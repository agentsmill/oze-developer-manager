/*! For license information please see main.651e3ad9.js.LICENSE.txt */
(()=>{"use strict";var e={49:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,y={};function g(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||m}function v(){}function w(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||m}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=g.prototype;var x=w.prototype=new v;x.constructor=w,f(x,g.prototype),x.isPureReactComponent=!0;var b=Array.isArray,j=Object.prototype.hasOwnProperty,k={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function z(e,t,r){var i,a={},s=null,o=null;if(null!=t)for(i in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)j.call(t,i)&&!N.hasOwnProperty(i)&&(a[i]=t[i]);var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===a[i]&&(a[i]=l[i]);return{$$typeof:n,type:e,key:s,ref:o,props:a,_owner:k.current}}function _(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function S(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function C(e,t,i,a,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return s=s(l=e),e=""===a?"."+S(l,0):a,b(s)?(i="",null!=e&&(i=e.replace(E,"$&/")+"/"),C(s,t,i,"",(function(e){return e}))):null!=s&&(_(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,i+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(E,"$&/")+"/")+e)),t.push(s)),1;if(l=0,a=""===a?".":a+":",b(e))for(var c=0;c<e.length;c++){var d=a+S(o=e[c],c);l+=C(o,t,i,d,s)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(o=e.next()).done;)l+=C(o=o.value,t,i,d=a+S(o,c++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function T(e,t,n){if(null==e)return e;var r=[],i=0;return C(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function P(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},A={transition:null},M={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:A,ReactCurrentOwner:k};function D(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:T,forEach:function(e,t,n){T(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return T(e,(function(){t++})),t},toArray:function(e){return T(e,(function(e){return e}))||[]},only:function(e){if(!_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=i,t.Profiler=s,t.PureComponent=w,t.StrictMode=a,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,t.act=D,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=f({},e.props),a=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=k.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)j.call(t,c)&&!N.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];i.children=l}return{$$typeof:n,type:e.type,key:a,ref:s,props:i,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=z,t.createFactory=function(e){var t=z.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=_,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=A.transition;A.transition={};try{e()}finally{A.transition=t}},t.unstable_act=D,t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,n){return I.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,n){return I.current.useReducer(e,t,n)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return I.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return I.current.useTransition()},t.version="18.3.1"},119:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(345)},340:(e,t,n)=>{e.exports=n(761)},345:(e,t,n)=>{var r=n(950),i=n(340);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function f(e,t,n,r,i,a,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){y[e]=new f(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];y[t]=new f(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){y[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){y[e]=new f(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){y[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){y[e]=new f(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){y[e]=new f(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){y[e]=new f(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){y[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function w(e,t,n,r){var i=y.hasOwnProperty(t)?y[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!u.call(m,e)||!u.call(p,e)&&(h.test(e)?m[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,v);y[t]=new f(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,v);y[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,v);y[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){y[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)})),y.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){y[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),j=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),E=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var A=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=M&&e[M]||e["@@iterator"])?e:null}var R,O=Object.assign;function L(e){if(void 0===R)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);R=t&&t[1]||""}return"\n"+R+e}var F=!1;function U(e,t){if(!e||F)return"";F=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),a=r.stack.split("\n"),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(1!==s||1!==o)do{if(s--,0>--o||i[s]!==a[o]){var l="\n"+i[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=o);break}}}finally{F=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?L(e):""}function V(e){switch(e.tag){case 5:return L(e.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case k:return"Fragment";case j:return"Portal";case z:return"Profiler";case N:return"StrictMode";case C:return"Suspense";case T:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case _:return(e._context.displayName||"Context")+".Provider";case S:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function $(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=q(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function G(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(ka){return e.body}}function Q(e,t){var n=t.checked;return O({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Z(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&w(e,"checked",t,!1)}function J(e,t){Y(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function X(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&G(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return O({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function ae(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return de(e,t)}))}:de);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ye(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=fe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(pe).forEach((function(e){me.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ge=O({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function we(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var je=null,ke=null,Ne=null;function ze(e){if(e=wi(e)){if("function"!==typeof je)throw Error(a(280));var t=e.stateNode;t&&(t=bi(t),je(e.stateNode,e.type,t))}}function _e(e){ke?Ne?Ne.push(e):Ne=[e]:ke=e}function Ee(){if(ke){var e=ke,t=Ne;if(Ne=ke=null,ze(e),t)for(e=0;e<t.length;e++)ze(t[e])}}function Se(e,t){return e(t)}function Ce(){}var Te=!1;function Pe(e,t,n){if(Te)return e(t,n);Te=!0;try{return Se(e,t,n)}finally{Te=!1,(null!==ke||null!==Ne)&&(Ce(),Ee())}}function Ie(e,t){var n=e.stateNode;if(null===n)return null;var r=bi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Ae=!1;if(d)try{var Me={};Object.defineProperty(Me,"passive",{get:function(){Ae=!0}}),window.addEventListener("test",Me,Me),window.removeEventListener("test",Me,Me)}catch(de){Ae=!1}function De(e,t,n,r,i,a,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var Re=!1,Oe=null,Le=!1,Fe=null,Ue={onError:function(e){Re=!0,Oe=e}};function Ve(e,t,n,r,i,a,s,o,l){Re=!1,Oe=null,De.apply(Ue,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function $e(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Be(e)!==e)throw Error(a(188))}function qe(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(r=i.return)){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return We(i),e;if(s===r)return We(i),t;s=s.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e),null!==e?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Ke=i.unstable_scheduleCallback,Ge=i.unstable_cancelCallback,Qe=i.unstable_shouldYield,Ze=i.unstable_requestPaint,Ye=i.unstable_now,Je=i.unstable_getCurrentPriorityLevel,Xe=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,at=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,s=268435455&n;if(0!==s){var o=s&~i;0!==o?r=ut(o):0!==(a&=s)&&(r=ut(a))}else 0!==(s=n&~i)?r=ut(s):0!==a&&(r=ut(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(a=t&-t)||16===i&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-st(t)),r|=e[n],t&=~i;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function yt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var wt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var bt,jt,kt,Nt,zt,_t=!1,Et=[],St=null,Ct=null,Tt=null,Pt=new Map,It=new Map,At=[],Mt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":St=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":Tt=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":It.delete(t.pointerId)}}function Rt(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=wi(t))&&jt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ot(e){var t=vi(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=$e(n)))return e.blockedOn=t,void zt(e.priority,(function(){kt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Lt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=wi(n))&&jt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function Ft(e,t,n){Lt(e)&&n.delete(t)}function Ut(){_t=!1,null!==St&&Lt(St)&&(St=null),null!==Ct&&Lt(Ct)&&(Ct=null),null!==Tt&&Lt(Tt)&&(Tt=null),Pt.forEach(Ft),It.forEach(Ft)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,_t||(_t=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ut)))}function Bt(e){function t(t){return Vt(t,e)}if(0<Et.length){Vt(Et[0],e);for(var n=1;n<Et.length;n++){var r=Et[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==St&&Vt(St,e),null!==Ct&&Vt(Ct,e),null!==Tt&&Vt(Tt,e),Pt.forEach(t),It.forEach(t),n=0;n<At.length;n++)(r=At[n]).blockedOn===e&&(r.blockedOn=null);for(;0<At.length&&null===(n=At[0]).blockedOn;)Ot(n),null===n.blockedOn&&At.shift()}var $t=x.ReactCurrentBatchConfig,Wt=!0;function qt(e,t,n,r){var i=wt,a=$t.transition;$t.transition=null;try{wt=1,Kt(e,t,n,r)}finally{wt=i,$t.transition=a}}function Ht(e,t,n,r){var i=wt,a=$t.transition;$t.transition=null;try{wt=4,Kt(e,t,n,r)}finally{wt=i,$t.transition=a}}function Kt(e,t,n,r){if(Wt){var i=Qt(e,t,n,r);if(null===i)Wr(e,t,r,Gt,n),Dt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return St=Rt(St,e,t,n,r,i),!0;case"dragenter":return Ct=Rt(Ct,e,t,n,r,i),!0;case"mouseover":return Tt=Rt(Tt,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return Pt.set(a,Rt(Pt.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,It.set(a,Rt(It.get(a)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Dt(e,r),4&t&&-1<Mt.indexOf(e)){for(;null!==i;){var a=wi(i);if(null!==a&&bt(a),null===(a=Qt(e,t,n,r))&&Wr(e,t,r,Gt,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var Gt=null;function Qt(e,t,n,r){if(Gt=null,null!==(e=vi(e=be(r))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=$e(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function Zt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Xe:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Yt=null,Jt=null,Xt=null;function en(){if(Xt)return Xt;var e,t,n=Jt,r=n.length,i="value"in Yt?Yt.value:Yt.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[a-t];t++);return Xt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,i,a){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return O(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=an(cn),un=O({},cn,{view:0,detail:0}),hn=an(un),pn=O({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(sn=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=sn=0,ln=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),mn=an(pn),fn=an(O({},pn,{dataTransfer:0})),yn=an(O({},un,{relatedTarget:0})),gn=an(O({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=O({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),wn=an(vn),xn=an(O({},cn,{data:0})),bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=kn[e])&&!!t[e]}function zn(){return Nn}var _n=O({},un,{key:function(e){if(e.key){var t=bn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?jn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),En=an(_n),Sn=an(O({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Cn=an(O({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zn})),Tn=an(O({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pn=O({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),In=an(Pn),An=[9,13,27,32],Mn=d&&"CompositionEvent"in window,Dn=null;d&&"documentMode"in document&&(Dn=document.documentMode);var Rn=d&&"TextEvent"in window&&!Dn,On=d&&(!Mn||Dn&&8<Dn&&11>=Dn),Ln=String.fromCharCode(32),Fn=!1;function Un(e,t){switch(e){case"keyup":return-1!==An.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var $n={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!$n[e.type]:"textarea"===t}function qn(e,t,n,r){_e(r),0<(t=Hr(t,"onChange")).length&&(n=new dn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,Kn=null;function Gn(e){Lr(e,0)}function Qn(e){if(K(xi(e)))return e}function Zn(e,t){if("change"===e)return t}var Yn=!1;if(d){var Jn;if(d){var Xn="oninput"in document;if(!Xn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Xn="function"===typeof er.oninput}Jn=Xn}else Jn=!1;Yn=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){Hn&&(Hn.detachEvent("onpropertychange",nr),Kn=Hn=null)}function nr(e){if("value"===e.propertyName&&Qn(Kn)){var t=[];qn(t,Kn,e,be(e)),Pe(Gn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Hn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Kn)}function ar(e,t){if("click"===e)return Qn(t)}function sr(e,t){if("input"===e||"change"===e)return Qn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!u.call(t,i)||!or(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function ur(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ur(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=G((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ur(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=void 0===r.end?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=dr(n,a);var s=dr(n,r);i&&s&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fr=d&&"documentMode"in document&&11>=document.documentMode,yr=null,gr=null,vr=null,wr=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;wr||null==yr||yr!==G(r)||("selectionStart"in(r=yr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&lr(vr,r)||(vr=r,0<(r=Hr(gr,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=yr)))}function br(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var jr={animationend:br("Animation","AnimationEnd"),animationiteration:br("Animation","AnimationIteration"),animationstart:br("Animation","AnimationStart"),transitionend:br("Transition","TransitionEnd")},kr={},Nr={};function zr(e){if(kr[e])return kr[e];if(!jr[e])return e;var t,n=jr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Nr)return kr[e]=n[t];return e}d&&(Nr=document.createElement("div").style,"AnimationEvent"in window||(delete jr.animationend.animation,delete jr.animationiteration.animation,delete jr.animationstart.animation),"TransitionEvent"in window||delete jr.transitionend.transition);var _r=zr("animationend"),Er=zr("animationiteration"),Sr=zr("animationstart"),Cr=zr("transitionend"),Tr=new Map,Pr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ir(e,t){Tr.set(e,t),l(t,[e])}for(var Ar=0;Ar<Pr.length;Ar++){var Mr=Pr[Ar];Ir(Mr.toLowerCase(),"on"+(Mr[0].toUpperCase()+Mr.slice(1)))}Ir(_r,"onAnimationEnd"),Ir(Er,"onAnimationIteration"),Ir(Sr,"onAnimationStart"),Ir("dblclick","onDoubleClick"),Ir("focusin","onFocus"),Ir("focusout","onBlur"),Ir(Cr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Rr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dr));function Or(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,s,o,l,c){if(Ve.apply(this,arguments),Re){if(!Re)throw Error(a(198));var d=Oe;Re=!1,Oe=null,Le||(Le=!0,Fe=d)}}(r,t,void 0,e),e.currentTarget=null}function Lr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;Or(i,o,c),a=l}else for(s=0;s<r.length;s++){if(l=(o=r[s]).instance,c=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;Or(i,o,c),a=l}}}if(Le)throw e=Fe,Le=!1,Fe=null,e}function Fr(e,t){var n=t[fi];void 0===n&&(n=t[fi]=new Set);var r=e+"__bubble";n.has(r)||($r(t,e,2,!1),n.add(r))}function Ur(e,t,n){var r=0;t&&(r|=4),$r(n,e,r,t)}var Vr="_reactListening"+Math.random().toString(36).slice(2);function Br(e){if(!e[Vr]){e[Vr]=!0,s.forEach((function(t){"selectionchange"!==t&&(Rr.has(t)||Ur(t,!1,e),Ur(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vr]||(t[Vr]=!0,Ur("selectionchange",!1,t))}}function $r(e,t,n,r){switch(Zt(t)){case 1:var i=qt;break;case 4:i=Ht;break;default:i=Kt}n=i.bind(null,t,n,e),i=void 0,!Ae||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;s=s.return}for(;null!==o;){if(null===(s=vi(o)))return;if(5===(l=s.tag)||6===l){r=a=s;continue e}o=o.parentNode}}r=r.return}Pe((function(){var r=a,i=be(n),s=[];e:{var o=Tr.get(e);if(void 0!==o){var l=dn,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=En;break;case"focusin":c="focus",l=yn;break;case"focusout":c="blur",l=yn;break;case"beforeblur":case"afterblur":l=yn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Cn;break;case _r:case Er:case Sr:l=gn;break;case Cr:l=Tn;break;case"scroll":l=hn;break;case"wheel":l=In;break;case"copy":case"cut":case"paste":l=wn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Sn}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==o?o+"Capture":null:o;d=[];for(var p,m=r;null!==m;){var f=(p=m).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==h&&(null!=(f=Ie(m,h))&&d.push(qr(m,f,p)))),u)break;m=m.return}0<d.length&&(o=new l(o,c,null,n,i),s.push({event:o,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!vi(c)&&!c[mi])&&(l||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?vi(c):null)&&(c!==(u=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(d=mn,f="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=Sn,f="onPointerLeave",h="onPointerEnter",m="pointer"),u=null==l?o:xi(l),p=null==c?o:xi(c),(o=new d(f,m+"leave",l,n,i)).target=u,o.relatedTarget=p,f=null,vi(i)===r&&((d=new d(h,m+"enter",c,n,i)).target=p,d.relatedTarget=u,f=d),u=f,l&&c)e:{for(h=c,m=0,p=d=l;p;p=Kr(p))m++;for(p=0,f=h;f;f=Kr(f))p++;for(;0<m-p;)d=Kr(d),m--;for(;0<p-m;)h=Kr(h),p--;for(;m--;){if(d===h||null!==h&&d===h.alternate)break e;d=Kr(d),h=Kr(h)}d=null}else d=null;null!==l&&Gr(s,o,l,d,!1),null!==c&&null!==u&&Gr(s,u,c,d,!0)}if("select"===(l=(o=r?xi(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var y=Zn;else if(Wn(o))if(Yn)y=sr;else{y=ir;var g=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(y=ar);switch(y&&(y=y(e,r))?qn(s,y,n,i):(g&&g(e,o,r),"focusout"===e&&(g=o._wrapperState)&&g.controlled&&"number"===o.type&&ee(o,"number",o.value)),g=r?xi(r):window,e){case"focusin":(Wn(g)||"true"===g.contentEditable)&&(yr=g,gr=r,vr=null);break;case"focusout":vr=gr=yr=null;break;case"mousedown":wr=!0;break;case"contextmenu":case"mouseup":case"dragend":wr=!1,xr(s,n,i);break;case"selectionchange":if(fr)break;case"keydown":case"keyup":xr(s,n,i)}var v;if(Mn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Bn?Un(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(On&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==w?"onCompositionEnd"===w&&Bn&&(v=en()):(Jt="value"in(Yt=i)?Yt.value:Yt.textContent,Bn=!0)),0<(g=Hr(r,w)).length&&(w=new xn(w,e,null,n,i),s.push({event:w,listeners:g}),v?w.data=v:null!==(v=Vn(n))&&(w.data=v))),(v=Rn?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(Fn=!0,Ln);case"textInput":return(e=t.data)===Ln&&Fn?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!Mn&&Un(e,t)?(e=en(),Xt=Jt=Yt=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return On&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Hr(r,"onBeforeInput")).length&&(i=new xn("onBeforeInput","beforeinput",null,n,i),s.push({event:i,listeners:r}),i.data=v))}Lr(s,t)}))}function qr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Ie(e,n))&&r.unshift(qr(e,a,i)),null!=(a=Ie(e,t))&&r.push(qr(e,a,i))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gr(e,t,n,r,i){for(var a=t._reactName,s=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==c&&(o=c,i?null!=(l=Ie(n,a))&&s.unshift(qr(n,l,o)):i||null!=(l=Ie(n,a))&&s.push(qr(n,l,o))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Qr=/\r\n?/g,Zr=/\u0000|\uFFFD/g;function Yr(e){return("string"===typeof e?e:""+e).replace(Qr,"\n").replace(Zr,"")}function Jr(e,t,n){if(t=Yr(t),Yr(e)!==t&&n)throw Error(a(425))}function Xr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,ai="function"===typeof Promise?Promise:void 0,si="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ai?function(e){return ai.resolve(null).then(e).catch(oi)}:ri;function oi(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Bt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Bt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function di(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ui=Math.random().toString(36).slice(2),hi="__reactFiber$"+ui,pi="__reactProps$"+ui,mi="__reactContainer$"+ui,fi="__reactEvents$"+ui,yi="__reactListeners$"+ui,gi="__reactHandles$"+ui;function vi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[mi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=di(e);null!==e;){if(n=e[hi])return n;e=di(e)}return t}n=(e=n).parentNode}return null}function wi(e){return!(e=e[hi]||e[mi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function bi(e){return e[pi]||null}var ji=[],ki=-1;function Ni(e){return{current:e}}function zi(e){0>ki||(e.current=ji[ki],ji[ki]=null,ki--)}function _i(e,t){ki++,ji[ki]=e.current,e.current=t}var Ei={},Si=Ni(Ei),Ci=Ni(!1),Ti=Ei;function Pi(e,t){var n=e.type.contextTypes;if(!n)return Ei;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ii(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ai(){zi(Ci),zi(Si)}function Mi(e,t,n){if(Si.current!==Ei)throw Error(a(168));_i(Si,t),_i(Ci,n)}function Di(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(a(108,$(e)||"Unknown",i));return O({},n,r)}function Ri(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ei,Ti=Si.current,_i(Si,e),_i(Ci,Ci.current),!0}function Oi(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Di(e,t,Ti),r.__reactInternalMemoizedMergedChildContext=e,zi(Ci),zi(Si),_i(Si,e)):zi(Ci),_i(Ci,n)}var Li=null,Fi=!1,Ui=!1;function Vi(e){null===Li?Li=[e]:Li.push(e)}function Bi(){if(!Ui&&null!==Li){Ui=!0;var e=0,t=wt;try{var n=Li;for(wt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Li=null,Fi=!1}catch(i){throw null!==Li&&(Li=Li.slice(e+1)),Ke(Xe,Bi),i}finally{wt=t,Ui=!1}}return null}var $i=[],Wi=0,qi=null,Hi=0,Ki=[],Gi=0,Qi=null,Zi=1,Yi="";function Ji(e,t){$i[Wi++]=Hi,$i[Wi++]=qi,qi=e,Hi=t}function Xi(e,t,n){Ki[Gi++]=Zi,Ki[Gi++]=Yi,Ki[Gi++]=Qi,Qi=e;var r=Zi;e=Yi;var i=32-st(r)-1;r&=~(1<<i),n+=1;var a=32-st(t)+i;if(30<a){var s=i-i%5;a=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Zi=1<<32-st(t)+i|n<<i|r,Yi=a+e}else Zi=1<<a|n<<i|r,Yi=e}function ea(e){null!==e.return&&(Ji(e,1),Xi(e,1,0))}function ta(e){for(;e===qi;)qi=$i[--Wi],$i[Wi]=null,Hi=$i[--Wi],$i[Wi]=null;for(;e===Qi;)Qi=Ki[--Gi],Ki[Gi]=null,Yi=Ki[--Gi],Ki[Gi]=null,Zi=Ki[--Gi],Ki[Gi]=null}var na=null,ra=null,ia=!1,aa=null;function sa(e,t){var n=Ic(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,ra=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,ra=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qi?{id:Zi,overflow:Yi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ic(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,ra=null,!0);default:return!1}}function la(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ca(e){if(ia){var t=ra;if(t){var n=t;if(!oa(e,t)){if(la(e))throw Error(a(418));t=ci(n.nextSibling);var r=na;t&&oa(e,t)?sa(r,n):(e.flags=-4097&e.flags|2,ia=!1,na=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,ia=!1,na=e}}}function da(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function ua(e){if(e!==na)return!1;if(!ia)return da(e),ia=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ra)){if(la(e))throw ha(),Error(a(418));for(;t;)sa(e,t),t=ci(t.nextSibling)}if(da(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ra=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ra=null}}else ra=na?ci(e.stateNode.nextSibling):null;return!0}function ha(){for(var e=ra;e;)e=ci(e.nextSibling)}function pa(){ra=na=null,ia=!1}function ma(e){null===aa?aa=[e]:aa.push(e)}var fa=x.ReactCurrentBatchConfig;function ya(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=r,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=i.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function ga(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function va(e){return(0,e._init)(e._payload)}function wa(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Mc(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Lc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===k?u(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===I&&va(a)===t.type)?((r=i(t,n.props)).ref=ya(e,t,n),r.return=e,r):((r=Dc(n.type,n.key,n.props,null,e.mode,r)).ref=ya(e,t,n),r.return=e,r)}function d(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function u(e,t,n,r,a){return null===t||7!==t.tag?((t=Rc(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case b:return(n=Dc(t.type,t.key,t.props,null,e.mode,n)).ref=ya(e,null,t),n.return=e,n;case j:return(t=Fc(t,e.mode,n)).return=e,t;case I:return h(e,(0,t._init)(t._payload),n)}if(te(t)||D(t))return(t=Rc(t,e.mode,n,null)).return=e,t;ga(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===i?c(e,t,n,r):null;case j:return n.key===i?d(e,t,n,r):null;case I:return p(e,t,(i=n._init)(n._payload),r)}if(te(n)||D(n))return null!==i?null:u(e,t,n,r,null);ga(e,n)}return null}function m(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case b:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case j:return d(t,e=e.get(null===r.key?n:r.key)||null,r,i);case I:return m(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||D(r))return u(t,e=e.get(n)||null,r,i,null);ga(t,r)}return null}function f(i,a,o,l){for(var c=null,d=null,u=a,f=a=0,y=null;null!==u&&f<o.length;f++){u.index>f?(y=u,u=null):y=u.sibling;var g=p(i,u,o[f],l);if(null===g){null===u&&(u=y);break}e&&u&&null===g.alternate&&t(i,u),a=s(g,a,f),null===d?c=g:d.sibling=g,d=g,u=y}if(f===o.length)return n(i,u),ia&&Ji(i,f),c;if(null===u){for(;f<o.length;f++)null!==(u=h(i,o[f],l))&&(a=s(u,a,f),null===d?c=u:d.sibling=u,d=u);return ia&&Ji(i,f),c}for(u=r(i,u);f<o.length;f++)null!==(y=m(u,i,f,o[f],l))&&(e&&null!==y.alternate&&u.delete(null===y.key?f:y.key),a=s(y,a,f),null===d?c=y:d.sibling=y,d=y);return e&&u.forEach((function(e){return t(i,e)})),ia&&Ji(i,f),c}function y(i,o,l,c){var d=D(l);if("function"!==typeof d)throw Error(a(150));if(null==(l=d.call(l)))throw Error(a(151));for(var u=d=null,f=o,y=o=0,g=null,v=l.next();null!==f&&!v.done;y++,v=l.next()){f.index>y?(g=f,f=null):g=f.sibling;var w=p(i,f,v.value,c);if(null===w){null===f&&(f=g);break}e&&f&&null===w.alternate&&t(i,f),o=s(w,o,y),null===u?d=w:u.sibling=w,u=w,f=g}if(v.done)return n(i,f),ia&&Ji(i,y),d;if(null===f){for(;!v.done;y++,v=l.next())null!==(v=h(i,v.value,c))&&(o=s(v,o,y),null===u?d=v:u.sibling=v,u=v);return ia&&Ji(i,y),d}for(f=r(i,f);!v.done;y++,v=l.next())null!==(v=m(f,i,y,v.value,c))&&(e&&null!==v.alternate&&f.delete(null===v.key?y:v.key),o=s(v,o,y),null===u?d=v:u.sibling=v,u=v);return e&&f.forEach((function(e){return t(i,e)})),ia&&Ji(i,y),d}return function e(r,a,s,l){if("object"===typeof s&&null!==s&&s.type===k&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case b:e:{for(var c=s.key,d=a;null!==d;){if(d.key===c){if((c=s.type)===k){if(7===d.tag){n(r,d.sibling),(a=i(d,s.props.children)).return=r,r=a;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===I&&va(c)===d.type){n(r,d.sibling),(a=i(d,s.props)).ref=ya(r,d,s),a.return=r,r=a;break e}n(r,d);break}t(r,d),d=d.sibling}s.type===k?((a=Rc(s.props.children,r.mode,l,s.key)).return=r,r=a):((l=Dc(s.type,s.key,s.props,null,r.mode,l)).ref=ya(r,a,s),l.return=r,r=l)}return o(r);case j:e:{for(d=s.key;null!==a;){if(a.key===d){if(4===a.tag&&a.stateNode.containerInfo===s.containerInfo&&a.stateNode.implementation===s.implementation){n(r,a.sibling),(a=i(a,s.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=Fc(s,r.mode,l)).return=r,r=a}return o(r);case I:return e(r,a,(d=s._init)(s._payload),l)}if(te(s))return f(r,a,s,l);if(D(s))return y(r,a,s,l);ga(r,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==a&&6===a.tag?(n(r,a.sibling),(a=i(a,s)).return=r,r=a):(n(r,a),(a=Lc(s,r.mode,l)).return=r,r=a),o(r)):n(r,a)}}var xa=wa(!0),ba=wa(!1),ja=Ni(null),Na=null,za=null,_a=null;function Ea(){_a=za=Na=null}function Sa(e){var t=ja.current;zi(ja),e._currentValue=t}function Ca(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ta(e,t){Na=e,_a=za=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xo=!0),e.firstContext=null)}function Pa(e){var t=e._currentValue;if(_a!==e)if(e={context:e,memoizedValue:t,next:null},null===za){if(null===Na)throw Error(a(308));za=e,Na.dependencies={lanes:0,firstContext:e}}else za=za.next=e;return t}var Ia=null;function Aa(e){null===Ia?Ia=[e]:Ia.push(e)}function Ma(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Aa(t)):(n.next=i.next,i.next=n),t.interleaved=n,Da(e,r)}function Da(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ra=!1;function Oa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function La(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ua(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Cl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Da(e,n)}return null===(i=r.interleaved)?(t.next=t,Aa(r)):(t.next=i.next,i.next=t),r.interleaved=t,Da(e,n)}function Va(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Ba(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=s:a=a.next=s,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function $a(e,t,n,r){var i=e.updateQueue;Ra=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?a=c:s.next=c,s=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==s&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==a){var u=i.baseState;for(s=0,d=c=l=null,o=a;;){var h=o.lane,p=o.eventTime;if((r&h)===h){null!==d&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,f=o;switch(h=t,p=n,f.tag){case 1:if("function"===typeof(m=f.payload)){u=m.call(p,u,h);break e}u=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(h="function"===typeof(m=f.payload)?m.call(p,u,h):m)||void 0===h)break e;u=O({},u,h);break e;case 2:Ra=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=p,l=u):d=d.next=p,s|=h;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(h=o).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===d&&(l=u),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,null!==(t=i.shared.interleaved)){i=t;do{s|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Ol|=s,e.lanes=s,e.memoizedState=u}}function Wa(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(a(191,i));i.call(r)}}}var qa={},Ha=Ni(qa),Ka=Ni(qa),Ga=Ni(qa);function Qa(e){if(e===qa)throw Error(a(174));return e}function Za(e,t){switch(_i(Ga,t),_i(Ka,e),_i(Ha,qa),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}zi(Ha),_i(Ha,t)}function Ya(){zi(Ha),zi(Ka),zi(Ga)}function Ja(e){Qa(Ga.current);var t=Qa(Ha.current),n=le(t,e.type);t!==n&&(_i(Ka,e),_i(Ha,n))}function Xa(e){Ka.current===e&&(zi(Ha),zi(Ka))}var es=Ni(0);function ts(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ns=[];function rs(){for(var e=0;e<ns.length;e++)ns[e]._workInProgressVersionPrimary=null;ns.length=0}var is=x.ReactCurrentDispatcher,as=x.ReactCurrentBatchConfig,ss=0,os=null,ls=null,cs=null,ds=!1,us=!1,hs=0,ps=0;function ms(){throw Error(a(321))}function fs(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function ys(e,t,n,r,i,s){if(ss=s,os=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,is.current=null===e||null===e.memoizedState?Xs:eo,e=n(r,i),us){s=0;do{if(us=!1,hs=0,25<=s)throw Error(a(301));s+=1,cs=ls=null,t.updateQueue=null,is.current=to,e=n(r,i)}while(us)}if(is.current=Js,t=null!==ls&&null!==ls.next,ss=0,cs=ls=os=null,ds=!1,t)throw Error(a(300));return e}function gs(){var e=0!==hs;return hs=0,e}function vs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===cs?os.memoizedState=cs=e:cs=cs.next=e,cs}function ws(){if(null===ls){var e=os.alternate;e=null!==e?e.memoizedState:null}else e=ls.next;var t=null===cs?os.memoizedState:cs.next;if(null!==t)cs=t,ls=e;else{if(null===e)throw Error(a(310));e={memoizedState:(ls=e).memoizedState,baseState:ls.baseState,baseQueue:ls.baseQueue,queue:ls.queue,next:null},null===cs?os.memoizedState=cs=e:cs=cs.next=e}return cs}function xs(e,t){return"function"===typeof t?t(e):t}function bs(e){var t=ws(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=ls,i=r.baseQueue,s=n.pending;if(null!==s){if(null!==i){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(null!==i){s=i.next,r=r.baseState;var l=o=null,c=null,d=s;do{var u=d.lane;if((ss&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,o=r):c=c.next=h,os.lanes|=u,Ol|=u}d=d.next}while(null!==d&&d!==s);null===c?o=r:c.next=l,or(r,t.memoizedState)||(xo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{s=i.lane,os.lanes|=s,Ol|=s,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function js(e){var t=ws(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{s=e(s,o.action),o=o.next}while(o!==i);or(s,t.memoizedState)||(xo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function ks(){}function Ns(e,t){var n=os,r=ws(),i=t(),s=!or(r.memoizedState,i);if(s&&(r.memoizedState=i,xo=!0),r=r.queue,Rs(Es.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==cs&&1&cs.memoizedState.tag){if(n.flags|=2048,Ps(9,_s.bind(null,n,r,i,t),void 0,null),null===Tl)throw Error(a(349));0!==(30&ss)||zs(n,t,i)}return i}function zs(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=os.updateQueue)?(t={lastEffect:null,stores:null},os.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function _s(e,t,n,r){t.value=n,t.getSnapshot=r,Ss(t)&&Cs(e)}function Es(e,t,n){return n((function(){Ss(t)&&Cs(e)}))}function Ss(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function Cs(e){var t=Da(e,1);null!==t&&rc(t,e,1,-1)}function Ts(e){var t=vs();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:e},t.queue=e,e=e.dispatch=Gs.bind(null,os,e),[t.memoizedState,e]}function Ps(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=os.updateQueue)?(t={lastEffect:null,stores:null},os.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Is(){return ws().memoizedState}function As(e,t,n,r){var i=vs();os.flags|=e,i.memoizedState=Ps(1|t,n,void 0,void 0===r?null:r)}function Ms(e,t,n,r){var i=ws();r=void 0===r?null:r;var a=void 0;if(null!==ls){var s=ls.memoizedState;if(a=s.destroy,null!==r&&fs(r,s.deps))return void(i.memoizedState=Ps(t,n,a,r))}os.flags|=e,i.memoizedState=Ps(1|t,n,a,r)}function Ds(e,t){return As(8390656,8,e,t)}function Rs(e,t){return Ms(2048,8,e,t)}function Os(e,t){return Ms(4,2,e,t)}function Ls(e,t){return Ms(4,4,e,t)}function Fs(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Us(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ms(4,4,Fs.bind(null,t,e),n)}function Vs(){}function Bs(e,t){var n=ws();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fs(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function $s(e,t){var n=ws();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fs(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ws(e,t,n){return 0===(21&ss)?(e.baseState&&(e.baseState=!1,xo=!0),e.memoizedState=n):(or(n,t)||(n=ft(),os.lanes|=n,Ol|=n,e.baseState=!0),t)}function qs(e,t){var n=wt;wt=0!==n&&4>n?n:4,e(!0);var r=as.transition;as.transition={};try{e(!1),t()}finally{wt=n,as.transition=r}}function Hs(){return ws().memoizedState}function Ks(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qs(e))Zs(t,n);else if(null!==(n=Ma(e,t,n,r))){rc(n,e,r,tc()),Ys(n,t,r)}}function Gs(e,t,n){var r=nc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qs(e))Zs(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=a(s,n);if(i.hasEagerState=!0,i.eagerState=o,or(o,s)){var l=t.interleaved;return null===l?(i.next=i,Aa(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Ma(e,t,i,r))&&(rc(n,e,r,i=tc()),Ys(n,t,r))}}function Qs(e){var t=e.alternate;return e===os||null!==t&&t===os}function Zs(e,t){us=ds=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ys(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Js={readContext:Pa,useCallback:ms,useContext:ms,useEffect:ms,useImperativeHandle:ms,useInsertionEffect:ms,useLayoutEffect:ms,useMemo:ms,useReducer:ms,useRef:ms,useState:ms,useDebugValue:ms,useDeferredValue:ms,useTransition:ms,useMutableSource:ms,useSyncExternalStore:ms,useId:ms,unstable_isNewReconciler:!1},Xs={readContext:Pa,useCallback:function(e,t){return vs().memoizedState=[e,void 0===t?null:t],e},useContext:Pa,useEffect:Ds,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,As(4194308,4,Fs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return As(4194308,4,e,t)},useInsertionEffect:function(e,t){return As(4,2,e,t)},useMemo:function(e,t){var n=vs();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=vs();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ks.bind(null,os,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},vs().memoizedState=e},useState:Ts,useDebugValue:Vs,useDeferredValue:function(e){return vs().memoizedState=e},useTransition:function(){var e=Ts(!1),t=e[0];return e=qs.bind(null,e[1]),vs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=os,i=vs();if(ia){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Tl)throw Error(a(349));0!==(30&ss)||zs(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,Ds(Es.bind(null,r,s,e),[e]),r.flags|=2048,Ps(9,_s.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=vs(),t=Tl.identifierPrefix;if(ia){var n=Yi;t=":"+t+"R"+(n=(Zi&~(1<<32-st(Zi)-1)).toString(32)+n),0<(n=hs++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ps++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},eo={readContext:Pa,useCallback:Bs,useContext:Pa,useEffect:Rs,useImperativeHandle:Us,useInsertionEffect:Os,useLayoutEffect:Ls,useMemo:$s,useReducer:bs,useRef:Is,useState:function(){return bs(xs)},useDebugValue:Vs,useDeferredValue:function(e){return Ws(ws(),ls.memoizedState,e)},useTransition:function(){return[bs(xs)[0],ws().memoizedState]},useMutableSource:ks,useSyncExternalStore:Ns,useId:Hs,unstable_isNewReconciler:!1},to={readContext:Pa,useCallback:Bs,useContext:Pa,useEffect:Rs,useImperativeHandle:Us,useInsertionEffect:Os,useLayoutEffect:Ls,useMemo:$s,useReducer:js,useRef:Is,useState:function(){return js(xs)},useDebugValue:Vs,useDeferredValue:function(e){var t=ws();return null===ls?t.memoizedState=e:Ws(t,ls.memoizedState,e)},useTransition:function(){return[js(xs)[0],ws().memoizedState]},useMutableSource:ks,useSyncExternalStore:Ns,useId:Hs,unstable_isNewReconciler:!1};function no(e,t){if(e&&e.defaultProps){for(var n in t=O({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ro(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:O({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var io={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),a=Fa(r,i);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Ua(e,a,i))&&(rc(t,e,i,r),Va(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),a=Fa(r,i);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Ua(e,a,i))&&(rc(t,e,i,r),Va(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),i=Fa(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Ua(e,i,r))&&(rc(t,e,r,n),Va(t,e,r))}};function ao(e,t,n,r,i,a,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,s):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,a))}function so(e,t,n){var r=!1,i=Ei,a=t.contextType;return"object"===typeof a&&null!==a?a=Pa(a):(i=Ii(t)?Ti:Si.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?Pi(e,i):Ei),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=io,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function oo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&io.enqueueReplaceState(t,t.state,null)}function lo(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Oa(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=Pa(a):(a=Ii(t)?Ti:Si.current,i.context=Pi(e,a)),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(ro(e,t,a,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&io.enqueueReplaceState(i,i.state,null),$a(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function co(e,t){try{var n="",r=t;do{n+=V(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i,digest:null}}function uo(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ho(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var po="function"===typeof WeakMap?WeakMap:Map;function mo(e,t,n){(n=Fa(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ql||(ql=!0,Hl=r),ho(0,t)},n}function fo(e,t,n){(n=Fa(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ho(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){ho(0,t),"function"!==typeof r&&(null===Kl?Kl=new Set([this]):Kl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function yo(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new po;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=_c.bind(null,e,t,n),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vo(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fa(-1,1)).tag=2,Ua(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var wo=x.ReactCurrentOwner,xo=!1;function bo(e,t,n,r){t.child=null===e?ba(t,null,n,r):xa(t,e.child,n,r)}function jo(e,t,n,r,i){n=n.render;var a=t.ref;return Ta(t,i),r=ys(e,t,n,r,a,i),n=gs(),null===e||xo?(ia&&n&&ea(t),t.flags|=1,bo(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qo(e,t,i))}function ko(e,t,n,r,i){if(null===e){var a=n.type;return"function"!==typeof a||Ac(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Dc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,No(e,t,a,r,i))}if(a=e.child,0===(e.lanes&i)){var s=a.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(s,r)&&e.ref===t.ref)return qo(e,t,i)}return t.flags|=1,(e=Mc(a,r)).ref=t.ref,e.return=t,t.child=e}function No(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if(lr(a,r)&&e.ref===t.ref){if(xo=!1,t.pendingProps=r=a,0===(e.lanes&i))return t.lanes=e.lanes,qo(e,t,i);0!==(131072&e.flags)&&(xo=!0)}}return Eo(e,t,n,r,i)}function zo(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},_i(Ml,Al),Al|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,_i(Ml,Al),Al|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,_i(Ml,Al),Al|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,_i(Ml,Al),Al|=r;return bo(e,t,i,n),t.child}function _o(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Eo(e,t,n,r,i){var a=Ii(n)?Ti:Si.current;return a=Pi(t,a),Ta(t,i),n=ys(e,t,n,r,a,i),r=gs(),null===e||xo?(ia&&r&&ea(t),t.flags|=1,bo(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qo(e,t,i))}function So(e,t,n,r,i){if(Ii(n)){var a=!0;Ri(t)}else a=!1;if(Ta(t,i),null===t.stateNode)Wo(e,t),so(t,n,r),lo(t,n,r,i),r=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=n.contextType;"object"===typeof c&&null!==c?c=Pa(c):c=Pi(t,c=Ii(n)?Ti:Si.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof s.getSnapshotBeforeUpdate;u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==r||l!==c)&&oo(t,s,r,c),Ra=!1;var h=t.memoizedState;s.state=h,$a(t,r,s,i),l=t.memoizedState,o!==r||h!==l||Ci.current||Ra?("function"===typeof d&&(ro(t,n,d,r),l=t.memoizedState),(o=Ra||ao(t,n,o,r,h,l,c))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=o):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,La(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:no(t.type,o),s.props=c,u=t.pendingProps,h=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=Pa(l):l=Pi(t,l=Ii(n)?Ti:Si.current);var p=n.getDerivedStateFromProps;(d="function"===typeof p||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==u||h!==l)&&oo(t,s,r,l),Ra=!1,h=t.memoizedState,s.state=h,$a(t,r,s,i);var m=t.memoizedState;o!==u||h!==m||Ci.current||Ra?("function"===typeof p&&(ro(t,n,p,r),m=t.memoizedState),(c=Ra||ao(t,n,c,r,h,m,l)||!1)?(d||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,m,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,m,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=m),s.props=r,s.state=m,s.context=l,r=c):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Co(e,t,n,r,a,i)}function Co(e,t,n,r,i,a){_o(e,t);var s=0!==(128&t.flags);if(!r&&!s)return i&&Oi(t,n,!1),qo(e,t,a);r=t.stateNode,wo.current=t;var o=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=xa(t,e.child,null,a),t.child=xa(t,null,o,a)):bo(e,t,o,a),t.memoizedState=r.state,i&&Oi(t,n,!0),t.child}function To(e){var t=e.stateNode;t.pendingContext?Mi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Mi(0,t.context,!1),Za(e,t.containerInfo)}function Po(e,t,n,r,i){return pa(),ma(i),t.flags|=256,bo(e,t,n,r),t.child}var Io,Ao,Mo,Do,Ro={dehydrated:null,treeContext:null,retryLane:0};function Oo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Lo(e,t,n){var r,i=t.pendingProps,s=es.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&s)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),_i(es,1&s),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,o?(i=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Oc(l,i,0,null),e=Rc(e,i,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Oo(n),t.memoizedState=Ro,e):Fo(t,l));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,i,s,o){if(n)return 256&t.flags?(t.flags&=-257,Uo(e,t,o,r=uo(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=Oc({mode:"visible",children:r.children},i,0,null),(s=Rc(s,i,o,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!==(1&t.mode)&&xa(t,e.child,null,o),t.child.memoizedState=Oo(o),t.memoizedState=Ro,s);if(0===(1&t.mode))return Uo(e,t,o,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Uo(e,t,o,r=uo(s=Error(a(419)),r,void 0))}if(l=0!==(o&e.childLanes),xo||l){if(null!==(r=Tl)){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|o))?0:i)&&i!==s.retryLane&&(s.retryLane=i,Da(e,i),rc(r,e,i,-1))}return yc(),Uo(e,t,o,r=uo(Error(a(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Sc.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,ra=ci(i.nextSibling),na=t,ia=!0,aa=null,null!==e&&(Ki[Gi++]=Zi,Ki[Gi++]=Yi,Ki[Gi++]=Qi,Zi=e.id,Yi=e.overflow,Qi=t),t=Fo(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,s,n);if(o){o=i.fallback,l=t.mode,r=(s=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==s?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Mc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==r?o=Mc(r,o):(o=Rc(o,l,n,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,l=null===(l=e.child.memoizedState)?Oo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Ro,i}return e=(o=e.child).sibling,i=Mc(o,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Fo(e,t){return(t=Oc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Uo(e,t,n,r){return null!==r&&ma(r),xa(t,e.child,null,n),(e=Fo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Vo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ca(e.return,t,n)}function Bo(e,t,n,r,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function $o(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(bo(e,t,r.children,n),0!==(2&(r=es.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Vo(e,n,t);else if(19===e.tag)Vo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(_i(es,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ts(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Bo(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ts(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Bo(t,!0,n,null,a);break;case"together":Bo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ol|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Mc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Mc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ho(e,t){if(!ia)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ko(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Go(e,t,n){var r=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ko(t),null;case 1:case 17:return Ii(t.type)&&Ai(),Ko(t),null;case 3:return r=t.stateNode,Ya(),zi(Ci),zi(Si),rs(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ua(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(oc(aa),aa=null))),Ao(e,t),Ko(t),null;case 5:Xa(t);var i=Qa(Ga.current);if(n=t.type,null!==e&&null!=t.stateNode)Mo(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Ko(t),null}if(e=Qa(Ha.current),ua(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[hi]=t,r[pi]=s,e=0!==(1&t.mode),n){case"dialog":Fr("cancel",r),Fr("close",r);break;case"iframe":case"object":case"embed":Fr("load",r);break;case"video":case"audio":for(i=0;i<Dr.length;i++)Fr(Dr[i],r);break;case"source":Fr("error",r);break;case"img":case"image":case"link":Fr("error",r),Fr("load",r);break;case"details":Fr("toggle",r);break;case"input":Z(r,s),Fr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Fr("invalid",r);break;case"textarea":ie(r,s),Fr("invalid",r)}for(var l in ve(n,s),i=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==s.suppressHydrationWarning&&Jr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&Jr(r.textContent,c,e),i=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Fr("scroll",r)}switch(n){case"input":H(r),X(r,s,!0);break;case"textarea":H(r),se(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=Xr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hi]=t,e[pi]=r,Io(e,t,!1,!1),t.stateNode=e;e:{switch(l=we(n,r),n){case"dialog":Fr("cancel",e),Fr("close",e),i=r;break;case"iframe":case"object":case"embed":Fr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Dr.length;i++)Fr(Dr[i],e);i=r;break;case"source":Fr("error",e),i=r;break;case"img":case"image":case"link":Fr("error",e),Fr("load",e),i=r;break;case"details":Fr("toggle",e),i=r;break;case"input":Z(e,r),i=Q(e,r),Fr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=O({},r,{value:void 0}),Fr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Fr("invalid",e)}for(s in ve(n,i),c=i)if(c.hasOwnProperty(s)){var d=c[s];"style"===s?ye(e,d):"dangerouslySetInnerHTML"===s?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===s?"string"===typeof d?("textarea"!==n||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=d&&"onScroll"===s&&Fr("scroll",e):null!=d&&w(e,s,d,l))}switch(n){case"input":H(e),X(e,r,!1);break;case"textarea":H(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ne(e,!!r.multiple,s,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Xr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ko(t),null;case 6:if(e&&null!=t.stateNode)Do(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=Qa(Ga.current),Qa(Ha.current),ua(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(s=r.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return Ko(t),null;case 13:if(zi(es),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ia&&null!==ra&&0!==(1&t.mode)&&0===(128&t.flags))ha(),pa(),t.flags|=98560,s=!1;else if(s=ua(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(a(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(a(317));s[hi]=t}else pa(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ko(t),s=!1}else null!==aa&&(oc(aa),aa=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&es.current)?0===Dl&&(Dl=3):yc())),null!==t.updateQueue&&(t.flags|=4),Ko(t),null);case 4:return Ya(),Ao(e,t),null===e&&Br(t.stateNode.containerInfo),Ko(t),null;case 10:return Sa(t.type._context),Ko(t),null;case 19:if(zi(es),null===(s=t.memoizedState))return Ko(t),null;if(r=0!==(128&t.flags),null===(l=s.rendering))if(r)Ho(s,!1);else{if(0!==Dl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ts(e))){for(t.flags|=128,Ho(s,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return _i(es,1&es.current|2),t.child}e=e.sibling}null!==s.tail&&Ye()>$l&&(t.flags|=128,r=!0,Ho(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ts(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ho(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ia)return Ko(t),null}else 2*Ye()-s.renderingStartTime>$l&&1073741824!==n&&(t.flags|=128,r=!0,Ho(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=s.last)?n.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ye(),t.sibling=null,n=es.current,_i(es,r?1&n|2:1&n),t):(Ko(t),null);case 22:case 23:return hc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Al)&&(Ko(t),6&t.subtreeFlags&&(t.flags|=8192)):Ko(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Qo(e,t){switch(ta(t),t.tag){case 1:return Ii(t.type)&&Ai(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ya(),zi(Ci),zi(Si),rs(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xa(t),null;case 13:if(zi(es),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));pa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return zi(es),null;case 4:return Ya(),null;case 10:return Sa(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Io=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ao=function(){},Mo=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Qa(Ha.current);var a,s=null;switch(n){case"input":i=Q(e,i),r=Q(e,r),s=[];break;case"select":i=O({},i,{value:void 0}),r=O({},r,{value:void 0}),s=[];break;case"textarea":i=re(e,i),r=re(e,r),s=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Xr)}for(d in ve(n,r),n=null,i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&null!=i[d])if("style"===d){var l=i[d];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(o.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var c=r[d];if(l=null!=i?i[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(s||(s=[]),s.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(o.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Fr("scroll",e),s||l===c||(s=[])):(s=s||[]).push(d,c))}n&&(s=s||[]).push("style",n);var d=s;(t.updateQueue=d)&&(t.flags|=4)}},Do=function(e,t,n,r){n!==r&&(t.flags|=4)};var Zo=!1,Yo=!1,Jo="function"===typeof WeakSet?WeakSet:Set,Xo=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){zc(e,t,r)}else n.current=null}function tl(e,t,n){try{n()}catch(r){zc(e,t,r)}}var nl=!1;function rl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&tl(t,n,a)}i=i.next}while(i!==r)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[pi],delete t[fi],delete t[yi],delete t[gi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Xr));else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function dl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(dl(e,t,n),e=e.sibling;null!==e;)dl(e,t,n),e=e.sibling}var ul=null,hl=!1;function pl(e,t,n){for(n=n.child;null!==n;)ml(e,t,n),n=n.sibling}function ml(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(it,n)}catch(o){}switch(n.tag){case 5:Yo||el(n,t);case 6:var r=ul,i=hl;ul=null,pl(e,t,n),hl=i,null!==(ul=r)&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),Bt(e)):li(ul,n.stateNode));break;case 4:r=ul,i=hl,ul=n.stateNode.containerInfo,hl=!0,pl(e,t,n),ul=r,hl=i;break;case 0:case 11:case 14:case 15:if(!Yo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var a=i,s=a.destroy;a=a.tag,void 0!==s&&(0!==(2&a)||0!==(4&a))&&tl(n,t,s),i=i.next}while(i!==r)}pl(e,t,n);break;case 1:if(!Yo&&(el(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){zc(n,t,o)}pl(e,t,n);break;case 21:pl(e,t,n);break;case 22:1&n.mode?(Yo=(r=Yo)||null!==n.memoizedState,pl(e,t,n),Yo=r):pl(e,t,n);break;default:pl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Jo),t.forEach((function(t){var r=Cc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function yl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(a(160));ml(s,o,i),ul=null,hl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(d){zc(i,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(yl(t,e),vl(e),4&r){try{rl(3,e,e.return),il(3,e)}catch(y){zc(e,e.return,y)}try{rl(5,e,e.return)}catch(y){zc(e,e.return,y)}}break;case 1:yl(t,e),vl(e),512&r&&null!==n&&el(n,n.return);break;case 5:if(yl(t,e),vl(e),512&r&&null!==n&&el(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(y){zc(e,e.return,y)}}if(4&r&&null!=(i=e.stateNode)){var s=e.memoizedProps,o=null!==n?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&Y(i,s),we(l,o);var d=we(l,s);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];"style"===u?ye(i,h):"dangerouslySetInnerHTML"===u?ue(i,h):"children"===u?he(i,h):w(i,u,h,d)}switch(l){case"input":J(i,s);break;case"textarea":ae(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;null!=m?ne(i,!!s.multiple,m,!1):p!==!!s.multiple&&(null!=s.defaultValue?ne(i,!!s.multiple,s.defaultValue,!0):ne(i,!!s.multiple,s.multiple?[]:"",!1))}i[pi]=s}catch(y){zc(e,e.return,y)}}break;case 6:if(yl(t,e),vl(e),4&r){if(null===e.stateNode)throw Error(a(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(y){zc(e,e.return,y)}}break;case 3:if(yl(t,e),vl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(y){zc(e,e.return,y)}break;case 4:default:yl(t,e),vl(e);break;case 13:yl(t,e),vl(e),8192&(i=e.child).flags&&(s=null!==i.memoizedState,i.stateNode.isHidden=s,!s||null!==i.alternate&&null!==i.alternate.memoizedState||(Bl=Ye())),4&r&&fl(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?(Yo=(d=Yo)||u,yl(t,e),Yo=d):yl(t,e),vl(e),8192&r){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Xo=e,u=e.child;null!==u;){for(h=Xo=u;null!==Xo;){switch(m=(p=Xo).child,p.tag){case 0:case 11:case 14:case 15:rl(4,p,p.return);break;case 1:el(p,p.return);var f=p.stateNode;if("function"===typeof f.componentWillUnmount){r=p,n=p.return;try{t=r,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(y){zc(r,n,y)}}break;case 5:el(p,p.return);break;case 22:if(null!==p.memoizedState){jl(h);continue}}null!==m?(m.return=p,Xo=m):jl(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{i=h.stateNode,d?"function"===typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=fe("display",o))}catch(y){zc(e,e.return,y)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(y){zc(e,e.return,y)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:yl(t,e),vl(e),4&r&&fl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),dl(e,ll(e),i);break;case 3:case 4:var s=r.stateNode.containerInfo;cl(e,ll(e),s);break;default:throw Error(a(161))}}catch(o){zc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function wl(e,t,n){Xo=e,xl(e,t,n)}function xl(e,t,n){for(var r=0!==(1&e.mode);null!==Xo;){var i=Xo,a=i.child;if(22===i.tag&&r){var s=null!==i.memoizedState||Zo;if(!s){var o=i.alternate,l=null!==o&&null!==o.memoizedState||Yo;o=Zo;var c=Yo;if(Zo=s,(Yo=l)&&!c)for(Xo=i;null!==Xo;)l=(s=Xo).child,22===s.tag&&null!==s.memoizedState?kl(i):null!==l?(l.return=s,Xo=l):kl(i);for(;null!==a;)Xo=a,xl(a,t,n),a=a.sibling;Xo=i,Zo=o,Yo=c}bl(e)}else 0!==(8772&i.subtreeFlags)&&null!==a?(a.return=i,Xo=a):bl(e)}}function bl(e){for(;null!==Xo;){var t=Xo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Yo||il(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Yo)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:no(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Wa(t,s,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Wa(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Bt(h)}}}break;default:throw Error(a(163))}Yo||512&t.flags&&al(t)}catch(p){zc(t,t.return,p)}}if(t===e){Xo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xo=n;break}Xo=t.return}}function jl(e){for(;null!==Xo;){var t=Xo;if(t===e){Xo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xo=n;break}Xo=t.return}}function kl(e){for(;null!==Xo;){var t=Xo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(l){zc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){zc(t,i,l)}}var a=t.return;try{al(t)}catch(l){zc(t,a,l)}break;case 5:var s=t.return;try{al(t)}catch(l){zc(t,s,l)}}}catch(l){zc(t,t.return,l)}if(t===e){Xo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Xo=o;break}Xo=t.return}}var Nl,zl=Math.ceil,_l=x.ReactCurrentDispatcher,El=x.ReactCurrentOwner,Sl=x.ReactCurrentBatchConfig,Cl=0,Tl=null,Pl=null,Il=0,Al=0,Ml=Ni(0),Dl=0,Rl=null,Ol=0,Ll=0,Fl=0,Ul=null,Vl=null,Bl=0,$l=1/0,Wl=null,ql=!1,Hl=null,Kl=null,Gl=!1,Ql=null,Zl=0,Yl=0,Jl=null,Xl=-1,ec=0;function tc(){return 0!==(6&Cl)?Ye():-1!==Xl?Xl:Xl=Ye()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Cl)&&0!==Il?Il&-Il:null!==fa.transition?(0===ec&&(ec=ft()),ec):0!==(e=wt)?e:e=void 0===(e=window.event)?16:Zt(e.type)}function rc(e,t,n,r){if(50<Yl)throw Yl=0,Jl=null,Error(a(185));gt(e,n,r),0!==(2&Cl)&&e===Tl||(e===Tl&&(0===(2&Cl)&&(Ll|=n),4===Dl&&lc(e,Il)),ic(e,r),1===n&&0===Cl&&0===(1&t.mode)&&($l=Ye()+500,Fi&&Bi()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-st(a),o=1<<s,l=i[s];-1===l?0!==(o&n)&&0===(o&r)||(i[s]=pt(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}(e,t);var r=ht(e,e===Tl?Il:0);if(0===r)null!==n&&Ge(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ge(n),1===t)0===e.tag?function(e){Fi=!0,Vi(e)}(cc.bind(null,e)):Vi(cc.bind(null,e)),si((function(){0===(6&Cl)&&Bi()})),n=null;else{switch(xt(r)){case 1:n=Xe;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Tc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Xl=-1,ec=0,0!==(6&Cl))throw Error(a(327));var n=e.callbackNode;if(kc()&&e.callbackNode!==n)return null;var r=ht(e,e===Tl?Il:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var i=Cl;Cl|=2;var s=fc();for(Tl===e&&Il===t||(Wl=null,$l=Ye()+500,pc(e,t));;)try{wc();break}catch(l){mc(e,l)}Ea(),_l.current=s,Cl=i,null!==Pl?t=0:(Tl=null,Il=0,t=Dl)}if(0!==t){if(2===t&&(0!==(i=mt(e))&&(r=i,t=sc(e,i))),1===t)throw n=Rl,pc(e,0),lc(e,r),ic(e,Ye()),n;if(6===t)lc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!or(a(),i))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=gc(e,r))&&(0!==(s=mt(e))&&(r=s,t=sc(e,s))),1===t))throw n=Rl,pc(e,0),lc(e,r),ic(e,Ye()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:jc(e,Vl,Wl);break;case 3:if(lc(e,r),(130023424&r)===r&&10<(t=Bl+500-Ye())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(jc.bind(null,e,Vl,Wl),t);break}jc(e,Vl,Wl);break;case 4:if(lc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-st(r);s=1<<o,(o=t[o])>i&&(i=o),r&=~s}if(r=i,10<(r=(120>(r=Ye()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*zl(r/1960))-r)){e.timeoutHandle=ri(jc.bind(null,e,Vl,Wl),r);break}jc(e,Vl,Wl);break;default:throw Error(a(329))}}}return ic(e,Ye()),e.callbackNode===n?ac.bind(null,e):null}function sc(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Vl,Vl=n,null!==t&&oc(t)),e}function oc(e){null===Vl?Vl=e:Vl.push.apply(Vl,e)}function lc(e,t){for(t&=~Fl,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(0!==(6&Cl))throw Error(a(327));kc();var t=ht(e,0);if(0===(1&t))return ic(e,Ye()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=mt(e);0!==r&&(t=r,n=sc(e,r))}if(1===n)throw n=Rl,pc(e,0),lc(e,t),ic(e,Ye()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,jc(e,Vl,Wl),ic(e,Ye()),null}function dc(e,t){var n=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=n)&&($l=Ye()+500,Fi&&Bi())}}function uc(e){null!==Ql&&0===Ql.tag&&0===(6&Cl)&&kc();var t=Cl;Cl|=1;var n=Sl.transition,r=wt;try{if(Sl.transition=null,wt=1,e)return e()}finally{wt=r,Sl.transition=n,0===(6&(Cl=t))&&Bi()}}function hc(){Al=Ml.current,zi(Ml)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Pl)for(n=Pl.return;null!==n;){var r=n;switch(ta(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ai();break;case 3:Ya(),zi(Ci),zi(Si),rs();break;case 5:Xa(r);break;case 4:Ya();break;case 13:case 19:zi(es);break;case 10:Sa(r.type._context);break;case 22:case 23:hc()}n=n.return}if(Tl=e,Pl=e=Mc(e.current,null),Il=Al=t,Dl=0,Rl=null,Fl=Ll=Ol=0,Vl=Ul=null,null!==Ia){for(t=0;t<Ia.length;t++)if(null!==(r=(n=Ia[t]).interleaved)){n.interleaved=null;var i=r.next,a=n.pending;if(null!==a){var s=a.next;a.next=i,r.next=s}n.pending=r}Ia=null}return e}function mc(e,t){for(;;){var n=Pl;try{if(Ea(),is.current=Js,ds){for(var r=os.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ds=!1}if(ss=0,cs=ls=os=null,us=!1,hs=0,El.current=null,null===n||null===n.return){Dl=1,Rl=t,Pl=null;break}e:{var s=e,o=n.return,l=n,c=t;if(t=Il,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=go(o);if(null!==m){m.flags&=-257,vo(m,o,l,0,t),1&m.mode&&yo(s,d,t),c=d;var f=(t=m).updateQueue;if(null===f){var y=new Set;y.add(c),t.updateQueue=y}else f.add(c);break e}if(0===(1&t)){yo(s,d,t),yc();break e}c=Error(a(426))}else if(ia&&1&l.mode){var g=go(o);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),vo(g,o,l,0,t),ma(co(c,l));break e}}s=c=co(c,l),4!==Dl&&(Dl=2),null===Ul?Ul=[s]:Ul.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Ba(s,mo(0,c,t));break e;case 1:l=c;var v=s.type,w=s.stateNode;if(0===(128&s.flags)&&("function"===typeof v.getDerivedStateFromError||null!==w&&"function"===typeof w.componentDidCatch&&(null===Kl||!Kl.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t,Ba(s,fo(s,l,t));break e}}s=s.return}while(null!==s)}bc(n)}catch(x){t=x,Pl===n&&null!==n&&(Pl=n=n.return);continue}break}}function fc(){var e=_l.current;return _l.current=Js,null===e?Js:e}function yc(){0!==Dl&&3!==Dl&&2!==Dl||(Dl=4),null===Tl||0===(268435455&Ol)&&0===(268435455&Ll)||lc(Tl,Il)}function gc(e,t){var n=Cl;Cl|=2;var r=fc();for(Tl===e&&Il===t||(Wl=null,pc(e,t));;)try{vc();break}catch(i){mc(e,i)}if(Ea(),Cl=n,_l.current=r,null!==Pl)throw Error(a(261));return Tl=null,Il=0,Dl}function vc(){for(;null!==Pl;)xc(Pl)}function wc(){for(;null!==Pl&&!Qe();)xc(Pl)}function xc(e){var t=Nl(e.alternate,e,Al);e.memoizedProps=e.pendingProps,null===t?bc(e):Pl=t,El.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Go(n,t,Al)))return void(Pl=n)}else{if(null!==(n=Qo(n,t)))return n.flags&=32767,void(Pl=n);if(null===e)return Dl=6,void(Pl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Pl=t);Pl=t=e}while(null!==t);0===Dl&&(Dl=5)}function jc(e,t,n){var r=wt,i=Sl.transition;try{Sl.transition=null,wt=1,function(e,t,n,r){do{kc()}while(null!==Ql);if(0!==(6&Cl))throw Error(a(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-st(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}(e,s),e===Tl&&(Pl=Tl=null,Il=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Gl||(Gl=!0,Tc(tt,(function(){return kc(),null}))),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Sl.transition,Sl.transition=null;var o=wt;wt=1;var l=Cl;Cl|=4,El.current=null,function(e,t){if(ei=Wt,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(b){n=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=e,p=null;t:for(;;){for(var m;h!==n||0!==i&&3!==h.nodeType||(l=o+i),h!==s||0!==r&&3!==h.nodeType||(c=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(m=h.firstChild);)p=h,h=m;for(;;){if(h===e)break t;if(p===n&&++d===i&&(l=o),p===s&&++u===r&&(c=o),null!==(m=h.nextSibling))break;p=(h=p).parentNode}h=m}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Wt=!1,Xo=t;null!==Xo;)if(e=(t=Xo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xo=e;else for(;null!==Xo;){t=Xo;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var y=f.memoizedProps,g=f.memoizedState,v=t.stateNode,w=v.getSnapshotBeforeUpdate(t.elementType===t.type?y:no(t.type,y),g);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(a(163))}}catch(b){zc(t,t.return,b)}if(null!==(e=t.sibling)){e.return=t.return,Xo=e;break}Xo=t.return}f=nl,nl=!1}(e,n),gl(n,e),mr(ti),Wt=!!ei,ti=ei=null,e.current=n,wl(n,e,i),Ze(),Cl=l,wt=o,Sl.transition=s}else e.current=n;if(Gl&&(Gl=!1,Ql=e,Zl=i),s=e.pendingLanes,0===s&&(Kl=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ic(e,Ye()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(ql)throw ql=!1,e=Hl,Hl=null,e;0!==(1&Zl)&&0!==e.tag&&kc(),s=e.pendingLanes,0!==(1&s)?e===Jl?Yl++:(Yl=0,Jl=e):Yl=0,Bi()}(e,t,n,r)}finally{Sl.transition=i,wt=r}return null}function kc(){if(null!==Ql){var e=xt(Zl),t=Sl.transition,n=wt;try{if(Sl.transition=null,wt=16>e?16:e,null===Ql)var r=!1;else{if(e=Ql,Ql=null,Zl=0,0!==(6&Cl))throw Error(a(331));var i=Cl;for(Cl|=4,Xo=e.current;null!==Xo;){var s=Xo,o=s.child;if(0!==(16&Xo.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Xo=d;null!==Xo;){var u=Xo;switch(u.tag){case 0:case 11:case 15:rl(8,u,s)}var h=u.child;if(null!==h)h.return=u,Xo=h;else for(;null!==Xo;){var p=(u=Xo).sibling,m=u.return;if(sl(u),u===d){Xo=null;break}if(null!==p){p.return=m,Xo=p;break}Xo=m}}}var f=s.alternate;if(null!==f){var y=f.child;if(null!==y){f.child=null;do{var g=y.sibling;y.sibling=null,y=g}while(null!==y)}}Xo=s}}if(0!==(2064&s.subtreeFlags)&&null!==o)o.return=s,Xo=o;else e:for(;null!==Xo;){if(0!==(2048&(s=Xo).flags))switch(s.tag){case 0:case 11:case 15:rl(9,s,s.return)}var v=s.sibling;if(null!==v){v.return=s.return,Xo=v;break e}Xo=s.return}}var w=e.current;for(Xo=w;null!==Xo;){var x=(o=Xo).child;if(0!==(2064&o.subtreeFlags)&&null!==x)x.return=o,Xo=x;else e:for(o=w;null!==Xo;){if(0!==(2048&(l=Xo).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(j){zc(l,l.return,j)}if(l===o){Xo=null;break e}var b=l.sibling;if(null!==b){b.return=l.return,Xo=b;break e}Xo=l.return}}if(Cl=i,Bi(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(it,e)}catch(j){}r=!0}return r}finally{wt=n,Sl.transition=t}}return!1}function Nc(e,t,n){e=Ua(e,t=mo(0,t=co(n,t),1),1),t=tc(),null!==e&&(gt(e,1,t),ic(e,t))}function zc(e,t,n){if(3===e.tag)Nc(e,e,n);else for(;null!==t;){if(3===t.tag){Nc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Kl||!Kl.has(r))){t=Ua(t,e=fo(t,e=co(n,e),1),1),e=tc(),null!==t&&(gt(t,1,e),ic(t,e));break}}t=t.return}}function _c(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Tl===e&&(Il&n)===n&&(4===Dl||3===Dl&&(130023424&Il)===Il&&500>Ye()-Bl?pc(e,0):Fl|=n),ic(e,t)}function Ec(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var n=tc();null!==(e=Da(e,t))&&(gt(e,t,n),ic(e,n))}function Sc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ec(e,n)}function Cc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Ec(e,n)}function Tc(e,t){return Ke(e,t)}function Pc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ic(e,t,n,r){return new Pc(e,t,n,r)}function Ac(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Mc(e,t){var n=e.alternate;return null===n?((n=Ic(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Dc(e,t,n,r,i,s){var o=2;if(r=e,"function"===typeof e)Ac(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case k:return Rc(n.children,i,s,t);case N:o=8,i|=8;break;case z:return(e=Ic(12,n,t,2|i)).elementType=z,e.lanes=s,e;case C:return(e=Ic(13,n,t,i)).elementType=C,e.lanes=s,e;case T:return(e=Ic(19,n,t,i)).elementType=T,e.lanes=s,e;case A:return Oc(n,i,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case _:o=10;break e;case E:o=9;break e;case S:o=11;break e;case P:o=14;break e;case I:o=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Ic(o,n,t,i)).elementType=e,t.type=r,t.lanes=s,t}function Rc(e,t,n,r){return(e=Ic(7,e,r,t)).lanes=n,e}function Oc(e,t,n,r){return(e=Ic(22,e,r,t)).elementType=A,e.lanes=n,e.stateNode={isHidden:!1},e}function Lc(e,t,n){return(e=Ic(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Ic(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yt(0),this.expirationTimes=yt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Vc(e,t,n,r,i,a,s,o,l){return e=new Uc(e,t,n,o,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Ic(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oa(a),e}function Bc(e){if(!e)return Ei;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ii(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Ii(n))return Di(e,n,t)}return t}function $c(e,t,n,r,i,a,s,o,l){return(e=Vc(n,r,!0,e,0,a,0,o,l)).context=Bc(null),n=e.current,(a=Fa(r=tc(),i=nc(n))).callback=void 0!==t&&null!==t?t:null,Ua(n,a,i),e.current.lanes=i,gt(e,i,r),ic(e,r),e}function Wc(e,t,n,r){var i=t.current,a=tc(),s=nc(i);return n=Bc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fa(a,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Ua(i,t,s))&&(rc(e,i,s,a),Va(e,i,s)),s}function qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kc(e,t){Hc(e,t),(e=e.alternate)&&Hc(e,t)}Nl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ci.current)xo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xo=!1,function(e,t,n){switch(t.tag){case 3:To(t),pa();break;case 5:Ja(t);break;case 1:Ii(t.type)&&Ri(t);break;case 4:Za(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;_i(ja,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(_i(es,1&es.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Lo(e,t,n):(_i(es,1&es.current),null!==(e=qo(e,t,n))?e.sibling:null);_i(es,1&es.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return $o(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),_i(es,es.current),r)break;return null;case 22:case 23:return t.lanes=0,zo(e,t,n)}return qo(e,t,n)}(e,t,n);xo=0!==(131072&e.flags)}else xo=!1,ia&&0!==(1048576&t.flags)&&Xi(t,Hi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Wo(e,t),e=t.pendingProps;var i=Pi(t,Si.current);Ta(t,n),i=ys(null,t,r,e,i,n);var s=gs();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ii(r)?(s=!0,Ri(t)):s=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Oa(t),i.updater=io,t.stateNode=i,i._reactInternals=t,lo(t,r,e,n),t=Co(null,t,r,!0,s,n)):(t.tag=0,ia&&s&&ea(t),bo(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Wo(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Ac(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===S)return 11;if(e===P)return 14}return 2}(r),e=no(r,e),i){case 0:t=Eo(null,t,r,e,n);break e;case 1:t=So(null,t,r,e,n);break e;case 11:t=jo(null,t,r,e,n);break e;case 14:t=ko(null,t,r,no(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Eo(e,t,r,i=t.elementType===r?i:no(r,i),n);case 1:return r=t.type,i=t.pendingProps,So(e,t,r,i=t.elementType===r?i:no(r,i),n);case 3:e:{if(To(t),null===e)throw Error(a(387));r=t.pendingProps,i=(s=t.memoizedState).element,La(e,t),$a(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Po(e,t,r,n,i=co(Error(a(423)),t));break e}if(r!==i){t=Po(e,t,r,n,i=co(Error(a(424)),t));break e}for(ra=ci(t.stateNode.containerInfo.firstChild),na=t,ia=!0,aa=null,n=ba(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pa(),r===i){t=qo(e,t,n);break e}bo(e,t,r,n)}t=t.child}return t;case 5:return Ja(t),null===e&&ca(t),r=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,o=i.children,ni(r,i)?o=null:null!==s&&ni(r,s)&&(t.flags|=32),_o(e,t),bo(e,t,o,n),t.child;case 6:return null===e&&ca(t),null;case 13:return Lo(e,t,n);case 4:return Za(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=xa(t,null,r,n):bo(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,jo(e,t,r,i=t.elementType===r?i:no(r,i),n);case 7:return bo(e,t,t.pendingProps,n),t.child;case 8:case 12:return bo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,_i(ja,r._currentValue),r._currentValue=o,null!==s)if(or(s.value,o)){if(s.children===i.children&&!Ci.current){t=qo(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){o=s.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===s.tag){(c=Fa(-1,n&-n)).tag=2;var d=s.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),Ca(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(a(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ca(o,n,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}bo(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ta(t,n),r=r(i=Pa(i)),t.flags|=1,bo(e,t,r,n),t.child;case 14:return i=no(r=t.type,t.pendingProps),ko(e,t,r,i=no(r.type,i),n);case 15:return No(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:no(r,i),Wo(e,t),t.tag=1,Ii(r)?(e=!0,Ri(t)):e=!1,Ta(t,n),so(t,r,i),lo(t,r,i,n),Co(null,t,r,!0,e,n);case 19:return $o(e,t,n);case 22:return zo(e,t,n)}throw Error(a(156,t.tag))};var Gc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Zc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function ed(e,t,n,r,i){var a=n._reactRootContainer;if(a){var s=a;if("function"===typeof i){var o=i;i=function(){var e=qc(s);o.call(e)}}Wc(t,s,e,i)}else s=function(e,t,n,r,i){if(i){if("function"===typeof r){var a=r;r=function(){var e=qc(s);a.call(e)}}var s=$c(t,r,e,0,null,!1,0,"",Xc);return e._reactRootContainer=s,e[mi]=s.current,Br(8===e.nodeType?e.parentNode:e),uc(),s}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var o=r;r=function(){var e=qc(l);o.call(e)}}var l=Vc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=l,e[mi]=l.current,Br(8===e.nodeType?e.parentNode:e),uc((function(){Wc(t,l,n,r)})),l}(n,t,e,i,r);return qc(s)}Zc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Wc(e,t,null,null)},Zc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){Wc(null,e,null,null)})),t[mi]=null}},Zc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Nt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<At.length&&0!==t&&t<At[n].priority;n++);At.splice(n,0,e),0===n&&Ot(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(vt(t,1|n),ic(t,Ye()),0===(6&Cl)&&($l=Ye()+500,Bi()))}break;case 13:uc((function(){var t=Da(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}})),Kc(e,1)}},jt=function(e){if(13===e.tag){var t=Da(e,134217728);if(null!==t)rc(t,e,134217728,tc());Kc(e,134217728)}},kt=function(e){if(13===e.tag){var t=nc(e),n=Da(e,t);if(null!==n)rc(n,e,t,tc());Kc(e,t)}},Nt=function(){return wt},zt=function(e,t){var n=wt;try{return wt=e,t()}finally{wt=n}},je=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=bi(r);if(!i)throw Error(a(90));K(r),J(r,i)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Se=dc,Ce=uc;var td={usingClientEntryPoint:!1,Events:[wi,xi,bi,_e,Ee,dc]},nd={findFiberByHostInstance:vi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rd={bundleType:nd.bundleType,version:nd.version,rendererPackageName:nd.rendererPackageName,rendererConfig:nd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:nd.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var id=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!id.isDisabled&&id.supportsFiber)try{it=id.inject(rd),at=id}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=td,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(a(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:j,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yc(e))throw Error(a(299));var n=!1,r="",i=Gc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Vc(e,1,!1,null,0,n,0,r,i),e[mi]=t.current,Br(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(a(200));return ed(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yc(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,i=!1,s="",o=Gc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=$c(t,null,e,1,null!=n?n:null,i,0,s,o),e[mi]=t.current,Br(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Zc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(a(200));return ed(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(a(40));return!!e._reactRootContainer&&(uc((function(){ed(null,null,e,!1,(function(){e._reactRootContainer=null,e[mi]=null}))})),!0)},t.unstable_batchedUpdates=dc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return ed(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},352:(e,t,n)=>{var r=n(119);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},414:(e,t,n)=>{e.exports=n(654)},654:(e,t,n)=>{var r=n(950),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,d=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)s.call(t,r)&&!l.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:d,props:a,_owner:o.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},761:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var o=2*(r+1)-1,l=e[o],c=o+1,d=e[c];if(0>a(l,n))c<i&&0>a(d,l)?(e[r]=d,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<i&&0>a(d,n)))break e;e[r]=d,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,p=3,m=!1,f=!1,y=!1,g="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(d);null!==t;){if(null===t.callback)i(d);else{if(!(t.startTime<=e))break;i(d),t.sortIndex=t.expirationTime,n(c,t)}t=r(d)}}function b(e){if(y=!1,x(e),!f)if(null!==r(c))f=!0,A(j);else{var t=r(d);null!==t&&M(b,t.startTime-e)}}function j(e,n){f=!1,y&&(y=!1,v(_),_=-1),m=!0;var a=p;try{for(x(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!C());){var s=h.callback;if("function"===typeof s){h.callback=null,p=h.priorityLevel;var o=s(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(c)&&i(c),x(n)}else i(c);h=r(c)}if(null!==h)var l=!0;else{var u=r(d);null!==u&&M(b,u.startTime-n),l=!1}return l}finally{h=null,p=a,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,N=!1,z=null,_=-1,E=5,S=-1;function C(){return!(t.unstable_now()-S<E)}function T(){if(null!==z){var e=t.unstable_now();S=e;var n=!0;try{n=z(!0,e)}finally{n?k():(N=!1,z=null)}}else N=!1}if("function"===typeof w)k=function(){w(T)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,I=P.port2;P.port1.onmessage=T,k=function(){I.postMessage(null)}}else k=function(){g(T,0)};function A(e){z=e,N||(N=!0,k())}function M(e,n){_=g((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||m||(f=!0,A(j))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,i,a){var s=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?s+a:s:a=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:i,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>s?(e.sortIndex=a,n(d,e),null===r(c)&&e===r(d)&&(y?(v(_),_=-1):y=!0,M(b,a-s))):(e.sortIndex=o,n(c,e),f||m||(f=!0,A(j))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},950:(e,t,n)=>{e.exports=n(49)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}();var r=n(950),i=n(352),a=n(414);const s={name:"Tw\xf3j Developer",cash:1e8,reputation:100,reputationHistory:[],reputationFactors:{legalCompliance:1,environmentalImpact:1,communityRelations:1,projectQuality:1,transparency:1,grayAreaActivity:1},activeReputationInitiatives:[],projects:[],rtbPower:0,totalPower:0,installedCapacity:0,rtbCapacity:0,staff:{lessors:[],developers:[],lawyers:[],envSpecialists:[],lobbyists:[]},illegals:{hasIllegalDatabase:!1,corruptionNetwork:0,intimidationPower:0,forgeryExpertise:0,auditRisk:20,lastAuditTurn:0,totalBribes:0,illegalActionHistory:[]},economicMetrics:{totalInvestment:0,totalRevenue:0,totalExpenses:0,avgROI:0,projectsCost:0,projectsValue:0},audits:{totalAudits:0,passedAudits:0,totalFines:0,lastAuditResult:null},loans:[],companyUpgrades:{}};function o(e,t){var n,r,i,a;switch(t.type){case"UPDATE_CASH":return{...e,cash:e.cash+t.payload};case"ADD_PROJECT":return{...e,projects:[...e.projects,t.payload],totalPower:e.totalPower+t.payload.power};case"UPDATE_PROJECT":return{...e,projects:e.projects.map((e=>e.id===t.payload.id?{...e,...t.payload.changes}:e))};case"SELL_PROJECT":return{...e,cash:e.cash+t.payload.price,projects:e.projects.filter((e=>e.id!==t.payload.projectId)),totalPower:e.totalPower-((null===(n=e.projects.find((e=>e.id===t.payload.projectId)))||void 0===n?void 0:n.power)||0),rtbPower:e.rtbPower-("ready_to_build"===(null===(r=e.projects.find((e=>e.id===t.payload.projectId)))||void 0===r?void 0:r.status)&&(null===(i=e.projects.find((e=>e.id===t.payload.projectId)))||void 0===i?void 0:i.power)||0),economicMetrics:{...e.economicMetrics,totalRevenue:e.economicMetrics.totalRevenue+t.payload.price,projectsValue:e.economicMetrics.projectsValue-((null===(a=e.projects.find((e=>e.id===t.payload.projectId)))||void 0===a?void 0:a.marketValue)||0)}};case"UPDATE_RTB_POWER":return{...e,rtbPower:e.rtbPower+t.payload};case"HIRE_STAFF":const s=t.payload.staffType.endsWith("s")?t.payload.staffType:`${t.payload.staffType}s`,o=e.staff[s]||[];return{...e,cash:e.cash-t.payload.cost,staff:{...e.staff,[s]:[...o,t.payload.staff]},economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+t.payload.cost}};case"FIRE_STAFF":const l=t.payload.staffType.endsWith("s")?t.payload.staffType:`${t.payload.staffType}s`;return{...e,cash:e.cash-t.payload.cost,staff:{...e.staff,[l]:(e.staff[l]||[]).filter((e=>e.id!==t.payload.staffId))},economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+t.payload.cost}};case"TRAIN_STAFF":const c=t.payload.staffType.endsWith("s")?t.payload.staffType:`${t.payload.staffType}s`;return{...e,cash:e.cash-t.payload.cost,staff:{...e.staff,[c]:(e.staff[c]||[]).map((e=>e.id===t.payload.staffId?{...e,skill:Math.min(10,e.skill+t.payload.skillGain),experience:e.experience+t.payload.experienceGain,training:[...e.training||[],{date:(new Date).toISOString(),type:t.payload.trainingType,cost:t.payload.cost,skillGain:t.payload.skillGain}]}:e))},economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+t.payload.cost}};case"UPDATE_STAFF":const d=t.payload.staffType.endsWith("s")?t.payload.staffType:`${t.payload.staffType}s`;return{...e,staff:{...e.staff,[d]:(e.staff[d]||[]).map((e=>e.id===t.payload.staffId?{...e,...t.payload.changes}:e))}};case"ASSIGN_STAFF_TO_PROJECT":return{...e,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,assignedStaff:{...e.assignedStaff||{},[t.payload.staffType]:t.payload.staffId}}:e)),staff:{...e.staff,[t.payload.staffType+"s"]:(e.staff[t.payload.staffType+"s"]||[]).map((e=>e.id===t.payload.staffId?{...e,assignedProject:t.payload.projectId,assignedSince:(new Date).toISOString()}:e))}};case"ADD_PROJECT_EVENT":return{...e,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,events:[...e.events,t.payload.event]}:e))};case"UPDATE_REPUTATION":return{...e,reputation:Math.max(0,Math.min(200,e.reputation+t.payload.change)),reputationHistory:[...e.reputationHistory,{date:(new Date).toISOString(),change:t.payload.change,reason:t.payload.reason,turn:t.payload.turn}]};case"USE_ILLEGAL_ACTION":return{...e,illegals:{...e.illegals,corruptionNetwork:t.payload.updateCorruption?Math.min(100,e.illegals.corruptionNetwork+t.payload.corruptionChange):e.illegals.corruptionNetwork,auditRisk:Math.min(100,e.illegals.auditRisk+t.payload.riskIncrease),totalBribes:e.illegals.totalBribes+(t.payload.bribeCost||0),illegalActionHistory:[...e.illegals.illegalActionHistory,{date:(new Date).toISOString(),type:t.payload.actionType,target:t.payload.target,cost:t.payload.bribeCost||0,turn:t.payload.turn}]},cash:e.cash-(t.payload.bribeCost||0),economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+(t.payload.bribeCost||0)}};case"TRIGGER_AUDIT":return{...e,illegals:{...e.illegals,auditRisk:Math.max(10,e.illegals.auditRisk-t.payload.riskReduction),lastAuditTurn:t.payload.turn},audits:{...e.audits,totalAudits:e.audits.totalAudits+1,passedAudits:t.payload.passed?e.audits.passedAudits+1:e.audits.passedAudits,totalFines:e.audits.totalFines+(t.payload.fine||0),lastAuditResult:{date:(new Date).toISOString(),turn:t.payload.turn,passed:t.payload.passed,fine:t.payload.fine||0,reputationLoss:t.payload.reputationLoss||0}},cash:e.cash-(t.payload.fine||0),economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+(t.payload.fine||0)}};case"UPDATE_PROJECT_MARKET_VALUE":return{...e,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,marketValue:t.payload.value}:e)),economicMetrics:{...e.economicMetrics,projectsValue:e.projects.reduce(((e,n)=>e+(n.id===t.payload.projectId?t.payload.value:n.marketValue||0)),0)}};case"UPDATE_PROJECT_TOTAL_COST":return{...e,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,totalCost:e.totalCost+t.payload.cost}:e)),economicMetrics:{...e.economicMetrics,totalInvestment:e.economicMetrics.totalInvestment+t.payload.cost,projectsCost:e.economicMetrics.projectsCost+t.payload.cost}};case"INITIALIZE_PROJECT_FORMAL_PARAMS":return{...e,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,formalParams:t.payload.params}:e))};case"UPDATE_ILLEGAL_DATABASE":return{...e,illegals:{...e.illegals,hasIllegalDatabase:t.payload.hasIllegalDatabase}};case"UPDATE_ILLEGALS_STATUS":return{...e,illegals:{...e.illegals,...t.payload}};case"ADD_ILLEGAL_HISTORY":return{...e,illegals:{...e.illegals,illegalActionHistory:[...e.illegals.illegalActionHistory,t.payload]}};case"ADD_ILLEGAL_ACTION":return{...e,cash:e.cash-t.payload.cost,illegals:{...e.illegals,auditRisk:Math.min(100,e.illegals.auditRisk+5),totalBribes:e.illegals.totalBribes+t.payload.cost,illegalActionHistory:[...e.illegals.illegalActionHistory,{date:(new Date).toISOString(),type:t.payload.type,target:t.payload.target,cost:t.payload.cost,turn:t.payload.turn,exposed:t.payload.exposed}]},economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+t.payload.cost}};case"ADD_LOAN":return{...e,loans:[...e.loans||[],t.payload],cash:e.cash+t.payload.amount};case"UPDATE_LOAN":return{...e,loans:(e.loans||[]).map((e=>e.id===t.payload.id?{...e,...t.payload.changes}:e))};case"REMOVE_LOAN":return{...e,loans:(e.loans||[]).filter((e=>e.id!==t.payload.id))};case"SEND_PROJECT_TO_MARKET":return e.projects.find((e=>e.id===t.payload.projectId))?{...e,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,isOnMarket:!0,marketPrice:t.payload.price,marketListingDate:(new Date).toISOString(),events:[...e.events,{date:(new Date).toISOString(),text:`Projekt zosta\u0142 wystawiony na rynek za ${t.payload.price.toLocaleString()} PLN`}]}:e))}:e;case"ACCELERATE_PROJECT":return e.projects.find((e=>e.id===t.payload.projectId))?{...e,cash:e.cash-t.payload.cost,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,progress:Math.min(100,(e.progress||0)+t.payload.progressGain),events:[...e.events,{date:(new Date).toISOString(),text:`Przyspieszono projekt o ${t.payload.progressGain}% za ${t.payload.cost.toLocaleString()} PLN`}]}:e)),economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+t.payload.cost,totalInvestment:e.economicMetrics.totalInvestment+t.payload.cost,projectsCost:e.economicMetrics.projectsCost+t.payload.cost}}:e;case"UPDATE_ECONOMIC_METRICS":return{...e,economicMetrics:{...e.economicMetrics,...t.payload}};case"PURCHASE_COMPANY_UPGRADE":return{...e,cash:e.cash-t.payload.cost,companyUpgrades:{...e.companyUpgrades||{},[t.payload.upgradeId]:t.payload.level}};case"UPDATE_PLAYER":case"LOAD_PLAYER":return{...e,...t.payload};case"UPDATE_STAFF_STRUCTURE":return{...e,staff:{...e.staff,...t.payload}};case"UPDATE_REPUTATION_FACTOR":return{...e,reputationFactors:{...e.reputationFactors,[t.payload.factor]:Math.max(.1,Math.min(2,e.reputationFactors[t.payload.factor]+t.payload.change))},reputationHistory:[...e.reputationHistory,{date:(new Date).toISOString(),type:"factor_change",factor:t.payload.factor,change:t.payload.change,reason:t.payload.reason,turn:t.payload.turn}]};case"START_REPUTATION_INITIATIVE":const u=e.activeReputationInitiatives.findIndex((e=>e.type===t.payload.initiative.type));if(-1!==u){const n=[...e.activeReputationInitiatives],r=n[u];return n[u]={...r,intensity:r.intensity+.5*t.payload.initiative.intensity,duration:Math.max(r.duration,t.payload.initiative.duration),cost:r.cost+t.payload.initiative.cost},{...e,activeReputationInitiatives:n,cash:e.cash-t.payload.initiative.cost}}return{...e,activeReputationInitiatives:[...e.activeReputationInitiatives,{...t.payload.initiative,startDate:(new Date).toISOString(),remainingDuration:t.payload.initiative.duration}],cash:e.cash-t.payload.initiative.cost};case"UPDATE_REPUTATION_INITIATIVES":const h=t.payload.daysPassed||1;let p=0,m={};const f=e.activeReputationInitiatives.map((e=>{const t=e.remainingDuration-h;if(e.continuousEffects)for(const n of e.continuousEffects)n.reputationPerDay&&(p+=n.reputationPerDay*h),n.factorChange&&n.factorPerDay&&(m[n.factorChange]=(m[n.factorChange]||0)+n.factorPerDay*h);if(t<=0){if(e.finalEffects)for(const t of e.finalEffects)t.reputationChange&&(p+=t.reputationChange),t.factorChange&&t.factorAmount&&(m[t.factorChange]=(m[t.factorChange]||0)+t.factorAmount);return null}return{...e,remainingDuration:t}})).filter(Boolean),y={...e.reputationFactors};for(const[e,t]of Object.entries(m))y[e]=Math.max(.1,Math.min(2,y[e]+t));return{...e,reputation:Math.max(0,Math.min(200,e.reputation+p)),reputationFactors:y,activeReputationInitiatives:f,reputationHistory:[...e.reputationHistory,...0!==p?[{date:(new Date).toISOString(),change:p,reason:"Efekt inicjatyw reputacyjnych",turn:t.payload.turn}]:[],...Object.entries(m).map((e=>{let[n,r]=e;return{date:(new Date).toISOString(),type:"factor_change",factor:n,change:r,reason:"Efekt inicjatyw reputacyjnych",turn:t.payload.turn}}))]};default:return e}}const l=(0,r.createContext)(),c=e=>{let{children:t}=e;const[n,i]=(0,r.useReducer)(o,s);return(0,a.jsx)(l.Provider,{value:{state:n,dispatch:i},children:t})},d=()=>{const e=(0,r.useContext)(l);if(!e)throw new Error("usePlayerContext musi by\u0107 u\u017cywany wewn\u0105trz PlayerProvider");return e},u=[{id:"competitor1",name:"GreenPower Polska",power:8e3,rtbPower:2e3,growth:1.1,strongRegions:["mazowieckie","wielkopolskie","slaskie"],strategy:"aggressive",reputation:70,description:"Najwi\u0119kszy deweloper OZE w Polsce, agresywnie rozwijaj\u0105cy sw\xf3j portfel projekt\xf3w. Koncentruje si\u0119 na du\u017cych farmach fotowoltaicznych i wiatrowych w centralnej i zachodniej Polsce.",focusTechnologies:["PV","WF"],foundedYear:2010},{id:"competitor2",name:"SolarTech",power:5e3,rtbPower:1500,growth:1.2,strongRegions:["malopolskie","podkarpackie","lubelskie"],strategy:"balanced",reputation:65,description:"Firma specjalizuj\u0105ca si\u0119 w projektach fotowoltaicznych, z rosn\u0105cym zainteresowaniem magazynami energii. Dzia\u0142a g\u0142\xf3wnie w po\u0142udniowo-wschodniej Polsce.",focusTechnologies:["PV","BESS"],foundedYear:2015},{id:"competitor3",name:"WindForce",power:6e3,rtbPower:1800,growth:1.15,strongRegions:["pomorskie","zachodniopomorskie","warminsko-mazurskie"],strategy:"conservative",reputation:80,description:"Do\u015bwiadczony deweloper farm wiatrowych z siln\u0105 pozycj\u0105 w p\xf3\u0142nocnej Polsce. Znany z wysokiej jako\u015bci projekt\xf3w i dobrych relacji z lokalnymi spo\u0142eczno\u015bciami.",focusTechnologies:["WF"],foundedYear:2008},{id:"competitor4",name:"EnergyStorage Systems",power:3e3,rtbPower:900,growth:1.25,strongRegions:["lodzkie","mazowieckie","slaskie"],strategy:"aggressive",reputation:60,description:"Nowy, szybko rozwijaj\u0105cy si\u0119 gracz specjalizuj\u0105cy si\u0119 w magazynach energii. Agresywnie pozyskuje lokalizacje w pobli\u017cu du\u017cych o\u015brodk\xf3w przemys\u0142owych i w\u0119z\u0142\xf3w energetycznych.",focusTechnologies:["BESS","PV"],foundedYear:2018},{id:"competitor5",name:"EcoEnergy",power:4500,rtbPower:1200,growth:1.05,strongRegions:["wielkopolskie","lubuskie","dolnoslaskie"],strategy:"conservative",reputation:75,description:"Stabilna firma z d\u0142ug\u0105 histori\u0105 na rynku OZE, dzia\u0142aj\u0105ca g\u0142\xf3wnie w zachodniej Polsce. Ostro\u017cnie podchodzi do nowych projekt\xf3w, ale ma solidny portfel aktyw\xf3w.",focusTechnologies:["PV","WF"],foundedYear:2005}],h=(e,t)=>{if(!t||!Array.isArray(t)||0===t.length)return null;const n=["land_acquisition","project_development","market_expansion","technology_shift","acquisition"],r=n[Math.floor(Math.random()*n.length)];let i={id:Date.now(),competitorId:e.id,competitorName:e.name,type:r,title:"",description:"",effects:[],regions:[]};switch(r){case"land_acquisition":const n=e.strongRegions[Math.floor(Math.random()*e.strongRegions.length)],r=t.find((e=>e.id===n));if(!r)return h(e,t);const a=Math.floor(30+50*Math.random());i.title=`${e.name} pozyskuje grunty w regionie ${r.name}`,i.description=`Konkurent zabezpieczy\u0142 ${a} ha grunt\xf3w pod nowy projekt OZE.`,i.effects.push({type:"regional_land_availability",value:.95,regionId:n}),i.regions.push(n);break;case"project_development":const s=Math.floor(20+60*Math.random()),o=e.focusTechnologies[Math.floor(Math.random()*e.focusTechnologies.length)];i.title=`${e.name} rozwija nowy projekt ${o}`,i.description=`Konkurent og\u0142osi\u0142 rozw\xf3j nowego projektu ${o} o mocy ${s} MW.`,i.effects.push({type:"competitor_power",value:s,competitorId:e.id});break;case"market_expansion":const l=t.filter((t=>!e.strongRegions.includes(t.id)));if(!(l.length>0))return h(e,t);{const t=l[Math.floor(Math.random()*l.length)];i.title=`${e.name} wchodzi na rynek w regionie ${t.name}`,i.description="Konkurent rozpoczyna dzia\u0142alno\u015b\u0107 w nowym regionie, zwi\u0119kszaj\u0105c konkurencj\u0119.",i.effects.push({type:"regional_competition",value:1.1,regionId:t.id}),i.regions.push(t.id)}break;case"technology_shift":const c=["PV","WF","BESS"].filter((t=>!e.focusTechnologies.includes(t)));if(!(c.length>0))return h(e,t);{const t=c[Math.floor(Math.random()*c.length)];i.title=`${e.name} wchodzi w now\u0105 technologi\u0119: ${t}`,i.description=`Konkurent og\u0142osi\u0142 strategiczn\u0105 decyzj\u0119 o rozwoju projekt\xf3w w technologii ${t}.`,i.effects.push({type:"competitor_technology",value:t,competitorId:e.id})}break;case"acquisition":i.title=`${e.name} przejmuje mniejszego dewelopera`,i.description="Konkurent og\u0142osi\u0142 przej\u0119cie mniejszej firmy deweloperskiej, zwi\u0119kszaj\u0105c sw\xf3j portfel projekt\xf3w.";const d=Math.floor(500+1e3*Math.random());i.effects.push({type:"competitor_power_boost",value:d,competitorId:e.id});break;default:return null}return i},p={marketModifier:{min:.7,max:1.5},permitTimeModifier:{min:.5,max:2},buildCostModifier:{min:.6,max:1.8},loanInterestRate:{min:.7,max:1.5},staffCostModifier:{min:.8,max:1.3},reputationChange:{min:-30,max:30},riskLevel:{min:-10,max:10},grayAreaImpact:{min:-25,max:25},projectEfficiency:{min:-20,max:30},staffProductivity:{min:-25,max:40}},m=(e,t)=>{if(!p[e])return t;const{min:n,max:r}=p[e];return Math.max(n,Math.min(r,t))},f=e=>{if(!e)return{};const t={};for(const[n,r]of Object.entries(e))t[n]="object"!==typeof r?m(n,r):r;if(e.regionalEffect){t.regionalEffect={...e.regionalEffect};for(const[n,r]of Object.entries(e.regionalEffect))"region"!==n&&(t.regionalEffect[n]=m(n,r))}if(e.technologyEffect){t.technologyEffect={...e.technologyEffect};for(const[n,r]of Object.entries(e.technologyEffect))"technology"!==n&&(t.technologyEffect[n]=m(n,r))}return t},y=e=>{const t={marketModifier:{min:.6,max:2},permitTimeModifier:{min:.4,max:2.5},buildCostModifier:{min:.5,max:2},loanInterestRate:{min:.5,max:2},staffCostModifier:{min:.7,max:1.5}},n={...e};for(const[r,i]of Object.entries(e))if(t[r]){const{min:e,max:a}=t[r];n[r]=Math.max(e,Math.min(a,i))}return n};class g{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.id=e||Date.now()+Math.random(),this.name=t,this.description=n,this.duration=r,this.image=i,this.startDate=null,this.expiryDate=null}activate(e){this.startDate=new Date(e);const t=new Date(e);return t.setDate(t.getDate()+this.duration),this.expiryDate=t,this}isExpired(e){return!!this.expiryDate&&e>this.expiryDate}getEffect(){return{}}}class v extends g{constructor(e,t,n,r,i){super(e,t,n,r,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="economic",this.effects=i}getEffect(){return this.effects}}class w extends g{constructor(e,t,n,r,i){super(e,t,n,r,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="political",this.effects=i}getEffect(){return this.effects}}class x extends g{constructor(e,t,n,r,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;super(e,t,n,r,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null),this.type="social",this.effects=i,this.region=a}getEffect(){const e={...this.effects};return this.region&&(e.regionalEffect={region:this.region,...e.regionalEffect}),e}}class b extends g{constructor(e,t,n,r,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;super(e,t,n,r,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null),this.type="environmental",this.effects=i,this.region=a}getEffect(){const e={...this.effects};return this.region&&(e.regionalEffect={region:this.region,...e.regionalEffect}),e}}class j extends g{constructor(e,t,n,r,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;super(e,t,n,r,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null),this.type="technological",this.effects=i,this.technology=a}getEffect(){const e={...this.effects};return this.technology&&(e.technologyEffect={technology:this.technology,...e.technologyEffect}),e}}class k extends g{constructor(e,t,n,r,i){super(e,t,n,r,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="media",this.effects=i}getEffect(){return this.effects}}class N extends g{constructor(e,t,n,r,i){super(e,t,n,r,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="regulatory",this.effects=i}getEffect(){return this.effects}}new j("quantum_battery","Prze\u0142om: Bateria kwantowa","Naukowcy z polskiego instytutu dokonali prze\u0142omu w technologii baterii kwantowych. Ta rewolucyjna technologia mo\u017ce zmieni\u0107 oblicze energetyki.",365,{investmentOpportunity:{cost:5e6,successChance:.4,potentialReturn:12,technologyAdvantage:3},energyStorageRevolution:!0,marketDisruption:.3}).rarity={weight:1,color:"#f59e0b"};const z=[new v("econ_1","Wzrost cen pr\u0105du na rynku","Ceny energii elektrycznej na rynku wzros\u0142y o 15%, zwi\u0119kszaj\u0105c atrakcyjno\u015b\u0107 projekt\xf3w OZE.",30,{marketModifier:1.15,permitTimeModifier:1}),new v("econ_2","Spadek cen pr\u0105du na rynku","Ceny energii elektrycznej na rynku spad\u0142y o 10%, zmniejszaj\u0105c op\u0142acalno\u015b\u0107 projekt\xf3w OZE.",21,{marketModifier:.9,permitTimeModifier:1}),new v("econ_3","Wzrost st\xf3p procentowych","NBP podni\xf3s\u0142 stopy procentowe, co utrudnia finansowanie projekt\xf3w i zwi\u0119ksza koszty kredyt\xf3w.",60,{buildCostModifier:1.1,marketModifier:.95}),new v("econ_4","Kryzys na rynku surowc\xf3w","Globalny kryzys na rynku surowc\xf3w zwi\u0119ksza koszty budowy farm PV i wiatrowych.",45,{buildCostModifier:1.2,marketModifier:1.05}),new v("econ_5","Nowe fundusze UE dla OZE","Unia Europejska uruchomi\u0142a nowe fundusze na rozw\xf3j OZE, co zwi\u0119ksza warto\u015b\u0107 projekt\xf3w.",90,{marketModifier:1.2,buildCostModifier:.95,reputationChange:5}),new v("eco_6","Dotacje dla hybryd PV+BESS","Rz\u0105d wprowadzi\u0142 program dotacji pokrywaj\u0105cy 30% koszt\xf3w magazyn\xf3w energii w projektach hybrydowych.",120,{marketModifier:1.2,permitTimeModifier:.9,technologyEffect:{technology:"BESS",marketModifier:1.3}}),new v("eco_7","Ulgi podatkowe dla inwestor\xf3w OZE","Wprowadzono 50% odliczenia VAT dla firm inwestuj\u0105cych w projekty energetyki odnawialnej.",180,{marketModifier:1.15,permitTimeModifier:.85}),new v("eco_8","Aukcje CPPA","Wprowadzono system d\u0142ugoterminowych kontrakt\xf3w dla przemys\u0142u, umo\u017cliwiaj\u0105cych stabilne finansowanie projekt\xf3w OZE.",150,{marketModifier:1.25}),new v("eco_9",'Program "Prosument 3.0"',"Nowy program rz\u0105dowy oferuje dotacje do 60% dla mikroinstalacji fotowoltaicznych.",90,{technologyEffect:{technology:"PV",marketModifier:1.2}}),new v("eco_10","C\u0142a na komponenty","Wprowadzono 20% c\u0142o na panele fotowoltaiczne z Chin, podnosz\u0105c koszty inwestycji.",120,{technologyEffect:{technology:"PV",marketModifier:.85,buildCostModifier:1.2},severity:"negative"})],_=[new w("pol_1","Nowelizacja ustawy o OZE","Sejm przyj\u0105\u0142 nowelizacj\u0119 ustawy o OZE, kt\xf3ra upraszcza procedury administracyjne.",120,{permitTimeModifier:.8,reputationChange:3}),new w("pol_2","Zaostrzenie wymaga\u0144 \u015brodowiskowych","Nowe przepisy zaostrzaj\u0105 wymagania dotycz\u0105ce ocen oddzia\u0142ywania na \u015brodowisko.",90,{permitTimeModifier:1.3,reputationChange:-2}),new w("pol_3","Reforma systemu aukcyjnego","Rz\u0105d zreformowa\u0142 system aukcyjny OZE, wprowadzaj\u0105c korzystniejsze zasady dla inwestor\xf3w.",180,{marketModifier:1.1,permitTimeModifier:.9,reputationChange:5}),new w("pol_4","Ograniczenie dotacji dla OZE","Rz\u0105d ograniczy\u0142 dotacje dla nowych projekt\xf3w OZE, co zmniejsza ich op\u0142acalno\u015b\u0107.",150,{marketModifier:.85,reputationChange:-3}),new w("pol_5","Nowe cele klimatyczne","Polska przyj\u0119\u0142a ambitniejsze cele klimatyczne, zwi\u0119kszaj\u0105c zapotrzebowanie na OZE.",210,{marketModifier:1.15,reputationChange:7}),new w("pol_6",'Ustawa "Fast-track"',"Sejm przyj\u0105\u0142 ustaw\u0119 znacz\u0105co skracaj\u0105c\u0105 proces pozwole\u0144 dla projekt\xf3w OZE z 5 do 2 lat.",365,{permitTimeModifier:.6,reputationChange:5}),new w("pol_7","Krajowy Plan Modernizacji Sieci","Rz\u0105d przeznaczy\u0142 10 mld z\u0142 na rozbudow\u0119 infrastruktury przesy\u0142owej, zwi\u0119kszaj\u0105c mo\u017cliwo\u015bci przy\u0142\u0105czeniowe.",240,{permitTimeModifier:.75,buildCostModifier:.9}),new w("pol_8","Strategia wodorowa","Przyj\u0119to strategi\u0119 rozwoju wodoru z OZE z celem 2 GW mocy do 2030 roku.",180,{marketModifier:1.15}),new w("pol_9","Zmiana ustawy odleg\u0142o\u015bciowej","Wprowadzono zakaz budowy wiatrak\xf3w w promieniu 1 km od zabudowa\u0144, co utrudnia rozw\xf3j energetyki wiatrowej.",300,{technologyEffect:{technology:"WF",marketModifier:.7,permitTimeModifier:1.5},severity:"negative"}),new w("pol_10","Op\xf3\u017anienie offshore","Brak ustawy o morskiej energetyce wstrzymuje projekty o \u0142\u0105cznej mocy 10 GW.",150,{technologyEffect:{technology:"WF",marketModifier:.8},severity:"negative"})],E=[new x("soc_1","Protesty przeciwko farmom wiatrowym","W wielu regionach kraju nasili\u0142y si\u0119 protesty lokalnych spo\u0142eczno\u015bci przeciwko farmom wiatrowym.",60,{permitTimeModifier:1.2,reputationChange:-3}),new x("soc_2","Wzrost poparcia dla OZE","Badania pokazuj\u0105 rekordowy wzrost poparcia spo\u0142ecznego dla energetyki odnawialnej.",90,{permitTimeModifier:.9,reputationChange:4}),new x("soc_3","Lokalna kampania przeciwko PV","W wojew\xf3dztwie ma\u0142opolskim rozwin\u0119\u0142a si\u0119 kampania przeciwko wielkoobszarowym farmom PV.",45,{regionalEffect:{permitTimeModifier:1.3}},"ma\u0142opolskie"),new x("soc_4","Program edukacyjny o OZE","Ministerstwo Klimatu uruchomi\u0142o og\xf3lnopolski program edukacyjny na temat korzy\u015bci z OZE.",120,{permitTimeModifier:.95,reputationChange:2}),new x("soc_5","Konflikt o turbiny przy wybrze\u017cu","Nasili\u0142 si\u0119 konflikt mi\u0119dzy rybakami a inwestorami farm wiatrowych na Ba\u0142tyku.",75,{regionalEffect:{permitTimeModifier:1.4}},"pomorskie"),new x("soc_6","Subsydia dla mieszka\u0144c\xf3w",'Program "Energia dla Spo\u0142eczno\u015bci" oferuje darmowe instalacje PV w zamian za zgod\u0119 na farmy wiatrowe.',120,{permitTimeModifier:.8,reputationChange:5}),new x("soc_7","Nowe miejsca pracy","Budowa farmy wiatrowej 50 MW stworzy\u0142a 100 sta\u0142ych miejsc pracy w regionie.",90,{reputationChange:3,technologyEffect:{technology:"WF",marketModifier:1.1}},"zachodniopomorskie"),new x("soc_8","Programy edukacyjne OZE",'Warsztaty "Zielona Gmina" w szko\u0142ach, finansowane przez deweloper\xf3w, zwi\u0119kszaj\u0105 spo\u0142eczn\u0105 akceptacj\u0119 projekt\xf3w.',150,{permitTimeModifier:.9,reputationChange:2}),new x("soc_9","Protesty NIMBY","Blokada budowy farmy wiatrowej przez mieszka\u0144c\xf3w gminy wzbudzi\u0142a obawy inwestor\xf3w.",60,{permitTimeModifier:1.3,reputationChange:-4,technologyEffect:{technology:"WF",marketModifier:.9}},"ma\u0142opolskie"),new x("soc_10","Bunt spo\u0142eczno\u015bci","Mieszka\u0144cy blokuj\u0105 wjazd ci\u0119\u017car\xf3wek na plac budowy farmy fotowoltaicznej.",45,{buildCostModifier:1.2,permitTimeModifier:1.4,reputationChange:-3},"podkarpackie")],S=[new b("env_1","Rekordowo s\u0142oneczne lato","Tegoroczne lato przynios\u0142o rekordow\u0105 liczb\u0119 dni s\u0142onecznych, co zwi\u0119ksza wydajno\u015b\u0107 PV.",90,{technologyEffect:{technology:"PV",marketModifier:1.1}}),new b("env_2","Silne wiatry na p\xf3\u0142nocy","Na p\xf3\u0142nocy Polski utrzymuj\u0105 si\u0119 wyj\u0105tkowo silne wiatry, zwi\u0119kszaj\u0105c potencja\u0142 farm wiatrowych.",60,{regionalEffect:{marketModifier:1.15},technologyEffect:{technology:"WF",marketModifier:1.1}},"pomorskie"),new b("env_3","Susze w centralnej Polsce","D\u0142ugotrwa\u0142e susze w centralnej Polsce powoduj\u0105 konflikty o wykorzystanie grunt\xf3w.",75,{regionalEffect:{permitTimeModifier:1.2}},"mazowieckie"),new b("env_4","Odkrycie cennego gatunku ptak\xf3w","W wojew\xf3dztwie podlaskim odkryto rzadki gatunek ptak\xf3w, co komplikuje projekty OZE.",120,{regionalEffect:{permitTimeModifier:1.5}},"podlaskie"),new b("env_5","Wysoki poziom zanieczyszczenia powietrza","Zim\u0105 odnotowano rekordowo wysokie poziomy zanieczyszczenia powietrza, co zwi\u0119ksza poparcie dla OZE.",60,{permitTimeModifier:.9,reputationChange:3}),new b("env_6","Korytarze bior\xf3\u017cnorodno\u015bci","Wsp\xf3\u0142projekty z ekologami, w tym tworzenie pasiek przy farmach PV, zwi\u0119kszaj\u0105 akceptacj\u0119 \u015brodowiskow\u0105.",120,{permitTimeModifier:.85,reputationChange:3,technologyEffect:{technology:"PV",buildCostModifier:1.05}}),new b("env_7","Ekstremalne warunki pogodowe","Gradobicie uszkodzi\u0142o znaczn\u0105 cz\u0119\u015b\u0107 paneli fotowoltaicznych w centralnej Polsce.",45,{buildCostModifier:1.2,technologyEffect:{technology:"PV",marketModifier:.9}},"\u0142\xf3dzkie"),new b("env_8","\u015amiertelno\u015b\u0107 ptak\xf3w","Aktywi\u015bci zaskar\u017cyli dewelopera za zabijanie chronionych gatunk\xf3w ptak\xf3w przez turbiny wiatrowe.",90,{permitTimeModifier:1.3,reputationChange:-3,technologyEffect:{technology:"WF",marketModifier:.85}},"warmi\u0144sko-mazurskie"),new b("env_9","Odkrycie cennego gatunku","W wojew\xf3dztwie lubelskim odkryto rzadki gatunek ro\u015blin, co komplikuje projekty OZE w regionie.",150,{regionalEffect:{permitTimeModifier:1.4}},"lubelskie"),new b("env_10","Degradacja \u015brodowiska","Wycinka 50 ha lasu pod farm\u0119 PV wywo\u0142a\u0142a skandal ekologiczny.",75,{permitTimeModifier:1.5,reputationChange:-5,technologyEffect:{technology:"PV",marketModifier:.8}})],C=[new j("tech_1","Prze\u0142om w wydajno\u015bci paneli PV","Naukowcy opracowali now\u0105 technologi\u0119 zwi\u0119kszaj\u0105c\u0105 wydajno\u015b\u0107 paneli fotowoltaicznych o 25%.",150,{technologyEffect:{technology:"PV",buildCostModifier:.9,marketModifier:1.15}},"PV"),new j("tech_2","Nowa generacja turbin wiatrowych","Na rynek wesz\u0142a nowa generacja turbin wiatrowych o lepszej wydajno\u015bci i ni\u017cszej emisji ha\u0142asu.",180,{technologyEffect:{technology:"WF",buildCostModifier:.85,marketModifier:1.2}},"WF"),new j("tech_3","Innowacje w magazynach energii","Prze\u0142omowe innowacje w technologii magazyn\xf3w energii zwi\u0119kszaj\u0105 ich op\u0142acalno\u015b\u0107.",120,{technologyEffect:{technology:"BESS",buildCostModifier:.8,marketModifier:1.3}},"BESS"),new j("tech_4","Problemy jako\u015bciowe z chi\u0144skimi panelami","Wykryto problemy jako\u015bciowe w panelach fotowoltaicznych importowanych z Chin.",90,{technologyEffect:{technology:"PV",buildCostModifier:1.15,marketModifier:.9}},"PV"),new j("tech_5","Nowy system prognozowania wiatru","Opracowano nowy system prognozowania wiatru, zwi\u0119kszaj\u0105cy efektywno\u015b\u0107 farm wiatrowych.",100,{technologyEffect:{technology:"WF",marketModifier:1.1}},"WF"),new j("tech_6","Innowacyjne trackery PV","Nowe systemy \u015bledzenia s\u0142o\u0144ca zwi\u0119kszaj\u0105 wydajno\u015b\u0107 paneli fotowoltaicznych o 25%.",180,{technologyEffect:{technology:"PV",buildCostModifier:.85,marketModifier:1.2}}),new j("tech_7","Hybrydyzacja OZE","Po\u0142\u0105czenie PV z wiatrem redukuje LCOE o 18%, zwi\u0119kszaj\u0105c op\u0142acalno\u015b\u0107 projekt\xf3w.",150,{buildCostModifier:.9,marketModifier:1.15}),new j("tech_8","Optymalizacja BESS","Nowe algorytmy zarz\u0105dzania zmniejszaj\u0105 straty energii w magazynach o 12%.",120,{technologyEffect:{technology:"BESS",marketModifier:1.25}}),new j("tech_9","Partnerstwo z Google","Wdro\u017cenie AI do prognozowania produkcji energii zwi\u0119ksza efektywno\u015b\u0107 zarz\u0105dzania farmami.",90,{marketModifier:1.1}),new j("tech_10","Awaria technologii","Magazyn BESS eksplodowa\u0142 z powodu b\u0142\u0119d\xf3w projektowych, wywo\u0142uj\u0105c obawy inwestor\xf3w.",60,{technologyEffect:{technology:"BESS",marketModifier:.75,buildCostModifier:1.3},severity:"negative"})];class T extends g{constructor(e,t,n,r,i,a){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;super(e,t,n,r,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null),this.type="local",this.effects=i,this.region=a,this.county=s}getEffect(){const e={...this.effects};return this.region&&(e.regionalEffect={region:this.region,...e.regionalEffect}),this.county&&(e.countyEffect={region:this.region,county:this.county,...e.countyEffect}),e}}const P=[new T("local_1","Modernizacja infrastruktury","Deweloperzy finansuj\u0105 remont dr\xf3g dojazdowych w gminie, zwi\u0119kszaj\u0105c przychylno\u015b\u0107 mieszka\u0144c\xf3w.",90,{permitTimeModifier:.8,reputationChange:3},"ma\u0142opolskie","krakowski"),new T("local_2","Wzrost przychod\xf3w gminy","Dodatkowe 500 000 z\u0142/rok z podatk\xf3w od farmy 20 MW zwi\u0119kszy\u0142o poparcie lokalnych w\u0142adz.",120,{permitTimeModifier:.7,reputationChange:4},"mazowieckie","p\u0142ocki"),new T("local_3","Projekty spo\u0142eczne","Budowa \u015bwietlicy i si\u0142owni plenerowej w zamian za zgod\u0119 na inwestycj\u0119 OZE.",180,{permitTimeModifier:.75,reputationChange:5},"podlaskie","bia\u0142ostocki"),new T("local_4","Klastry energii","Gminy \u0142\u0105cz\u0105 si\u0119 w lokalny system energetyczny, zwi\u0119kszaj\u0105c mo\u017cliwo\u015bci przy\u0142\u0105czeniowe.",150,{permitTimeModifier:.85,buildCostModifier:.9},"\u015bl\u0105skie","cz\u0119stochowski"),new T("local_5","Konflikty o grunty","W\u0142a\u015bciciele ziemi \u017c\u0105daj\u0105 podwy\u017cek czynszu o 300%, co utrudnia pozyskiwanie grunt\xf3w.",60,{buildCostModifier:1.3,permitTimeModifier:1.2},"wielkopolskie","pozna\u0144ski"),new T("local_6","Brak przy\u0142\u0105czy","Operator odmawia pod\u0142\u0105czenia farmy z powodu przeci\u0105\u017cenia sieci w regionie.",90,{permitTimeModifier:1.5},"\u0142\xf3dzkie","\u0142\xf3dzki wschodni"),new T("local_7","Spadek warto\u015bci nieruchomo\u015bci","Domy w pobli\u017cu farmy wiatrowej straci\u0142y 20% warto\u015bci, wywo\u0142uj\u0105c protesty mieszka\u0144c\xf3w.",75,{permitTimeModifier:1.3,reputationChange:-4},"pomorskie","s\u0142upski")];class I extends g{constructor(e,t,n,r,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;super(e,t,n,r,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null),this.type="project",this.effects=i,this.technology=a}getEffect(){const e={...this.effects};return this.technology&&(e.technologyEffect={technology:this.technology,...e.technologyEffect}),e}}const A=[new I("proj_1","Finansowanie z UE","Uzyskano grant 15 mln z\u0142 z Funduszu Sp\xf3jno\u015bci na budow\u0119 magazynu energii.",90,{buildCostModifier:.7,technologyEffect:{marketModifier:1.2}},"BESS"),new I("proj_2","Digital Twin","Cyfrowy model farmy zmniejsza ryzyko awarii o 40%, zwi\u0119kszaj\u0105c warto\u015b\u0107 projektu.",120,{marketModifier:1.15},"PV"),new I("proj_3","Certyfikat ESG","Uzyskanie ratingu AA+ przyci\u0105ga inwestor\xf3w i zwi\u0119ksza warto\u015b\u0107 projektu.",150,{marketModifier:1.2,reputationChange:3}),new I("proj_4","Recykling na miejscu","Mobilne zak\u0142ady przetwarzania zu\u017cytych paneli zwi\u0119kszaj\u0105 ekologiczno\u015b\u0107 projektu.",180,{marketModifier:1.1,reputationChange:4},"PV"),new I("proj_5","Op\xf3\u017anienie pozwole\u0144","Decyzja \u015brodowiskowa przeci\u0105ga si\u0119 o 18 miesi\u0119cy z powodu protest\xf3w ekolog\xf3w.",90,{permitTimeModifier:1.6}),new I("proj_6","Bank wycofuje finansowanie","Podwy\u017cka st\xf3p procentowych spowodowa\u0142a wycofanie si\u0119 banku z finansowania projektu.",60,{marketModifier:.8,buildCostModifier:1.2}),new I("proj_7","Wzrost sk\u0142adek ubezpieczeniowych","Po huraganie koszt polisy dla farm PV wzr\xf3s\u0142 o 200%.",120,{buildCostModifier:1.15},"PV")],M=[new v("land_war","Wojna surowcowa","Rolnicy masowo wstrzymuj\u0105 sprzeda\u017c ziemi z powodu rosn\u0105cych cen \u017cywno\u015bci. Zd\u0105\u017cysz pozyska\u0107 grunty przed kolejn\u0105 podwy\u017ck\u0105?",90,{leaseRate:1.3,projectType:"all",description:"Koszt dzier\u017cawy wzr\xf3s\u0142 o 30% w tym regionie"})],D=[...z,..._,...E,...S,...C,...P,...A,...M],R=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=[...D];if(e&&(t=t.filter((t=>t.type===e))),0===t.length)return null;return t[Math.floor(Math.random()*t.length)]},O=e=>{if(!e.effects)return"info";let t=0;return e.effects.marketModifier&&(t+=10*(e.effects.marketModifier-1)),e.effects.reputationChange&&(t+=e.effects.reputationChange/5),e.effects.permitTimeModifier&&(t-=10*(e.effects.permitTimeModifier-1)),e.effects.buildCostModifier&&(t-=10*(e.effects.buildCostModifier-1)),e.effects.riskLevel&&(t-=e.effects.riskLevel),e.effects.grayAreaImpact&&(t-=e.effects.grayAreaImpact/5),t>2?"positive":t<-2?"negative":t<-.5||t>.5?"warning":"info"},L=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const i=[],a=r?r.turn:null,s=(r?r.date:new Date,r&&r.day,{});return Object.entries({economic:.3,political:.25,social:.28,environmental:.27,technological:.24,local:.35,project:.3}).forEach((e=>{let[t,r]=e;s[t]=1-Math.pow(1-r,1/n)})),e&&Object.entries(e).forEach((e=>{let[t,n]=e;void 0!==s[t]&&(s[t]*=n)})),Object.entries(s).forEach((e=>{let[r,s]=e;for(let o=0;o<n;o++)if(Math.random()<s){const e=R(r);if(e){const n=new Date;if(e.effects&&(e.effects=f(e.effects)),i.push(e.activate(n)),t){const n={id:e.id||Date.now()+Math.random(),type:e.type,title:e.name,description:e.description,severity:O(e),turn:a||(new Date).getTime(),expires:a?a+Math.ceil(e.duration/2):Math.ceil(e.duration/2)};e.effects&&(n.effects={...e.effects}),e.region?(n.region=e.region,n.scope="regional"):n.scope="national",e.technology&&(n.technology=e.technology),e.projectType&&(n.projectType=e.projectType);Math.random()<.2&&(n.requiresDecision=!0,n.severity="special",n.decisions=[{id:"option1",label:"Opcja 1",effects:{reputationImpact:5}},{id:"option2",label:"Opcja 2",effects:{cashImpact:1e4}}]),t({type:"ADD_EVENT",payload:n})}}}})),i};F=new x("corruption_discovery","Korupcja w urz\u0119dzie","Tw\xf3j pracownik odkry\u0142 dowody na korupcj\u0119 w lokalnym urz\u0119dzie przy wydawaniu pozwole\u0144 dla OZE. Co zrobisz?",30,{decisions:[{id:"report",label:"Zg\u0142o\u015b spraw\u0119",reputation:10,permitTimeModifier:1.3},{id:"bribe",label:"Wykorzystaj sytuacj\u0119",reputation:-20,permitTimeModifier:.6,riskLevel:.7},{id:"ignore",label:"Zignoruj spraw\u0119",reputation:-5}]}),U={report:[new k("media_exposure","Sprawa w mediach","Twoje zg\u0142oszenie doprowadzi\u0142o do medialnego rozg\u0142osu wok\xf3\u0142 korupcji. Jeste\u015b postrzegany jako etyczna firma w bran\u017cy.",120,{reputationChange:15,marketAdvantage:.05,competitorRelations:-.1}),new w("investigation_started","Dochodzenie antykorupcyjne","CBA wszcz\u0119\u0142o dochodzenie w sprawie korupcji w urz\u0119dzie. Wszystkie pozwolenia s\u0105 teraz dok\u0142adniej sprawdzane.",180,{permitTimeModifier:1.2,permitSuccess:1.1})],bribe:[new T("expedited_permits","Przyspieszone pozwolenia","Twoje projekty otrzymuj\u0105 szybk\u0105 \u015bcie\u017ck\u0119, ale dzia\u0142asz na granicy prawa.",90,{permitTimeModifier:.5,riskEventChance:.3}),new class extends g{constructor(e,t,n,r,i){super(e,t,n,r,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="risk",this.effects=i}getEffect(){return this.effects}}("corruption_investigation","Dochodzenie antykorupcyjne","Twoje nieetyczne dzia\u0142ania wysz\u0142y na jaw. Firma stoi w obliczu powa\u017cnych konsekwencji prawnych.",null,{reputationChange:-50,legalFees:1e6,permitBlock:!0,projectFreeze:!0},.4)],ignore:[new class extends g{constructor(e,t,n,r,i){super(e,t,n,r,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="industry",this.effects=i}getEffect(){return this.effects}}("industry_perception","Z\u0142a reputacja bran\u017cy","Korupcja w bran\u017cy OZE nasila si\u0119. Spo\u0142ecze\u0144stwo coraz bardziej sceptycznie podchodzi do nowych projekt\xf3w.",365,{socialAcceptance:-.1,permitDifficulty:1.1})]};var F,U;new class extends g{constructor(e,t,n,r,i){super(e,t,n,null),this.type="dilemma",this.options=r,this.consequences=i,this.decisionMade=!1}makeDecision(e,t){if(this.decisionMade)return null;this.decisionMade=!0;this.options.find((t=>t.id===e));return t.playerDecisions.push({dilemmaId:this.id,decision:e,turn:t.turn}),this.consequences[e]}}("wetlands_project","Projekt na terenach podmok\u0142ych","Znalaz\u0142e\u015b idealn\u0105 lokalizacj\u0119 na farm\u0119 wiatrow\u0105, ale jest to cenny ekosystem podmok\u0142y, dom dla wielu rzadkich gatunk\xf3w. Eksperci \u015brodowiskowi apeluj\u0105 o ochron\u0119 tego terenu.",[{id:"protect",label:"Zrezygnuj z projektu i chro\u0144 ekosystem",description:"Zyskasz uznanie ekolog\xf3w, ale stracisz doskona\u0142\u0105 lokalizacj\u0119 biznesow\u0105."},{id:"relocate",label:"Zmodyfikuj projekt, by zminimalizowa\u0107 wp\u0142yw",description:"Kompromisowe rozwi\u0105zanie z mniejszym zyskiem, ale zachowaniem cz\u0119\u015bci ekosystemu."},{id:"develop",label:"Kontynuuj projekt zgodnie z planem",description:"Maksymalizuj zyski, ignoruj\u0105c sprzeciw ekolog\xf3w."}],{protect:{reputationChange:25,environmentalScore:30,investmentLoss:2e5,permitsEase:1.2,followUpEvents:["eco_partnership_offer"]},relocate:{reputationChange:10,environmentalScore:15,projectEfficiency:.85,investmentIncrease:15e4,permitsEase:1.05},develop:{reputationChange:-20,environmentalScore:-25,projectEfficiency:1,permitRisk:.4,followUpEvents:["eco_protest_campaign","media_backlash"]}});new class{constructor(e,t,n,r,i){this.id=e,this.name=t,this.description=n,this.trigger=r,this.stages=i,this.currentStage=0,this.isActive=!1,this.isCompleted=!1}checkTrigger(e,t){if(this.isActive||this.isCompleted)return!1;return!!this.trigger(e,t)&&(this.isActive=!0,this.stages[0])}progressToNextStage(e){return!this.isActive||this.isCompleted?null:(this.currentStage++,this.currentStage>=this.stages.length?(this.isCompleted=!0,this.isActive=!1,null):this.stages[this.currentStage])}}("green_revolution","Zielona Rewolucja Energetyczna","Seria wydarze\u0144 zwi\u0105zanych z prze\u0142omem w polityce energetycznej kraju.",((e,t)=>t.operationalProjects>=5&&e.turn>50),[new w("energy_policy_shift","Zmiana polityki energetycznej","Rz\u0105d og\u0142asza ambitny plan transformacji energetycznej z naciskiem na OZE. To mo\u017ce by\u0107 szansa dla Twojej firmy.",180,{marketGrowth:.2,subsidiesIncrease:.15,publicOpinion:20}),new k("public_debate","Debata publiczna o OZE","W ca\u0142ym kraju toczy si\u0119 intensywna debata o przysz\u0142o\u015bci energetyki. Tw\xf3j g\u0142os mo\u017ce by\u0107 znacz\u0105cy.",90,{decision:[{id:"advocate",label:"Aktywnie wspieraj zmiany",effect:{publicVisibility:.3,politicalInfluence:.2,cost:5e5}},{id:"neutral",label:"Zachowaj neutralno\u015b\u0107",effect:{}}]}),new v("investment_boom","Boom inwestycyjny w OZE","Banki i fundusze inwestycyjne masowo kieruj\u0105 kapita\u0142 w stron\u0119 zielonej energii.",365,{financingCost:.8,investorInterest:.4,competitionIntensity:1.3}),new N("new_regulations","Nowe regulacje OZE","Parlament przyj\u0105\u0142 pakiet ustaw znacz\u0105co upraszczaj\u0105cych procedury dla projekt\xf3w odnawialnych.",730,{permitTime:.6,gridConnectionEase:1.4,complianceRequirements:["Konieczno\u015b\u0107 certyfikacji zr\xf3wnowa\u017conego rozwoju","Obowi\u0105zkowy udzia\u0142 spo\u0142eczno\u015bci lokalnej w zyskach","Roczne audyty \u015brodowiskowe"]}),new class extends g{constructor(e,t,n,r,i){super(e,t,n,r,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="market",this.effects=i}getEffect(){return this.effects}}("market_maturity","Dojrza\u0142o\u015b\u0107 rynku OZE","Polski rynek OZE osi\u0105gn\u0105\u0142 dojrza\u0142o\u015b\u0107. Konkurencja jest intensywna, ale stabilne zasady gry tworz\u0105 przewidywalne \u015brodowisko biznesowe.",null,{marketStability:.4,profitMargins:.85,innovationPremium:.25})]);const V=(0,r.createContext)(),B={events:[{id:"initial-event-1",type:"economic_event",title:"Pocz\u0105tek dzia\u0142alno\u015bci",description:"Rozpoczynasz swoj\u0105 przygod\u0119 w sektorze OZE. Powodzenia!",severity:"positive",turn:1,expires:10},{id:"initial-event-2",type:"staff_event",title:"Zatrudnienie pierwszych pracownik\xf3w",description:"Czas zbudowa\u0107 zesp\xf3\u0142, kt\xf3ry b\u0119dzie realizowa\u0142 Twoje projekty.",severity:"info",turn:1,expires:8},{id:"initial-event-3",type:"project_event",title:"Rynek OZE w Polsce",description:"Rynek OZE w Polsce dynamicznie si\u0119 rozwija. To dobry moment na inwestycje.",severity:"info",turn:1,expires:12}],filters:{type:"all",severity:"all",staffId:null,projectId:null}};function $(e,t){switch(t.type){case"ADD_EVENT":{let n=[...e.events];if(n.length>=20&&(n.sort(((e,t)=>"info"===e.severity&&"info"!==t.severity?-1:"info"!==e.severity&&"info"===t.severity?1:e.turn-t.turn)),n.shift()),"info"===t.payload.severity){if(n.filter((e=>"info"===e.severity)).length>=5){const e=n.findIndex((e=>"info"===e.severity));-1!==e&&n.splice(e,1)}}if("staff_event"===(t.payload.type||"other")){if(n.filter((e=>"staff_event"===e.type)).length>=3){const e=n.findIndex((e=>"staff_event"===e.type));-1!==e&&n.splice(e,1)}}return{...e,events:[...n,t.payload]}}case"REMOVE_EVENT":return{...e,events:e.events.filter((e=>e.id!==t.payload))};case"CLEAR_EXPIRED_EVENTS":return{...e,events:e.events.filter((e=>!e.expires||e.expires>t.payload.currentTurn))};case"SET_FILTER":return{...e,filters:{...e.filters,[t.payload.filterType]:t.payload.value}};case"CLEAR_FILTERS":return{...e,filters:{type:"all",severity:"all",staffId:null,projectId:null}};case"LIMIT_EVENTS":{let t=[...e.events];t.length>20&&(t.sort(((e,t)=>"project_event"===e.type&&"project_event"!==t.type?1:"project_event"!==e.type&&"project_event"===t.type||"staff_event"===e.type&&"staff_event"!==t.type?-1:"staff_event"!==e.type&&"staff_event"===t.type?1:"info"===e.severity&&"info"!==t.severity?-1:"info"!==e.severity&&"info"===t.severity?1:e.turn-t.turn)),t=t.slice(t.length-20));const n=t.filter((e=>"info"===e.severity));if(n.length>5){n.sort(((e,t)=>e.turn-t.turn));const e=n.slice(0,n.length-5).map((e=>e.id));t=t.filter((t=>!("info"===t.severity&&e.includes(t.id))))}const r=t.filter((e=>"staff_event"===e.type));if(r.length>3){r.sort(((e,t)=>e.turn-t.turn));const e=new Set(r.slice(0,r.length-3).map((e=>e.id)));t=t.filter((t=>"staff_event"!==t.type||!e.has(t.id)))}return{...e,events:t}}default:return e}}function W(e){let{children:t}=e;const[n,i]=(0,r.useReducer)($,B);return(0,a.jsx)(V.Provider,{value:{state:n,dispatch:i},children:t})}function q(){const e=(0,r.useContext)(V);if(!e)throw new Error("useEventsContext must be used within an EventsProvider");return e}const H=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},K={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],a=i+1<e.length,s=a?e[i+1]:0,o=i+2<e.length,l=o?e[i+2]:0,c=t>>2,d=(3&t)<<4|s>>4;let u=(15&s)<<2|l>>6,h=63&l;o||(h=64,a||(u=64)),r.push(n[c],n[d],n[u],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(H(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){const a=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{const a=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&a)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0;++i;const s=i<e.length?n[e.charAt(i)]:64;++i;const o=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==a||null==s||null==o)throw new G;const l=t<<2|a>>4;if(r.push(l),64!==s){const e=a<<4&240|s>>2;if(r.push(e),64!==o){const e=s<<6&192|o;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class G extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Q=function(e){return function(e){const t=H(e);return K.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Z=function(e){try{return K.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};const Y=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,J=()=>{try{return Y()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/oze-developer-manager",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_NODE_ENV:"development"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&Z(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},X=e=>{var t,n;return null===(n=null===(t=J())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},ee=()=>{var e;return null===(e=J())||void 0===e?void 0:e.config},te=e=>{var t;return null===(t=J())||void 0===t?void 0:t[`_${e}`]};class ne{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function re(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function ie(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function ae(){return!function(){var e;const t=null===(e=J())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function se(){try{return"object"===typeof indexedDB}catch(e){return!1}}function oe(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}))}class le extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,le.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ce.prototype.create)}}class ce{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,r=this.errors[e],i=r?function(e,t){return e.replace(de,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(r,t):"Error",a=`${this.serviceName}: ${i} (${n}).`;return new le(n,a,t)}}const de=/\{\$([^}]+)}/g;function ue(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],a=t[i];if(he(n)&&he(a)){if(!ue(n,a))return!1}else if(n!==a)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function he(e){return null!==e&&"object"===typeof e}function pe(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function me(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function fe(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class ye{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=ge),void 0===r.error&&(r.error=ge),void 0===r.complete&&(r.complete=ge);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function ge(){}function ve(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3)*Math.pow(t,e),r=Math.round(.5*n*(Math.random()-.5)*2);return Math.min(144e5,n+r)}function we(e){return e&&e._delegate?e._delegate:e}class xe{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const be="[DEFAULT]";class je{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new ne;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:be})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,a]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&a.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===be?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(a){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be;return this.component?this.component.multipleInstances?e:be:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class ke{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new je(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const Ne=[];var ze;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(ze||(ze={}));const _e={debug:ze.DEBUG,verbose:ze.VERBOSE,info:ze.INFO,warn:ze.WARN,error:ze.ERROR,silent:ze.SILENT},Ee=ze.INFO,Se={[ze.DEBUG]:"log",[ze.VERBOSE]:"log",[ze.INFO]:"info",[ze.WARN]:"warn",[ze.ERROR]:"error"},Ce=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=Se[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var i=arguments.length,a=new Array(i>2?i-2:0),s=2;s<i;s++)a[s-2]=arguments[s];console[r](`[${n}]  ${e.name}:`,...a)};class Te{constructor(e){this.name=e,this._logLevel=Ee,this._logHandler=Ce,this._userLogHandler=null,Ne.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ze))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?_e[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ze.DEBUG,...t),this._logHandler(this,ze.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ze.VERBOSE,...t),this._logHandler(this,ze.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ze.INFO,...t),this._logHandler(this,ze.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ze.WARN,...t),this._logHandler(this,ze.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ze.ERROR,...t),this._logHandler(this,ze.ERROR,...t)}}let Pe,Ie;const Ae=new WeakMap,Me=new WeakMap,De=new WeakMap,Re=new WeakMap,Oe=new WeakMap;let Le={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Me.get(e);if("objectStoreNames"===t)return e.objectStoreNames||De.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ve(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Fe(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Ie||(Ie=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Be(this),n),Ve(Ae.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Ve(e.apply(Be(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const a=e.call(Be(this),t,...r);return De.set(a,t.sort?t.sort():[t]),Ve(a)}}function Ue(e){return"function"===typeof e?Fe(e):(e instanceof IDBTransaction&&function(e){if(Me.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=()=>{t(),r()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)}));Me.set(e,t)}(e),t=e,(Pe||(Pe=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,Le):e);var t}function Ve(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",a)},i=()=>{t(Ve(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",a)}));return t.then((t=>{t instanceof IDBCursor&&Ae.set(t,e)})).catch((()=>{})),Oe.set(t,e),t}(e);if(Re.has(e))return Re.get(e);const t=Ue(e);return t!==e&&(Re.set(e,t),Oe.set(t,e)),t}const Be=e=>Oe.get(e);function $e(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=indexedDB.open(e,t),o=Ve(s);return r&&s.addEventListener("upgradeneeded",(e=>{r(Ve(s.result),e.oldVersion,e.newVersion,Ve(s.transaction),e)})),n&&s.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),o.then((e=>{a&&e.addEventListener("close",(()=>a())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}const We=["get","getKey","getAll","getAllKeys","count"],qe=["put","add","delete","clear"],He=new Map;function Ke(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(He.get(t))return He.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=qe.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!We.includes(n))return;const a=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let a=t.store;for(var s=arguments.length,o=new Array(s>1?s-1:0),l=1;l<s;l++)o[l-1]=arguments[l];return r&&(a=a.index(o.shift())),(await Promise.all([a[n](...o),i&&t.done]))[0]};return He.set(t,a),a}Le=(e=>({...e,get:(t,n,r)=>Ke(t,n)||e.get(t,n,r),has:(t,n)=>!!Ke(t,n)||e.has(t,n)}))(Le);class Ge{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const Qe="@firebase/app",Ze="0.10.13",Ye=new Te("@firebase/app"),Je="@firebase/app-compat",Xe="@firebase/analytics-compat",et="@firebase/analytics",tt="@firebase/app-check-compat",nt="@firebase/app-check",rt="@firebase/auth",it="@firebase/auth-compat",at="@firebase/database",st="@firebase/data-connect",ot="@firebase/database-compat",lt="@firebase/functions",ct="@firebase/functions-compat",dt="@firebase/installations",ut="@firebase/installations-compat",ht="@firebase/messaging",pt="@firebase/messaging-compat",mt="@firebase/performance",ft="@firebase/performance-compat",yt="@firebase/remote-config",gt="@firebase/remote-config-compat",vt="@firebase/storage",wt="@firebase/storage-compat",xt="@firebase/firestore",bt="@firebase/vertexai-preview",jt="@firebase/firestore-compat",kt="firebase",Nt="[DEFAULT]",zt={[Qe]:"fire-core",[Je]:"fire-core-compat",[et]:"fire-analytics",[Xe]:"fire-analytics-compat",[nt]:"fire-app-check",[tt]:"fire-app-check-compat",[rt]:"fire-auth",[it]:"fire-auth-compat",[at]:"fire-rtdb",[st]:"fire-data-connect",[ot]:"fire-rtdb-compat",[lt]:"fire-fn",[ct]:"fire-fn-compat",[dt]:"fire-iid",[ut]:"fire-iid-compat",[ht]:"fire-fcm",[pt]:"fire-fcm-compat",[mt]:"fire-perf",[ft]:"fire-perf-compat",[yt]:"fire-rc",[gt]:"fire-rc-compat",[vt]:"fire-gcs",[wt]:"fire-gcs-compat",[xt]:"fire-fst",[jt]:"fire-fst-compat",[bt]:"fire-vertex","fire-js":"fire-js",[kt]:"fire-js-all"},_t=new Map,Et=new Map,St=new Map;function Ct(e,t){try{e.container.addComponent(t)}catch(n){Ye.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Tt(e){const t=e.name;if(St.has(t))return Ye.debug(`There were multiple attempts to register component ${t}.`),!1;St.set(t,e);for(const n of _t.values())Ct(n,e);for(const n of Et.values())Ct(n,e);return!0}function Pt(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function It(e){return void 0!==e.settings}const At=new ce("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Mt{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new xe("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw At.create("app-deleted",{appName:this._name})}}const Dt="10.14.1";function Rt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:Nt,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw At.create("bad-app-name",{appName:String(i)});if(n||(n=ee()),!n)throw At.create("no-options");const a=_t.get(i);if(a){if(ue(n,a.options)&&ue(r,a.config))return a;throw At.create("duplicate-app",{appName:i})}const s=new ke(i);for(const l of St.values())s.addComponent(l);const o=new Mt(n,r,s);return _t.set(i,o),o}function Ot(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nt;const t=_t.get(e);if(!t&&e===Nt&&ee())return Rt();if(!t)throw At.create("no-app",{appName:e});return t}function Lt(e,t,n){var r;let i=null!==(r=zt[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const a=i.match(/\s|\//),s=t.match(/\s|\//);if(a||s){const e=[`Unable to register library "${i}" with version "${t}":`];return a&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Ye.warn(e.join(" "))}Tt(new xe(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}const Ft="firebase-heartbeat-store";let Ut=null;function Vt(){return Ut||(Ut=$e("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Ft)}catch(n){console.warn(n)}}}).catch((e=>{throw At.create("idb-open",{originalErrorMessage:e.message})}))),Ut}async function Bt(e,t){try{const n=(await Vt()).transaction(Ft,"readwrite"),r=n.objectStore(Ft);await r.put(t,$t(e)),await n.done}catch(n){if(n instanceof le)Ye.warn(n.message);else{const e=At.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});Ye.warn(e.message)}}}function $t(e){return`${e.name}!${e.options.appId}`}class Wt{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Ht(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=qt();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return;return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}catch(n){Ye.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=qt(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),Kt(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Kt(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=Q(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return Ye.warn(t),""}}}function qt(){return(new Date).toISOString().substring(0,10)}class Ht{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!se()&&oe().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await Vt()).transaction(Ft),n=await t.objectStore(Ft).get($t(e));return await t.done,n}catch(t){if(t instanceof le)Ye.warn(t.message);else{const e=At.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});Ye.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Bt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Bt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Kt(e){return Q(JSON.stringify({version:2,heartbeats:e})).length}var Gt;Gt="",Tt(new xe("platform-logger",(e=>new Ge(e)),"PRIVATE")),Tt(new xe("heartbeat",(e=>new Wt(e)),"PRIVATE")),Lt(Qe,Ze,Gt),Lt(Qe,Ze,"esm2017"),Lt("fire-js","");Lt("firebase","10.14.1","app");function Qt(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function Zt(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Yt=Zt,Jt=new ce("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Xt=new Te("@firebase/auth");function en(e){if(Xt.logLevel<=ze.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Xt.error(`Auth (${Dt}): ${e}`,...n)}}function tn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw sn(e,...n)}function nn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return sn(e,...n)}function rn(e,t,n){const r=Object.assign(Object.assign({},Yt()),{[t]:n});return new ce("auth","Firebase",r).create(t,{appName:e.name})}function an(e){return rn(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function sn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return Jt.create(e,...n)}function on(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw sn(t,...r)}}function ln(e){const t="INTERNAL ASSERTION FAILED: "+e;throw en(t),new Error(t)}function cn(e,t){e||ln(t)}function dn(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function un(){return"http:"===hn()||"https:"===hn()}function hn(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class pn{constructor(e,t){this.shortDelay=e,this.longDelay=t,cn(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(re())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(un()||ie()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function mn(e,t){cn(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class fn{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void ln("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void ln("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void ln("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const yn={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},gn=new pn(3e4,6e4);function vn(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function wn(e,t,n,r){return xn(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let i={},a={};r&&("GET"===t?a=r:i={body:JSON.stringify(r)});const s=pe(Object.assign({key:e.config.apiKey},a)).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:o},i);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),fn.fetch()(jn(e,e.config.apiHost,n,s),l)}))}async function xn(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},yn),t);try{const t=new Nn(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw zn(e,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const t=i.ok?a.errorMessage:a.error.message,[n,s]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw zn(e,"credential-already-in-use",a);if("EMAIL_EXISTS"===n)throw zn(e,"email-already-in-use",a);if("USER_DISABLED"===n)throw zn(e,"user-disabled",a);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw rn(e,o,s);tn(e,o)}}catch(i){if(i instanceof le)throw i;tn(e,"network-request-failed",{message:String(i)})}}async function bn(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const a=await wn(e,t,n,r,i);return"mfaPendingCredential"in a&&tn(e,"multi-factor-auth-required",{_serverResponse:a}),a}function jn(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?mn(e.config,i):`${e.config.apiScheme}://${i}`}function kn(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Nn{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(nn(this.auth,"network-request-failed"))),gn.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function zn(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=nn(e,t,r);return i.customData._tokenResponse=n,i}function _n(e){return void 0!==e&&void 0!==e.enterprise}class En{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return kn(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function Sn(e,t){return wn(e,"GET","/v2/recaptchaConfig",vn(e,t))}async function Cn(e,t){return wn(e,"POST","/v1/accounts:lookup",t)}function Tn(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function Pn(e){return 1e3*Number(e)}function In(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return en("JWT malformed, contained fewer than 3 sections"),null;try{const e=Z(n);return e?JSON.parse(e):(en("Failed to decode base64 JWT payload"),null)}catch(i){return en("Caught error parsing JWT payload as JSON",null===i||void 0===i?void 0:i.toString()),null}}function An(e){const t=In(e);return on(t,"internal-error"),on("undefined"!==typeof t.exp,"internal-error"),on("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Mn(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof le&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class Dn{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null===e||void 0===e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class Rn{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Tn(this.lastLoginAt),this.creationTime=Tn(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function On(e){var t;const n=e.auth,r=await e.getIdToken(),i=await Mn(e,Cn(n,{idToken:r}));on(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const a=i.users[0];e._notifyReloadListener(a);const s=(null===(t=a.providerUserInfo)||void 0===t?void 0:t.length)?Ln(a.providerUserInfo):[],o=(l=e.providerData,c=s,[...l.filter((e=>!c.some((t=>t.providerId===e.providerId)))),...c]);var l,c;const d=e.isAnonymous,u=!(e.email&&a.passwordHash)&&!(null===o||void 0===o?void 0:o.length),h=!!d&&u,p={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new Rn(a.createdAt,a.lastLoginAt),isAnonymous:h};Object.assign(e,p)}function Ln(e){return e.map((e=>{var{providerId:t}=e,n=Qt(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class Fn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){on(e.idToken,"internal-error"),on("undefined"!==typeof e.idToken,"internal-error"),on("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):An(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){on(0!==e.length,"internal-error");const t=An(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(on(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await xn(e,{},(async()=>{const n=pe({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,a=jn(e,r,"/v1/token",`key=${i}`),s=await e._getAdditionalHeaders();return s["Content-Type"]="application/x-www-form-urlencoded",fn.fetch()(a,{method:"POST",headers:s,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,a=new Fn;return n&&(on("string"===typeof n,"internal-error",{appName:e}),a.refreshToken=n),r&&(on("string"===typeof r,"internal-error",{appName:e}),a.accessToken=r),i&&(on("number"===typeof i,"internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Fn,this.toJSON())}_performRefresh(){return ln("not implemented")}}function Un(e,t){on("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class Vn{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=Qt(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Dn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Rn(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Mn(this,this.stsTokenManager.getToken(this.auth,e));return on(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=we(e),r=await n.getIdToken(t),i=In(r);on(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const a="object"===typeof i.firebase?i.firebase:void 0,s=null===a||void 0===a?void 0:a.sign_in_provider;return{claims:i,token:r,authTime:Tn(Pn(i.auth_time)),issuedAtTime:Tn(Pn(i.iat)),expirationTime:Tn(Pn(i.exp)),signInProvider:s||null,signInSecondFactor:(null===a||void 0===a?void 0:a.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=we(e);await On(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(on(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Vn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){on(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await On(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(It(this.auth.app))return Promise.reject(an(this.auth));const e=await this.getIdToken();return await Mn(this,async function(e,t){return wn(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,a,s,o,l,c;const d=null!==(n=t.displayName)&&void 0!==n?n:void 0,u=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,p=null!==(a=t.photoURL)&&void 0!==a?a:void 0,m=null!==(s=t.tenantId)&&void 0!==s?s:void 0,f=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,y=null!==(l=t.createdAt)&&void 0!==l?l:void 0,g=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:w,isAnonymous:x,providerData:b,stsTokenManager:j}=t;on(v&&j,e,"internal-error");const k=Fn.fromJSON(this.name,j);on("string"===typeof v,e,"internal-error"),Un(d,e.name),Un(u,e.name),on("boolean"===typeof w,e,"internal-error"),on("boolean"===typeof x,e,"internal-error"),Un(h,e.name),Un(p,e.name),Un(m,e.name),Un(f,e.name),Un(y,e.name),Un(g,e.name);const N=new Vn({uid:v,auth:e,email:u,emailVerified:w,displayName:d,isAnonymous:x,photoURL:p,phoneNumber:h,tenantId:m,stsTokenManager:k,createdAt:y,lastLoginAt:g});return b&&Array.isArray(b)&&(N.providerData=b.map((e=>Object.assign({},e)))),f&&(N._redirectEventId=f),N}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new Fn;r.updateFromServerResponse(t);const i=new Vn({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await On(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];on(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?Ln(r.providerUserInfo):[],a=!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length),s=new Fn;s.updateFromIdToken(n);const o=new Vn({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:a}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new Rn(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length)};return Object.assign(o,l),o}}const Bn=new Map;function $n(e){cn(e instanceof Function,"Expected a class definition");let t=Bn.get(e);return t?(cn(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Bn.set(e,t),t)}class Wn{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Wn.type="NONE";const qn=Wn;function Hn(e,t,n){return`firebase:${e}:${t}:${n}`}class Kn{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=Hn(this.userKey,r.apiKey,i),this.fullPersistenceKey=Hn("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Vn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new Kn($n(qn),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||$n(qn);const a=Hn(n,e.config.apiKey,e.name);let s=null;for(const c of t)try{const t=await c._get(a);if(t){const n=Vn._fromJSON(e,t);c!==i&&(s=n),i=c;break}}catch(l){}const o=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&o.length?(i=o[0],s&&await i._set(a,s.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(a)}catch(l){}}))),new Kn(i,e,n)):new Kn(i,e,n)}}function Gn(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Jn(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Qn(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(er(t))return"Blackberry";if(tr(t))return"Webos";if(Zn(t))return"Safari";if((t.includes("chrome/")||Yn(t))&&!t.includes("edge/"))return"Chrome";if(Xn(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function Qn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re();return/firefox\//i.test(e)}function Zn(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:re()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Yn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re();return/crios\//i.test(e)}function Jn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re();return/iemobile/i.test(e)}function Xn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re();return/android/i.test(e)}function er(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re();return/blackberry/i.test(e)}function tr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re();return/webos/i.test(e)}function nr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function rr(){return function(){const e=re();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function ir(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re();return nr(e)||Xn(e)||tr(e)||er(e)||/windows phone/i.test(e)||Jn(e)}function ar(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Gn(re());break;case"Worker":t=`${Gn(re())}-${e}`;break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${Dt}/${r}`}class sr{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(i){r(i)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class or{constructor(e){var t,n,r,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=a.minPasswordLength)&&void 0!==t?t:6,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),void 0!==a.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),void 0!==a.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),void 0!==a.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),void 0!==a.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,a,s;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(r=o.containsLowercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(i=o.containsUppercaseLetter)||void 0===i||i),o.isValid&&(o.isValid=null===(a=o.containsNumericCharacter)||void 0===a||a),o.isValid&&(o.isValid=null===(s=o.containsNonAlphanumericCharacter)||void 0===s||s),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class lr{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new dr(this),this.idTokenSubscription=new dr(this),this.beforeStateQueue=new sr(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Jt,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=$n(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await Kn.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(i){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Cn(this,{idToken:e}),n=await Vn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(It(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,a=null===r||void 0===r?void 0:r._redirectEventId,s=await this.tryRedirectSignIn(e);n&&n!==a||!(null===s||void 0===s?void 0:s.user)||(r=s.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(a)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return on(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await On(e)}catch(t){if("auth/network-request-failed"!==(null===t||void 0===t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(It(this.app))return Promise.reject(an(this));const t=e?we(e):null;return t&&on(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&on(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return It(this.app)?Promise.reject(an(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return It(this.app)?Promise.reject(an(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence($n(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return wn(e,"GET","/v2/passwordPolicy",vn(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new or(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ce("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return wn(e,"POST","/v2/accounts:revokeToken",vn(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&$n(e)||this._popupRedirectResolver;on(t,this,"argument-error"),this.redirectPersistenceManager=await Kn.create(this,[$n(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let a=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(on(s,this,"internal-error"),s.then((()=>{a||i(this.currentUser)})),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{a=!0,i()}}{const n=e.addObserver(t);return()=>{a=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return on(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ar(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(Xt.logLevel<=ze.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Xt.warn(`Auth (${Dt}): ${e}`,...n)}}(`Error while retrieving App Check token: ${t.error}`),null===t||void 0===t?void 0:t.token}}function cr(e){return we(e)}class dr{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new ye(e,t);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return on(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ur={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function hr(e){return ur.loadJS(e)}function pr(e){return`__${e}${Math.floor(1e6*Math.random())}`}class mr{constructor(e){this.type="recaptcha-enterprise",this.auth=cr(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;_n(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{Sn(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new En(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&_n(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=ur.recaptchaEnterpriseScript;0!==t.length&&(t+=i),hr(t).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function fr(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=new mr(e);let a;try{a=await i.verify(n)}catch(o){a=await i.verify(n,!0)}const s=Object.assign({},t);return r?Object.assign(s,{captchaResp:a}):Object.assign(s,{captchaResponse:a}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}async function yr(e,t,n,r){var i;if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await fr(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch((async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await fr(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)}))}function gr(e,t,n){const r=cr(e);on(r._canInitEmulator,r,"emulator-config-failed"),on(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),a=vr(t),{host:s,port:o}=function(e){const t=vr(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:wr(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:wr(t)}}}(t),l=null===o?"":`:${o}`;r.config.emulator={url:`${a}//${s}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:s,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function vr(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function wr(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class xr{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ln("not implemented")}_getIdTokenResponse(e){return ln("not implemented")}_linkToIdToken(e,t){return ln("not implemented")}_getReauthenticationResolver(e){return ln("not implemented")}}async function br(e,t){return wn(e,"POST","/v1/accounts:signUp",t)}async function jr(e,t){return bn(e,"POST","/v1/accounts:signInWithPassword",vn(e,t))}class kr extends xr{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new kr(e,t,"password")}static _fromEmailAndCode(e,t){return new kr(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return yr(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",jr);case"emailLink":return async function(e,t){return bn(e,"POST","/v1/accounts:signInWithEmailLink",vn(e,t))}(e,{email:this._email,oobCode:this._password});default:tn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return yr(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",br);case"emailLink":return async function(e,t){return bn(e,"POST","/v1/accounts:signInWithEmailLink",vn(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:tn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Nr(e,t){return bn(e,"POST","/v1/accounts:signInWithIdp",vn(e,t))}class zr extends xr{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new zr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):tn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=Qt(t,["providerId","signInMethod"]);if(!n||!r)return null;const a=new zr(n,r);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){return Nr(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Nr(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Nr(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=pe(t)}return e}}const _r={USER_NOT_FOUND:"user-not-found"};class Er extends xr{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Er({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Er({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return bn(e,"POST","/v1/accounts:signInWithPhoneNumber",vn(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await bn(e,"POST","/v1/accounts:signInWithPhoneNumber",vn(e,t));if(n.temporaryProof)throw zn(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return bn(e,"POST","/v1/accounts:signInWithPhoneNumber",vn(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),_r)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new Er({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Sr{constructor(e){var t,n,r,i,a,s;const o=me(fe(e)),l=null!==(t=o.apiKey)&&void 0!==t?t:null,c=null!==(n=o.oobCode)&&void 0!==n?n:null,d=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=o.mode)&&void 0!==r?r:null);on(l&&c&&d,"argument-error"),this.apiKey=l,this.operation=d,this.code=c,this.continueUrl=null!==(i=o.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(a=o.languageCode)&&void 0!==a?a:null,this.tenantId=null!==(s=o.tenantId)&&void 0!==s?s:null}static parseLink(e){const t=function(e){const t=me(fe(e)).link,n=t?me(fe(t)).deep_link_id:null,r=me(fe(e)).deep_link_id;return(r?me(fe(r)).link:null)||r||n||t||e}(e);try{return new Sr(t)}catch(n){return null}}}class Cr{constructor(){this.providerId=Cr.PROVIDER_ID}static credential(e,t){return kr._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Sr.parseLink(t);return on(n,"argument-error"),kr._fromEmailAndCode(e,n.code,n.tenantId)}}Cr.PROVIDER_ID="password",Cr.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Cr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Tr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Pr extends Tr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ir extends Pr{constructor(){super("facebook.com")}static credential(e){return zr._fromParams({providerId:Ir.PROVIDER_ID,signInMethod:Ir.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ir.credentialFromTaggedObject(e)}static credentialFromError(e){return Ir.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Ir.credential(t.oauthAccessToken)}catch(n){return null}}}Ir.FACEBOOK_SIGN_IN_METHOD="facebook.com",Ir.PROVIDER_ID="facebook.com";class Ar extends Pr{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return zr._fromParams({providerId:Ar.PROVIDER_ID,signInMethod:Ar.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ar.credentialFromTaggedObject(e)}static credentialFromError(e){return Ar.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return Ar.credential(n,r)}catch(i){return null}}}Ar.GOOGLE_SIGN_IN_METHOD="google.com",Ar.PROVIDER_ID="google.com";class Mr extends Pr{constructor(){super("github.com")}static credential(e){return zr._fromParams({providerId:Mr.PROVIDER_ID,signInMethod:Mr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Mr.credentialFromTaggedObject(e)}static credentialFromError(e){return Mr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Mr.credential(t.oauthAccessToken)}catch(n){return null}}}Mr.GITHUB_SIGN_IN_METHOD="github.com",Mr.PROVIDER_ID="github.com";class Dr extends Pr{constructor(){super("twitter.com")}static credential(e,t){return zr._fromParams({providerId:Dr.PROVIDER_ID,signInMethod:Dr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Dr.credentialFromTaggedObject(e)}static credentialFromError(e){return Dr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return Dr.credential(n,r)}catch(i){return null}}}async function Rr(e,t){return bn(e,"POST","/v1/accounts:signUp",vn(e,t))}Dr.TWITTER_SIGN_IN_METHOD="twitter.com",Dr.PROVIDER_ID="twitter.com";class Or{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await Vn._fromIdTokenResponse(e,n,r),a=Lr(n);return new Or({user:i,providerId:a,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Lr(n);return new Or({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Lr(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Fr extends le{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Fr.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Fr(e,t,n,r)}}function Ur(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Fr._fromErrorAndOperation(e,n,t,r);throw n}))}async function Vr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await Mn(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Or._forOperation(e,"link",r)}async function Br(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(It(r.app))return Promise.reject(an(r));const i="reauthenticate";try{const a=await Mn(e,Ur(r,i,t,e),n);on(a.idToken,r,"internal-error");const s=In(a.idToken);on(s,r,"internal-error");const{sub:o}=s;return on(e.uid===o,r,"user-mismatch"),Or._forOperation(e,i,a)}catch(a){throw"auth/user-not-found"===(null===a||void 0===a?void 0:a.code)&&tn(r,"user-mismatch"),a}}async function $r(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(It(e.app))return Promise.reject(an(e));const r="signIn",i=await Ur(e,r,t),a=await Or._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(a.user),a}async function Wr(e,t){let{displayName:n,photoURL:r}=t;if(void 0===n&&void 0===r)return;const i=we(e),a={idToken:await i.getIdToken(),displayName:n,photoUrl:r,returnSecureToken:!0},s=await Mn(i,async function(e,t){return wn(e,"POST","/v1/accounts:update",t)}(i.auth,a));i.displayName=s.displayName||null,i.photoURL=s.photoUrl||null;const o=i.providerData.find((e=>{let{providerId:t}=e;return"password"===t}));o&&(o.displayName=i.displayName,o.photoURL=i.photoURL),await i._updateTokensIfNecessary(s)}new WeakMap;const qr="__sak";class Hr{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(qr,"1"),this.storage.removeItem(qr),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Kr extends Hr{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ir(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);rr()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Kr.type="LOCAL";const Gr=Kr;class Qr extends Hr{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Qr.type="SESSION";const Zr=Qr;class Yr{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Yr(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,a=this.handlersMap[r];if(!(null===a||void 0===a?void 0:a.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const s=Array.from(a).map((async e=>e(t.origin,i))),o=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(s);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Jr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Yr.receivers=[];class Xr{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,a;return new Promise(((s,o)=>{const l=Jr("",20);r.port1.start();const c=setTimeout((()=>{o(new Error("unsupported_event"))}),n);a={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout((()=>{o(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),s(t.data.response);break;default:clearTimeout(c),clearTimeout(i),o(new Error("invalid_response"))}}},this.handlers.add(a),r.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])})).finally((()=>{a&&this.removeMessageHandler(a)}))}}function ei(){return window}function ti(){return"undefined"!==typeof ei().WorkerGlobalScope&&"function"===typeof ei().importScripts}const ni="firebaseLocalStorageDb",ri="firebaseLocalStorage",ii="fbase_key";class ai{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function si(e,t){return e.transaction([ri],t?"readwrite":"readonly").objectStore(ri)}function oi(){const e=indexedDB.open(ni,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(ri,{keyPath:ii})}catch(r){n(r)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(ri)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(ni);return new ai(e).toPromise()}(),t(await oi()))}))}))}async function li(e,t,n){const r=si(e,!0).put({[ii]:t,value:n});return new ai(r).toPromise()}function ci(e,t){const n=si(e,!0).delete(t);return new ai(n).toPromise()}class di{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await oi()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ti()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Yr._getInstance(ti()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Xr(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await oi();return await li(e,qr,"1"),await ci(e,qr),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>li(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=si(e,!1).get(t),r=await new ai(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>ci(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=si(e,!1).getAll();return new ai(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}di.type="LOCAL";const ui=di;pr("rcb"),new pn(3e4,6e4);const hi="recaptcha";async function pi(e,t,n){var r;const i=await n.verify();try{let a;if(on("string"===typeof i,e,"argument-error"),on(n.type===hi,e,"argument-error"),a="string"===typeof t?{phoneNumber:t}:t,"session"in a){const t=a.session;if("phoneNumber"in a){on("enroll"===t.type,e,"internal-error");const n=await function(e,t){return wn(e,"POST","/v2/accounts/mfaEnrollment:start",vn(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:a.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{on("signin"===t.type,e,"internal-error");const n=(null===(r=a.multiFactorHint)||void 0===r?void 0:r.uid)||a.multiFactorUid;on(n,e,"missing-multi-factor-info");const s=await function(e,t){return wn(e,"POST","/v2/accounts/mfaSignIn:start",vn(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return s.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return wn(e,"POST","/v1/accounts:sendVerificationCode",vn(e,t))}(e,{phoneNumber:a.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}class mi{constructor(e){this.providerId=mi.PROVIDER_ID,this.auth=cr(e)}verifyPhoneNumber(e,t){return pi(this.auth,e,we(t))}static credential(e,t){return Er._fromVerification(e,t)}static credentialFromResult(e){const t=e;return mi.credentialFromTaggedObject(t)}static credentialFromError(e){return mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?Er._fromTokenResponse(n,r):null}}function fi(e,t){return t?$n(t):(on(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}mi.PROVIDER_ID="phone",mi.PHONE_SIGN_IN_METHOD="phone";class yi extends xr{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Nr(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Nr(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Nr(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function gi(e){return $r(e.auth,new yi(e),e.bypassAuthState)}function vi(e){const{auth:t,user:n}=e;return on(n,t,"internal-error"),Br(n,new yi(e),e.bypassAuthState)}async function wi(e){const{auth:t,user:n}=e;return on(n,t,"internal-error"),Vr(n,new yi(e),e.bypassAuthState)}class xi{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:a,type:s}=e;if(a)return void this.reject(a);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return gi;case"linkViaPopup":case"linkViaRedirect":return wi;case"reauthViaPopup":case"reauthViaRedirect":return vi;default:tn(this.auth,"internal-error")}}resolve(e){cn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){cn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const bi=new pn(2e3,1e4);class ji extends xi{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,ji.currentPopupAction&&ji.currentPopupAction.cancel(),ji.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return on(e,this.auth,"internal-error"),e}async onExecution(){cn(1===this.filter.length,"Popup operations only handle one event");const e=Jr();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(nn(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(nn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ji.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(nn(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,bi.get())};e()}}ji.currentPopupAction=null;const ki=new Map;class Ni extends xi{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=ki.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Ei(t),r=_i(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}ki.set(this.auth._key(),e)}return this.bypassAuthState||ki.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function zi(e,t){ki.set(e._key(),t)}function _i(e){return $n(e._redirectPersistence)}function Ei(e){return Hn("pendingRedirect",e.config.apiKey,e.name)}async function Si(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(It(e.app))return Promise.reject(an(e));const r=cr(e),i=fi(r,t),a=new Ni(r,i,n),s=await a.execute();return s&&!n&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,t)),s}class Ci{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Pi(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Pi(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(nn(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ti(e))}saveEventToCache(e){this.cachedEventUids.add(Ti(e)),this.lastProcessedEventTime=Date.now()}}function Ti(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Pi(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===(null===n||void 0===n?void 0:n.code)}const Ii=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ai=/^https?/;async function Mi(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return wn(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(Di(r))return}catch(n){}tn(e,"unauthorized-domain")}function Di(e){const t=dn(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Ai.test(n))return!1;if(Ii.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Ri=new pn(3e4,6e4);function Oi(){const e=ei().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function Li(e){return new Promise(((t,n)=>{var r,i,a;function s(){Oi(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Oi(),n(nn(e,"network-request-failed"))},timeout:Ri.get()})}if(null===(i=null===(r=ei().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=ei().gapi)||void 0===a?void 0:a.load)){const t=pr("iframefcb");return ei()[t]=()=>{gapi.load?s():n(nn(e,"network-request-failed"))},hr(`${ur.gapiScript}?onload=${t}`).catch((e=>n(e)))}s()}})).catch((e=>{throw Fi=null,e}))}let Fi=null;const Ui=new pn(5e3,15e3),Vi={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Bi=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function $i(e){const t=e.config;on(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?mn(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:Dt},i=Bi.get(e.config.apiHost);i&&(r.eid=i);const a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),`${n}?${pe(r).slice(1)}`}async function Wi(e){const t=await function(e){return Fi=Fi||Li(e),Fi}(e),n=ei().gapi;return on(n,e,"internal-error"),t.open({where:document.body,url:$i(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Vi,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=nn(e,"network-request-failed"),a=ei().setTimeout((()=>{r(i)}),Ui.get());function s(){ei().clearTimeout(a),n(t)}t.ping(s).then(s,(()=>{r(i)}))}))))}const qi={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Hi{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Ki(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const a=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l=Object.assign(Object.assign({},qi),{width:r.toString(),height:i.toString(),top:a,left:s}),c=re().toLowerCase();n&&(o=Yn(c)?"_blank":n),Qn(c)&&(t=t||"http://localhost",l.scrollbars="yes");const d=Object.entries(l).reduce(((e,t)=>{let[n,r]=t;return`${e}${n}=${r},`}),"");if(function(){var e;return nr(arguments.length>0&&void 0!==arguments[0]?arguments[0]:re())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",o),new Hi(null);const u=window.open(t||"",o,d);on(u,e,"popup-blocked");try{u.focus()}catch(h){}return new Hi(u)}const Gi="__/auth/handler",Qi="emulator/auth/handler",Zi=encodeURIComponent("fac");async function Yi(e,t,n,r,i,a){on(e.config.authDomain,e,"auth-domain-config-required"),on(e.config.apiKey,e,"invalid-api-key");const s={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Dt,eventId:i};if(t instanceof Tr){t.setDefaultLanguage(e.languageCode),s.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(s.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))s[e]=t}if(t instanceof Pr){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(s.scopes=e.join(","))}e.tenantId&&(s.tid=e.tenantId);const o=s;for(const d of Object.keys(o))void 0===o[d]&&delete o[d];const l=await e._getAppCheckToken(),c=l?`#${Zi}=${encodeURIComponent(l)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${Gi}`;return mn(t,Qi)}(e)}?${pe(o).slice(1)}${c}`}const Ji="webStorageSupport";const Xi=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Zr,this._completeRedirectFn=Si,this._overrideRedirectResult=zi}async _openPopup(e,t,n,r){var i;cn(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return Ki(e,await Yi(e,t,n,dn(),r),Jr())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){ei().location.href=e}(await Yi(e,t,n,dn(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(cn(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await Wi(e),n=new Ci(e);return t.register("authEvent",(t=>{on(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ji,{type:Ji},(n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[Ji];void 0!==i&&t(!!i),tn(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Mi(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ir()||Zn()||nr()}};var ea="@firebase/auth",ta="1.7.9";class na{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){on(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const ra=te("authIdTokenMaxAge")||300;let ia=null;var aa;ur={loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=nn("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},aa="Browser",Tt(new xe("auth",((e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=r.options;on(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:s,authDomain:o,clientPlatform:aa,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ar(aa)},c=new lr(r,i,a,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map($n);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),Tt(new xe("auth-internal",(e=>(e=>new na(e))(cr(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Lt(ea,ta,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(aa)),Lt(ea,ta,"esm2017");var sa,oa,la="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},ca={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var a=e.g[3],s=t+(a^n&(i^a))+r[0]+3614090360&4294967295;s=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=n+(s<<7&4294967295|s>>>25))+((s=a+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^a&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(a^t))+r[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=t+(a^n&(i^a))+r[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=a+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^a&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(a^t))+r[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=t+(a^n&(i^a))+r[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=a+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^a&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(a^t))+r[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=t+(a^n&(i^a))+r[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=a+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^a&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(a^t))+r[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^a&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(a^t))+r[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^t&(i^a))+r[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^a&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(a^t))+r[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^t&(i^a))+r[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^a&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(a^t))+r[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^t&(i^a))+r[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^a&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(a^t))+r[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^t&(i^a))+r[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=t+(n^i^a)+r[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=a+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=i+(a^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^a^t)+r[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^a)+r[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=a+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=i+(a^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^a^t)+r[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^a)+r[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=a+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=i+(a^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^a^t)+r[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^a)+r[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=a+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=i+(a^t^n)+r[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^a^t)+r[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=t+(i^(n|~a))+r[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(a|~n))+r[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=n+(a^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=t+(i^(n|~a))+r[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(a|~n))+r[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=n+(a^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=t+(i^(n|~a))+r[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(a|~n))+r[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=n+(a^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((a=(t=n+((s=t+(i^(n|~a))+r[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((i=a+((s=i+(t^(a|~n))+r[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+a&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var a=0|e[i];r&&a==t||(n[i]=a,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,a=this.h,s=0;s<t;){if(0==a)for(;s<=r;)n(this,e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(i[a++]=e.charCodeAt(s++),a==this.blockSize){n(this,i),a=0;break}}else for(;s<t;)if(i[a++]=e[s++],a==this.blockSize){n(this,i),a=0;break}}this.h=a,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var i={};function a(e){return-128<=e&&128>e?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new r([0|e],0>e?-1:0)})):new r([0|e],0>e?-1:0)}function s(e){if(isNaN(e)||!isFinite(e))return o;if(0>e)return h(s(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=4294967296;return new r(t,0)}var o=a(0),l=a(1),c=a(16777216);function d(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function u(e){return-1==e.h}function h(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new r(n,~e.h).add(l)}function p(e,t){return e.add(h(t))}function m(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function f(e,t){this.g=e,this.h=t}function y(e,t){if(d(t))throw Error("division by zero");if(d(e))return new f(o,o);if(u(e))return t=y(h(e),t),new f(h(t.g),h(t.h));if(u(t))return t=y(e,h(t)),new f(h(t.g),t.h);if(30<e.g.length){if(u(e)||u(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;0>=r.l(e);)n=g(n),r=g(r);var i=v(n,1),a=v(r,1);for(r=v(r,2),n=v(n,2);!d(r);){var c=a.add(r);0>=c.l(e)&&(i=i.add(n),a=c),r=v(r,1),n=v(n,1)}return t=p(e,i.j(t)),new f(i,t)}for(i=o;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),c=(a=s(n)).j(t);u(c)||0<c.l(e);)c=(a=s(n-=r)).j(t);d(a)&&(a=l),i=i.add(a),e=p(e,c)}return new f(i,e)}function g(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.i(i)<<1|e.i(i-1)>>>31;return new r(n,e.h)}function v(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,a=[],s=0;s<i;s++)a[s]=0<t?e.i(s+n)>>>t|e.i(s+n+1)<<32-t:e.i(s+n);return new r(a,e.h)}(e=r.prototype).m=function(){if(u(this))return-h(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(d(this))return"0";if(u(this))return"-"+h(this).toString(e);for(var t=s(Math.pow(e,6)),n=this,r="";;){var i=y(n,t).g,a=((0<(n=p(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(d(n=i))return a+r;for(;6>a.length;)a="0"+a;r=a+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return u(e=p(this,e))?-1:d(e)?0:1},e.abs=function(){return u(this)?h(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,a=0;a<=t;a++){var s=i+(65535&this.i(a))+(65535&e.i(a)),o=(s>>>16)+(this.i(a)>>>16)+(e.i(a)>>>16);i=o>>>16,s&=65535,o&=65535,n[a]=o<<16|s}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(d(this)||d(e))return o;if(u(this))return u(e)?h(this).j(h(e)):h(h(this).j(e));if(u(e))return h(this.j(h(e)));if(0>this.l(c)&&0>e.l(c))return s(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var a=0;a<e.g.length;a++){var l=this.i(i)>>>16,p=65535&this.i(i),f=e.i(a)>>>16,y=65535&e.i(a);n[2*i+2*a]+=p*y,m(n,2*i+2*a),n[2*i+2*a+1]+=l*y,m(n,2*i+2*a+1),n[2*i+2*a+1]+=p*f,m(n,2*i+2*a+1),n[2*i+2*a+2]+=l*f,m(n,2*i+2*a+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new r(n,0)},e.A=function(e){return y(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)&e.i(i);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)|e.i(i);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)^e.i(i);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,oa=ca.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=s,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return h(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=s(Math.pow(n,8)),i=o,a=0;a<t.length;a+=8){var l=Math.min(8,t.length-a),c=parseInt(t.substring(a,a+l),n);8>l?(l=s(Math.pow(n,l)),i=i.j(l).add(s(c))):i=(i=i.j(r)).add(s(c))}return i},sa=ca.Integer=r}).apply("undefined"!==typeof la?la:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var da,ua,ha,pa,ma,fa,ya,ga,va="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},wa={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof va&&va];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var i=n;e=e.split(".");for(var a=0;a<e.length-1;a++){var s=e[a];if(!(s in i))break e;i=i[s]}(r=r(a=i[e=e[e.length-1]]))!=a&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e,t){return t}))}}));var r=r||{},i=this||self;function a(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function s(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function d(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function u(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function h(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function p(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(a(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function m(e){return/^[\s\xa0]*$/.test(e)}function f(){var e=i.navigator;return e&&(e=e.userAgent)?e:""}function y(e){return y[" "](e),e}y[" "]=function(){};var g=-1!=f().indexOf("Gecko")&&!(-1!=f().toLowerCase().indexOf("webkit")&&-1==f().indexOf("Edge"))&&!(-1!=f().indexOf("Trident")||-1!=f().indexOf("MSIE"))&&-1==f().indexOf("Edge");function v(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function w(e){const t={};for(const n in e)t[n]=e[n];return t}const x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<x.length;t++)n=x[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function j(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function k(e){i.setTimeout((()=>{throw e}),0)}function N(){var e=C;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var z=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new _),(e=>e.reset()));class _{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let E,S=!1,C=new class{constructor(){this.h=this.g=null}add(e,t){const n=z.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},T=()=>{const e=i.Promise.resolve(void 0);E=()=>{e.then(P)}};var P=()=>{for(var e;e=N();){try{e.h.call(e.g)}catch(n){k(n)}var t=z;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}S=!1};function I(){this.s=this.s,this.C=this.C}function A(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}I.prototype.s=!1,I.prototype.ma=function(){this.s||(this.s=!0,this.N())},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},A.prototype.h=function(){this.defaultPrevented=!0};var M=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(n){}return e}();function D(e,t){if(A.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(g){e:{try{y(t.nodeName);var i=!0;break e}catch(a){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:R[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&D.aa.h.call(this)}}u(D,A);var R={2:"touch",3:"pen",4:"mouse"};D.prototype.h=function(){D.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var O="closure_listenable_"+(1e6*Math.random()|0),L=0;function F(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++L,this.da=this.fa=!1}function U(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function V(e){this.src=e,this.g={},this.h=0}function B(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=Array.prototype.indexOf.call(i,t,void 0);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(U(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function $(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.da&&a.listener==t&&a.capture==!!n&&a.ha==r)return i}return-1}V.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var s=$(e,t,r,i);return-1<s?(t=e[s],n||(t.fa=!1)):((t=new F(t,this.src,a,!!r,i)).fa=n,e.push(t)),t};var W="closure_lm_"+(1e6*Math.random()|0),q={};function H(e,t,n,r,i){if(r&&r.once)return G(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)H(e,t[a],n,r,i);return null}return n=te(n),e&&e[O]?e.K(t,n,s(r)?!!r.capture:!!r,i):K(e,t,n,!1,r,i)}function K(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=s(i)?!!i.capture:!!i,l=X(e);if(l||(e[W]=l=new V(e)),(n=l.add(t,n,r,o,a)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=J;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)M||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Y(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function G(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)G(e,t[a],n,r,i);return null}return n=te(n),e&&e[O]?e.L(t,n,s(r)?!!r.capture:!!r,i):K(e,t,n,!0,r,i)}function Q(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)Q(e,t[a],n,r,i);else r=s(r)?!!r.capture:!!r,n=te(n),e&&e[O]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=$(a=e.g[t],n,r,i))&&(U(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--)))):e&&(e=X(e))&&(t=e.g[t.toString()],e=-1,t&&(e=$(t,n,r,i)),(n=-1<e?t[e]:null)&&Z(n))}function Z(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[O])B(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Y(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=X(t))?(B(n,e),0==n.h&&(n.src=null,t[W]=null)):U(e)}}}function Y(e){return e in q?q[e]:q[e]="on"+e}function J(e,t){if(e.da)e=!0;else{t=new D(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&Z(e),e=n.call(r,t)}return e}function X(e){return(e=e[W])instanceof V?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){I.call(this),this.i=new V(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new A(t,e);else if(t instanceof A)t.target=t.target||e;else{var i=t;b(t=new A(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var s=t.g=n[a];i=ie(s,r,!0,t)&&i}if(i=ie(s=t.g=e,r,!0,t)&&i,i=ie(s,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=ie(s=t.g=n[a],r,!1,t)&&i}function ie(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var s=t[a];if(s&&!s.da&&s.capture==n){var o=s.listener,l=s.ha||s.src;s.fa&&B(e.i,s),i=!1!==o.call(l,r)&&i}}return i&&!r.defaultPrevented}function ae(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function se(e){e.g=ae((()=>{e.g=null,e.i&&(e.i=!1,se(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}u(ne,I),ne.prototype[O]=!0,ne.prototype.removeEventListener=function(e,t,n,r){Q(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)U(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class oe extends I{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:se(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){I.call(this),this.h=e,this.g={}}u(le,I);var ce=[];function de(e){v(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Z(e)}),e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),de(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ue=i.JSON.stringify,he=i.JSON.parse,pe=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function me(){}function fe(e){return e.h||(e.h=e.i())}function ye(){}me.prototype.h=null;var ge={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ve(){A.call(this,"d")}function we(){A.call(this,"c")}u(ve,A),u(we,A);var xe={},be=null;function je(){return be=be||new ne}function ke(e){A.call(this,xe.La,e)}function Ne(e){const t=je();re(t,new ke(t))}function ze(e,t){A.call(this,xe.STAT_EVENT,e),this.stat=t}function _e(e){const t=je();re(t,new ze(t,e))}function Ee(e,t){A.call(this,xe.Ma,e),this.size=t}function Se(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout((function(){e()}),t)}function Ce(){this.g=!0}function Te(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var s=1;s<i.length;s++)i[s]=""}}}return ue(n)}catch(o){return t}}(e,n)+(r?" "+r:"")}))}xe.La="serverreachability",u(ke,A),xe.STAT_EVENT="statevent",u(ze,A),xe.Ma="timingevent",u(Ee,A),Ce.prototype.xa=function(){this.g=!1},Ce.prototype.info=function(){};var Pe,Ie={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ae={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Me(){}function De(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Re}function Re(){this.i=null,this.g="",this.h=!1}u(Me,me),Me.prototype.g=function(){return new XMLHttpRequest},Me.prototype.i=function(){return{}},Pe=new Me;var Oe={},Le={};function Fe(e,t,n){e.L=1,e.v=ut(st(t)),e.m=n,e.P=!0,Ue(e,null)}function Ue(e,t){e.F=Date.now(),$e(e),e.A=st(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),zt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Re,e.g=pn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new oe(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(ce[0]=i.toString()),i=ce);for(var a=0;a<i.length;a++){var s=H(n,i[a],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}t=e.H?w(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ne(),function(e,t,n,r,i,a){e.info((function(){if(e.g)if(a)for(var s="",o=a.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var d=c[0];c=c[1];var u=d.split("_");s=2<=u.length&&"type"==u[1]?s+(d+"=")+c+"&":s+(d+"=redacted&")}}else s=null;else s=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+s}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function Ve(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Be(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Le:(n=Number(t.substring(n,r)),isNaN(n)?Oe:(r+=1)+n>t.length?Le:(t=t.slice(r,r+n),e.C=r+n,t))}function $e(e){e.S=Date.now()+e.I,We(e,e.I)}function We(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Se(c(e.ba,e),t)}function qe(e){e.B&&(i.clearTimeout(e.B),e.B=null)}function He(e){0==e.j.G||e.J||ln(e.j,e)}function Ke(e){qe(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,de(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Ge(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Xe(n.h,e)))if(!e.K&&Xe(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(d){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;on(n),Zt(n)}rn(n),_e(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=Se(c(n.Za,n),6e3));if(1>=Je(n.h)&&n.ca){try{n.ca()}catch(d){}n.ca=void 0}}else dn(n,11)}else if((e.K||n.g==e)&&on(n),!m(t))for(i=n.Da.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const i=c[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const d=c[5];null!=d&&"number"===typeof d&&0<d&&(r=1.5*d,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const u=e.g;if(u){const e=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var a=r.h;a.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(et(a,a.h),a.h=null))}if(r.D){const e=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,dt(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var s=e;if((r=n).qa=hn(r,r.J?r.ia:null,r.W),s.K){tt(r.h,s);var o=s,l=r.L;l&&(o.I=l),o.B&&(qe(o),$e(o)),r.g=s}else nn(r);0<n.i.length&&Jt(n)}else"stop"!=c[0]&&"close"!=c[0]||dn(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?dn(n,7):Qt(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Ne()}catch(d){}}De.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==qt(e)?t.j():this.Y(e)},De.prototype.Y=function(e){try{if(e==this.g)e:{const h=qt(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||Ht(this.g)))){this.J||4!=h||7==t||Ne(),qe(this);var n=this.g.Z();this.X=n;t:if(Ve(this)){var r=Ht(this.g);e="";var a=r.length,s=4==qt(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ke(this),He(this);var o="";break t}this.h.i=new i.TextDecoder}for(t=0;t<a;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(s&&t==a-1)});r.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(e,t,n,r,i,a,s){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+s}))}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!m(l)){var d=l;break t}}d=null}if(!(n=d)){this.o=!1,this.s=3,_e(12),Ke(this),He(this);break e}Te(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ge(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<o.length;){if(e=Be(this,o),e==Le){4==h&&(this.s=4,_e(14),n=!1),Te(this.i,this.l,null,"[Incomplete Response]");break}if(e==Oe){this.s=4,_e(15),Te(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}Te(this.i,this.l,e,null),Ge(this,e)}if(Ve(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=o.length||this.h.h||(this.s=1,_e(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var u=this.j;u.g==this&&u.ba&&!u.M&&(u.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),an(u),u.M=!0,_e(11))}}else Te(this.i,this.l,o,"[Invalid Chunked Response]"),Ke(this),He(this)}else Te(this.i,this.l,o,null),Ge(this,o);4==h&&Ke(this),this.o&&!this.J&&(4==h?ln(this.j,this):(this.o=!1,$e(this)))}else(function(e){const t={};e=(e.g&&2<=qt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(m(e[r]))continue;var n=j(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const a=t[i]||[];t[i]=a,a.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,_e(12)):(this.s=0,_e(13)),Ke(this),He(this)}}}catch(xa){}},De.prototype.cancel=function(){this.J=!0,Ke(this)},De.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(Ne(),_e(17)),Ke(this),this.s=2,He(this)):We(this,this.S-e)};var Qe=class{constructor(e,t){this.g=e,this.map=t}};function Ze(e){this.l=e||10,i.PerformanceNavigationTiming?e=0<(e=i.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ye(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Je(e){return e.h?1:e.g?e.g.size:0}function Xe(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return h(e.i)}function rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(a(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(a(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(a(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}Ze.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var it=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function at(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof at){this.h=e.h,ot(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new bt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ct(this,n),this.m=e.m}else e&&(t=String(e).match(it))?(this.h=!1,ot(this,t[1]||"",!0),this.o=ht(t[2]||""),this.g=ht(t[3]||"",!0),lt(this,t[4]),this.l=ht(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=ht(t[7]||"")):(this.h=!1,this.i=new bt(null,this.h))}function st(e){return new at(e)}function ot(e,t,n){e.j=n?ht(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,n){t instanceof bt?(e.i=t,function(e,t){t&&!e.j&&(jt(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(kt(this,t),zt(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=pt(t,wt)),e.i=new bt(t,e.h))}function dt(e,t,n){e.i.set(t,n)}function ut(e){return dt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ht(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function pt(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,mt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function mt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}at.prototype.toString=function(){var e=[],t=this.j;t&&e.push(pt(t,yt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(pt(t,yt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(pt(n,"/"==n.charAt(0)?vt:gt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",pt(n,xt)),e.join("")};var ft,yt=/[#\/\?@]/g,gt=/[#\?:]/g,vt=/[#\?]/g,wt=/[#\?@]/g,xt=/#/g;function bt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function jt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function kt(e,t){jt(e),t=_t(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Nt(e,t){return jt(e),t=_t(e,t),e.g.has(t)}function zt(e,t,n){kt(e,t),0<n.length&&(e.i=null,e.g.set(_t(e,t),h(n)),e.h+=n.length)}function _t(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Et(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(a){}}function St(){this.g=new pe}function Ct(e,t,n){const r=n||"";try{rt(e,(function(e,n){let i=e;s(e)&&(i=ue(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function Tt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Pt(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function It(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function At(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Mt(e)}function Mt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Dt(e){let t="";return v(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Rt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Dt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):dt(e,t,n))}function Ot(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=bt.prototype).add=function(e,t){jt(this),this.i=null,e=_t(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){jt(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},e.na=function(){jt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},e.V=function(e){jt(this);let t=[];if("string"===typeof e)Nt(this,e)&&(t=t.concat(this.g.get(_t(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return jt(this),this.i=null,Nt(this,e=_t(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const a=encodeURIComponent(String(r)),s=this.V(r);for(r=0;r<s.length;r++){var i=a;""!==s[r]&&(i+="="+encodeURIComponent(String(s[r]))),e.push(i)}}return this.i=e.join("&")},u(Tt,me),Tt.prototype.g=function(){return new Pt(this.l,this.j)},Tt.prototype.i=(ft={},function(){return ft}),u(Pt,ne),(e=Pt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Mt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||i).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,At(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Mt(this)),this.g&&(this.readyState=3,Mt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;It(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?At(this):Mt(this),3==this.readyState&&It(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,At(this))},e.Qa=function(e){this.g&&(this.response=e,At(this))},e.ga=function(){this.g&&At(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Pt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),u(Ot,ne);var Lt=/^https?$/i,Ft=["POST","PUT"];function Ut(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Vt(e),$t(e)}function Vt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function Bt(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=qt(e)||2!=e.Z()))if(e.u&&4==qt(e))ae(e.Ea,0,e);else if(re(e,"readystatechange"),4==qt(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var a;if(a=0===r){var s=String(e.D).match(it)[1]||null;!s&&i.self&&i.self.location&&(s=i.self.location.protocol.slice(0,-1)),a=!Lt.test(s?s.toLowerCase():"")}n=a}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var o=2<qt(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",Vt(e)}}finally{$t(e)}}}function $t(e,t){if(e.g){Wt(e);const r=e.g,i=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{r.onreadystatechange=i}catch(n){}}}function Wt(e){e.I&&(i.clearTimeout(e.I),e.I=null)}function qt(e){return e.g?e.g.readyState:0}function Ht(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(ka){return null}}function Kt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Gt(e){this.Aa=0,this.i=[],this.j=new Ce,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Kt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Kt("baseRetryDelayMs",5e3,e),this.cb=Kt("retryDelaySeedMs",1e4,e),this.Wa=Kt("forwardChannelMaxRetries",2,e),this.wa=Kt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Ze(e&&e.concurrentRequestLimit),this.Da=new St,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Qt(e){if(Yt(e),3==e.G){var t=e.U++,n=st(e.I);if(dt(n,"SID",e.K),dt(n,"RID",t),dt(n,"TYPE","terminate"),en(e,n),(t=new De(e,e.j,t)).L=2,t.v=ut(st(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&i.Image&&((new Image).src=t.v,n=!0),n||(t.g=pn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),$e(t)}un(e)}function Zt(e){e.g&&(an(e),e.g.cancel(),e.g=null)}function Yt(e){Zt(e),e.u&&(i.clearTimeout(e.u),e.u=null),on(e),e.h.cancel(),e.s&&("number"===typeof e.s&&i.clearTimeout(e.s),e.s=null)}function Jt(e){if(!Ye(e.h)&&!e.s){e.s=!0;var t=e.Ga;E||T(),S||(E(),S=!0),C.add(t,e),e.B=0}}function Xt(e,t){var n;n=t?t.l:e.U++;const r=st(e.I);dt(r,"SID",e.K),dt(r,"RID",n),dt(r,"AID",e.T),en(e,r),e.m&&e.o&&Rt(r,e.m,e.o),n=new De(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),Fe(n,r,t)}function en(e,t){e.H&&v(e.H,(function(e,n){dt(t,n,e)})),e.l&&rt({},(function(e,n){dt(t,n,e)}))}function tn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let a=!0;for(let s=0;s<n;s++){let n=i[s].g;const o=i[s].map;if(n-=t,0>n)t=Math.max(0,i[s].g-100),a=!1;else try{Ct(o,e,"req"+n+"_")}catch(xa){r&&r(o)}}if(a){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function nn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;E||T(),S||(E(),S=!0),C.add(t,e),e.v=0}}function rn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Se(c(e.Fa,e),cn(e,e.v)),e.v++,!0)}function an(e){null!=e.A&&(i.clearTimeout(e.A),e.A=null)}function sn(e){e.g=new De(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=st(e.qa);dt(t,"RID","rpc"),dt(t,"SID",e.K),dt(t,"AID",e.T),dt(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&dt(t,"TO",e.ja),dt(t,"TYPE","xmlhttp"),en(e,t),e.m&&e.o&&Rt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=ut(st(t)),n.m=null,n.P=!0,Ue(n,e)}function on(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function ln(e,t){var n=null;if(e.g==t){on(e),an(e),e.g=null;var r=2}else{if(!Xe(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;re(r=je(),new Ee(r,n)),Jt(e)}else nn(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==r&&function(e,t){return!(Je(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Se(c(e.Ga,e,t),cn(e,e.B)),e.B++,!0))}(e,t)||2==r&&rn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:dn(e,5);break;case 4:dn(e,10);break;case 3:dn(e,6);break;default:dn(e,2)}}function cn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function dn(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new at(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||ot(r,"https"),ut(r),t?function(e,t){const n=new Ce;if(i.Image){const r=new Image;r.onload=d(Et,n,"TestLoadImage: loaded",!0,t,r),r.onerror=d(Et,n,"TestLoadImage: error",!1,t,r),r.onabort=d(Et,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=d(Et,n,"TestLoadImage: timeout",!1,t,r),i.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ce;const n=new AbortController,r=setTimeout((()=>{n.abort(),Et(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(r),e.ok?Et(0,0,!0,t):Et(0,0,!1,t)})).catch((()=>{clearTimeout(r),Et(0,0,!1,t)}))}(r.toString(),n)}else _e(2);e.G=0,e.l&&e.l.sa(t),un(e),Yt(e)}function un(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(p(e.ka,t),p(e.ka,e.i),e.h.i.length=0,h(e.i),e.i.length=0),e.l.ra()}}function hn(e,t,n){var r=n instanceof at?st(n):new at(n);if(""!=r.g)t&&(r.g=t+"."+r.g),lt(r,r.s);else{var a=i.location;r=a.protocol,t=t?t+"."+a.hostname:a.hostname,a=+a.port;var s=new at(null);r&&ot(s,r),t&&(s.g=t),a&&lt(s,a),n&&(s.l=n),r=s}return n=e.D,t=e.ya,n&&t&&dt(r,n,t),dt(r,"VER",e.la),en(e,r),r}function pn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Ot(new Tt({eb:n})):new Ot(e.pa)).Ha(e.J),t}function mn(){}function fn(){}function yn(e,t){ne.call(this),this.g=new Gt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!m(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!m(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new wn(this)}function gn(e){ve.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function vn(){we.call(this),this.status=1}function wn(e){this.g=e}(e=Ot.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Pe.g(),this.v=this.o?fe(this.o):fe(Pe),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(s){return void Ut(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var a in r)n.set(a,r[a]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),a=i.FormData&&e instanceof i.FormData,!(0<=Array.prototype.indexOf.call(Ft,t,void 0))||r||a||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Wt(this),this.u=!0,this.g.send(e),this.u=!1}catch(s){Ut(this,s)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),$t(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$t(this,!0)),Ot.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Bt(this):this.bb())},e.bb=function(){Bt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<qt(this)?this.g.status:-1}catch(ft){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(ft){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),he(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Gt.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){_e(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=hn(this,null,this.W),Jt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new De(this,this.j,e);let a=this.o;if(this.S&&(a?(a=w(a),b(a,this.S)):a=this.S),null!==this.m||this.O||(i.H=a,a=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=tn(this,i,t),dt(n=st(this.I),"RID",e),dt(n,"CVER",22),this.D&&dt(n,"X-HTTP-Session-Id",this.D),en(this,n),a&&(this.O?t="headers="+encodeURIComponent(String(Dt(a)))+"&"+t:this.m&&Rt(n,this.m,a)),et(this.h,i),this.Ua&&dt(n,"TYPE","init"),this.P?(dt(n,"$req",t),dt(n,"SID","null"),i.T=!0,Fe(i,n,null)):Fe(i,n,t),this.G=2}}else 3==this.G&&(e?Xt(this,e):0==this.i.length||Ye(this.h)||Xt(this))},e.Fa=function(){if(this.u=null,sn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Se(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_e(10),Zt(this),sn(this))},e.Za=function(){null!=this.C&&(this.C=null,Zt(this),rn(this),_e(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),_e(2)):(this.j.info("Failed to ping google.com"),_e(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=mn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},fn.prototype.g=function(e,t){return new yn(e,t)},u(yn,ne),yn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){Qt(this.g)},yn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=ue(e),e=n);t.i.push(new Qe(t.Ya++,e)),3==t.G&&Jt(t)},yn.prototype.N=function(){this.g.l=null,delete this.j,Qt(this.g),delete this.g,yn.aa.N.call(this)},u(gn,ve),u(vn,we),u(wn,mn),wn.prototype.ua=function(){re(this.g,"a")},wn.prototype.ta=function(e){re(this.g,new gn(e))},wn.prototype.sa=function(e){re(this.g,new vn)},wn.prototype.ra=function(){re(this.g,"b")},fn.prototype.createWebChannel=fn.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,ga=wa.createWebChannelTransport=function(){return new fn},ya=wa.getStatEventTarget=function(){return je()},fa=wa.Event=xe,ma=wa.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,pa=wa.ErrorCode=Ie,Ae.COMPLETE="complete",ha=wa.EventType=Ae,ye.EventType=ge,ge.OPEN="a",ge.CLOSE="b",ge.ERROR="c",ge.MESSAGE="d",ne.prototype.listen=ne.prototype.K,ua=wa.WebChannel=ye,wa.FetchXmlHttpFactory=Tt,Ot.prototype.listenOnce=Ot.prototype.L,Ot.prototype.getLastError=Ot.prototype.Ka,Ot.prototype.getLastErrorCode=Ot.prototype.Ba,Ot.prototype.getStatus=Ot.prototype.Z,Ot.prototype.getResponseJson=Ot.prototype.Oa,Ot.prototype.getResponseText=Ot.prototype.oa,Ot.prototype.send=Ot.prototype.ea,Ot.prototype.setWithCredentials=Ot.prototype.Ha,da=wa.XhrIo=Ot}).apply("undefined"!==typeof va?va:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const xa="@firebase/firestore";class ba{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ba.UNAUTHENTICATED=new ba(null),ba.GOOGLE_CREDENTIALS=new ba("google-credentials-uid"),ba.FIRST_PARTY=new ba("first-party-uid"),ba.MOCK_USER=new ba("mock-user");let ja="10.14.0";const ka=new Te("@firebase/firestore");function Na(){return ka.logLevel}function za(e){if(ka.logLevel<=ze.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Sa);ka.debug(`Firestore (${ja}): ${e}`,...i)}}function _a(e){if(ka.logLevel<=ze.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Sa);ka.error(`Firestore (${ja}): ${e}`,...i)}}function Ea(e){if(ka.logLevel<=ze.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Sa);ka.warn(`Firestore (${ja}): ${e}`,...i)}}function Sa(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function Ca(){const e=`FIRESTORE (${ja}) INTERNAL ASSERTION FAILED: `+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state");throw _a(e),new Error(e)}function Ta(e,t){e||Ca()}function Pa(e,t){return e}const Ia={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Aa extends le{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ma{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Da{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Ra{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ba.UNAUTHENTICATED)))}shutdown(){}}class Oa{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class La{constructor(e){this.t=e,this.currentUser=ba.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ta(void 0===this.o);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new Ma;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ma,e.enqueueRetryable((()=>r(this.currentUser)))};const a=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},s=e=>{za("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((e=>s(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?s(e):(za("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ma)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(za("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Ta("string"==typeof t.accessToken),new Da(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ta(null===e||"string"==typeof e),new ba(e)}}class Fa{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=ba.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Ua{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Fa(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(ba.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Va{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ba{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Ta(void 0===this.o);const n=e=>{null!=e.error&&za("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,za("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{za("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):za("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Ta("string"==typeof e.token),this.R=e.token,new Va(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function $a(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class Wa{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=$a(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function qa(e,t){return e<t?-1:e>t?1:0}function Ha(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}class Ka{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Aa(Ia.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Aa(Ia.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Aa(Ia.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Aa(Ia.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ka.fromMillis(Date.now())}static fromDate(e){return Ka.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Ka(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?qa(this.nanoseconds,e.nanoseconds):qa(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ga{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ga(e)}static min(){return new Ga(new Ka(0,0))}static max(){return new Ga(new Ka(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Qa{constructor(e,t,n){void 0===t?t=0:t>e.length&&Ca(),void 0===n?n=e.length-t:n>e.length-t&&Ca(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Qa.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Qa?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Za extends Qa{construct(e,t,n){return new Za(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new Aa(Ia.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter((e=>e.length>0)))}return new Za(e)}static emptyPath(){return new Za([])}}const Ya=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ja extends Qa{construct(e,t,n){return new Ja(e,t,n)}static isValidIdentifier(e){return Ya.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ja.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Ja(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Aa(Ia.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let a=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Aa(Ia.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Aa(Ia.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(a=!a,r++):"."!==t||a?(n+=t,r++):(i(),r++)}if(i(),a)throw new Aa(Ia.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ja(t)}static emptyPath(){return new Ja([])}}class Xa{constructor(e){this.path=e}static fromPath(e){return new Xa(Za.fromString(e))}static fromName(e){return new Xa(Za.fromString(e).popFirst(5))}static empty(){return new Xa(Za.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Za.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Za.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Xa(new Za(e.slice()))}}class es{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}es.UNKNOWN_ID=-1;function ts(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Ga.fromTimestamp(1e9===r?new Ka(n+1,0):new Ka(n,r));return new rs(i,Xa.empty(),t)}function ns(e){return new rs(e.readTime,e.key,-1)}class rs{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new rs(Ga.min(),Xa.empty(),-1)}static max(){return new rs(Ga.max(),Xa.empty(),-1)}}function is(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Xa.comparator(e.documentKey,t.documentKey),0!==n?n:qa(e.largestBatchId,t.largestBatchId))}const as="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ss{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function os(e){if(e.code!==Ia.FAILED_PRECONDITION||e.message!==as)throw e;za("LocalStore","Unexpectedly lost primary lease")}class ls{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ca(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ls(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ls?t:ls.resolve(t)}catch(e){return ls.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ls.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ls.reject(t)}static resolve(e){return new ls(((t,n)=>{t(e)}))}static reject(e){return new ls(((t,n)=>{n(e)}))}static waitFor(e){return new ls(((t,n)=>{let r=0,i=0,a=!1;e.forEach((e=>{++r,e.next((()=>{++i,a&&i===r&&t()}),(e=>n(e)))})),a=!0,i===r&&t()}))}static or(e){let t=ls.resolve(!1);for(const n of e)t=t.next((e=>e?ls.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new ls(((n,r)=>{const i=e.length,a=new Array(i);let s=0;for(let o=0;o<i;o++){const l=o;t(e[l]).next((e=>{a[l]=e,++s,s===i&&n(a)}),(e=>r(e)))}}))}static doWhile(e,t){return new ls(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}function cs(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ds(e){return"IndexedDbTransactionError"===e.name}class us{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function hs(e){return null==e}function ps(e){return 0===e&&1/e==-1/0}function ms(e){return"number"==typeof e&&Number.isInteger(e)&&!ps(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}us.oe=-1;const fs=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],ys=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],gs=ys,vs=[...gs,"indexConfiguration","indexState","indexEntries"];function ws(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function xs(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function bs(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class js{constructor(e,t){this.comparator=e,this.root=t||Ns.EMPTY}insert(e,t){return new js(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ns.BLACK,null,null))}remove(e){return new js(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ns.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ks(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ks(this.root,e,this.comparator,!1)}getReverseIterator(){return new ks(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ks(this.root,e,this.comparator,!0)}}class ks{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ns{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Ns.RED,this.left=null!=r?r:Ns.EMPTY,this.right=null!=i?i:Ns.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Ns(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Ns.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Ns.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ns.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ns.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ca();if(this.right.isRed())throw Ca();const e=this.left.check();if(e!==this.right.check())throw Ca();return e+(this.isRed()?0:1)}}Ns.EMPTY=null,Ns.RED=!0,Ns.BLACK=!1,Ns.EMPTY=new class{constructor(){this.size=0}get key(){throw Ca()}get value(){throw Ca()}get color(){throw Ca()}get left(){throw Ca()}get right(){throw Ca()}copy(e,t,n,r,i){return this}insert(e,t,n){return new Ns(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class zs{constructor(e){this.comparator=e,this.data=new js(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new _s(this.data.getIterator())}getIteratorFrom(e){return new _s(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof zs))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new zs(this.comparator);return t.data=e,t}}class _s{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Es{constructor(e){this.fields=e,e.sort(Ja.comparator)}static empty(){return new Es([])}unionWith(e){let t=new zs(Ja.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Es(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ha(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Ss extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Cs{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Ss("Invalid base64 string: "+e):e}}(e);return new Cs(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Cs(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qa(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Cs.EMPTY_BYTE_STRING=new Cs("");const Ts=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ps(e){if(Ta(!!e),"string"==typeof e){let t=0;const n=Ts.exec(e);if(Ta(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Is(e.seconds),nanos:Is(e.nanos)}}function Is(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function As(e){return"string"==typeof e?Cs.fromBase64String(e):Cs.fromUint8Array(e)}function Ms(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ds(e){const t=e.mapValue.fields.__previous_value__;return Ms(t)?Ds(t):t}function Rs(e){const t=Ps(e.mapValue.fields.__local_write_time__.timestampValue);return new Ka(t.seconds,t.nanos)}class Os{constructor(e,t,n,r,i,a,s,o,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=s,this.longPollingOptions=o,this.useFetchStreams=l}}class Ls{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Ls("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Ls&&e.projectId===this.projectId&&e.database===this.database}}const Fs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Us(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ms(e)?4:no(e)?9007199254740991:eo(e)?10:11:Ca()}function Vs(e,t){if(e===t)return!0;const n=Us(e);if(n!==Us(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Rs(e).isEqual(Rs(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Ps(e.timestampValue),r=Ps(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return As(e.bytesValue).isEqual(As(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Is(e.geoPointValue.latitude)===Is(t.geoPointValue.latitude)&&Is(e.geoPointValue.longitude)===Is(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Is(e.integerValue)===Is(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Is(e.doubleValue),r=Is(t.doubleValue);return n===r?ps(n)===ps(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Ha(e.arrayValue.values||[],t.arrayValue.values||[],Vs);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(ws(n)!==ws(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Vs(n[i],r[i])))return!1;return!0}(e,t);default:return Ca()}}function Bs(e,t){return void 0!==(e.values||[]).find((e=>Vs(e,t)))}function $s(e,t){if(e===t)return 0;const n=Us(e),r=Us(t);if(n!==r)return qa(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return qa(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Is(e.integerValue||e.doubleValue),r=Is(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Ws(e.timestampValue,t.timestampValue);case 4:return Ws(Rs(e),Rs(t));case 5:return qa(e.stringValue,t.stringValue);case 6:return function(e,t){const n=As(e),r=As(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=qa(n[i],r[i]);if(0!==e)return e}return qa(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=qa(Is(e.latitude),Is(t.latitude));return 0!==n?n:qa(Is(e.longitude),Is(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return qs(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,a;const s=e.fields||{},o=t.fields||{},l=null===(n=s.value)||void 0===n?void 0:n.arrayValue,c=null===(r=o.value)||void 0===r?void 0:r.arrayValue,d=qa((null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0,(null===(a=null==c?void 0:c.values)||void 0===a?void 0:a.length)||0);return 0!==d?d:qs(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Fs.mapValue&&t===Fs.mapValue)return 0;if(e===Fs.mapValue)return 1;if(t===Fs.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(let s=0;s<r.length&&s<a.length;++s){const e=qa(r[s],a[s]);if(0!==e)return e;const t=$s(n[r[s]],i[a[s]]);if(0!==t)return t}return qa(r.length,a.length)}(e.mapValue,t.mapValue);default:throw Ca()}}function Ws(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return qa(e,t);const n=Ps(e),r=Ps(t),i=qa(n.seconds,r.seconds);return 0!==i?i:qa(n.nanos,r.nanos)}function qs(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=$s(n[i],r[i]);if(e)return e}return qa(n.length,r.length)}function Hs(e){return Ks(e)}function Ks(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Ps(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return As(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return Xa.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Ks(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${Ks(e.fields[i])}`;return n+"}"}(e.mapValue):Ca()}function Gs(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Qs(e){return!!e&&"integerValue"in e}function Zs(e){return!!e&&"arrayValue"in e}function Ys(e){return!!e&&"nullValue"in e}function Js(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Xs(e){return!!e&&"mapValue"in e}function eo(e){var t,n;return"__vector__"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function to(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return xs(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=to(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=to(e.arrayValue.values[n]);return t}return Object.assign({},e)}function no(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class ro{constructor(e){this.value=e}static empty(){return new ro({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Xs(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=to(t)}setAll(e){let t=Ja.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=to(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Xs(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Vs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Xs(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){xs(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new ro(to(this.value))}}function io(e){const t=[];return xs(e.fields,((e,n)=>{const r=new Ja([e]);if(Xs(n)){const e=io(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new Es(t)}class ao{constructor(e,t,n,r,i,a,s){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=a,this.documentState=s}static newInvalidDocument(e){return new ao(e,0,Ga.min(),Ga.min(),Ga.min(),ro.empty(),0)}static newFoundDocument(e,t,n,r){return new ao(e,1,t,Ga.min(),n,r,0)}static newNoDocument(e,t){return new ao(e,2,t,Ga.min(),Ga.min(),ro.empty(),0)}static newUnknownDocument(e,t){return new ao(e,3,t,Ga.min(),Ga.min(),ro.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ga.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ro.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ro.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ga.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ao&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ao(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class so{constructor(e,t){this.position=e,this.inclusive=t}}function oo(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const a=t[i],s=e.position[i];if(r=a.field.isKeyField()?Xa.comparator(Xa.fromName(s.referenceValue),n.key):$s(s,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function lo(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Vs(e.position[n],t.position[n]))return!1;return!0}class co{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function uo(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class ho{}class po extends ho{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new bo(e,t,n):"array-contains"===t?new zo(e,n):"in"===t?new _o(e,n):"not-in"===t?new Eo(e,n):"array-contains-any"===t?new So(e,n):new po(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new jo(e,n):new ko(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison($s(t,this.value)):null!==t&&Us(this.value)===Us(t)&&this.matchesComparison($s(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Ca()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class mo extends ho{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new mo(e,t)}matches(e){return fo(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function fo(e){return"and"===e.op}function yo(e){return go(e)&&fo(e)}function go(e){for(const t of e.filters)if(t instanceof mo)return!1;return!0}function vo(e){if(e instanceof po)return e.field.canonicalString()+e.op.toString()+Hs(e.value);if(yo(e))return e.filters.map((e=>vo(e))).join(",");{const t=e.filters.map((e=>vo(e))).join(",");return`${e.op}(${t})`}}function wo(e,t){return e instanceof po?function(e,t){return t instanceof po&&e.op===t.op&&e.field.isEqual(t.field)&&Vs(e.value,t.value)}(e,t):e instanceof mo?function(e,t){return t instanceof mo&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&wo(n,t.filters[r])),!0)}(e,t):void Ca()}function xo(e){return e instanceof po?function(e){return`${e.field.canonicalString()} ${e.op} ${Hs(e.value)}`}(e):e instanceof mo?function(e){return e.op.toString()+" {"+e.getFilters().map(xo).join(" ,")+"}"}(e):"Filter"}class bo extends po{constructor(e,t,n){super(e,t,n),this.key=Xa.fromName(n.referenceValue)}matches(e){const t=Xa.comparator(e.key,this.key);return this.matchesComparison(t)}}class jo extends po{constructor(e,t){super(e,"in",t),this.keys=No("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class ko extends po{constructor(e,t){super(e,"not-in",t),this.keys=No("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function No(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>Xa.fromName(e.referenceValue)))}class zo extends po{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Zs(t)&&Bs(t.arrayValue,this.value)}}class _o extends po{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Bs(this.value.arrayValue,t)}}class Eo extends po{constructor(e,t){super(e,"not-in",t)}matches(e){if(Bs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Bs(this.value.arrayValue,t)}}class So extends po{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Zs(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Bs(this.value.arrayValue,e)))}}class Co{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=a,this.endAt=s,this.ue=null}}function To(e){return new Co(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Po(e){const t=Pa(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>vo(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),hs(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Hs(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Hs(e))).join(",")),t.ue=e}return t.ue}function Io(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!uo(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!wo(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!lo(e.startAt,t.startAt)&&lo(e.endAt,t.endAt)}function Ao(e){return Xa.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Mo{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=a,this.startAt=s,this.endAt=o,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Do(e,t,n,r,i,a,s,o){return new Mo(e,t,n,r,i,a,s,o)}function Ro(e){return new Mo(e)}function Oo(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Lo(e){return null!==e.collectionGroup}function Fo(e){const t=Pa(e);if(null===t.ce){t.ce=[];const e=new Set;for(const i of t.explicitOrderBy)t.ce.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new zs(Ja.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.ce.push(new co(r,n))})),e.has(Ja.keyField().canonicalString())||t.ce.push(new co(Ja.keyField(),n))}return t.ce}function Uo(e){const t=Pa(e);return t.le||(t.le=Vo(t,Fo(e))),t.le}function Vo(e,t){if("F"===e.limitType)return To(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new co(e.field,t)}));const n=e.endAt?new so(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new so(e.startAt.position,e.startAt.inclusive):null;return To(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Bo(e,t){const n=e.filters.concat([t]);return new Mo(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function $o(e,t,n){return new Mo(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Wo(e,t){return Io(Uo(e),Uo(t))&&e.limitType===t.limitType}function qo(e){return`${Po(Uo(e))}|lt:${e.limitType}`}function Ho(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>xo(e))).join(", ")}]`),hs(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Hs(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Hs(e))).join(",")),`Target(${t})`}(Uo(e))}; limitType=${e.limitType})`}function Ko(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Xa.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Fo(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=oo(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Fo(e),t))&&!(e.endAt&&!function(e,t,n){const r=oo(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Fo(e),t))}(e,t)}function Go(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Qo(e){return(t,n)=>{let r=!1;for(const i of Fo(e)){const e=Zo(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Zo(e,t,n){const r=e.field.isKeyField()?Xa.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?$s(r,i):Ca()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Ca()}}class Yo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){xs(this.inner,((t,n)=>{for(const[r,i]of n)e(r,i)}))}isEmpty(){return bs(this.inner)}size(){return this.innerSize}}const Jo=new js(Xa.comparator);function Xo(){return Jo}const el=new js(Xa.comparator);function tl(){let e=el;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function nl(e){let t=el;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function rl(){return al()}function il(){return al()}function al(){return new Yo((e=>e.toString()),((e,t)=>e.isEqual(t)))}const sl=new js(Xa.comparator),ol=new zs(Xa.comparator);function ll(){let e=ol;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const cl=new zs(qa);function dl(){return cl}function ul(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ps(t)?"-0":t}}function hl(e){return{integerValue:""+e}}function pl(e,t){return ms(t)?hl(t):ul(e,t)}class ml{constructor(){this._=void 0}}function fl(e,t,n){return e instanceof vl?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Ms(t)&&(t=Ds(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof wl?xl(e,t):e instanceof bl?jl(e,t):function(e,t){const n=gl(e,t),r=Nl(n)+Nl(e.Pe);return Qs(n)&&Qs(e.Pe)?hl(r):ul(e.serializer,r)}(e,t)}function yl(e,t,n){return e instanceof wl?xl(e,t):e instanceof bl?jl(e,t):n}function gl(e,t){return e instanceof kl?function(e){return Qs(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class vl extends ml{}class wl extends ml{constructor(e){super(),this.elements=e}}function xl(e,t){const n=zl(t);for(const r of e.elements)n.some((e=>Vs(e,r)))||n.push(r);return{arrayValue:{values:n}}}class bl extends ml{constructor(e){super(),this.elements=e}}function jl(e,t){let n=zl(t);for(const r of e.elements)n=n.filter((e=>!Vs(e,r)));return{arrayValue:{values:n}}}class kl extends ml{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Nl(e){return Is(e.integerValue||e.doubleValue)}function zl(e){return Zs(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class _l{constructor(e,t){this.version=e,this.transformResults=t}}class El{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new El}static exists(e){return new El(void 0,e)}static updateTime(e){return new El(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Sl(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Cl{}function Tl(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Ul(e.key,El.none()):new Dl(e.key,e.data,El.none());{const n=e.data,r=ro.empty();let i=new zs(Ja.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Rl(e.key,r,new Es(i.toArray()),El.none())}}function Pl(e,t,n){e instanceof Dl?function(e,t,n){const r=e.value.clone(),i=Ll(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Rl?function(e,t,n){if(!Sl(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Ll(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Ol(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Il(e,t,n,r){return e instanceof Dl?function(e,t,n,r){if(!Sl(e.precondition,t))return n;const i=e.value.clone(),a=Fl(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Rl?function(e,t,n,r){if(!Sl(e.precondition,t))return n;const i=Fl(e.fieldTransforms,r,t),a=t.data;return a.setAll(Ol(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return Sl(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Al(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=gl(r.transform,e||null);null!=i&&(null===n&&(n=ro.empty()),n.set(r.field,i))}return n||null}function Ml(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Ha(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof wl&&t instanceof wl||e instanceof bl&&t instanceof bl?Ha(e.elements,t.elements,Vs):e instanceof kl&&t instanceof kl?Vs(e.Pe,t.Pe):e instanceof vl&&t instanceof vl}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Dl extends Cl{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Rl extends Cl{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Ol(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function Ll(e,t,n){const r=new Map;Ta(e.length===n.length);for(let i=0;i<n.length;i++){const a=e[i],s=a.transform,o=t.data.field(a.field);r.set(a.field,yl(s,o,n[i]))}return r}function Fl(e,t,n){const r=new Map;for(const i of e){const e=i.transform,a=n.data.field(i.field);r.set(i.field,fl(e,a,t))}return r}class Ul extends Cl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Vl extends Cl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Bl{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Pl(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Il(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Il(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=il();return this.mutations.forEach((r=>{const i=e.get(r.key),a=i.overlayedDocument;let s=this.applyToLocalView(a,i.mutatedFields);s=t.has(r.key)?null:s;const o=Tl(a,s);null!==o&&n.set(r.key,o),a.isValidDocument()||a.convertToNoDocument(Ga.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ll())}isEqual(e){return this.batchId===e.batchId&&Ha(this.mutations,e.mutations,((e,t)=>Ml(e,t)))&&Ha(this.baseMutations,e.baseMutations,((e,t)=>Ml(e,t)))}}class $l{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Ta(e.mutations.length===n.length);let r=sl;const i=e.mutations;for(let a=0;a<i.length;a++)r=r.insert(i[a].key,n[a].version);return new $l(e,t,n,r)}}class Wl{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class ql{constructor(e,t){this.count=e,this.unchangedNames=t}}var Hl,Kl;function Gl(e){switch(e){default:return Ca();case Ia.CANCELLED:case Ia.UNKNOWN:case Ia.DEADLINE_EXCEEDED:case Ia.RESOURCE_EXHAUSTED:case Ia.INTERNAL:case Ia.UNAVAILABLE:case Ia.UNAUTHENTICATED:return!1;case Ia.INVALID_ARGUMENT:case Ia.NOT_FOUND:case Ia.ALREADY_EXISTS:case Ia.PERMISSION_DENIED:case Ia.FAILED_PRECONDITION:case Ia.ABORTED:case Ia.OUT_OF_RANGE:case Ia.UNIMPLEMENTED:case Ia.DATA_LOSS:return!0}}function Ql(e){if(void 0===e)return _a("GRPC error has no .code"),Ia.UNKNOWN;switch(e){case Hl.OK:return Ia.OK;case Hl.CANCELLED:return Ia.CANCELLED;case Hl.UNKNOWN:return Ia.UNKNOWN;case Hl.DEADLINE_EXCEEDED:return Ia.DEADLINE_EXCEEDED;case Hl.RESOURCE_EXHAUSTED:return Ia.RESOURCE_EXHAUSTED;case Hl.INTERNAL:return Ia.INTERNAL;case Hl.UNAVAILABLE:return Ia.UNAVAILABLE;case Hl.UNAUTHENTICATED:return Ia.UNAUTHENTICATED;case Hl.INVALID_ARGUMENT:return Ia.INVALID_ARGUMENT;case Hl.NOT_FOUND:return Ia.NOT_FOUND;case Hl.ALREADY_EXISTS:return Ia.ALREADY_EXISTS;case Hl.PERMISSION_DENIED:return Ia.PERMISSION_DENIED;case Hl.FAILED_PRECONDITION:return Ia.FAILED_PRECONDITION;case Hl.ABORTED:return Ia.ABORTED;case Hl.OUT_OF_RANGE:return Ia.OUT_OF_RANGE;case Hl.UNIMPLEMENTED:return Ia.UNIMPLEMENTED;case Hl.DATA_LOSS:return Ia.DATA_LOSS;default:return Ca()}}(Kl=Hl||(Hl={}))[Kl.OK=0]="OK",Kl[Kl.CANCELLED=1]="CANCELLED",Kl[Kl.UNKNOWN=2]="UNKNOWN",Kl[Kl.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Kl[Kl.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Kl[Kl.NOT_FOUND=5]="NOT_FOUND",Kl[Kl.ALREADY_EXISTS=6]="ALREADY_EXISTS",Kl[Kl.PERMISSION_DENIED=7]="PERMISSION_DENIED",Kl[Kl.UNAUTHENTICATED=16]="UNAUTHENTICATED",Kl[Kl.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Kl[Kl.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Kl[Kl.ABORTED=10]="ABORTED",Kl[Kl.OUT_OF_RANGE=11]="OUT_OF_RANGE",Kl[Kl.UNIMPLEMENTED=12]="UNIMPLEMENTED",Kl[Kl.INTERNAL=13]="INTERNAL",Kl[Kl.UNAVAILABLE=14]="UNAVAILABLE",Kl[Kl.DATA_LOSS=15]="DATA_LOSS";let Zl=null;function Yl(){return new TextEncoder}const Jl=new sa([4294967295,4294967295],0);function Xl(e){const t=Yl().encode(e),n=new oa;return n.update(t),new Uint8Array(n.digest())}function ec(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new sa([n,r],0),new sa([i,a],0)]}class tc{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new nc(`Invalid padding: ${t}`);if(n<0)throw new nc(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new nc(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new nc(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=sa.fromNumber(this.Ie)}Ee(e,t,n){let r=e.add(t.multiply(sa.fromNumber(n)));return 1===r.compare(Jl)&&(r=new sa([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=Xl(e),[n,r]=ec(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);if(!this.de(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new tc(i,r,t);return n.forEach((e=>a.insert(e))),a}insert(e){if(0===this.Ie)return;const t=Xl(e),[n,r]=ec(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class nc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class rc{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,ic.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new rc(Ga.min(),r,new js(qa),Xo(),ll())}}class ic{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new ic(n,t,ll(),ll(),ll())}}class ac{constructor(e,t,n,r){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=r}}class sc{constructor(e,t){this.targetId=e,this.me=t}}class oc{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Cs.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class lc{constructor(){this.fe=0,this.ge=uc(),this.pe=Cs.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ll(),t=ll(),n=ll();return this.ge.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Ca()}})),new ic(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=uc()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ta(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class cc{constructor(e){this.Le=e,this.Be=new Map,this.ke=Xo(),this.qe=dc(),this.Qe=new js(qa)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,(t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:Ca()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((e,n)=>{this.ze(n)&&t(n)}))}He(e){const t=e.targetId,n=e.me.count,r=this.Je(t);if(r){const i=r.target;if(Ao(i))if(0===n){const e=new Xa(i.path);this.Ue(t,e,ao.newNoDocument(e,Ga.min()))}else Ta(1===n);else{const r=this.Ye(t);if(r!==n){const n=this.Ze(e),i=n?this.Xe(n,e,r):1;if(0!==i){this.je(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}null==Zl||Zl.et(function(e,t,n,r,i){var a,s,o,l,c,d;const u={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(u.bloomFilter={applied:0===i,hashCount:null!==(a=null==h?void 0:h.hashCount)&&void 0!==a?a:0,bitmapLength:null!==(l=null===(o=null===(s=null==h?void 0:h.bits)||void 0===s?void 0:s.bitmap)||void 0===o?void 0:o.length)&&void 0!==l?l:0,padding:null!==(d=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==d?d:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),u}(r,e.me,this.Le.tt(),n,i))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let a,s;try{a=As(n).toUint8Array()}catch(e){if(e instanceof Ss)return Ea("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{s=new tc(a,r,i)}catch(e){return Ea(e instanceof nc?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===s.Ie?null:s}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const i=this.Le.tt(),a=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,n,null),r++)})),r}rt(e){const t=new Map;this.Be.forEach(((n,r)=>{const i=this.Je(r);if(i){if(n.current&&Ao(i.target)){const t=new Xa(i.target.path);null!==this.ke.get(t)||this.it(r,t)||this.Ue(r,t,ao.newNoDocument(t,e))}n.be&&(t.set(r,n.ve()),n.Ce())}}));let n=ll();this.qe.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.ke.forEach(((t,n)=>n.setReadTime(e)));const r=new rc(e,t,this.Qe,this.ke,n);return this.ke=Xo(),this.qe=dc(),this.Qe=new js(qa),r}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new lc,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new zs(qa),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||za("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new lc),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.Ue(e,t,null)}))}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function dc(){return new js(Xa.comparator)}function uc(){return new js(Xa.comparator)}const hc={asc:"ASCENDING",desc:"DESCENDING"},pc={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},mc={and:"AND",or:"OR"};class fc{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function yc(e,t){return e.useProto3Json||hs(t)?t:{value:t}}function gc(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function vc(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function wc(e,t){return gc(e,t.toTimestamp())}function xc(e){return Ta(!!e),Ga.fromTimestamp(function(e){const t=Ps(e);return new Ka(t.seconds,t.nanos)}(e))}function bc(e,t){return jc(e,t).canonicalString()}function jc(e,t){const n=function(e){return new Za(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function kc(e){const t=Za.fromString(e);return Ta($c(t)),t}function Nc(e,t){return bc(e.databaseId,t.path)}function zc(e,t){const n=kc(t);if(n.get(1)!==e.databaseId.projectId)throw new Aa(Ia.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Aa(Ia.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Xa(Cc(n))}function _c(e,t){return bc(e.databaseId,t)}function Ec(e){const t=kc(e);return 4===t.length?Za.emptyPath():Cc(t)}function Sc(e){return new Za(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Cc(e){return Ta(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Tc(e,t,n){return{name:Nc(e,t),fields:n.value.mapValue.fields}}function Pc(e,t){let n;if(t instanceof Dl)n={update:Tc(e,t.key,t.value)};else if(t instanceof Ul)n={delete:Nc(e,t.key)};else if(t instanceof Rl)n={update:Tc(e,t.key,t.data),updateMask:Bc(t.fieldMask)};else{if(!(t instanceof Vl))return Ca();n={verify:Nc(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof vl)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof wl)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof bl)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof kl)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw Ca()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:wc(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Ca()}(e,t.precondition)),n}function Ic(e,t){return{documents:[_c(e,t.path)]}}function Ac(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=_c(e,i);const a=function(e){if(0!==e.length)return Vc(mo.create(e,"and"))}(t.filters);a&&(n.structuredQuery.where=a);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Fc(e.field),direction:Rc(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=yc(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:i}}function Mc(e){let t=Ec(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Ta(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let a=[];n.where&&(a=function(e){const t=Dc(e);return t instanceof mo&&yo(t)?t.getFilters():[t]}(n.where));let s=[];n.orderBy&&(s=function(e){return e.map((e=>function(e){return new co(Uc(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,hs(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new so(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new so(n,t)}(n.endAt)),Do(t,i,s,a,o,"F",l,c)}function Dc(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Uc(e.unaryFilter.field);return po.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Uc(e.unaryFilter.field);return po.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Uc(e.unaryFilter.field);return po.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Uc(e.unaryFilter.field);return po.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Ca()}}(e):void 0!==e.fieldFilter?function(e){return po.create(Uc(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ca()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return mo.create(e.compositeFilter.filters.map((e=>Dc(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Ca()}}(e.compositeFilter.op))}(e):Ca()}function Rc(e){return hc[e]}function Oc(e){return pc[e]}function Lc(e){return mc[e]}function Fc(e){return{fieldPath:e.canonicalString()}}function Uc(e){return Ja.fromServerFormat(e.fieldPath)}function Vc(e){return e instanceof po?function(e){if("=="===e.op){if(Js(e.value))return{unaryFilter:{field:Fc(e.field),op:"IS_NAN"}};if(Ys(e.value))return{unaryFilter:{field:Fc(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Js(e.value))return{unaryFilter:{field:Fc(e.field),op:"IS_NOT_NAN"}};if(Ys(e.value))return{unaryFilter:{field:Fc(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fc(e.field),op:Oc(e.op),value:e.value}}}(e):e instanceof mo?function(e){const t=e.getFilters().map((e=>Vc(e)));return 1===t.length?t[0]:{compositeFilter:{op:Lc(e.op),filters:t}}}(e):Ca()}function Bc(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function $c(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Wc{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ga.min(),a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ga.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Cs.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=s,this.expectedCount=o}withSequenceNumber(e){return new Wc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Wc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class qc{constructor(e){this.ct=e}}function Hc(e){const t=Mc({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?$o(t,t.limit,"L"):t}class Kc{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Is(e.integerValue));else if("doubleValue"in e){const n=Is(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),ps(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),"string"==typeof n&&(n=Ps(n)),t.Rt(`${n.seconds||""}`),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(As(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?no(e)?this.dt(t,Number.MAX_SAFE_INTEGER):eo(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Ca()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const n=e.fields||{};this.dt(t,55);for(const r of Object.keys(n))this.Vt(r,t),this.Tt(n[r],t)}wt(e,t){var n,r;const i=e.fields||{};this.dt(t,53);const a="value",s=(null===(r=null===(n=i[a].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.dt(t,15),t.At(Is(s)),this.Vt(a,t),this.Tt(i[a],t)}bt(e,t){const n=e.values||[];this.dt(t,50);for(const r of n)this.Tt(r,t)}yt(e,t){this.dt(t,37),Xa.fromName(e).path.forEach((e=>{this.dt(t,60),this.Dt(e,t)}))}dt(e,t){e.At(t)}ft(e){e.At(2)}}Kc.vt=new Kc;class Gc{constructor(){this.un=new Qc}addToCollectionParentIndex(e,t){return this.un.add(t),ls.resolve()}getCollectionParents(e,t){return ls.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return ls.resolve()}deleteFieldIndex(e,t){return ls.resolve()}deleteAllFieldIndexes(e){return ls.resolve()}createTargetIndexes(e,t){return ls.resolve()}getDocumentsMatchingTarget(e,t){return ls.resolve(null)}getIndexType(e,t){return ls.resolve(0)}getFieldIndexes(e,t){return ls.resolve([])}getNextCollectionGroupToUpdate(e){return ls.resolve(null)}getMinOffset(e,t){return ls.resolve(rs.min())}getMinOffsetFromCollectionGroup(e,t){return ls.resolve(rs.min())}updateCollectionGroup(e,t,n){return ls.resolve()}updateIndexEntries(e,t){return ls.resolve()}}class Qc{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new zs(Za.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new zs(Za.comparator)).toArray()}}new Uint8Array(0);class Zc{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Zc(e,Zc.DEFAULT_COLLECTION_PERCENTILE,Zc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Zc.DEFAULT_COLLECTION_PERCENTILE=10,Zc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Zc.DEFAULT=new Zc(41943040,Zc.DEFAULT_COLLECTION_PERCENTILE,Zc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Zc.DISABLED=new Zc(-1,0,0);class Yc{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Yc(0)}static kn(){return new Yc(-1)}}class Jc{constructor(){this.changes=new Yo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ao.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?ls.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Xc{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ed{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&Il(n.mutation,e,Es.empty(),Ka.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,ll()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ll();const r=rl();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=tl();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=rl();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,ll())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=Xo();const a=al(),s=al();return t.forEach(((e,t)=>{const s=n.get(t.key);r.has(t.key)&&(void 0===s||s.mutation instanceof Rl)?i=i.insert(t.key,t):void 0!==s?(a.set(t.key,s.mutation.getFieldMask()),Il(s.mutation,t,s.mutation.getFieldMask(),Ka.now())):a.set(t.key,Es.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>a.set(e,t))),t.forEach(((e,t)=>{var n;return s.set(e,new Xc(t,null!==(n=a.get(e))&&void 0!==n?n:null))})),s)))}recalculateAndSaveOverlays(e,t){const n=al();let r=new js(((e,t)=>e-t)),i=ll();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const a=t.get(e);if(null===a)return;let s=n.get(e)||Es.empty();s=i.applyToLocalView(a,s),n.set(e,s);const o=(r.get(i.batchId)||ll()).add(e);r=r.insert(i.batchId,o)}))})).next((()=>{const a=[],s=r.getReverseIterator();for(;s.hasNext();){const r=s.getNext(),o=r.key,l=r.value,c=il();l.forEach((e=>{if(!i.has(e)){const r=Tl(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}})),a.push(this.documentOverlayCache.saveOverlays(e,o,c))}return ls.waitFor(a)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return Xa.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Lo(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const a=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):ls.resolve(rl());let s=-1,o=i;return a.next((t=>ls.forEach(t,((t,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),i.get(t)?ls.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{o=o.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,o,t,ll()))).next((e=>({batchId:s,changes:nl(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Xa(t)).next((e=>{let t=tl();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let a=tl();return this.indexManager.getCollectionParents(e,i).next((s=>ls.forEach(s,(s=>{const o=function(e,t){return new Mo(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(i));return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next((e=>{e.forEach(((e,t)=>{a=a.insert(e,t)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,ao.newInvalidDocument(r)))}));let n=tl();return e.forEach(((e,r)=>{const a=i.get(e);void 0!==a&&Il(a.mutation,r,Es.empty(),Ka.now()),Ko(t,r)&&(n=n.insert(e,r))})),n}))}}class td{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return ls.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:xc(e.createTime)}}(t)),ls.resolve()}getNamedQuery(e,t){return ls.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(e){return{name:e.name,query:Hc(e.bundledQuery),readTime:xc(e.readTime)}}(t)),ls.resolve()}}class nd{constructor(){this.overlays=new js(Xa.comparator),this.Ir=new Map}getOverlay(e,t){return ls.resolve(this.overlays.get(t))}getOverlays(e,t){const n=rl();return ls.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.ht(e,t,r)})),ls.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Ir.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.Ir.delete(n)),ls.resolve()}getOverlaysForCollection(e,t,n){const r=rl(),i=t.length+1,a=new Xa(t.child("")),s=this.overlays.getIteratorFrom(a);for(;s.hasNext();){const e=s.getNext().value,a=e.getKey();if(!t.isPrefixOf(a.path))break;a.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return ls.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new js(((e,t)=>e-t));const a=this.overlays.getIterator();for(;a.hasNext();){const e=a.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=rl(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const s=rl(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach(((e,t)=>s.set(e,t))),!(s.size()>=r)););return ls.resolve(s)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Ir.get(r.largestBatchId).delete(n.key);this.Ir.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Wl(t,n));let i=this.Ir.get(t);void 0===i&&(i=ll(),this.Ir.set(t,i)),this.Ir.set(t,i.add(n.key))}}class rd{constructor(){this.sessionToken=Cs.EMPTY_BYTE_STRING}getSessionToken(e){return ls.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ls.resolve()}}class id{constructor(){this.Tr=new zs(ad.Er),this.dr=new zs(ad.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new ad(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Vr(new ad(e,t))}mr(e,t){e.forEach((e=>this.removeReference(e,t)))}gr(e){const t=new Xa(new Za([])),n=new ad(t,e),r=new ad(t,e+1),i=[];return this.dr.forEachInRange([n,r],(e=>{this.Vr(e),i.push(e.key)})),i}pr(){this.Tr.forEach((e=>this.Vr(e)))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new Xa(new Za([])),n=new ad(t,e),r=new ad(t,e+1);let i=ll();return this.dr.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new ad(e,0),n=this.Tr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class ad{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return Xa.comparator(e.key,t.key)||qa(e.wr,t.wr)}static Ar(e,t){return qa(e.wr,t.wr)||Xa.comparator(e.key,t.key)}}class sd{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new zs(ad.Er)}checkEmpty(e){return ls.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Bl(i,t,n,r);this.mutationQueue.push(a);for(const s of r)this.br=this.br.add(new ad(s.key,i)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast());return ls.resolve(a)}lookupMutationBatch(e,t){return ls.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.vr(n),i=r<0?0:r;return ls.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ls.resolve(0===this.mutationQueue.length?-1:this.Sr-1)}getAllMutationBatches(e){return ls.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new ad(t,0),r=new ad(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,r],(e=>{const t=this.Dr(e.wr);i.push(t)})),ls.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new zs(qa);return t.forEach((e=>{const t=new ad(e,0),r=new ad(e,Number.POSITIVE_INFINITY);this.br.forEachInRange([t,r],(e=>{n=n.add(e.wr)}))})),ls.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;Xa.isDocumentKey(i)||(i=i.child(""));const a=new ad(new Xa(i),0);let s=new zs(qa);return this.br.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(s=s.add(e.wr)),!0)}),a),ls.resolve(this.Cr(s))}Cr(e){const t=[];return e.forEach((e=>{const n=this.Dr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Ta(0===this.Fr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.br;return ls.forEach(t.mutations,(r=>{const i=new ad(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.br=n}))}On(e){}containsKey(e,t){const n=new ad(t,0),r=this.br.firstAfterOrEqual(n);return ls.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ls.resolve()}Fr(e,t){return this.vr(e)}vr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class od{constructor(e){this.Mr=e,this.docs=new js(Xa.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ls.resolve(n?n.document.mutableCopy():ao.newInvalidDocument(t))}getEntries(e,t){let n=Xo();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():ao.newInvalidDocument(e))})),ls.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Xo();const a=t.path,s=new Xa(a.child("")),o=this.docs.getIteratorFrom(s);for(;o.hasNext();){const{key:e,value:{document:s}}=o.getNext();if(!a.isPrefixOf(e.path))break;e.path.length>a.length+1||is(ns(s),n)<=0||(r.has(s.key)||Ko(t,s))&&(i=i.insert(s.key,s.mutableCopy()))}return ls.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Ca()}Or(e,t){return ls.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new ld(this)}getSize(e){return ls.resolve(this.size)}}class ld extends Jc{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(n)})),ls.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}class cd{constructor(e){this.persistence=e,this.Nr=new Yo((e=>Po(e)),Io),this.lastRemoteSnapshotVersion=Ga.min(),this.highestTargetId=0,this.Lr=0,this.Br=new id,this.targetCount=0,this.kr=Yc.Bn()}forEachTarget(e,t){return this.Nr.forEach(((e,n)=>t(n))),ls.resolve()}getLastRemoteSnapshotVersion(e){return ls.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ls.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),ls.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),ls.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Yc(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,ls.resolve()}updateTargetData(e,t){return this.Kn(t),ls.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,ls.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Nr.forEach(((a,s)=>{s.sequenceNumber<=t&&null===n.get(s.targetId)&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,s.targetId)),r++)})),ls.waitFor(i).next((()=>r))}getTargetCount(e){return ls.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return ls.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),ls.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),ls.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),ls.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return ls.resolve(n)}containsKey(e,t){return ls.resolve(this.Br.containsKey(t))}}class dd{constructor(e,t){this.qr={},this.overlays={},this.Qr=new us(0),this.Kr=!1,this.Kr=!0,this.$r=new rd,this.referenceDelegate=e(this),this.Ur=new cd(this),this.indexManager=new Gc,this.remoteDocumentCache=function(e){return new od(e)}((e=>this.referenceDelegate.Wr(e))),this.serializer=new qc(t),this.Gr=new td(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new nd,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new sd(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){za("MemoryPersistence","Starting transaction:",e);const r=new ud(this.Qr.next());return this.referenceDelegate.zr(),n(r).next((e=>this.referenceDelegate.jr(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Hr(e,t){return ls.or(Object.values(this.qr).map((n=>()=>n.containsKey(e,t))))}}class ud extends ss{constructor(e){super(),this.currentSequenceNumber=e}}class hd{constructor(e){this.persistence=e,this.Jr=new id,this.Yr=null}static Zr(e){return new hd(e)}get Xr(){if(this.Yr)return this.Yr;throw Ca()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),ls.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),ls.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),ls.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach((e=>this.Xr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Xr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ls.forEach(this.Xr,(n=>{const r=Xa.fromPath(n);return this.ei(e,r).next((e=>{e||t.removeEntry(r,Ga.min())}))})).next((()=>(this.Yr=null,t.apply(e))))}updateLimboDocument(e,t){return this.ei(e,t).next((e=>{e?this.Xr.delete(t.toString()):this.Xr.add(t.toString())}))}Wr(e){return 0}ei(e,t){return ls.or([()=>ls.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class pd{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=r}static Wi(e,t){let n=ll(),r=ll();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new pd(e,t.fromCache,n,r)}}class md{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class fd{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=ae()?8:cs(re())>0?6:4}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.Yi(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.Zi(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const n=new md;return this.Xi(e,t,n).next((r=>{if(i.result=r,this.zi)return this.es(e,t,n,r.size)}))})).next((()=>i.result))}es(e,t,n,r){return n.documentReadCount<this.ji?(Na()<=ze.DEBUG&&za("QueryEngine","SDK will not create cache indexes for query:",Ho(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ls.resolve()):(Na()<=ze.DEBUG&&za("QueryEngine","Query:",Ho(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Hi*r?(Na()<=ze.DEBUG&&za("QueryEngine","The SDK decides to create cache indexes for query:",Ho(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Uo(t))):ls.resolve())}Yi(e,t){if(Oo(t))return ls.resolve(null);let n=Uo(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=$o(t,null,"F"),n=Uo(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=ll(...r);return this.Ji.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const a=this.ts(t,r);return this.ns(t,a,i,n.readTime)?this.Yi(e,$o(t,null,"F")):this.rs(e,a,t,n)}))))})))))}Zi(e,t,n,r){return Oo(t)||r.isEqual(Ga.min())?ls.resolve(null):this.Ji.getDocuments(e,n).next((i=>{const a=this.ts(t,i);return this.ns(t,a,n,r)?ls.resolve(null):(Na()<=ze.DEBUG&&za("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Ho(t)),this.rs(e,a,t,ts(r,-1)).next((e=>e)))}))}ts(e,t){let n=new zs(Qo(e));return t.forEach(((t,r)=>{Ko(e,r)&&(n=n.add(r))})),n}ns(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Xi(e,t,n){return Na()<=ze.DEBUG&&za("QueryEngine","Using full collection scan to execute query:",Ho(t)),this.Ji.getDocumentsMatchingQuery(e,t,rs.min(),n)}rs(e,t,n,r){return this.Ji.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class yd{constructor(e,t,n,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new js(qa),this._s=new Yo((e=>Po(e)),Io),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ed(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.os)))}}function gd(e,t,n,r){return new yd(e,t,n,r)}async function vd(e,t){const n=Pa(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.ls(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],a=[];let s=ll();for(const e of r){i.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}for(const e of t){a.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}return n.localDocuments.getDocuments(e,s).next((e=>({hs:e,removedBatchIds:i,addedBatchIds:a})))}))}))}function wd(e){const t=Pa(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Ur.getLastRemoteSnapshotVersion(e)))}function xd(e,t,n){let r=ll(),i=ll();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=Xo();return n.forEach(((n,a)=>{const s=e.get(n);a.isFoundDocument()!==s.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(Ga.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!s.isValidDocument()||a.version.compareTo(s.version)>0||0===a.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):za("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",a.version)})),{Ps:r,Is:i}}))}function bd(e,t){const n=Pa(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function jd(e,t){const n=Pa(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Ur.getTargetData(e,t).next((i=>i?(r=i,ls.resolve(r)):n.Ur.allocateTargetId(e).next((i=>(r=new Wc(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Ur.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.os.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.os=n.os.insert(e.targetId,e),n._s.set(t,e.targetId)),e}))}async function kd(e,t,n){const r=Pa(e),i=r.os.get(t),a=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",a,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!ds(e))throw e;za("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.os=r.os.remove(t),r._s.delete(i.target)}function Nd(e,t,n){const r=Pa(e);let i=Ga.min(),a=ll();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=Pa(e),i=r._s.get(n);return void 0!==i?ls.resolve(r.os.get(i)):r.Ur.getTargetData(t,n)}(r,e,Uo(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(e,t.targetId).next((e=>{a=e}))})).next((()=>r.ss.getDocumentsMatchingQuery(e,t,n?i:Ga.min(),n?a:ll()))).next((e=>(zd(r,Go(t),e),{documents:e,Ts:a})))))}function zd(e,t,n){let r=e.us.get(t)||Ga.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.us.set(t,r)}class _d{constructor(){this.activeTargetIds=dl()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ed{constructor(){this.so=new _d,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new _d,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Sd{_o(e){}shutdown(){}}class Cd{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){za("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){za("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Td=null;function Pd(){return null===Td?Td=268435456+Math.round(2147483648*Math.random()):Td++,"0x"+Td.toString(16)}const Id={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Ad{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}const Md="WebChannelConnection";class Dd extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Do=t+"://"+e.host,this.vo=`projects/${n}/databases/${r}`,this.Co="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${r}`}get Fo(){return!1}Mo(e,t,n,r,i){const a=Pd(),s=this.xo(e,t.toUriEncodedString());za("RestConnection",`Sending RPC '${e}' ${a}:`,s,n);const o={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(o,r,i),this.No(e,s,o,n).then((t=>(za("RestConnection",`Received RPC '${e}' ${a}: `,t),t)),(t=>{throw Ea("RestConnection",`RPC '${e}' ${a} failed with error: `,t,"url: ",s,"request:",n),t}))}Lo(e,t,n,r,i,a){return this.Mo(e,t,n,r,i)}Oo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+ja,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}xo(e,t){const n=Id[e];return`${this.Do}/v1/${t}:${n}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,r){const i=Pd();return new Promise(((a,s)=>{const o=new da;o.setWithCredentials(!0),o.listenOnce(ha.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case pa.NO_ERROR:const t=o.getResponseJson();za(Md,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),a(t);break;case pa.TIMEOUT:za(Md,`RPC '${e}' ${i} timed out`),s(new Aa(Ia.DEADLINE_EXCEEDED,"Request time out"));break;case pa.HTTP_ERROR:const n=o.getStatus();if(za(Md,`RPC '${e}' ${i} failed with status:`,n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Ia).indexOf(t)>=0?t:Ia.UNKNOWN}(t.status);s(new Aa(e,t.message))}else s(new Aa(Ia.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Aa(Ia.UNAVAILABLE,"Connection failed."));break;default:Ca()}}finally{za(Md,`RPC '${e}' ${i} completed.`)}}));const l=JSON.stringify(r);za(Md,`RPC '${e}' ${i} sending request:`,r),o.send(t,"POST",l,n,15)}))}Bo(e,t,n){const r=Pd(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=ga(),s=ya(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Oo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=i.join("");za(Md,`Creating RPC '${e}' stream ${r}: ${c}`,o);const d=a.createWebChannel(c,o);let u=!1,h=!1;const p=new Ad({Io:t=>{h?za(Md,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(u||(za(Md,`Opening RPC '${e}' stream ${r} transport.`),d.open(),u=!0),za(Md,`RPC '${e}' stream ${r} sending:`,t),d.send(t))},To:()=>d.close()}),m=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return m(d,ua.EventType.OPEN,(()=>{h||(za(Md,`RPC '${e}' stream ${r} transport opened.`),p.yo())})),m(d,ua.EventType.CLOSE,(()=>{h||(h=!0,za(Md,`RPC '${e}' stream ${r} transport closed`),p.So())})),m(d,ua.EventType.ERROR,(t=>{h||(h=!0,Ea(Md,`RPC '${e}' stream ${r} transport errored:`,t),p.So(new Aa(Ia.UNAVAILABLE,"The operation could not be completed")))})),m(d,ua.EventType.MESSAGE,(t=>{var n;if(!h){const i=t.data[0];Ta(!!i);const a=i,s=a.error||(null===(n=a[0])||void 0===n?void 0:n.error);if(s){za(Md,`RPC '${e}' stream ${r} received error:`,s);const t=s.status;let n=function(e){const t=Hl[e];if(void 0!==t)return Ql(t)}(t),i=s.message;void 0===n&&(n=Ia.INTERNAL,i="Unknown error status: "+t+" with message "+s.message),h=!0,p.So(new Aa(n,i)),d.close()}else za(Md,`RPC '${e}' stream ${r} received:`,i),p.bo(i)}})),m(s,fa.STAT_EVENT,(t=>{t.stat===ma.PROXY?za(Md,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===ma.NOPROXY&&za(Md,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{p.wo()}),0),p}}function Rd(){return"undefined"!=typeof document?document:null}function Od(e){return new fc(e,!0)}class Ld{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ui=e,this.timerId=t,this.ko=n,this.qo=r,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-n);r>0&&za("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,(()=>(this.Uo=Date.now(),e()))),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){null!==this.$o&&(this.$o.skipDelay(),this.$o=null)}cancel(){null!==this.$o&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}class Fd{constructor(e,t,n,r,i,a,s,o){this.ui=e,this.Ho=n,this.Jo=r,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=s,this.listener=o,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Ld(e,t)}n_(){return 1===this.state||5===this.state||this.r_()}r_(){return 2===this.state||3===this.state}start(){this.e_=0,4!==this.state?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&null===this.Zo&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,(()=>this.__())))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,4!==e?this.t_.reset():t&&t.code===Ia.RESOURCE_EXHAUSTED?(_a(t.toString()),_a("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===Ia.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,r]=e;this.Yo===t&&this.P_(n,r)}),(t=>{e((()=>{const e=new Aa(Ia.UNKNOWN,"Fetching auth token failed: "+t.message);return this.I_(e)}))}))}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo((()=>{n((()=>this.listener.Eo()))})),this.stream.Ro((()=>{n((()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,(()=>(this.r_()&&(this.state=3),Promise.resolve()))),this.listener.Ro())))})),this.stream.mo((e=>{n((()=>this.I_(e)))})),this.stream.onMessage((e=>{n((()=>1==++this.e_?this.E_(e):this.onNext(e)))}))}i_(){this.state=5,this.t_.Go((async()=>{this.state=0,this.start()}))}I_(e){return za("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget((()=>this.Yo===e?t():(za("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Ud extends Fd{constructor(e,t,n,r,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,a),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Ca()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],a=function(e,t){return e.useProto3Json?(Ta(void 0===t||"string"==typeof t),Cs.fromBase64String(t||"")):(Ta(void 0===t||t instanceof Buffer||t instanceof Uint8Array),Cs.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,o=s&&function(e){const t=void 0===e.code?Ia.UNKNOWN:Ql(e.code);return new Aa(t,e.message||"")}(s);n=new oc(r,i,a,o||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=zc(e,r.document.name),a=xc(r.document.updateTime),s=r.document.createTime?xc(r.document.createTime):Ga.min(),o=new ro({mapValue:{fields:r.document.fields}}),l=ao.newFoundDocument(i,a,s,o),c=r.targetIds||[],d=r.removedTargetIds||[];n=new ac(c,d,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=zc(e,r.document),a=r.readTime?xc(r.readTime):Ga.min(),s=ao.newNoDocument(i,a),o=r.removedTargetIds||[];n=new ac([],o,s.key,s)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=zc(e,r.document),a=r.removedTargetIds||[];n=new ac([],a,i,null)}else{if(!("filter"in t))return Ca();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,a=new ql(r,i),s=e.targetId;n=new sc(s,a)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Ga.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Ga.min():t.readTime?xc(t.readTime):Ga.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=Sc(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Ao(r)?{documents:Ic(e,r)}:{query:Ac(e,r)._t},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=vc(e,t.resumeToken);const r=yc(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Ga.min())>0){n.readTime=gc(e,t.snapshotVersion.toTimestamp());const r=yc(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ca()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=Sc(this.serializer),t.removeTarget=e,this.a_(t)}}class Vd extends Fd{constructor(e,t,n,r,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Ta(!!e.streamToken),this.lastStreamToken=e.streamToken,Ta(!e.writeResults||0===e.writeResults.length),this.listener.f_()}onNext(e){Ta(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=function(e,t){return e&&e.length>0?(Ta(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?xc(e.updateTime):xc(t);return n.isEqual(Ga.min())&&(n=xc(t)),new _l(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=xc(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=Sc(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Pc(this.serializer,e)))};this.a_(t)}}class Bd extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new Aa(Ia.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[a,s]=i;return this.connection.Mo(e,jc(t,n),r,a,s)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Ia.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Aa(Ia.UNKNOWN,e.toString())}))}Lo(e,t,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((a=>{let[s,o]=a;return this.connection.Lo(e,jc(t,n),r,s,o,i)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Ia.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Aa(Ia.UNKNOWN,e.toString())}))}terminate(){this.y_=!0,this.connection.terminate()}}class $d{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){0===this.S_&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve()))))}M_(e){"Online"===this.state?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,"Online"===e&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(_a(t),this.D_=!1):za("OnlineStateTracker",t)}x_(){null!==this.b_&&(this.b_.cancel(),this.b_=null)}}class Wd{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o((e=>{n.enqueueAndForget((async()=>{Xd(this)&&(za("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Pa(e);t.L_.add(4),await Hd(t),t.q_.set("Unknown"),t.L_.delete(4),await qd(t)}(this))}))})),this.q_=new $d(n,r)}}async function qd(e){if(Xd(e))for(const t of e.B_)await t(!0)}async function Hd(e){for(const t of e.B_)await t(!1)}function Kd(e,t){const n=Pa(e);n.N_.has(t.targetId)||(n.N_.set(t.targetId,t),Jd(n)?Yd(n):vu(n).r_()&&Qd(n,t))}function Gd(e,t){const n=Pa(e),r=vu(n);n.N_.delete(t),r.r_()&&Zd(n,t),0===n.N_.size&&(r.r_()?r.o_():Xd(n)&&n.q_.set("Unknown"))}function Qd(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Ga.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}vu(e).A_(t)}function Zd(e,t){e.Q_.xe(t),vu(e).R_(t)}function Yd(e){e.Q_=new cc({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),vu(e).start(),e.q_.v_()}function Jd(e){return Xd(e)&&!vu(e).n_()&&e.N_.size>0}function Xd(e){return 0===Pa(e).L_.size}function eu(e){e.Q_=void 0}async function tu(e){e.q_.set("Online")}async function nu(e){e.N_.forEach(((t,n)=>{Qd(e,t)}))}async function ru(e,t){eu(e),Jd(e)?(e.q_.M_(t),Yd(e)):e.q_.set("Unknown")}async function iu(e,t,n){if(e.q_.set("Online"),t instanceof oc&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.N_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.N_.delete(r),e.Q_.removeTarget(r))}(e,t)}catch(n){za("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await au(e,n)}else if(t instanceof ac?e.Q_.Ke(t):t instanceof sc?e.Q_.He(t):e.Q_.We(t),!n.isEqual(Ga.min()))try{const t=await wd(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Q_.rt(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.N_.get(r);i&&e.N_.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.N_.get(t);if(!r)return;e.N_.set(t,r.withResumeToken(Cs.EMPTY_BYTE_STRING,r.snapshotVersion)),Zd(e,t);const i=new Wc(r.target,t,n,r.sequenceNumber);Qd(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){za("RemoteStore","Failed to raise snapshot:",t),await au(e,t)}}async function au(e,t,n){if(!ds(t))throw t;e.L_.add(1),await Hd(e),e.q_.set("Offline"),n||(n=()=>wd(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{za("RemoteStore","Retrying IndexedDB access"),await n(),e.L_.delete(1),await qd(e)}))}function su(e,t){return t().catch((n=>au(e,n,t)))}async function ou(e){const t=Pa(e),n=wu(t);let r=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;lu(t);)try{const e=await bd(t.localStore,r);if(null===e){0===t.O_.length&&n.o_();break}r=e.batchId,cu(t,e)}catch(e){await au(t,e)}du(t)&&uu(t)}function lu(e){return Xd(e)&&e.O_.length<10}function cu(e,t){e.O_.push(t);const n=wu(e);n.r_()&&n.V_&&n.m_(t.mutations)}function du(e){return Xd(e)&&!wu(e).n_()&&e.O_.length>0}function uu(e){wu(e).start()}async function hu(e){wu(e).p_()}async function pu(e){const t=wu(e);for(const n of e.O_)t.m_(n.mutations)}async function mu(e,t,n){const r=e.O_.shift(),i=$l.from(r,t,n);await su(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await ou(e)}async function fu(e,t){t&&wu(e).V_&&await async function(e,t){if(function(e){return Gl(e)&&e!==Ia.ABORTED}(t.code)){const n=e.O_.shift();wu(e).s_(),await su(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await ou(e)}}(e,t),du(e)&&uu(e)}async function yu(e,t){const n=Pa(e);n.asyncQueue.verifyOperationInProgress(),za("RemoteStore","RemoteStore received new credentials");const r=Xd(n);n.L_.add(3),await Hd(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.L_.delete(3),await qd(n)}async function gu(e,t){const n=Pa(e);t?(n.L_.delete(2),await qd(n)):t||(n.L_.add(2),await Hd(n),n.q_.set("Unknown"))}function vu(e){return e.K_||(e.K_=function(e,t,n){const r=Pa(e);return r.w_(),new Ud(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:tu.bind(null,e),Ro:nu.bind(null,e),mo:ru.bind(null,e),d_:iu.bind(null,e)}),e.B_.push((async t=>{t?(e.K_.s_(),Jd(e)?Yd(e):e.q_.set("Unknown")):(await e.K_.stop(),eu(e))}))),e.K_}function wu(e){return e.U_||(e.U_=function(e,t,n){const r=Pa(e);return r.w_(),new Vd(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:hu.bind(null,e),mo:fu.bind(null,e),f_:pu.bind(null,e),g_:mu.bind(null,e)}),e.B_.push((async t=>{t?(e.U_.s_(),await ou(e)):(await e.U_.stop(),e.O_.length>0&&(za("RemoteStore",`Stopping write stream with ${e.O_.length} pending writes`),e.O_=[]))}))),e.U_}class xu{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Ma,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const a=Date.now()+n,s=new xu(e,t,a,r,i);return s.start(n),s}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Aa(Ia.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function bu(e,t){if(_a("AsyncQueue",`${t}: ${e}`),ds(e))return new Aa(Ia.UNAVAILABLE,`${t}: ${e}`);throw e}class ju{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Xa.comparator(t.key,n.key):(e,t)=>Xa.comparator(e.key,t.key),this.keyedMap=tl(),this.sortedSet=new js(this.comparator)}static emptySet(e){return new ju(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ju))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new ju;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class ku{constructor(){this.W_=new js(Xa.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?0!==e.type&&3===n.type?this.W_=this.W_.insert(t,e):3===e.type&&1!==n.type?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.W_=this.W_.remove(t):1===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Ca():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Nu{constructor(e,t,n,r,i,a,s,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=s,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const a=[];return t.forEach((e=>{a.push({type:0,doc:e})})),new Nu(e,t,ju.emptySet(t),a,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Wo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class zu{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some((e=>e.J_()))}}class _u{constructor(){this.queries=Eu(),this.onlineState="Unknown",this.Y_=new Set}terminate(){!function(e,t){const n=Pa(e),r=n.queries;n.queries=Eu(),r.forEach(((e,n)=>{for(const r of n.j_)r.onError(t)}))}(this,new Aa(Ia.ABORTED,"Firestore shutting down"))}}function Eu(){return new Yo((e=>qo(e)),Wo)}async function Su(e,t){const n=Pa(e);let r=3;const i=t.query;let a=n.queries.get(i);a?!a.H_()&&t.J_()&&(r=2):(a=new zu,r=t.J_()?0:1);try{switch(r){case 0:a.z_=await n.onListen(i,!0);break;case 1:a.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=bu(e,`Initialization of query '${Ho(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,a),a.j_.push(t),t.Z_(n.onlineState),a.z_&&t.X_(a.z_)&&Iu(n)}async function Cu(e,t){const n=Pa(e),r=t.query;let i=3;const a=n.queries.get(r);if(a){const e=a.j_.indexOf(t);e>=0&&(a.j_.splice(e,1),0===a.j_.length?i=t.J_()?0:1:!a.H_()&&t.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Tu(e,t){const n=Pa(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.j_)e.X_(i)&&(r=!0);t.z_=i}}r&&Iu(n)}function Pu(e,t,n){const r=Pa(e),i=r.queries.get(t);if(i)for(const a of i.j_)a.onError(n);r.queries.delete(t)}function Iu(e){e.Y_.forEach((e=>{e.next()}))}var Au,Mu;(Mu=Au||(Au={})).ea="default",Mu.Cache="cache";class Du{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Nu(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache)return!0;if(!this.J_())return!0;const n="Offline"!==t;return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}oa(e){e=Nu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Au.Cache}}class Ru{constructor(e){this.key=e}}class Ou{constructor(e){this.key=e}}class Lu{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ll(),this.mutatedKeys=ll(),this.Aa=Qo(e),this.Ra=new ju(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new ku,r=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,a=r,s=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const c=r.get(e),d=Ko(this.query,t)?t:null,u=!!c&&this.mutatedKeys.has(c.key),h=!!d&&(d.hasLocalMutations||this.mutatedKeys.has(d.key)&&d.hasCommittedMutations);let p=!1;c&&d?c.data.isEqual(d.data)?u!==h&&(n.track({type:3,doc:d}),p=!0):this.ga(c,d)||(n.track({type:2,doc:d}),p=!0,(o&&this.Aa(d,o)>0||l&&this.Aa(d,l)<0)&&(s=!0)):!c&&d?(n.track({type:0,doc:d}),p=!0):c&&!d&&(n.track({type:1,doc:c}),p=!0,(o||l)&&(s=!0)),p&&(d?(a=a.add(d),i=h?i.add(e):i.delete(e)):(a=a.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;a.size>this.query.limit;){const e="F"===this.query.limitType?a.last():a.first();a=a.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Ra:a,fa:n,ns:s,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ca()}};return n(e)-n(t)}(e.type,t.type)||this.Aa(e.doc,t.doc))),this.pa(n),r=null!=r&&r;const s=t&&!r?this.ya():[],o=0===this.da.size&&this.current&&!r?1:0,l=o!==this.Ea;return this.Ea=o,0!==a.length||l?{snapshot:new Nu(this.query,e.Ra,i,a,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:s}:{wa:s}}Z_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new ku,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach((e=>this.Ta=this.Ta.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Ta=this.Ta.delete(e))),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ll(),this.Ra.forEach((e=>{this.Sa(e.key)&&(this.da=this.da.add(e.key))}));const t=[];return e.forEach((e=>{this.da.has(e)||t.push(new Ou(e))})),this.da.forEach((n=>{e.has(n)||t.push(new Ru(n))})),t}ba(e){this.Ta=e.Ts,this.da=ll();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Nu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,0===this.Ea,this.hasCachedResults)}}class Fu{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Uu{constructor(e){this.key=e,this.va=!1}}class Vu{constructor(e,t,n,r,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Yo((e=>qo(e)),Wo),this.Ma=new Map,this.xa=new Set,this.Oa=new js(Xa.comparator),this.Na=new Map,this.La=new id,this.Ba={},this.ka=new Map,this.qa=Yc.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return!0===this.Qa}}async function Bu(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=ch(e);let i;const a=r.Fa.get(t);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.Da()):i=await Wu(r,t,n,!0),i}async function $u(e,t){const n=ch(e);await Wu(n,t,!0,!1)}async function Wu(e,t,n,r){const i=await jd(e.localStore,Uo(t)),a=i.targetId,s=e.sharedClientState.addLocalQueryTarget(a,n);let o;return r&&(o=await qu(e,t,a,"current"===s,i.resumeToken)),e.isPrimaryClient&&n&&Kd(e.remoteStore,i),o}async function qu(e,t,n,r,i){e.Ka=(t,n,r)=>async function(e,t,n,r){let i=t.view.ma(n);i.ns&&(i=await Nd(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.ma(n,i)})));const a=r&&r.targetChanges.get(t.targetId),s=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,a,s);return rh(e,t.targetId,o.wa),o.snapshot}(e,t,n,r);const a=await Nd(e.localStore,t,!0),s=new Lu(t,a.Ts),o=s.ma(a.documents),l=ic.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=s.applyChanges(o,e.isPrimaryClient,l);rh(e,n,c.wa);const d=new Fu(t,n,s);return e.Fa.set(t,d),e.Ma.has(n)?e.Ma.get(n).push(t):e.Ma.set(n,[t]),c.snapshot}async function Hu(e,t,n){const r=Pa(e),i=r.Fa.get(t),a=r.Ma.get(i.targetId);if(a.length>1)return r.Ma.set(i.targetId,a.filter((e=>!Wo(e,t)))),void r.Fa.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await kd(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Gd(r.remoteStore,i.targetId),th(r,i.targetId)})).catch(os)):(th(r,i.targetId),await kd(r.localStore,i.targetId,!0))}async function Ku(e,t){const n=Pa(e),r=n.Fa.get(t),i=n.Ma.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Gd(n.remoteStore,r.targetId))}async function Gu(e,t){const n=Pa(e);try{const e=await function(e,t){const n=Pa(e),r=t.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const s=[];t.targetChanges.forEach(((a,o)=>{const l=i.get(o);if(!l)return;s.push(n.Ur.removeMatchingKeys(e,a.removedDocuments,o).next((()=>n.Ur.addMatchingKeys(e,a.addedDocuments,o))));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(Cs.EMPTY_BYTE_STRING,Ga.min()).withLastLimboFreeSnapshotVersion(Ga.min()):a.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(a.resumeToken,r)),i=i.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,c,a)&&s.push(n.Ur.updateTargetData(e,c))}));let o=Xo(),l=ll();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),s.push(xd(e,a,t.documentUpdates).next((e=>{o=e.Ps,l=e.Is}))),!r.isEqual(Ga.min())){const t=n.Ur.getLastRemoteSnapshotVersion(e).next((t=>n.Ur.setTargetsMetadata(e,e.currentSequenceNumber,r)));s.push(t)}return ls.waitFor(s).next((()=>a.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,o,l))).next((()=>o))})).then((e=>(n.os=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Na.get(t);r&&(Ta(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.va=!0:e.modifiedDocuments.size>0?Ta(r.va):e.removedDocuments.size>0&&(Ta(r.va),r.va=!1))})),await sh(n,e,t)}catch(e){await os(e)}}function Qu(e,t,n){const r=Pa(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Fa.forEach(((n,r)=>{const i=r.view.Z_(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=Pa(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const i of n.j_)i.Z_(t)&&(r=!0)})),r&&Iu(n)}(r.eventManager,t),e.length&&r.Ca.d_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Zu(e,t,n){const r=Pa(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Na.get(t),a=i&&i.key;if(a){let e=new js(Xa.comparator);e=e.insert(a,ao.newNoDocument(a,Ga.min()));const n=ll().add(a),i=new rc(Ga.min(),new Map,new js(qa),e,n);await Gu(r,i),r.Oa=r.Oa.remove(a),r.Na.delete(t),ah(r)}else await kd(r.localStore,t,!1).then((()=>th(r,t,n))).catch(os)}async function Yu(e,t){const n=Pa(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Pa(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,a=i.keys();let s=ls.resolve();return a.forEach((e=>{s=s.next((()=>r.getEntry(t,e))).next((t=>{const a=n.docVersions.get(e);Ta(null!==a),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),s.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=ll();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);eh(n,r,null),Xu(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await sh(n,e)}catch(e){await os(e)}}async function Ju(e,t,n){const r=Pa(e);try{const e=await function(e,t){const n=Pa(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(Ta(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);eh(r,t,n),Xu(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await sh(r,e)}catch(n){await os(n)}}function Xu(e,t){(e.ka.get(t)||[]).forEach((e=>{e.resolve()})),e.ka.delete(t)}function eh(e,t,n){const r=Pa(e);let i=r.Ba[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Ba[r.currentUser.toKey()]=i}}function th(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Ma.get(t))e.Fa.delete(r),n&&e.Ca.$a(r,n);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach((t=>{e.La.containsKey(t)||nh(e,t)}))}function nh(e,t){e.xa.delete(t.path.canonicalString());const n=e.Oa.get(t);null!==n&&(Gd(e.remoteStore,n),e.Oa=e.Oa.remove(t),e.Na.delete(n),ah(e))}function rh(e,t,n){for(const r of n)r instanceof Ru?(e.La.addReference(r.key,t),ih(e,r)):r instanceof Ou?(za("SyncEngine","Document no longer in limbo: "+r.key),e.La.removeReference(r.key,t),e.La.containsKey(r.key)||nh(e,r.key)):Ca()}function ih(e,t){const n=t.key,r=n.path.canonicalString();e.Oa.get(n)||e.xa.has(r)||(za("SyncEngine","New document in limbo: "+n),e.xa.add(r),ah(e))}function ah(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const n=new Xa(Za.fromString(t)),r=e.qa.next();e.Na.set(r,new Uu(n)),e.Oa=e.Oa.insert(n,r),Kd(e.remoteStore,new Wc(Uo(Ro(n.path)),r,"TargetPurposeLimboResolution",us.oe))}}async function sh(e,t,n){const r=Pa(e),i=[],a=[],s=[];r.Fa.isEmpty()||(r.Fa.forEach(((e,o)=>{s.push(r.Ka(o,t,n).then((e=>{var t;if((e||n)&&r.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(o.targetId,i?"current":"not-current")}if(e){i.push(e);const t=pd.Wi(o.targetId,e);a.push(t)}})))})),await Promise.all(s),r.Ca.d_(i),await async function(e,t){const n=Pa(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>ls.forEach(t,(t=>ls.forEach(t.$i,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>ls.forEach(t.Ui,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!ds(e))throw e;za("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.os.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.os=n.os.insert(e,i)}}}(r.localStore,a))}async function oh(e,t){const n=Pa(e);if(!n.currentUser.isEqual(t)){za("SyncEngine","User change. New user:",t.toKey());const e=await vd(n.localStore,t);n.currentUser=t,function(e,t){e.ka.forEach((e=>{e.forEach((e=>{e.reject(new Aa(Ia.CANCELLED,t))}))})),e.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await sh(n,e.hs)}}function lh(e,t){const n=Pa(e),r=n.Na.get(t);if(r&&r.va)return ll().add(r.key);{let e=ll();const r=n.Ma.get(t);if(!r)return e;for(const t of r){const r=n.Fa.get(t);e=e.unionWith(r.view.Va)}return e}}function ch(e){const t=Pa(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Gu.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=lh.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Zu.bind(null,t),t.Ca.d_=Tu.bind(null,t.eventManager),t.Ca.$a=Pu.bind(null,t.eventManager),t}function dh(e){const t=Pa(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Yu.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Ju.bind(null,t),t}class uh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Od(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return gd(this.persistence,new fd,e.initialUser,this.serializer)}Ga(e){return new dd(hd.Zr,this.serializer)}Wa(e){return new Ed}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}uh.provider={build:()=>new uh};class hh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Qu(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=oh.bind(null,this.syncEngine),await gu(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new _u}createDatastore(e){const t=Od(e.databaseInfo.databaseId),n=function(e){return new Dd(e)}(e.databaseInfo);return function(e,t,n,r){return new Bd(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new Wd(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>Qu(this.syncEngine,e,0)),Cd.D()?new Cd:new Sd)}createSyncEngine(e,t){return function(e,t,n,r,i,a,s){const o=new Vu(e,t,n,r,i,a);return s&&(o.Qa=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=Pa(e);za("RemoteStore","RemoteStore shutting down."),t.L_.add(5),await Hd(t),t.k_.shutdown(),t.q_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}hh.provider={build:()=>new hh};class ph{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):_a("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class mh{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=ba.UNAUTHENTICATED,this.clientId=Wa.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async e=>{za("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(za("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ma;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=bu(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function fh(e,t){e.asyncQueue.verifyOperationInProgress(),za("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await vd(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function yh(e,t){e.asyncQueue.verifyOperationInProgress();const n=await gh(e);za("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>yu(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>yu(t.remoteStore,n))),e._onlineComponents=t}async function gh(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){za("FirestoreClient","Using user provided OfflineComponentProvider");try{await fh(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===Ia.FAILED_PRECONDITION||e.code===Ia.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;Ea("Error using user provided cache. Falling back to memory cache: "+n),await fh(e,new uh)}}else za("FirestoreClient","Using default OfflineComponentProvider"),await fh(e,new uh);return e._offlineComponents}async function vh(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(za("FirestoreClient","Using user provided OnlineComponentProvider"),await yh(e,e._uninitializedComponentsProvider._online)):(za("FirestoreClient","Using default OnlineComponentProvider"),await yh(e,new hh))),e._onlineComponents}function wh(e){return vh(e).then((e=>e.syncEngine))}async function xh(e){const t=await vh(e),n=t.eventManager;return n.onListen=Bu.bind(null,t.syncEngine),n.onUnlisten=Hu.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=$u.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Ku.bind(null,t.syncEngine),n}function bh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Ma;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const a=new ph({next:o=>{a.Za(),t.enqueueAndForget((()=>Cu(e,s)));const l=o.docs.has(n);!l&&o.fromCache?i.reject(new Aa(Ia.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&r&&"server"===r.source?i.reject(new Aa(Ia.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:e=>i.reject(e)}),s=new Du(Ro(n.path),a,{includeMetadataChanges:!0,_a:!0});return Su(e,s)}(await xh(e),e.asyncQueue,t,n,r))),r.promise}function jh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Ma;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const a=new ph({next:n=>{a.Za(),t.enqueueAndForget((()=>Cu(e,s))),n.fromCache&&"server"===r.source?i.reject(new Aa(Ia.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),s=new Du(n,a,{includeMetadataChanges:!0,_a:!0});return Su(e,s)}(await xh(e),e.asyncQueue,t,n,r))),r.promise}function kh(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Nh=new Map;function zh(e,t,n){if(!n)throw new Aa(Ia.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function _h(e){if(!Xa.isDocumentKey(e))throw new Aa(Ia.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Eh(e){if(Xa.isDocumentKey(e))throw new Aa(Ia.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Sh(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Ca()}function Ch(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Aa(Ia.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Sh(e);throw new Aa(Ia.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}class Th{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Aa(Ia.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Aa(Ia.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Aa(Ia.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kh(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Aa(Ia.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Aa(Ia.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Aa(Ia.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ph{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Th({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Aa(Ia.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Aa(Ia.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Th(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Ra;switch(e.type){case"firstParty":return new Ua(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Aa(Ia.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Nh.get(e);t&&(za("ComponentProvider","Removing Datastore"),Nh.delete(e),t.terminate())}(this),Promise.resolve()}}function Ih(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const a=(e=Ch(e,Ph))._getSettings(),s=`${t}:${n}`;if("firestore.googleapis.com"!==a.host&&a.host!==s&&Ea("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},a),{host:s,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=ba.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Q(JSON.stringify({alg:"none",type:"JWT"})),Q(JSON.stringify(a)),""].join(".")}(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const a=r.mockUserToken.sub||r.mockUserToken.user_id;if(!a)throw new Aa(Ia.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new ba(a)}e._authCredentials=new Oa(new Da(t,n))}}class Ah{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ah(this.firestore,e,this._query)}}class Mh{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Dh(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Mh(this.firestore,e,this._key)}}class Dh extends Ah{constructor(e,t,n){super(e,t,Ro(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Mh(this.firestore,null,new Xa(e))}withConverter(e){return new Dh(this.firestore,e,this._path)}}function Rh(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=we(e),zh("collection","path",t),e instanceof Ph){const n=Za.fromString(t,...r);return Eh(n),new Dh(e,null,n)}{if(!(e instanceof Mh||e instanceof Dh))throw new Aa(Ia.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Za.fromString(t,...r));return Eh(n),new Dh(e.firestore,null,n)}}function Oh(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=we(e),1===arguments.length&&(t=Wa.newId()),zh("doc","path",t),e instanceof Ph){const n=Za.fromString(t,...r);return _h(n),new Mh(e,null,new Xa(n))}{if(!(e instanceof Mh||e instanceof Dh))throw new Aa(Ia.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Za.fromString(t,...r));return _h(n),new Mh(e.firestore,e instanceof Dh?e.converter:null,new Xa(n))}}class Lh{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Ld(this,"async_queue_retry"),this.Vu=()=>{const e=Rd();e&&za("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()},this.mu=e;const t=Rd();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Rd();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise((()=>{}));const t=new Ma;return this.gu((()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Pu.push(e),this.pu())))}async pu(){if(0!==this.Pu.length){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!ds(e))throw e;za("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go((()=>this.pu()))}}gu(e){const t=this.mu.then((()=>(this.du=!0,e().catch((e=>{this.Eu=e,this.du=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw _a("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.du=!1,e))))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const r=xu.createAndSchedule(this,e,t,n,(e=>this.yu(e)));return this.Tu.push(r),r}fu(){this.Eu&&Ca()}verifyOperationInProgress(){}async wu(){let e;do{e=this.mu,await e}while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then((()=>{this.Tu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.Tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.wu()}))}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}class Fh extends Ph{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Lh,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Lh(e),this._firestoreClient=void 0,await e}}}function Uh(e){if(e._terminated)throw new Aa(Ia.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Vh(e),e._firestoreClient}function Vh(e){var t,n,r;const i=e._freezeSettings(),a=function(e,t,n,r){return new Os(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,kh(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new mh(e._authCredentials,e._appCheckCredentials,e._queue,a,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class Bh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bh(Cs.fromBase64String(e))}catch(e){throw new Aa(Ia.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Bh(Cs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class $h{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new Aa(Ia.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ja(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Wh{constructor(e){this._methodName=e}}class qh{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Aa(Ia.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Aa(Ia.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return qa(this._lat,e._lat)||qa(this._long,e._long)}}class Hh{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const Kh=/^__.*__$/;class Gh{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Rl(e,this.data,this.fieldMask,t,this.fieldTransforms):new Dl(e,this.data,t,this.fieldTransforms)}}function Qh(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ca()}}class Zh{constructor(e,t,n,r,i,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Zh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.Ou(e),r}Nu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return lp(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(0===e.length)throw this.Bu("Document fields must not be empty");if(Qh(this.Cu)&&Kh.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Yh{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Od(e)}Qu(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Zh({Cu:e,methodName:t,qu:n,path:Ja.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Jh(e){const t=e._freezeSettings(),n=Od(e._databaseId);return new Yh(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Xh(e,t,n,r,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const s=e.Qu(a.merge||a.mergeFields?2:0,t,n,i);ip("Data must be an object, but it was:",s,r);const o=np(r,s);let l,c;if(a.merge)l=new Es(s.fieldMask),c=s.fieldTransforms;else if(a.mergeFields){const e=[];for(const r of a.mergeFields){const i=ap(t,r,n);if(!s.contains(i))throw new Aa(Ia.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);cp(e,i)||e.push(i)}l=new Es(e),c=s.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,c=s.fieldTransforms;return new Gh(new ro(o),l,c)}function ep(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return tp(n,e.Qu(r?4:3,t))}function tp(e,t){if(rp(e=we(e)))return ip("Unsupported field value:",t,e),np(e,t);if(e instanceof Wh)return function(e,t){if(!Qh(t.Cu))throw t.Bu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Bu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&4!==t.Cu)throw t.Bu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=tp(i,t.Lu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=we(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return pl(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Ka.fromDate(e);return{timestampValue:gc(t.serializer,n)}}if(e instanceof Ka){const n=new Ka(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:gc(t.serializer,n)}}if(e instanceof qh)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Bh)return{bytesValue:vc(t.serializer,e._byteString)};if(e instanceof Mh){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Bu(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:bc(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Hh)return function(e,t){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw t.Bu("VectorValues must only contain numeric values.");return ul(t.serializer,e)}))}}}}}}(e,t);throw t.Bu(`Unsupported field value: ${Sh(e)}`)}(e,t)}function np(e,t){const n={};return bs(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):xs(e,((e,r)=>{const i=tp(r,t.Mu(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function rp(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Ka||e instanceof qh||e instanceof Bh||e instanceof Mh||e instanceof Wh||e instanceof Hh)}function ip(e,t,n){if(!rp(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Sh(n);throw"an object"===r?t.Bu(e+" a custom object"):t.Bu(e+" "+r)}}function ap(e,t,n){if((t=we(t))instanceof $h)return t._internalPath;if("string"==typeof t)return op(e,t);throw lp("Field path arguments must be of type string or ",e,!1,void 0,n)}const sp=new RegExp("[~\\*/\\[\\]]");function op(e,t,n){if(t.search(sp)>=0)throw lp(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new $h(...t.split("."))._internalPath}catch(r){throw lp(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function lp(e,t,n,r,i){const a=r&&!r.isEmpty(),s=void 0!==i;let o=`Function ${t}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(a||s)&&(l+=" (found",a&&(l+=` in field ${r}`),s&&(l+=` in document ${i}`),l+=")"),new Aa(Ia.INVALID_ARGUMENT,o+e+l)}function cp(e,t){return e.some((e=>e.isEqual(t)))}class dp{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Mh(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new up(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(hp("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class up extends dp{data(){return super.data()}}function hp(e,t){return"string"==typeof t?op(e,t):t instanceof $h?t._internalPath:t._delegate._internalPath}function pp(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Aa(Ia.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mp{}class fp extends mp{}class yp extends fp{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new yp(e,t,n)}_apply(e){const t=this._parse(e);return bp(e._query,t),new Ah(e.firestore,e.converter,Bo(e._query,t))}_parse(e){const t=Jh(e.firestore),n=function(e,t,n,r,i,a,s){let o;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new Aa(Ia.INVALID_ARGUMENT,`Invalid Query. You can't perform '${a}' queries on documentId().`);if("in"===a||"not-in"===a){xp(s,a);const t=[];for(const n of s)t.push(wp(r,e,n));o={arrayValue:{values:t}}}else o=wp(r,e,s)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||xp(s,a),o=ep(n,t,s,"in"===a||"not-in"===a);return po.create(i,a,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class gp extends mp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new gp(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:mo.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)bp(n,i),n=Bo(n,i)}(e._query,t),new Ah(e.firestore,e.converter,Bo(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class vp extends fp{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new vp(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Aa(Ia.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Aa(Ia.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new co(t,n)}(e._query,this._field,this._direction);return new Ah(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Mo(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function wp(e,t,n){if("string"==typeof(n=we(n))){if(""===n)throw new Aa(Ia.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Lo(t)&&-1!==n.indexOf("/"))throw new Aa(Ia.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(Za.fromString(n));if(!Xa.isDocumentKey(r))throw new Aa(Ia.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Gs(e,new Xa(r))}if(n instanceof Mh)return Gs(e,n._key);throw new Aa(Ia.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Sh(n)}.`)}function xp(e,t){if(!Array.isArray(e)||0===e.length)throw new Aa(Ia.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function bp(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Aa(Ia.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Aa(Ia.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class jp{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Us(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Is(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(As(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ca()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return xs(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertVectorValue(e){var t,n,r;const i=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t.value.arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map((e=>Is(e.doubleValue)));return new Hh(i)}convertGeoPoint(e){return new qh(Is(e.latitude),Is(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Ds(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Rs(e));default:return null}}convertTimestamp(e){const t=Ps(e);return new Ka(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Za.fromString(e);Ta($c(n));const r=new Ls(n.get(1),n.get(3)),i=new Xa(n.popFirst(5));return r.isEqual(t)||_a(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function kp(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Np{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class zp extends dp{constructor(e,t,n,r,i,a){super(e,t,n,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new _p(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(hp("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class _p extends zp{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Ep{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Np(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new _p(this._firestore,this._userDataWriter,n.key,n,new Np(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Aa(Ia.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new _p(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Np(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new _p(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Np(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,a=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),a=n.indexOf(t.doc.key)),{type:Sp(t.type),doc:r,oldIndex:i,newIndex:a}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Sp(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ca()}}class Cp extends jp{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bh(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Mh(this.firestore,null,t)}}function Tp(e,t){return function(e,t){const n=new Ma;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=dh(e);try{const e=await function(e,t){const n=Pa(e),r=Ka.now(),i=t.reduce(((e,t)=>e.add(t.key)),ll());let a,s;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let o=Xo(),l=ll();return n.cs.getEntries(e,i).next((e=>{o=e,o.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,o))).next((i=>{a=i;const s=[];for(const e of t){const t=Al(e,a.get(e.key).overlayedDocument);null!=t&&s.push(new Rl(e.key,t,io(t.value.mapValue),El.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,s,t)})).next((t=>{s=t;const r=t.applyToLocalDocumentSet(a,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:s.batchId,changes:nl(a)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Ba[e.currentUser.toKey()];r||(r=new js(qa)),r=r.insert(t,n),e.Ba[e.currentUser.toKey()]=r}(r,e.batchId,n),await sh(r,e.changes),await ou(r.remoteStore)}catch(e){const t=bu(e,"Failed to persist write");n.reject(t)}}(await wh(e),t,n))),n.promise}(Uh(e),t)}function Pp(e,t,n){const r=n.docs.get(t._key),i=new Cp(e);return new zp(e,i,t._key,r,new Np(n.hasPendingWrites,n.fromCache),t.converter)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){ja=e}(Dt),Tt(new xe("firestore",((e,n)=>{let{instanceIdentifier:r,options:i}=n;const a=e.getProvider("app").getImmediate(),s=new Fh(new La(e.getProvider("auth-internal")),new Ba(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Aa(Ia.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ls(e.options.projectId,t)}(a,r),a);return i=Object.assign({useFetchStreams:t},i),s._setSettings(i),s}),"PUBLIC").setMultipleInstances(!0)),Lt(xa,"4.7.3",e),Lt(xa,"4.7.3","esm2017")}();const Ip="@firebase/installations",Ap="0.6.9",Mp=1e4,Dp=`w:${Ap}`,Rp="FIS_v2",Op=36e5,Lp=new ce("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Fp(e){return e instanceof le&&e.code.includes("request-failed")}function Up(e){let{projectId:t}=e;return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function Vp(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function Bp(e,t){const n=(await t.json()).error;return Lp.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function $p(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function Wp(e,t){let{refreshToken:n}=t;const r=$p(e);return r.append("Authorization",function(e){return`${Rp} ${e}`}(n)),r}async function qp(e){const t=await e();return t.status>=500&&t.status<600?e():t}function Hp(e){return new Promise((t=>{setTimeout(t,e)}))}const Kp=/^[cdef][\w-]{21}$/;function Gp(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}(e);return Kp.test(t)?t:""}catch(e){return""}}function Qp(e){return`${e.appName}!${e.appId}`}const Zp=new Map;function Yp(e,t){const n=Qp(e);Jp(n,t),function(e,t){const n=em();n&&n.postMessage({key:e,fid:t});tm()}(n,t)}function Jp(e,t){const n=Zp.get(e);if(n)for(const r of n)r(t)}let Xp=null;function em(){return!Xp&&"BroadcastChannel"in self&&(Xp=new BroadcastChannel("[Firebase] FID Change"),Xp.onmessage=e=>{Jp(e.data.key,e.data.fid)}),Xp}function tm(){0===Zp.size&&Xp&&(Xp.close(),Xp=null)}const nm="firebase-installations-store";let rm=null;function im(){return rm||(rm=$e("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(nm)}})),rm}async function am(e,t){const n=Qp(e),r=(await im()).transaction(nm,"readwrite"),i=r.objectStore(nm),a=await i.get(n);return await i.put(t,n),await r.done,a&&a.fid===t.fid||Yp(e,t.fid),t}async function sm(e){const t=Qp(e),n=(await im()).transaction(nm,"readwrite");await n.objectStore(nm).delete(t),await n.done}async function om(e,t){const n=Qp(e),r=(await im()).transaction(nm,"readwrite"),i=r.objectStore(nm),a=await i.get(n),s=t(a);return void 0===s?await i.delete(n):await i.put(s,n),await r.done,!s||a&&a.fid===s.fid||Yp(e,s.fid),s}async function lm(e){let t;const n=await om(e.appConfig,(n=>{const r=function(e){const t=e||{fid:Gp(),registrationStatus:0};return um(t)}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(Lp.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e,{fid:i}=t;const a=Up(n),s=$p(n),o=r.getImmediate({optional:!0});if(o){const e=await o.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const l={fid:i,authVersion:Rp,appId:n.appId,sdkVersion:Dp},c={method:"POST",headers:s,body:JSON.stringify(l)},d=await qp((()=>fetch(a,c)));if(d.ok){const e=await d.json();return{fid:e.fid||i,registrationStatus:2,refreshToken:e.refreshToken,authToken:Vp(e.authToken)}}throw await Bp("Create Installation",d)}(e,t);return am(e.appConfig,n)}catch(n){throw Fp(n)&&409===n.customData.serverCode?await sm(e.appConfig):await am(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:cm(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function cm(e){let t=await dm(e.appConfig);for(;1===t.registrationStatus;)await Hp(100),t=await dm(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await lm(e);return n||t}return t}function dm(e){return om(e,(e=>{if(!e)throw Lp.create("installation-not-found");return um(e)}))}function um(e){return 1===(t=e).registrationStatus&&t.registrationTime+Mp<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function hm(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e;const i=function(e,t){let{fid:n}=t;return`${Up(e)}/${n}/authTokens:generate`}(n,t),a=Wp(n,t),s=r.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&a.append("x-firebase-client",e)}const o={installation:{sdkVersion:Dp,appId:n.appId}},l={method:"POST",headers:a,body:JSON.stringify(o)},c=await qp((()=>fetch(i,l)));if(c.ok){return Vp(await c.json())}throw await Bp("Generate Auth Token",c)}async function pm(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=await om(e.appConfig,(r=>{if(!fm(r))throw Lp.create("not-registered");const i=r.authToken;if(!n&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+Op}(e)}(i))return r;if(1===i.requestStatus)return t=async function(e,t){let n=await mm(e.appConfig);for(;1===n.authToken.requestStatus;)await Hp(100),n=await mm(e.appConfig);const r=n.authToken;return 0===r.requestStatus?pm(e,t):r}(e,n),r;{if(!navigator.onLine)throw Lp.create("app-offline");const n=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return t=async function(e,t){try{const n=await hm(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await am(e.appConfig,r),n}catch(n){if(!Fp(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await am(e.appConfig,n)}else await sm(e.appConfig);throw n}}(e,n),n}}));return t?await t:r.authToken}function mm(e){return om(e,(e=>{if(!fm(e))throw Lp.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+Mp<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n}))}function fm(e){return void 0!==e&&2===e.registrationStatus}async function ym(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;await async function(e){const{registrationPromise:t}=await lm(e);t&&await t}(n);return(await pm(n,t)).token}function gm(e){return Lp.create("missing-app-config-values",{valueName:e})}const vm="installations",wm=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw gm("App Configuration");if(!e.name)throw gm("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw gm(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:Pt(t,"heartbeat"),_delete:()=>Promise.resolve()}},xm=e=>{const t=Pt(e.getProvider("app").getImmediate(),vm).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await lm(t);return r?r.catch(console.error):pm(t).catch(console.error),n.fid}(t),getToken:e=>ym(t,e)}};Tt(new xe(vm,wm,"PUBLIC")),Tt(new xe("installations-internal",xm,"PRIVATE")),Lt(Ip,Ap),Lt(Ip,Ap,"esm2017");const bm="analytics",jm="https://www.googletagmanager.com/gtag/js",km=new Te("@firebase/analytics"),Nm=new ce("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function zm(e){if(!e.startsWith(jm)){const t=Nm.create("invalid-gtag-resource",{gtagURL:e});return km.warn(t.message),""}return e}function _m(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}function Em(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}("firebase-js-sdk-policy",{createScriptURL:zm}),r=document.createElement("script"),i=`${jm}?l=${e}&id=${t}`;r.src=n?null===n||void 0===n?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function Sm(e,t,n,r){return async function(i){try{for(var a=arguments.length,s=new Array(a>1?a-1:0),o=1;o<a;o++)s[o-1]=arguments[o];if("event"===i){const[r,i]=s;await async function(e,t,n,r,i){try{let a=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);const r=await _m(n);for(const n of e){const e=r.find((e=>e.measurementId===n)),i=e&&t[e.appId];if(!i){a=[];break}a.push(i)}}0===a.length&&(a=Object.values(t)),await Promise.all(a),e("event",r,i||{})}catch(a){km.error(a)}}(e,t,n,r,i)}else if("config"===i){const[i,a]=s;await async function(e,t,n,r,i,a){const s=r[i];try{if(s)await t[s];else{const e=(await _m(n)).find((e=>e.measurementId===i));e&&await t[e.appId]}}catch(o){km.error(o)}e("config",i,a)}(e,t,n,r,i,a)}else if("consent"===i){const[t,n]=s;e("consent",t,n)}else if("get"===i){const[t,n,r]=s;e("get",t,n,r)}else if("set"===i){const[t]=s;e("set",t)}else e(i,...s)}catch(l){km.error(l)}}}const Cm=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function Tm(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function Pm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Cm,n=arguments.length>2?arguments[2]:void 0;const{appId:r,apiKey:i,measurementId:a}=e.options;if(!r)throw Nm.create("no-app-id");if(!i){if(a)return{measurementId:a,appId:r};throw Nm.create("no-api-key")}const s=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new Am;return setTimeout((async()=>{o.abort()}),void 0!==n?n:6e4),Im({appId:r,apiKey:i,measurementId:a},s,o,t)}async function Im(e,t,n){let{throttleEndTimeMillis:r,backoffCount:i}=t,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Cm;var s;const{appId:o,measurementId:l}=e;try{await function(e,t){return new Promise(((n,r)=>{const i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener((()=>{clearTimeout(a),r(Nm.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(n,r)}catch(c){if(l)return km.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null===c||void 0===c?void 0:c.message}]`),{appId:o,measurementId:l};throw c}try{const t=await async function(e){var t;const{appId:n,apiKey:r}=e,i={method:"GET",headers:Tm(r)},a="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),s=await fetch(a,i);if(200!==s.status&&304!==s.status){let e="";try{const n=await s.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(o){}throw Nm.create("config-fetch-failed",{httpStatus:s.status,responseMessage:e})}return s.json()}(e);return a.deleteThrottleMetadata(o),t}catch(c){const t=c;if(!function(e){if(!(e instanceof le)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t)){if(a.deleteThrottleMetadata(o),l)return km.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null===t||void 0===t?void 0:t.message}]`),{appId:o,measurementId:l};throw c}const r=503===Number(null===(s=null===t||void 0===t?void 0:t.customData)||void 0===s?void 0:s.httpStatus)?ve(i,a.intervalMillis,30):ve(i,a.intervalMillis),d={throttleEndTimeMillis:Date.now()+r,backoffCount:i+1};return a.setThrottleMetadata(o,d),km.debug(`Calling attemptFetch again in ${r} millis`),Im(e,d,n,a)}}class Am{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let Mm,Dm;function Rm(e){Dm=e}function Om(e){Mm=e}async function Lm(e,t,n,r,i,a,s){var o;const l=Pm(e);l.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&km.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>km.error(e))),t.push(l);const c=async function(){if(!se())return km.warn(Nm.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await oe()}catch(e){return km.warn(Nm.create("indexeddb-unavailable",{errorInfo:null===e||void 0===e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?r.getId():void 0)),[d,u]=await Promise.all([l,c]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(jm)&&n.src.includes(e))return n;return null})(a)||Em(a,d.measurementId),Dm&&(i("consent","default",Dm),Rm(void 0)),i("js",new Date);const h=null!==(o=null===s||void 0===s?void 0:s.config)&&void 0!==o?o:{};return h.origin="firebase",h.update=!0,null!=u&&(h.firebase_id=u),i("config",d.measurementId,h),Mm&&(i("set",Mm),Om(void 0)),d.measurementId}class Fm{constructor(e){this.app=e}_delete(){return delete Um[this.app.options.appId],Promise.resolve()}}let Um={},Vm=[];const Bm={};let $m,Wm,qm="dataLayer",Hm="gtag",Km=!1;function Gm(){const e=[];if(ie()&&e.push("This is a browser extension environment."),"undefined"!==typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=Nm.create("invalid-analytics-context",{errorInfo:t});km.warn(n.message)}}function Qm(e,t,n){Gm();const r=e.options.appId;if(!r)throw Nm.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw Nm.create("no-api-key");km.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Um[r])throw Nm.create("already-exists",{id:r});if(!Km){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(qm);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,i){let a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[i]&&"function"===typeof window[i]&&(a=window[i]),window[i]=Sm(a,e,t,n),{gtagCore:a,wrappedGtag:window[i]}}(Um,Vm,Bm,qm,Hm);Wm=e,$m=t,Km=!0}Um[r]=Lm(e,Vm,Bm,t,$m,qm,n);return new Fm(e)}function Zm(e,t,n,r){e=we(e),async function(e,t,n,r,i){if(i&&i.global)e("event",n,r);else{const i=await t;e("event",n,Object.assign(Object.assign({},r),{send_to:i}))}}(Wm,Um[e.app.options.appId],t,n,r).catch((e=>km.error(e)))}const Ym="@firebase/analytics",Jm="0.10.8";Tt(new xe(bm,((e,t)=>{let{options:n}=t;return Qm(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)}),"PUBLIC")),Tt(new xe("analytics-internal",(function(e){try{const t=e.getProvider(bm).getImmediate();return{logEvent:(e,n,r)=>Zm(t,e,n,r)}}catch(t){throw Nm.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),Lt(Ym,Jm),Lt(Ym,Jm,"esm2017");const Xm=Rt({apiKey:"AIzaSyDB6GPLf6XY8zdm3X_v5IpGy1RsKvzmxCs",authDomain:"oze-developer.firebaseapp.com",projectId:"oze-developer",storageBucket:"oze-developer.firebasestorage.app",messagingSenderId:"846053756987",appId:"1:846053756987:web:6a6e5954c24f3932fccc1e",measurementId:"G-3FJW0FC6S7"}),ef=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ot();const t=Pt(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Pt(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(ue(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;tn(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Xi,persistence:[ui,Gr,Zr]}),r=te("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>ra)return;const r=null===t||void 0===t?void 0:t.token;ia!==r&&(ia=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){we(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e,t,n,r){we(e).onIdTokenChanged(t,n,r)}(n,(e=>t(e)))}}var i;const a=X("auth");return a&&gr(n,`http://${a}`),n}(Xm),tf=function(e,t){const n="string"==typeof e?e:t||"(default)",r=Pt("object"==typeof e?e:Ot(),"firestore").getImmediate({identifier:n});if(!r._initialized){const e=(e=>{const t=X(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("firestore");e&&Ih(r,...e)}return r}(Xm),nf=(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ot();e=we(e);const t=Pt(e,bm);t.isInitialized()?t.getImmediate():function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Pt(e,bm);if(n.isInitialized()){const e=n.getImmediate();if(ue(t,n.getOptions()))return e;throw Nm.create("already-initialized")}const r=n.initialize({options:t})}(e)}(Xm),async()=>{try{const e=await async function(e){var t;if(It(e.app))return Promise.reject(an(e));const n=cr(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new Or({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await Rr(n,{returnSecureToken:!0}),i=await Or._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}(ef);return e.user}catch(e){throw console.error("B\u0142\u0105d logowania anonimowego:",e),e}}),rf=async(e,t)=>{if(!ef.currentUser)return null;try{const n=ef.currentUser.uid,r={userId:n,nickname:ef.currentUser.displayName||"Anonimowy gracz",gameState:{day:e.day,turn:e.turn,gameDate:e.gameDate,currentScreen:e.currentScreen,gameSpeed:e.gameSpeed,competitors:e.competitors,marketProjects:e.marketProjects,marketHistory:e.marketHistory},playerState:{cash:t.cash,reputation:t.reputation,installedCapacity:t.installedCapacity,rtbCapacity:t.rtbCapacity,rtbPower:t.rtbPower,economicMetrics:t.economicMetrics,staff:t.staff,projects:t.projects,gameGoals:t.gameGoals,knownRegions:t.knownRegions,capabilities:t.capabilities,modifiers:t.modifiers},timestamp:new Date};return await function(e,t,n){e=Ch(e,Mh);const r=Ch(e.firestore,Fh),i=kp(e.converter,t,n);return Tp(r,[Xh(Jh(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,El.none())])}(Oh(tf,"saves",n),r),r}catch(n){throw console.error("B\u0142\u0105d zapisywania stanu gry:",n),n}},af=async()=>{if(!ef.currentUser)return null;try{const e=ef.currentUser.uid,t=await function(e){e=Ch(e,Mh);const t=Ch(e.firestore,Fh);return bh(Uh(t),e._key).then((n=>Pp(t,e,n)))}(Oh(tf,"saves",e));return t.exists()?t.data():null}catch(e){throw console.error("B\u0142\u0105d wczytywania stanu gry:",e),e}},sf=async(e,t)=>{if(!ef.currentUser)return null;try{const n={userId:ef.currentUser.uid,nickname:ef.currentUser.displayName||"Anonimowy gracz",goal:e,days:t,timestamp:new Date};return await function(e,t){const n=Ch(e.firestore,Fh),r=Oh(e),i=kp(e.converter,t);return Tp(n,[Xh(Jh(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,El.exists(!1))]).then((()=>r))}(Rh(tf,"leaderboard"),n),n}catch(n){throw console.error("B\u0142\u0105d zapisywania wyniku do tablicy wynik\xf3w:",n),n}},of=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{e||(e="25GW"),"number"!==typeof t&&(t=10);const r=function(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];t instanceof mp&&n.push(t),n=n.concat(i),function(e){const t=e.filter((e=>e instanceof gp)).length,n=e.filter((e=>e instanceof yp)).length;if(t>1||t>0&&n>0)throw new Aa(Ia.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)e=s._apply(e);return e}(Rh(tf,"leaderboard"),function(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=hp("orderBy",e);return vp._create(n,t)}("turns","asc"),t(t));try{const e=await function(e){e=Ch(e,Ah);const t=Ch(e.firestore,Fh),n=Uh(t),r=new Cp(t);return pp(e._query),jh(n,e._query).then((n=>new Ep(t,r,e,n)))}(r),t=[];return e.forEach((e=>{t.push({id:e.id,...e.data()})})),t}catch(n){return console.error("B\u0142\u0105d podczas wykonywania zapytania:",n),[]}}catch(r){return console.error("B\u0142\u0105d pobierania tablicy wynik\xf3w:",r),[]}},lf=e=>function(e,t,n,r){return we(e).onAuthStateChanged(t,n,r)}(ef,e),cf=e=>e.toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"}),df={day:1,turn:1,gameDate:new Date("2024-01-01"),gameSpeed:1,currentScreen:"home",appView:null,notification:null,selectedRegion:null,selectedCounty:null,selectedProject:null,globalEvents:{currentEvents:[],eventProbabilities:{economic:.2,political:.1,social:.15,environmental:.1,technological:.15},historicalEvents:[]},competitors:u,marketProjects:[],marketHistory:[],marketPriceModifiers:{PV:1,WF:1,BESS:1},reputationModifiers:{projectCost:1,constructionSpeed:1,projectQuality:1,permitSpeed:1,leasingSuccess:1,gridConnectionCost:1},economyModifiers:{inflationRate:.05,interestRate:.06,gridConnectionCost:1,permitCost:1,energyPrice:1,constructionCost:1},parallelProcessing:{enabled:!0,maxParallelTasks:3},goals:{installedCapacity:{target:25e3,achieved:!1,achievedOn:null},money:{target:1e10,achieved:!1,achievedOn:null}}};function uf(e,t){switch(t.type){case"SET_SCREEN":return{...e,currentScreen:t.payload};case"SELECT_REGION":return{...e,selectedRegion:t.payload,selectedCounty:null};case"SELECT_COUNTY":return{...e,selectedCounty:t.payload};case"SELECT_PROJECT":return{...e,selectedProject:t.payload};case"SET_NOTIFICATION":return{...e,notification:t.payload};case"ADVANCE_DAY":const n=e.gameSpeed,r=((e,t)=>{const n=new Date(e);return n.setDate(n.getDate()+t),n})(e.gameDate,n);return{...e,day:e.day+n,gameDate:r,lastDateUpdate:new Date};case"SET_GAME_SPEED":return{...e,gameSpeed:t.payload};case"UPDATE_MARKET_PROJECTS":return{...e,marketProjects:t.payload};case"ADD_MARKET_PROJECT":return{...e,marketProjects:[...e.marketProjects,t.payload]};case"REMOVE_MARKET_PROJECT":return{...e,marketProjects:e.marketProjects.filter((e=>e.id!==t.payload))};case"ADD_MARKET_HISTORY":return{...e,marketHistory:[...e.marketHistory,t.payload]};case"UPDATE_MARKET_PRICE_MODIFIERS":return{...e,marketPriceModifiers:{...e.marketPriceModifiers,...t.payload}};case"UPDATE_REPUTATION_MODIFIERS":return{...e,reputationModifiers:{...e.reputationModifiers,...t.payload}};case"UPDATE_ECONOMY_STATE":return{...e,economyModifiers:{...e.economyModifiers,...t.payload}};case"SET_PARALLEL_PROCESSING":return{...e,parallelProcessing:{...e.parallelProcessing,...t.payload}};case"UPDATE_GAME_GOALS":return{...e,goals:{...e.goals,...t.payload}};case"SET_WIN_CONDITION":return{...e,goals:{...e.goals,isWon:!0,winReason:t.payload}};case"ADD_GLOBAL_EVENT":return{...e,globalEvents:{...e.globalEvents,currentEvents:[...e.globalEvents.currentEvents,t.payload]}};case"ADD_GLOBAL_EVENTS":return{...e,globalEvents:{...e.globalEvents,currentEvents:[...e.globalEvents.currentEvents,...t.payload]}};case"REMOVE_GLOBAL_EVENT":return{...e,globalEvents:{...e.globalEvents,currentEvents:e.globalEvents.currentEvents.filter((e=>e.id!==t.payload))}};case"UPDATE_EVENT_PROBABILITIES":return{...e,globalEvents:{...e.globalEvents,eventProbabilities:{...e.globalEvents.eventProbabilities,...t.payload}}};case"LOAD_GAME":return{...e,...t.payload,notification:e.notification,appView:e.appView};case"SET_APP_VIEW":return{...e,appView:t.payload};default:return e}}const hf=(0,r.createContext)();function pf(e){let{children:t}=e;const[n,i]=(0,r.useReducer)(uf,df),{dispatch:s}=q();(0,r.useEffect)((()=>{c()}),[]);const o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";try{window.notificationQueue||(window.notificationQueue=[],window.activeNotifications=0,window.lastNotificationTime=0);const n="error"===t,r=Date.now();if(window.notificationQueue.some((t=>t.text===e&&r-t.addedAt<5e3))&&!n)return void console.log("Podobne powiadomienie ju\u017c zosta\u0142o wy\u015bwietlone niedawno:",e);window.notificationQueue.push({text:e,type:t,addedAt:r});const a=5;window.notificationQueue.length>a&&(window.notificationQueue=window.notificationQueue.sort(((e,t)=>"error"===e.type&&"error"!==t.type?1:"error"!==e.type&&"error"===t.type?-1:e.addedAt-t.addedAt)).slice(-a));const s=()=>{if(0===window.notificationQueue.length||window.activeNotifications>=2)return;if(r-window.lastNotificationTime<500&&!n)return void setTimeout(s,500);const e=window.notificationQueue.shift();window.lastNotificationTime=Date.now(),window.activeNotifications++,i({type:"SET_NOTIFICATION",payload:{text:e.text,type:e.type}});const t="error"===e.type?8e3:"success"===e.type?5e3:3e3;setTimeout((()=>{i({type:"SET_NOTIFICATION",payload:null}),window.activeNotifications--,setTimeout(s,300)}),t)};s()}catch(n){console.error("B\u0142\u0105d podczas wy\u015bwietlania powiadomienia:",n),i({type:"SET_NOTIFICATION",payload:{text:e,type:t}}),setTimeout((()=>{i({type:"SET_NOTIFICATION",payload:null})}),5e3)}},l=()=>{const e={},t=.02*Math.random()-.01;e.inflationRate=Math.max(0,Math.min(.15,n.economyModifiers.inflationRate+t));const r=.01*Math.random()-.005;e.economicGrowth=Math.max(-.05,Math.min(.08,n.economyModifiers.economicGrowth+r)),n.economyModifiers.inflationRate>n.economyModifiers.interestRate+.02?e.interestRate=n.economyModifiers.interestRate+.01:n.economyModifiers.inflationRate<n.economyModifiers.interestRate-.02&&(e.interestRate=n.economyModifiers.interestRate-.01),i({type:"UPDATE_ECONOMY_STATE",payload:e})},c=()=>{const e=(e=>{if(!e||0===e.length)return{marketModifier:1,permitTimeModifier:1,buildCostModifier:1,riskLevel:0,grayAreaImpact:0,reputationChange:0};const t={marketModifier:1,permitTimeModifier:1,buildCostModifier:1,riskLevel:0,grayAreaImpact:0,reputationChange:0};return e.forEach((e=>{if(!e.effects)return;const n=f(e.effects);n.marketModifier&&(t.marketModifier*=n.marketModifier),n.permitTimeModifier&&(t.permitTimeModifier*=n.permitTimeModifier),n.buildCostModifier&&(t.buildCostModifier*=n.buildCostModifier),n.riskLevel&&(t.riskLevel+=n.riskLevel),n.grayAreaImpact&&(t.grayAreaImpact+=n.grayAreaImpact),n.reputationChange&&(t.reputationChange+=n.reputationChange)})),y(t)})(n.globalEvents.currentEvents.filter((e=>!e.expiryDate||new Date(e.expiryDate)>n.gameDate)));i({type:"UPDATE_MODIFIERS",payload:{marketPriceModifiers:{PV:e.marketModifier,WF:e.marketModifier,BESS:e.marketModifier}}})},d=(e,t)=>{if(e&&!n.goals.isWon)return e.rtbPower>=n.goals.rtbPowerTarget?(i({type:"SET_WIN_CONDITION",payload:"rtb_power"}),o(`Gratulacje! Osi\u0105gn\u0105\u0142e\u015b cel mocy RTB - ${n.goals.rtbPowerTarget.toLocaleString()} MW!`,"success"),void(e.installedCapacity+e.rtbCapacity>=25e3&&!e.goals.includes("25GW")&&(t({type:"PLAYER_ADD_GOAL_ACHIEVED",payload:"25GW"}),i({type:"SET_NOTIFICATION",payload:{text:"GRATULACJE! Osi\u0105gni\u0119to cel 25GW mocy zainstalowanej i gotowej do budowy!",type:"success"}}),sf("25GW",n.day).catch((e=>console.error("B\u0142\u0105d zapisywania wyniku 25GW:",e)))))):e.cash>=n.goals.cashTarget?(i({type:"SET_WIN_CONDITION",payload:"cash"}),o(`Gratulacje! Osi\u0105gn\u0105\u0142e\u015b cel finansowy - ${n.goals.cashTarget.toLocaleString()} PLN!`,"success"),void(e.cash>=1e10&&!e.goals.includes("10BLN")&&(t({type:"PLAYER_ADD_GOAL_ACHIEVED",payload:"10BLN"}),i({type:"SET_NOTIFICATION",payload:{text:"GRATULACJE! Osi\u0105gni\u0119to cel 10 miliard\xf3w PLN!",type:"success"}}),sf("10BLN",n.day).catch((e=>console.error("B\u0142\u0105d zapisywania wyniku 10BLN:",e)))))):void 0};return(0,a.jsx)(hf.Provider,{value:{state:n,dispatch:i,showNotification:o,nextDay:(e,t)=>{if(e&&t)try{const u={...e};u.projects||(u.projects={underConstruction:[],completed:[],readyToBuild:[]}),Array.isArray(u.projects.underConstruction)&&u.projects.underConstruction.length>0&&(u.projects.underConstruction=u.projects.underConstruction.map((e=>e?(e.constructionDaysLeft>0&&(e.constructionDaysLeft-=n.gameSpeed,e.constructionDaysLeft<=0&&(e.constructionDaysLeft=0,e.status="completed",e.completionDate=new Date(n.gameDate),o(`Projekt ${e.name||"bez nazwy"} zosta\u0142 zbudowany i jest gotowy do produkcji!`,"success"),Array.isArray(u.projects.completed)||(u.projects.completed=[]),u.projects.completed.push(e),u.projects.underConstruction=u.projects.underConstruction.filter((t=>t&&t.id!==e.id)))),e):e)));try{c()}catch(a){console.error("B\u0142\u0105d podczas aktualizacji modyfikator\xf3w gry:",a)}i({type:"ADVANCE_DAY"});try{l()}catch(a){console.error("B\u0142\u0105d podczas aktualizacji ekonomii:",a)}if(s)try{s({type:"LIMIT_EVENTS"}),s({type:"CLEAR_EXPIRED_EVENTS",payload:{currentTurn:n.turn}})}catch(a){console.error("B\u0142\u0105d podczas obs\u0142ugi wydarze\u0144:",a)}try{const e=.1,t=.3,i=Math.min(e*(n.gameSpeed||1),t),a=n.globalEvents.currentEvents.length;if(!(a>16)&&Math.random()<i&&s){var r;const e={turn:n.turn||1,date:new Date(n.gameDate||new Date),day:n.day||1};L((null===(r=n.globalEvents)||void 0===r?void 0:r.eventProbabilities)||{},s,Math.min(n.gameSpeed||1,2),e)}}catch(a){console.error("B\u0142\u0105d podczas generowania wydarze\u0144:",a)}try{d(u,t)}catch(a){console.error("B\u0142\u0105d podczas sprawdzania cel\xf3w gry:",a)}t({type:"UPDATE_PLAYER",payload:u});try{window.dispatchEvent(new Event("next-game-day"))}catch(a){console.error("B\u0142\u0105d podczas wysy\u0142ania zdarzenia next-game-day:",a)}}catch(a){console.error("Krytyczny b\u0142\u0105d w funkcji nextDay:",a),o("Wyst\u0105pi\u0142 b\u0142\u0105d podczas przechodzenia do nast\u0119pnego dnia. Spr\xf3buj ponownie.","error")}else console.error("nextDay wywo\u0142ane z nieprawid\u0142owymi parametrami",{playerState:e,playerDispatch:t})},calculateEventsEffect:e=>{if(!n.globalEvents||!n.globalEvents.currentEvents)return 1;const t=n.globalEvents.currentEvents.filter((t=>t.effects&&t.effects[e]));let r=1;return t.forEach((t=>{t.effects&&t.effects[e]&&(r*=t.effects[e])})),r},formatDate:cf,updateReputationModifiers:e=>{i({type:"UPDATE_REPUTATION_MODIFIERS",payload:e})}},children:t})}const mf=()=>{const e=(0,r.useContext)(hf);if(!e)throw new Error("useGameContext musi by\u0107 u\u017cywany wewn\u0105trz GameProvider");return e},ff=[{id:"dolnoslaskie",name:"Dolno\u015bl\u0105skie",gridCapacity:500,solarConditions:70,windConditions:60,socialAcceptance:60,environmentalComplexity:1.2,adminEfficiency:.9,availableLand:12e3,landPriceMultiplier:1.1,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"kujawsko-pomorskie",name:"Kujawsko-Pomorskie",gridCapacity:400,solarConditions:65,windConditions:75,socialAcceptance:50,environmentalComplexity:1,adminEfficiency:1,availableLand:15e3,landPriceMultiplier:.9,projects:[],protests:[],dominantPlayer:null,isOPRO:!0},{id:"lubelskie",name:"Lubelskie",gridCapacity:380,solarConditions:75,windConditions:55,socialAcceptance:65,environmentalComplexity:.9,adminEfficiency:1.1,availableLand:18e3,landPriceMultiplier:.8,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"lubuskie",name:"Lubuskie",gridCapacity:320,solarConditions:65,windConditions:70,socialAcceptance:55,environmentalComplexity:.8,adminEfficiency:1,availableLand:13e3,landPriceMultiplier:.9,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"lodzkie",name:"\u0141\xf3dzkie",gridCapacity:450,solarConditions:70,windConditions:65,socialAcceptance:60,environmentalComplexity:1,adminEfficiency:1,availableLand:14e3,landPriceMultiplier:1,projects:[],protests:[],dominantPlayer:null,isOPRO:!0},{id:"malopolskie",name:"Ma\u0142opolskie",gridCapacity:420,solarConditions:65,windConditions:50,socialAcceptance:55,environmentalComplexity:1.3,adminEfficiency:.9,availableLand:9e3,landPriceMultiplier:1.3,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"mazowieckie",name:"Mazowieckie",gridCapacity:550,solarConditions:70,windConditions:65,socialAcceptance:65,environmentalComplexity:1,adminEfficiency:.8,availableLand:2e4,landPriceMultiplier:1.2,projects:[],protests:[],dominantPlayer:null,isOPRO:!0},{id:"opolskie",name:"Opolskie",gridCapacity:300,solarConditions:65,windConditions:60,socialAcceptance:60,environmentalComplexity:1,adminEfficiency:1.1,availableLand:8e3,landPriceMultiplier:.9,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"podkarpackie",name:"Podkarpackie",gridCapacity:340,solarConditions:70,windConditions:50,socialAcceptance:60,environmentalComplexity:1.2,adminEfficiency:1,availableLand:12e3,landPriceMultiplier:.8,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"podlaskie",name:"Podlaskie",gridCapacity:320,solarConditions:65,windConditions:60,socialAcceptance:55,environmentalComplexity:1.1,adminEfficiency:1,availableLand:16e3,landPriceMultiplier:.7,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"pomorskie",name:"Pomorskie",gridCapacity:430,solarConditions:60,windConditions:85,socialAcceptance:70,environmentalComplexity:1.1,adminEfficiency:.9,availableLand:13e3,landPriceMultiplier:1.1,projects:[],protests:[],dominantPlayer:null,isOPRO:!0},{id:"slaskie",name:"\u015al\u0105skie",gridCapacity:520,solarConditions:65,windConditions:55,socialAcceptance:50,environmentalComplexity:1.4,adminEfficiency:.8,availableLand:7e3,landPriceMultiplier:1.2,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"swietokrzyskie",name:"\u015awi\u0119tokrzyskie",gridCapacity:310,solarConditions:70,windConditions:55,socialAcceptance:60,environmentalComplexity:1,adminEfficiency:1.1,availableLand:1e4,landPriceMultiplier:.8,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"warminsko-mazurskie",name:"Warmi\u0144sko-Mazurskie",gridCapacity:350,solarConditions:60,windConditions:75,socialAcceptance:65,environmentalComplexity:1.2,adminEfficiency:1,availableLand:17e3,landPriceMultiplier:.8,projects:[],protests:[],dominantPlayer:null,isOPRO:!0},{id:"wielkopolskie",name:"Wielkopolskie",gridCapacity:480,solarConditions:65,windConditions:70,socialAcceptance:60,environmentalComplexity:1,adminEfficiency:.9,availableLand:19e3,landPriceMultiplier:1,projects:[],protests:[],dominantPlayer:null,isOPRO:!0},{id:"zachodniopomorskie",name:"Zachodniopomorskie",gridCapacity:400,solarConditions:60,windConditions:90,socialAcceptance:70,environmentalComplexity:1,adminEfficiency:1,availableLand:15e3,landPriceMultiplier:.9,projects:[],protests:[],dominantPlayer:null,isOPRO:!0}],yf=(0,r.createContext)();function gf(e,t){switch(t.type){case"UPDATE_REGION":return e.map((e=>e.id===t.payload.id?{...e,...t.payload.changes}:e));case"ADD_PROJECT_TO_REGION":return e.map((e=>e.id===t.payload.regionId?{...e,projects:[...e.projects,t.payload.project],availableLand:Math.max(0,e.availableLand-t.payload.project.size)}:e));case"UPDATE_REGIONAL_CONDITIONS":return e.map((e=>{const t=Math.floor(5*Math.random())-2,n=Math.floor(5*Math.random())-2,r=Math.floor(3*Math.random())-1;return{...e,solarConditions:Math.min(100,Math.max(0,e.solarConditions+t)),windConditions:Math.min(100,Math.max(0,e.windConditions+n)),socialAcceptance:Math.min(100,Math.max(0,e.socialAcceptance+r))}}));case"ADD_LAND_ACQUISITION_PROCESS":return e.map((e=>e.id===t.payload.regionId?{...e,landAcquisitionProcesses:[...e.landAcquisitionProcesses||[],t.payload.process]}:e));case"UPDATE_LAND_ACQUISITION_PROCESS":return e.map((e=>e.id===t.payload.regionId?{...e,landAcquisitionProcesses:(e.landAcquisitionProcesses||[]).map((e=>e.id===t.payload.processId?{...e,...t.payload.changes}:e))}:e));case"REMOVE_LAND_ACQUISITION_PROCESS":return e.map((e=>e.id===t.payload.regionId?{...e,landAcquisitionProcesses:(e.landAcquisitionProcesses||[]).filter((e=>e.id!==t.payload.processId))}:e));case"UPDATE_LAND_ACQUISITION_PROCESSES_PROGRESS":return e.map((e=>{const n=(e.landAcquisitionProcesses||[]).map((n=>{if("in_progress"===n.status){const r=new Date(t.payload.currentDate),i=new Date(n.startDate),a=new Date(n.completionDate);if(console.log("Aktualizacja procesu pozyskiwania gruntu:",{processId:n.id,regionId:e.id,currentDate:r.toISOString(),startDate:i.toISOString(),completionDate:a.toISOString()}),r>=a)return console.log(`Proces ${n.id} zako\u0144czony, post\u0119p 100%`),{...n,status:"ready_for_negotiation",progress:100};if(r>i){const e=a.getTime()-i.getTime(),t=r.getTime()-i.getTime(),s=Math.min(99,Math.floor(t/e*100));return console.log(`Proces ${n.id} w trakcie, post\u0119p ${s}%`),{...n,progress:s}}}return n}));return{...e,landAcquisitionProcesses:n}}));default:return e}}const vf=e=>{let{children:t}=e;const[n,i]=(0,r.useReducer)(gf,ff),{state:s,showNotification:o}=mf();return(0,r.useEffect)((()=>{const e=e=>{console.log("Wywo\u0142anie wydarzenia update-land-acquisition",e.detail),i({type:"UPDATE_LAND_ACQUISITION_PROCESSES_PROGRESS",payload:{currentDate:e.detail.currentDate||new Date(s.gameDate)}})},t=()=>{console.log("Wywo\u0142anie wydarzenia next-game-day, aktualizacja proces\xf3w gruntowych");const e=new Date(s.gameDate);i({type:"UPDATE_LAND_ACQUISITION_PROCESSES_PROGRESS",payload:{currentDate:e}}),n.forEach((e=>{e.landAcquisitionProcesses&&e.landAcquisitionProcesses.forEach((t=>{"ready_for_negotiation"===t.status&&100===t.progress&&o(`Proces poszukiwania dzia\u0142ki ${t.size}ha w regionie ${e.name} zako\u0144czony. Skaut ${t.scoutName} czeka na rozpocz\u0119cie negocjacji.`,"success")}))}))};return window.addEventListener("update-land-acquisition",e),window.addEventListener("next-game-day",t),()=>{window.removeEventListener("update-land-acquisition",e),window.removeEventListener("next-game-day",t)}}),[i,n,s.gameDate,o]),(0,a.jsx)(yf.Provider,{value:{state:n,dispatch:i},children:t})},wf=()=>{const e=(0,r.useContext)(yf);if(!e)throw new Error("useRegionsContext must be used within a RegionsProvider");return e},xf={dolnoslaskie:[{id:"wroclawski",name:"Wroc\u0142awski",capital:"Wroc\u0142aw",population:64e4,area:2930,solarPotential:75,windPotential:60,availableLand:1800,gridCapacity:120,environmentalRestrictions:45,administrativeEfficiency:70,localOpposition:35,propertyPrices:1.8,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}},{id:"jeleniogorski",name:"Jeleniog\xf3rski",capital:"Jelenia G\xf3ra",population:12e4,area:1880,solarPotential:65,windPotential:85,availableLand:1200,gridCapacity:80,environmentalRestrictions:75,administrativeEfficiency:65,localOpposition:45,propertyPrices:1.2,projects:[],events:[],isNatura2000:!0,isProtectedLandscape:!0,powerLines:{hv:!0,mv:!0}},{id:"walbrzyski",name:"Wa\u0142brzyski",capital:"Wa\u0142brzych",population:17e4,area:1650,solarPotential:60,windPotential:70,availableLand:900,gridCapacity:70,environmentalRestrictions:65,administrativeEfficiency:60,localOpposition:50,propertyPrices:.9,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!0,powerLines:{hv:!0,mv:!0}}],mazowieckie:[{id:"warszawski",name:"Warszawski",capital:"Warszawa",population:18e5,area:3200,solarPotential:70,windPotential:55,availableLand:1300,gridCapacity:250,environmentalRestrictions:50,administrativeEfficiency:80,localOpposition:40,propertyPrices:3.2,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}},{id:"radomski",name:"Radomski",capital:"Radom",population:25e4,area:2500,solarPotential:75,windPotential:60,availableLand:2100,gridCapacity:90,environmentalRestrictions:35,administrativeEfficiency:65,localOpposition:30,propertyPrices:.8,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}},{id:"plocki",name:"P\u0142ocki",capital:"P\u0142ock",population:17e4,area:1800,solarPotential:65,windPotential:70,availableLand:1900,gridCapacity:110,environmentalRestrictions:40,administrativeEfficiency:60,localOpposition:25,propertyPrices:.9,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}}],wielkopolskie:[{id:"poznanski",name:"Pozna\u0144ski",capital:"Pozna\u0144",population:54e4,area:2800,solarPotential:65,windPotential:80,availableLand:2200,gridCapacity:150,environmentalRestrictions:40,administrativeEfficiency:75,localOpposition:30,propertyPrices:2.1,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}},{id:"kaliski",name:"Kaliski",capital:"Kalisz",population:16e4,area:2100,solarPotential:70,windPotential:65,availableLand:1800,gridCapacity:85,environmentalRestrictions:35,administrativeEfficiency:70,localOpposition:25,propertyPrices:1.1,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}}],malopolskie:[{id:"krakowski",name:"Krakowski",capital:"Krak\xf3w",population:76e4,area:2300,solarPotential:65,windPotential:40,availableLand:1100,gridCapacity:130,environmentalRestrictions:70,administrativeEfficiency:75,localOpposition:55,propertyPrices:2.5,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!0,powerLines:{hv:!0,mv:!0}},{id:"tarnowski",name:"Tarnowski",capital:"Tarn\xf3w",population:15e4,area:1900,solarPotential:70,windPotential:45,availableLand:1500,gridCapacity:70,environmentalRestrictions:55,administrativeEfficiency:65,localOpposition:40,propertyPrices:1,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}}],pomorskie:[{id:"gdanski",name:"Gda\u0144ski",capital:"Gda\u0144sk",population:47e4,area:2200,solarPotential:60,windPotential:95,availableLand:1400,gridCapacity:160,environmentalRestrictions:60,administrativeEfficiency:75,localOpposition:35,propertyPrices:2.3,projects:[],events:[],isNatura2000:!0,isProtectedLandscape:!0,powerLines:{hv:!0,mv:!0}},{id:"slupski",name:"S\u0142upski",capital:"S\u0142upsk",population:12e4,area:2500,solarPotential:55,windPotential:100,availableLand:2e3,gridCapacity:120,environmentalRestrictions:55,administrativeEfficiency:60,localOpposition:30,propertyPrices:.9,projects:[],events:[],isNatura2000:!0,isProtectedLandscape:!0,powerLines:{hv:!0,mv:!0}}]},bf=(0,r.createContext)(),jf=(()=>{const e=[];return Object.keys(xf).forEach((t=>{xf[t].forEach((n=>{e.push({...n,voivodeship:t})}))})),e})();function kf(e,t){switch(t.type){case"UPDATE_COUNTY":return e.map((e=>e.id===t.payload.id&&e.voivodeship===t.payload.voivodeship?{...e,...t.payload.changes}:e));case"ADD_PROJECT_TO_COUNTY":return e.map((e=>e.id===t.payload.countyId&&e.voivodeship===t.payload.voivodeship?{...e,projects:[...e.projects,t.payload.project],availableLand:Math.max(0,e.availableLand-t.payload.project.size)}:e));case"REMOVE_PROJECT_FROM_COUNTY":return e.map((e=>e.id===t.payload.countyId&&e.voivodeship===t.payload.voivodeship?{...e,projects:e.projects.filter((e=>e.id!==t.payload.projectId)),availableLand:e.availableLand+t.payload.projectSize}:e));case"ADD_EVENT_TO_COUNTY":return e.map((e=>e.id===t.payload.countyId&&e.voivodeship===t.payload.voivodeship?{...e,events:[...e.events,t.payload.event]}:e));case"REMOVE_EVENT_FROM_COUNTY":return e.map((e=>e.id===t.payload.countyId&&e.voivodeship===t.payload.voivodeship?{...e,events:e.events.filter((e=>e.id!==t.payload.eventId))}:e));case"UPDATE_COUNTY_PARAMETERS":return e.map((e=>e.id===t.payload.countyId&&e.voivodeship===t.payload.voivodeship?{...e,...t.payload.parameters}:e));case"UPDATE_ALL_COUNTIES":return e.map((e=>{const t=5*Math.random()-2.5,n=5*Math.random()-2.5,r=3*Math.random()-1.5,i=(.1*Math.random()-.05)*e.propertyPrices;return{...e,solarPotential:Math.max(0,Math.min(100,e.solarPotential+t)),windPotential:Math.max(0,Math.min(100,e.windPotential+n)),localOpposition:Math.max(0,Math.min(100,e.localOpposition+r)),propertyPrices:Math.max(.5,e.propertyPrices+i)}}));default:return e}}const Nf=e=>{let{children:t}=e;const[n,i]=(0,r.useReducer)(kf,jf);return(0,a.jsx)(bf.Provider,{value:{state:n,dispatch:i},children:t})},zf={competitors:u,competitorEvents:[],lastUpdateTurn:0},_f="UPDATE_COMPETITORS",Ef="ADD_COMPETITOR_EVENT",Sf="INCREASE_COMPETITOR_POWER",Cf="ADD_COMPETITOR_REGION",Tf="ADD_COMPETITOR_TECHNOLOGY",Pf=(e,t)=>{switch(t.type){case _f:return{...e,competitors:t.payload,lastUpdateTurn:t.turn};case Ef:return{...e,competitorEvents:[...e.competitorEvents,t.payload]};case Sf:return{...e,competitors:e.competitors.map((e=>e.id===t.payload.competitorId?{...e,power:e.power+t.payload.value,rtbPower:e.rtbPower+Math.floor(.3*t.payload.value)}:e))};case Cf:return{...e,competitors:e.competitors.map((e=>e.id===t.payload.competitorId?{...e,strongRegions:[...e.strongRegions,t.payload.regionId]}:e))};case Tf:return{...e,competitors:e.competitors.map((e=>e.id===t.payload.competitorId?{...e,focusTechnologies:[...e.focusTechnologies,t.payload.technology]}:e))};default:return e}},If=(0,r.createContext)(),Af=e=>{let{children:t}=e;const[n,i]=(0,r.useReducer)(Pf,zf),{state:s}=mf(),{state:o}=wf();(0,r.useEffect)((()=>{s.turn>n.lastUpdateTurn&&(l(),c())}),[s.turn]);const l=()=>{const e=n.competitors.map((e=>{const t=Math.floor(e.power*(e.growth-1)),n=Math.floor(.3*t);return{...e,power:e.power+t,rtbPower:e.rtbPower+n}}));i({type:_f,payload:e,turn:s.turn})},c=()=>{if(!o||!o.regions||0===o.regions.length)return;const e=n.competitors[Math.floor(Math.random()*n.competitors.length)],t=h(e,o.regions);t&&(i({type:Ef,payload:{...t,turn:s.turn}}),t.effects.forEach((e=>{switch(e.type){case"competitor_power":case"competitor_power_boost":i({type:Sf,payload:{competitorId:e.competitorId,value:e.value}});break;case"competitor_technology":i({type:Tf,payload:{competitorId:e.competitorId,technology:e.value}})}})))};return(0,a.jsx)(If.Provider,{value:{state:n,dispatch:i},children:t})},Mf=()=>{const{state:e,dispatch:t}=d(),{state:n,dispatch:i}=mf(),a=(0,r.useCallback)((()=>{try{console.log("Odebrano zdarzenie next-game-day, gameSpeed:",(null===n||void 0===n?void 0:n.gameSpeed)||1),n&&n.appView&&i({type:"SET_APP_VIEW",payload:null});try{window.dispatchEvent(new CustomEvent("process-time-acceleration",{detail:{gameSpeed:(null===n||void 0===n?void 0:n.gameSpeed)||1,day:(null===n||void 0===n?void 0:n.day)||1,turn:(null===n||void 0===n?void 0:n.turn)||1}}))}catch(e){console.error("B\u0142\u0105d przy wysy\u0142aniu zdarzenia process-time-acceleration:",e)}}catch(e){console.error("B\u0142\u0105d w obs\u0142udze zdarzenia next-game-day:",e)}}),[n,i]);return(0,r.useEffect)((()=>(window.addEventListener("next-game-day",a),()=>{window.removeEventListener("next-game-day",a)})),[a]),null};class Df extends r.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("B\u0142\u0105d w komponencie Store:",e,t),this.setState({errorInfo:t})}render(){var e;return this.state.hasError?(0,a.jsxs)("div",{className:"store-error-boundary",children:[(0,a.jsx)("h2",{children:"Wyst\u0105pi\u0142 b\u0142\u0105d w aplikacji"}),(0,a.jsx)("p",{children:(null===(e=this.state.error)||void 0===e?void 0:e.message)||"Nieznany b\u0142\u0105d"}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-500 text-white rounded",children:"Od\u015bwie\u017c stron\u0119"})]}):this.props.children}}const Rf=e=>{let{children:t}=e;return(0,a.jsx)(Df,{children:(0,a.jsx)(W,{children:(0,a.jsx)(c,{children:(0,a.jsx)(pf,{children:(0,a.jsx)(vf,{children:(0,a.jsx)(Nf,{children:(0,a.jsxs)(Af,{children:[(0,a.jsx)(Mf,{}),t]})})})})})})})};var Of={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Lf=(e,t)=>{const n=(0,r.forwardRef)(((n,i)=>{let{color:a="currentColor",size:s=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:d,...u}=n;return(0,r.createElement)("svg",{ref:i,...Of,width:s,height:s,stroke:a,strokeWidth:l?24*Number(o)/Number(s):o,className:["lucide",`lucide-${h=e,h.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()}`,c].join(" "),...u},[...t.map((e=>{let[t,n]=e;return(0,r.createElement)(t,n)})),...Array.isArray(d)?d:[d]]);var h}));return n.displayName=`${e}`,n},Ff=Lf("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Uf=Lf("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Vf=Lf("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]),Bf=Lf("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),$f=Lf("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),Wf=Lf("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]),qf=Lf("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Hf=Lf("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Kf=Lf("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Gf=Lf("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Qf=Lf("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),Zf=Lf("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Yf=Lf("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),Jf=Lf("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Xf=e=>{let{text:t,type:n="info",onClose:i,autoClose:s=!0,duration:o=5e3}=e;(0,r.useEffect)((()=>{if(s){const e=setTimeout((()=>{i()}),o);return()=>clearTimeout(e)}}),[s,o,i]);return(0,a.jsxs)("div",{className:(()=>{const e="notification flex items-center";switch(n){case"win":case"success":return`${e} bg-green-500 text-white`;case"error":return`${e} bg-red-500 text-white`;case"warning":return`${e} bg-yellow-500 text-black`;default:return`${e} bg-blue-500 text-white`}})(),children:[(0,a.jsx)("div",{className:"mr-4",children:t}),(0,a.jsx)("button",{className:"ml-4 px-2 py-1 rounded bg-opacity-20 bg-black hover:bg-opacity-30 transition-all",onClick:i,children:"\u2715"})]})},ey=Lf("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),ty=Lf("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),ny=Lf("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),ry=Lf("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);class iy{constructor(e,t,n){this.playerState=e,this.playerDispatch=t,this.gameState=n}getReputationStatus(){const{reputation:e,reputationFactors:t,reputationHistory:n}=this.playerState;return{current:e,category:this.getReputationCategory(e),factors:t,trend:this.calculateReputationTrend(n)}}calculateReputationTrend(e){if(!e||e.length<5)return"stable";const t=e.filter((e=>void 0!==e.change)).slice(-5).map((e=>e.change));if(0===t.length)return"stable";const n=t.reduce(((e,t)=>e+t),0);return n>5?"rising":n<-5?"falling":"stable"}getReputationCategory(e){return e>=150?"excellent":e>=100?"good":e>=50?"average":e>=25?"poor":"terrible"}getReputationModifiers(){const{reputation:e,reputationFactors:t}=this.playerState,n={projectCost:1,constructionSpeed:1,projectQuality:1,staffRecruitmentCost:1,loanInterestRate:1,projectSalePrice:1,auditFrequency:1,stakeholderTrust:1};e>=150?(n.projectCost*=.85,n.constructionSpeed*=1.2,n.staffRecruitmentCost*=.9,n.loanInterestRate*=.8,n.projectSalePrice*=1.25,n.auditFrequency*=.5,n.stakeholderTrust*=1.5):e>=100?(n.projectCost*=.95,n.constructionSpeed*=1.1,n.loanInterestRate*=.9,n.projectSalePrice*=1.1,n.auditFrequency*=.8,n.stakeholderTrust*=1.2):e>=50||(e>=25?(n.projectCost*=1.1,n.constructionSpeed*=.9,n.staffRecruitmentCost*=1.1,n.loanInterestRate*=1.2,n.projectSalePrice*=.9,n.auditFrequency*=1.5,n.stakeholderTrust*=.8):(n.projectCost*=1.25,n.constructionSpeed*=.8,n.staffRecruitmentCost*=1.25,n.loanInterestRate*=1.5,n.projectSalePrice*=.75,n.auditFrequency*=2.5,n.stakeholderTrust*=.5));const{legalCompliance:r,environmentalImpact:i,communityRelations:a,projectQuality:s,transparency:o,grayAreaActivity:l}=t;return n.auditFrequency*=1-r+1,n.loanInterestRate*=1+.3*(1-r),n.projectSalePrice*=1+.2*(i-1),n.stakeholderTrust*=1+.2*(i-1),n.constructionSpeed*=1+.1*(a-1),n.stakeholderTrust*=1+.3*(a-1),n.projectSalePrice*=1+.3*(s-1),n.projectCost*=1-.1*(s-1),n.loanInterestRate*=1-.2*(o-1),n.auditFrequency*=1-.1*(o-1),n.auditFrequency*=1+.5*(l-1),n.stakeholderTrust*=1-.3*(l-1),n}calculateReputationBonus(e){const{reputation:t,reputationFactors:n}=this.playerState;let r=0;r=t>=150?.2:t>=100?.1:t>=50?0:t>=25?-.1:-.2;const i={negotiate_land:["communityRelations","transparency"],apply_for_permit:["legalCompliance","transparency"],environmental_study:["environmentalImpact","projectQuality"],lobby_officials:["transparency","legalCompliance"],project_design:["projectQuality","environmentalImpact"],build_project:["projectQuality","communityRelations"],get_grid_connection:["legalCompliance","transparency"],get_loan:["legalCompliance","transparency"]}[e]||[];let a=0;if(i.length>0){const e=i.reduce(((e,t)=>e+(n[t]||1)),0);a=.2*(e/i.length-1)}const s=r+a;return Math.max(-.3,Math.min(.3,s))}updateReputationForEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={project_success:{reputationChange:5,factorChanges:{projectQuality:.05}},project_delay:{reputationChange:-3,factorChanges:{projectQuality:-.03,transparency:-.02}},local_protest:{reputationChange:-8,factorChanges:{communityRelations:-.1,transparency:-.05}},environmental_award:{reputationChange:10,factorChanges:{environmentalImpact:.1,projectQuality:.05}},project_overbudget:{reputationChange:-5,factorChanges:{projectQuality:-.05,transparency:-.03}},positive_media_coverage:{reputationChange:7,factorChanges:{transparency:.05}},negative_media_coverage:{reputationChange:-7,factorChanges:{transparency:-.05}},successful_audit:{reputationChange:8,factorChanges:{legalCompliance:.08,transparency:.05}},innovation_breakthrough:{reputationChange:12,factorChanges:{projectQuality:.1,environmentalImpact:.08}},staff_incident:{reputationChange:-6,factorChanges:{transparency:-.04,projectQuality:-.03}}}[e];if(n&&(this.playerDispatch({type:"UPDATE_REPUTATION",payload:{change:n.reputationChange,reason:t.reason||`Zdarzenie: ${e}`,turn:this.gameState.turn}}),n.factorChanges))for(const[r,i]of Object.entries(n.factorChanges))this.playerDispatch({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:r,change:i,reason:t.reason||`Zdarzenie: ${e}`,turn:this.gameState.turn}})}triggerRandomEvent(){const{reputation:e,reputationFactors:t}=this.playerState,n=[{type:"positive_media_coverage",weight:10+(e-100)/5,condition:()=>e>70&&t.transparency>.8},{type:"negative_media_coverage",weight:10+(100-e)/5,condition:()=>e<130&&t.transparency<1.2},{type:"local_protest",weight:8+20*(1-t.communityRelations),condition:()=>t.communityRelations<1.3},{type:"environmental_award",weight:5+20*(t.environmentalImpact-1),condition:()=>t.environmentalImpact>1.2&&e>80},{type:"innovation_breakthrough",weight:3+10*(t.projectQuality-1),condition:()=>t.projectQuality>1.1},{type:"staff_incident",weight:7-10*(t.projectQuality-1),condition:()=>t.projectQuality<1.3}].filter((e=>e.condition()));if(0===n.length)return null;const r=n.reduce(((e,t)=>e+Math.max(1,t.weight)),0);let i=Math.random()*r,a=null;for(const s of n){const e=Math.max(1,s.weight);if(i<=e){a=s;break}i-=e}return a||(a=n[0]),this.updateReputationForEvent(a.type),{type:a.type,description:this.getEventDescription(a.type),turn:this.gameState.turn}}getEventDescription(e){return{project_success:"Tw\xf3j projekt zosta\u0142 uko\u0144czony przed terminem, co spotka\u0142o si\u0119 z uznaniem bran\u017cy.",project_delay:"Op\xf3\u017anienia w realizacji projektu wywo\u0142a\u0142y niezadowolenie inwestor\xf3w.",local_protest:"Mieszka\u0144cy protestuj\u0105 przeciwko Twojej inwestycji, obawiaj\u0105c si\u0119 jej wp\u0142ywu na lokaln\u0105 spo\u0142eczno\u015b\u0107.",environmental_award:"Twoja firma otrzyma\u0142a nagrod\u0119 za wk\u0142ad w ochron\u0119 \u015brodowiska i zr\xf3wnowa\u017cony rozw\xf3j.",project_overbudget:"Jeden z Twoich projekt\xf3w znacznie przekroczy\u0142 bud\u017cet, wzbudzaj\u0105c obawy o zarz\u0105dzanie finansami.",positive_media_coverage:"Media pozytywnie opisa\u0142y dzia\u0142alno\u015b\u0107 Twojej firmy, podkre\u015blaj\u0105c jej etyczne praktyki.",negative_media_coverage:"Krytyczny artyku\u0142 w mediach rzuci\u0142 cie\u0144 na reputacj\u0119 Twojej firmy.",successful_audit:"Twoja firma przesz\u0142a audyt z wyr\xf3\u017cnieniem, potwierdzaj\u0105c zgodno\u015b\u0107 z przepisami.",innovation_breakthrough:"Tw\xf3j zesp\xf3\u0142 opracowa\u0142 innowacyjne rozwi\u0105zanie, kt\xf3re zosta\u0142o docenione przez bran\u017c\u0119.",staff_incident:"Incydent z udzia\u0142em pracownika Twojej firmy wywo\u0142a\u0142 negatywne komentarze."}[e]||"Nieznane zdarzenie wp\u0142yn\u0119\u0142o na reputacj\u0119 Twojej firmy."}generateReputationReport(){const{reputation:e,reputationFactors:t,reputationHistory:n}=this.playerState,r=n.filter((e=>e.turn>=this.gameState.turn-10)).map((e=>({turn:e.turn,reason:e.reason,change:e.change,type:e.type,factor:e.factor}))),i=Object.entries(t);i.sort(((e,t)=>t[1]-e[1]));const a=i.slice(0,2).map((e=>{let[t,n]=e;return{factor:t,value:n}}));i.sort(((e,t)=>e[1]-t[1]));const s=i.slice(0,2).map((e=>{let[t,n]=e;return{factor:t,value:n}})),o=this.calculateReputationTrend(n),l=this.generateRecommendations(e,t,s.map((e=>e.factor)));return{currentReputation:e,category:this.getReputationCategory(e),trend:o,factors:t,strongestFactors:a,weakestFactors:s,recentChanges:r,recommendations:l,modifiers:this.getReputationModifiers()}}generateRecommendations(e,t,n){const r=[];return e<50&&r.push({text:"Rozwa\u017c przeprowadzenie kompleksowej kampanii naprawczej reputacji.",priority:"high"}),e<80&&e>=50&&r.push({text:"Zwi\u0119ksz przejrzysto\u015b\u0107 komunikacji z interesariuszami.",priority:"medium"}),n.forEach((e=>{const n=t[e];if(n<.7){const t={legalCompliance:"Zainwestuj w program zgodno\u015bci prawnej i szkolenia dla pracownik\xf3w.",environmentalImpact:"Zainwestuj w inicjatywy \u015brodowiskowe i ulepsz standardy projektowe.",communityRelations:"Nawi\u0105\u017c dialog ze spo\u0142eczno\u015bciami lokalnymi i wspieraj lokalne inicjatywy.",projectQuality:"Wprowad\u017a rygorystyczne kontrole jako\u015bci i zainwestuj w szkolenia zespo\u0142u.",transparency:"Zwi\u0119ksz przejrzysto\u015b\u0107 dzia\u0142a\u0144 firmy i komunikacj\u0119 z interesariuszami.",grayAreaActivity:"Przeprowad\u017a wewn\u0119trzny audyt i wyeliminuj praktyki z szarej strefy."};t.push({text:t[e]||`Popraw czynnik: ${e}`,priority:"high",factor:e})}else if(n<1){const t={legalCompliance:"Regularnie przegl\u0105daj zgodno\u015b\u0107 z przepisami i wytycznymi bran\u017cowymi.",environmentalImpact:"Monitoruj wp\u0142yw projekt\xf3w na \u015brodowisko i wprowadzaj ulepszenia.",communityRelations:"Organizuj regularne konsultacje spo\u0142eczne i wydarzenia dla spo\u0142eczno\u015bci.",projectQuality:"Zbieraj i analizuj feedback dotycz\u0105cy jako\u015bci projekt\xf3w.",transparency:"Publikuj regularne raporty z dzia\u0142alno\u015bci firmy.",grayAreaActivity:"Wprowad\u017a program etyczny i mechanizmy zg\u0142aszania nieprawid\u0142owo\u015bci."};t.push({text:t[e]||`Popraw czynnik: ${e}`,priority:"medium",factor:e})}})),t.grayAreaActivity>=1.3&&r.push({text:"Uwaga! Wysoki poziom aktywno\u015bci w szarej strefie zwi\u0119ksza ryzyko audytu!",priority:"critical",factor:"grayAreaActivity"}),r}}class ay{constructor(e,t,n){this.playerState=e,this.playerDispatch=t,this.gameState=n}calculateAuditRisk(){const{illegals:e,reputationFactors:t}=this.playerState,n=e.auditRisk,r=.2*e.corruptionNetwork,i=40*(t.grayAreaActivity-1),a=3*e.illegalActionHistory.filter((e=>e.turn>this.gameState.turn-10)).length;return Math.min(95,Math.max(5,n-r+i+a))}executeIllegalAction(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{cost:n=0,target:r=null,riskIncrease:i=5}=t;if(this.playerState.cash<n)return{success:!1,reason:"Niewystarczaj\u0105ca ilo\u015b\u0107 got\xf3wki"};this.playerDispatch({type:"ADD_ILLEGAL_ACTION",payload:{type:e,target:r,cost:n,turn:this.gameState.turn,exposed:!1}}),this.playerDispatch({type:"UPDATE_ILLEGALS_STATUS",payload:{auditRisk:Math.min(100,this.playerState.illegals.auditRisk+i)}}),this.updateReputationForIllegalAction(e,t);const a=this.calculateDetectionRisk(e);return 100*Math.random()<a?(this.handleDetection(e,t),{success:!0,detected:!0,consequences:"Dzia\u0142anie zosta\u0142o wykryte, co mia\u0142o negatywny wp\u0142yw na reputacj\u0119 firmy."}):{success:!0,detected:!1}}updateReputationForIllegalAction(e,t){const n={bribe_official:{transparency:-.05,legalCompliance:-.1,grayAreaActivity:.08},falsify_documents:{transparency:-.08,legalCompliance:-.15,grayAreaActivity:.1},intimidate_opposition:{communityRelations:-.12,transparency:-.07,grayAreaActivity:.12},create_illegal_database:{transparency:-.1,legalCompliance:-.15,grayAreaActivity:.2},build_corruption_network:{transparency:-.15,legalCompliance:-.2,grayAreaActivity:.25},buy_land_illegally:{legalCompliance:-.12,grayAreaActivity:.15}}[e]||{};for(const[r,i]of Object.entries(n))this.playerDispatch({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:r,change:i,reason:`Nielegalne dzia\u0142anie: ${this.getActionName(e)}`,turn:this.gameState.turn}});this.playerDispatch({type:"UPDATE_REPUTATION",payload:{change:-5,reason:`Nielegalne dzia\u0142anie: ${this.getActionName(e)}`,turn:this.gameState.turn}})}calculateDetectionRisk(e){const{illegals:t,reputationFactors:n}=this.playerState,r={bribe_official:15,falsify_documents:20,intimidate_opposition:25,create_illegal_database:10,build_corruption_network:15,buy_land_illegally:30}[e]||20,i=.15*t.corruptionNetwork,a=10*n.transparency;return Math.min(90,Math.max(5,r-i+a))}handleDetection(e,t){this.playerDispatch({type:"UPDATE_REPUTATION",payload:{change:-15,reason:`Wykryto nielegalne dzia\u0142anie: ${this.getActionName(e)}`,turn:this.gameState.turn}}),this.playerDispatch({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:"transparency",change:-.2,reason:`Wykryto nielegalne dzia\u0142anie: ${this.getActionName(e)}`,turn:this.gameState.turn}}),this.playerDispatch({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:"legalCompliance",change:-.25,reason:`Wykryto nielegalne dzia\u0142anie: ${this.getActionName(e)}`,turn:this.gameState.turn}});const n=this.playerState.illegals.illegalActionHistory.length-1;if(n>=0){const e=[...this.playerState.illegals.illegalActionHistory];e[n]={...e[n],exposed:!0},this.playerDispatch({type:"UPDATE_ILLEGALS_STATUS",payload:{illegalActionHistory:e,auditRisk:Math.min(100,this.playerState.illegals.auditRisk+20)}})}}conductAudit(){const{illegals:e,reputationFactors:t}=this.playerState;let n=30;n-=.3*e.corruptionNetwork,n+=20*t.grayAreaActivity;const r=e.illegalActionHistory.filter((e=>e.turn>this.gameState.turn-20)).length;n+=5*r;const i=100*Math.random()<n;let a=0,s=0;return i&&(a=5e5,a+=25e4*r,a*=1-e.corruptionNetwork/200,s=15+2*r,this.playerDispatch({type:"UPDATE_REPUTATION",payload:{change:-s,reason:"Nieprawid\u0142owo\u015bci wykryte podczas audytu",turn:this.gameState.turn}}),this.playerDispatch({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:"legalCompliance",change:-.15,reason:"Nieprawid\u0142owo\u015bci wykryte podczas audytu",turn:this.gameState.turn}}),this.playerDispatch({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:"transparency",change:-.1,reason:"Nieprawid\u0142owo\u015bci wykryte podczas audytu",turn:this.gameState.turn}})),this.playerDispatch({type:"TRIGGER_AUDIT",payload:{passed:!i,fine:a,reputationLoss:s,turn:this.gameState.turn,riskReduction:20}}),{passed:!i,fine:a,reputationLoss:s}}getActionName(e){return{bribe_official:"Przekupienie urz\u0119dnika",falsify_documents:"Fa\u0142szowanie dokument\xf3w",intimidate_opposition:"Zastraszanie opozycji",create_illegal_database:"Stworzenie nielegalnej bazy danych",build_corruption_network:"Budowa sieci korupcyjnej",buy_land_illegally:"Nielegalne nabycie grunt\xf3w"}[e]||e}getGrayAreaStatus(){const{illegals:e,reputationFactors:t}=this.playerState;return{auditRisk:this.calculateAuditRisk(),corruptionNetwork:e.corruptionNetwork,grayAreaActivity:t.grayAreaActivity,recentIllegalActions:e.illegalActionHistory.filter((e=>e.turn>this.gameState.turn-10)).length,lastAuditTurn:e.lastAuditTurn,turnsSinceLastAudit:this.gameState.turn-e.lastAuditTurn,hasIllegalDatabase:e.hasIllegalDatabase}}}class sy{constructor(e,t,n,r){this.playerState=e,this.playerDispatch=t,this.gameState=n,this.reputationManager=r}calculateMaxCreditLimit(){const{cash:e,economicMetrics:t,reputation:n,projects:r}=this.playerState;let i=1;i=n>=150?1.5:n>=100?1.2:n>=50?1:n>=25?.7:.5;const a=(2*e+.75*r.reduce(((e,t)=>e+(t.marketValue||0)),0))*i,s=Math.min(5e7+this.gameState.turn/30*5e7,5e8);return Math.min(a,s)}calculateInterestRate(e,t){var n;const r=this.reputationManager.getReputationModifiers().loanInterestRate,i=(null===(n=this.gameState.economyState)||void 0===n?void 0:n.baseInterestRate)||3;let a=0;t<=12?a=-.5:t>=36&&(a=1);let s=0;e<=1e6?s=.5:e>=1e7&&(s=-.5);const o=this.getTotalOutstandingLoans(),l=(i+a+s+Math.min(2,o/1e7))*r;return Math.max(1.5,Math.min(12,l))}getTotalOutstandingLoans(){const{loans:e}=this.playerState;return e&&0!==e.length?e.reduce(((e,t)=>t.remainingAmount?e+t.remainingAmount:e),0):0}calculateMonthlyPayment(e,t,n){const r=t/100/12;return e*r*Math.pow(1+r,n)/(Math.pow(1+r,n)-1)}applyForLoan(e,t,n){const r=this.calculateMaxCreditLimit();if(e>r)return{success:!1,reason:`Przekroczono limit kredytowy ${r.toLocaleString()} PLN`};const i=this.calculateInterestRate(e,t),a=this.calculateMonthlyPayment(e,i,t),s=this.generateLoanSchedule(e,i,t),o=`loan_${Date.now()}`;return this.playerDispatch({type:"ADD_LOAN",payload:{id:o,amount:e,interestRate:i,durationMonths:t,monthlyPayment:a,remainingAmount:e,remainingPayments:t,startDate:(new Date).toISOString(),purpose:n,schedule:s,status:"active"}}),{success:!0,loanId:o,amount:e,interestRate:i,monthlyPayment:a,durationMonths:t}}generateLoanSchedule(e,t,n){const r=t/100/12,i=this.calculateMonthlyPayment(e,t,n);let a=e;const s=[];for(let o=1;o<=n;o++){const e=a*r,t=i-e;a-=t,s.push({paymentNumber:o,date:this.addMonths(new Date,o),payment:i,principal:t,interest:e,remainingPrincipal:Math.max(0,a),paid:!1})}return s}processMonthlyPayments(){const{loans:e,cash:t}=this.playerState;if(!e||0===e.length)return{success:!0,message:"Brak aktywnych kredyt\xf3w"};let n=0;const r=[],i=[];for(const a of e)"active"===a.status&&(n+=a.monthlyPayment);if(t<n)return{success:!1,message:`Niewystarczaj\u0105ce \u015brodki na sp\u0142at\u0119 rat kredyt\xf3w (${n.toLocaleString()} PLN)`,shortfall:n-t};this.playerDispatch({type:"UPDATE_CASH",payload:-n});for(const a of e){if("active"!==a.status)continue;const e=a.remainingPayments-1,t=a.schedule[a.durationMonths-a.remainingPayments];if(t){const n=[...a.schedule];n[a.durationMonths-a.remainingPayments]={...t,paid:!0,paidDate:(new Date).toISOString()};const s={...a,remainingPayments:e,remainingAmount:a.remainingAmount-t.principal,schedule:n,status:0===e?"completed":"active"};this.playerDispatch({type:"UPDATE_LOAN",payload:{id:a.id,changes:s}}),0===e?i.push(a.id):r.push(a.id)}}return{success:!0,message:`Dokonano sp\u0142aty rat na \u0142\u0105czn\u0105 kwot\u0119 ${n.toLocaleString()} PLN`,updatedLoans:r,completedLoans:i}}makeLoanPrepayment(e,t){const{loans:n,cash:r}=this.playerState,i=n.find((t=>t.id===e));if(!i)return{success:!1,message:"Nie znaleziono kredytu"};if("active"!==i.status)return{success:!1,message:`Kredyt ma status ${i.status} i nie mo\u017ce by\u0107 sp\u0142acony`};if(r<t)return{success:!1,message:`Niewystarczaj\u0105ce \u015brodki (${t.toLocaleString()} PLN)`};t>i.remainingAmount&&(t=i.remainingAmount),this.playerDispatch({type:"UPDATE_CASH",payload:-t});const a=i.remainingAmount-t;if(a<=0)return this.playerDispatch({type:"UPDATE_LOAN",payload:{id:e,changes:{remainingAmount:0,remainingPayments:0,status:"completed"}}}),{success:!0,message:"Kredyt zosta\u0142 ca\u0142kowicie sp\u0142acony",fullyPaid:!0};{const n=this.recalculateLoanSchedule(a,i.interestRate,i.remainingPayments),r=n.length>0?n[0].payment:0;return this.playerDispatch({type:"UPDATE_LOAN",payload:{id:e,changes:{remainingAmount:a,monthlyPayment:r,schedule:this.mergeSchedule(i.schedule,n,i.durationMonths-i.remainingPayments)}}}),{success:!0,message:`Dokonano przedp\u0142aty w kwocie ${t.toLocaleString()} PLN`,newRemainingAmount:a,newMonthlyPayment:r}}}recalculateLoanSchedule(e,t,n){const r=t/100/12,i=this.calculateMonthlyPayment(e,t,n);let a=e;const s=[];for(let o=1;o<=n;o++){const e=a*r,t=i-e;a-=t,s.push({paymentNumber:o,date:this.addMonths(new Date,o),payment:i,principal:t,interest:e,remainingPrincipal:Math.max(0,a),paid:!1})}return s}mergeSchedule(e,t,n){const r=[...e];for(let i=0;i<n;i++)r[i]&&(r[i].paid=!0);for(let i=0;i<t.length;i++){const e=i+n;e<r.length&&(r[e]={...r[e],payment:t[i].payment,principal:t[i].principal,interest:t[i].interest,remainingPrincipal:t[i].remainingPrincipal})}return r}getLoanOffers(){const e=this.calculateMaxCreditLimit(),{reputation:t}=this.playerState,n=[{name:"Kredyt kr\xf3tkoterminowy",description:"Kredyt na pokrycie bie\u017c\u0105cych potrzeb firmy",durationMonths:12,maxAmount:Math.min(e,1e7),interestRate:this.calculateInterestRate(5e6,12),type:"standard"},{name:"Kredyt \u015brednioterminowy",description:"Kredyt na rozw\xf3j i inwestycje \u015bredniej wielko\u015bci",durationMonths:24,maxAmount:Math.min(e,2e7),interestRate:this.calculateInterestRate(1e7,24),type:"standard"},{name:"Kredyt d\u0142ugoterminowy",description:"Kredyt na du\u017ce projekty inwestycyjne",durationMonths:36,maxAmount:Math.min(e,5e7),interestRate:this.calculateInterestRate(25e6,36),type:"standard"}];let r=[];t>=120&&r.push({name:"Kredyt preferencyjny",description:"Specjalna oferta dla firm o wyj\u0105tkowej reputacji",durationMonths:60,maxAmount:Math.min(e,1e8),interestRate:.9*this.calculateInterestRate(5e7,60),type:"special"}),t>=150&&r.push({name:"Finansowanie strategiczne",description:"Ekskluzywna oferta dla lider\xf3w rynku",durationMonths:120,maxAmount:Math.min(e,2e8),interestRate:.85*this.calculateInterestRate(1e8,120),type:"premium"});let i=[];return this.playerState.reputationFactors.environmentalImpact>=1.3&&i.push({name:"Zielone finansowanie",description:"Preferencyjny kredyt na projekty z pozytywnym wp\u0142ywem \u015brodowiskowym",durationMonths:48,maxAmount:Math.min(e,8e7),interestRate:.8*this.calculateInterestRate(4e7,48),type:"green",requirements:"Tylko na projekty ekologiczne z certyfikatem"}),[...n,...r,...i]}addMonths(e,t){const n=new Date(e);return n.setMonth(n.getMonth()+t),n.toISOString()}}const oy=()=>{const{state:e,dispatch:t}=d(),{state:n}=mf(),i=(0,r.useMemo)((()=>new iy(e,t,n)),[e,t,n]),a=(0,r.useMemo)((()=>new ay(e,t,n)),[e,t,n]),s=(0,r.useMemo)((()=>new sy(e,t,n,i)),[e,t,n,i]);return{reputationManager:i,grayAreaManager:a,bankingSystem:s}},ly=Lf("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]),cy=Lf("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),dy=Lf("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),uy=Lf("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),hy=Lf("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),py=Lf("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),my=e=>{let{children:t,variant:n="primary",size:r="medium",onClick:i,className:s="",disabled:o=!1,...l}=e;return(0,a.jsx)("button",{className:`${{primary:"bg-blue-700 hover:bg-blue-800 text-white",success:"bg-green-500 hover:bg-green-600 text-white",danger:"bg-red-500 hover:bg-red-600 text-white",warning:"bg-yellow-500 hover:bg-yellow-600 text-black",info:"bg-blue-500 hover:bg-blue-600 text-white",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-800"}[n]} ${{small:"px-2 py-1 text-xs",medium:"px-3 py-1",large:"px-4 py-2 text-lg"}[r]} rounded font-medium transition-colors ${o?"opacity-50 cursor-not-allowed":""} ${s}`,onClick:i,disabled:o,...l,children:t})},fy=e=>{let{onClose:t}=e;const{state:n}=d(),{state:i}=mf(),{reputationManager:s}=oy(),[o,l]=(0,r.useState)(null),[c,u]=(0,r.useState)("overview");(0,r.useEffect)((()=>{s&&l(s.generateReputationReport())}),[n.reputation,n.reputationFactors,s]);const h=e=>"rising"===e?(0,a.jsx)(ny,{className:"w-5 h-5 text-green-500"}):"falling"===e?(0,a.jsx)(ry,{className:"w-5 h-5 text-red-500"}):(0,a.jsx)(ty,{className:"w-5 h-5 text-gray-500"}),p=e=>({legalCompliance:(0,a.jsx)(ey,{className:"w-5 h-5 text-blue-500"}),environmentalImpact:(0,a.jsx)(ly,{className:"w-5 h-5 text-green-500"}),communityRelations:(0,a.jsx)(Kf,{className:"w-5 h-5 text-purple-500"}),projectQuality:(0,a.jsx)(cy,{className:"w-5 h-5 text-yellow-500"}),transparency:(0,a.jsx)(dy,{className:"w-5 h-5 text-cyan-500"}),grayAreaActivity:(0,a.jsx)(uy,{className:"w-5 h-5 text-gray-500"})}[e]||(0,a.jsx)(Hf,{className:"w-5 h-5 text-gray-500"})),m=e=>({legalCompliance:"Zgodno\u015b\u0107 z prawem",environmentalImpact:"Wp\u0142yw na \u015brodowisko",communityRelations:"Relacje ze spo\u0142eczno\u015bci\u0105",projectQuality:"Jako\u015b\u0107 projekt\xf3w",transparency:"Przejrzysto\u015b\u0107",grayAreaActivity:"Aktywno\u015b\u0107 w szarej strefie"}[e]||e),f=(e,t)=>"grayAreaActivity"===e?t<=.7?"text-green-600 font-medium":t<=1?"text-blue-600":t<=1.3?"text-yellow-600":"text-red-600":t>=1.5?"text-green-600 font-medium":t>=1?"text-blue-600":t>=.7?"text-yellow-600":"text-red-600",y=(e,t)=>"grayAreaActivity"===e?t<=.7?"bg-green-500":t<=1?"bg-blue-500":t<=1.3?"bg-yellow-500":"bg-red-500":t>=1.5?"bg-green-500":t>=1?"bg-blue-500":t>=.7?"bg-yellow-500":"bg-red-500",g=e=>({projectCost:"Koszt projekt\xf3w",constructionSpeed:"Szybko\u015b\u0107 budowy",projectQuality:"Jako\u015b\u0107 projekt\xf3w",staffRecruitmentCost:"Koszt rekrutacji",loanInterestRate:"Oprocentowanie kredyt\xf3w",projectSalePrice:"Cena sprzeda\u017cy projekt\xf3w",auditFrequency:"Cz\u0119stotliwo\u015b\u0107 audyt\xf3w",stakeholderTrust:"Zaufanie interesariuszy"}[e]||e),v=(e,t)=>{const n=["projectCost","loanInterestRate","staffRecruitmentCost","auditFrequency"].includes(e),r=t-1,i=Math.abs(100*r).toFixed(0);return 0===r?(0,a.jsx)("span",{className:"text-gray-600",children:"Neutralny"}):n?r<0?(0,a.jsxs)("span",{className:"text-green-600",children:["-",i,"%"]}):(0,a.jsxs)("span",{className:"text-red-600",children:["+",i,"%"]}):r>0?(0,a.jsxs)("span",{className:"text-green-600",children:["+",i,"%"]}):(0,a.jsxs)("span",{className:"text-red-600",children:["-",i,"%"]})};return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Reputacja Firmy"}),(0,a.jsx)(my,{onClick:t,variant:"secondary",size:"sm",children:"Zamknij"})]}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("div",{className:"flex border-b",children:[(0,a.jsx)("button",{className:"px-4 py-2 font-medium "+("overview"===c?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),onClick:()=>u("overview"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(Gf,{className:"w-4 h-4 mr-1"}),(0,a.jsx)("span",{children:"Przegl\u0105d"})]})}),(0,a.jsx)("button",{className:"px-4 py-2 font-medium "+("modifiers"===c?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),onClick:()=>u("modifiers"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(hy,{className:"w-4 h-4 mr-1"}),(0,a.jsx)("span",{children:"Modyfikatory"})]})}),(0,a.jsx)("button",{className:"px-4 py-2 font-medium "+("history"===c?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),onClick:()=>u("history"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(py,{className:"w-4 h-4 mr-1"}),(0,a.jsx)("span",{children:"Historia"})]})})]})}),(0,a.jsxs)("div",{children:["overview"===c&&(()=>{if(!o)return(0,a.jsx)("div",{children:"\u0141adowanie danych..."});const{currentReputation:e,category:t,trend:n,factors:r}=o,i=(s=e)>=150?{label:"Doskona\u0142a",color:"text-green-600"}:s>=100?{label:"Dobra",color:"text-blue-600"}:s>=50?{label:"Przeci\u0119tna",color:"text-yellow-600"}:s>=25?{label:"S\u0142aba",color:"text-orange-600"}:{label:"Bardzo s\u0142aba",color:"text-red-600"};var s;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-medium mb-2 text-blue-700",children:"Reputacja Firmy"}),(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("div",{className:"w-full h-4 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full "+(e>=150?"bg-green-500":e>=100?"bg-blue-500":e>=50?"bg-yellow-500":e>=25?"bg-orange-500":"bg-red-500"),style:{width:`${Math.min(100,e/2)}%`}})}),(0,a.jsx)("span",{className:"ml-3 font-medium",children:e})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:`${i.color} font-medium`,children:i.label}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-sm mr-1",children:"Trend:"}),h(n)]})]})]}),(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Czynniki Reputacji"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:Object.entries(r).map((e=>{let[t,n]=e;return(0,a.jsxs)("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center mb-1",children:[p(t),(0,a.jsx)("span",{className:"ml-2 font-medium",children:m(t)})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Warto\u015b\u0107:"}),(0,a.jsxs)("span",{className:f(t,n),children:[(100*n).toFixed(0),"%"]})]}),(0,a.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:y(t,n),style:{width:`${Math.min(100,50*n)}%`}})})]},t)}))}),(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Rekomendacje"}),(0,a.jsx)("div",{className:"space-y-2 mb-6",children:o.recommendations.length>0?o.recommendations.map(((e,t)=>{return(0,a.jsx)("div",{className:"bg-white p-3 rounded-lg shadow-sm border-l-4 border-yellow-500",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(n=e.priority,"critical"===n?(0,a.jsx)(Hf,{className:"w-5 h-5 text-red-500"}):"high"===n?(0,a.jsx)(Hf,{className:"w-5 h-5 text-orange-500"}):"medium"===n?(0,a.jsx)(Hf,{className:"w-5 h-5 text-yellow-500"}):(0,a.jsx)(Hf,{className:"w-5 h-5 text-blue-500"})),(0,a.jsxs)("div",{className:"ml-2",children:[(0,a.jsx)("p",{className:"text-sm",children:e.text}),e.factor&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Dotyczy: ",m(e.factor)]})]})]})},t);var n})):(0,a.jsxs)("div",{className:"text-center py-4 text-gray-500",children:[(0,a.jsx)(hy,{className:"h-12 w-12 mx-auto mb-2 text-green-300"}),(0,a.jsx)("p",{children:"Brak rekomendacji - Twoja reputacja jest w doskona\u0142ym stanie!"})]})})]})})(),"modifiers"===c&&(()=>{if(!o)return(0,a.jsx)("div",{children:"\u0141adowanie danych..."});const{modifiers:e}=o;return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:(0,a.jsx)("p",{className:"text-sm text-blue-800",children:"Modyfikatory pokazuj\u0105, jak Twoja reputacja wp\u0142ywa na r\xf3\u017cne aspekty gry. Warto\u015b\u0107 100% oznacza brak wp\u0142ywu, warto\u015bci ni\u017csze lub wy\u017csze oznaczaj\u0105 odpowiednio negatywny lub pozytywny wp\u0142yw."})}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(e).map((e=>{let[t,n]=e;return(0,a.jsxs)("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("span",{className:"font-medium",children:g(t)}),v(t,n)]}),(0,a.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:n<1?"bg-green-500":n>1?"bg-red-500":"bg-blue-500",style:{width:`${Math.min(100,50*n)}%`}})}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:n<1?`${Math.abs(100*(n-1)).toFixed(0)}% ni\u017csze koszty/czasy`:n>1?`${(100*(n-1)).toFixed(0)}% wy\u017csze koszty/czasy`:"Neutralny wp\u0142yw"})]},t)}))})]})})(),"history"===c&&(()=>{if(!n.reputationHistory||0===n.reputationHistory.length)return(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(py,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Brak historii zmian reputacji"})]});const e=[...n.reputationHistory].reverse().slice(0,20);return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:(0,a.jsx)("p",{className:"text-sm text-blue-800",children:"Historia ostatnich 20 zmian reputacji Twojej firmy."})}),(0,a.jsx)("div",{className:"space-y-2",children:e.map(((e,t)=>(0,a.jsxs)("div",{className:"bg-white p-3 rounded-lg shadow-sm border-l-4 border-blue-500",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,a.jsx)("span",{className:"font-medium",children:"factor_change"===e.type?`Zmiana czynnika: ${m(e.factor)}`:"Zmiana reputacji"}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["Tura ",e.turn]})]}),(0,a.jsx)("p",{className:"text-sm",children:e.reason}),(0,a.jsxs)("div",{className:"flex items-center mt-1",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 mr-2",children:"Zmiana:"}),(0,a.jsxs)("span",{className:e.change>0?"text-green-600":e.change<0?"text-red-600":"text-gray-600",children:[e.change>0?"+":"","factor_change"===e.type?`${(100*e.change).toFixed(0)}%`:e.change]})]})]},t)))})]})})()]})]})},yy=Lf("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),gy=Lf("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),vy=Lf("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),wy=Lf("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),xy=Lf("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),by=Lf("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),jy={INDUSTRY_CONFERENCE:{type:"conference",name:"Udzia\u0142 w konferencji bran\u017cowej",description:"Aktywny udzia\u0142 w konferencji bran\u017cowej buduje wizerunek eksperta i lidera sektora OZE.",cost:5e4,duration:30,intensity:1,icon:(0,a.jsx)(hy,{className:"w-5 h-5 text-blue-500"}),immediateEffects:[{reputationChange:2,factor:"transparency"}],continuousEffects:[{reputationPerDay:.05,factor:"transparency"}],finalEffects:[{factorChange:"transparency",factorAmount:.05}]},SPEAKING_ENGAGEMENT:{type:"conference",name:"Wyst\u0105pienie na konferencji jako ekspert",description:"Prezentacja Twojej ekspertyzy na presti\u017cowej konferencji znacz\u0105co podnosi reputacj\u0119 firmy.",cost:1e5,duration:60,intensity:2,icon:(0,a.jsx)(yy,{className:"w-5 h-5 text-indigo-500"}),immediateEffects:[{reputationChange:5,factor:"transparency"}],continuousEffects:[{reputationPerDay:.1,factor:"transparency"}],finalEffects:[{factorChange:"transparency",factorAmount:.1}]},ENVIRONMENTAL_NGO_PARTNERSHIP:{type:"ngo_partnership",name:"Partnerstwo z organizacj\u0105 ekologiczn\u0105",description:"D\u0142ugoterminowe partnerstwo z uznan\u0105 organizacj\u0105 ekologiczn\u0105 uwiarygadnia Twoje zaanga\u017cowanie w ochron\u0119 \u015brodowiska.",cost:2e5,duration:365,intensity:2,icon:(0,a.jsx)(ly,{className:"w-5 h-5 text-green-500"}),immediateEffects:[{reputationChange:3,factor:"environmentalImpact"}],continuousEffects:[{reputationPerDay:.03,factor:"environmentalImpact"},{factorChange:"environmentalImpact",factorPerDay:2e-4}],finalEffects:[{reputationChange:5,factor:"environmentalImpact"}]},COMMUNITY_FUND:{type:"ngo_partnership",name:"Fundusz wspierania spo\u0142eczno\u015bci lokalnych",description:"Utworzenie funduszu wspieraj\u0105cego inicjatywy spo\u0142eczno\u015bci lokalnych w regionach Twoich inwestycji OZE.",cost:5e5,duration:365,intensity:3,icon:(0,a.jsx)(Kf,{className:"w-5 h-5 text-purple-500"}),immediateEffects:[{reputationChange:7,factor:"communityRelations"}],continuousEffects:[{reputationPerDay:.04,factor:"communityRelations"},{factorChange:"communityRelations",factorPerDay:3e-4}],finalEffects:[{factorChange:"communityRelations",factorAmount:.15}]},PR_CAMPAIGN:{type:"media_campaign",name:"Kampania PR",description:"Profesjonalna kampania PR buduj\u0105ca pozytywny wizerunek Twojej firmy w mediach i opinii publicznej.",cost:3e5,duration:90,intensity:2,icon:(0,a.jsx)(gy,{className:"w-5 h-5 text-cyan-500"}),immediateEffects:[{reputationChange:4}],continuousEffects:[{reputationPerDay:.07}],finalEffects:[]},TRANSPARENCY_REPORT:{type:"media_campaign",name:"Raport transparentno\u015bci",description:"Publikacja szczeg\xf3\u0142owego raportu o dzia\u0142alno\u015bci Twojej firmy, wp\u0142ywie na \u015brodowisko i spo\u0142ecze\u0144stwo.",cost:15e4,duration:120,intensity:1,icon:(0,a.jsx)(dy,{className:"w-5 h-5 text-sky-500"}),immediateEffects:[{reputationChange:3,factor:"transparency"},{factorChange:"transparency",factorAmount:.1}],continuousEffects:[{reputationPerDay:.02,factor:"transparency"}],finalEffects:[{reputationChange:2,factor:"transparency"}]},LEGAL_COMPLIANCE_PROGRAM:{type:"legal_repair",name:"Program zgodno\u015bci prawnej",description:"Kompleksowy program naprawczy zapewniaj\u0105cy pe\u0142n\u0105 zgodno\u015b\u0107 z przepisami i najlepszymi praktykami bran\u017cowymi.",cost:4e5,duration:270,intensity:3,icon:(0,a.jsx)(ey,{className:"w-5 h-5 text-red-500"}),immediateEffects:[{factorChange:"grayAreaActivity",factorAmount:-.2}],continuousEffects:[{factorChange:"grayAreaActivity",factorPerDay:-.001},{factorChange:"legalCompliance",factorPerDay:5e-4}],finalEffects:[{reputationChange:8,factor:"legalCompliance"},{factorChange:"legalCompliance",factorAmount:.2}]},WHISTLEBLOWER_PROTECTION:{type:"legal_repair",name:"Program ochrony sygnalist\xf3w",description:"Wdro\u017cenie mechanizm\xf3w zg\u0142aszania nieprawid\u0142owo\u015bci i ochrony sygnalist\xf3w w Twojej firmie.",cost:15e4,duration:120,intensity:2,icon:(0,a.jsx)(uy,{className:"w-5 h-5 text-amber-500"}),immediateEffects:[{reputationChange:2,factor:"transparency"}],continuousEffects:[{factorChange:"grayAreaActivity",factorPerDay:-8e-4}],finalEffects:[{reputationChange:5,factor:"transparency"},{factorChange:"transparency",factorAmount:.1}]}},ky=e=>{var t;let{onClose:n}=e;const{state:i,dispatch:s}=d(),{state:o,showNotification:l}=mf(),[c,u]=(0,r.useState)(null),h=(0,r.useRef)(null),p=e=>{h.current&&!h.current.contains(e.target)&&n()};(0,r.useEffect)((()=>(document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p)})),[]);const m=Object.values(jy).reduce(((e,t)=>(e[t.type]||(e[t.type]=[]),e[t.type].push(t),e)),{}),f=e=>{const t=[];return e.immediateEffects&&e.immediateEffects.forEach((e=>{t.push({...e,type:"immediate"})})),e.continuousEffects&&e.continuousEffects.forEach((e=>{t.push({...e,type:"continuous"})})),e.finalEffects&&e.finalEffects.forEach((e=>{t.push({...e,type:"final"})})),(0,a.jsx)("div",{className:"grid gap-2",children:t.map(((e,t)=>(0,a.jsxs)("div",{className:"flex items-center border-b pb-2",children:[x(e),(0,a.jsxs)("div",{className:"ml-2",children:[(0,a.jsx)("div",{className:"text-sm font-medium",children:v(e)}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:w(e.type)})]})]},t)))})},y=e=>({conference:"Konferencje i wydarzenia",ngo_partnership:"Wsp\xf3\u0142praca z NGO",media_campaign:"Kampanie medialne",certification:"Certyfikacje i standardy",legal_repair:"Naprawy wizerunkowe"}[e]||e),g=e=>{switch(e){case 1:return"Niska";case 2:return"\u015arednia";case 3:return"Wysoka";default:return"Nieznana"}},v=e=>{if(e.reputationChange){return`Zmiana reputacji: ${e.reputationChange>0?"+":""}${e.reputationChange}`}if(e.reputationPerDay){return`Reputacja dziennie: ${e.reputationPerDay>0?"+":""}${e.reputationPerDay}`}if(e.factorChange){const t={legalCompliance:"Zgodno\u015b\u0107 z prawem",environmentalImpact:"Wp\u0142yw na \u015brodowisko",communityRelations:"Relacje ze spo\u0142eczno\u015bci\u0105",projectQuality:"Jako\u015b\u0107 projekt\xf3w",transparency:"Przejrzysto\u015b\u0107",grayAreaActivity:"Aktywno\u015b\u0107 w szarej strefie"}[e.factorChange]||e.factorChange;let n="";if(e.factorAmount){n=`${e.factorAmount>0?"+":""}${(100*e.factorAmount).toFixed(0)}%`}else if(e.factorPerDay){n=`${e.factorPerDay>0?"+":""}${(100*e.factorPerDay).toFixed(2)}% dziennie`}return`${t}: ${n}`}return"Nieznany efekt"},w=e=>{switch(e){case"immediate":return"Efekt natychmiastowy";case"continuous":return"Efekt ci\u0105g\u0142y";case"final":return"Efekt ko\u0144cowy";default:return""}},x=e=>{if(e.reputationChange||e.reputationPerDay){return e.reputationChange&&e.reputationChange>0||e.reputationPerDay&&e.reputationPerDay>0?(0,a.jsx)(wy,{className:"w-4 h-4 text-green-500"}):(0,a.jsx)(xy,{className:"w-4 h-4 text-red-500"})}if(e.factorChange){return{legalCompliance:(0,a.jsx)(ey,{className:"w-4 h-4 text-blue-500"}),environmentalImpact:(0,a.jsx)(ly,{className:"w-4 h-4 text-green-500"}),communityRelations:(0,a.jsx)(Kf,{className:"w-4 h-4 text-purple-500"}),projectQuality:(0,a.jsx)(cy,{className:"w-4 h-4 text-yellow-500"}),transparency:(0,a.jsx)(dy,{className:"w-4 h-4 text-cyan-500"}),grayAreaActivity:(0,a.jsx)(uy,{className:"w-4 h-4 text-gray-500"})}[e.factorChange]||(0,a.jsx)(by,{className:"w-4 h-4 text-gray-500"})}return(0,a.jsx)(by,{className:"w-4 h-4 text-gray-500"})},b=e=>({legalCompliance:"Zgodno\u015b\u0107 z prawem",environmentalImpact:"Wp\u0142yw na \u015brodowisko",communityRelations:"Relacje ze spo\u0142eczno\u015bci\u0105",projectQuality:"Jako\u015b\u0107 projekt\xf3w",transparency:"Przejrzysto\u015b\u0107",grayAreaActivity:"Aktywno\u015b\u0107 w szarej strefie"}[e]||e),j=e=>e>=1.5?"text-green-600 font-medium":e>=1?"text-blue-600":e>=.7?"text-yellow-600":"text-red-600",k=(e,t)=>"grayAreaActivity"===e?t<=.7?"bg-green-500":t<=1?"bg-blue-500":t<=1.3?"bg-yellow-500":"bg-red-500":t>=1.5?"bg-green-500":t>=1?"bg-blue-500":t>=.7?"bg-yellow-500":"bg-red-500",N=e=>{const t=Object.values(jy).find((t=>t.type===e.type&&t.name===e.name));return(null===t||void 0===t?void 0:t.icon)||(0,a.jsx)(by,{className:"w-5 h-5 text-gray-500"})};return(0,a.jsxs)("div",{ref:h,className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Inicjatywy Reputacyjne"}),(0,a.jsx)("button",{onClick:n,className:"p-2 rounded-full hover:bg-gray-100",children:(0,a.jsx)(vy,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-medium mb-2 text-blue-700",children:"Reputacja Firmy"}),(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("div",{className:"w-full h-4 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full "+(z=i.reputation,z>=150?"bg-green-500":z>=100?"bg-blue-500":z>=50?"bg-yellow-500":"bg-red-500"),style:{width:`${Math.min(100,i.reputation/2)}%`}})}),(0,a.jsx)("span",{className:"ml-3 font-medium",children:i.reputation})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:(e=>e>=150?"Doskona\u0142a reputacja - jeste\u015b liderem etycznym w bran\u017cy":e>=100?"Dobra reputacja - jeste\u015b szanowanym graczem na rynku":e>=50?"Przeci\u0119tna reputacja - masz neutralny wizerunek":e>=25?"S\u0142aba reputacja - budzisz pewne kontrowersje":"Bardzo s\u0142aba reputacja - jeste\u015b powszechnie krytykowany")(i.reputation)})]}),(0,a.jsx)("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(i.reputationFactors||{}).map((e=>{let[t,n]=e;return(0,a.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:b(t)}),(0,a.jsxs)("span",{className:j(n),children:[(100*n).toFixed(0),"%"]})]}),(0,a.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:k(t,n),style:{width:`${Math.min(100,50*n)}%`}})})]},t)}))}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Aktywne Inicjatywy"}),(null===(t=i.activeReputationInitiatives)||void 0===t?void 0:t.length)>0?(0,a.jsx)("div",{className:"grid gap-3",children:i.activeReputationInitiatives.map(((e,t)=>(0,a.jsx)("div",{className:"border rounded-lg p-3",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center overflow-hidden",children:[N(e),(0,a.jsxs)("div",{className:"ml-2 overflow-hidden",children:[(0,a.jsx)("div",{className:"font-medium text-ellipsis overflow-hidden",children:e.name}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 whitespace-nowrap",children:["Pozosta\u0142o: ",e.remainingDuration," dni"]})]})]}),(0,a.jsx)("div",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full whitespace-nowrap",children:g(e.intensity)})]})},t)))}):(0,a.jsxs)("div",{className:"text-center py-4 text-gray-500",children:[(0,a.jsx)(by,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),(0,a.jsx)("p",{children:"Brak aktywnych inicjatyw"})]})]}),(0,a.jsx)("h3",{className:"font-medium mb-3",children:"Dost\u0119pne Inicjatywy"}),Object.entries(m).map((e=>{let[t,n]=e;return((e,t)=>(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:y(e)}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((e=>(0,a.jsx)("div",{className:"border rounded-lg p-4 hover:border-blue-300 cursor-pointer",onClick:()=>u(e),children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"mr-3",children:e.icon}),(0,a.jsxs)("div",{className:"flex-grow overflow-hidden",children:[(0,a.jsx)("h4",{className:"font-medium text-ellipsis overflow-hidden",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 break-words",children:[e.description.substring(0,80),"..."]}),(0,a.jsxs)("div",{className:"mt-2 text-sm text-blue-600 whitespace-nowrap",children:["Koszt: ",e.cost.toLocaleString()," z\u0142"]})]})]})},e.name)))})]}))(t,n)})),c&&(c?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[c.icon,(0,a.jsx)("h2",{className:"text-xl font-semibold ml-3 break-words",children:c.name})]}),(0,a.jsx)("button",{className:"text-gray-400 hover:text-gray-600",onClick:()=>u(null),children:(0,a.jsx)(vy,{className:"w-6 h-6"})})]}),(0,a.jsx)("p",{className:"text-gray-700 mb-4 break-words",children:c.description}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Szczeg\xf3\u0142y:"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600 mr-2 whitespace-nowrap",children:"Koszt:"}),(0,a.jsxs)("span",{className:"font-medium whitespace-nowrap",children:[c.cost.toLocaleString()," z\u0142"]})]}),(0,a.jsxs)("div",{className:"flex items-center overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600 mr-2 whitespace-nowrap",children:"Czas trwania:"}),(0,a.jsxs)("span",{className:"font-medium whitespace-nowrap",children:[c.duration," dni"]})]}),(0,a.jsxs)("div",{className:"flex items-center overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600 mr-2 whitespace-nowrap",children:"Intensywno\u015b\u0107:"}),(0,a.jsx)("span",{className:"font-medium whitespace-nowrap",children:g(c.intensity)})]})]})]}),(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Efekty:"}),(0,a.jsx)("div",{className:"mb-4",children:f(c)}),(0,a.jsxs)("div",{className:"flex justify-end mt-6",children:[(0,a.jsx)("button",{className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md mr-3",onClick:()=>u(null),children:"Anuluj"}),(0,a.jsxs)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md "+(i.cash<c.cost?"opacity-50 cursor-not-allowed":""),onClick:()=>(e=>{if(i.cash<e.cost)l(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w (potrzeba ${e.cost.toLocaleString()} PLN)`,"error");else{if(s({type:"START_REPUTATION_INITIATIVE",payload:{initiative:e}}),e.immediateEffects)for(const t of e.immediateEffects)t.reputationChange&&s({type:"UPDATE_REPUTATION",payload:{change:t.reputationChange,reason:`Inicjatywa: ${e.name} (natychmiastowy efekt)`,turn:o.turn}}),t.factorChange&&t.factorAmount&&s({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:t.factorChange,change:t.factorAmount,reason:`Inicjatywa: ${e.name} (natychmiastowy efekt)`,turn:o.turn}});l(`Rozpocz\u0119to inicjatyw\u0119: ${e.name}`,"success"),u(null)}})(c),disabled:i.cash<c.cost,children:["Rozpocznij (",c.cost.toLocaleString()," z\u0142)"]})]})]})}):null)]});var z},Ny=()=>{const{state:e}=d(),[t,n]=(0,r.useState)(!1),[i,s]=(0,r.useState)(!1),o=e.activeReputationInitiatives&&e.activeReputationInitiatives.length>0,l=e.reputation<50||e.reputationFactors&&Object.values(e.reputationFactors).some((e=>e<.7));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center px-3 py-1.5 rounded-md cursor-pointer "+(c=e.reputation,c>=150?"bg-green-100":c>=100?"bg-blue-100":c>=50?"bg-yellow-100":c>=25?"bg-orange-100":"bg-red-100"),onClick:()=>n(!0),children:[(0,a.jsx)("div",{className:"mr-2",children:(e=>e>=100?(0,a.jsx)(ey,{className:"w-4 h-4"}):e>=50?(0,a.jsx)(ty,{className:"w-4 h-4"}):(0,a.jsx)(Hf,{className:"w-4 h-4"}))(e.reputation)}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:`font-medium ${(e=>e>=150?"text-green-600":e>=100?"text-blue-600":e>=50?"text-yellow-600":e>=25?"text-orange-600":"text-red-600")(e.reputation)}`,children:e.reputation}),(()=>{if(!e.reputationHistory||e.reputationHistory.length<5)return null;const t=e.reputationHistory.filter((e=>void 0!==e.change)).slice(-5).map((e=>e.change));if(0===t.length)return null;const n=t.reduce(((e,t)=>e+t),0);return n>5?(0,a.jsx)(ny,{className:"w-4 h-4 text-green-500"}):n<-5?(0,a.jsx)(ry,{className:"w-4 h-4 text-red-500"}):null})()]}),(0,a.jsx)("div",{className:"text-xs text-gray-600",children:(e=>e>=150?"Doskona\u0142a":e>=100?"Dobra":e>=50?"Przeci\u0119tna":e>=25?"S\u0142aba":"Bardzo s\u0142aba")(e.reputation)})]}),o&&(0,a.jsx)("div",{className:"ml-2 bg-blue-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center cursor-pointer",onClick:e=>{e.stopPropagation(),s(!0)},title:"Aktywne inicjatywy reputacyjne",children:e.activeReputationInitiatives.length}),l&&(0,a.jsx)("div",{className:"ml-2 text-red-500",title:"Problemy z reputacj\u0105",children:(0,a.jsx)(Hf,{className:"w-4 h-4"})})]}),t&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsx)(fy,{onClose:()=>n(!1)})})}),i&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsx)(ky,{onClose:()=>s(!1)})})})]});var c},zy=(0,r.memo)((e=>{let{icon:t,screenName:n,label:r,currentScreen:i,onClick:s}=e;const o=i===n;return(0,a.jsxs)("button",{onClick:s,className:"nav-button flex items-center px-3 py-1 rounded text-white "+(o?"active":""),children:[(0,a.jsx)("span",{className:"mr-1",children:t})," ",r]})})),_y=(0,r.memo)((e=>{let{currentDay:t,gameSpeed:n}=e;return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center mr-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(Ff,{size:18,className:"mr-1"}),(0,a.jsxs)("span",{className:"font-medium",children:["Dzie\u0144 ",t]})]}),n>1&&(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)(Uf,{size:16,className:"mr-1"}),(0,a.jsxs)("span",{className:`\n            ${3===n?"text-yellow-300":""}\n            ${5===n?"text-orange-300":""}\n            ${10===n?"text-red-300":""}\n            font-semibold\n          `,children:["Pr\u0119dko\u015b\u0107 x",n]})]})]})})),Ey=(0,r.memo)((e=>{let{cash:t,installedCapacity:n,reputation:r}=e;return(0,a.jsxs)("div",{className:"stats-container flex space-x-6",children:[(0,a.jsxs)("div",{className:"stat flex items-center",children:[(0,a.jsx)(Vf,{size:18,className:"mr-1 text-green-400"}),(0,a.jsxs)("span",{children:[(s=t,void 0===s||null===s||isNaN(s)?"0.00":s>=1e9?`${(s/1e9).toFixed(2)} mld`:s>=1e6?`${(s/1e6).toFixed(2)} mln`:s>=1e3?`${(s/1e3).toFixed(2)} tys.`:`${s.toFixed(2)}`)," PLN"]})]}),(0,a.jsxs)("div",{className:"stat flex items-center",children:[(0,a.jsx)(Bf,{size:18,className:"mr-1 text-yellow-400"}),(0,a.jsxs)("span",{children:[(i=n,void 0===i||null===i||isNaN(i)?"0.00":(i/1e3).toFixed(2))," GW"]})]}),(0,a.jsx)("div",{className:"stat flex items-center",children:(0,a.jsx)(Ny,{value:r,showValue:!0})})]});var i,s})),Sy=e=>{let{children:t}=e;const{state:n,dispatch:i,nextDay:s}=mf(),{state:o,dispatch:l}=d(),{state:c}=q(),u=(0,r.useCallback)((e=>(e.preventDefault(),e.returnValue="Czy na pewno chcesz opu\u015bci\u0107 gr\u0119? Niezapisane zmiany mog\u0105 zosta\u0107 utracone.",e.returnValue)),[]),h=(0,r.useCallback)((e=>{e.preventDefault(),history.pushState(null,document.title,window.location.href),n.selectedProject?i({type:"SELECT_PROJECT",payload:null}):n.selectedRegion?i({type:"SELECT_REGION",payload:null}):n.selectedCounty&&i({type:"SELECT_COUNTY",payload:null})}),[n.selectedProject,n.selectedRegion,n.selectedCounty,i]);(0,r.useEffect)((()=>(window.addEventListener("popstate",h),window.addEventListener("beforeunload",u),history.pushState(null,document.title,window.location.href),()=>{window.removeEventListener("popstate",h),window.removeEventListener("beforeunload",u)})),[h,u]);const p=(0,r.useCallback)((()=>{var e;const t=null===c||void 0===c||null===(e=c.events)||void 0===e?void 0:e.filter((e=>e&&!0===e.requiresDecision&&!0!==e.decided));t&&t.length>0?i({type:"SET_NOTIFICATION",payload:{text:"Musisz rozwi\u0105za\u0107 wszystkie oczekuj\u0105ce decyzje przed przej\u015bciem do nast\u0119pnego dnia!",type:"warning"}}):(s(o,l),window.dispatchEvent(new CustomEvent("next-game-day")),n.selectedProject&&i({type:"SELECT_PROJECT",payload:null}),n.selectedRegion&&i({type:"SELECT_REGION",payload:null}),n.selectedCounty&&i({type:"SELECT_COUNTY",payload:null}))}),[n,i,s,o,l,c]),m=(0,r.useCallback)((e=>{i({type:"SET_GAME_SPEED",payload:e});i({type:"SET_NOTIFICATION",payload:{text:`Ustawiono ${{1:"normaln\u0105",3:"przyspieszon\u0105 (x3)",5:"szybk\u0105 (x5)",10:"bardzo szybk\u0105 (x10)"}[e]} pr\u0119dko\u015b\u0107 up\u0142ywu czasu.`,type:"info"}})}),[i]),f=(0,r.useCallback)((()=>{i({type:"SET_APP_VIEW",payload:"leaderboard"})}),[i]),y=(0,r.useCallback)((()=>{"function"===typeof window.saveGameFunction&&(window.saveGameFunction(),i({type:"SET_NOTIFICATION",payload:{text:"Gra zosta\u0142a zapisana!",type:"success"}}))}),[i]),g=(0,r.useCallback)((e=>{i({type:"SET_SCREEN",payload:e}),n.selectedProject&&i({type:"SELECT_PROJECT",payload:null}),n.selectedRegion&&i({type:"SELECT_REGION",payload:null}),n.selectedCounty&&i({type:"SELECT_COUNTY",payload:null})}),[i,n.selectedProject,n.selectedRegion,n.selectedCounty]),v=(0,r.useCallback)((()=>{"function"===typeof window.saveGameFunction&&window.saveGameFunction(),ef.signOut().then((()=>{console.log("U\u017cytkownik wylogowany")})).catch((e=>{console.error("B\u0142\u0105d wylogowania:",e)}))}),[]),w=(0,r.useCallback)((()=>{const e=[{screen:"home",icon:(0,a.jsx)($f,{size:18}),label:"G\u0142\xf3wna"},{screen:"regions",icon:(0,a.jsx)(Wf,{size:18}),label:"Mapa"},{screen:"company",icon:(0,a.jsx)(qf,{size:18}),label:"Firma"},{screen:"events",icon:(0,a.jsx)(Hf,{size:18}),label:"Wydarzenia"},{screen:"competitors",icon:(0,a.jsx)(Kf,{size:18}),label:"Konkurencja"},{screen:"market",icon:(0,a.jsx)(Gf,{size:18}),label:"Rynek"}];return(0,a.jsx)("div",{className:"flex space-x-2",children:e.map((e=>(0,a.jsx)(zy,{icon:e.icon,screenName:e.screen,label:e.label,currentScreen:n.currentScreen,onClick:()=>g(e.screen)},e.screen)))})}),[n.currentScreen,g]);return(0,a.jsxs)("div",{className:"game-container min-h-screen flex flex-col",children:[(0,a.jsxs)("div",{className:"top-bar bg-gray-800 text-white py-2 px-4 flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"left-section flex items-center",children:[(0,a.jsx)(_y,{currentDay:n.day,gameSpeed:n.gameSpeed}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("button",{onClick:p,className:"next-day-btn flex items-center bg-blue-700 hover:bg-blue-800 px-3 py-1 rounded mr-2",children:[(0,a.jsx)(Qf,{size:18})," ",(0,a.jsx)("span",{className:"ml-1",children:"Nowy dzie\u0144"})]}),(0,a.jsxs)("div",{className:"game-speed-controls flex space-x-1",children:[(0,a.jsx)("button",{onClick:()=>m(1),className:"px-2 py-1 rounded text-xs font-bold "+(1===n.gameSpeed?"bg-green-600":"bg-gray-600 hover:bg-gray-500"),title:"Normalna pr\u0119dko\u015b\u0107",children:"x1"}),(0,a.jsx)("button",{onClick:()=>m(3),className:"px-2 py-1 rounded text-xs font-bold "+(3===n.gameSpeed?"bg-yellow-600":"bg-gray-600 hover:bg-gray-500"),title:"Przyspieszona pr\u0119dko\u015b\u0107",children:"x3"}),(0,a.jsx)("button",{onClick:()=>m(5),className:"px-2 py-1 rounded text-xs font-bold "+(5===n.gameSpeed?"bg-orange-600":"bg-gray-600 hover:bg-gray-500"),title:"Szybka pr\u0119dko\u015b\u0107",children:"x5"}),(0,a.jsx)("button",{onClick:()=>m(10),className:"px-2 py-1 rounded text-xs font-bold "+(10===n.gameSpeed?"bg-red-600":"bg-gray-600 hover:bg-gray-500"),title:"Bardzo szybka pr\u0119dko\u015b\u0107",children:"x10"})]})]})]}),(0,a.jsx)(Ey,{cash:o.cash,installedCapacity:o.installedCapacity,reputation:o.reputation}),(0,a.jsxs)("div",{className:"right-section flex items-center space-x-2",children:[(0,a.jsxs)("button",{onClick:y,className:"save-btn flex items-center bg-green-700 hover:bg-green-800 px-3 py-1 rounded",children:[(0,a.jsx)(Zf,{size:18})," ",(0,a.jsx)("span",{className:"ml-1",children:"Zapisz"})]}),(0,a.jsxs)("button",{onClick:f,className:"leaderboard-btn flex items-center bg-yellow-700 hover:bg-yellow-800 px-3 py-1 rounded",children:[(0,a.jsx)(Yf,{size:18})," ",(0,a.jsx)("span",{className:"ml-1",children:"Wyniki"})]}),(0,a.jsxs)("button",{onClick:v,className:"logout-btn flex items-center bg-red-700 hover:bg-red-800 px-3 py-1 rounded",children:[(0,a.jsx)(Jf,{size:18})," ",(0,a.jsx)("span",{className:"ml-1",children:"Wyloguj"})]})]})]}),(0,a.jsx)("div",{className:"nav-bar bg-gray-700 py-2 px-4",children:w()}),(0,a.jsx)("div",{className:"main-content flex-grow p-4 relative",children:t}),(0,a.jsx)(Xf,{})]})},Cy=Lf("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Ty=Lf("Wind",[["path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2",key:"1k4u03"}],["path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2",key:"b7d0fd"}],["path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2",key:"1p5cb3"}]]),Py=Lf("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Iy=e=>{var t,n;let{onSaveGame:r,onShowLeaderboard:i}=e;const{state:s,dispatch:o}=mf(),{state:l}=d(),{state:c}=wf(),u=e=>{o({type:"SET_SCREEN",payload:e})},h=(()=>{const e=[];return c.forEach((t=>{t.landAcquisitionProcesses&&t.landAcquisitionProcesses.length>0&&t.landAcquisitionProcesses.forEach((n=>{if("in_progress"===n.status){const r=l.staff.scouts.find((e=>e.id===n.scoutId))||{name:"Nieznany skaut"};e.push({...n,regionName:t.name,regionId:t.id,scout:r})}}))})),e})();return(0,a.jsxs)("div",{className:"home-view-container",children:[(0,a.jsxs)("div",{className:"welcome-banner",children:[(0,a.jsx)("h1",{children:"Symulator Rozwoju OZE"}),(0,a.jsxs)("div",{className:"game-date",children:[(0,a.jsxs)("div",{className:"date-item",children:[(0,a.jsx)(Ff,{className:"date-icon"}),(0,a.jsx)("span",{children:new Date(2023,0,s.day).toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"})})]}),(0,a.jsxs)("div",{className:"date-item",children:[(0,a.jsx)(Uf,{className:"date-icon"}),(0,a.jsxs)("span",{children:["Tura ",s.turn]})]})]})]}),(0,a.jsxs)("div",{className:"company-summary",children:[(0,a.jsxs)("h2",{children:["Twoja Firma: ",l.companyName||"OZE Developer"]}),(0,a.jsxs)("div",{className:"stats-grid",children:[(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Stan konta"}),(0,a.jsxs)("p",{className:"stat-value",children:[(null===(t=l.cash)||void 0===t?void 0:t.toLocaleString())||0," PLN"]})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Liczba projekt\xf3w"}),(0,a.jsx)("p",{className:"stat-value",children:(null===(n=l.projects)||void 0===n?void 0:n.length)||0})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Pracownicy"}),(0,a.jsx)("p",{className:"stat-value",children:l&&l.staff?Object.values(l.staff).filter(Boolean).flat().length:0})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Reputacja"}),(0,a.jsxs)("p",{className:"stat-value",children:[l.reputation||50,"/100"]})]})]})]}),(0,a.jsxs)("div",{className:"quick-actions-section",children:[(0,a.jsx)("h2",{children:"Szybkie Akcje"}),(0,a.jsxs)("div",{className:"quick-actions-grid",children:[(0,a.jsxs)("button",{className:"action-card",onClick:()=>u("company"),children:[(0,a.jsx)(qf,{className:"action-icon"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{children:"Zarz\u0105dzanie Sp\xf3\u0142k\u0105"}),(0,a.jsx)("p",{children:"Przegl\u0105daj finanse, projekty i pracownik\xf3w"})]}),(0,a.jsx)(Cy,{className:"arrow-icon"})]}),(0,a.jsxs)("button",{className:"action-card",onClick:()=>u("company"),children:[(0,a.jsx)(Kf,{className:"action-icon"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{children:"Zatrudnij pracownik\xf3w"}),(0,a.jsx)("p",{children:"Skauci, developerzy i inni specjali\u015bci"})]}),(0,a.jsx)(Cy,{className:"arrow-icon"})]}),(0,a.jsxs)("button",{className:"action-card",onClick:()=>u("regions"),children:[(0,a.jsx)(Wf,{className:"action-icon"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{children:"Wyb\xf3r Region\xf3w"}),(0,a.jsx)("p",{children:"Wybierz wojew\xf3dztwo do dzia\u0142a\u0144"})]}),(0,a.jsx)(Cy,{className:"arrow-icon"})]}),(0,a.jsxs)("button",{className:"action-card",onClick:()=>u("market"),children:[(0,a.jsx)(Bf,{className:"action-icon"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{children:"Gie\u0142da Projekt\xf3w"}),(0,a.jsx)("p",{children:"Kupuj i sprzedawaj projekty OZE"})]}),(0,a.jsx)(Cy,{className:"arrow-icon"})]})]})]}),(0,a.jsxs)("div",{className:"guides-section",children:[(0,a.jsx)("h2",{children:"Przewodnik"}),(0,a.jsxs)("div",{className:"guides-grid",children:[(0,a.jsxs)("div",{className:"guide-card",children:[(0,a.jsx)(by,{className:"guide-icon"}),(0,a.jsx)("h3",{children:"Jak zacz\u0105\u0107?"}),(0,a.jsx)("p",{children:"Aby rozpocz\u0105\u0107 rozw\xf3j projekt\xf3w OZE, najpierw zatrudnij skaut\xf3w, kt\xf3rzy b\u0119d\u0105 szuka\u0107 odpowiednich lokalizacji pod projekty."}),(0,a.jsx)("button",{className:"guide-action-btn",onClick:()=>u("company"),children:"Zatrudnij skauta"})]}),(0,a.jsxs)("div",{className:"guide-card",children:[(0,a.jsx)(Ty,{className:"guide-icon"}),(0,a.jsx)("h3",{children:"Rozw\xf3j Projektu"}),(0,a.jsx)("p",{children:"Projekty OZE przechodz\u0105 przez kilka etap\xf3w rozwoju, od pozyskania dzia\u0142ki do gotowej inwestycji. Ka\u017cdy etap wymaga odpowiednich specjalist\xf3w."}),(0,a.jsx)("button",{className:"guide-action-btn",onClick:()=>u("regions"),children:"Wybierz region"})]})]})]}),(0,a.jsx)("div",{className:"next-turn-section",children:(0,a.jsx)("button",{className:"next-turn-btn",onClick:()=>o({type:"NEXT_DAY"}),children:"Nast\u0119pny dzie\u0144"})}),(0,a.jsx)("div",{className:"dashboard-container",children:(0,a.jsxs)("div",{className:"dashboard-panel land-acquisition-panel",children:[(0,a.jsxs)("h3",{className:"panel-header",children:[(0,a.jsx)(Py,{className:"panel-icon"}),"Aktualne poszukiwania w regionie"]}),0===h.length?(0,a.jsx)("div",{className:"no-processes",children:(0,a.jsx)("p",{children:"Brak aktywnych proces\xf3w pozyskiwania grunt\xf3w"})}):(0,a.jsx)("div",{className:"active-processes",children:h.map((e=>(0,a.jsxs)("div",{className:"process-card",children:[(0,a.jsxs)("div",{className:"process-header",children:[(0,a.jsxs)("div",{className:"process-title",children:["Poszukiwanie dzia\u0142ki ",e.size,"ha"]}),(0,a.jsx)("div",{className:"process-region",children:e.regionName})]}),(0,a.jsxs)("div",{className:"process-details",children:[(0,a.jsxs)("div",{className:"scout-info",children:[(0,a.jsx)("span",{className:"label",children:"Skaut:"}),(0,a.jsx)("span",{className:"value",children:e.scout.name})]}),(0,a.jsxs)("div",{className:"date-info",children:[(0,a.jsxs)("div",{className:"date-item",children:[(0,a.jsx)("span",{className:"label",children:"Rozpocz\u0119cie:"}),(0,a.jsx)("span",{className:"value",children:new Date(e.startDate).toLocaleDateString("pl-PL")})]}),(0,a.jsxs)("div",{className:"date-item",children:[(0,a.jsx)("span",{className:"label",children:"Zako\u0144czenie:"}),(0,a.jsx)("span",{className:"value",children:new Date(e.completionDate).toLocaleDateString("pl-PL")})]})]})]}),(0,a.jsxs)("div",{className:"progress-container",children:[(0,a.jsxs)("div",{className:"progress-label",children:[(0,a.jsx)("span",{children:"Post\u0119p poszukiwania:"}),(0,a.jsxs)("span",{children:[Math.floor(e.progress),"%"]})]}),(0,a.jsx)("div",{className:"progress-bar",children:(0,a.jsx)("div",{className:"progress-fill",style:{width:`${e.progress}%`}})})]})]},e.id)))})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,a.jsxs)("button",{onClick:r,className:"flex items-center justify-center gap-2 p-3 text-white transition-colors rounded-lg bg-emerald-700 hover:bg-emerald-800",children:[(0,a.jsx)(Zf,{size:20}),(0,a.jsx)("span",{children:"Zapisz gr\u0119"})]}),(0,a.jsxs)("button",{onClick:i,className:"flex items-center justify-center gap-2 p-3 text-white transition-colors bg-amber-600 rounded-lg hover:bg-amber-700",children:[(0,a.jsx)(Yf,{size:20}),(0,a.jsx)("span",{children:"Tablica wynik\xf3w"})]})]})]})},Ay=e=>{switch(e){case"land_acquisition":return"Pozyskiwanie grunt\xf3w (Greenfield)";case"environmental_decision":return"Decyzja \u015brodowiskowa (EIA/D\u015aU)";case"zoning_conditions":return"Warunki zabudowy (MPZP/WZ)";case"grid_connection":return"Warunki przy\u0142\u0105czenia (WP)";case"ready_to_build":return"Gotowy do budowy (RTB)";case"construction":return"Budowa (COD-1)";case"operating":return"Operacyjny (COD)";default:return e}},My=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return"";e.endsWith("s");const n=e.endsWith("s")?e.slice(0,-1):e;if("lessor"===n||"scout"===n)return t?"Skauta":"Skaut";return{developer:t?"Developera":"Developer",lawyer:t?"Prawnika":"Prawnik",envSpecialist:t?"Specjalist\u0119 ds. \u015brodowiska":"Specjalista ds. \u015brodowiska",lobbyist:t?"Lobbyst\u0119":"Lobbysta"}[n]||n},Dy=e=>{switch(e){case"junior":return"pocz\u0105tkuj\u0105cego";case"mid":return"do\u015bwiadczonego";case"senior":return"eksperta";default:return e}},Ry=e=>{switch(e){case"aggressive":return"Agresywna";case"balanced":return"Zr\xf3wnowa\u017cona";case"conservative":return"Konserwatywna";default:return e}},Oy=(e,t)=>e.rtbPower>1.5*t?`Silny lider, posiada ${e.rtbPower.toLocaleString()} MW mocy RTB. Unikaj bezpo\u015bredniej konkurencji.`:e.rtbPower>t?`Nieznacznie wyprzedza Ci\u0119 z moc\u0105 ${e.rtbPower.toLocaleString()} MW. Mo\u017cliwe do nadrobienia.`:e.rtbPower>.7*t?`Blisko za Tob\u0105 z moc\u0105 ${e.rtbPower.toLocaleString()} MW. Pilnuj przewagi.`:`S\u0142abszy konkurent z moc\u0105 ${e.rtbPower.toLocaleString()} MW. Koncentruje si\u0119 na regionach ${e.strongRegions.slice(0,2).join(", ")}.`,Ly=()=>{const{state:e,dispatch:t}=d(),{state:n,showNotification:i}=mf(),{dispatch:a}=q(),[s,o]=(0,r.useState)([]),l={junior:{minSkill:1,maxSkill:3,salaryMultiplier:1},mid:{minSkill:4,maxSkill:7,salaryMultiplier:1.5},senior:{minSkill:8,maxSkill:10,salaryMultiplier:2.2}},c={scout:2500,developer:3e3,lawyer:0,envSpecialist:0,lobbyist:5e3},u={lawyer:3e4,envSpecialist:25e3},h=(0,r.useCallback)((()=>{n.turn>1&&f()}),[n.turn]);(0,r.useEffect)((()=>{h()}),[h]);const p=(e,t)=>{switch(e){case"scout":case"scouts":return"land_acquisition"===t;case"developer":case"developers":case"lobbyist":case"lobbyists":return!0;default:return!1}},m=(n,r)=>{const a=n.endsWith("s")?n:`${n}s`,s=e.staff[a];if(!s)return!1;const o=s.find((e=>e.id===r));if(!o||!o.assignedProject)return!1;const l=o.assignedProject,c=e.projects.find((e=>e.id===l));t({type:"UPDATE_STAFF",payload:{staffType:a,staffId:r,changes:{assignedProject:null,assignedSince:null}}});const d=n.endsWith("s")?n.slice(0,-1):n;return c&&(t({type:"UPDATE_PROJECT",payload:{id:l,changes:{assignedStaff:{...c.assignedStaff||{},[d]:null}}}}),i(`Od\u0142\u0105czono ${My(n)} ${o.name} od projektu ${c.name}`,"info")),!0},f=()=>{const t=[];Object.keys(e.staff).forEach((n=>{const r=e.staff[n];r&&0!==r.length&&r.forEach((e=>{if(Math.random()<.05){const n=y(e);n&&(t.push(n),g(e.type,e.id,n))}v(e.type,e.id)}))})),t.length>0&&o((e=>[...e,...t]))},y=e=>{let t=[.15,.1,.05,.1,.1,.2,.3];e.morale<50&&(t[2]*=3,t[4]*=2),e.energy<50&&(t[1]*=2,t[6]*=1.5),e.skill>7&&(t[5]*=2,t[3]*=1.5);const r=t.reduce(((e,t)=>e+t),0);t=t.map((e=>e/r));const i=Math.random();let a=0,s=-1;for(let n=0;n<t.length;n++)if(a+=t[n],i<=a){s=n;break}if(-1===s)return null;const o=["vacation","illness","burnout","promotion","conflict","innovation","mistake"][s];let l={id:Date.now(),staffId:e.id,staffName:e.name,staffType:e.type,type:o,turn:n.turn,title:"",description:"",effects:[]};switch(o){case"vacation":l.title=`${e.name} bierze urlop`,l.description=`Pracownik bierze ${Math.floor(1+3*Math.random())} dni urlopu.`,l.effects.push({type:"energy",value:30}),l.effects.push({type:"morale",value:20}),l.effects.push({type:"productivity",value:-1});break;case"illness":l.title=`${e.name} zachorowa\u0142`,l.description=`Pracownik jest chory i nie mo\u017ce pracowa\u0107 przez ${Math.floor(1+5*Math.random())} dni.`,l.effects.push({type:"energy",value:-20}),l.effects.push({type:"productivity",value:-1});break;case"burnout":l.title=`${e.name} cierpi na wypalenie zawodowe`,l.description="Pracownik jest przem\u0119czony i jego wydajno\u015b\u0107 spada o 50%.",l.effects.push({type:"energy",value:-40}),l.effects.push({type:"morale",value:-30}),l.effects.push({type:"productivity",value:-.5});break;case"promotion":l.title=`${e.name} zas\u0142uguje na awans`,l.description="Pracownik wykazuje si\u0119 du\u017cym zaanga\u017cowaniem i zas\u0142uguje na awans.",l.effects.push({type:"morale",value:40}),l.effects.push({type:"skill",value:1}),l.effects.push({type:"salary",value:.1});break;case"conflict":l.title=`${e.name} ma konflikt w zespole`,l.description="Pracownik ma konflikt z innymi cz\u0142onkami zespo\u0142u, co wp\u0142ywa na jego morale.",l.effects.push({type:"morale",value:-25}),l.effects.push({type:"productivity",value:-.2});break;case"innovation":l.title=`${e.name} ma innowacyjny pomys\u0142`,l.description="Pracownik wpad\u0142 na innowacyjny pomys\u0142, kt\xf3ry mo\u017ce przyspieszy\u0107 rozw\xf3j projekt\xf3w.",l.effects.push({type:"morale",value:15}),l.effects.push({type:"productivity",value:.2}),l.effects.push({type:"experience",value:10});break;case"mistake":l.title=`${e.name} pope\u0142ni\u0142 b\u0142\u0105d`,l.description="Pracownik pope\u0142ni\u0142 b\u0142\u0105d, kt\xf3ry mo\u017ce op\xf3\u017ani\u0107 rozw\xf3j projektu.",l.effects.push({type:"morale",value:-10}),l.effects.push({type:"productivity",value:-.15});break;default:return null}return l},g=(e,n,r)=>{const a={id:n};r.effects.forEach((e=>{switch(e.type){case"energy":a.energy=e.value;break;case"morale":a.morale=e.value;break;case"productivity":a.productivityModifier=e.value;break;case"skill":a.skillIncrease=e.value;break;case"experience":a.experienceIncrease=e.value;break;case"salary":a.salaryModifier=e.value}})),t({type:"UPDATE_STAFF",payload:{staffType:e,staffUpdate:a}}),i(r.title,"info")},v=function(n,r){var i;let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10;const l=n.endsWith("s")?n:`${n}s`,c=e.staff[l];if(!c)return;const d=c.findIndex((e=>e.id===r));if(-1===d)return;const u=c[d];let h=o;if(h*=[1,1.1,1.2,1.35][(null===(i=e.companyUpgrades)||void 0===i?void 0:i.training_program)||0],"developer"===n||"developers"===n)if(a&&a.technology){const e=u.technologyExperience||{},i=e[a.technology]||0,s=Math.floor(1.5*h);e[a.technology]=i+s;const o={data:(new Date).toISOString(),typ:"do\u015bwiadczenie",opis:`Zdoby\u0142 ${s} p.d. w technologii ${a.technology}`};t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:r,changes:{experience:u.experience+h,technologyExperience:e,historia:[...u.historia||[],o]}}})}else t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:r,changes:{experience:u.experience+h,historia:[...u.historia||[],{data:(new Date).toISOString(),typ:"do\u015bwiadczenie",opis:`Zdoby\u0142 ${h} p.d.`}]}}});else if("lessor"===n||"lessors"===n)if("land_acquisition"===s&&a){const e=(u.acquiredLands||0)+1,i=(u.acquiredArea||0)+(a.area||0),s=Math.floor(2*h),o={data:(new Date).toISOString(),typ:"pozyskanie_gruntu",opis:`Pozyska\u0142 grunt o powierzchni ${a.area} ha w lokalizacji ${a.location||"nieznana"}`};t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:r,changes:{experience:u.experience+s,acquiredLands:e,acquiredArea:i,historia:[...u.historia||[],o]}}})}else t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:r,changes:{experience:u.experience+h,historia:[...u.historia||[],{data:(new Date).toISOString(),typ:"do\u015bwiadczenie",opis:`Zdoby\u0142 ${h} p.d.`}]}}});else t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:r,changes:{experience:u.experience+h,historia:[...u.historia||[],{data:(new Date).toISOString(),typ:"do\u015bwiadczenie",opis:`Zdoby\u0142 ${h} p.d.`}]}}});k(n,r)},w=(e,t)=>{const n="junior"===e.level?1:"mid"===e.level?1.5:2,r="skill"===t?1:1.5;return Math.floor(5e3*n*r)},x=()=>{const e=["Adam","Anna","Piotr","Katarzyna","Micha\u0142","Magdalena","Jan","Aleksandra","Tomasz","Ma\u0142gorzata","Marek","Barbara","Andrzej","Ewa","Krzysztof","Zofia","Pawe\u0142","Monika","Rafa\u0142","Joanna"],t=["Nowak","Kowalski","Wi\u015bniewski","W\xf3jcik","Kowalczyk","Kami\u0144ski","Lewandowski","Zieli\u0144ski","Wo\u017aniak","Szyma\u0144ski","D\u0105browski","Koz\u0142owski","Jankowski","Mazur","Kwiatkowski","Krawczyk","Piotrowski","Grabowski","Nowakowski","Paw\u0142owski"];return`${e[Math.floor(Math.random()*e.length)]} ${t[Math.floor(Math.random()*t.length)]}`},b=e=>{const t={scout:["PV","WF","BESS","Negocjacje","Analiza grunt\xf3w"],developer:["PV","WF","BESS","Zarz\u0105dzanie projektami","Analiza techniczna"],lawyer:["Prawo energetyczne","Prawo \u015brodowiskowe","Prawo budowlane","Negocjacje"],envSpecialist:["Oceny oddzia\u0142ywania","Ochrona gatunkowa","Rekultywacja","Monitoring"],lobbyist:["W\u0142adze lokalne","Media","NGO","Spo\u0142eczno\u015bci lokalne"]}[e]||["Og\xf3lna"];return t[Math.floor(Math.random()*t.length)]},j=()=>{const e=["Pracowity","Leniwy","Kreatywny","Analityczny","Komunikatywny","Introwertyczny","Dok\u0142adny","Chaotyczny","Ambitny","Ostro\u017cny","Optymista","Pesymista","Zespo\u0142owy","Indywidualista","Elastyczny","Sztywny","Odporny na stres","Wra\u017cliwy","Punktualny","Sp\xf3\u017anialski"],t=1+Math.floor(3*Math.random()),n=[];for(let r=0;r<t;r++){const t=e.filter((e=>!n.includes(e)));if(0===t.length)break;const r=t[Math.floor(Math.random()*t.length)];n.push(r)}return n},k=(n,r)=>{const a=n.endsWith("s")?n:`${n}s`,s=e.staff[a];if(!s)return;const o=s.findIndex((e=>e.id===r));if(-1===o)return;const l=s[o],c={junior:{min:0,max:3e3,next:"mid"},mid:{min:3001,max:8e3,next:"senior"},senior:{min:8001,max:1/0,next:null}},d=l.level;if(l.experience>c[d].max&&c[d].next){const e=c[d].next;if(t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:r,changes:{level:e,historia:[...l.historia||[],{data:(new Date).toISOString(),typ:"awans",opis:`Awansowa\u0142 na pozycj\u0119 ${Dy(e)}`}]}}}),"mid"===e){const a=Math.max(1,Math.floor(3*Math.random())+1);t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:r,changes:{skill:Math.min(10,l.skill+a)}}}),i(`${l.name} zdoby\u0142 awans na poziom ${Dy(e)}! Umiej\u0119tno\u015bci +${a}`,"success")}else if("senior"===e){const a=Math.max(2,Math.floor(3*Math.random())+2);t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:r,changes:{skill:Math.min(10,l.skill+a)}}}),i(`${l.name} zdoby\u0142 awans na poziom ${Dy(e)}! Umiej\u0119tno\u015bci +${a}`,"success")}}const u=[1e3,2e3,4e3,6e3,8e3,1e4,12e3,14e3,16e3].filter((e=>l.experience>=e));if(u.length>l.skill-1&&l.skill<10){const e=Math.min(10,u.length+1);e>l.skill&&(t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:r,changes:{skill:e,historia:[...l.historia||[],{data:(new Date).toISOString(),typ:"rozw\xf3j",opis:`Zwi\u0119kszy\u0142 umiej\u0119tno\u015bci do poziomu ${e}/10`}]}}}),i(`${l.name} zwi\u0119kszy\u0142 swoje umiej\u0119tno\u015bci do poziomu ${e}/10!`,"success"))}},N=()=>e.projects.filter((e=>"waiting_for_developer"===e.status||"new"===e.status&&(!e.assignedStaff||!e.assignedStaff.developer))),z=e=>{const n=N();if(0===n.length)return!1;const r=n[0];return t({type:"ASSIGN_STAFF_TO_PROJECT",payload:{staffType:"developer",staffId:e,projectId:r.id}}),t({type:"UPDATE_PROJECT",payload:{projectId:r.id,changes:{status:"in_development",progress:0}}}),!0};return{hireStaff:function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"junior";try{if(!e||!e.staff)return console.error("Brak stanu gracza lub struktury personelu"),i("Wyst\u0105pi\u0142 problem z zatrudnieniem pracownika. Od\u015bwie\u017c stron\u0119.","error"),!1;if(!["scout","developer","lawyer","envSpecialist","lobbyist"].includes(r))return console.error(`Nieprawid\u0142owy typ pracownika: ${r}`),i(`Nieprawid\u0142owy typ pracownika: ${r}`,"error"),!1;if(!["junior","mid","senior"].includes(a))return console.error(`Nieprawid\u0142owy poziom pracownika: ${a}`),i(`Nieprawid\u0142owy poziom pracownika: ${a}`,"error"),!1;const o=`${r}s`;if(!e.staff[o])return console.error(`Kategoria pracownik\xf3w ${o} nie istnieje`),i("Wyst\u0105pi\u0142 problem z zatrudnieniem pracownika. Od\u015bwie\u017c stron\u0119.","error"),!1;const d=l[a]||l.junior,h=c[r]||3e3,p=Math.floor(h*d.salaryMultiplier),m="lawyer"===r||"envSpecialist"===r?u[r]:2*p;if(e.cash<m)return i(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w! Potrzebujesz ${m.toLocaleString()} PLN.`,"error"),!1;const f=`${r}-${Date.now()}-${Math.floor(1e3*Math.random())}`,y=Math.floor(d.minSkill+Math.random()*(d.maxSkill-d.minSkill+1)),g={id:f,type:r,name:x(),skill:y,experience:0,level:a,salary:p,hiredOn:(null===n||void 0===n?void 0:n.turn)||0,morale:100,energy:100,specialization:b(r),traits:j(),busy:!1,assignedRegion:null,assignedProject:null};if(t({type:"HIRE_STAFF",payload:{staffType:r,staff:g,cost:m}}),i(`Zatrudniono ${Dy(a)} ${My(r,!0)}: ${g.name}`,"success"),"developer"===r)try{if(z(f)){const e=N();e.length>0&&i(`Developer ${g.name} zosta\u0142 automatycznie przydzielony do projektu ${e[0].name}`,"success")}}catch(s){console.error("B\u0142\u0105d podczas przydzielania developera do projektu:",s)}return!0}catch(s){return console.error("Wyst\u0105pi\u0142 b\u0142\u0105d podczas zatrudniania pracownika:",s),i("Wyst\u0105pi\u0142 b\u0142\u0105d podczas zatrudniania pracownika. Spr\xf3buj ponownie.","error"),!1}},fireStaff:(n,r)=>{const a=e.staff[`${n}s`];if(!a)return!1;const s=a.findIndex((e=>e.id===r));if(-1===s)return!1;const o=a[s],l=o.salary;return e.cash<l?(i(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w na odpraw\u0119! Potrzebujesz ${l.toLocaleString()} PLN.`,"error"),!1):(t({type:"FIRE_STAFF",payload:{staffType:n,staffId:r,cost:l}}),i(`Zwolniono pracownika: ${o.name}`,"warning"),!0)},trainStaff:(n,r,a)=>{const s=e.staff[`${n}s`];if(!s)return!1;const o=s.findIndex((e=>e.id===r));if(-1===o)return!1;const l=s[o],c=w(l,a);return e.cash<c?(i(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w na szkolenie! Potrzebujesz ${c.toLocaleString()} PLN.`,"error"),!1):(t({type:"TRAIN_STAFF",payload:{staffType:n,staffId:r,trainingType:a,cost:c}}),i(`Wys\u0142ano pracownika ${l.name} na szkolenie`,"success"),!0)},assignStaffToProject:(r,s,o)=>{const l=r.endsWith("s")?r:`${r}s`,c=e.staff[l];if(!c)return!1;const d=c.find((e=>e.id===s));if(!d)return!1;const u=e.projects.find((e=>e.id===o));if(!u)return!1;if(!p(r,u.status))return i(`${My(r)} nie mo\u017ce by\u0107 przypisany do projektu na etapie ${Ay(u.status)}`,"error"),!1;if(("developer"===r||"developers"===r)&&!d.assignedProject){const t=e.projects.filter((e=>e.assignedStaff&&e.assignedStaff.developer===s)).length;if(t>=5)return i(`Developer ${d.name} osi\u0105gn\u0105\u0142 limit 5 projekt\xf3w. Od\u0142\u0105cz go od istniej\u0105cego projektu, aby przypisa\u0107 do nowego.`,"error"),!1}return d.assignedProject&&m(r,s),t({type:"ASSIGN_STAFF_TO_PROJECT",payload:{staffType:r.endsWith("s")?r.slice(0,-1):r,staffId:s,projectId:o}}),a({type:"ADD_EVENT",payload:{id:Date.now()+Math.random(),type:"staff_event",title:"Przypisanie pracownika",description:`${d.name} (${My(r)}) zosta\u0142 przypisany do projektu ${u.name}`,severity:"info",turn:n.turn,expires:n.turn+5,staffId:d.id,staffName:d.name}}),i(`Przypisano ${My(r)} ${d.name} do projektu ${u.name}`,"success"),!0},unassignStaffFromProject:m,generateStaffEvents:f,applyStaffEventEffect:g,updateStaffExperience:v,calculateTrainingCost:w,isStaffValidForProjectStage:p,checkForLevelUp:k,calculateStaffProjectBonus:t=>{var n,r;const i=e.projects.find((e=>e.id===t));if(!i||!i.assignedStaff)return 1;let a=1;if(i.assignedStaff.developer){const t=e.staff.developers.find((e=>e.id===i.assignedStaff.developer));if(t){a+=.02*t.skill+({junior:.05,mid:.1,senior:.15}[t.level]||.05)}}if(i.assignedStaff.lobbyist){const t=e.staff.lobbyists.find((e=>e.id===i.assignedStaff.lobbyist));if(t){a+=.01*t.skill+({junior:.03,mid:.06,senior:.1}[t.level]||.03)}}const s=(null===(n=e.staff.lawyers)||void 0===n?void 0:n.length)||0,o=(null===(r=e.staff.envSpecialists)||void 0===r?void 0:r.length)||0;if(s>0&&["environmental_decision","zoning_conditions","grid_connection"].includes(i.status)){const t=e.staff.lawyers.reduce(((e,t)=>e+t.skill),0)/s;a+=Math.min(.03*s,.15)+.005*t}if(o>0&&"environmental_decision"===i.status){const t=e.staff.envSpecialists.reduce(((e,t)=>e+t.skill),0)/o;a+=Math.min(.04*o,.2)+.005*t}return Math.min(a,1.5)},findProjectsWaitingForDeveloper:N,assignDeveloperToWaitingProject:z}},Fy={PV:{name:"Fotowoltaika",shortName:"PV",icon:"Sun",color:"yellow",stages:{land_acquisition:{time:{min:1,max:3},costPerMW:{min:1e4,max:1e4},description:"Pozyskiwanie grunt\xf3w pod instalacje fotowoltaiczne"},environmental_decision:{time:{min:4,max:8},costPerMW:{min:15e3,max:25e3},description:"Uzyskanie decyzji \u015brodowiskowej dla instalacji PV"},zoning_conditions:{time:{min:2,max:4},costPerMW:{min:3e4,max:4e4},description:"Uzyskanie warunk\xf3w zabudowy dla instalacji PV"},grid_connection:{time:{min:3,max:6},costPerMW:{min:12e4,max:15e4},description:"Przy\u0142\u0105czenie do sieci instalacji fotowoltaicznej"},construction:{time:{min:6,max:10},costPerMW:{min:25e5,max:35e5},description:"Budowa instalacji fotowoltaicznej"}},marketPrices:{greenfield:{min:15e3,max:25e3,currency:"PLN"},development:{min:5e4,max:8e4,currency:"EUR"},rtb:{min:61e4,max:61e4,currency:"PLN"},cod:{min:8e5,max:12e5,currency:"EUR"}},specificRisks:[{name:"Problemy z sieci\u0105",probability:.25,impact:"grid_connection_delay",description:"Ograniczenia w przy\u0142\u0105czeniu do sieci"},{name:"Zmiany w systemie wsparcia",probability:.15,impact:"financial_impact",description:"Zmiany w aukcjach OZE"}]},WF:{name:"Farmy Wiatrowe",shortName:"WF",icon:"Wind",color:"blue",stages:{land_acquisition:{time:{min:7,max:12},costPerMW:{min:1e4,max:1e4},description:"Pozyskiwanie grunt\xf3w pod farmy wiatrowe"},environmental_decision:{time:{min:12,max:20},costPerMW:{min:15e3,max:25e3},description:"Uzyskanie decyzji \u015brodowiskowej dla farm wiatrowych"},zoning_conditions:{time:{min:10,max:16},costPerMW:{min:3e4,max:4e4},description:"Uzyskanie warunk\xf3w zabudowy dla farm wiatrowych"},grid_connection:{time:{min:12,max:24},costPerMW:{min:12e4,max:15e4},description:"Przy\u0142\u0105czenie do sieci farm wiatrowych"},construction:{time:{min:18,max:30},costPerMW:{min:4e6,max:6e6},description:"Budowa farm wiatrowych"}},marketPrices:{greenfield:{min:2e5,max:7e5,currency:"PLN"},development:{min:25e4,max:35e4,currency:"PLN"},rtb:{min:4e5,max:4e5,currency:"PLN"},cod:{min:15e5,max:2e6,currency:"EUR"}},specificRisks:[{name:"Protesty ekologiczne",probability:.35,impact:"environmental_decision_delay",description:"Protesty organizacji ekologicznych"},{name:"Zasada 10H",probability:.2,impact:"land_limitation",description:"Ograniczenia lokalizacji turbin"}]},BESS:{name:"Magazyny Energii",shortName:"BESS",icon:"Battery",color:"green",stages:{land_acquisition:{time:{min:4,max:8},costPerMW:{min:1e4,max:1e4},description:"Pozyskiwanie grunt\xf3w pod magazyny energii"},environmental_decision:{time:{min:6,max:12},costPerMW:{min:15e3,max:25e3},description:"Uzyskanie decyzji \u015brodowiskowej dla magazyn\xf3w energii"},zoning_conditions:{time:{min:4,max:10},costPerMW:{min:3e4,max:4e4},description:"Uzyskanie warunk\xf3w zabudowy dla magazyn\xf3w energii"},grid_connection:{time:{min:10,max:18},costPerMW:{min:12e4,max:15e4},description:"Przy\u0142\u0105czenie do sieci magazyn\xf3w energii"},construction:{time:{min:12,max:18},costPerMW:{min:28e5,max:36e5},description:"Budowa magazyn\xf3w energii"}},marketPrices:{greenfield:{min:5e4,max:1e5,currency:"PLN"},development:{min:15e4,max:25e4,currency:"PLN"},rtb:{min:18e5,max:18e5,currency:"PLN"},cod:{min:3e6,max:45e5,currency:"PLN"}},specificRisks:[{name:"Regulacje bezpiecze\u0144stwa",probability:.3,impact:"additional_costs",description:"Dodatkowe wymagania bezpiecze\u0144stwa"},{name:"Problemy z \u0142a\u0144cuchem dostaw",probability:.25,impact:"construction_delay",description:"Op\xf3\u017anienia w dostawie komponent\xf3w"}]}},Uy={"PV+BESS":{name:"Fotowoltaika z Magazynem",shortName:"PV+BESS",icon:"SunBattery",color:"teal",components:["PV","BESS"],componentWeights:{PV:.7,BESS:.3}},"WF+BESS":{name:"Wiatrowa z Magazynem",shortName:"WF+BESS",icon:"WindBattery",color:"indigo",components:["WF","BESS"],componentWeights:{WF:.7,BESS:.3}},"PV+WF":{name:"Fotowoltaika i Wiatrowa",shortName:"PV+WF",icon:"SunWind",color:"green",components:["PV","WF"],componentWeights:{PV:.5,WF:.5}},"PV+WF+BESS":{name:"Kompleksowy System OZE",shortName:"PV+WF+BESS",icon:"SunWindBattery",color:"purple",components:["PV","WF","BESS"],componentWeights:{PV:.4,WF:.4,BESS:.2}}};function Vy(e,t,n){const r={PV:15e4,WF:2e5,BESS:25e4,"PV+BESS":18e4,"WF+BESS":23e4,"PV+WF":19e4,"PV+WF+BESS":22e4}[e]||a50000,i={land_acquisition:.15,environmental_decision:.35,zoning_conditions:.55,grid_connection:.85,ready_to_build:1}[n]||.1;return Math.round(t*r*i)}const By=()=>{const{state:e,dispatch:t}=d(),{state:n,dispatch:i}=wf(),{state:a,dispatch:s}=(()=>{const e=(0,r.useContext)(bf);if(!e)throw new Error("useCountyContext musi by\u0107 u\u017cywany wewn\u0105trz CountyProvider");return e})(),{state:o,dispatch:l,showNotification:c}=mf(),{dispatch:u}=q(),h=(0,r.useCallback)((e=>{let t=0;return a.forEach((n=>{n.leasePools&&Object.values(n.leasePools).forEach((n=>{n.lessors&&n.lessors.includes(e)&&t++}))})),t}),[a]),p=(0,r.useCallback)((()=>{const t=e.staff.lessors;if(0===t.length)return null;const n=t.map((e=>({lessor:e,countyCount:h(e.id)})));return n.sort(((e,t)=>e.countyCount-t.countyCount)),n[0].lessor}),[e.staff.lessors,h]),m=(0,r.useCallback)(((e,t)=>{if(!e||!e.specialization)return!1;const n=e.specialization.toLowerCase();if("PV"===t&&n.includes("fotowoltaika"))return!0;if("WF"===t&&n.includes("wiatrowe"))return!0;if("BESS"===t&&n.includes("magazyn"))return!0;if(t.includes("+")&&n.includes("hybrydowe")){t.split("+");if("PV+BESS"===t&&n.includes("pv+bess"))return!0;if("WF+BESS"===t&&n.includes("fw+bess"))return!0;if("PV+WF"===t&&n.includes("pv+wf"))return!0;if("PV+WF+BESS"===t&&n.includes("pv+wf+bess"))return!0}return!1}),[]),f=(0,r.useCallback)(((e,t,n)=>{const r=a.find((n=>n.voivodeship===e&&n.id===t));if(!r)return!1;if(!r.leasePools)return s({type:"UPDATE_COUNTY",payload:{id:t,voivodeship:e,changes:{leasePools:{PV:{lessors:[],projects:[]},WF:{lessors:[],projects:[]},BESS:{lessors:[],projects:[]},"PV+BESS":{lessors:[],projects:[]},"WF+BESS":{lessors:[],projects:[]},"PV+WF":{lessors:[],projects:[]},"PV+WF+BESS":{lessors:[],projects:[]}}}}}),!0;if(!r.leasePools[n]){const i={...r.leasePools};i[n]={lessors:[],projects:[]},s({type:"UPDATE_COUNTY",payload:{id:t,voivodeship:e,changes:{leasePools:i}}})}return!0}),[a,s]),y=(0,r.useCallback)(((e,t,n,r)=>{const i=a.find((e=>e.voivodeship===t&&e.id===n));if(!i||!i.leasePools||!i.leasePools[r])return!1;if(i.leasePools[r].lessors.includes(e))return!0;const o={...i.leasePools};return o[r]={...o[r],lessors:[...o[r].lessors,e]},s({type:"UPDATE_COUNTY",payload:{id:n,voivodeship:t,changes:{leasePools:o}}}),!0}),[a,s]),g=(0,r.useCallback)(((e,t,n)=>{const r=a.find((n=>n.voivodeship===e&&n.id===t));return!!(r&&r.leasePools&&r.leasePools[n])&&r.leasePools[n].lessors.length>0}),[a]),v=(0,r.useCallback)(((t,n,r)=>{const i=a.find((e=>e.voivodeship===t&&e.id===n));if(!i||!i.leasePools||!i.leasePools[r])return null;if(0===i.leasePools[r].lessors.length)return null;const s=i.leasePools[r].lessors[0];return e.staff.lessors.find((e=>e.id===s))}),[a,e.staff.lessors]),w=(0,r.useCallback)((function(r){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"PV",d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!n.find((e=>e.id===r)))return null;if(0===e.staff.lessors.length)return c("Potrzebujesz zatrudni\u0107 przynajmniej jednego dzier\u017cawc\u0119, aby rozpocz\u0105\u0107 projekt!","error"),null;if(!d)return c("Wybierz powiat, w kt\xf3rym chcesz rozpocz\u0105\u0107 projekt!","error"),null;if(!f(r,d,l))return c("Nie uda\u0142o si\u0119 zainicjowa\u0107 puli dzier\u017cawy dla powiatu!","error"),null;if(!g(r,d,l)){const e=p();if(!e)return c("Wszyscy twoi dzier\u017cawcy obs\u0142uguj\u0105 ju\u017c maksymaln\u0105 liczb\u0119 powiat\xf3w (5). Zatrudnij wi\u0119cej dzier\u017cawc\xf3w!","error"),null;if(!y(e.id,r,d,l))return c("Nie uda\u0142o si\u0119 przypisa\u0107 dzier\u017cawcy do puli dzier\u017cawy!","error"),null;m(e,l)||c(`Dzier\u017cawca ${e.name} nie ma specjalizacji pasuj\u0105cej do technologii ${l}. Efektywno\u015b\u0107 dzier\u017cawy b\u0119dzie ni\u017csza.`,"warning")}v(r,d,l);const u=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=e.includes("+");let i,a,s=[];if(r){if(a=Uy[e],!a)return null;if(s=a.components.map((e=>Fy[e])),s.some((e=>!e)))return null}else if(i=Fy[e],!i)return null;const o=n.size||Math.floor(30+50*Math.random());let l;if(r)l="PV+BESS"===e?Math.floor(o*(1.2+.6*Math.random())):"WF+BESS"===e?Math.floor(o*(.6+.3*Math.random())):"PV+WF"===e?Math.floor(o*(.8+.4*Math.random())):Math.floor(o*(1+.5*Math.random()));else switch(e){case"PV":l=Math.floor(o*(1+.5*Math.random()));break;case"WF":l=Math.floor(o*(.5+.3*Math.random()));break;case"BESS":l=Math.floor(o*(2+1*Math.random()));break;default:l=Math.floor(o*(1.2+.8*Math.random()))}const c=Date.now()+Math.floor(1e3*Math.random()),d=r?`${a.shortName} ${t.slice(0,3).toUpperCase()}${Math.floor(100*Math.random())}`:`${i.shortName} ${t.slice(0,3).toUpperCase()}${Math.floor(100*Math.random())}`;let u={},h={};if(r){u=a.components.reduce(((e,t)=>{const n=Fy[t],r=a.componentWeights[t];return Object.entries(n.stages).forEach((t=>{let[n,i]=t;e[n]||(e[n]={time:{min:0,max:0},costPerMW:{min:0,max:0},description:`${a.name}: ${i.description}`}),e[n].time.min+=i.time.min*r,e[n].time.max+=i.time.max*r,e[n].costPerMW.min+=i.costPerMW.min*r,e[n].costPerMW.max+=i.costPerMW.max*r})),e}),{});const e=a.components.reduce(((e,t)=>{const n=Fy[t],r=a.componentWeights[t];return Object.entries(n.marketPrices).forEach((t=>{let[n,i]=t;e[n]||(e[n]={min:0,max:0,currency:i.currency}),e[n].min+=i.min*r,e[n].max+=i.max*r})),e}),{}),t=1.1+.1*Math.random();Object.keys(e).forEach((n=>{h[n]={min:Math.round(e[n].min*t),max:Math.round(e[n].max*t),currency:e[n].currency}}))}else u=i.stages,h=i.marketPrices;const p={};return Object.entries(u).forEach((e=>{let[t,n]=e;const r=n.costPerMW.min,i=n.costPerMW.max,a=r+Math.random()*(i-r);p[t]=Math.round(a*l)})),{id:c,name:d,technology:e,isHybrid:r,hybridComponents:r?a.components:[e],region:t,size:o,power:l,status:"land_acquisition",statusIndex:0,progress:0,turn:n.turn||1,etapCosts:p,marketValue:Vy(e,l,"land_acquisition"),totalCost:0,events:[],assignedStaff:{},specialRisks:r?a.components.flatMap((e=>Fy[e].specificRisks||[])):i.specificRisks||[]}}(l,r,{turn:o.turn,countyId:d}),h=a.find((e=>e.voivodeship===r&&e.id===d));if(!h)return c("Nie znaleziono powiatu!","error"),null;if(h.availableLand<u.size)return c(`W tym powiecie nie ma wystarczaj\u0105cej ilo\u015bci grunt\xf3w na projekt o mocy ${u.power} MW!`,"error"),null;if(h.gridCapacity<u.power)return c(`W tym powiecie nie ma wystarczaj\u0105cej mocy przy\u0142\u0105czeniowej dla projektu o mocy ${u.power} MW!`,"error"),null;u.county={id:h.id,name:h.name,voivodeship:h.voivodeship},u.technology=l,l.includes("+")?(u.isHybrid=!0,u.hybridComponents=l.split("+")):(u.isHybrid=!1,u.hybridComponents=[l]),l.includes("PV")?u.productionFactor=h.solarPotential/100:l.includes("WF")?u.productionFactor=h.windPotential/100:"BESS"===l&&(u.productionFactor=1);const w=1+h.environmentalRestrictions/100*.5;u.environmentalDelayFactor=w;const x=1+h.localOpposition/100*.3;u.oppositionDelayFactor=x;const b=2-h.administrativeEfficiency/100;u.administrationEfficiencyFactor=b,u.totalDelayFactor=(w+x+b)/3;const j=Math.floor(10*Math.random())+1,k=Math.min(j*(500+500*Math.random()),7e3),N=Math.max(1e4-k,3e3)*h.propertyPrices,z=Math.round(N*u.size);u.etapCosts.land_acquisition=z,u.leaseDetails={baseRate:1e4,adjustedRate:N,distanceToTransformer:j,hasIndexationClause:Math.random()<.7,securityDeposit:Math.floor((3e4+2e4*Math.random())*u.power)},u.assignedStaff={},u.etapPaid={land_acquisition:!1,environmental_decision:!1,zoning_conditions:!1,grid_connection:!1,construction:!1},t({type:"ADD_PROJECT",payload:u}),i({type:"ADD_PROJECT_TO_REGION",payload:{regionId:r,project:{id:u.id,name:u.name,power:u.power,status:u.status,technology:u.technology}}}),s({type:"ADD_PROJECT_TO_COUNTY",payload:{countyId:d,voivodeship:r,project:{id:u.id,name:u.name,size:u.size,power:u.power,technology:u.technology}}});const _=a.find((e=>e.voivodeship===r&&e.id===d));if(_&&_.leasePools&&_.leasePools[l]){const e={..._.leasePools};e[l]={...e[l],projects:[...e[l].projects,u.id]},s({type:"UPDATE_COUNTY",payload:{id:d,voivodeship:r,changes:{leasePools:e}}})}return c(`Rozpocz\u0119to nowy projekt ${u.name} w powiecie ${h.name}`,"success"),u}),[e,n,a,o,t,i,s,c,p,m,f,g,y,v]),x=(0,r.useCallback)((n=>{try{const i=e.projects.find((e=>e.id===n));if(!i)return console.error(`Nie znaleziono projektu o ID: ${n}`),!1;if(!i.assignedDeveloper){var r;const a=(null===(r=e.staff.developers)||void 0===r?void 0:r.filter((e=>!e.busy&&!e.assignedProject)))||[];if(!(a.length>0))return!1;{const e=a.sort(((e,t)=>(t.skill||0)-(e.skill||0)))[0];t({type:"UPDATE_STAFF",payload:{staffType:"developers",staffId:e.id,changes:{busy:!0,assignedProject:n}}}),t({type:"UPDATE_PROJECT",payload:{projectId:n,changes:{assignedDeveloper:e.id,status:"in_development"}}}),c(`Developer ${e.name} zosta\u0142 przydzielony do projektu w ${i.regionId}`,"success")}}i.status;const a=["land_acquisition_completed","environmental_studies","environmental_decision","zoning_conditions","building_permit","grid_connection","rtb"],s=a.indexOf(i.currentStage||"land_acquisition_completed");if(-1===s)return console.error(`Nieprawid\u0142owy etap projektu: ${i.currentStage}`),!1;if(s===a.length-1)return!0;const l=a[s+1],d=b(i,l);if(!d.canTransition)return t({type:"UPDATE_PROJECT",payload:{projectId:n,changes:{transitionBlockReason:d.reason}}}),!1;const u=j(i,l);if(Math.random()>u){const r=new Date(o.gameDate),d={...i.stages};return d[i.currentStage]&&(d[i.currentStage].completed=!0,d[i.currentStage].completionDate=r.toISOString()),d[l]?d[l].startDate=r.toISOString():d[l]={completed:!1,startDate:r.toISOString(),completionDate:null},t({type:"UPDATE_PROJECT",payload:{projectId:n,changes:{currentStage:l,stages:d,lastUpdated:r.toISOString(),progress:(s+1)/(a.length-1)*100}}}),c(`Projekt w ${i.regionId} przeszed\u0142 do etapu ${Ay(l)}`,"success"),"rtb"===l&&(t({type:"UPDATE_PROJECT",payload:{projectId:n,changes:{status:"ready_to_build",rtbDate:r.toISOString()}}}),i.assignedDeveloper&&t({type:"UPDATE_STAFF",payload:{staffType:"developers",staffId:i.assignedDeveloper,changes:{busy:!1,assignedProject:null}}}),t({type:"UPDATE_PLAYER",payload:{rtbCapacity:(e.rtbCapacity||0)+(i.capacity||0)}}),t({type:"UPDATE_PLAYER",payload:{reputation:Math.min(200,(e.reputation||0)+5)}}),c(`Projekt w ${i.regionId} osi\u0105gn\u0105\u0142 status Ready-to-Build!`,"success")),!0}return t({type:"UPDATE_PROJECT",payload:{projectId:n,changes:{transitionFailures:(i.transitionFailures||0)+1,issues:[...i.issues||[],k(l)]}}}),c(`Wyst\u0105pi\u0142 problem podczas przej\u015bcia projektu w ${i.regionId} do etapu ${Ay(l)}`,"warning"),!1}catch(i){return console.error("B\u0142\u0105d podczas zarz\u0105dzania rozwojem projektu:",i),!1}}),[e,t,o,j,b,k,c]),b=(e,t)=>{var n,r;const i={canTransition:!0,reason:""};if(e.issues&&e.issues.some((e=>!e.resolved)))return i.canTransition=!1,i.reason="Projekt ma nierozwi\u0105zane problemy",i;switch(t){case"environmental_decision":e.hasEnvironmentalAssessment||(i.canTransition=!1,i.reason="Brak oceny oddzia\u0142ywania na \u015brodowisko");break;case"zoning_conditions":null!==(n=e.stageHistory)&&void 0!==n&&null!==(r=n.environmental_decision)&&void 0!==r&&r.completed||(i.canTransition=!1,i.reason="Brak decyzji \u015brodowiskowej");break;case"grid_connection":e.hasGridConnectionDesign||(i.canTransition=!1,i.reason="Brak projektu przy\u0142\u0105cza do sieci");break;case"ready_to_build":e.hasConstructionPermit||(i.canTransition=!1,i.reason="Brak pozwolenia na budow\u0119")}return i},j=(t,n)=>{let r=0;switch(n){case"environmental_decision":r=.2;break;case"zoning_conditions":r=.15;break;case"grid_connection":r=.25;break;case"ready_to_build":r=.1;break;default:r=.05}r+=.1*(t.complexity||0);const i=e.reputation||50;i>=80?r*=.7:i<30&&(r*=1.3);const a=e.staff.developers.find((e=>{var n;return e.id===(null===(n=t.assignedStaff)||void 0===n?void 0:n.developer)}));if(a){r*=1-(a.skill||50)/100*.5-(a.specialization===t.technology?.2:0)}return r+=.1*(t.transitionFailures||0),Math.max(.05,Math.min(.95,r))},k=e=>{const t={land_acquisition:[{name:"Problemy prawne z w\u0142asno\u015bci\u0105 gruntu",cost:5e3,time:10,complexity:.2},{name:"Sp\xf3r graniczny",cost:3e3,time:7,complexity:.15},{name:"Nieoczekiwane ograniczenia dzier\u017cawy",cost:4e3,time:5,complexity:.1}],environmental_decision:[{name:"Wymagana dodatkowa ocena wp\u0142ywu na gatunki chronione",cost:8e3,time:15,complexity:.3},{name:"Sprzeciw lokalnych ekolog\xf3w",cost:1e4,time:20,complexity:.25},{name:"Niekompletna dokumentacja \u015brodowiskowa",cost:6e3,time:10,complexity:.2}],zoning_conditions:[{name:"Negatywna opinia s\u0105siad\xf3w",cost:5e3,time:12,complexity:.2},{name:"Konflikt z miejscowym planem zagospodarowania",cost:12e3,time:25,complexity:.4},{name:"Wymagane dodatkowe konsultacje spo\u0142eczne",cost:7e3,time:15,complexity:.3}],grid_connection:[{name:"Niewystarczaj\u0105ca przepustowo\u015b\u0107 sieci",cost:15e3,time:20,complexity:.35},{name:"Konieczno\u015b\u0107 budowy dodatkowej infrastruktury",cost:25e3,time:30,complexity:.5},{name:"Wysoki koszt przy\u0142\u0105czenia",cost:2e4,time:15,complexity:.25}],ready_to_build:[{name:"Konieczno\u015b\u0107 aktualizacji projektu budowlanego",cost:1e4,time:15,complexity:.3},{name:"Dodatkowe wymogi bezpiecze\u0144stwa",cost:8e3,time:10,complexity:.2},{name:"Problemy z finansowaniem",cost:3e4,time:20,complexity:.4}]}[e]||[];if(0===t.length)return{id:`issue-${Date.now()}-${Math.floor(1e3*Math.random())}`,name:"Nieoczekiwany problem administracyjny",description:"Pojawi\u0142 si\u0119 nieoczekiwany problem administracyjny.",cost:5e3,time:10,complexity:.2,resolved:!1,createdAt:(new Date).toISOString()};const n=t[Math.floor(Math.random()*t.length)];return{id:`issue-${Date.now()}-${Math.floor(1e3*Math.random())}`,name:n.name,description:`${n.name}. Wymaga dodatkowych dzia\u0142a\u0144.`,cost:n.cost,time:n.time,complexity:n.complexity,resolved:!1,createdAt:(new Date).toISOString()}},N=((0,r.useCallback)(((n,r)=>{const i=e.projects.find((e=>e.id===n));if(!i||!i.issues)return c("Nie znaleziono projektu lub problem\xf3w","error"),!1;const a=i.issues.find((e=>e.id===r));if(!a)return c("Nie znaleziono problemu","error"),!1;if(e.cash<a.cost)return c(`Niewystarczaj\u0105ce \u015brodki. Potrzeba: ${a.cost.toLocaleString()} PLN`,"error"),!1;t({type:"UPDATE_CASH",payload:{amount:-a.cost,reason:`Rozwi\u0105zanie problemu: ${a.name} w projekcie ${i.name}`}});const s=i.issues.map((e=>e.id===r?{...e,resolved:!0,resolvedAt:(new Date).toISOString()}:e));return t({type:"UPDATE_PROJECT",payload:{projectId:n,changes:{issues:s}}}),t({type:"ADD_PROJECT_EVENT",payload:{projectId:n,event:{date:(new Date).toISOString(),text:`Rozwi\u0105zano problem: ${a.name}`,type:"issue_resolved"}}}),c(`Problem "${a.name}" zosta\u0142 rozwi\u0105zany`,"success"),!0}),[e.projects,e.cash,t,c]),(0,r.useCallback)((function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const i=e.projects.find((e=>e.id===n));if(!i)return c("Nie znaleziono projektu","error"),!1;if("ready_to_build"===i.status)return c("Projekt jest ju\u017c gotowy do budowy","warning"),!1;let a=0,s=0;switch(i.status){case"land_acquisition":a=r||Math.round(5e3*i.size),s=Math.min(50,Math.round(a/(5e3*i.size)*50));break;case"environmental_decision":a=r||Math.max(5e4,1e4*i.power),s=Math.min(40,Math.round(a/(1e4*i.power)*40));break;case"zoning_conditions":a=r||Math.max(3e4,7e3*i.power),s=Math.min(35,Math.round(a/(7e3*i.power)*35));break;case"grid_connection":a=r||Math.max(8e4,15e3*i.power),s=Math.min(30,Math.round(a/(15e3*i.power)*30))}return e.cash<a?(c(`Niewystarczaj\u0105ca ilo\u015b\u0107 got\xf3wki. Potrzebujesz ${a.toLocaleString()} PLN.`,"error"),!1):(t({type:"UPDATE_PROJECT",payload:{id:n,changes:{progress:Math.min(100,(i.progress||0)+s),events:[...i.events,{turn:o.turn,text:`Przyspieszono projekt o ${s}% za ${a.toLocaleString()} PLN`}]}}}),t({type:"UPDATE_CASH",payload:-a}),t({type:"UPDATE_PROJECT_TOTAL_COST",payload:{projectId:i.id,cost:a}}),c(`Przyspieszono projekt ${i.name} o ${s}%!`,"success"),!0)}),[e,o,t])),z=(0,r.useCallback)((function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const i=e.projects.find((e=>e.id===n));if(!i)return c("Nie znaleziono projektu","error"),!1;if("ready_to_build"!==i.status)return c("Tylko projekty gotowe do budowy mog\u0105 by\u0107 wystawione na rynek","warning"),!1;const a=15e4*i.power,s=r||a;return t({type:"SEND_PROJECT_TO_MARKET",payload:{projectId:n,price:s}}),c(`Projekt "${i.name}" zosta\u0142 wystawiony na rynek za ${s.toLocaleString()} PLN`,"success"),!0}),[e,t,c]),_=(0,r.useCallback)((function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bribery";const i=e.projects.find((e=>e.id===n));if(!i)return c("Nie znaleziono projektu","error"),!1;if(e.reputation<120)return c("Niewystarczaj\u0105ca reputacja do wykonania nielegalnych dzia\u0142a\u0144","error"),!1;const a={bribery:{cost:Math.round(25e3*i.power),progressGain:25,reputationLoss:10,riskOfExposure:.3},forgery:{cost:Math.round(15e3*i.power),progressGain:15,reputationLoss:15,riskOfExposure:.4},intimidation:{cost:Math.round(1e4*i.power),progressGain:10,reputationLoss:20,riskOfExposure:.5}},s=a[r]||a.bribery;if(e.cash<s.cost)return c("Niewystarczaj\u0105ca ilo\u015b\u0107 got\xf3wki","error"),!1;const l=Math.random()<s.riskOfExposure;return t({type:"UPDATE_PROJECT",payload:{id:n,changes:{progress:Math.min(100,(i.progress||0)+s.progressGain),useIllegalMethods:!0,events:[...i.events,{turn:o.turn,text:`U\u017cyto nielegalnych metod (${r}) do przyspieszenia projektu o ${s.progressGain}%`,isIllegal:!0}]}}}),t({type:"UPDATE_CASH",payload:-s.cost}),l&&t({type:"UPDATE_REPUTATION",payload:{change:-s.reputationLoss,reason:`Wykryto nielegalne dzia\u0142ania w projekcie ${i.name}`}}),t({type:"ADD_ILLEGAL_ACTION",payload:{type:r,target:i.name,cost:s.cost,turn:o.turn,exposed:l}}),l?c(`Twoje nielegalne dzia\u0142ania zosta\u0142y wykryte! Strata reputacji: ${s.reputationLoss}`,"error"):c(`U\u017cyto nielegalnych metod do przyspieszenia projektu o ${s.progressGain}%`,"success"),!0}),[e,o,t,c]);return{projects:e.projects,startNewProject:w,manageProjectDevelopment:x,accelerateProject:N,sendProjectToMarket:z,applyIllegalMethod:_,translateStage:Ay}},$y=Lf("Battery",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]),Wy=Lf("ShieldOff",[["path",{d:"M19.7 14a6.9 6.9 0 0 0 .3-2V5l-8-3-3.2 1.2",key:"342pvf"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M4.7 4.7 4 5v7c0 6 8 10 8 10a20.3 20.3 0 0 0 5.62-4.38",key:"p0ycf4"}]]),qy=Lf("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),Hy=Lf("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Ky=e=>{let{value:t=0,status:n="medium",showPercent:r=!1,className:i="",...s}=e;const o=Math.min(100,Math.max(0,t)),l=`progress-${n}`;return(0,a.jsxs)("div",{className:`relative ${i}`,...s,children:[(0,a.jsx)("div",{className:"progress-bar-container",children:(0,a.jsx)("div",{className:`progress-bar-fill ${l}`,style:{width:`${o}%`}})}),r&&(0,a.jsxs)("div",{className:"text-xs font-medium text-gray-700 text-right mt-1",children:[o,"%"]})]})},Gy=e=>{let{status:t="active",text:n,icon:r,className:i="",...s}=e;const o=`status-${t}`;return(0,a.jsxs)("span",{className:`status-indicator ${o} ${i}`,...s,children:[r&&(0,a.jsx)("span",{className:"mr-1",children:r}),n]})},Qy=e=>{var t,n;let{project:i,onAdvance:s,onAssignStaff:o,onDetails:l,onSell:c,onApplyIllegalMethod:u,onAccelerate:h}=e;const{state:p}=d(),{showNotification:m}=mf(),[f,y]=(0,r.useState)(!1);if(!i)return null;const g=e=>e>=1e6?`${(e/1e6).toFixed(2)} mln z\u0142`:e>=1e3?`${(e/1e3).toFixed(1)} tys. z\u0142`:`${e} z\u0142`,v=()=>"ready_to_build"===i.status?100:Math.min(100,Math.round(i.progress)),w={land_acquisition:{index:0,label:"Grunty"},environmental_decision:{index:1,label:"\u015arodowisko"},zoning_conditions:{index:2,label:"Warunki zabudowy"},grid_connection:{index:3,label:"Przy\u0142\u0105czenie"},ready_to_build:{index:4,label:"RTB"}},x=()=>{const e=25e4*i.power,t={land_acquisition:.15,environmental_decision:.35,zoning_conditions:.55,grid_connection:.85,ready_to_build:1}[i.status]||.1,n=i.progress/100*.2;return Math.round(e*(t+n))},b=()=>x()-i.totalCost,j=e=>{if(!u)return void m("Funkcja u\u017cywania nielegalnych metod nie jest dost\u0119pna","error");if(p.reputation<30)return void m("Reputacja jest zbyt niska, aby ryzykowa\u0107 kolejne nielegalne dzia\u0142ania","error");let t=0;switch(e){case"bribe_official":t=25e3+1e3*i.power;break;case"forge_documents":t=15e3+500*i.power;break;case"pressure_officials":t=3e4+2e3*i.power;break;default:t=2e4}p.cash<t?m(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w na t\u0119 akcj\u0119 (${t.toLocaleString()} z\u0142)`,"error"):(u(i.id,e,t),y(!1))};return(0,a.jsxs)("div",{className:"bg-white rounded shadow-md overflow-hidden flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"p-3 border-b bg-gray-50 flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"font-medium",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(e=>{switch(e){case"PV":return(0,a.jsx)(Bf,{className:"h-4 w-4 text-yellow-500"});case"WF":return(0,a.jsx)(Ty,{className:"h-4 w-4 text-blue-500"});case"BESS":return(0,a.jsx)($y,{className:"h-4 w-4 text-purple-500"});default:return null}})(i.technology),(0,a.jsx)("span",{className:"ml-1",children:i.name}),i.useIllegalMethods&&(0,a.jsx)("div",{className:"ml-2 text-red-500",title:"Ten projekt wykorzystuje nielegalne metody",children:(0,a.jsx)(Wy,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 flex items-center",children:[(0,a.jsx)(Py,{className:"h-3 w-3 mr-1"}),i.county?`${i.county.name}, ${i.region}`:i.region]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-bold flex items-center justify-end",children:[i.power," MW"]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 flex items-center justify-end",children:[(0,a.jsx)(Ff,{className:"h-3 w-3 mr-1"})," Tura ",i.startedOn]})]})]}),(0,a.jsxs)("div",{className:"px-4 py-3",children:[(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[(0,a.jsxs)("span",{children:["Etap: ",Ay(i.status)]}),(0,a.jsxs)("span",{children:[v(),"%"]})]}),(0,a.jsx)(Ky,{value:v(),status:i.useIllegalMethods?"warning":v()>=75?"high":v()>=30?"medium":"low"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[(0,a.jsx)("span",{children:"Ca\u0142kowity post\u0119p"}),(0,a.jsxs)("span",{children:[20*(null===(t=w[i.status])||void 0===t?void 0:t.index)+v()/5,"%"]})]}),(0,a.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full "+(i.useIllegalMethods?"bg-amber-500":"bg-blue-500"),style:{width:20*(null===(n=w[i.status])||void 0===n?void 0:n.index)+v()/5+"%"}})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-4 text-xs",children:[(0,a.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,a.jsx)("div",{className:"text-gray-500",children:"Ca\u0142kowity koszt"}),(0,a.jsx)("div",{className:"font-medium",children:g(i.totalCost)})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,a.jsx)("div",{className:"text-gray-500",children:"Szacowana warto\u015b\u0107"}),(0,a.jsx)("div",{className:"font-medium",children:g(x())})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,a.jsx)("div",{className:"text-gray-500",children:"Potencjalny zysk"}),(0,a.jsxs)("div",{className:"font-medium "+(b()>=0?"text-green-600":"text-red-600"),children:[g(b())," (",(()=>{const e=b();return 0===i.totalCost?0:Math.round(e/i.totalCost*100)})(),"%)"]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,a.jsx)("div",{className:"text-gray-500",children:"Status"}),(0,a.jsx)("div",{className:"font-medium",children:(0,a.jsx)(Gy,{status:(k=i.status,N=i.progress,"ready_to_build"===k?"completed":N<25?"warning":"active"),text:i.progress>=100?"Gotowy do rozwoju":"W trakcie"})})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap justify-between mt-auto pt-2 border-t",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{onClick:()=>l(i.id),className:"text-xs px-2 py-1 text-gray-600 hover:bg-gray-100 rounded",children:"Szczeg\xf3\u0142y"}),(0,a.jsxs)("button",{onClick:()=>o(i.id),className:"text-xs px-2 py-1 text-gray-600 hover:bg-gray-100 rounded ml-1",children:[(0,a.jsx)(Kf,{className:"h-3 w-3 inline mr-1"}),"Personel"]})]}),(0,a.jsxs)("div",{className:"relative",children:[f&&(0,a.jsxs)("div",{className:"absolute bottom-8 right-0 bg-white shadow-md rounded border p-2 w-48 z-10",children:[(0,a.jsxs)("div",{className:"text-xs font-medium mb-2 text-red-600 flex items-center",children:[(0,a.jsx)(Wy,{className:"h-3 w-3 mr-1"}),"Dzia\u0142ania niejawne"]}),(0,a.jsx)("button",{onClick:()=>j("bribe_official"),className:"text-xs w-full text-left p-1 hover:bg-red-50 text-gray-700 mb-1 rounded",children:"\u0141ap\xf3wka dla urz\u0119dnika (25k+ z\u0142)"}),(0,a.jsx)("button",{onClick:()=>j("forge_documents"),className:"text-xs w-full text-left p-1 hover:bg-red-50 text-gray-700 mb-1 rounded",children:"Fa\u0142szowanie dokument\xf3w (15k+ z\u0142)"}),(0,a.jsx)("button",{onClick:()=>j("pressure_officials"),className:"text-xs w-full text-left p-1 hover:bg-red-50 text-gray-700 mb-1 rounded",children:"Naciski na urz\u0119dnik\xf3w (30k+ z\u0142)"}),(0,a.jsx)("button",{onClick:()=>y(!1),className:"text-xs w-full text-left p-1 hover:bg-gray-100 text-gray-500 rounded",children:"Anuluj"})]}),i.progress>=100&&"ready_to_build"!==i.status&&(0,a.jsx)("button",{onClick:()=>s(i.id),className:"text-xs px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600",children:"Nast\u0119pny etap"}),"land_acquisition"!==i.status&&(0,a.jsxs)("button",{onClick:()=>c(i.id),className:"text-xs px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 ml-1",children:[(0,a.jsx)(qy,{className:"h-3 w-3 inline mr-1"}),"Sprzedaj"]}),"ready_to_build"!==i.status&&(0,a.jsx)("button",{onClick:()=>y(!f),className:`text-xs px-2 py-1 ${i.useIllegalMethods?"bg-amber-500":"bg-gray-700"} text-white rounded hover:bg-gray-800 ml-1`,title:i.useIllegalMethods?"Ten projekt ju\u017c u\u017cywa nielegalnych metod":"U\u017cyj nielegalnych metod, aby przyspieszy\u0107 projekt",children:(0,a.jsx)(Hy,{className:"h-3 w-3 inline"})})]})]})]}),(0,a.jsxs)("div",{className:"px-4 py-3 bg-gray-50 flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"Status: "}),(0,a.jsx)("span",{className:"text-sm font-medium "+(i.useIllegalMethods?"text-amber-600":"text-blue-600"),children:Ay(i.status)})]}),"ready_to_build"!==i.status&&(0,a.jsx)(my,{variant:"secondary",size:"sm",onClick:()=>{"function"===typeof h&&h(i.id)},children:"Przyspiesz projekt"})]})]});var k,N},Zy=(Lf("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),Lf("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Lf("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]])),Yy=Lf("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Jy=Lf("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Xy=Lf("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),eg={filterGroup:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},filterBtn:{padding:"0.375rem 0.75rem",borderRadius:"0.375rem",fontSize:"0.875rem",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",border:"1px solid #e5e7eb",cursor:"pointer",position:"relative"},active:{backgroundColor:"#3b82f6",color:"white",border:"1px solid #2563eb"},badge:{position:"absolute",top:"-8px",right:"-8px",minWidth:"20px",height:"20px",borderRadius:"10px",backgroundColor:"#ef4444",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"bold",padding:"0 6px"}},tg=()=>{const{state:e,dispatch:t}=d(),{state:n,showNotification:i}=mf(),{projects:s,accelerateProject:o,sendProjectToMarket:l,applyIllegalMethod:c,advanceProject:u}=By(),[h,p]=(Ly(),(0,r.useState)(null)),[m,f]=(0,r.useState)("all"),[y,g]=(0,r.useState)("progress"),[v,w]=(0,r.useState)("desc"),x=(0,r.useMemo)((()=>e.projects.filter((e=>"all"===m||("waiting"===m?"development_ready"===e.status:"pv"===m?"PV"===e.technology:"wf"===m?"WF"===e.technology:"development"===m?"in_development"===e.status:"rtb"!==m||"ready_to_build"===e.status)))),[e.projects,m]),b=(0,r.useMemo)((()=>[...x].sort(((e,t)=>{if("progress"===y){const n=e.progress||0,r=t.progress||0;return"asc"===v?n-r:r-n}if("power"===y)return"asc"===v?e.power-t.power:t.power-e.power;if("stage"===y){const n=["land_acquisition","environmental_decision","zoning_conditions","grid_connection","ready_to_build"],r=n.indexOf(e.status),i=n.indexOf(t.status);return"asc"===v?r-i:i-r}if("value"===y){const n=e=>15e4*e.power*({land_acquisition:.15,environmental_decision:.35,zoning_conditions:.55,grid_connection:.85,ready_to_build:1}[e.status]||.1),r=n(e),i=n(t);return"asc"===v?r-i:i-r}return 0}))),[x,y,v]),j=(0,r.useMemo)((()=>{const t={total:e.projects.length,pv:0,wf:0,rtb:0,development:0,totalPower:0,totalEstimatedValue:0};return e.projects.forEach((e=>{"PV"===e.technology&&t.pv++,"WF"===e.technology&&t.wf++,"ready_to_build"===e.status&&t.rtb++,"ready_to_build"!==e.status&&t.development++,t.totalPower+=e.power||0;const n=15e4*e.power;t.totalEstimatedValue+=n*({land_acquisition:.15,environmental_decision:.35,zoning_conditions:.55,grid_connection:.85,ready_to_build:1}[e.status]||.1)})),t}),[e.projects]),k=t=>{const n=e.projects.find((e=>e.id===t));if(!n)return;let r=0;switch(n.status){case"land_acquisition":r=Math.round(5e3*n.size);break;case"environmental_decision":r=Math.max(5e4,1e4*n.power);break;case"zoning_conditions":r=Math.max(3e4,7e3*n.power);break;case"grid_connection":r=Math.max(8e4,15e3*n.power)}const a=window.prompt(`Podaj kwot\u0119 przyspieszenia projektu (sugerowana: ${r.toLocaleString()} PLN):`,r);if(null===a)return;const s=parseInt(a.replace(/\D/g,""),10);if(isNaN(s)||s<=0)return void i("Nieprawid\u0142owa kwota","error");o(t,s)&&i(`Przyspieszono projekt za ${s.toLocaleString()} PLN`,"success")};return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[(0,a.jsx)(Zy,{className:"h-6 w-6 mr-2 text-blue-600"}),"Podsumowanie projekt\xf3w",e.projects.filter((e=>"development_ready"===e.status)).length>0&&(0,a.jsxs)("span",{style:{marginLeft:"0.5rem",padding:"0.25rem 0.5rem",backgroundColor:"#ef4444",color:"white",borderRadius:"0.375rem",fontSize:"0.75rem",fontWeight:"bold"},children:[e.projects.filter((e=>"development_ready"===e.status)).length," projekt(\xf3w) czeka na developera"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-3 mb-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-3 rounded-md",children:[(0,a.jsx)("div",{className:"text-xs text-blue-800",children:"Wszystkie projekty"}),(0,a.jsx)("div",{className:"text-xl font-bold text-blue-900",children:j.total})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 p-3 rounded-md",children:[(0,a.jsx)("div",{className:"text-xs text-yellow-800",children:"Fotowoltaika (PV)"}),(0,a.jsx)("div",{className:"text-xl font-bold text-yellow-900",children:j.pv})]}),(0,a.jsxs)("div",{className:"bg-green-50 p-3 rounded-md",children:[(0,a.jsx)("div",{className:"text-xs text-green-800",children:"Farmy wiatrowe (WF)"}),(0,a.jsx)("div",{className:"text-xl font-bold text-green-900",children:j.wf})]}),(0,a.jsxs)("div",{className:"bg-purple-50 p-3 rounded-md",children:[(0,a.jsx)("div",{className:"text-xs text-purple-800",children:"W developmencie"}),(0,a.jsx)("div",{className:"text-xl font-bold text-purple-900",children:j.development})]}),(0,a.jsxs)("div",{className:"bg-indigo-50 p-3 rounded-md",children:[(0,a.jsx)("div",{className:"text-xs text-indigo-800",children:"Ready-to-Build"}),(0,a.jsx)("div",{className:"text-xl font-bold text-indigo-900",children:j.rtb})]}),(0,a.jsxs)("div",{className:"bg-red-50 p-3 rounded-md",children:[(0,a.jsx)("div",{className:"text-xs text-red-800",children:"Moc ca\u0142kowita"}),(0,a.jsxs)("div",{className:"text-xl font-bold text-red-900",children:[j.totalPower," MW"]})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4 items-center text-sm",children:[(0,a.jsx)("div",{className:"font-medium",children:"Filtruj:"}),(0,a.jsxs)("div",{style:eg.filterGroup,children:[(0,a.jsx)("button",{style:{...eg.filterBtn,..."all"===m?eg.active:{}},onClick:()=>f("all"),children:"Wszystkie"}),(0,a.jsxs)("button",{style:{...eg.filterBtn,..."waiting"===m?eg.active:{}},onClick:()=>f("waiting"),children:["Oczekuj\u0105ce na developera",e.projects.filter((e=>"development_ready"===e.status)).length>0&&(0,a.jsx)("span",{style:eg.badge,children:e.projects.filter((e=>"development_ready"===e.status)).length})]}),(0,a.jsx)("button",{style:{...eg.filterBtn,..."development"===m?eg.active:{}},onClick:()=>f("development"),children:"W rozwoju"}),(0,a.jsx)("button",{style:{...eg.filterBtn,..."rtb"===m?eg.active:{}},onClick:()=>f("rtb"),children:"Gotowe do budowy"})]}),(0,a.jsx)("div",{className:"font-medium ml-4",children:"Sortuj:"}),(0,a.jsxs)("select",{value:y,onChange:e=>g(e.target.value),className:"border rounded px-2 py-1 text-sm",children:[(0,a.jsx)("option",{value:"progress",children:"Post\u0119p"}),(0,a.jsx)("option",{value:"power",children:"Moc (MW)"}),(0,a.jsx)("option",{value:"stage",children:"Etap"}),(0,a.jsx)("option",{value:"value",children:"Warto\u015b\u0107"})]}),(0,a.jsx)("button",{onClick:()=>w("asc"===v?"desc":"asc"),className:"border rounded px-2 py-1 flex items-center",children:"asc"===v?(0,a.jsx)(Yy,{className:"h-4 w-4"}):(0,a.jsx)(Jy,{className:"h-4 w-4"})})]}),b.length>0?(0,a.jsx)("div",{className:"space-y-3",children:b.map((e=>(0,a.jsx)(Qy,{project:e,onAdvance:()=>u(e.id),onAccelerate:k,onApplyIllegalMethod:t=>c(e.id,t)},e.id)))}):(0,a.jsxs)("div",{className:"bg-gray-50 p-8 rounded-lg text-center",children:[(0,a.jsx)("div",{className:"text-gray-400 mb-3",children:(0,a.jsx)(Xy,{className:"h-10 w-10 mx-auto"})}),(0,a.jsx)("p",{className:"text-gray-600",children:"Brak projekt\xf3w spe\u0142niaj\u0105cych kryteria filtrowania"}),(0,a.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:"Zmie\u0144 filtry lub rozpocznij nowe projekty"})]})]})},ng=e=>{let{title:t,isOpen:n,onClose:i,children:s,variant:o="default"}=e;if(!n)return null;const l=(0,r.useRef)(null),c=e=>{l.current&&!l.current.contains(e.target)&&i()};(0,r.useEffect)((()=>(document.addEventListener("mousedown",c),()=>{document.removeEventListener("mousedown",c)})),[]);return(0,a.jsxs)("div",{ref:l,className:`fixed top-0 right-0 h-full w-96 shadow-lg border-l-4 z-30 transition-all duration-300 ease-in-out ${(()=>{switch(o){case"illegal":return"border-l-red-600 bg-red-50";case"staff":return"border-l-blue-600 bg-blue-50";case"project":return"border-l-green-600 bg-green-50";case"finance":return"border-l-purple-600 bg-purple-50";default:return"border-l-gray-600 bg-gray-50"}})()}`,style:{transform:n?"translateX(0)":"translateX(100%)",overflowY:"auto"},children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,a.jsx)("h2",{className:"text-xl font-bold break-words",children:t}),(0,a.jsx)("button",{onClick:i,className:"p-1 rounded-full hover:bg-gray-200 transition-colors",children:(0,a.jsx)(vy,{size:20})})]}),(0,a.jsx)("div",{className:"p-4 overflow-hidden",children:s})]})},rg=Lf("FileX",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"9.5",x2:"14.5",y1:"12.5",y2:"17.5",key:"izs6du"}],["line",{x1:"14.5",x2:"9.5",y1:"12.5",y2:"17.5",key:"1lehlj"}]]),ig=Lf("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),ag=Lf("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]),sg=Lf("ShieldAlert",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]),og=Lf("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),lg=Lf("ActivitySquare",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M17 12h-2l-2 5-2-10-2 5H7",key:"15hlnc"}]]),cg=e=>{let{onClose:t}=e;const{state:n,dispatch:i}=d(),{state:s,showNotification:o}=mf(),{dispatch:l}=q(),[c,u]=(0,r.useState)(null),[h,p]=(0,r.useState)(null),m=new ay(n,i,s);(0,r.useEffect)((()=>{p(m.getGrayAreaStatus())}),[n.illegals,n.reputationFactors]);const f=[{id:"bribe_officials",name:"Przekupstwo urz\u0119dnik\xf3w",description:"Wykorzystaj \u0142ap\xf3wki, aby przyspieszy\u0107 proces administracyjny i uzyska\u0107 przychylne decyzje.",icon:(0,a.jsx)(Vf,{className:"h-5 w-5 text-yellow-600"}),riskLevel:"high",cost:5e4,reputation:-10,effects:"Przyspiesza proces uzyskiwania decyzji administracyjnych o 40% dla wskazanego projektu.",requirements:"Minimum 100 000 PLN i reputacja > 30",details:"Przekupstwo urz\u0119dnik\xf3w to powszechna praktyka w krajach o wysokim poziomie korupcji. W sektorze OZE mo\u017ce dotyczy\u0107 przyspieszenia wydania decyzji \u015brodowiskowych, warunk\xf3w zabudowy lub przy\u0142\u0105czenia do sieci.",requiredCorruption:10,targetType:"project"},{id:"falsify_documents",name:"Fa\u0142szowanie dokumentacji",description:"Zmodyfikuj dokumentacj\u0119 techniczn\u0105 lub \u015brodowiskow\u0105, aby ukry\u0107 potencjalne problemy.",icon:(0,a.jsx)(rg,{className:"h-5 w-5 text-red-600"}),riskLevel:"extreme",cost:1e5,reputation:-20,effects:"Eliminuje negatywne czynniki techniczne lub \u015brodowiskowe blokuj\u0105ce rozw\xf3j projektu.",requirements:"Konieczne posiadanie nielegalnej bazy danych i reputacja > 50",details:"Fa\u0142szowanie dokumentacji to powa\u017cne przest\u0119pstwo, kt\xf3re mo\u017ce dotyczy\u0107 raport\xf3w oddzia\u0142ywania na \u015brodowisko, bada\u0144 ornitologicznych lub dokumentacji technicznej. Wykrycie mo\u017ce skutkowa\u0107 nie tylko karami finansowymi, ale nawet odpowiedzialno\u015bci\u0105 karn\u0105.",requiredCorruption:30,targetType:"project"},{id:"insider_info",name:"Informacje poufne",description:"Uzyskaj dost\u0119p do poufnych informacji o planach przestrzennych i aukcjach energii.",icon:(0,a.jsx)(dy,{className:"h-5 w-5 text-blue-600"}),riskLevel:"medium",cost:25e3,reputation:-5,effects:"Udost\u0119pnia informacje o najlepszych lokalizacjach i nadchodz\u0105cych aukcjach, zwi\u0119kszaj\u0105c szanse sukcesu.",requirements:"Posiadanie co najmniej jednego lobbysty",details:"Wykorzystanie informacji poufnych to dzia\u0142alno\u015b\u0107 na granicy prawa, kt\xf3ra polega na uzyskiwaniu dost\u0119pu do niepublicznych danych o planach zagospodarowania, przetargach czy zmianach regulacyjnych. Mo\u017ce dawa\u0107 znacz\u0105c\u0105 przewag\u0119 konkurencyjn\u0105.",requiredCorruption:5,targetType:"company"},{id:"intimidate_landowners",name:"Zastraszanie w\u0142a\u015bcicieli grunt\xf3w",description:"Wywieranie presji na w\u0142a\u015bcicieli grunt\xf3w, aby sprzedali ziemi\u0119 po zani\u017conej cenie.",icon:(0,a.jsx)(ig,{className:"h-5 w-5 text-purple-600"}),riskLevel:"high",cost:3e4,reputation:-15,effects:"Obni\u017ca koszty zakupu grunt\xf3w o 30-50%.",requirements:"Reputacja > 40",details:"Zastraszanie w\u0142a\u015bcicieli grunt\xf3w to metoda nieetyczna i nielegalna, stosowana przez nieuczciwych deweloper\xf3w. Polega na wywieraniu presji poprzez gro\u017aby lub wykorzystywanie luk prawnych, aby zmusi\u0107 w\u0142a\u015bcicieli do sprzeda\u017cy po zani\u017conych cenach.",requiredCorruption:20,targetType:"project"},{id:"build_corruption_network",name:"Budowa sieci korupcyjnej",description:"Rozwijaj sie\u0107 kontakt\xf3w w urz\u0119dach i instytucjach kontrolnych, aby u\u0142atwi\u0107 przysz\u0142e dzia\u0142ania.",icon:(0,a.jsx)(ag,{className:"h-5 w-5 text-green-600"}),riskLevel:"medium",cost:2e5,reputation:-10,effects:"Zwi\u0119ksza poziom sieci korupcyjnej o 10 punkt\xf3w, obni\u017caj\u0105c koszty przysz\u0142ych nielegalnych dzia\u0142a\u0144.",requirements:"Minimum 200 000 PLN",details:"Budowa sieci korupcyjnej to d\u0142ugofalowa inwestycja w nieformalne kontakty z urz\u0119dnikami, politykami i przedstawicielami instytucji kontrolnych. Im silniejsza sie\u0107, tym \u0142atwiejsze i ta\u0144sze staj\u0105 si\u0119 przysz\u0142e nielegalne dzia\u0142ania.",requiredCorruption:0,targetType:"company"},{id:"sabotage_competitors",name:"Sabota\u017c konkurencji",description:"Zlecenie dzia\u0142a\u0144 sabota\u017cowych przeciwko konkurencyjnym projektom w regionie.",icon:(0,a.jsx)(sg,{className:"h-5 w-5 text-orange-600"}),riskLevel:"extreme",cost:15e4,reputation:-25,effects:"Op\xf3\u017ania projekty konkurencji w regionie o 3-6 miesi\u0119cy.",requirements:"Reputacja > 60 i poziom sieci korupcyjnej > 30",details:"Sabota\u017c konkurencji to bezpo\u015brednie dzia\u0142ania wymierzone w projekty konkurencyjnych firm. Mo\u017ce obejmowa\u0107 manipulowanie konsultacjami spo\u0142ecznymi, sztuczne wywo\u0142ywanie protest\xf3w lub nawet fizyczne uszkodzenia infrastruktury. Niesie wysokie ryzyko wykrycia i powa\u017cnych konsekwencji prawnych.",requiredCorruption:40,targetType:"region"},{id:"create_illegal_database",name:"Stw\xf3rz nielegaln\u0105 baz\u0119 danych",description:"Zlecenie stworzenia bazy danych zawieraj\u0105cej poufne informacje o urz\u0119dnikach, planach i procedurach.",icon:(0,a.jsx)(og,{className:"h-5 w-5 text-gray-600"}),riskLevel:"low",cost:75e3,reputation:-5,effects:"Odblokowuje dodatkowe nielegalne akcje i zwi\u0119ksza skuteczno\u015b\u0107 istniej\u0105cych o 20%.",requirements:"Minimum 75 000 PLN",details:"Nielegalna baza danych to zbi\xf3r poufnych informacji o urz\u0119dnikach, procedurach i lukach prawnych. Jej posiadanie umo\u017cliwia bardziej precyzyjne planowanie nielegalnych dzia\u0142a\u0144 i zwi\u0119ksza ich skuteczno\u015b\u0107. Pozyskanie takich danych wymaga zaanga\u017cowania os\xf3b z dost\u0119pem do poufnych informacji.",requiredCorruption:0,targetType:"company"}],y=e=>!(e.requirements.includes("minimum")&&n.cash<e.cost)&&(!(e.requirements.includes("reputacja")&&n.reputation<parseInt(e.requirements.match(/reputacja > (\d+)/)[1]))&&(!(e.requiredCorruption>n.illegals.corruptionNetwork)&&(!("falsify_documents"===e.id&&!n.illegals.hasIllegalDatabase)&&(("insider_info"!==e.id||0!==n.staff.lobbyists.length)&&("create_illegal_database"!==e.id||!n.illegals.hasIllegalDatabase))))),g=e=>{switch(e){case"low":return(0,a.jsx)("span",{className:"text-green-600 font-medium",children:"Niskie"});case"medium":return(0,a.jsx)("span",{className:"text-yellow-600 font-medium",children:"\u015arednie"});case"high":return(0,a.jsx)("span",{className:"text-orange-600 font-medium",children:"Wysokie"});case"extreme":return(0,a.jsx)("span",{className:"text-red-600 font-medium",children:"Ekstremalne"});default:return(0,a.jsx)("span",{className:"text-gray-600",children:"Nieznane"})}},v=e=>{const t=y(e);return(0,a.jsxs)("div",{className:"border rounded-lg p-4 mb-4 hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"flex items-start mb-2",children:[(0,a.jsx)("div",{className:"mr-3",children:e.icon}),(0,a.jsxs)("div",{className:"flex-grow",children:[(0,a.jsx)("h3",{className:"font-bold text-gray-800",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]}),(0,a.jsxs)("div",{className:"ml-2 text-right",children:[(0,a.jsxs)("div",{className:"text-sm mb-1",children:["Ryzyko: ",g(e.riskLevel)]}),(0,a.jsxs)("div",{className:"text-sm",children:["Koszt: ",(0,a.jsxs)("span",{className:"font-medium",children:[e.cost.toLocaleString()," PLN"]})]})]})]}),(0,a.jsxs)("div",{className:"mt-2 space-y-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Efekt:"})," ",e.effects]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Wymagania:"})," ",e.requirements]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Wp\u0142yw na reputacj\u0119:"})," ",(0,a.jsx)("span",{className:"text-red-600",children:e.reputation})]})]}),(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)(my,{onClick:()=>(e=>{if(!y(e))return void o("Nie mo\u017cesz wykona\u0107 tej akcji - nie spe\u0142niasz wymaga\u0144!","error");if(n.cash<e.cost)return void o(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w (potrzeba ${e.cost.toLocaleString()} PLN)`,"error");const t=m.executeIllegalAction(e.id,{cost:e.cost,target:e.targetType,riskIncrease:"extreme"===e.riskLevel?20:"high"===e.riskLevel?15:"medium"===e.riskLevel?10:5});if(t.success){switch(e.id){case"create_illegal_database":i({type:"UPDATE_ILLEGAL_DATABASE",payload:{hasIllegalDatabase:!0}}),l({type:"ADD_EVENT",payload:{id:Date.now(),type:"illegal_activity",title:"Stworzenie nielegalnej bazy danych",description:"Stworzy\u0142e\u015b nielegaln\u0105 baz\u0119 danych, kt\xf3ra umo\u017cliwi Ci bardziej skuteczne planowanie nielegalnych dzia\u0142a\u0144.",severity:"warning",turn:s.turn,expires:s.turn+10}}),o("Stworzy\u0142e\u015b nielegaln\u0105 baz\u0119 danych!","success");break;case"build_corruption_network":l({type:"ADD_EVENT",payload:{id:Date.now(),type:"illegal_activity",title:"Rozbudowa sieci korupcyjnej",description:"Rozwin\u0105\u0142e\u015b swoj\u0105 sie\u0107 kontakt\xf3w korupcyjnych, co u\u0142atwi Ci przysz\u0142e nielegalne dzia\u0142ania.",severity:"warning",turn:s.turn,expires:s.turn+15}}),o("Rozbudowa\u0142e\u015b swoj\u0105 sie\u0107 korupcyjn\u0105!","success");break;default:u(e)}p(m.getGrayAreaStatus()),t.detected&&(o(t.consequences,"warning"),l({type:"ADD_EVENT",payload:{id:Date.now(),type:"scandal",title:`Wykryto nielegalne dzia\u0142anie: ${e.name}`,description:"Twoje nielegalne dzia\u0142anie zosta\u0142o wykryte, co znacz\u0105co wp\u0142yn\u0119\u0142o na reputacj\u0119 firmy.",severity:"danger",turn:s.turn,expires:s.turn+20}}))}else o(t.reason,"error")})(e),disabled:!t,variant:t?"warning":"disabled",className:"w-full",icon:(0,a.jsx)(Hf,{className:"h-4 w-4"}),children:t?"Wykonaj akcj\u0119":"Niedost\u0119pne"})})]})};return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)(Hf,{className:"h-6 w-6 text-red-600 mr-2"}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Szara strefa"})]}),(0,a.jsx)("div",{className:"bg-red-100 border border-red-300 rounded-lg p-3 mb-4",children:(0,a.jsxs)("p",{className:"text-red-800 text-sm",children:[(0,a.jsx)("strong",{children:"UWAGA:"})," Dzia\u0142ania w szarej strefie s\u0105 nielegalne i wi\u0105\u017c\u0105 si\u0119 z ryzykiem. Wykrycie mo\u017ce skutkowa\u0107 karami finansowymi, utrat\u0105 reputacji, a nawet zako\u0144czeniem gry."]})}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"Tw\xf3j status:"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{className:"bg-white rounded p-2 shadow-sm",children:[(0,a.jsx)("div",{className:"text-gray-600 text-sm",children:"Sie\u0107 korupcyjna:"}),(0,a.jsxs)("div",{className:"font-medium",children:[n.illegals.corruptionNetwork,"/100"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded p-2 shadow-sm",children:[(0,a.jsx)("div",{className:"text-gray-600 text-sm",children:"Ryzyko audytu:"}),(0,a.jsxs)("div",{className:"font-medium",children:[(null===h||void 0===h?void 0:h.auditRisk)||n.illegals.auditRisk,"%"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded p-2 shadow-sm",children:[(0,a.jsx)("div",{className:"text-gray-600 text-sm",children:"Baza danych:"}),(0,a.jsx)("div",{className:"font-medium",children:n.illegals.hasIllegalDatabase?"Posiadasz":"Brak"})]}),(0,a.jsxs)("div",{className:"bg-white rounded p-2 shadow-sm",children:[(0,a.jsx)("div",{className:"text-gray-600 text-sm",children:"\u0141ap\xf3wki wydane:"}),(0,a.jsxs)("div",{className:"font-medium",children:[n.illegals.totalBribes.toLocaleString()," PLN"]})]})]})]}),n.reputationFactors&&(0,a.jsxs)("div",{className:"mb-4 bg-gray-50 p-3 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"font-bold",children:"Poziom aktywno\u015bci w szarej strefie:"}),(e=>{let t,n,r;return e<=.7?(t="bg-green-100 text-green-800",n=(0,a.jsx)(ry,{className:"h-4 w-4 text-green-600"}),r="Niski"):e<=1?(t="bg-blue-100 text-blue-800",n=(0,a.jsx)(lg,{className:"h-4 w-4 text-blue-600"}),r="Normalny"):e<=1.3?(t="bg-yellow-100 text-yellow-800",n=(0,a.jsx)(ny,{className:"h-4 w-4 text-yellow-600"}),r="Podwy\u017cszony"):(t="bg-red-100 text-red-800",n=(0,a.jsx)(Hf,{className:"h-4 w-4 text-red-600"}),r="Wysoki"),(0,a.jsxs)("div",{className:`flex items-center ${t} px-2 py-1 rounded`,children:[n,(0,a.jsx)("span",{className:"ml-1 text-sm font-medium",children:r})]})})(n.reputationFactors.grayAreaActivity)]}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full "+(n.reputationFactors.grayAreaActivity<=.7?"bg-green-500":n.reputationFactors.grayAreaActivity<=1?"bg-blue-500":n.reputationFactors.grayAreaActivity<=1.3?"bg-yellow-500":"bg-red-500"),style:{width:`${Math.min(100,50*n.reputationFactors.grayAreaActivity)}%`}})})}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Wysoki poziom aktywno\u015bci w szarej strefie zwi\u0119ksza ryzyko audytu i kontroli."})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"Dost\u0119pne akcje:"}),(0,a.jsx)("div",{className:"space-y-3",children:f.map((e=>v(e)))})]}),n.illegals.illegalActionHistory&&n.illegals.illegalActionHistory.length>0&&(0,a.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"Historia dzia\u0142a\u0144:"}),(0,a.jsx)("div",{className:"space-y-2",children:n.illegals.illegalActionHistory.slice(-5).reverse().map(((e,t)=>(0,a.jsxs)("div",{className:`p-2 rounded ${e.exposed?"bg-red-100":"bg-white"} text-sm border`,children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:m.getActionName(e.type)}),(0,a.jsx)("span",{className:"text-gray-500",children:new Date(e.date).toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"flex justify-between mt-1",children:[(0,a.jsxs)("span",{className:"text-gray-500",children:["Koszt: ",e.cost.toLocaleString()," PLN"]}),e.exposed&&(0,a.jsx)("span",{className:"text-red-600",children:"Wykryte"})]})]},t)))})]})]})},dg=Lf("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),ug=Lf("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),hg=Lf("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),pg=e=>{var t,n,r,i,s;let{staffId:o,staffType:l,onClose:c,onFire:u,onTrain:h,onAssign:p}=e;const{state:m}=d(),{state:f}=mf(),y=l.endsWith("s")?l:`${l}s`,g=null===(t=m.staff[y])||void 0===t?void 0:t.find((e=>e.id===o));if(!g)return(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("div",{className:"bg-red-100 p-4 rounded",children:(0,a.jsx)("p",{className:"text-red-800",children:"Nie znaleziono pracownika."})}),(0,a.jsx)(my,{onClick:c,className:"mt-4",children:"Zamknij"})]});const v=e=>`${e.toLocaleString()} PLN / mies.`,w=m.projects.find((e=>e.id===g.assignedProject)),x=(null===(n=g.traits)||void 0===n?void 0:n.filter((e=>e.effect>0)))||[],b=(null===(r=g.traits)||void 0===r?void 0:r.filter((e=>e.effect<0)))||[],j=(null===(i=g.traits)||void 0===i?void 0:i.filter((e=>0===e.effect)))||[],k=e=>(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:(e.effect>0?"text-green-600":e.effect<0?"text-red-600":"text-gray-600")+" font-medium mr-2",children:e.name}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:e.description})]},e.name);return(0,a.jsxs)("div",{className:"overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center mr-4",children:(0,a.jsx)(dg,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:g.name}),(0,a.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,a.jsx)(Zy,{className:"h-4 w-4 mr-1"}),(0,a.jsxs)("span",{children:[My(l)," (",Dy(g.level),")"]})]})]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("h3",{className:"font-bold text-lg mb-2 flex items-center",children:[(0,a.jsx)(ug,{className:"h-5 w-5 mr-2 text-purple-600"}),"Umiej\u0119tno\u015bci i rozw\xf3j"]}),(0,a.jsxs)("div",{className:"bg-white rounded shadow p-4",children:[(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)("span",{className:"text-gray-700",children:"Poziom umiej\u0119tno\u015bci:"}),(0,a.jsxs)("span",{className:"font-medium",children:[g.skill,"/10"]})]}),(0,a.jsx)(Ky,{value:10*g.skill,max:100,colorClass:"bg-purple-500"})]}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)("span",{className:"text-gray-700",children:"Do\u015bwiadczenie:"}),(0,a.jsxs)("span",{className:"font-medium",children:[g.experience," pkt"]})]}),(0,a.jsx)(Ky,{value:g.experience%100,max:100,colorClass:"bg-blue-500"}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:["Do awansu: ",100-g.experience%100," pkt"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-700 mb-1",children:"Specjalizacja:"}),(0,a.jsx)("div",{className:"font-medium",children:g.specialization||"Brak"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-700 mb-1",children:"Odbyte szkolenia:"}),(0,a.jsx)("div",{className:"font-medium",children:(null===(s=g.training)||void 0===s?void 0:s.length)||0})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,a.jsx)(my,{onClick:()=>h(o,l),variant:"primary",className:"flex-1",icon:(0,a.jsx)(ny,{className:"h-4 w-4"}),children:"Trenuj"}),(0,a.jsx)(my,{onClick:()=>p(o,l),variant:"secondary",className:"flex-1",icon:(0,a.jsx)(Zy,{className:"h-4 w-4"}),children:"Przydziel do projektu"})]})]}),g.traits&&g.traits.length>0&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-2",children:"Cechy charakteru"}),(0,a.jsxs)("div",{className:"bg-white rounded shadow p-4",children:[x.length>0&&(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("h4",{className:"font-medium text-green-600 mb-1",children:"Pozytywne:"}),(0,a.jsx)("div",{className:"space-y-1",children:x.map(k)})]}),j.length>0&&(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-600 mb-1",children:"Neutralne:"}),(0,a.jsx)("div",{className:"space-y-1",children:j.map(k)})]}),b.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-red-600 mb-1",children:"Negatywne:"}),(0,a.jsx)("div",{className:"space-y-1",children:b.map(k)})]})]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("h3",{className:"font-bold text-lg mb-2 flex items-center",children:[(0,a.jsx)(Uf,{className:"h-5 w-5 mr-2 text-blue-600"}),"Historia zatrudnienia"]}),(0,a.jsxs)("div",{className:"bg-white rounded shadow p-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-700 mb-1",children:"Data zatrudnienia:"}),(0,a.jsx)("div",{className:"font-medium",children:(_=g.hiredOn,new Date(_).toLocaleDateString("pl-PL"))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-700 mb-1",children:"Czas zatrudnienia:"}),(0,a.jsx)("div",{className:"font-medium",children:(()=>{const e=new Date(g.hiredOn),t=new Date,n=Math.abs(t-e),r=Math.ceil(n/864e5);return`${r} dni (${Math.floor(r/30)} miesi\u0119cy)`})()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-700 mb-1",children:"Wynagrodzenie:"}),(0,a.jsx)("div",{className:"font-medium",children:v(g.salary)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-700 mb-1",children:"Koszt zatrudnienia:"}),(0,a.jsx)("div",{className:"font-medium",children:v(g.hiringCost||0)})]})]}),w&&(0,a.jsxs)("div",{className:"mt-3 p-2 bg-blue-50 rounded",children:[(0,a.jsx)("div",{className:"text-blue-800 font-medium",children:"Przypisany do projektu:"}),(0,a.jsxs)("div",{children:[w.name," (",w.technology,")"]})]})]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("h3",{className:"font-bold text-lg mb-2 flex items-center",children:[(0,a.jsx)(hg,{className:"h-5 w-5 mr-2 text-red-600"}),"Status"]}),(0,a.jsx)("div",{className:"bg-white rounded shadow p-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)("span",{children:"Morale:"}),(0,a.jsxs)("span",{className:(z=g.morale,z>=80?"text-green-600":z>=50?"text-blue-600":z>=30?"text-yellow-600":"text-red-600"),children:[g.morale,"%"]})]}),(0,a.jsx)(Ky,{value:g.morale,max:100,colorClass:g.morale>=50?"bg-green-500":"bg-red-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)("span",{children:"Energia:"}),(0,a.jsxs)("span",{className:(N=g.energy,N>=80?"text-green-600":N>=50?"text-blue-600":N>=30?"text-yellow-600":"text-red-600"),children:[g.energy,"%"]})]}),(0,a.jsx)(Ky,{value:g.energy,max:100,colorClass:g.energy>=50?"bg-blue-500":"bg-orange-500"})]})]})})]}),(0,a.jsxs)("div",{className:"mt-6 flex justify-between",children:[(0,a.jsx)(my,{onClick:()=>u(o,l),variant:"danger",icon:(0,a.jsx)(ig,{className:"h-4 w-4"}),children:"Zwolnij pracownika"}),(0,a.jsx)(my,{onClick:c,variant:"secondary",children:"Zamknij"})]})]});var N,z,_},mg=e=>{let{onClose:t}=e;const{state:n,dispatch:i}=d(),{state:s,showNotification:o}=mf(),[l,c]=(0,r.useState)(null),[u,h]=(0,r.useState)(1e6),[p,m]=(0,r.useState)(12),f=(0,r.useRef)(null),y=e=>{f.current&&!f.current.contains(e.target)&&t()};(0,r.useEffect)((()=>(document.addEventListener("mousedown",y),()=>{document.removeEventListener("mousedown",y)})),[]);const g=e=>!(e.requiresProjects>0&&n.projects.length<e.requiresProjects)&&(!(e.requiresReputation>0&&n.reputation<e.requiresReputation)&&(!(e.requiresRTB&&!n.projects.some((e=>"ready_to_build"===e.status)))&&!(e.requiresCorruption&&n.illegals.corruptionNetwork<e.requiresCorruption))),v=e=>{let t=e.baseInterestRate;e.reputationBonus&&n.reputation>80&&(t-=.01);const r=n.projects.filter((e=>"ready_to_build"===e.status)).length;return r>0&&(t-=.005*r),Math.max(.05,t)},w=(e,t,n)=>{const r=t/12;return e*r/(1-Math.pow(1+r,-n))},x=e=>e.toLocaleString()+" PLN",b=e=>(100*e).toFixed(2)+"%";return(0,a.jsxs)("div",{ref:f,children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)(qy,{className:"h-6 w-6 text-green-600 mr-2"}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Panel finansowy"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,a.jsx)("h3",{className:"font-bold mb-3",children:"Twoje finanse"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-600 text-sm",children:"Got\xf3wka:"}),(0,a.jsx)("div",{className:"font-bold text-lg text-green-700",children:x(n.cash)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-600 text-sm",children:"Warto\u015b\u0107 projekt\xf3w:"}),(0,a.jsx)("div",{className:"font-bold text-lg",children:x(n.economicMetrics.projectsValue||0)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-600 text-sm",children:"Przychody:"}),(0,a.jsx)("div",{className:"font-bold text-green-700",children:x(n.economicMetrics.totalRevenue||0)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-600 text-sm",children:"Wydatki:"}),(0,a.jsx)("div",{className:"font-bold text-red-700",children:x(n.economicMetrics.totalExpenses||0)})]})]})]}),n.loans&&n.loans.length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,a.jsx)("h3",{className:"font-bold mb-3",children:"Aktywne kredyty"}),n.loans.map((e=>(0,a.jsxs)("div",{className:"border-b pb-3 mb-3 last:border-0 last:mb-0 last:pb-0",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,a.jsx)("span",{className:"font-medium",children:e.bankName}),(0,a.jsx)("span",{className:"text-blue-600",children:x(e.remainingAmount)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Rata miesi\u0119czna:"}),(0,a.jsx)("span",{className:"ml-1",children:x(e.monthlyPayment)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Oprocentowanie:"}),(0,a.jsx)("span",{className:"ml-1",children:b(e.interestRate)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Pozosta\u0142o rat:"}),(0,a.jsx)("span",{className:"ml-1",children:e.remainingTerm})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Nast\u0119pna p\u0142atno\u015b\u0107:"}),(0,a.jsxs)("span",{className:"ml-1",children:["Tura ",e.nextPaymentTurn]})]})]}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs mb-1",children:[(0,a.jsx)("span",{children:"Sp\u0142acono"}),(0,a.jsxs)("span",{children:[Math.round(100*(1-e.remainingAmount/e.amount)),"%"]})]}),(0,a.jsx)(Ky,{value:e.amount-e.remainingAmount,max:e.amount,colorClass:"bg-green-500"})]})]},e.id)))]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,a.jsx)("h3",{className:"font-bold mb-3",children:"Zaci\u0105gnij kredyt"}),l?(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)(gy,{className:"h-5 w-5 text-blue-600 mr-2"}),(0,a.jsx)("h4",{className:"font-bold text-blue-800 break-words",children:l.name})]}),(0,a.jsx)("p",{className:"text-sm text-gray-700 break-words",children:l.description})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-1",children:"Kwota kredytu"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"range",min:1e5,max:l.maxLoan,step:1e5,value:u,onChange:e=>h(parseInt(e.target.value)),className:"flex-grow mr-3"}),(0,a.jsx)("span",{className:"font-medium w-32 text-right",children:x(u)})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-1",children:"Okres sp\u0142aty (miesi\u0105ce)"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"range",min:3,max:36,step:3,value:p,onChange:e=>m(parseInt(e.target.value)),className:"flex-grow mr-3"}),(0,a.jsxs)("span",{className:"font-medium w-32 text-right",children:[p," mies."]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-3 rounded mb-4",children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Podsumowanie kredytu"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{className:"text-sm overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Kwota kredytu:"}),(0,a.jsx)("span",{className:"ml-1 font-medium whitespace-nowrap",children:x(u)})]}),(0,a.jsxs)("div",{className:"text-sm overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Okres sp\u0142aty:"}),(0,a.jsxs)("span",{className:"ml-1 font-medium whitespace-nowrap",children:[p," miesi\u0119cy"]})]}),(0,a.jsxs)("div",{className:"text-sm overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Oprocentowanie:"}),(0,a.jsx)("span",{className:"ml-1 font-medium whitespace-nowrap",children:b(v(l))})]}),(0,a.jsxs)("div",{className:"text-sm overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Rata miesi\u0119czna:"}),(0,a.jsx)("span",{className:"ml-1 font-medium whitespace-nowrap",children:x(w(u,v(l),p))})]}),(0,a.jsxs)("div",{className:"text-sm col-span-2 overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Ca\u0142kowity koszt kredytu:"}),(0,a.jsx)("span",{className:"ml-1 font-medium text-red-600 whitespace-nowrap",children:x(w(u,v(l),p)*p-u)})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(my,{onClick:()=>{if(!l)return void o("Wybierz bank, aby zaci\u0105gn\u0105\u0107 kredyt","error");if(!g(l))return void o("Nie spe\u0142niasz wymaga\u0144 tego banku","error");if(u>l.maxLoan)return void o(`Maksymalna kwota kredytu to ${l.maxLoan.toLocaleString()} PLN`,"error");if(n.loans&&n.loans.length>0)return void o("Mo\u017cesz mie\u0107 tylko jeden aktywny kredyt","error");const e=v(l),t=w(u,e,p),r=t*p,a=r-u;i({type:"ADD_LOAN",payload:{id:Date.now(),bankId:l.id,bankName:l.name,amount:u,remainingAmount:u,interestRate:e,term:p,remainingTerm:p,monthlyPayment:t,totalInterest:a,totalPayment:r,takenOnTurn:s.turn,nextPaymentTurn:s.turn+1}}),i({type:"UPDATE_CASH",payload:u}),i({type:"UPDATE_ECONOMIC_METRICS",payload:{totalLoansTaken:(n.economicMetrics.totalLoansTaken||0)+u}}),l.reputationPenalty&&i({type:"UPDATE_REPUTATION",payload:{change:-l.reputationPenalty,reason:`Zaci\u0105gni\u0119cie kredytu w ${l.name}`,turn:s.turn}}),o(`Zaci\u0105gni\u0119to kredyt na kwot\u0119 ${u.toLocaleString()} PLN`,"success"),c(null)},variant:"success",className:"flex-1",icon:(0,a.jsx)(Cy,{className:"h-4 w-4"}),children:"Zaci\u0105gnij kredyt"}),(0,a.jsx)(my,{onClick:()=>c(null),variant:"secondary",className:"flex-1",children:"Anuluj"})]})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-700 mb-4",children:"Wybierz bank, aby zaci\u0105gn\u0105\u0107 kredyt:"}),(0,a.jsx)("div",{className:"space-y-3",children:[{id:"eco_bank",name:"EcoBank",description:"Bank specjalizuj\u0105cy si\u0119 w finansowaniu projekt\xf3w OZE",maxLoan:5e6,baseInterestRate:.08,reputationBonus:!0,requirementsDescription:"Wymaga min. 3 projekt\xf3w i reputacji > 70",requiresProjects:3,requiresReputation:70},{id:"investment_bank",name:"InvestBank",description:"Du\u017cy bank komercyjny z programem dla projekt\xf3w energetycznych",maxLoan:1e7,baseInterestRate:.095,reputationBonus:!0,requirementsDescription:"Wymaga min. 5 projekt\xf3w i reputacji > 50, lub projektu RTB",requiresProjects:5,requiresReputation:50,requiresRTB:!0},{id:"small_bank",name:"LocalBank",description:"Mniejszy bank lokalny, mniej wymagaj\u0105cy, ale dro\u017csza oferta",maxLoan:2e6,baseInterestRate:.12,reputationBonus:!1,requirementsDescription:"Brak szczeg\xf3lnych wymaga\u0144",requiresProjects:0,requiresReputation:0},{id:"shadow_bank",name:"ShadowFinance",description:"Nieoficjalne \u017ar\xf3d\u0142o finansowania, wysokie odsetki, brak formalno\u015bci",maxLoan:15e5,baseInterestRate:.25,reputationBonus:!1,reputationPenalty:5,requirementsDescription:"Wymaga poziomu sieci korupcyjnej > 20",requiresCorruption:20}].map((e=>{const t=g(e),n=v(e);return(0,a.jsx)("div",{className:"border rounded-lg p-4 mb-4 hover:shadow-md transition-shadow "+((null===l||void 0===l?void 0:l.id)===e.id?"border-blue-500 bg-blue-50":""),onClick:()=>t&&c(e),children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"mr-3",children:(0,a.jsx)(gy,{className:"h-6 w-6 "+(t?"text-blue-600":"text-gray-400")})}),(0,a.jsxs)("div",{className:"flex-grow overflow-hidden",children:[(0,a.jsx)("h3",{className:`font-bold ${t?"text-gray-800":"text-gray-500"} text-ellipsis overflow-hidden`,children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600 break-words",children:e.description}),(0,a.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[(0,a.jsxs)("div",{className:"overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Max kredyt:"}),(0,a.jsx)("span",{className:"ml-1 font-medium whitespace-nowrap",children:x(e.maxLoan)})]}),(0,a.jsxs)("div",{className:"overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Oprocentowanie:"}),(0,a.jsx)("span",{className:`ml-1 font-medium ${n>.15?"text-red-600":"text-blue-600"} whitespace-nowrap`,children:b(n)})]})]}),(0,a.jsxs)("div",{className:"mt-1 text-sm overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Wymagania:"}),(0,a.jsx)("span",{className:`ml-1 ${t?"text-green-600":"text-red-600"} break-words`,children:t?"Spe\u0142nione":e.requirementsDescription})]})]})]})},e.id)}))})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,a.jsxs)("h3",{className:"font-bold mb-3 flex items-center",children:[(0,a.jsx)(Gf,{className:"h-5 w-5 mr-2 text-purple-600"}),"Statystyki finansowe"]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between p-2 bg-gray-50 rounded",children:[(0,a.jsx)("span",{className:"text-gray-700",children:"\u0141\u0105czne inwestycje:"}),(0,a.jsx)("span",{className:"font-medium",children:x(n.economicMetrics.totalInvestment||0)})]}),(0,a.jsxs)("div",{className:"flex justify-between p-2 bg-gray-50 rounded",children:[(0,a.jsx)("span",{className:"text-gray-700",children:"\u0141\u0105czne kredyty:"}),(0,a.jsx)("span",{className:"font-medium",children:x(n.economicMetrics.totalLoansTaken||0)})]}),(0,a.jsxs)("div",{className:"flex justify-between p-2 bg-gray-50 rounded",children:[(0,a.jsx)("span",{className:"text-gray-700",children:"\u015aredni ROI:"}),(0,a.jsxs)("span",{className:"font-medium "+((n.economicMetrics.avgROI||0)>0?"text-green-600":"text-red-600"),children:[(100*(n.economicMetrics.avgROI||0)).toFixed(1),"%"]})]}),(0,a.jsxs)("div",{className:"flex justify-between p-2 bg-gray-50 rounded",children:[(0,a.jsx)("span",{className:"text-gray-700",children:"Bilans:"}),(0,a.jsx)("span",{className:"font-medium "+((n.economicMetrics.totalRevenue||0)>(n.economicMetrics.totalExpenses||0)?"text-green-600":"text-red-600"),children:x((n.economicMetrics.totalRevenue||0)-(n.economicMetrics.totalExpenses||0))})]})]})]})]})},fg=Lf("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),yg=Lf("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),gg=e=>{var t;let{staffManagement:n,gameState:i,playerState:s}=e;const[o,l]=(0,r.useState)(null),[c,d]=(0,r.useState)("junior"),[u,h]=(0,r.useState)(""),[p,m]=(0,r.useState)("all"),f=[{id:"scouts",name:"Skauci",icon:(0,a.jsx)(Kf,{className:"h-4 w-4"}),description:"Zajmuj\u0105 si\u0119 pozyskiwaniem grunt\xf3w pod projekty OZE. Niezb\u0119dni do rozpocz\u0119cia nowych projekt\xf3w."},{id:"developers",name:"Developerzy",icon:(0,a.jsx)(Zy,{className:"h-4 w-4"}),description:"Prowadz\u0105 projekty OZE od pozyskanej ziemi do RTB. Ka\u017cdy developer mo\u017ce prowadzi\u0107 maksymalnie 5 projekt\xf3w."},{id:"lawyers",name:"Prawnicy",icon:(0,a.jsx)(hy,{className:"h-4 w-4"}),description:"Specjalizuj\u0105 si\u0119 w kwestiach prawnych i pozwoleniach. Przyspieszaj\u0105 rozw\xf3j wszystkich projekt\xf3w."},{id:"envSpecialists",name:"Specjali\u015bci ds. \u015brodowiska",icon:(0,a.jsx)(hy,{className:"h-4 w-4"}),description:"Eksperci od ocen oddzia\u0142ywania na \u015brodowisko. Przyspieszaj\u0105 rozw\xf3j wszystkich projekt\xf3w."},{id:"lobbyists",name:"Lobby\u015bci",icon:(0,a.jsx)(hy,{className:"h-4 w-4"}),description:"Pomagaj\u0105 uzyska\u0107 przychylno\u015b\u0107 w\u0142adz lokalnych i krajowych. Mog\u0105 by\u0107 r\u0119cznie przypisywani do projekt\xf3w dla dodatkowego przyspieszenia."}],y=[{id:"junior",name:"Junior",cost:1,description:"Pocz\u0105tkuj\u0105cy specjali\u015bci z podstawowymi umiej\u0119tno\u015bciami. Ta\u0144si, ale mniej efektywni."},{id:"mid",name:"Mid",cost:1.5,description:"Specjali\u015bci ze \u015brednim do\u015bwiadczeniem. Dobry balans mi\u0119dzy kosztem a efektywno\u015bci\u0105."},{id:"senior",name:"Senior",cost:2.5,description:"Eksperci z wieloletnim do\u015bwiadczeniem. Drodzy, ale bardzo efektywni."}],g=()=>f.filter((e=>{if("all"!==p&&e.id!==p)return!1;if(u){const t=u.toLowerCase();return e.name.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)}return!0})),v=(e,t)=>{const n={scout:15e3,developer:25e3,lawyer:3e4,envSpecialist:2e4,lobbyist:4e4}[e.endsWith("s")?e.slice(0,-1):e]||2e4,r={junior:1,mid:1.5,senior:2.2}[t]||1;return Math.round(n*r)},w=(e,t)=>s.cash>=v(e,t);return(0,a.jsxs)("div",{className:"employment-center",children:[(0,a.jsxs)("div",{className:"employment-header",children:[(0,a.jsx)("h2",{children:"Centrum Zatrudnienia"}),(0,a.jsx)("p",{children:"Zatrudnij nowych pracownik\xf3w, aby rozwija\u0107 projekty OZE. Ka\u017cdy typ specjalisty ma swoj\u0105 rol\u0119 w procesie rozwoju projekt\xf3w."})]}),(0,a.jsxs)("div",{className:"employment-filters",children:[(0,a.jsxs)("div",{className:"filter-group",children:[(0,a.jsxs)("div",{className:"filter-label",children:[(0,a.jsx)(fg,{className:"h-4 w-4 mr-1"}),(0,a.jsx)("span",{children:"Filtruj:"})]}),(0,a.jsxs)("select",{value:p,onChange:e=>m(e.target.value),className:"filter-select",children:[(0,a.jsx)("option",{value:"all",children:"Wszyscy specjali\u015bci"}),f.map((e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,a.jsxs)("div",{className:"search-group",children:[(0,a.jsx)(yg,{className:"search-icon"}),(0,a.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),placeholder:"Szukaj specjalist\xf3w...",className:"search-input"})]})]}),(0,a.jsxs)("div",{className:"staff-types-grid",children:[g().map((e=>{var t;e.id.endsWith("s")?e.id.slice(0,-1):e.id;const n=o===e.id;return(0,a.jsxs)("div",{className:"staff-type-card "+(n?"selected":""),onClick:()=>l(e.id),children:[(0,a.jsx)("div",{className:"staff-type-icon",children:e.icon}),(0,a.jsxs)("div",{className:"staff-type-content",children:[(0,a.jsx)("h3",{children:e.name}),(0,a.jsx)("p",{children:e.description})]}),(0,a.jsxs)("div",{className:"staff-current-count",children:[(0,a.jsx)(dg,{className:"h-4 w-4 mr-1"}),(0,a.jsxs)("span",{children:[(null===(t=s.staff[e.id])||void 0===t?void 0:t.length)||0," zatrudnionych"]})]})]},e.id)})),0===g().length&&(0,a.jsx)("div",{className:"no-results",children:(0,a.jsx)("p",{children:"Nie znaleziono specjalist\xf3w spe\u0142niaj\u0105cych kryteria wyszukiwania."})})]}),o&&(0,a.jsxs)("div",{className:"hiring-panel",children:[(0,a.jsxs)("h3",{children:["Zatrudnij: ",My(o)]}),(0,a.jsxs)("div",{className:"level-selection",children:[(0,a.jsx)("div",{className:"level-options",children:y.map((e=>(0,a.jsx)("button",{className:"level-option "+(c===e.id?"selected":""),onClick:()=>d(e.id),children:e.name},e.id)))}),(0,a.jsx)("div",{className:"level-description",children:(0,a.jsx)("p",{children:null===(t=y.find((e=>e.id===c)))||void 0===t?void 0:t.description})})]}),(0,a.jsxs)("div",{className:"hiring-costs",children:[(0,a.jsxs)("div",{className:"cost-item",children:[(0,a.jsx)("span",{children:"Koszt zatrudnienia:"}),(0,a.jsxs)("span",{className:"cost-value",children:[v(o,c).toLocaleString()," PLN"]})]}),(0,a.jsxs)("div",{className:"cost-item",children:[(0,a.jsx)("span",{children:"Miesi\u0119czne wynagrodzenie:"}),(0,a.jsxs)("span",{className:"cost-value",children:[(x=o,b=c,Math.round(.04*v(x,b))).toLocaleString()," PLN"]})]})]}),(0,a.jsxs)("div",{className:"hiring-actions",children:[(0,a.jsx)("button",{className:"cancel-btn",onClick:()=>l(null),children:"Anuluj"}),(0,a.jsx)("button",{className:"hire-btn",disabled:!w(o,c),onClick:()=>{if(!o||!c)return;const e=o.endsWith("s")?o.slice(0,-1):o;n.hireStaff(e,c),l(null)},children:w(o,c)?"Zatrudnij":"Brak \u015brodk\xf3w"})]})]})]});var x,b},vg=(0,r.createContext)(null),wg={didCatch:!1,error:null};class xg extends r.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=wg}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(null!==e){for(var t,n,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];null===(t=(n=this.props).onReset)||void 0===t||t.call(n,{args:i,reason:"imperative-api"}),this.setState(wg)}}componentDidCatch(e,t){var n,r;null===(n=(r=this.props).onError)||void 0===n||n.call(r,e,t)}componentDidUpdate(e,t){const{didCatch:n}=this.state,{resetKeys:r}=this.props;var i,a;n&&null!==t.error&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.length!==t.length||e.some(((e,n)=>!Object.is(e,t[n])))}(e.resetKeys,r)&&(null===(i=(a=this.props).onReset)||void 0===i||i.call(a,{next:r,prev:e.resetKeys,reason:"keys"}),this.setState(wg))}render(){const{children:e,fallbackRender:t,FallbackComponent:n,fallback:i}=this.props,{didCatch:a,error:s}=this.state;let o=e;if(a){const e={error:s,resetErrorBoundary:this.resetErrorBoundary};if("function"===typeof t)o=t(e);else if(n)o=(0,r.createElement)(n,e);else{if(void 0===i)throw s;o=i}}return(0,r.createElement)(vg.Provider,{value:{didCatch:a,error:s,resetErrorBoundary:this.resetErrorBoundary}},o)}}const bg=e=>{let{staff:t,onFire:n,onTrain:r,onAssign:i,onDetails:s}=e;if(!t)return null;const o=e=>e>=75?"staff-morale-high":e>=40?"staff-morale-medium":"staff-morale-low",l=e=>e>=75?"staff-energy-high":e>=40?"staff-energy-medium":"staff-energy-low",c=e=>{switch(e){case"pracowity":return(0,a.jsx)(Hy,{size:14,className:"text-yellow-500"});case"kreatywny":return(0,a.jsx)(ug,{size:14,className:"text-blue-500"});case"dok\u0142adny":return(0,a.jsx)(hy,{size:14,className:"text-purple-500"});case"konfliktowy":return(0,a.jsx)(hg,{size:14,className:"text-red-500"});default:return null}};return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-200 hover:shadow-lg transition-shadow",children:[(0,a.jsxs)("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200 flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center "+("senior"===t.level?"bg-purple-100":"mid"===t.level?"bg-blue-100":"bg-green-100"),children:(0,a.jsx)("span",{className:"text-sm font-bold",children:t.name?t.name[0]:"P"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:t.name||"Pracownik"}),(0,a.jsxs)("p",{className:"text-xs text-gray-600",children:["scout"===t.type?"Pozyskiwacz":"developer"===t.type?"Developer":"lobbyist"===t.type?"Lobbysta":"Specjalista"," \u2022 ","junior"===t.level?"Pocz\u0105tkuj\u0105cy":"mid"===t.level?"Do\u015bwiadczony":"Ekspert"]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Pensja"}),(0,a.jsx)("div",{className:"text-sm font-medium",children:(d=t.salary||0,`${(d/1e3).toFixed(1)}k PLN`)})]})]}),(0,a.jsxs)("div",{className:"px-4 py-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(hy,{className:"h-4 w-4 text-blue-500 mr-1"}),(0,a.jsxs)("div",{className:"text-xs text-gray-700",children:["Umiej\u0119tno\u015b\u0107: ",(0,a.jsxs)("span",{className:"font-medium",children:[t.skill||0,"/10"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(Zy,{className:"h-4 w-4 text-gray-500 mr-1"}),(0,a.jsxs)("div",{className:"text-xs text-gray-700",children:["Do\u015bwiadczenie: ",(0,a.jsxs)("span",{className:"font-medium",children:[Math.floor((t.experience||0)/365)," lat"]})]})]})]}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[(0,a.jsx)("span",{children:"Rozw\xf3j kariery"}),(0,a.jsx)("span",{children:"junior"===t.level?"Junior \u2192 Mid":"mid"===t.level?"Mid \u2192 Senior":"Senior"})]}),(0,a.jsx)(Ky,{value:(()=>{const e={junior:0,mid:1,senior:2}[t.level]||0,n=e<2?e+1:2;if(2===e)return 100;const r=[0,3e3,8e3],i=t.experience||0,a=r[e],s=(i-a)/(r[n]-a)*100;return Math.min(100,Math.max(0,s))})(),status:"senior"===t.level?"high":"medium"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(hg,{className:`h-4 w-4 mr-1 ${o(t.morale||0)}`}),(0,a.jsx)("span",{className:"text-xs text-gray-600",children:"Morale"})]}),(0,a.jsxs)("span",{className:`text-xs font-medium ${o(t.morale||0)}`,children:[t.morale||0,"%"]})]}),(0,a.jsx)(Ky,{value:t.morale||0,status:t.morale>=75?"high":t.morale>=40?"medium":"low"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)($y,{className:`h-4 w-4 mr-1 ${l(t.energy||0)}`}),(0,a.jsx)("span",{className:"text-xs text-gray-600",children:"Energia"})]}),(0,a.jsxs)("span",{className:`text-xs font-medium ${l(t.energy||0)}`,children:[t.energy||0,"%"]})]}),(0,a.jsx)(Ky,{value:t.energy||0,status:t.energy>=75?"high":t.energy>=40?"medium":"low"})]})]}),t.traits&&t.traits.length>0&&(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"Cechy charakteru"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:t.traits.map(((e,t)=>(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-800",children:[c(e),(0,a.jsx)("span",{className:"ml-1 capitalize",children:e})]},t)))})]}),(0,a.jsxs)("div",{className:"flex space-x-2 mt-3",children:[(0,a.jsx)("button",{onClick:()=>s&&s(t),className:"flex-1 text-xs py-1 px-2 bg-blue-50 text-blue-600 rounded border border-blue-200 hover:bg-blue-100 transition-colors",children:"Szczeg\xf3\u0142y"}),(0,a.jsx)("button",{onClick:()=>r&&r(t),className:"flex-1 text-xs py-1 px-2 bg-green-50 text-green-600 rounded border border-green-200 hover:bg-green-100 transition-colors",children:"Szkolenie"}),"developer"===t.type&&!t.assignedProject&&i&&(0,a.jsx)("button",{onClick:()=>i&&i(t),className:"flex-1 text-xs py-1 px-2 bg-purple-50 text-purple-600 rounded border border-purple-200 hover:bg-purple-100 transition-colors",children:"Przypisz"}),(0,a.jsx)("button",{onClick:()=>n&&n(t),className:"flex-1 text-xs py-1 px-2 bg-red-50 text-red-600 rounded border border-red-200 hover:bg-red-100 transition-colors",children:"Zwolnij"})]})]})]});var d},jg=[{id:"pracowity",label:"Pracowity",description:"+15% wydajno\u015b\u0107, -10% zm\u0119czenie",effects:{efficiency:.15,energyLoss:-.1}},{id:"kreatywny",label:"Kreatywny",description:"+20% szansa na innowacje",effects:{innovationChance:.2}},{id:"charyzmatyczny",label:"Charyzmatyczny",description:"+15% negocjacje, +10% relacje",effects:{negotiation:.15,relations:.1}},{id:"dokladny",label:"Dok\u0142adny",description:"-30% ryzyko b\u0142\u0119d\xf3w, +10% czas",effects:{errorRisk:-.3,timeNeeded:.1}},{id:"ambitny",label:"Ambitny",description:"+25% praca po godzinach, szybszy rozw\xf3j",effects:{workOvertime:.25,careerGrowth:.15}},{id:"analityczny",label:"Analityczny",description:"+20% rozwi\u0105zywanie problem\xf3w",effects:{problemSolving:.2}},{id:"optymista",label:"Optymista",description:"+15% morale, -10% stres",effects:{moraleGain:.15,stressGain:-.1}},{id:"lojalny",label:"Lojalny",description:"-50% szansa odej\u015bcia, +15% morale przy d\u0142ugim sta\u017cu",effects:{leaveChance:-.5,longTermMorale:.15}}],kg=[{id:"perfekcjonista",label:"Perfekcjonista",description:"+30% jako\u015b\u0107, +20% czas",effects:{quality:.3,timeNeeded:.2}},{id:"indywidualista",label:"Indywidualista",description:"+10% solo, -15% zesp\xf3\u0142",effects:{soloWork:.1,teamWork:-.15}},{id:"ryzykant",label:"Ryzykant",description:"+25% szansa przyspieszenia, +15% b\u0142\u0119dy",effects:{speedBoost:.25,errorRisk:.15}},{id:"tradycjonalista",label:"Tradycjonalista",description:"-20% adaptacja do zmian, +15% standardowe procedury",effects:{adaptability:-.2,standardProcedures:.15}}],Ng=[{id:"konfliktowy",label:"Konfliktowy",description:"-20% relacje, ryzyko spor\xf3w",effects:{relations:-.2,conflictRisk:.3}},{id:"prokrastynator",label:"Prokrastynator",description:"+25% op\xf3\u017anienia, -15% wydajno\u015b\u0107",effects:{delayRisk:.25,efficiency:-.15}},{id:"wypalony",label:"Wypalony",description:"-25% wydajno\u015b\u0107, -20% morale",effects:{efficiency:-.25,morale:-.2}},{id:"chaotyczny",label:"Chaotyczny",description:"-15% organizacja, +10% kreatywno\u015b\u0107",effects:{organization:-.15,creativity:.1}},{id:"pesymista",label:"Pesymista",description:"-15% morale zespo\u0142u, cz\u0119stsze zg\u0142aszanie problem\xf3w",effects:{teamMorale:-.15,problemReporting:.2}},{id:"niecierpliwy",label:"Niecierpliwy",description:"-20% zadania d\u0142ugoterminowe, +10% kr\xf3tkie zadania",effects:{longTasks:-.2,shortTasks:.1}}],zg=e=>{let{staff:t,onClose:n,onFire:i,onTrain:s}=e;if(!t)return null;const o=(0,r.useRef)(null),l=e=>{o.current&&!o.current.contains(e.target)&&n()};(0,r.useEffect)((()=>(document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)})),[]);const c=e=>{if(!e)return"-";try{return new Date(e).toLocaleDateString("pl-PL",{day:"2-digit",month:"2-digit",year:"numeric"})}catch(t){return e}},d=e=>e>=80?{text:"Doskona\u0142e",status:"high"}:e>=60?{text:"Dobre",status:"high"}:e>=40?{text:"Neutralne",status:"medium"}:e>=20?{text:"S\u0142abe",status:"low"}:{text:"Krytyczne",status:"low"},u=e=>e>=80?{text:"Pe\u0142na",status:"high"}:e>=60?{text:"Wysoka",status:"high"}:e>=40?{text:"\u015arednia",status:"medium"}:e>=20?{text:"Niska",status:"low"}:{text:"Wyczerpanie",status:"low"},h=e=>jg.some((t=>t.id===e))?"bg-green-100 text-green-800 border-green-200":Ng.some((t=>t.id===e))?"bg-red-100 text-red-800 border-red-200":"bg-blue-100 text-blue-800 border-blue-200";return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{ref:o,className:"bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex items-center overflow-hidden",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0",children:(0,a.jsx)(dg,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsxs)("div",{className:"overflow-hidden",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-ellipsis overflow-hidden",children:t.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 whitespace-nowrap text-ellipsis overflow-hidden",children:["scout"===t.type?"Pozyskiwacz":"developer"===t.type?"Developer":"lobbyist"===t.type?"Lobbysta":"lawyer"===t.type?"Prawnik":"envSpecialist"===t.type?"Specjalista \u015brodowiskowy":"Pracownik"," \u2022 ","junior"===t.level?"Pocz\u0105tkuj\u0105cy":"mid"===t.level?"Do\u015bwiadczony":"Ekspert"]})]})]}),(0,a.jsx)("button",{onClick:n,className:"h-8 w-8 rounded-full flex items-center justify-center hover:bg-gray-200 flex-shrink-0",children:(0,a.jsx)(vy,{className:"h-5 w-5 text-gray-500"})})]}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"md:col-span-2 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,a.jsx)(dg,{className:"h-5 w-5 mr-2 text-blue-500"}),"Informacje podstawowe"]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"overflow-hidden",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Data zatrudnienia"}),(0,a.jsx)("div",{className:"font-medium whitespace-nowrap",children:c(t.hiredOn)})]}),(0,a.jsxs)("div",{className:"overflow-hidden",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Czas zatrudnienia"}),(0,a.jsx)("div",{className:"font-medium whitespace-nowrap",children:(()=>{if(!t.hiredOn)return"-";const e=new Date(t.hiredOn),n=new Date,r=Math.abs(n-e),i=Math.ceil(r/864e5);if(i<30)return`${i} dni`;if(i<365){return`${Math.floor(i/30)} mies.`}{const e=Math.floor(i/365),t=Math.floor(i%365/30);return`${e} lat${t>0?`, ${t} mies.`:""}`}})()})]}),(0,a.jsxs)("div",{className:"overflow-hidden",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Wynagrodzenie"}),(0,a.jsx)("div",{className:"font-medium whitespace-nowrap",children:(p=t.salary||0,`${p.toLocaleString()} PLN`)})]}),(0,a.jsxs)("div",{className:"overflow-hidden",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Specjalizacja"}),(0,a.jsx)("div",{className:"font-medium text-ellipsis overflow-hidden",children:t.specialization||"-"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,a.jsx)(hy,{className:"h-5 w-5 mr-2 text-blue-500"}),"Umiej\u0119tno\u015bci i rozw\xf3j"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)("span",{className:"text-sm",children:"Umiej\u0119tno\u015b\u0107 podstawowa"}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:[t.skill||0,"/10"]})]}),(0,a.jsx)(Ky,{value:10*(t.skill||0),status:(t.skill||0)>=7?"high":(t.skill||0)>=4?"medium":"low"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)("span",{className:"text-sm",children:"Do\u015bwiadczenie"}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:[t.experience||0," pkt"]})]}),(0,a.jsx)(Ky,{value:"senior"===t.level?100:"mid"===t.level?(t.experience-3e3)/5e3*100:t.experience/3e3*100,status:"medium"}),(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"junior"===t.level?"Do awansu na poziom Do\u015bwiadczony":"mid"===t.level?"Do awansu na poziom Ekspert":"Najwy\u017cszy poziom do\u015bwiadczenia"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,a.jsx)(ug,{className:"h-5 w-5 mr-2 text-blue-500"}),"Cechy charakteru"]}),t.traits&&t.traits.length>0?(0,a.jsx)("div",{className:"space-y-3",children:t.traits.map((e=>{const t=(e=>[...jg,...kg,...Ng].find((t=>t.id===e))||{label:e,description:""})(e);return(0,a.jsxs)("div",{className:`p-2 rounded border ${h(e)} break-words`,children:[(0,a.jsx)("div",{className:"font-medium",children:t.label||e}),(0,a.jsx)("div",{className:"text-sm",children:t.description})]},e)}))}):(0,a.jsx)("p",{className:"text-gray-500 italic",children:"Brak zdefiniowanych cech"})]}),t.historia&&t.historia.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,a.jsx)(Ff,{className:"h-5 w-5 mr-2 text-blue-500"}),"Historia pracownika"]}),(0,a.jsx)("div",{className:"border rounded divide-y",children:t.historia.map(((e,t)=>(0,a.jsx)("div",{className:"p-3",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("div",{className:"font-medium",children:e.opis}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:c(e.data)})]})},t)))})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[(0,a.jsx)("h3",{className:"text-lg font-bold mb-3",children:"Status"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsxs)("span",{className:"text-sm flex items-center",children:[(0,a.jsx)(hg,{className:"h-4 w-4 mr-1 text-red-500"}),"Morale"]}),(0,a.jsx)("span",{className:"text-sm font-medium "+("high"===d(t.morale||0).status?"text-green-600":"medium"===d(t.morale||0).status?"text-yellow-600":"text-red-600"),children:d(t.morale||0).text})]}),(0,a.jsx)(Ky,{value:t.morale||0,status:d(t.morale||0).status})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsxs)("span",{className:"text-sm flex items-center",children:[(0,a.jsx)($y,{className:"h-4 w-4 mr-1 text-green-500"}),"Energia"]}),(0,a.jsx)("span",{className:"text-sm font-medium "+("high"===u(t.energy||0).status?"text-green-600":"medium"===u(t.energy||0).status?"text-yellow-600":"text-red-600"),children:u(t.energy||0).text})]}),(0,a.jsx)(Ky,{value:t.energy||0,status:u(t.energy||0).status})]})]}),t.potrzeby&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h4",{className:"font-medium text-sm mb-2",children:"Potrzeby"}),(0,a.jsx)("div",{className:"space-y-2",children:Object.entries(t.potrzeby).map((e=>{let[t,n]=e,r="";switch(t){case"uznanie":r="Uznanie";break;case"rozwoj":r="Rozw\xf3j";break;case"stabilizacja":r="Stabilizacja";break;case"autonomia":r="Autonomia";break;case"relacjeSpoleczne":r="Relacje";break;default:r=t}return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)("span",{className:"text-xs",children:r}),(0,a.jsxs)("span",{className:"text-xs font-medium",children:[n,"/100"]})]}),(0,a.jsx)("div",{className:"w-full h-1 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full "+(n>=70?"bg-green-500":n>=40?"bg-yellow-500":"bg-red-500"),style:{width:`${n}%`}})})]},t)}))})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[(0,a.jsx)("h3",{className:"text-md font-bold mb-3",children:"Przypisane projekty"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 italic",children:"Brak przypisanych projekt\xf3w"})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[(0,a.jsx)("h3",{className:"text-md font-bold mb-3",children:"Akcje"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("button",{onClick:()=>s&&s(t),className:"w-full flex items-center justify-center py-2 px-4 bg-blue-100 text-blue-700 rounded border border-blue-200 hover:bg-blue-200",children:[(0,a.jsx)(hy,{className:"h-4 w-4 mr-2"}),"Wy\u015blij na szkolenie"]}),(0,a.jsxs)("button",{onClick:()=>i&&i(t),className:"w-full flex items-center justify-center py-2 px-4 bg-red-100 text-red-700 rounded border border-red-200 hover:bg-red-200",children:[(0,a.jsx)(vy,{className:"h-4 w-4 mr-2"}),"Zwolnij pracownika"]})]})]})]})]})})]})});var p},_g=()=>{const{state:e}=d();return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mt-6",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-2",children:"Reputacja firmy"}),(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mr-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${e.reputation||50}%`}})}),(0,a.jsxs)("span",{className:"font-medium "+(t=e.reputation||50,t>=80?"text-green-500":t>=60?"text-blue-500":t>=40?"text-yellow-500":t>=20?"text-orange-500":"text-red-500"),children:[e.reputation||50,"%"]})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-700",children:["Poziom: ",(0,a.jsx)("span",{className:"font-medium",children:(e=>e>=80?"Doskona\u0142a":e>=60?"Dobra":e>=40?"Przeci\u0119tna":e>=20?"S\u0142aba":"Bardzo s\u0142aba")(e.reputation||50)})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Reputacja wp\u0142ywa na negocjacje, sukces projekt\xf3w i relacje z interesariuszami"})]});var t},Eg=()=>{const{state:e,dispatch:t}=d(),{state:n,showNotification:i}=mf(),s=Ly(),[o,l]=(0,r.useState)("all"),[c,u]=(0,r.useState)("all"),[h,p]=(0,r.useState)(""),[m,f]=(0,r.useState)("skill"),[y,g]=(0,r.useState)("desc"),[v,w]=(0,r.useState)(null),[x,b]=(0,r.useState)(!1),[j,k]=(0,r.useState)(!1),[N,z]=(0,r.useState)(!1),[_,E]=(0,r.useState)(null),S=()=>{try{const t=[];return e&&e.staff?(Object.entries(e.staff).forEach((e=>{let[n,r]=e;r&&Array.isArray(r)&&r.length>0&&r.forEach((e=>{e&&e.id&&t.push({...e,staffCategory:n.replace(/s$/,"")})}))})),t):(console.error("Brak danych o kadrach"),[])}catch(t){return console.error("B\u0142\u0105d podczas pobierania listy pracownik\xf3w:",t),[]}},C=()=>{let e=S();if("all"!==o&&(e=e.filter((e=>e.staffCategory===o||e.type===o))),"all"!==c&&(e=e.filter((e=>e.level===c))),h){const t=h.toLowerCase();e=e.filter((e=>e.name.toLowerCase().includes(t)||e.specialization&&e.specialization.toLowerCase().includes(t)))}return e.sort(((e,t)=>{let n=0;switch(m){case"name":n=e.name.localeCompare(t.name);break;case"skill":n=(t.skill||0)-(e.skill||0);break;case"experience":n=(t.experience||0)-(e.experience||0);break;case"salary":n=(t.salary||0)-(e.salary||0);break;case"morale":n=(t.morale||0)-(e.morale||0);break;case"energy":n=(t.energy||0)-(e.energy||0);break;default:n=0}return"asc"===y?-n:n})),e},T=(e,t)=>{try{if(!e||!["scout","developer","lawyer","envSpecialist","lobbyist"].includes(e))return void i("Nieprawid\u0142owy typ pracownika.","error");if(!t||!["junior","mid","senior"].includes(t))return void i("Nieprawid\u0142owy poziom pracownika.","error");if(!s||"function"!==typeof s.hireStaff)return void i("System zarz\u0105dzania personelem jest niedost\u0119pny.","error");s.hireStaff(e,t)||console.log(`Nie uda\u0142o si\u0119 zatrudni\u0107 pracownika typu ${e}, poziom ${t}`)}catch(n){console.error("Wyst\u0105pi\u0142 b\u0142\u0105d podczas zatrudniania pracownika:",n),i("Wyst\u0105pi\u0142 nieoczekiwany b\u0142\u0105d podczas zatrudniania. Spr\xf3buj ponownie.","error")}},P=(e,t,n)=>{try{if(!e||!["scout","developer","lawyer","envSpecialist","lobbyist"].includes(e))return void i("Nieprawid\u0142owy typ pracownika.","error");if(!t||!["junior","mid","senior"].includes(t))return void i("Nieprawid\u0142owy poziom pracownika.","error");if(!n||n<=0||n>10)return void i("Nieprawid\u0142owa liczba pracownik\xf3w do zatrudnienia.","error");if(!s||"function"!==typeof s.hireStaff)return void i("System zarz\u0105dzania personelem jest niedost\u0119pny.","error");let r=0,a=0;for(let i=0;i<n;i++){if(!s.hireStaff(e,t)){a++;break}r++}r>0&&i(`Zatrudniono ${r} nowych pracownik\xf3w typu ${e}`,"success"),a>0&&i(`Nie uda\u0142o si\u0119 zatrudni\u0107 ${a} pracownik\xf3w`,"warning")}catch(r){console.error("Wyst\u0105pi\u0142 b\u0142\u0105d podczas masowego zatrudniania pracownik\xf3w:",r),i("Wyst\u0105pi\u0142 nieoczekiwany b\u0142\u0105d podczas zatrudniania. Spr\xf3buj ponownie.","error")}},I=e=>{event.preventDefault(),event.stopPropagation(),s.fireStaff(e.staffCategory,e.id),i(`Pracownik ${e.name} zosta\u0142 zwolniony`,"success")},A=t=>{event.preventDefault(),event.stopPropagation();const n=s.calculateTrainingCost(t,"standard");if(e.cash<n)return void i(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w na szkolenie (${n.toLocaleString()} PLN)`,"error");s.trainStaff(t.staffCategory,t.id,"standard")&&i(`Pracownik ${t.name} zosta\u0142 wys\u0142any na szkolenie`,"success")},M=e=>{event.preventDefault(),event.stopPropagation(),w(e),b(!0)},D={scouts:C().filter((e=>"scout"===e.staffCategory)),developers:C().filter((e=>"developer"===e.staffCategory)),specialists:C().filter((e=>"scout"!==e.staffCategory&&"developer"!==e.staffCategory))},R=(()=>{const e=S(),t=e.filter((e=>"scout"===e.staffCategory)).length,n=e.filter((e=>"developer"===e.staffCategory)).length,r=e.filter((e=>"scout"!==e.staffCategory&&"developer"!==e.staffCategory)).length,i=e.reduce(((e,t)=>e+(t.salary||0)),0),a=e.length>0?e.reduce(((e,t)=>e+(t.skill||0)),0)/e.length:0,s=e.length>0?e.reduce(((e,t)=>e+(t.morale||0)),0)/e.length:0,o=e.length>0?e.reduce(((e,t)=>e+(t.energy||0)),0)/e.length:0;return{totalCount:e.length,scoutCount:t,developerCount:n,specialistCount:r,totalSalaries:i,avgSkill:a,avgMorale:s,avgEnergy:o}})(),O=e=>{event.preventDefault(),event.stopPropagation();0!==s.findProjectsWaitingForDeveloper().length?(E(e),z(!0)):i("Brak projekt\xf3w oczekuj\u0105cych na przypisanie developera.","warning")};(0,r.useCallback)(((e,t,n)=>{if(!e||!t||!n)return;const r=e.lastReputationUpdate||0,i=t.turn||0;if(r>=i)return;const a=t.daysPerTurn||2,s=i*a;let o=0;for(let l=r*a+1;l<=s;l++)l%2===0&&o++;o>0&&n({type:"UPDATE_REPUTATION_INITIATIVES",payload:{daysPassed:2*o,turn:t.turn}})}),[]);return(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Zarz\u0105dzanie Kadrami"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Zarz\u0105dzaj swoimi pracownikami, zatrudniaj nowych, szkolenia i przydzielaj do projekt\xf3w."}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 border-l-4 border-blue-500",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"\u0141\u0105czna liczba pracownik\xf3w"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:R.totalCount})]}),(0,a.jsx)(Kf,{className:"h-10 w-10 text-blue-500 opacity-40"})]}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["Skauci: ",R.scoutCount," \u2022 Developerzy: ",R.developerCount," \u2022 Specjali\u015bci: ",R.specialistCount]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 border-l-4 border-green-500",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Miesi\u0119czne wynagrodzenia"}),(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[R.totalSalaries.toLocaleString()," PLN"]})]}),(0,a.jsx)(Zy,{className:"h-10 w-10 text-green-500 opacity-40"})]}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["\u015arednio na pracownika: ",R.totalCount>0?(R.totalSalaries/R.totalCount).toLocaleString():0," PLN"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 border-l-4 border-purple-500",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"\u015arednie umiej\u0119tno\u015bci"}),(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[R.avgSkill.toFixed(1),"/10"]})]}),(0,a.jsx)(ug,{className:"h-10 w-10 text-purple-500 opacity-40"})]}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["Skauci: ",D.scouts.length>0?(D.scouts.reduce(((e,t)=>e+(t.skill||0)),0)/D.scouts.length).toFixed(1):"0"," \u2022 Developerzy: ",D.developers.length>0?(D.developers.reduce(((e,t)=>e+(t.skill||0)),0)/D.developers.length).toFixed(1):"0"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 border-l-4 border-red-500",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"\u015arednie morale zespo\u0142u"}),(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[R.avgMorale.toFixed(0),"%"]})]}),(0,a.jsx)(hg,{className:"h-10 w-10 text-red-500 opacity-40"})]}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["Energia zespo\u0142u: ",R.avgEnergy.toFixed(0),"%"]})]})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Typ pracownika"}),(0,a.jsxs)("select",{value:o,onChange:e=>l(e.target.value),className:"border rounded px-3 py-1 text-sm",children:[(0,a.jsx)("option",{value:"all",children:"Wszyscy"}),(0,a.jsx)("option",{value:"scout",children:"Skauci"}),(0,a.jsx)("option",{value:"developer",children:"Developerzy"}),(0,a.jsx)("option",{value:"lobbyist",children:"Lobby\u015bci"}),(0,a.jsx)("option",{value:"lawyer",children:"Prawnicy"}),(0,a.jsx)("option",{value:"envSpecialist",children:"Specjali\u015bci \u015brodowiskowi"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Poziom"}),(0,a.jsxs)("select",{value:c,onChange:e=>u(e.target.value),className:"border rounded px-3 py-1 text-sm",children:[(0,a.jsx)("option",{value:"all",children:"Wszystkie"}),(0,a.jsx)("option",{value:"junior",children:"Junior"}),(0,a.jsx)("option",{value:"mid",children:"Mid"}),(0,a.jsx)("option",{value:"senior",children:"Senior"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Sortuj wg"}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsxs)("select",{value:m,onChange:e=>f(e.target.value),className:"border-l border-t border-b rounded-l px-3 py-1 text-sm",children:[(0,a.jsx)("option",{value:"name",children:"Imi\u0119 i nazwisko"}),(0,a.jsx)("option",{value:"skill",children:"Umiej\u0119tno\u015bci"}),(0,a.jsx)("option",{value:"experience",children:"Do\u015bwiadczenie"}),(0,a.jsx)("option",{value:"salary",children:"Wynagrodzenie"}),(0,a.jsx)("option",{value:"morale",children:"Morale"}),(0,a.jsx)("option",{value:"energy",children:"Energia"})]}),(0,a.jsx)("button",{onClick:()=>g("asc"===y?"desc":"asc"),className:"border rounded-r px-2 bg-gray-100 hover:bg-gray-200",children:"asc"===y?"\u2191":"\u2193"})]})]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-4",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",value:h,onChange:e=>p(e.target.value),placeholder:"Szukaj pracownika...",className:"border rounded pl-9 pr-3 py-1.5 w-64"}),(0,a.jsx)(yg,{className:"h-4 w-4 text-gray-400 absolute top-2 left-3"})]})})]})}),(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,a.jsx)(Kf,{className:"h-5 w-5 mr-2"}),"Skauci - Pozyskiwanie grunt\xf3w",(0,a.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",D.scouts.length,")"]})]}),(0,a.jsx)("p",{className:"text-gray-600 mb-4 text-sm",children:"Skauci szukaj\u0105 i negocjuj\u0105 umowy dzier\u017cawy grunt\xf3w pod projekty OZE. Do\u015bwiadczeni skauci przy\u015bpieszaj\u0105 pozyskiwanie grunt\xf3w i wynegocjuj\u0105 lepsze ceny."}),D.scouts.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:D.scouts.map((e=>(0,a.jsx)(bg,{staff:e,onFire:I,onTrain:A,onDetails:M},e.id)))}):(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 text-center",children:[(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"Nie masz jeszcze \u017cadnych pozyskiwaczy"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"Zatrudnij pocz\u0105tkuj\u0105cych (junior)"}),(0,a.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>T("scout","junior"),className:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"1 osoba"}),(0,a.jsx)("button",{onClick:()=>P("scout","junior",3),className:"px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"3 osoby"})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"Zatrudnij do\u015bwiadczonych (mid)"}),(0,a.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>T("scout","mid"),className:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"1 osoba"}),(0,a.jsx)("button",{onClick:()=>P("scout","mid",3),className:"px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"3 osoby"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"Zatrudnij ekspert\xf3w (senior)"}),(0,a.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>T("scout","senior"),className:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"1 osoba"}),(0,a.jsx)("button",{onClick:()=>P("scout","senior",3),className:"px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"3 osoby"})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,a.jsx)(Kf,{className:"h-5 w-5 mr-2"}),"Developerzy - Zarz\u0105dzanie projektami",(0,a.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",D.developers.length,")"]})]}),(0,a.jsx)("p",{className:"text-gray-600 mb-4 text-sm",children:"Developerzy zarz\u0105dzaj\u0105 projektami i przyspieszaj\u0105 proces realizacji. Do\u015bwiadczeni developerzy zwi\u0119kszaj\u0105 szanse na powodzenie projektu i redukuj\u0105 ryzyko."}),D.developers.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:D.developers.map((e=>(0,a.jsx)(bg,{staff:e,onFire:I,onTrain:A,onDetails:M,onAssign:e.assignedProject?null:O},e.id)))}):(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 text-center",children:[(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"Nie masz jeszcze \u017cadnych developer\xf3w"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"Zatrudnij pocz\u0105tkuj\u0105cych (junior)"}),(0,a.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>T("developer","junior"),className:"px-3 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"1 osoba"}),(0,a.jsx)("button",{onClick:()=>P("developer","junior",3),className:"px-3 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"3 osoby"})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"Zatrudnij do\u015bwiadczonych (mid)"}),(0,a.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>T("developer","mid"),className:"px-3 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"1 osoba"}),(0,a.jsx)("button",{onClick:()=>P("developer","mid",3),className:"px-3 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"3 osoby"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"Zatrudnij ekspert\xf3w (senior)"}),(0,a.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>T("developer","senior"),className:"px-3 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"1 osoba"}),(0,a.jsx)("button",{onClick:()=>P("developer","senior",3),className:"px-3 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"3 osoby"})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,a.jsx)(Kf,{className:"h-5 w-5 mr-2"}),"Specjali\u015bci wysokiego szczebla",(0,a.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",D.specialists.length,")"]})]}),(0,a.jsx)("p",{className:"text-gray-600 mb-4 text-sm",children:"Specjali\u015bci wysokiego szczebla to kluczowi eksperci, kt\xf3rzy znacz\u0105co przyspieszaj\u0105 uzyskiwanie pozwole\u0144 i rozw\xf3j projekt\xf3w."}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"font-bold text-md mb-2",children:"Prawnik"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Przyspiesza uzyskiwanie warunk\xf3w zabudowy i decyzji lokalizacyjnych o 30%."}),(0,a.jsx)("button",{onClick:()=>T("lawyer","senior"),className:"w-full px-3 py-2 bg-purple-500 text-white rounded hover:bg-purple-600",children:"Zatrudnij (30 mln z\u0142)"})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"font-bold text-md mb-2",children:"Specjalista ds. \u015brodowiska"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Przyspiesza uzyskiwanie decyzji \u015brodowiskowych o 30% i zmniejsza ryzyko blokad."}),(0,a.jsx)("button",{onClick:()=>T("envSpecialist","senior"),className:"w-full px-3 py-2 bg-purple-500 text-white rounded hover:bg-purple-600",children:"Zatrudnij (25 mln z\u0142)"})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"font-bold text-md mb-2",children:"Lobbysta"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Wp\u0142ywa na decyzje lokalne, przyspiesza procesy administracyjne i zwi\u0119ksza akceptacj\u0119 spo\u0142eczn\u0105."}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>T("lobbyist","junior"),className:"flex-1 px-2 py-2 bg-purple-500 text-white rounded hover:bg-purple-600 text-sm",children:"Junior (5k z\u0142/m-c)"}),(0,a.jsx)("button",{onClick:()=>T("lobbyist","senior"),className:"flex-1 px-2 py-2 bg-purple-500 text-white rounded hover:bg-purple-600 text-sm",children:"Expert (11k z\u0142/m-c)"})]})]})]})]})]}),x&&v&&(0,a.jsx)(zg,{staff:v,onClose:()=>b(!1),onFire:()=>{I(v),b(!1)},onTrain:()=>{A(v)}}),N&&_&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Przypisz developera do projektu"}),(0,a.jsxs)("p",{className:"mb-4",children:["Wybierz projekt, do kt\xf3rego chcesz przypisa\u0107 developera ",(0,a.jsx)("strong",{children:_.name}),":"]}),(0,a.jsx)("div",{className:"space-y-3 mb-6",children:s.findProjectsWaitingForDeveloper().map((e=>(0,a.jsxs)("div",{className:"bg-gray-50 p-3 rounded border border-gray-200 hover:bg-blue-50 cursor-pointer",onClick:()=>(()=>{if(!_)return;s.assignDeveloperToWaitingProject(_.id)?i(`Developer ${_.name} zosta\u0142 przypisany do projektu.`,"success"):i("Nie uda\u0142o si\u0119 przypisa\u0107 developera do projektu.","error"),z(!1),E(null)})(e.id),children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["Region: ",e.region,", Powierzchnia: ",e.size,"ha"]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Typ projektu: ",e.projectType||"Standardowy"]})]},e.id)))}),(0,a.jsx)("div",{className:"flex justify-end space-x-3",children:(0,a.jsx)("button",{onClick:()=>{z(!1),E(null)},className:"px-4 py-2 bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:"Anuluj"})})]})}),(0,a.jsx)(_g,{})]})},Sg=Lf("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),Cg=()=>{var e;const{state:t,dispatch:n}=d(),{showNotification:i}=mf(),[s,o]=(0,r.useState)("efficiency"),l=[{id:"efficiency",name:"Efektywno\u015b\u0107",icon:(0,a.jsx)(ny,{size:16})},{id:"training",name:"Szkolenia",icon:(0,a.jsx)(ug,{size:16})},{id:"equipment",name:"Sprz\u0119t",icon:(0,a.jsx)(Sg,{size:16})},{id:"reputation",name:"Reputacja",icon:(0,a.jsx)(hy,{size:16})}],c=e=>t.companyUpgrades&&t.companyUpgrades[e]||0,u=e=>{const t=c(e.id);return t>=e.levels?1/0:Math.floor(e.baseCost*Math.pow(e.costMultiplier,t))};return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mt-6",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Ulepszenia firmy"}),(0,a.jsx)("div",{className:"flex border-b border-gray-200 mb-4",children:l.map((e=>(0,a.jsxs)("button",{className:"flex items-center px-4 py-2 "+(s===e.id?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),onClick:()=>o(e.id),children:[(0,a.jsx)("span",{className:"mr-2",children:e.icon}),e.name]},e.id)))}),(0,a.jsx)("div",{className:"space-y-4",children:null===(e={efficiency:[{id:"project_management",name:"System zarz\u0105dzania projektami",description:"Zwi\u0119ksza efektywno\u015b\u0107 pracy developer\xf3w o 10% na poziom",levels:3,baseCost:25e3,costMultiplier:2,effects:[{target:"developer_efficiency",value:.1},{target:"project_progress_rate",value:.05}]},{id:"document_templates",name:"Szablony dokument\xf3w",description:"Przyspiesza uzyskiwanie pozwole\u0144 o 5% na poziom",levels:3,baseCost:15e3,costMultiplier:1.5,effects:[{target:"permit_speed",value:.05}]},{id:"automation",name:"Automatyzacja proces\xf3w",description:"Zmniejsza koszty operacyjne o 5% na poziom",levels:3,baseCost:3e4,costMultiplier:1.8,effects:[{target:"operational_costs",value:-.05}]}],training:[{id:"training_program",name:"Program szkole\u0144",description:"Przyspiesza zdobywanie do\u015bwiadczenia pracownik\xf3w o 10% na poziom",levels:3,baseCost:2e4,costMultiplier:1.7,effects:[{target:"experience_gain_rate",value:.1}]},{id:"mentoring",name:"Program mentoringu",description:"Zwi\u0119ksza umiej\u0119tno\u015bci nowych pracownik\xf3w o 1 na poziom",levels:2,baseCost:25e3,costMultiplier:2,effects:[{target:"starting_skill_bonus",value:1}]}],equipment:[{id:"office_equipment",name:"Sprz\u0119t biurowy",description:"Zwi\u0119ksza zadowolenie pracownik\xf3w o 5% na poziom",levels:3,baseCost:1e4,costMultiplier:1.5,effects:[{target:"staff_morale",value:.05}]},{id:"field_equipment",name:"Sprz\u0119t terenowy",description:"Zwi\u0119ksza efektywno\u015b\u0107 skaut\xf3w o 10% na poziom",levels:3,baseCost:15e3,costMultiplier:1.6,effects:[{target:"scout_efficiency",value:.1}]}],reputation:[{id:"marketing",name:"Marketing i PR",description:"Zwi\u0119ksza reputacj\u0119 firmy o 5 punkt\xf3w na poziom",levels:3,baseCost:2e4,costMultiplier:1.8,effects:[{target:"reputation",value:5}]},{id:"social_responsibility",name:"Odpowiedzialno\u015b\u0107 spo\u0142eczna",description:"Zwi\u0119ksza akceptacj\u0119 spo\u0142eczn\u0105 projekt\xf3w o 10% na poziom",levels:2,baseCost:3e4,costMultiplier:2,effects:[{target:"social_acceptance",value:.1}]}]}[s])||void 0===e?void 0:e.map((e=>{const r=c(e.id),s=u(e),o=r>=e.levels;return(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-sm font-medium",children:["Poziom: ",r,"/",e.levels]}),o?(0,a.jsxs)("div",{className:"flex items-center mt-2 text-green-600 text-sm",children:[(0,a.jsx)(hy,{size:16,className:"mr-1"}),"Maksymalny poziom"]}):(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("button",{onClick:()=>(e=>{const r=c(e.id);if(r>=e.levels)return void i("Osi\u0105gni\u0119to maksymalny poziom tego ulepszenia","warning");const a=u(e);t.cash<a?i(`Niewystarczaj\u0105ce \u015brodki. Potrzeba ${a.toLocaleString()} PLN`,"error"):(n({type:"PURCHASE_COMPANY_UPGRADE",payload:{upgradeId:e.id,cost:a,newLevel:r+1}}),e.effects.forEach((e=>{"reputation"===e.target&&n({type:"UPDATE_REPUTATION",payload:e.value})})),i(`Zakupiono ulepszenie: ${e.name} (poziom ${r+1}/${e.levels})`,"success"))})(e),disabled:t.cash<s||o,className:"px-3 py-1.5 text-sm rounded "+(t.cash<s||o?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"),children:o?"Maksymalny poziom":`Ulepsz (${s.toLocaleString()} PLN)`})})]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5 mt-3",children:(0,a.jsx)("div",{className:"bg-blue-600 h-1.5 rounded-full",style:{width:r/e.levels*100+"%"}})})]},e.id)}))}),(0,a.jsxs)("div",{className:"flex items-start mt-4 p-3 bg-blue-50 rounded-lg text-sm",children:[(0,a.jsx)(Hf,{size:18,className:"text-blue-500 mr-2 mt-0.5"}),(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-blue-800",children:"Ulepszenia firmy daj\u0105 trwa\u0142e premie, kt\xf3re wp\u0142ywaj\u0105 na wszystkie aspekty dzia\u0142alno\u015bci. Wybieraj je zgodnie ze swoj\u0105 strategi\u0105 rozwoju."})})]})]})},Tg=()=>{var e;const{state:t}=d(),{state:n}=mf(),r=e=>new Intl.NumberFormat("pl-PL",{style:"currency",currency:"PLN",maximumFractionDigits:0}).format(e),i=(()=>{let e=0,n=5e3;t.staff&&Object.values(t.staff).forEach((t=>{Array.isArray(t)&&t.forEach((t=>{t.salary&&(e+=t.salary)}))}));const r=Object.values(t.staff||{}).reduce(((e,t)=>e+(Array.isArray(t)?t.length:0)),0);return n+=1e3*r,{staffCosts:e,officeCosts:n,otherCosts:2e3,total:e+n+2e3}})(),s=t.projects&&0!==t.projects.length?t.projects.reduce(((e,t)=>{let n=0;switch(t.status){case"new":n=0;break;case"land_acquisition":default:n=5e3*t.size;break;case"environmental_decision":n=1e4*t.size;break;case"zoning_conditions":n=15e3*t.size;break;case"grid_connection":n=25e3*t.size;break;case"ready_to_build":n=5e4*t.size}return e+n*("PV"===t.technology?1:"Wind"===t.technology?1.2:1.5)}),0):0;return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mt-6",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Przegl\u0105d firmy"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"rounded-full bg-blue-100 p-2 mr-3",children:(0,a.jsx)(gy,{size:20,className:"text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Aktywa pieni\u0119\u017cne"}),(0,a.jsx)("p",{className:"font-semibold",children:r(t.cash||0)})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"rounded-full bg-green-100 p-2 mr-3",children:(0,a.jsx)(uy,{size:20,className:"text-green-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Warto\u015b\u0107 projekt\xf3w"}),(0,a.jsx)("p",{className:"font-semibold",children:r(s)})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"rounded-full bg-purple-100 p-2 mr-3",children:(0,a.jsx)(Kf,{size:20,className:"text-purple-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Miesi\u0119czne koszty personelu"}),(0,a.jsx)("p",{className:"font-semibold",children:r(i.staffCosts)})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"rounded-full bg-red-100 p-2 mr-3",children:(0,a.jsx)(Hy,{size:20,className:"text-red-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Ca\u0142kowite koszty miesi\u0119czne"}),(0,a.jsx)("p",{className:"font-semibold",children:r(i.total)})]})]})]}),(0,a.jsxs)("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Liczba projekt\xf3w"}),(0,a.jsx)("p",{className:"font-medium",children:(null===(e=t.projects)||void 0===e?void 0:e.length)||0})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Liczba pracownik\xf3w"}),(0,a.jsx)("p",{className:"font-medium",children:Object.values(t.staff||{}).reduce(((e,t)=>e+(Array.isArray(t)?t.length:0)),0)})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Dzie\u0144 operacyjny"}),(0,a.jsx)("p",{className:"font-medium",children:n.turn*(n.daysPerTurn||2)})]})]})]})},Pg=Lf("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),Ig=Lf("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),Ag=()=>{var e,t,n;const{state:i,dispatch:s}=d(),{state:o,showNotification:l}=mf(),[c,u]=(0,r.useState)(null),[h,p]=(0,r.useState)(!1),m=Array.isArray(i.leases)?i.leases:[];(0,r.useEffect)((()=>{const e=()=>{if(c){const e=m.find((e=>e.id===c.id));e?u(e):(u(null),p(!1))}};return window.addEventListener("next-game-day",e),()=>{window.removeEventListener("next-game-day",e)}}),[c,m]);const f=e=>{if(!e)return"Data nieznana";try{return new Date(e).toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"})}catch(t){return console.error("B\u0142\u0105d formatowania daty:",t),"B\u0142\u0105d formatu daty"}},y=e=>{if(e&&window.confirm("Czy na pewno chcesz wypowiedzie\u0107 umow\u0119 dzier\u017cawy? Utracisz prawa do dzia\u0142ki i nie otrzymasz zwrotu kaucji."))try{var t;const n=null===(t=i.projects)||void 0===t?void 0:t.find((t=>t.leaseId===e));if(n)return void l(`Nie mo\u017cna wypowiedzie\u0107 umowy dzier\u017cawy, poniewa\u017c jest przypisana do projektu "${n.name}". Najpierw musisz zako\u0144czy\u0107 projekt.`,"error");s({type:"REMOVE_LEASE",payload:e}),c&&c.id===e&&(u(null),p(!1)),l("Umowa dzier\u017cawy zosta\u0142a wypowiedziana.","success")}catch(n){console.error("B\u0142\u0105d podczas wypowiadania umowy dzier\u017cawy:",n),l("Wyst\u0105pi\u0142 b\u0142\u0105d podczas wypowiadania umowy dzier\u017cawy.","error")}};(0,r.useEffect)((()=>{if(c){const e=m.find((e=>e.id===c.id));e?u(e):(u(null),p(!1))}}),[m,c]);const g=[...m].sort(((e,t)=>{const n=new Date(e.startDate);return new Date(t.startDate)-n}));return(0,a.jsxs)("div",{className:"p-4 bg-white rounded-lg shadow-md",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold mb-4 flex items-center",children:[(0,a.jsx)(uy,{className:"mr-2 h-5 w-5 text-blue-500"}),"Aktywne umowy dzier\u017cawy (",m.length,")"]}),0===m.length?(0,a.jsxs)("div",{className:"text-center py-6 bg-gray-50 rounded-lg",children:[(0,a.jsx)(uy,{className:"mx-auto h-12 w-12 text-gray-300 mb-2"}),(0,a.jsx)("p",{className:"text-gray-500 mb-1",children:"Brak aktywnych um\xf3w dzier\u017cawy"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Zawrzyj umowy dzier\u017cawy, aby rozpocz\u0105\u0107 nowe projekty OZE"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:g.map((e=>{var t;return(0,a.jsxs)("div",{className:"border rounded-lg p-3 transition-all duration-200 "+(c&&c.id===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"),onClick:()=>{u(e),p(!0)},children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-medium",children:["Dzia\u0142ka ",e.size,"ha (",e.projectType||"Brak typu",")"]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(Py,{className:"h-3 w-3 mr-1"}),e.regionName||"Nieznany region"]})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),(e=>{var t;const n=null===(t=i.projects)||void 0===t?void 0:t.find((t=>t.leaseId===e));n?l(`Znaleziono powi\u0105zany projekt: ${n.name}`,"info"):l("Nie znaleziono projektu powi\u0105zanego z t\u0105 umow\u0105 dzier\u017cawy.","error")})(e.id)},className:"text-blue-500 hover:text-blue-700 p-1",title:"Zobacz powi\u0105zany projekt",children:(0,a.jsx)(Pg,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),y(e.id)},className:"text-red-500 hover:text-red-700 p-1 ml-1",title:"Wypowiedz umow\u0119",children:(0,a.jsx)(Ig,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"text-sm space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Czynsz miesi\u0119czny:"}),(0,a.jsxs)("span",{className:"font-medium",children:[null===(t=e.monthlyRent)||void 0===t?void 0:t.toLocaleString()," PLN"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Umowa zawarta:"}),(0,a.jsx)("span",{children:f(e.startDate)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Wygasa:"}),(0,a.jsx)("span",{children:f(e.endDate)})]})]})]},e.id)}))}),h&&c&&(0,a.jsxs)("div",{className:"mt-6 bg-gray-50 p-4 rounded-lg border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,a.jsx)("h3",{className:"text-lg font-bold",children:"Szczeg\xf3\u0142y umowy dzier\u017cawy"}),(0,a.jsx)("button",{onClick:()=>p(!1),className:"text-gray-500 hover:text-gray-700",children:"Zamknij"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Informacje podstawowe"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"ID umowy:"}),(0,a.jsx)("span",{className:"font-mono",children:c.id})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Region:"}),(0,a.jsx)("span",{children:c.regionName})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Powierzchnia:"}),(0,a.jsxs)("span",{children:[c.size," ha"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Jako\u015b\u0107 dzia\u0142ki:"}),(0,a.jsx)("span",{children:"high"===c.quality?"Wysoka":"medium"===c.quality?"\u015arednia":"Niska"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Typ projektu:"}),(0,a.jsx)("span",{children:c.projectType||"Nie okre\u015blono"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Warunki finansowe"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Cena ca\u0142kowita:"}),(0,a.jsxs)("span",{className:"font-medium",children:[null===(e=c.totalPrice)||void 0===e?void 0:e.toLocaleString()," PLN"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Czynsz miesi\u0119czny:"}),(0,a.jsxs)("span",{children:[null===(t=c.monthlyRent)||void 0===t?void 0:t.toLocaleString()," PLN"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Kaucja:"}),(0,a.jsxs)("span",{children:[null===(n=c.deposit)||void 0===n?void 0:n.toLocaleString()," PLN"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"D\u0142ugo\u015b\u0107 umowy:"}),(0,a.jsxs)("span",{children:[c.contractLength||29," lat"]})]})]})]})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Terminy"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Data zawarcia:"}),(0,a.jsx)("span",{children:f(c.startDate)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Data wyga\u015bni\u0119cia:"}),(0,a.jsx)("span",{children:f(c.endDate)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Pozosta\u0142y czas:"}),(0,a.jsx)("span",{children:(()=>{try{const e=new Date(c.endDate),t=new Date(o.gameDate),n=Math.abs(e-t);return`${Math.floor(n/31536e6)} lat`}catch(e){return"B\u0142\u0105d obliczenia"}})()})]})]})]}),(0,a.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,a.jsx)("button",{onClick:()=>(c.id,void l("Funkcja renegocjacji umowy dzier\u017cawy jest w trakcie rozwoju.","info")),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Renegocjuj umow\u0119"}),(0,a.jsx)("button",{onClick:()=>y(c.id),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Wypowiedz umow\u0119"})]})]})]})},Mg=()=>{const[e,t]=(0,r.useState)("overview"),{state:n,dispatch:i}=d(),{state:s,showNotification:o,dispatch:l}=mf(),c=Ly(),[u,h]=(0,r.useState)(!1),[p,m]=(0,r.useState)(!1),[f,y]=(0,r.useState)(""),[g,v]=(0,r.useState)(!1),[w,x]=(0,r.useState)(null),[b,j]=(0,r.useState)(null);(0,r.useEffect)((()=>{try{if(!n)throw new Error("Dane gracza s\u0105 niedost\u0119pne");if(n.staff){const e=["scouts","developers","lawyers","envSpecialists","lobbyists"].filter((e=>!n.staff[e]));if(e.length>0){const t={};e.forEach((e=>{t[e]=[]})),i({type:"UPDATE_STAFF_STRUCTURE",payload:t}),o("Zaktualizowano struktur\u0119 danych personelu","info")}n.projects||i({type:"UPDATE_PLAYER",payload:{projects:[]}}),n.reputationHistory||i({type:"UPDATE_PLAYER",payload:{reputationHistory:[]}}),n.illegals&&n.illegals.illegalActionHistory||i({type:"UPDATE_PLAYER",payload:{illegals:{...n.illegals||{},illegalActionHistory:[]}}}),n.economicMetrics||i({type:"UPDATE_PLAYER",payload:{economicMetrics:{totalInvestment:0,totalRevenue:0,totalExpenses:0,avgROI:0}}}),n.reputationFactors||i({type:"UPDATE_PLAYER",payload:{reputationFactors:{legalCompliance:1,environmentalImpact:1,communityRelations:1,projectQuality:1,transparency:1,grayAreaActivity:1}}}),n.activeReputationInitiatives||i({type:"UPDATE_PLAYER",payload:{activeReputationInitiatives:[]}}),h(!0)}else i({type:"INITIALIZE_PLAYER",payload:{cash:1e6,reputation:50,installedCapacity:0,rtbCapacity:0,staff:{scouts:[],developers:[],lawyers:[],envSpecialists:[],lobbyists:[]},projects:[],reputationHistory:[],illegals:{illegalActionHistory:[]},economicMetrics:{totalInvestment:0,totalRevenue:0,totalExpenses:0,avgROI:0}}}),o("Inicjalizacja danych gracza...","info")}catch(e){console.error("B\u0142\u0105d podczas inicjalizacji danych:",e),m(!0),y(e.message||"B\u0142\u0105d podczas \u0142adowania zarz\u0105dzania sp\xf3\u0142k\u0105"),o("B\u0142\u0105d podczas \u0142adowania zarz\u0105dzania sp\xf3\u0142k\u0105.","error")}}),[n,i,o]);const k=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{x(e),j(t),v(!0)}catch(n){console.error("B\u0142\u0105d podczas otwierania panelu bocznego:",n),o("Wyst\u0105pi\u0142 b\u0142\u0105d podczas otwierania panelu","error")}},N=()=>{try{v(!1),setTimeout((()=>{x(null),j(null)}),300)}catch(e){console.error("B\u0142\u0105d podczas zamykania panelu bocznego:",e)}},z=(n,r)=>(0,a.jsx)("button",{className:`px-4 py-2 ${e===n?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"} rounded-md shadow-sm transition`,onClick:e=>{e.preventDefault(),e.stopPropagation(),t(n)},children:r});(0,r.useEffect)((()=>{const e=e=>{if(e.target.closest(".company-view-container"))return;const t=e.target.closest("a[href], button[data-nav]");if(t){const n=t.getAttribute("href")||t.getAttribute("data-nav");if("company"!==n&&"#company"!==n)return;e.preventDefault(),e.stopPropagation()}};return document.addEventListener("click",e,!0),()=>{document.removeEventListener("click",e,!0)}}),[]);const _=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{if("get"===e)return localStorage.getItem(t);"set"===e?localStorage.setItem(t,n):"remove"===e&&localStorage.removeItem(t)}catch(r){return console.error(`B\u0142\u0105d podczas operacji ${e} na localStorage dla klucza ${t}:`,r),null}};(0,r.useEffect)((()=>{try{_("set","companyViewActiveTab",e)}catch(t){console.error("Nie mo\u017cna zapisa\u0107 stanu zak\u0142adki:",t)}}),[e]),(0,r.useEffect)((()=>{try{const e=_("get","companyViewActiveTab");e&&t(e)}catch(e){console.error("Nie mo\u017cna wczyta\u0107 stanu zak\u0142adki:",e)}}),[]);const E=(n,r)=>(0,a.jsx)(xg,{fallback:(0,a.jsxs)("div",{className:"bg-red-100 p-6 rounded text-center",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-red-700 mb-4",children:["Wyst\u0105pi\u0142 b\u0142\u0105d w panelu ",n]}),(0,a.jsx)("p",{className:"text-red-600 mb-4",children:"Problemy z wy\u015bwietlaniem zawarto\u015bci. Spr\xf3buj od\u015bwie\u017cy\u0107 stron\u0119 lub wybra\u0107 inn\u0105 zak\u0142adk\u0119."}),(0,a.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",onClick:()=>window.location.reload(),children:"Od\u015bwie\u017c stron\u0119"}),(0,a.jsx)("button",{className:"px-4 py-2 bg-gray-600 text-white rounded",onClick:()=>t("overview"),children:"Wr\xf3\u0107 do przegl\u0105du"})]})]}),onError:(e,t)=>{console.error(`B\u0142\u0105d w komponencie ${n}:`,e,t),o(`Wyst\u0105pi\u0142 problem z panelem ${n}. Wybierz inn\u0105 zak\u0142adk\u0119 lub od\u015bwie\u017c stron\u0119.`,"error")},resetKeys:[e],children:(0,a.jsx)(r,{})});return p?(0,a.jsx)("div",{className:"container mx-auto p-4",children:(0,a.jsxs)("div",{className:"bg-red-100 p-8 rounded-lg text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-red-700 mb-4",children:"B\u0142\u0105d podczas \u0142adowania"}),(0,a.jsx)("p",{className:"text-red-700 mb-4",children:f||"Wyst\u0105pi\u0142 problem podczas \u0142adowania danych zarz\u0105dzania sp\xf3\u0142k\u0105."}),(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",onClick:()=>{l({type:"SET_SCREEN",payload:"home"})},children:"Wr\xf3\u0107 do ekranu g\u0142\xf3wnego"})]})}):u?(0,a.jsxs)("div",{className:"container mx-auto p-4 company-view-container",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Zarz\u0105dzanie firm\u0105"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:e=>{e.preventDefault(),e.stopPropagation(),k("reputation_initiatives")},children:"Inicjatywy reputacyjne"}),(0,a.jsx)("button",{className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",onClick:e=>{e.preventDefault(),e.stopPropagation(),k("illegal_actions")},children:"Szara strefa"})]})]}),(0,a.jsxs)("div",{className:"flex mb-6 space-x-2 border-b pb-3",children:[z("overview","Przegl\u0105d firmy"),z("projects","Projekty"),z("staff","Pracownicy"),z("finances","Finanse"),z("reputation","Reputacja"),z("upgrades","Ulepszenia")]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg min-h-[600px]",children:["overview"===e&&E("przegl\u0105d",Tg),"projects"===e&&E("projekty",tg),"staff"===e&&(0,a.jsx)(xg,{fallback:(0,a.jsxs)("div",{className:"bg-red-100 p-6 rounded text-center",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-red-700 mb-4",children:"Wyst\u0105pi\u0142 b\u0142\u0105d w panelu kadry"}),(0,a.jsx)("p",{className:"text-red-600 mb-4",children:"Problemy z wy\u015bwietlaniem panelu kadr. Spr\xf3buj od\u015bwie\u017cy\u0107 stron\u0119."}),(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",onClick:()=>window.location.reload(),children:"Od\u015bwie\u017c stron\u0119"})]}),onError:(e,t)=>{console.error("B\u0142\u0105d w komponencie kadr:",e,t),o("Wyst\u0105pi\u0142 problem z panelem kadr. Od\u015bwie\u017c stron\u0119, aby kontynuowa\u0107.","error")},resetKeys:[e],children:(0,a.jsx)(Eg,{})}),"finances"===e&&E("finanse",mg),"reputation"===e&&E("reputacja",_g),"upgrades"===e&&E("ulepszenia",Cg),"staff"!==e&&(0,a.jsx)("div",{className:"mt-8",children:(0,a.jsx)(xg,{fallback:(0,a.jsx)("div",{className:"bg-yellow-50 p-3 rounded border border-yellow-200",children:(0,a.jsx)("p",{className:"text-yellow-700",children:"Nie mo\u017cna za\u0142adowa\u0107 listy um\xf3w dzier\u017cawy."})}),children:(0,a.jsx)(Ag,{})})})]}),(()=>{if(!g)return null;try{switch(w){case"illegal_actions":return(0,a.jsx)(ng,{title:"Szara strefa",isOpen:g,onClose:N,variant:"illegal",children:(0,a.jsx)(cg,{onClose:N})});case"reputation_initiatives":return(0,a.jsx)(ng,{title:"Inicjatywy reputacyjne",isOpen:g,onClose:N,variant:"reputation",children:(0,a.jsx)(ky,{onClose:N})});case"staff_details":return(0,a.jsx)(ng,{title:"Szczeg\xf3\u0142y pracownika",isOpen:g,onClose:N,variant:"staff",children:(0,a.jsx)(pg,{staffId:null===b||void 0===b?void 0:b.id,staffType:null===b||void 0===b?void 0:b.type,onClose:N,onFire:(e,t)=>{c&&"function"===typeof c.fireStaff?(c.fireStaff(t,e),N()):o("Funkcja zwalniania pracownik\xf3w jest niedost\u0119pna","error")},onTrain:()=>{o("Funkcja szkolenia jest w trakcie rozwoju","info"),N()},onAssign:()=>{o("Funkcja przydzielania jest w trakcie rozwoju","info"),N()}})});case"finance":return(0,a.jsx)(ng,{title:"Panel finansowy",isOpen:g,onClose:N,variant:"finance",children:(0,a.jsx)(mg,{onClose:N})});case"company_upgrades":return(0,a.jsx)(ng,{title:"Ulepszenia firmowe",isOpen:g,onClose:N,variant:"upgrade",children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Ulepszenia firmowe"}),(0,a.jsx)("p",{className:"mb-4",children:"W tym miejscu b\u0119dziesz m\xf3g\u0142 ulepsza\u0107 swoj\u0105 firm\u0119, zwi\u0119kszaj\u0105c jej efektywno\u015b\u0107, reputacj\u0119 i mo\u017cliwo\u015bci."}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:[(0,a.jsxs)("div",{className:"border p-3 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-bold",children:"Biuro"}),(0,a.jsx)("p",{className:"text-sm mb-2",children:"Zwi\u0119ksza morale pracownik\xf3w i szybko\u015b\u0107 pracy"}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"Poziom: 1"}),(0,a.jsx)("button",{className:"px-3 py-1 bg-blue-500 text-white rounded disabled:bg-gray-300",disabled:!0,children:"Ulepsz (250,000 PLN)"})]})]}),(0,a.jsxs)("div",{className:"border p-3 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-bold",children:"Laboratoria"}),(0,a.jsx)("p",{className:"text-sm mb-2",children:"Przyspiesza badania i analizy"}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"Poziom: 0"}),(0,a.jsx)("button",{className:"px-3 py-1 bg-blue-500 text-white rounded",children:"Kup (150,000 PLN)"})]})]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-gray-500 italic mb-2",children:"Wi\u0119cej ulepsze\u0144 b\u0119dzie dost\u0119pnych wkr\xf3tce"}),(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:N,children:"Zamknij"})]})]})});default:return null}}catch(e){return console.error("B\u0142\u0105d podczas renderowania panelu bocznego:",e),(0,a.jsx)(ng,{title:"B\u0142\u0105d",isOpen:g,onClose:N,variant:"error",children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-red-600 mb-4",children:"Wyst\u0105pi\u0142 b\u0142\u0105d"}),(0,a.jsx)("p",{className:"mb-4",children:"Nie uda\u0142o si\u0119 za\u0142adowa\u0107 \u017c\u0105danego panelu."}),(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:N,children:"Zamknij"})]})})}})()]}):(0,a.jsx)("div",{className:"container mx-auto p-4",children:(0,a.jsxs)("div",{className:"bg-blue-50 p-8 rounded-lg text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-blue-700 mb-4",children:"\u0141adowanie danych"}),(0,a.jsx)("p",{className:"text-blue-700 mb-4",children:"Trwa \u0142adowanie danych zarz\u0105dzania sp\xf3\u0142k\u0105..."}),(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto"})]})})},Dg=Lf("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Rg=Lf("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),Og=Lf("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),Lg=Lf("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),Fg={container:{display:"flex",flexDirection:"column",height:"100%",width:"100%",maxHeight:"85vh",position:"relative",overflowY:"hidden"},header:{padding:"1rem",borderBottom:"1px solid #e5e7eb"},tabsContainer:{display:"flex",borderBottom:"1px solid #e5e7eb",overflow:"hidden",position:"relative"},mainContent:{display:"flex",flexGrow:1,overflow:"hidden",position:"relative"},sidebar:{width:"220px",borderRight:"1px solid #e5e7eb",background:"#f9fafb",overflow:"auto",height:"100%",padding:"0.75rem"},content:{flexGrow:1,height:"100%",overflowY:"auto",position:"relative"},eventsList:{padding:"1rem",overflowY:"auto",height:"100%",transition:"width 0.3s ease-in-out"},eventDetails:{padding:"1rem",borderLeft:"1px solid #e5e7eb",background:"#f9fafb",width:"50%",height:"100%",overflowY:"auto"},noEvents:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",padding:"2rem",color:"#6b7280",textAlign:"center"}},Ug=[],Vg={},Bg={},$g=e=>{let{children:t,fallback:n}=e;const[i,s]=(0,r.useState)(!1),[o,l]=(0,r.useState)(null),c=e=>{console.error("B\u0142\u0105d w komponencie Events:",e),l(e),s(!0)};return(0,r.useEffect)((()=>(window.addEventListener("error",c),()=>{window.removeEventListener("error",c)})),[]),i?(0,a.jsxs)("div",{className:"error-boundary p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-red-600 font-semibold",children:"Wyst\u0105pi\u0142 b\u0142\u0105d w module wydarze\u0144"}),(0,a.jsx)("p",{className:"text-gray-700",children:"Przepraszamy za niedogodno\u015bci. Spr\xf3buj od\u015bwie\u017cy\u0107 stron\u0119."}),o&&(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:o.toString()})]}):t};function Wg(e){return(0,a.jsx)($g,{fallback:(0,a.jsxs)("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded",children:[(0,a.jsx)("h2",{className:"font-bold text-amber-800",children:"Wyst\u0105pi\u0142 b\u0142\u0105d w panelu wydarze\u0144"}),(0,a.jsx)("p",{children:"Spr\xf3buj od\u015bwie\u017cy\u0107 stron\u0119. Je\u015bli problem b\u0119dzie si\u0119 powtarza\u0142, skontaktuj si\u0119 z administratorem."})]}),children:(0,a.jsx)(qg,{...e})})}const qg=e=>{let{eventsState:t={events:Ug},eventsDispatch:n,gameState:i=Vg,gameDispatch:s,playerState:o=Bg,playerDispatch:l,selectedEvent:c=null,setSelectedEvent:d=null}=e;if(!t||!i||!o)return(0,a.jsxs)("div",{className:"p-4 text-center",children:[(0,a.jsx)(Hf,{className:"w-12 h-12 mx-auto text-red-500 mb-2"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-600",children:"Brak danych"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Nie mo\u017cna za\u0142adowa\u0107 panelu wydarze\u0144 z powodu braku wymaganych danych. Od\u015bwie\u017c stron\u0119 lub skontaktuj si\u0119 z administratorem."})]});const[u,h]=(0,r.useState)("all"),[p,m]=(0,r.useState)(null),[f,y]=(0,r.useState)(""),[g,v]=(0,r.useState)(!1),[w,x]=(0,r.useState)("all"),[b,j]=(0,r.useState)("all"),[k,N]=(0,r.useState)("all"),[z,_]=(0,r.useState)("all"),[E,S]=(0,r.useState)(!1),[C,T]=(0,r.useState)(!1),[P,I]=(0,r.useState)(!1),[A,M]=(0,r.useState)(!1),D=(0,r.useRef)(null),R=(0,r.useRef)(null),O=((0,r.useRef)(null),null!==c?c:p),L=e=>{d?d(e):m(e)};(0,r.useEffect)((()=>{const e=e=>{try{R.current&&!R.current.contains(e.target)&&v(!1)}catch(t){console.error("B\u0142\u0105d przy obs\u0142udze klikni\u0119cia poza filtry:",t)}};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),(0,r.useEffect)((()=>{if(O){I(!0);const e=setTimeout((()=>{I(!1)}),300);return()=>clearTimeout(e)}}),[O]),(0,r.useEffect)((()=>{if(O&&n)try{const e=setTimeout((()=>{O.read||n({type:"MARK_EVENT_READ",payload:O.id})}),5e3);return()=>clearTimeout(e)}catch(e){console.error("B\u0142\u0105d przy oznaczaniu wydarzenia jako przeczytane:",e)}}),[O,n]);const F=(0,r.useMemo)((()=>Array.isArray(null===t||void 0===t?void 0:t.events)?t.events:[]),[null===t||void 0===t?void 0:t.events]),U=(0,r.useMemo)((()=>F&&i?F.filter((e=>!e.expires||e.expires>(i.day||0))):[]),[F,null===i||void 0===i?void 0:i.day]),V=(0,r.useMemo)((()=>{if(!U)return{national:[],regional:[],local:[],projects:[],organization:[],special:[],regionalByVoivodeship:{}};const e=U.filter((e=>"national"===e.scope||"global"===e.scope)),t=U.filter((e=>"regional"===e.scope)),n=U.filter((e=>"county"===e.scope)),r=U.filter((e=>"project"===e.scope||"project_event"===e.type)),i=U.filter((e=>"staff_event"===e.type||"audit_event"===e.type||"illegal_event"===e.type||"reputation_event"===e.type||"organization"===e.scope)),a=U.filter((e=>e.requiresDecision||"special_event"===e.type||"special"===e.severity)),s={};return t.forEach((e=>{e.regionId&&(s[e.regionId]||(s[e.regionId]=[]),s[e.regionId].push(e))})),{national:e,regional:t,local:n,projects:r,organization:i,special:a,regionalByVoivodeship:s}}),[U]),B=(0,r.useMemo)((()=>[{id:"dolnoslaskie",name:"Dolno\u015bl\u0105skie"},{id:"kujawsko-pomorskie",name:"Kujawsko-Pomorskie"},{id:"lubelskie",name:"Lubelskie"},{id:"lubuskie",name:"Lubuskie"},{id:"lodzkie",name:"\u0141\xf3dzkie"},{id:"malopolskie",name:"Ma\u0142opolskie"},{id:"mazowieckie",name:"Mazowieckie"},{id:"opolskie",name:"Opolskie"},{id:"podkarpackie",name:"Podkarpackie"},{id:"podlaskie",name:"Podlaskie"},{id:"pomorskie",name:"Pomorskie"},{id:"slaskie",name:"\u015al\u0105skie"},{id:"swietokrzyskie",name:"\u015awi\u0119tokrzyskie"},{id:"warminsko-mazurskie",name:"Warmi\u0144sko-Mazurskie"},{id:"wielkopolskie",name:"Wielkopolskie"},{id:"zachodniopomorskie",name:"Zachodniopomorskie"}]),[]),$=(0,r.useMemo)((()=>{let e=(()=>{if(!V)return[];let e=[];switch(z){case"krajowe":e=V.national||[];break;case"regionalne":e=V.regional||[],"all"!==k&&(e=e.filter((e=>e.region===k)));break;case"lokalne":e=V.local||[];break;case"organizacja":e=V.organization||[];break;case"projekty":e=V.projects||[];break;case"specjalne":e=V.special||[];break;default:e=[...V.national||[],...V.regional||[],...V.local||[],...V.projects||[],...V.organization||[],...V.special||[]]}return e})();if("all"!==w&&(e=e.filter((e=>e.type===w))),"all"!==b&&(e=e.filter((e=>e.priority===b))),f.trim()){const t=f.toLowerCase();e=e.filter((e=>e.title&&e.title.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t)))}return e.sort(((e,t)=>{if(e.read!==t.read)return e.read?1:-1;if(e.priority!==t.priority){const n={high:3,medium:2,low:1};return n[t.priority]-n[e.priority]}return t.date-e.date}))}),[V,w,b,k,f,z]),W=e=>{const t=()=>{const t=e.toString().split("").reduce(((e,t)=>0|(e=(e<<5)-e+t.charCodeAt(0))),0);return.99999*Math.abs(Math.sin(t))},n=["To wydarzenie mo\u017ce wp\u0142yn\u0105\u0107 na ca\u0142y sektor OZE w Polsce.","Warto obserwowa\u0107, jak to wp\u0142ynie na inne projekty w regionie.","Sytuacja rozwija si\u0119 w interesuj\u0105cym kierunku.","Kluczowe b\u0119dzie, jak zareaguj\u0105 inni gracze na rynku.","Mo\u017ce to stworzy\u0107 nowe mo\u017cliwo\u015bci dla inwestor\xf3w.","To mo\u017ce by\u0107 punkt zwrotny dla ca\u0142ej bran\u017cy.","Podobne wydarzenia w przesz\u0142o\u015bci mia\u0142y du\u017cy wp\u0142yw na rynek.","Warto przeanalizowa\u0107, jak to wp\u0142ynie na lokaln\u0105 spo\u0142eczno\u015b\u0107.","Interesuj\u0105ca sytuacja, wymaga dalszej obserwacji.","To mo\u017ce zmieni\u0107 ca\u0142\u0105 dynamik\u0119 rynku OZE."],r=["Analityk rynku","Ekspert OZE","Konsultant bran\u017cowy","Ekonomista","Inwestor","Dziennikarz gospodarczy","Lokalny samorz\u0105dowiec","Przedstawiciel sektora","Ekspert ds. regulacji","Obserwator rynku"],i=Array.isArray(n)?n:[],a=Array.isArray(r)?r:[];if(0===i.length||0===a.length)return{text:"Brak dost\u0119pnych komentarzy.",author:"System"};const s=Math.floor(t()*i.length),o=Math.floor(t()*a.length);return{text:i[s],author:a[o],date:new Date}},q=((0,r.useMemo)((()=>i&&o?(()=>{if(!i||!o)return{date:new Date,text:"\u0141adowanie danych...",author:"System",projectReference:null};const e=["Rozpocz\u0119li\u015bmy proces screeningu grunt\xf3w pod k\u0105tem nas\u0142onecznienia i dost\u0119pu do sieci.","Odbyli\u015bmy pierwsze spotkanie z w\u0142a\u015bcicielem terenu \u2013 wykazuje zainteresowanie d\u0142ugoterminow\u0105 dzier\u017caw\u0105 pod PV.","Podpisali\u015bmy list intencyjny na dzier\u017caw\u0119 45 ha pod farm\u0119 wiatrow\u0105.","GIS wskazuje na korzystny wsp\xf3\u0142czynnik irradiacji solarnej na analizowanym terenie.","Wst\u0119pne modelowanie wskazuje na \u015brednioroczny wind yield na poziomie 2800 h.","Analiza warunk\xf3w glebowych potwierdza mo\u017cliwo\u015b\u0107 posadowienia magazynu BESS.","Zaplanowano badania gruntu pod k\u0105tem no\u015bno\u015bci dla turbin wiatrowych.","Umowa przedwst\u0119pna podpisana z opcj\u0105 przed\u0142u\u017cenia po uzyskaniu warunk\xf3w przy\u0142\u0105czenia.","Rozpocz\u0119li\u015bmy coroczny monitoring ornitologiczny i chiropterologiczny.","Wie\u017ca pomiarowa zainstalowana, zbieramy dane wietrzno\u015bci przez minimum 12 miesi\u0119cy.","Analiza zacieniania wykaza\u0142a konieczno\u015b\u0107 odsuni\u0119cia instalacji od granicy lasu.","Optymalizacja zagospodarowania terenu pozwala na zwi\u0119kszenie mocy instalacji do 40 MW.","Shadow flicker w granicach dopuszczalnych norm odleg\u0142o\u015bciowych.","Model akustyczny wykaza\u0142 konieczno\u015b\u0107 ograniczenia mocy turbin w porze nocnej.","Projekt zgodny z miejscowym planem zagospodarowania przestrzennego.","Z\u0142o\u017cyli\u015bmy wniosek o decyzj\u0119 \u015brodowiskow\u0105 dla farmy PV o mocy 100 MW.","Konsultacje spo\u0142eczne planowane na przysz\u0142y miesi\u0105c w \u015bwietlicy gminnej.","Regionalna Dyrekcja Ochrony \u015arodowiska za\u017c\u0105da\u0142a uzupe\u0142nienia raportu OO\u015a.","Gmina wyda\u0142a pozytywn\u0105 opini\u0119 dla projektu magazynu energii BESS.","Z\u0142o\u017cyli\u015bmy wniosek o wydanie warunk\xf3w przy\u0142\u0105czenia do sieci 110 kV.","OSD za\u017c\u0105da\u0142 wykonania ekspertyzy wp\u0142ywu przy\u0142\u0105czenia na system elektroenergetyczny.","Mikrositing turbin wiatrowych zoptymalizowany pod k\u0105tem wydajno\u015bci parku.","Dob\xf3r falownik\xf3w z funkcj\u0105 Q(U) i P(f) zgodnie z wymogami NC RfG.","Uzyskali\u015bmy pozwolenie na budow\u0119 dla farmy PV o mocy 50 MW."],t="number"===typeof i.day?i.day:0,n="number"===typeof i.turn?i.turn:0,r=Array.isArray(e)?e:[];if(0===r.length)return{date:new Date,text:"Brak wpis\xf3w w pami\u0119tniku.",author:"System",projectReference:null};const a=(t+n)%r.length,s=(null===o||void 0===o?void 0:o.projects)||{},l=Array.isArray(s.inDevelopment)?s.inDevelopment:[],c=Array.isArray(s.underConstruction)?s.underConstruction:[],d=Array.isArray(s.completed)?s.completed:[];let u=null;l.length>0?u=l[0]:c.length>0?u=c[0]:d.length>0&&(u=d[0]);let h={date:new Date(i.gameDate||new Date),text:r[a],author:"Developer OZE",projectReference:u?u.name:null};if(u&&u.type)switch(u.type){case"PV":h.text+=" Projekt fotowoltaiczny wymaga szczeg\xf3lnej analizy nas\u0142onecznienia i k\u0105ta nachylenia paneli.";break;case"WF":h.text+=" Dla farm wiatrowych kluczowe jest zbadanie wietrzno\u015bci terenu przez minimum 12 miesi\u0119cy.";break;case"BESS":h.text+=" Magazyn energii wymaga szczeg\xf3lnego uwzgl\u0119dnienia infrastruktury przy\u0142\u0105czeniowej i bezpiecze\u0144stwa."}return h})():{date:new Date,text:"\u0141adowanie danych...",author:"System",projectReference:null}),[null===i||void 0===i?void 0:i.day,null===i||void 0===i?void 0:i.turn,null===o||void 0===o?void 0:o.projects]),e=>{if(!e||!e.type)return(0,a.jsx)(by,{size:16,className:"text-gray-500"});switch(e.type){case"staff_event":return(0,a.jsx)(Kf,{size:16,className:"text-indigo-500"});case"project_event":return(0,a.jsx)(Zy,{size:16,className:"text-teal-500"});case"economic_event":return(0,a.jsx)(ny,{size:16,className:"text-emerald-500"});case"audit_event":return(0,a.jsx)(uy,{size:16,className:"text-amber-500"});case"illegal_event":return(0,a.jsx)(Dg,{size:16,className:"text-rose-500"});case"law_change":return(0,a.jsx)(gy,{size:16,className:"text-blue-500"});case"market_change":return(0,a.jsx)(Rg,{size:16,className:"text-purple-500"});case"regional_event":return(0,a.jsx)(Wf,{size:16,className:"text-orange-500"});case"national_event":return(0,a.jsx)(Og,{size:16,className:"text-blue-500"});case"special_event":return(0,a.jsx)(Hf,{size:16,className:"text-red-500"});default:return(0,a.jsx)(by,{size:16,className:"text-gray-500"})}}),H=e=>{if(!e)return"text-blue-600 bg-blue-50 border-blue-200";switch(e){case"positive":return"text-green-600 bg-green-50 border-green-200";case"negative":case"high":return"text-red-600 bg-red-50 border-red-200";case"warning":case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"special":return"text-purple-600 bg-purple-50 border-purple-200";default:return"text-blue-600 bg-blue-50 border-blue-200"}},K=e=>{if(!e)return"Inne";return{staff_event:"Personel",project_event:"Projekt",economic_event:"Gospodarka",political_event:"Polityka",social_event:"Spo\u0142eczne",audit_event:"Audyt",illegal_event:"Naruszenie",law_change:"Prawodawstwo",market_change:"Rynek",regional_event:"Regionalne",national_event:"Krajowe",special_event:"Specjalne"}[e]||"Inne"},G=e=>{if(!e)return"Nieznany zasi\u0119g";switch(e){case"global":return"Globalny";case"national":return"Krajowy";case"regional":return"Regionalny";case"local":return"Lokalny";case"company":return"Firmowy";case"industry":return"Bran\u017cowy";default:return e}},Q=e=>{if(!e)return"Data nieznana";if(e instanceof Date||"number"===typeof e&&e>1e5){return new Date(e).toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"})}if(!i||!i.gameDate)return`Tura ${e}`;const t=(i.turn||0)-e,n=new Date(i.gameDate),r=new Date(n);return r.setDate(n.getDate()-2*t),r.toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"})},Z=e=>{let{effects:t,variant:n="list"}=e;if(!t||"object"!==typeof t)return(0,a.jsx)("div",{className:"text-gray-500 text-sm",children:"Brak danych o efektach"});const r=Object.entries(t).filter((e=>{let[t,n]=e;return void 0!==n}));if(0===r.length)return(0,a.jsx)("div",{className:"text-gray-500 text-sm",children:"Brak efekt\xf3w"});const i=e=>({marketModifier:"Wp\u0142yw na rynek",loanInterestRate:"Stopy procentowe",permitTimeModifier:"Czas uzyskania pozwole\u0144",reputationChange:"Zmiana reputacji",buildCostModifier:"Koszty budowy",projectEfficiency:"Efektywno\u015b\u0107 projektu",staffProductivity:"Produktywno\u015b\u0107 personelu"}[e]||e),s=(e,t)=>{if(e.includes("Modifier")){const e=(100*(t-1)).toFixed(1);return`${e>0?"+":""}${e}%`}return"reputationChange"===e||"projectEfficiency"===e||"staffProductivity"===e?`${t>0?"+":""}${t}`:t.toString()};return"grid"===n?(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:r.map((e=>{let[t,n]=e;return(0,a.jsxs)("div",{className:"flex justify-between p-2 bg-gray-100 rounded",children:[(0,a.jsxs)("span",{className:"font-medium",children:[i(t),":"]}),(0,a.jsx)("span",{className:n>1||n>0?"text-green-600 font-bold":"text-red-600 font-bold",children:s(t,n)})]},t)}))}):(0,a.jsx)("ul",{className:"list-disc pl-5 space-y-1",children:r.map((e=>{let[t,n]=e;return(0,a.jsxs)("li",{children:[(0,a.jsxs)("span",{className:"font-medium",children:[i(t),":"]}),(0,a.jsx)("span",{className:n>1||n>0?"text-green-600 ml-1":"text-red-600 ml-1",children:s(t,n)})]},t)}))})};(0,r.useMemo)((()=>{if(!O)return[];try{const e=O.severity||"medium",t="high"===e||"special"===e?3:"medium"===e?2:1,n=[];for(let r=0;r<t;r++)n.push(W(O.id+r));return n}catch(e){return console.error("B\u0142\u0105d przy generowaniu komentarzy:",e),[]}}),[O]),(0,r.useMemo)((()=>{if(!O)return null;const e={};try{switch(O.type){case"economic_event":e.marketModifier=1.05,e.loanInterestRate=.98;break;case"political_event":e.permitTimeModifier=1.1,e.reputationChange=-2;break;case"project_event":e.buildCostModifier=1.03,e.projectEfficiency=5;break;case"staff_event":e.staffProductivity=-3;break;default:Math.random()>.5&&(e.marketModifier=1.02)}return O.effects||e}catch(t){return console.error("B\u0142\u0105d przy generowaniu wp\u0142ywu globalnego:",t),{}}}),[O]),(0,r.useMemo)((()=>{if(!t||!Array.isArray(t.events))return[];try{return t.events.filter((e=>e&&(e.isMilestone||e.requiresDecision||"high"===e.severity||"special"===e.severity||"high"===e.priority))).sort(((e,t)=>{const n=e.turn||e.date||0;return(t.turn||t.date||0)-n})).slice(0,5)}catch(e){return console.error("B\u0142\u0105d przy generowaniu kamieni milowych:",e),[]}}),[null===t||void 0===t?void 0:t.events]);return(0,a.jsxs)("div",{style:Fg.container,className:"events-view-container",children:[(0,a.jsxs)("div",{style:Fg.header,className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Panel Wydarze\u0144"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"\u015aled\u017a wa\u017cne wydarzenia w bran\u017cy OZE i reaguj na zmieniaj\u0105c\u0105 si\u0119 sytuacj\u0119"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("div",{className:"relative mr-2",children:[(0,a.jsx)("input",{type:"text",value:f,onChange:e=>y(e.target.value),placeholder:"Szukaj wydarze\u0144...",className:"border rounded pl-9 pr-3 py-1.5 w-64"}),(0,a.jsx)(yg,{className:"h-4 w-4 text-gray-400 absolute top-2 left-3"})]}),(0,a.jsxs)("button",{onClick:()=>v(!g),className:"flex items-center rounded border px-3 py-1.5 hover:bg-gray-50",children:[(0,a.jsx)(fg,{className:"h-4 w-4 mr-1"}),"Filtry"]})]})]}),(0,a.jsxs)("div",{style:Fg.tabsContainer,className:"overflow-x-auto whitespace-nowrap",children:[(0,a.jsx)("button",{onClick:()=>_("all"),className:"px-4 py-2 font-medium "+("all"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(Og,{size:16,className:"mr-1"}),"Wszystkie",(0,a.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(U)?U.length:0})]})}),(0,a.jsx)("button",{onClick:()=>_("krajowe"),className:"px-4 py-2 font-medium "+("krajowe"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(Og,{size:16,className:"mr-1"}),"Krajowe",(0,a.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(null===V||void 0===V?void 0:V.national)?V.national.length:0})]})}),(0,a.jsx)("button",{onClick:()=>_("regionalne"),className:"px-4 py-2 font-medium "+("regionalne"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(Wf,{size:16,className:"mr-1"}),"Regionalne",(0,a.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(null===V||void 0===V?void 0:V.regional)?V.regional.length:0})]})}),(0,a.jsx)("button",{onClick:()=>_("lokalne"),className:"px-4 py-2 font-medium "+("lokalne"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(Wf,{size:16,className:"mr-1"}),"Lokalne",(0,a.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(null===V||void 0===V?void 0:V.local)?V.local.length:0})]})}),(0,a.jsx)("button",{onClick:()=>_("organizacja"),className:"px-4 py-2 font-medium "+("organizacja"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(gy,{size:16,className:"mr-1"}),"Organizacja",(0,a.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(null===V||void 0===V?void 0:V.organization)?V.organization.length:0})]})}),(0,a.jsx)("button",{onClick:()=>_("projekty"),className:"px-4 py-2 font-medium "+("projekty"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(Zy,{size:16,className:"mr-1"}),"Projekty",(0,a.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(null===V||void 0===V?void 0:V.projects)?V.projects.length:0})]})}),(0,a.jsx)("button",{onClick:()=>_("specjalne"),className:"px-4 py-2 font-medium "+("specjalne"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(Dg,{size:16,className:"mr-1"}),"Specjalne",(0,a.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(null===V||void 0===V?void 0:V.special)?V.special.length:0})]})})]}),g&&(0,a.jsx)("div",{className:"p-3 border-b",ref:R,children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Typ wydarzenia"}),(0,a.jsxs)("select",{value:w,onChange:e=>x(e.target.value),className:"w-full border rounded px-2 py-1.5 text-sm",children:[(0,a.jsx)("option",{value:"all",children:"Wszystkie typy"}),(0,a.jsx)("option",{value:"economic_event",children:"Ekonomiczne"}),(0,a.jsx)("option",{value:"political_event",children:"Polityczne"}),(0,a.jsx)("option",{value:"social_event",children:"Spo\u0142eczne"}),(0,a.jsx)("option",{value:"environmental_event",children:"\u015arodowiskowe"}),(0,a.jsx)("option",{value:"technological_event",children:"Technologiczne"}),(0,a.jsx)("option",{value:"project_event",children:"Projektowe"}),(0,a.jsx)("option",{value:"staff_event",children:"Kadrowe"}),(0,a.jsx)("option",{value:"reputation_event",children:"Reputacyjne"}),(0,a.jsx)("option",{value:"special_event",children:"Specjalne"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Priorytet"}),(0,a.jsxs)("select",{value:b,onChange:e=>j(e.target.value),className:"w-full border rounded px-2 py-1.5 text-sm",children:[(0,a.jsx)("option",{value:"all",children:"Wszystkie priorytety"}),(0,a.jsx)("option",{value:"high",children:"Wysoki"}),(0,a.jsx)("option",{value:"medium",children:"\u015aredni"}),(0,a.jsx)("option",{value:"low",children:"Niski"})]})]}),"regionalne"===z&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Wojew\xf3dztwo"}),(0,a.jsxs)("select",{value:k,onChange:e=>N(e.target.value),className:"w-full border rounded px-2 py-1.5 text-sm",children:[(0,a.jsx)("option",{value:"all",children:"Wszystkie wojew\xf3dztwa"}),B.map((e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id)))]})]})]})}),(0,a.jsx)("div",{style:Fg.mainContent,className:"flex-grow overflow-hidden",children:(0,a.jsxs)("div",{className:"flex gap-4 h-full",children:[(0,a.jsx)("div",{style:Fg.eventsList,className:"transition-all duration-300 ease-in-out "+(O?"w-1/2":"w-full"),children:(0,a.jsx)("div",{children:Array.isArray($)&&$.length>0?$.map((e=>(0,a.jsxs)("div",{className:"mb-3 p-3 border rounded-lg cursor-pointer transition-shadow hover:shadow-md "+(null!==e&&void 0!==e&&e.read?"bg-white":"bg-blue-50"),onClick:()=>{e&&(L(e),!e.read&&n&&n({type:"MARK_EVENT_READ",payload:e.id}))},children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:`flex h-6 w-6 rounded-full items-center justify-center ${H((null===e||void 0===e?void 0:e.severity)||"neutral")}`,children:q(e)}),(0,a.jsx)("h3",{className:"font-medium ml-2 flex-1",children:(null===e||void 0===e?void 0:e.title)||"Wydarzenie bez tytu\u0142u"})]}),(0,a.jsx)("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:Q((null===e||void 0===e?void 0:e.turn)||new Date)})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:(null===e||void 0===e?void 0:e.description)||"Brak opisu"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[(null===e||void 0===e?void 0:e.scope)&&(0,a.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 rounded-full text-xs",children:G(e.scope)}),(null===e||void 0===e?void 0:e.type)&&(0,a.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 rounded-full text-xs",children:K(e.type)}),(null===e||void 0===e?void 0:e.requiresDecision)&&(0,a.jsx)("span",{className:"px-2 py-0.5 bg-red-100 text-red-800 rounded-full text-xs",children:"Wymaga decyzji"})]})]},(null===e||void 0===e?void 0:e.id)||Math.random().toString()))):(0,a.jsxs)("div",{style:Fg.noEvents,children:[(0,a.jsx)(Lg,{className:"h-12 w-12 text-gray-300 mb-2"}),(0,a.jsx)("h3",{className:"text-lg font-medium mb-1",children:"Brak wydarze\u0144"}),(0,a.jsx)("p",{className:"text-sm",children:"Nie ma obecnie \u017cadnych wydarze\u0144 do wy\u015bwietlenia w wybranej kategorii."})]})})}),O&&(0,a.jsxs)("div",{style:Fg.eventDetails,className:"animate-slide-in",ref:D,children:[(0,a.jsxs)("div",{className:"mb-4 pb-3 border-b flex justify-between items-start",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:O.title||"Szczeg\xf3\u0142y wydarzenia"}),(0,a.jsx)("button",{onClick:()=>L(null),className:"p-1 hover:bg-gray-100 rounded",children:(0,a.jsx)(vy,{size:18})})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-gray-700 mb-4",children:O.description}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,a.jsx)(Ff,{size:16,className:"mr-1"}),(0,a.jsxs)("span",{children:["Data: ",Q(O.turn||new Date)]})]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,a.jsx)(Uf,{size:16,className:"mr-1"}),(0,a.jsxs)("span",{children:["Wygasa: ",O.expires?Q(O.expires):"Nigdy"]})]}),O.region&&(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,a.jsx)(Wf,{size:16,className:"mr-1"}),(0,a.jsxs)("span",{children:["Region: ",O.region]})]}),O.projectId&&(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,a.jsx)(Zy,{size:16,className:"mr-1"}),(0,a.jsxs)("span",{children:["Projekt: ",O.projectName||O.projectId]})]}),(0,a.jsxs)("div",{className:"mt-3 flex flex-wrap gap-1",children:[O.scope&&(0,a.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 rounded-full text-xs",children:G(O.scope)}),O.type&&(0,a.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 rounded-full text-xs",children:K(O.type)}),O.severity&&(0,a.jsx)("span",{className:`px-2 py-0.5 rounded-full text-xs ${H(O.severity)}`,children:translateSeverity(O.severity)})]})]}),O.effects&&Object.keys(O.effects).length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Efekty wydarzenia:"}),(0,a.jsx)(Z,{effects:O.effects})]}),O.requiresDecision&&O.decisions&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Wymagana decyzja:"}),(0,a.jsx)("div",{className:"space-y-2",children:O.decisions.map((e=>(0,a.jsxs)("button",{className:"w-full p-3 border rounded hover:bg-gray-50 text-left flex justify-between items-center",onClick:()=>(e=>{if(O&&O.options&&n)try{if(!O.options.find((t=>t.id===e)))return;n({type:"EVENT_DECISION",payload:{eventId:O.id,optionId:e}}),L(null)}catch(t){console.error("B\u0142\u0105d przy podejmowaniu decyzji:",t)}})(O.id,e.id),children:[(0,a.jsx)("span",{children:e.label}),(0,a.jsx)("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:e.effects.reputationImpact?`Reputacja: ${e.effects.reputationImpact>0?"+":""}${e.effects.reputationImpact}`:e.effects.cashImpact?`Got\xf3wka: ${e.effects.cashImpact>0?"+":""}${e.effects.cashImpact.toLocaleString()} PLN`:"Efekt specjalny"})]},e.id)))})]})]})]})})]})};class Hg extends r.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("B\u0142\u0105d w EventsView:",e,t)}render(){return this.state.hasError?(0,a.jsxs)("div",{className:"p-8 flex flex-col items-center justify-center",children:[(0,a.jsx)(Dg,{className:"w-16 h-16 text-red-500 mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-bold text-red-700 mb-2",children:"B\u0142\u0105d w panelu wydarze\u0144"}),(0,a.jsx)("p",{className:"text-gray-600 text-center mb-4",children:"Panel wydarze\u0144 wymaga odpowiednich kontekst\xf3w aplikacji. Upewnij si\u0119, \u017ce komponent jest u\u017cywany wewn\u0105trz:"}),(0,a.jsxs)("ul",{className:"list-disc pl-5 text-gray-600 mb-4",children:[(0,a.jsx)("li",{children:"EventsProvider"}),(0,a.jsx)("li",{children:"GameProvider"}),(0,a.jsx)("li",{children:"PlayerProvider"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:this.state.error?this.state.error.message:"Nieznany b\u0142\u0105d"})]}):this.props.children}}const Kg=e=>e&&"object"===typeof e,Gg=(e,t)=>{try{const n=e();return n||(console.warn(`${t} nie jest dost\u0119pny`),null)}catch(n){return console.error(`B\u0142\u0105d przy pobieraniu ${t}:`,n),null}},Qg=()=>{const[e,t]=(0,r.useState)(null),[n,i]=(0,r.useState)(!1),[s,o]=(0,r.useState)(null),l=Gg(q,"EventsContext"),c=Gg(mf,"GameContext"),u=Gg(d,"PlayerContext");(0,r.useEffect)((()=>{try{const e=()=>{t(null)};return window.addEventListener("next-game-day",e),l&&c&&u?i(!0):o("Brak wymaganych kontekst\xf3w"),()=>{window.removeEventListener("next-game-day",e)}}catch(s){console.error("B\u0142\u0105d w useEffect EventsView:",s),o(s.message||"Nieznany b\u0142\u0105d")}}),[l,c,u]);const h=e=>{let{message:t}=e;return(0,a.jsxs)("div",{className:"p-8 flex flex-col items-center justify-center",children:[(0,a.jsx)(Dg,{className:"w-16 h-16 text-red-500 mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-bold text-red-700 mb-2",children:"B\u0142\u0105d kontekstu"}),(0,a.jsx)("p",{className:"text-gray-600 text-center mb-4",children:"Panel wydarze\u0144 wymaga odpowiednich kontekst\xf3w aplikacji. Upewnij si\u0119, \u017ce komponent jest u\u017cywany wewn\u0105trz:"}),(0,a.jsxs)("ul",{className:"list-disc pl-5 text-gray-600 mb-4",children:[(0,a.jsx)("li",{children:"EventsProvider"}),(0,a.jsx)("li",{children:"GameProvider"}),(0,a.jsx)("li",{children:"PlayerProvider"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:t})]})};return s?(0,a.jsx)(h,{message:s}):n?Kg(null===l||void 0===l?void 0:l.state)&&null!==l&&void 0!==l&&l.dispatch?Kg(null===c||void 0===c?void 0:c.state)&&null!==c&&void 0!==c&&c.dispatch?Kg(null===u||void 0===u?void 0:u.state)&&null!==u&&void 0!==u&&u.dispatch?(Array.isArray(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{const r=t.split(".");let i=e;for(const e of r){if(null===i||void 0===i)return n;i=i[e]}return null===i||void 0===i?n:i}catch(r){return console.error(`B\u0142\u0105d dost\u0119pu do \u015bcie\u017cki: ${t}`,r),n}}(l,"state.events"))||(console.warn("Events w EventsContext nie jest tablic\u0105. Inicjalizacja pust\u0105 tablic\u0105."),l.state&&(l.state.events=[])),(0,a.jsx)(Hg,{children:(0,a.jsx)(Wg,{eventsState:l.state,eventsDispatch:l.dispatch,gameState:c.state,gameDispatch:c.dispatch,playerState:u.state,playerDispatch:u.dispatch,selectedEvent:e,setSelectedEvent:t})})):(0,a.jsx)(h,{message:"PlayerContext jest niekompletny"}):(0,a.jsx)(h,{message:"GameContext jest niekompletny"}):(0,a.jsx)(h,{message:"EventsContext jest niekompletny"}):(0,a.jsxs)("div",{className:"p-8 flex flex-col items-center justify-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500 mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"\u0141adowanie panelu wydarze\u0144..."})]})},Zg=()=>(0,a.jsx)(Hg,{children:(0,a.jsx)(Qg,{})}),Yg=e=>{let{competitor:t,playerPower:n}=e;return(0,a.jsxs)("div",{className:"border rounded p-3",children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:t.name}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:"Strategia:"})," ",Ry(t.strategy)]}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:"Reputacja:"})," ",t.reputation,"/100"]}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:"Tempo wzrostu:"})," ",(100*(t.growth-1)).toFixed(1),"% na tur\u0119"]}),(0,a.jsx)("div",{className:"text-sm",children:(0,a.jsx)("span",{className:"font-medium",children:"Silne regiony:"})}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:t.strongRegions.map((e=>(0,a.jsx)("div",{className:"text-xs bg-gray-200 px-2 py-1 rounded",children:e},e)))}),(0,a.jsx)("div",{className:"text-sm mt-2 text-gray-600 italic",children:Oy(t,n)})]})]})},Jg=e=>{let{ranking:t}=e;return(0,a.jsxs)("div",{className:"bg-white p-4 rounded shadow mb-4",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-3",children:"Ranking deweloper\xf3w OZE"}),(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-100",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-center p-2",children:"Miejsce"}),(0,a.jsx)("th",{className:"text-left p-2",children:"Firma"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Moc RTB"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Portfel projekt\xf3w"}),(0,a.jsx)("th",{className:"text-right p-2",children:"Udzia\u0142 w rynku"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:t.map(((e,n)=>{const r="player"===e.id,i=(e.rtbPower/t.reduce(((e,t)=>e+t.rtbPower),0)*100).toFixed(1);return(0,a.jsxs)("tr",{className:""+(r?"bg-blue-50":"hover:bg-gray-50"),children:[(0,a.jsx)("td",{className:"text-center p-2 font-medium",children:n+1}),(0,a.jsx)("td",{className:"p-2",children:r?(0,a.jsx)("div",{className:"font-bold text-blue-600",children:e.name}):e.name}),(0,a.jsxs)("td",{className:"text-center p-2",children:[e.rtbPower.toLocaleString()," MW"]}),(0,a.jsxs)("td",{className:"text-center p-2",children:[e.power.toLocaleString()," MW"]}),(0,a.jsx)("td",{className:"text-right p-2",children:(0,a.jsxs)("div",{className:"flex items-center justify-end",children:[(0,a.jsxs)("div",{children:[i,"%"]}),(0,a.jsx)("div",{className:"ml-2 w-16 bg-gray-200 h-2 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full "+(r?"bg-blue-500":"bg-gray-500"),style:{width:`${i}%`}})})]})})]},e.id)}))})]})]})},Xg=e=>{let{playerRank:t,ranking:n,playerPower:r}=e;return(0,a.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Twoja pozycja na rynku"}),1===t?(0,a.jsxs)("div",{className:"p-3 bg-green-100 text-green-800 rounded",children:[(0,a.jsx)("div",{className:"font-bold",children:"Jeste\u015b liderem rynku!"}),(0,a.jsx)("p",{className:"text-sm mt-1",children:"Utrzymuj przewag\u0119 nad konkurencj\u0105 rozwijaj\u0105c projekty w r\xf3\u017cnych regionach."})]}):(0,a.jsxs)("div",{className:"p-3 bg-blue-100 text-blue-800 rounded",children:[(0,a.jsxs)("div",{className:"font-bold",children:["Jeste\u015b na ",t,". miejscu"]}),(0,a.jsxs)("p",{className:"text-sm mt-1",children:["Do lidera brakuje Ci ",(n[0].rtbPower-r).toLocaleString()," MW mocy w projektach RTB."]})]}),(0,a.jsxs)("div",{className:"mt-3 text-sm",children:[(0,a.jsxs)("p",{children:["Tw\xf3j udzia\u0142 w rynku: ",(r/n.reduce(((e,t)=>e+t.rtbPower),0)*100).toFixed(1),"%"]}),(0,a.jsx)("p",{className:"mt-1",children:"Tempo wzrostu twojego portfela zale\u017cy od liczby projekt\xf3w i zatrudnionych specjalist\xf3w."})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("div",{className:"font-medium mb-2",children:"Post\u0119p do celu (100 GW):"}),(0,a.jsx)("div",{className:"w-full bg-gray-200 h-4 rounded-full overflow-hidden mt-1",children:(0,a.jsx)("div",{className:"h-full bg-green-500 relative",style:{width:`${Math.min(100,r/1e5*100)}%`},children:(0,a.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center text-xs text-white font-bold",children:[(r/1e5*100).toFixed(1),"%"]})})})]})]})},ev=e=>{let{competitors:t,playerPower:n}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Analiza konkurent\xf3w"}),(0,a.jsx)("ul",{className:"text-sm space-y-2",children:t.map((e=>(0,a.jsxs)("li",{className:"flex",children:[(0,a.jsx)("div",{className:"text-blue-600 font-bold mr-2",children:"\u2022"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"font-medium",children:[e.name,":"]})," ",Oy(e,n)]})]},e.id)))})]}),(0,a.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Porady strategiczne"}),(0,a.jsxs)("ul",{className:"text-sm space-y-2",children:[(0,a.jsxs)("li",{className:"flex",children:[(0,a.jsx)("div",{className:"text-green-600 font-bold mr-2",children:"\u2022"}),(0,a.jsx)("div",{children:"Skupiaj si\u0119 na regionach z dobrymi warunkami wiatrowymi/s\u0142onecznymi i nisk\u0105 konkurencj\u0105."})]}),(0,a.jsxs)("li",{className:"flex",children:[(0,a.jsx)("div",{className:"text-green-600 font-bold mr-2",children:"\u2022"}),(0,a.jsx)("div",{children:"Zatrudniaj do\u015bwiadczonych specjalist\xf3w, aby przyspieszy\u0107 rozw\xf3j projekt\xf3w."})]}),(0,a.jsxs)("li",{className:"flex",children:[(0,a.jsx)("div",{className:"text-green-600 font-bold mr-2",children:"\u2022"}),(0,a.jsx)("div",{children:"Dywersyfikuj portfolio projekt\xf3w geograficznie, aby minimalizowa\u0107 ryzyko."})]}),(0,a.jsxs)("li",{className:"flex",children:[(0,a.jsx)("div",{className:"text-green-600 font-bold mr-2",children:"\u2022"}),(0,a.jsx)("div",{children:"Monitoruj ruchy konkurencji i unikaj region\xf3w, w kt\xf3rych s\u0105 dominuj\u0105cy gracze."})]}),(0,a.jsxs)("li",{className:"flex",children:[(0,a.jsx)("div",{className:"text-green-600 font-bold mr-2",children:"\u2022"}),(0,a.jsx)("div",{children:"Inwestuj w projekty z wysokim ROI, aby maksymalizowa\u0107 zwrot z inwestycji."})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Cel gry"}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("p",{children:"Twoim celem jest osi\u0105gni\u0119cie 100,000 MW (100 GW) mocy w projektach RTB jako pierwszy deweloper."}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("div",{className:"font-medium",children:"Post\u0119p do celu:"}),(0,a.jsx)("div",{className:"w-full bg-gray-200 h-4 rounded-full overflow-hidden mt-1",children:(0,a.jsx)("div",{className:"h-full bg-green-500 relative",style:{width:`${Math.min(100,n/1e5*100)}%`},children:(0,a.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center text-xs text-white font-bold",children:[(n/1e5*100).toFixed(1),"%"]})})})]})]})]})]})},tv=()=>{const{state:e}=mf(),{state:t}=d(),n=[...e.competitors].sort(((e,t)=>t.rtbPower-e.rtbPower)),r=[...n,{id:"player",name:"Twoja firma",rtbPower:t.rtbPower,power:1.2*t.rtbPower}].sort(((e,t)=>t.rtbPower-e.rtbPower)),i=r.findIndex((e=>"player"===e.id))+1;return(0,a.jsxs)("div",{className:"flex flex-1",children:[(0,a.jsxs)("div",{className:"flex-1 p-4 overflow-y-auto",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Analiza konkurencji"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Twoja pozycja"}),(0,a.jsxs)("div",{className:"text-xl font-bold",children:[i," miejsce"]})]}),(0,a.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Twoja moc RTB"}),(0,a.jsxs)("div",{className:"text-xl font-bold",children:[t.rtbPower.toLocaleString()," MW"]})]}),(0,a.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Lider rynku"}),(0,a.jsx)("div",{className:"text-xl font-bold",children:r[0].name}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[r[0].rtbPower.toLocaleString()," MW"]})]})]}),(0,a.jsx)(Jg,{ranking:r}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-3",children:"Strategie konkurent\xf3w"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-4",children:n.map((e=>(0,a.jsx)(Yg,{competitor:e,playerPower:t.rtbPower},e.id)))})]})]}),(0,a.jsxs)("div",{className:"w-1/3 bg-gray-100 p-4 overflow-y-auto",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Analiza rynku i porady"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(Xg,{playerRank:i,ranking:r,playerPower:t.rtbPower}),(0,a.jsx)(ev,{competitors:n,playerPower:t.rtbPower})]})]})]})},nv=e=>{let{children:t,title:n,className:r="",headerAction:i=null,footer:s=null,...o}=e;return(0,a.jsxs)("div",{className:`bg-white p-4 rounded shadow ${r}`,...o,children:[n&&(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,a.jsx)("h3",{className:"font-bold text-lg",children:n}),i]}),(0,a.jsx)("div",{className:"card-content",children:t}),s&&(0,a.jsx)("div",{className:"card-footer mt-4 pt-3 border-t border-gray-200",children:s})]})},rv=()=>{const{state:e,dispatch:t}=d(),{state:n,dispatch:i,showNotification:s,calculateEventsEffect:o}=mf(),{dispatch:l}=q(),[c,u]=(0,r.useState)("all"),[h,p]=(0,r.useState)("power"),[m,f]=(0,r.useState)("desc"),y=[...e.projects.filter((e=>"all"===c||("pv"===c?"PV"===e.technology:"wf"===c?"WF"===e.technology:"rtb"!==c||"ready_to_build"===e.status)))].sort(((e,t)=>{if("power"===h)return"asc"===m?e.power-t.power:t.power-e.power;if("price"===h)return"asc"===m?e.totalCost-t.totalCost:t.totalCost-e.totalCost;if("stage"===h){const n=["land_acquisition","environmental_decision","zoning_conditions","grid_connection","ready_to_build"],r=n.indexOf(e.status),i=n.indexOf(t.status);return"asc"===m?r-i:i-r}return 0})),g=t=>{var r;const i=15e4*t.power,a=o("marketModifier"),c={PV:1*n.marketPriceModifiers.PV*a,WF:1.2*n.marketPriceModifiers.WF*a,BESS:1.5*n.marketPriceModifiers.BESS*a},d=1;n.globalEvents.currentEvents.length>0&&n.globalEvents.currentEvents.forEach((e=>{const n=e.getEffect();n.technologyEffect&&n.technologyEffect.technology===t.technology&&n.technologyEffect.marketModifier&&(d*=n.technologyEffect.marketModifier)}));const u={land_acquisition:.15,environmental_decision:.35,zoning_conditions:.55,grid_connection:.85,ready_to_build:1}[t.status]||.1,h=c[t.technology]*d||1,p=1+t.power/100*.2;let m=1;n.globalEvents.currentEvents.length>0&&n.globalEvents.currentEvents.forEach((e=>{const n=e.getEffect();n.regionalEffect&&n.regionalEffect.region===t.regionId&&n.regionalEffect.marketModifier&&(m*=n.regionalEffect.marketModifier)}));const f=null===(r=e.staff.developers)||void 0===r?void 0:r.find((e=>e.id===t.assignedDeveloper)),y=f?1+f.skill/20:1;let g=null,v=1;const w=n.globalEvents.currentEvents.length>0?.05:.1;if(Math.random()<w){g=[{name:"Nag\u0142y spadek cen energii",impact:.85,description:"Ceny energii na rynku spad\u0142y o 15%, obni\u017caj\u0105c warto\u015b\u0107 projekt\xf3w OZE."},{name:"Zmiana regulacji",impact:.8,description:"Niekorzystne zmiany w ustawie o OZE obni\u017cy\u0142y warto\u015b\u0107 projekt\xf3w."},{name:"Lokalne protesty",impact:.9,description:"Protesty mieszka\u0144c\xf3w zniech\u0119caj\u0105 potencjalnych inwestor\xf3w."},{name:"Problem geologiczny",impact:.7,description:"Wykryto potencjalne problemy geologiczne na terenie projektu."},{name:"Korzystna zmiana warunk\xf3w aukcji",impact:1.15,description:"Planowane aukcje OZE z korzystnymi warunkami podnios\u0142y warto\u015b\u0107 projektu."},{name:"Wzmo\u017cone zainteresowanie inwestor\xf3w",impact:1.2,description:"Duzi inwestorzy poszukuj\u0105 projekt\xf3w w tym regionie."}][Math.random()<.7?Math.floor(4*Math.random()):Math.floor(2*Math.random())+4],v=g.impact}const x=Math.floor(i*u*h*p*m*y*v);if(g){const e=v<1?"warning":"positive";l({type:"ADD_EVENT",payload:{id:Date.now()+Math.random(),type:"economic_event",title:g.name,description:g.description,severity:e,turn:n.turn,expires:n.turn+10,projectId:t.id,effect:{type:"market_price_modifier",value:v,technology:t.technology}}}),s(`${g.name}: ${g.description} Wp\u0142yw na cen\u0119: ${(100*g.impact).toFixed(0)}%`,e)}return x},v=e=>{switch(e){case"land_acquisition":return(0,a.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:"Pozyskiwanie grunt\xf3w"});case"environmental_decision":return(0,a.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs",children:"Decyzja \u015brodowiskowa"});case"zoning_conditions":return(0,a.jsx)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs",children:"Warunki zabudowy"});case"grid_connection":return(0,a.jsx)("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 rounded-full text-xs",children:"Przy\u0142\u0105czenie"});case"ready_to_build":return(0,a.jsx)("span",{className:"px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs",children:"RTB"});default:return(0,a.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 rounded-full text-xs",children:e})}};return(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Sprzeda\u017c projekt\xf3w na gie\u0142dzie"}),(0,a.jsx)("div",{className:"bg-white p-4 rounded shadow mb-4",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Filtruj"}),(0,a.jsxs)("select",{value:c,onChange:e=>u(e.target.value),className:"border rounded px-2 py-1",children:[(0,a.jsx)("option",{value:"all",children:"Wszystkie projekty"}),(0,a.jsx)("option",{value:"pv",children:"Tylko PV"}),(0,a.jsx)("option",{value:"wf",children:"Tylko wiatrowe"}),(0,a.jsx)("option",{value:"rtb",children:"Tylko RTB"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Sortuj wed\u0142ug"}),(0,a.jsxs)("select",{value:h,onChange:e=>p(e.target.value),className:"border rounded px-2 py-1",children:[(0,a.jsx)("option",{value:"power",children:"Mocy [MW]"}),(0,a.jsx)("option",{value:"price",children:"Ceny"}),(0,a.jsx)("option",{value:"stage",children:"Etapu"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Kolejno\u015b\u0107"}),(0,a.jsxs)("select",{value:m,onChange:e=>f(e.target.value),className:"border rounded px-2 py-1",children:[(0,a.jsx)("option",{value:"asc",children:"Rosn\u0105co"}),(0,a.jsx)("option",{value:"desc",children:"Malej\u0105co"})]})]})]})}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded shadow mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-bold mb-3",children:"Aktualna wycena projekt\xf3w"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Warto\u015b\u0107 projekt\xf3w zale\u017cy od etapu rozwoju, technologii, lokalizacji i jako\u015bci pracy developera. Rynek mo\u017ce ulega\u0107 wahaniom w zale\u017cno\u015bci od zdarze\u0144 ekonomicznych."}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[(0,a.jsxs)("div",{className:"border rounded p-3",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Etap RTB"}),(0,a.jsx)("div",{className:"font-bold",children:"x10 wy\u017csza wycena"})]}),(0,a.jsxs)("div",{className:"border rounded p-3",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Technologia"}),(0,a.jsx)("div",{className:"font-bold",children:"PV: x1.0 | WF: x1.2 | BESS: x1.5"})]}),(0,a.jsxs)("div",{className:"border rounded p-3",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Umiej\u0119tno\u015bci developera"}),(0,a.jsx)("div",{className:"font-bold",children:"do +50% dla eksperta"})]}),(0,a.jsxs)("div",{className:"border rounded p-3",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Wielko\u015b\u0107 projektu"}),(0,a.jsx)("div",{className:"font-bold",children:"+20% dla 100MW"})]})]})]}),(0,a.jsx)("div",{className:"bg-white rounded shadow overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-100",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left p-3",children:"Projekt"}),(0,a.jsx)("th",{className:"text-center p-3",children:"Technologia"}),(0,a.jsx)("th",{className:"text-center p-3",children:"Moc"}),(0,a.jsx)("th",{className:"text-center p-3",children:"Status"}),(0,a.jsx)("th",{className:"text-right p-3",children:"Cena sprzeda\u017cy"}),(0,a.jsx)("th",{className:"text-right p-3",children:"Zysk"}),(0,a.jsx)("th",{className:"text-center p-3",children:"Akcje"})]})}),(0,a.jsx)("tbody",{className:"divide-y",children:y.length>0?y.map((r=>{const o=g(r),c=o-r.totalCost,d=(c/r.totalCost*100).toFixed(1),u=["land_acquisition","environmental_decision","zoning_conditions","grid_connection","ready_to_build"],h=u.indexOf("environmental_decision"),p=u.indexOf(r.status)>=h;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsxs)("td",{className:"p-3",children:[(0,a.jsx)("div",{className:"font-medium",children:r.name}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:r.county?`Powiat ${r.county.name}`:"Brak lokalizacji"})]}),(0,a.jsx)("td",{className:"text-center p-3",children:r.technology}),(0,a.jsxs)("td",{className:"text-center p-3",children:[r.power," MW"]}),(0,a.jsx)("td",{className:"text-center p-3",children:v(r.status)}),(0,a.jsxs)("td",{className:"text-right p-3 font-medium",children:[o.toLocaleString()," PLN"]}),(0,a.jsxs)("td",{className:"text-right p-3",children:[(0,a.jsxs)("div",{className:c>=0?"text-green-600":"text-red-600",children:[c.toLocaleString()," PLN"]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[d,"%"]})]}),(0,a.jsx)("td",{className:"text-center p-3",children:(0,a.jsx)("button",{onClick:()=>(r=>{const a=e.projects.find((e=>e.id===r));if(!a)return;const o=["land_acquisition","environmental_decision","zoning_conditions","grid_connection","ready_to_build"],c=o.indexOf("environmental_decision");if(o.indexOf(a.status)<c)return void s(`Nie mo\u017cna sprzeda\u0107 projektu na etapie "${Ay(a.status)}". Projekt musi osi\u0105gn\u0105\u0107 co najmniej etap decyzji \u015brodowiskowej.`,"error");const d=g(a);i({type:"ADD_MARKET_TRANSACTION",payload:{id:Date.now(),projectId:a.id,projectName:a.name,technology:a.technology,power:a.power,status:a.status,price:d,turn:n.turn,seller:"player",date:(new Date).toISOString()}}),t({type:"SELL_PROJECT",payload:{projectId:a.id,price:d}}),a.county,l({type:"ADD_EVENT",payload:{id:Date.now()+Math.random(),type:"project_event",title:`Sprzeda\u017c projektu: ${a.name}`,description:`Projekt ${a.name} zosta\u0142 sprzedany za ${d.toLocaleString()} z\u0142.`,severity:"positive",turn:n.turn,expires:n.turn+5,projectId:a.id}}),s(`Sprzedano projekt "${a.name}" za ${d.toLocaleString()} PLN na gie\u0142dzie`,"success")})(r.id),className:`px-3 py-1 ${p?"bg-green-500 hover:bg-green-600":"bg-gray-400 cursor-not-allowed"} text-white rounded text-sm`,disabled:!p,title:p?"":"Projekt musi osi\u0105gn\u0105\u0107 etap decyzji \u015brodowiskowej",children:"Sprzedaj"})})]},r.id)})):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"7",className:"p-4 text-center text-gray-500",children:"Brak projekt\xf3w spe\u0142niaj\u0105cych kryteria filtrowania"})})})]})}),(0,a.jsxs)("div",{className:"bg-white rounded shadow overflow-hidden mt-6",children:[(0,a.jsx)("div",{className:"p-4 border-b",children:(0,a.jsx)("h3",{className:"text-lg font-bold",children:"Historia sprzeda\u017cy"})}),n.marketHistory.length>0?(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-100",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left p-3",children:"Projekt"}),(0,a.jsx)("th",{className:"text-center p-3",children:"Technologia"}),(0,a.jsx)("th",{className:"text-center p-3",children:"Moc"}),(0,a.jsx)("th",{className:"text-center p-3",children:"Status"}),(0,a.jsx)("th",{className:"text-right p-3",children:"Cena"}),(0,a.jsx)("th",{className:"text-center p-3",children:"Tura"})]})}),(0,a.jsx)("tbody",{className:"divide-y",children:n.marketHistory.map((e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"p-3",children:e.projectName}),(0,a.jsx)("td",{className:"text-center p-3",children:e.technology}),(0,a.jsxs)("td",{className:"text-center p-3",children:[e.power," MW"]}),(0,a.jsx)("td",{className:"text-center p-3",children:v(e.status)}),(0,a.jsxs)("td",{className:"text-right p-3 font-medium",children:[e.price.toLocaleString()," PLN"]}),(0,a.jsx)("td",{className:"text-center p-3",children:e.turn})]},e.id)))})]}):(0,a.jsx)("p",{className:"p-4 text-center text-gray-500",children:"Brak historii transakcji"})]})]})},iv=()=>{const[e,t]=(0,r.useState)("available"),[n,i]=(0,r.useState)("all"),[s,o]=(0,r.useState)("all"),{state:l,dispatch:c}=d(),{state:u,showNotification:h}=mf(),p=["land_acquisition","environmental_decision","zoning_conditions","grid_connection","ready_to_build","constructed"],[m,f]=(0,r.useState)([{id:1,name:"PV-MAZ1234",technology:"PV",status:"greenfield",developmentStatus:"land_acquisition",developmentProgress:0,region:"mazowieckie",power:15,price:225e3,seller:"Inny deweloper",listedOn:new Date(2025,2,1)},{id:2,name:"WF-ZAP4321",technology:"WF",status:"development",developmentStatus:"environmental_decision",developmentProgress:35,region:"zachodniopomorskie",power:30,price:1392e3,seller:"Fundusz inwestycyjny",listedOn:new Date(2025,2,5)},{id:3,name:"BESS-MAL5678",technology:"BESS",status:"development",developmentStatus:"zoning_conditions",developmentProgress:65,region:"ma\u0142opolskie",power:10,price:4e6,seller:"Prywatny inwestor",listedOn:new Date(2025,2,8)},{id:4,name:"PV-POM7890",technology:"PV",status:"development",developmentStatus:"grid_connection",developmentProgress:80,region:"pomorskie",power:25,price:315e4,seller:"Fundusz OZE",listedOn:new Date(2025,2,10)},{id:5,name:"WF-LUB2468",technology:"WF",status:"rtb",developmentStatus:"ready_to_build",developmentProgress:100,region:"lubelskie",power:45,price:189e5,seller:"Mi\u0119dzynarodowy Deweloper",listedOn:new Date(2025,2,12)},{id:6,name:"PV-KUJ1357",technology:"PV",status:"development",developmentStatus:"environmental_decision",developmentProgress:40,region:"kujawsko-pomorskie",power:18,price:198e4,seller:"Sp\xf3\u0142ka projektowa",listedOn:new Date(2025,2,15),isResale:!0,originalPrice:22e5},{id:7,name:"BESS-DOL9753",technology:"BESS",status:"cod",developmentStatus:"constructed",developmentProgress:100,region:"dolno\u015bl\u0105skie",power:8,price:12e6,seller:"Fundusz Infrastrukturalny",listedOn:new Date(2025,2,18)}]),y=m.filter((e=>("all"===n||e.technology===n)&&("all"===s||e.status===s))),g=()=>{const e=Object.keys(Fy),t=e[Math.floor(Math.random()*e.length)],n=Fy[t],r=["greenfield","development","development","development","rtb","cod"],i=r[Math.floor(Math.random()*r.length)],a=Math.floor(Math.random()*p.length),s=p[a],o="land_acquisition"===s?10:"environmental_decision"===s?30:"zoning_conditions"===s?55:"grid_connection"===s?75:100,l=["mazowieckie","ma\u0142opolskie","wielkopolskie","zachodniopomorskie","podlaskie","kujawsko-pomorskie","pomorskie","lubelskie","dolno\u015bl\u0105skie","\u015bl\u0105skie","podkarpackie","lubuskie"],c=l[Math.floor(Math.random()*l.length)],d=Math.floor(5+45*Math.random()),u=n.marketPrices[i]||n.marketPrices.development,h=u.min+Math.random()*(u.max-u.min),m=.85+.3*Math.random(),f=Math.floor(h*d*m),y=Math.random()<.15,g=y?Math.floor(f*(.05+.1*Math.random()+1)):f,v=["Inny deweloper","Fundusz inwestycyjny","Prywatny inwestor","Sp\xf3\u0142ka projektowa","Fundusz OZE","Mi\u0119dzynarodowy Deweloper","Fundusz Infrastrukturalny","Sp\xf3\u0142ka energetyczna","Bank inwestycyjny"],w=v[Math.floor(Math.random()*v.length)];return{id:Date.now()+Math.floor(1e3*Math.random()),name:`${n.shortName}-${c.substring(0,3).toUpperCase()}${Math.floor(1e4*Math.random())}`,technology:t,status:i,developmentStatus:s,developmentProgress:o,region:c,power:d,price:f,seller:w,listedOn:new Date,isResale:y,originalPrice:y?g:f}},v=()=>{try{const e=10;let t=[...m];t.length>e&&(t=t.slice(-Math.floor(e/2)));const n=e-t.length,r=Math.min(Math.floor(1+3*Math.random()),n),i=Date.now();if(window.lastMarketRefresh||(window.lastMarketRefresh=0),i-window.lastMarketRefresh<5e3)return void console.log("Zbyt cz\u0119ste od\u015bwie\u017canie gie\u0142dy. Poczekaj chwil\u0119.");window.lastMarketRefresh=i;const a=[];for(let s=0;s<r;s++)a.push(g());f([...t,...a]),a.length>0&&h(`Dodano ${a.length} ${1===a.length?"nowy projekt":"nowe projekty"} na gie\u0142d\u0119`,"info")}catch(e){console.error("B\u0142\u0105d podczas od\u015bwie\u017cania gie\u0142dy:",e),h("Wyst\u0105pi\u0142 b\u0142\u0105d podczas od\u015bwie\u017cania gie\u0142dy projekt\xf3w","error")}};(0,r.useEffect)((()=>{m.length<=7&&v(),u.turn%3===0&&(()=>{try{const e=10;if(m.length>=e)return void console.log("Osi\u0105gni\u0119to maksymaln\u0105 liczb\u0119 projekt\xf3w na gie\u0142dzie");const t=Date.now();if(window.lastMarketGeneration||(window.lastMarketGeneration=0),t-window.lastMarketGeneration<1e4)return void console.log("Zbyt cz\u0119ste generowanie projekt\xf3w. Poczekaj chwil\u0119.");window.lastMarketGeneration=t;const n=e-m.length,r=Math.min(1+Math.floor(2*Math.random()),n),i=[];for(let a=0;a<r;a++)i.push(g());f((t=>t.length>=e?t:(i.length>0&&h(`Na gie\u0142dzie pojawi\u0142o si\u0119 ${i.length} ${1===i.length?"nowy projekt":"nowe projekty"}`,"info"),[...t,...i])))}catch(e){console.error("B\u0142\u0105d przy generowaniu nowych ofert:",e)}})()}),[u.turn]);const w=e=>{switch(e){case"PV":return(0,a.jsx)(Bf,{className:"h-5 w-5 text-yellow-500"});case"WF":return(0,a.jsx)(Ty,{className:"h-5 w-5 text-blue-500"});case"BESS":return(0,a.jsx)($y,{className:"h-5 w-5 text-purple-500"});default:return null}},x=e=>{switch(e){case"greenfield":return"Greenfield";case"development":return"W rozwoju";case"rtb":return"Ready-to-Build";case"cod":return"Commercial Operation";default:return e}},b=e=>{switch(e){case"land_acquisition":return"Pozyskiwanie dzia\u0142ki";case"environmental_decision":return"Decyzja \u015brodowiskowa";case"zoning_conditions":return"Warunki zabudowy";case"grid_connection":return"Przy\u0142\u0105cze do sieci";case"ready_to_build":return"Ready-to-Build";case"constructed":return"Wybudowany";default:return"Nieznany etap"}};return(0,a.jsxs)("div",{className:"flex flex-1",children:[(0,a.jsxs)("div",{className:"flex-1 p-4 overflow-y-auto",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Gie\u0142da Projekt\xf3w OZE"}),(0,a.jsxs)("div",{className:"flex border-b border-gray-200 mb-4",children:[(0,a.jsx)("button",{onClick:()=>t("available"),className:"py-2 px-4 font-medium "+("available"===e?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),children:"Dost\u0119pne Projekty"}),(0,a.jsx)("button",{onClick:()=>t("history"),className:"py-2 px-4 font-medium "+("history"===e?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),children:"Historia Transakcji"}),(0,a.jsx)("button",{onClick:()=>t("sell"),className:"py-2 px-4 font-medium "+("sell"===e?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),children:"Sprzeda\u017c"})]}),"available"===e&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex mb-4",children:[(0,a.jsx)("button",{onClick:()=>i("all"),className:"px-3 py-1 rounded "+("all"===n?"bg-gray-700 text-white":"bg-gray-200"),children:"Wszystkie"}),(0,a.jsxs)("button",{onClick:()=>i("PV"),className:"px-3 py-1 rounded ml-2 flex items-center "+("PV"===n?"bg-yellow-500 text-white":"bg-gray-200"),children:[(0,a.jsx)(Bf,{className:"h-4 w-4 mr-1"})," Fotowoltaika"]}),(0,a.jsxs)("button",{onClick:()=>i("WF"),className:"px-3 py-1 rounded ml-2 flex items-center "+("WF"===n?"bg-blue-500 text-white":"bg-gray-200"),children:[(0,a.jsx)(Ty,{className:"h-4 w-4 mr-1"})," Farmy Wiatrowe"]}),(0,a.jsxs)("button",{onClick:()=>i("BESS"),className:"px-3 py-1 rounded ml-2 flex items-center "+("BESS"===n?"bg-purple-500 text-white":"bg-gray-200"),children:[(0,a.jsx)($y,{className:"h-4 w-4 mr-1"})," Magazyny Energii"]})]}),(0,a.jsxs)("div",{className:"flex mb-4",children:[(0,a.jsx)("button",{onClick:()=>o("all"),className:"px-3 py-1 rounded "+("all"===s?"bg-gray-700 text-white":"bg-gray-200"),children:"Wszystkie etapy"}),(0,a.jsx)("button",{onClick:()=>o("greenfield"),className:"px-3 py-1 rounded ml-2 "+("greenfield"===s?"bg-green-500 text-white":"bg-gray-200"),children:"Greenfield"}),(0,a.jsx)("button",{onClick:()=>o("development"),className:"px-3 py-1 rounded ml-2 "+("development"===s?"bg-orange-500 text-white":"bg-gray-200"),children:"Development"}),(0,a.jsx)("button",{onClick:()=>o("rtb"),className:"px-3 py-1 rounded ml-2 "+("rtb"===s?"bg-red-500 text-white":"bg-gray-200"),children:"Ready-to-Build"}),(0,a.jsx)("button",{onClick:()=>o("cod"),className:"px-3 py-1 rounded ml-2 "+("cod"===s?"bg-purple-500 text-white":"bg-gray-200"),children:"Commercial Operation"})]}),(0,a.jsx)(nv,{title:"Dost\u0119pne projekty",headerAction:(0,a.jsx)(my,{onClick:v,variant:"info",size:"small",children:"Od\u015bwie\u017c gie\u0142d\u0119"}),children:y.length>0?(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-100",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left p-2",children:"Projekt"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Technologia"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Etap"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Status developmentu"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Region"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Moc"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Cena"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Sprzedaj\u0105cy"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Akcja"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:y.map((e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50 "+(e.isResale?"bg-green-50":""),children:[(0,a.jsx)("td",{className:"p-2",children:e.name}),(0,a.jsx)("td",{className:"text-center p-2",children:(0,a.jsxs)("div",{className:"flex justify-center items-center",children:[w(e.technology),(0,a.jsx)("span",{className:"ml-1",children:e.technology})]})}),(0,a.jsx)("td",{className:"text-center p-2",children:x(e.status)}),(0,a.jsxs)("td",{className:"text-center p-2",children:["development"===e.status&&(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("span",{children:b(e.developmentStatus)}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-1",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${e.developmentProgress}%`}})})]}),"development"!==e.status&&"-"]}),(0,a.jsx)("td",{className:"text-center p-2",children:e.region}),(0,a.jsxs)("td",{className:"text-center p-2",children:[e.power," MW"]}),(0,a.jsx)("td",{className:"text-center p-2",children:(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsxs)("span",{className:"font-medium",children:[e.price.toLocaleString()," PLN"]}),e.isResale&&(0,a.jsxs)("span",{className:"text-xs text-green-600",children:["Oszcz\u0119dno\u015b\u0107: ",(e.originalPrice-e.price).toLocaleString()," PLN"]})]})}),(0,a.jsx)("td",{className:"text-center p-2",children:e.seller}),(0,a.jsx)("td",{className:"text-center p-2",children:(0,a.jsx)(my,{variant:"success",size:"small",onClick:()=>(e=>{const t=m.find((t=>t.id===e));if(!t||l.cash<t.price)return;c({type:"ADD_PROJECT",payload:{...t,status:"greenfield"===t.status?"land_acquisition":"rtb"===t.status?"ready_to_build":"cod"===t.status?"constructed":t.developmentStatus||"environmental_decision",etapPaid:(()=>{const e=p.indexOf(t.developmentStatus);return{land_acquisition:e>=0,environmental_decision:e>=1,zoning_conditions:e>=2,grid_connection:e>=3,ready_to_build:e>=4,construction:e>=5}})(),progress:t.developmentProgress||0,totalCost:t.price,assignedScout:null,assignedDeveloper:null,events:[{date:(new Date).toISOString(),text:`Projekt zakupiony na gie\u0142dzie za ${t.price.toLocaleString()} PLN${t.isResale?` (oszcz\u0119dno\u015b\u0107: ${(t.originalPrice-t.price).toLocaleString()} PLN)`:""}`}]}}),c({type:"UPDATE_CASH",payload:-t.price}),c({type:"UPDATE_ECONOMIC_METRICS",payload:{totalInvestment:l.economicMetrics.totalInvestment+t.price}}),h(`Zakupiono projekt ${t.name} za ${t.price.toLocaleString()} PLN`,"success"),f(m.filter((t=>t.id!==e)))})(e.id),disabled:l.cash<e.price,children:"Kup"})})]},e.id)))})]})}):(0,a.jsx)("p",{className:"text-gray-500",children:"Brak dost\u0119pnych projekt\xf3w spe\u0142niaj\u0105cych kryteria"})})]}),"history"===e&&(0,a.jsx)(nv,{title:"Historia transakcji",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Brak historii transakcji."})}),"sell"===e&&(0,a.jsx)(rv,{})]}),(0,a.jsxs)("div",{className:"w-1/3 bg-gray-100 p-4 overflow-y-auto",children:[(0,a.jsx)(nv,{title:"Analiza rynku",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Aktualne trendy cenowe"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"PV (Greenfield):"})," 15 000\u201325 000 z\u0142/MWp"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"PV (RTB):"})," 100 000\u2013250 000 EUR/MWp"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Farmy Wiatrowe (RTB):"})," 340 000\u2013464 000 z\u0142/MW"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Magazyny Energii (RTB):"})," ","1.2\u20131.8 mln z\u0142/MW"]})]})]}),(0,a.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Okazje rynkowe"}),(0,a.jsxs)("ul",{className:"space-y-1 text-sm",children:[(0,a.jsx)("li",{children:"\u2022 Projekty z oznaczeniem odsprzeda\u017cy mog\u0105 by\u0107 ta\u0144sze o 5-15% od warto\u015bci rynkowej!"}),(0,a.jsx)("li",{children:"\u2022 Magazyny energii w fazie developmentu staj\u0105 si\u0119 coraz bardziej atrakcyjne"}),(0,a.jsx)("li",{children:"\u2022 Projekty w fazie przy\u0142\u0105cza do sieci maj\u0105 najwy\u017csze ROI przy szybkim uko\u0144czeniu"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Porady inwestycyjne"}),(0,a.jsxs)("ul",{className:"space-y-1 text-sm",children:[(0,a.jsx)("li",{children:"\u2022 Projekty hybrydowe (PV + magazyn) osi\u0105gaj\u0105 premi\u0119 cenow\u0105 30-40%"}),(0,a.jsx)("li",{children:"\u2022 Obecnie najlepsze IRR maj\u0105 projekty w wojew\xf3dztwach mazowieckim i pomorskim"}),(0,a.jsx)("li",{children:"\u2022 Nadchodz\u0105ce zmiany regulacyjne mog\u0105 zwi\u0119kszy\u0107 warto\u015b\u0107 projekt\xf3w BESS"})]})]})]})}),(0,a.jsxs)(nv,{title:"Twoja got\xf3wka",className:"mt-4",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-green-600 mb-2",children:[l.cash?l.cash.toLocaleString():"0"," PLN"]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Pami\u0119taj, \u017ce zakupione projekty wymagaj\u0105 dalszego finansowania w trakcie developmentu."})]})]})]})},av="initial",sv="scouting",ov="negotiation",lv="agreement",cv=e=>{let{region:t,regionId:n,negotiationData:i,onComplete:s,onCancel:o}=e;const l=(0,r.useRef)(!0),{state:c,dispatch:u}=d(),{state:h,dispatch:p,showNotification:m}=mf(),{state:f,dispatch:y}=wf(),{state:g}=q(),[v,w]=(0,r.useState)(i?"negotiation":"initial"),[x,b]=(0,r.useState)((()=>(null===i||void 0===i?void 0:i.processId)||`land-acquisition-${Date.now()}`)),[j,k]=(0,r.useState)(null),[N,z]=(0,r.useState)(null),[_,E]=(0,r.useState)(i?100:0),[S,C]=(0,r.useState)({size:i?i.size:100,quality:i?i.quality:"medium",expectedPrice:i?i.negotiatedPrice:0,negotiatedPrice:i?i.negotiatedPrice:0,monthlyRent:0,contractLength:29,depositRequired:0,annualRate:.6,startDate:i?new Date(i.startDate):new Date(h.gameDate),completionDate:i?new Date(i.completionDate):null,durationMonths:Math.floor(3*Math.random())+1,processId:x,projectType:i?i.projectType:"PV",riskFactors:{environmentalRisk:0,socialRisk:0,competitionRisk:0,legalRisk:0},seasonalFactors:{availabilityModifier:1,priceModifier:1}}),[T,P]=(0,r.useState)([]),[I,A]=(0,r.useState)(!1),[M,D]=(0,r.useState)(0);f.find((e=>e.id===n)),r.useMemo((()=>c&&c.staff&&c.staff.scouts?c.staff.scouts.filter((e=>!e.busy||e.assignedRegion===n)):[]),[c,n]);(0,r.useEffect)((()=>()=>{l.current=!1}),[]),(0,r.useEffect)((()=>{try{const e={processId:x,acquisitionStep:v,selectedScout:j?j.id:null,countyId:N,landParameters:S,progress:_,events:T,isNegotiationComplete:I,negotiationAttempts:M,lastSaved:(new Date).toISOString()};localStorage.setItem(`landAcquisition-${x}`,JSON.stringify(e))}catch(e){console.error("B\u0142\u0105d podczas zapisywania stanu do localStorage:",e)}}),[x,v,j,N,S,_,T,I,M]),(0,r.useEffect)((()=>{if(!i)try{const e=localStorage.getItem(`landAcquisition-${x}`);if(e){const t=JSON.parse(e),n=new Date(t.lastSaved),r=new Date;if(Math.floor((r-n)/864e5)>7)return void localStorage.removeItem(`landAcquisition-${x}`);if(w(t.acquisitionStep),z(t.countyId),C(t.landParameters),E(t.progress),P(t.events),A(t.isNegotiationComplete),D(t.negotiationAttempts),t.selectedScout){const e=c.staff.scouts.find((e=>e.id===t.selectedScout));e&&k(e)}}}catch(e){console.error("B\u0142\u0105d podczas wczytywania stanu z localStorage:",e)}}),[x,i,c.staff.scouts]),(0,r.useEffect)((()=>{if(v!==sv)return;let e;return e=setInterval((()=>{l.current&&E((e=>{if(e>=100)return 100;const t=2+(j?j.skill/10*3:0)+1*Math.random();return Math.random()<.1&&R(),Math.min(100,e+t)}))}),2e3),()=>{clearInterval(e)}}),[v,j]),(0,r.useEffect)((()=>{if(v!==sv)return;const e=()=>{l.current&&E((e=>{if(e>=100)return 100;const t=10+(j?j.skill/10*5:0)+5*Math.random();return R(),Math.min(100,e+t)}))};return window.addEventListener("day-changed",e),()=>{window.removeEventListener("day-changed",e)}}),[v,j]);const R=()=>{const e=[{type:"info",text:"Poszukiwanie dzia\u0142ki w toku..."},{type:"success",text:"Znaleziono obiecuj\u0105c\u0105 lokalizacj\u0119!"},{type:"warning",text:"Napotkano problemy z dost\u0119pno\u015bci\u0105 grunt\xf3w."},{type:"info",text:"Trwaj\u0105 rozmowy z w\u0142a\u015bcicielami grunt\xf3w."},{type:"success",text:"W\u0142a\u015bciciel gruntu jest zainteresowany wsp\xf3\u0142prac\u0105."},{type:"warning",text:"Konkurencyjna firma zainteresowana t\u0105 lokalizacj\u0105."}],t=e[Math.floor(Math.random()*e.length)],n={id:Date.now(),date:(new Date).toISOString(),type:t.type,text:t.text};P((e=>[n,...e].slice(0,10)))},O=()=>(0,a.jsxs)(nv,{className:"acquisition-card",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-blue-800 mb-4",children:"Negocjacje warunk\xf3w"}),(0,a.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"avatar mr-3",children:(0,a.jsx)(Kf,{className:"h-6 w-6 text-blue-500"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium",children:["Skaut: ",(null===j||void 0===j?void 0:j.name)||"Nieznany skaut"]}),j&&(0,a.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:[(0,a.jsxs)("span",{className:"mr-3",children:["Umiej\u0119tno\u015bci: ",j.skill,"/10"]}),(0,a.jsxs)("span",{children:["Negocjacje: ",j.negotiation||Math.floor(.8*j.skill),"/10"]})]})]})]})}),(0,a.jsxs)("div",{className:"land-details bg-white p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Parametry dzia\u0142ki"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"label",children:"Powierzchnia:"}),(0,a.jsxs)("span",{className:"value",children:[S.size," ha"]})]}),(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"label",children:"Jako\u015b\u0107 lokalizacji:"}),(0,a.jsx)("span",{className:"value",children:"low"===S.quality?"Niska":"medium"===S.quality?"\u015arednia":"Wysoka"})]}),(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"label",children:"Szacowana cena:"}),(0,a.jsxs)("span",{className:"value",children:[S.expectedPrice.toLocaleString()," PLN"]})]}),(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"label",children:"Cena za hektar:"}),(0,a.jsxs)("span",{className:"value",children:[S.pricePerHa.toLocaleString()," PLN"]})]})]})]})]});return(0,a.jsxs)("div",{className:"land-acquisition-view",children:[(0,a.jsxs)("div",{className:"acquisition-header bg-white p-4 rounded-lg mb-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold text-primary",children:[v===av&&"Wyb\xf3r skauta",v===sv&&"Poszukiwanie dzia\u0142ki",v===ov&&"Negocjacje warunk\xf3w",v===lv&&"Finalizacja umowy"]}),(0,a.jsxs)("div",{className:"location-info text-gray-600",children:[(0,a.jsx)(Wf,{className:"h-4 w-4 inline mr-1"}),(0,a.jsxs)("span",{children:[t,", "]}),(0,a.jsx)("span",{children:N?`${N}, `:""}),(0,a.jsx)("span",{children:"Polska"})]})]}),v!==av&&null!==_&&(0,a.jsxs)("div",{className:"acquisition-progress mt-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[(0,a.jsx)("span",{children:"Post\u0119p procesu"}),(0,a.jsxs)("span",{children:[_,"%"]})]}),(0,a.jsx)("div",{className:"progress-bar h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"progress-fill h-full bg-blue-500",style:{width:`${_}%`}})})]})]}),(()=>{switch(v){case av:return renderScoutSelection();case sv:return renderScouting();case ov:return O();case lv:return renderAgreementSummary();default:return renderScoutSelection()}})()]})},dv=[{id:"zachodniopomorskie",name:"Zachodniopomorskie",x:0,y:0},{id:"pomorskie",name:"Pomorskie",x:1,y:0},{id:"warminsko-mazurskie",name:"Warmi\u0144sko-Mazurskie",x:2,y:0},{id:"podlaskie",name:"Podlaskie",x:3,y:0},{id:"lubuskie",name:"Lubuskie",x:0,y:1},{id:"wielkopolskie",name:"Wielkopolskie",x:1,y:1},{id:"kujawsko-pomorskie",name:"Kujawsko-Pomorskie",x:2,y:1},{id:"mazowieckie",name:"Mazowieckie",x:3,y:1},{id:"dolnoslaskie",name:"Dolno\u015bl\u0105skie",x:0,y:2},{id:"lodzkie",name:"\u0141\xf3dzkie",x:1,y:2},{id:"swietokrzyskie",name:"\u015awi\u0119tokrzyskie",x:2,y:2},{id:"lubelskie",name:"Lubelskie",x:3,y:2},{id:"opolskie",name:"Opolskie",x:0,y:3},{id:"slaskie",name:"\u015al\u0105skie",x:1,y:3},{id:"malopolskie",name:"Ma\u0142opolskie",x:2,y:3},{id:"podkarpackie",name:"Podkarpackie",x:3,y:3}],uv=()=>{var e,t;const{state:n,dispatch:i}=mf(),{state:s,dispatch:o}=d(),{state:l,dispatch:c}=wf(),[u,h]=(0,r.useState)(null),[p,m]=(0,r.useState)(null),[f,y]=(0,r.useState)(!1),[g,v]=(0,r.useState)(!1),[w,x]=(0,r.useState)(!1),[b,j]=(0,r.useState)(null),[k,N]=(0,r.useState)(!1),[z,_]=(0,r.useState)(null),[E,S]=(0,r.useState)("lands"),[C,T]=(0,r.useState)([]),[P,I]=(0,r.useState)([]),[A,M]=(0,r.useState)(!1),[D,R]=(0,r.useState)(!1);(0,r.useEffect)((()=>{n.selectedRegion!==u&&(h(n.selectedRegion),n.selectedRegion&&y(!0))}),[n.selectedRegion]),(0,r.useEffect)((()=>{var e;if(null!==(e=s.staff)&&void 0!==e&&e.scouts){const e=s.staff.scouts.filter((e=>e.busy));I(e)}}),[null===(e=s.staff)||void 0===e?void 0:e.scouts]);const O=e=>{var t,n;const r=l.find((t=>t.id===e));return(null===r||void 0===r||null===(t=r.projects)||void 0===t||null===(n=t.filter((e=>"land_acquisition"!==e.status)))||void 0===n?void 0:n.length)||0},L=e=>P.filter((t=>t.assignedRegion===e)),F=e=>{const t=l.find((t=>t.id===e));return t&&t.projects?t.projects.reduce(((e,t)=>"constructed"===t.status?e+(t.capacity||0):e),0):0},U=()=>!!(s&&s.staff&&s.staff.scouts)&&s.staff.scouts.some((e=>!e.busy)),V=()=>{w||(U()?(x(!0),y(!1),R(!0),j(null)):showNotification("Brak dost\u0119pnych skaut\xf3w. Zatrudnij nowych pracownik\xf3w lub poczekaj a\u017c obecni sko\u0144cz\u0105 swoje zadania.","warning"))},B=()=>{if(!u)return;const e=l.find((e=>e.id===u));0!==((null===e||void 0===e?void 0:e.landAcquisitionProcesses)||[]).length?(v(!0),y(!1)):i({type:"NOTIFY",payload:{text:"Brak aktualnych poszukiwa\u0144 w tym regionie. Wy\u015blij skauta, aby rozpocz\u0105\u0107 pozyskiwanie dzia\u0142ki.",type:"info"}})},$=e=>{var t;const n=l.find((t=>t.id===e));return(null===n||void 0===n||null===(t=n.landAcquisitionProcesses)||void 0===t?void 0:t.length)||0},W=e=>{const t=l.find((t=>t.id===e));return((null===t||void 0===t?void 0:t.landAcquisitionProcesses)||[]).some((e=>"ready_for_negotiation"===e.status))},q=e=>{const t=L(e).length;return 0===t?null:(0,a.jsxs)("div",{className:"scout-indicator",title:`${t} aktywnych skaut\xf3w`,children:[(0,a.jsx)(Kf,{size:14}),(0,a.jsx)("span",{children:t})]})},H=e=>{const t=O(e);return 0===t?null:(0,a.jsxs)("div",{className:"projects-indicator",title:`${t} projekt\xf3w`,children:[(0,a.jsx)(uy,{size:14}),(0,a.jsx)("span",{children:t})]})},K=e=>{const t=l.find((t=>t.id===e));if(!t)return null;const n=t.solarConditions;let r="";return r=n>=80?"excellent":n>=60?"good":n>=40?"average":"poor",(0,a.jsx)("div",{className:`condition-indicator solar-condition ${r}`,title:`Nas\u0142onecznienie: ${n}/100`,children:(0,a.jsx)(Bf,{size:14})})},G=e=>{const t=l.find((t=>t.id===e));if(!t)return null;const n=t.windConditions;let r="";return r=n>=80?"excellent":n>=60?"good":n>=40?"average":"poor",(0,a.jsx)("div",{className:`condition-indicator wind-condition ${r}`,title:`Warunki wiatrowe: ${n}/100`,children:(0,a.jsx)(Ty,{size:14})})},Q=e=>{try{if(!u)return console.error("Nie wybrano regionu do negocjacji"),void i({type:"NOTIFY",payload:{text:"B\u0142\u0105d: Nie wybrano regionu do negocjacji.",type:"error"}});const t=l.find((e=>e.id===u));if(!t||!t.landAcquisitionProcesses)return console.error("Brak danych regionu lub proces\xf3w pozyskiwania grunt\xf3w"),void i({type:"NOTIFY",payload:{text:"B\u0142\u0105d: Nie mo\u017cna uzyska\u0107 dost\u0119pu do danych regionu.",type:"error"}});const n=t.landAcquisitionProcesses.find((t=>t.id===e));if(!n)return console.error("Nie znaleziono procesu do negocjacji o ID:",e),void i({type:"NOTIFY",payload:{text:"B\u0142\u0105d: Nie znaleziono procesu do negocjacji.",type:"error"}});console.log("Przygotowanie do negocjacji procesu:",n);const r=n.negotiatedPrice||1e4*n.size;let a=null;s&&s.staff&&s.staff.scouts&&(a=s.staff.scouts.find((e=>e.id===n.scoutId))),j({processId:n.id,scoutId:n.scoutId,scoutName:n.scoutName||(a?a.name:"Nieznany skaut"),size:n.size||100,quality:n.quality||"medium",negotiatedPrice:r,expectedPrice:n.expectedPrice||r,regionId:u,annualRate:n.annualRate||.05,status:n.status||"ready_for_negotiation"}),M(!0)}catch(t){console.error("Wyst\u0105pi\u0142 nieoczekiwany b\u0142\u0105d podczas przygotowania negocjacji:",t),i({type:"NOTIFY",payload:{text:"Wyst\u0105pi\u0142 nieoczekiwany b\u0142\u0105d podczas przygotowania negocjacji. Spr\xf3buj ponownie.",type:"error"}})}},Z=e=>{var t;const n=l.find((e=>e.id===u)),r=null===n||void 0===n||null===(t=n.landAcquisitionProcesses)||void 0===t?void 0:t.find((t=>t.id===e));if(!r)return;const a=s.staff.scouts.find((e=>e.id===r.scoutId));a&&o({type:"UPDATE_STAFF",payload:{staffType:"scouts",staffId:a.id,changes:{busy:!1,assignedRegion:null}}}),c({type:"REMOVE_LAND_ACQUISITION_PROCESS",payload:{regionId:u,processId:e}}),i({type:"NOTIFY",payload:{text:`Anulowano proces poszukiwania gruntu w regionie ${null===n||void 0===n?void 0:n.name}.`,type:"info"}})};return(0,a.jsxs)("div",{className:"region-selection-view",children:[(0,a.jsxs)("div",{className:"region-selection-header",children:[(0,a.jsx)("h2",{children:"Wyb\xf3r regionu"}),(0,a.jsx)("p",{children:"Wybierz wojew\xf3dztwo, aby rozpocz\u0105\u0107 poszukiwanie dzia\u0142ek lub zarz\u0105dza\u0107 projektami"})]}),(0,a.jsxs)("div",{className:"regions-map-container",children:[(0,a.jsxs)("div",{className:"region-map-section",children:[(0,a.jsx)("div",{className:"regions-grid",children:dv.map((e=>{var t;const n=u===e.id,r=p===e.id,s=l.find((t=>t.id===e.id));return(0,a.jsx)("div",{className:`region-cell ${n?"selected":""} ${r?"hovered":""}`,style:{gridColumn:e.x+1,gridRow:e.y+1},children:(0,a.jsxs)("button",{className:`region-btn ${o=e.id,(e=>{const t=(e.solarConditions+e.windConditions)/2;return t>=70?"bg-green-200":t>=55?"bg-yellow-200":"bg-red-200"})(l.find((e=>e.id===o)))} ${n?"selected":""}`,onClick:()=>(e=>{if(u===e)return y(!f),void v(!1);l.find((t=>t.id===e)),h(e),i({type:"SELECT_REGION",payload:e}),y(!0),v(!1)})(e.id),onMouseEnter:()=>m(e.id),onMouseLeave:()=>m(null),children:[(0,a.jsx)("div",{className:"region-name",children:e.name}),(0,a.jsxs)("div",{className:"region-indicators",children:[K(e.id),G(e.id),q(e.id),H(e.id)]}),r&&s&&(0,a.jsxs)("div",{className:"region-hover-info",children:[(0,a.jsxs)("div",{className:"hover-info-item",children:[(0,a.jsx)("span",{children:"Dost\u0119pne grunty:"}),(0,a.jsxs)("span",{children:[null===(t=s.availableLand)||void 0===t?void 0:t.toLocaleString()," ha"]})]}),(0,a.jsxs)("div",{className:"hover-info-item",children:[(0,a.jsx)("span",{children:"Projekty:"}),(0,a.jsx)("span",{children:O(e.id)})]}),L(e.id).length>0&&(0,a.jsxs)("div",{className:"hover-info-item",children:[(0,a.jsx)("span",{children:"Aktywni skauci:"}),(0,a.jsx)("span",{children:L(e.id).length})]})]})]})},e.id);var o}))}),(0,a.jsxs)("div",{className:"regions-legend",children:[(0,a.jsx)("h3",{children:"Legenda"}),(0,a.jsxs)("div",{className:"legend-items",children:[(0,a.jsxs)("div",{className:"legend-item",children:[(0,a.jsx)("span",{className:"color-box color-low"}),(0,a.jsx)("span",{children:"Brak projekt\xf3w"})]}),(0,a.jsxs)("div",{className:"legend-item",children:[(0,a.jsx)("span",{className:"color-box color-medium"}),(0,a.jsx)("span",{children:"1-2 projekty"})]}),(0,a.jsxs)("div",{className:"legend-item",children:[(0,a.jsx)("span",{className:"color-box color-high"}),(0,a.jsx)("span",{children:"3+ projekt\xf3w"})]}),(0,a.jsxs)("div",{className:"legend-item",children:[(0,a.jsx)("span",{className:"color-box color-selected"}),(0,a.jsx)("span",{children:"Wybrany region"})]})]})]})]}),(0,a.jsxs)("div",{className:"region-panel-section",children:[(()=>{var e;if(!u||!f)return null;const t=l.find((e=>e.id===u)),n=L(u);return(0,a.jsxs)("div",{className:"region-action-panel",children:[(0,a.jsxs)("div",{className:"action-panel-header",children:[(0,a.jsx)("h3",{children:(null===t||void 0===t?void 0:t.name)||"Wybrany region"}),(0,a.jsx)("button",{className:"close-panel-btn",onClick:()=>y(!1),children:(0,a.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),(0,a.jsxs)("div",{className:"region-key-stats",children:[(0,a.jsxs)("div",{className:"key-stat",children:[(0,a.jsx)(Py,{size:18}),(0,a.jsxs)("div",{className:"stat-content",children:[(0,a.jsx)("span",{className:"stat-label",children:"Dost\u0119pne grunty"}),(0,a.jsxs)("span",{className:"stat-value",children:[null===t||void 0===t||null===(e=t.availableLand)||void 0===e?void 0:e.toLocaleString()," ha"]})]})]}),(0,a.jsxs)("div",{className:"key-stat",children:[(0,a.jsx)(Bf,{size:18}),(0,a.jsxs)("div",{className:"stat-content",children:[(0,a.jsx)("span",{className:"stat-label",children:"Nas\u0142onecznienie"}),(0,a.jsxs)("span",{className:"stat-value",children:[null===t||void 0===t?void 0:t.solarConditions,"/100"]})]})]}),(0,a.jsxs)("div",{className:"key-stat",children:[(0,a.jsx)(Ty,{size:18}),(0,a.jsxs)("div",{className:"stat-content",children:[(0,a.jsx)("span",{className:"stat-label",children:"Warunki wiatrowe"}),(0,a.jsxs)("span",{className:"stat-value",children:[null===t||void 0===t?void 0:t.windConditions,"/100"]})]})]}),(0,a.jsxs)("div",{className:"key-stat",children:[(0,a.jsx)(Rg,{size:18}),(0,a.jsxs)("div",{className:"stat-content",children:[(0,a.jsx)("span",{className:"stat-label",children:"Moc zainstalowana"}),(0,a.jsxs)("span",{className:"stat-value",children:[F(u)," MW"]})]})]})]}),(0,a.jsxs)("div",{className:"action-buttons",children:[(0,a.jsxs)("button",{className:"action-btn scout-btn "+(U()?"":"disabled"),onClick:V,disabled:!U(),children:[(0,a.jsx)("div",{className:"btn-icon",children:(0,a.jsx)(Py,{size:18})}),(0,a.jsxs)("div",{className:"btn-content",children:[(0,a.jsx)("div",{className:"btn-title",children:"Wy\u015blij skauta"}),(0,a.jsx)("div",{className:"btn-description",children:"Znajd\u017a i wynegocjuj dzier\u017caw\u0119 dzia\u0142ki"})]})]}),(0,a.jsxs)("button",{className:"action-btn projects-btn "+(0===$(u)?"disabled":""),onClick:B,disabled:0===$(u),children:[(0,a.jsxs)("div",{className:"btn-icon",children:[(0,a.jsx)(uy,{size:18}),W(u)&&(0,a.jsx)("div",{className:"notification-badge",children:"!"})]}),(0,a.jsxs)("div",{className:"btn-content",children:[(0,a.jsxs)("div",{className:"btn-title",children:["Aktualne poszukiwania",W(u)&&(0,a.jsx)("span",{className:"attention-marker",children:" \u2022 "})]}),(0,a.jsxs)("div",{className:"btn-description",children:["Przejrzyj post\u0119p poszukiwania grunt\xf3w w tym regionie",W(u)&&(0,a.jsx)("span",{className:"text-yellow-500",children:" (Wymagana akcja!)"})]})]})]})]}),n.length>0&&(0,a.jsxs)("div",{className:"active-scouts-section",children:[(0,a.jsxs)("h4",{children:[(0,a.jsx)(Uf,{size:16,className:"section-icon"}),"Aktywne procesy w regionie"]}),(0,a.jsx)("div",{className:"active-scouts-list",children:n.map((e=>(0,a.jsxs)("div",{className:"active-scout-item",children:[(0,a.jsx)("div",{className:"scout-avatar",children:(0,a.jsx)(Kf,{size:20})}),(0,a.jsxs)("div",{className:"scout-info",children:[(0,a.jsx)("div",{className:"scout-name",children:e.name}),(0,a.jsx)("div",{className:"scout-status",children:"Poszukiwanie dzia\u0142ki"}),(0,a.jsxs)("div",{className:"scout-progress",children:[(0,a.jsx)("div",{className:"progress-bar",children:(0,a.jsx)("div",{className:"progress-fill",style:{width:`${e.progress||0}%`}})}),(0,a.jsxs)("span",{className:"progress-text",children:[Math.floor(e.progress||0),"%"]})]})]})]},e.id)))})]}),!(s&&s.staff&&s.staff.scouts&&s.staff.scouts.length>0)&&(0,a.jsxs)("div",{className:"region-warning",children:[(0,a.jsx)(Hf,{size:16,className:"warning-icon"}),(0,a.jsx)("span",{children:"Nie masz zatrudnionych skaut\xf3w. Zatrudnij skauta w panelu HR, aby m\xf3c poszukiwa\u0107 dzia\u0142ek."})]})]})})(),(()=>{if(!u||!g)return null;const e=l.find((e=>e.id===u)),t=(null===e||void 0===e?void 0:e.landAcquisitionProcesses)||[],n=e=>new Date(e).toLocaleDateString("pl-PL"),r={in_progress:"W trakcie",ready_for_negotiation:"Gotowy do negocjacji",negotiating:"W negocjacjach",completed:"Zako\u0144czony"},i={in_progress:"bg-blue-100 text-blue-800",ready_for_negotiation:"bg-green-200 text-green-900 font-bold",negotiating:"bg-amber-100 text-amber-800",completed:"bg-gray-100 text-gray-800"};return(0,a.jsxs)("div",{className:"region-projects-panel",children:[(0,a.jsxs)("div",{className:"projects-panel-header",children:[(0,a.jsxs)("h3",{children:["Aktualne poszukiwania w regionie ",null===e||void 0===e?void 0:e.name]}),(0,a.jsx)("button",{className:"close-panel-btn",onClick:()=>v(!1),children:(0,a.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),(0,a.jsx)("div",{className:"acquisition-processes-container",children:0===t.length?(0,a.jsx)("div",{className:"no-processes-message",children:"Brak aktualnych proces\xf3w poszukiwania grunt\xf3w w tym regionie."}):(0,a.jsx)("div",{className:"acquisition-processes-grid",children:t.map((e=>(0,a.jsxs)("div",{className:"acquisition-process-card "+(C.includes(e.id)?"expanded":""),onClick:()=>(e=>{var t;const n=l.find((e=>e.id===u)),r=null===n||void 0===n||null===(t=n.landAcquisitionProcesses)||void 0===t?void 0:t.find((t=>t.id===e));r&&"ready_for_negotiation"===r.status?Q(e):T((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))})(e.id),children:[(0,a.jsxs)("div",{className:"process-card-header",children:[(0,a.jsx)("div",{className:"process-icon",children:(0,a.jsx)(Py,{size:18})}),(0,a.jsxs)("div",{className:"process-info",children:[(0,a.jsxs)("h4",{className:"process-title",children:["Dzia\u0142ka ",e.size,"ha"]}),(0,a.jsx)("div",{className:`process-status-badge ${i[e.status]}`,children:r[e.status]})]}),(0,a.jsx)("div",{className:"process-progress-indicator",children:(0,a.jsxs)("svg",{viewBox:"0 0 36 36",className:"circular-chart",children:[(0,a.jsx)("path",{className:"circle-bg",d:"M18 2.0845\r a 15.9155 15.9155 0 0 1 0 31.831\r a 15.9155 15.9155 0 0 1 0 -31.831"}),(0,a.jsx)("path",{className:"circle",strokeDasharray:`${e.progress}, 100`,d:"M18 2.0845\r a 15.9155 15.9155 0 0 1 0 31.831\r a 15.9155 15.9155 0 0 1 0 -31.831"}),(0,a.jsxs)("text",{x:"18",y:"20.35",className:"percentage",children:[e.progress,"%"]})]})})]}),C.includes(e.id)&&(0,a.jsxs)("div",{className:"process-card-details",children:[(0,a.jsxs)("div",{className:"details-grid",children:[(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"detail-label",children:"Skaut:"}),(0,a.jsx)("span",{className:"detail-value",children:e.scoutName})]}),(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"detail-label",children:"Rozpocz\u0119cie:"}),(0,a.jsx)("span",{className:"detail-value",children:n(e.startDate)})]}),(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"detail-label",children:"Zako\u0144czenie:"}),(0,a.jsx)("span",{className:"detail-value",children:n(e.completionDate)})]}),e.negotiatedPrice&&(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"detail-label",children:"Wycena:"}),(0,a.jsxs)("span",{className:"detail-value",children:[e.negotiatedPrice.toLocaleString()," PLN"]})]}),(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"detail-label",children:"Jako\u015b\u0107:"}),(0,a.jsx)("span",{className:"detail-value",children:"high"===e.quality?"Wysoka":"medium"===e.quality?"\u015arednia":"Niska"})]})]}),(0,a.jsxs)("div",{className:"process-actions",children:["ready_for_negotiation"===e.status&&(0,a.jsx)("button",{className:"action-button negotiate",onClick:t=>{t.stopPropagation(),Q(e.id)},children:"Negocjuj umow\u0119"}),"in_progress"===e.status&&(0,a.jsx)("button",{className:"action-button cancel",onClick:t=>{t.stopPropagation(),Z(e.id)},children:"Anuluj poszukiwanie"})]})]})]},e.id)))})})]})})()]})]}),w&&u&&(0,a.jsxs)("div",{className:"land-acquisition-modal",children:[(0,a.jsx)("div",{className:"land-acquisition-backdrop",onClick:()=>{D&&!window.confirm("Czy na pewno chcesz anulowa\u0107 proces pozyskiwania gruntu?")||(x(!1),y(!0),R(!1))}}),(0,a.jsx)("div",{className:"land-acquisition-content",children:(0,a.jsx)(cv,{region:null===(t=l.find((e=>e.id===u)))||void 0===t?void 0:t.name,regionId:u,negotiationData:b,onComplete:e=>{console.log("Proces pozyskiwania gruntu zako\u0144czony:",e),e&&e.leaseId&&e.projectId&&showNotification("Umowa dzier\u017cawy zosta\u0142a podpisana! Utworzono nowy projekt w Twoim portfolio.","success"),x(!1),y(!0),R(!1),refreshProjects&&refreshProjects()},onCancel:()=>{D&&!window.confirm("Czy na pewno chcesz anulowa\u0107 proces pozyskiwania gruntu?")||(x(!1),y(!0),R(!1))}})})]})]})},hv=e=>{let{employees:t,onSelectEmployee:n,selectedEmployeeId:i}=e;const[s,o]=(0,r.useState)("all"),[l,c]=(0,r.useState)("all"),[d,u]=(0,r.useState)("name"),h=(0,r.useMemo)((()=>{let e=[...t];return"all"!==s&&(e=e.filter((e=>e.typeShort===s))),"all"!==l&&(e=e.filter((e=>e.level===l))),e.sort(((e,t)=>{switch(d){case"name":return e.name.localeCompare(t.name);case"type":return e.typeShort.localeCompare(t.typeShort);case"level":return e.level.localeCompare(t.level);case"skill":return t.skill-e.skill;case"experience":return t.experience-e.experience;default:return 0}})),e}),[t,s,l,d]),p=e=>e.experience<3e3?"Pocz\u0105tkuj\u0105cy":e.experience<8e3?"Do\u015bwiadczony":"Ekspert";return(0,a.jsxs)("div",{className:"hr-employees-list",children:[(0,a.jsxs)("div",{className:"hr-employees-list-header",children:["Pracownicy (",h.length,")"]}),(0,a.jsxs)("div",{className:"hr-employees-list-filters",children:[(0,a.jsxs)("select",{value:s,onChange:e=>o(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"Wszyscy"}),(0,a.jsx)("option",{value:"lessor",children:"Dzier\u017cawcy"}),(0,a.jsx)("option",{value:"developer",children:"Developerzy"}),(0,a.jsx)("option",{value:"lawyer",children:"Prawnicy"}),(0,a.jsx)("option",{value:"envSpecialist",children:"Spec. \u015brodowiskowi"}),(0,a.jsx)("option",{value:"lobbyist",children:"Lobby\u015bci"})]}),(0,a.jsxs)("select",{value:l,onChange:e=>c(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"Wszystkie poziomy"}),(0,a.jsx)("option",{value:"junior",children:"Pocz\u0105tkuj\u0105cy"}),(0,a.jsx)("option",{value:"mid",children:"Do\u015bwiadczeni"}),(0,a.jsx)("option",{value:"senior",children:"Eksperci"})]}),(0,a.jsxs)("select",{value:d,onChange:e=>u(e.target.value),children:[(0,a.jsx)("option",{value:"name",children:"Sortuj: Nazwa"}),(0,a.jsx)("option",{value:"type",children:"Sortuj: Typ"}),(0,a.jsx)("option",{value:"level",children:"Sortuj: Poziom"}),(0,a.jsx)("option",{value:"skill",children:"Sortuj: Umiej\u0119tno\u015bci"}),(0,a.jsx)("option",{value:"experience",children:"Sortuj: Do\u015bwiadczenie"})]})]}),(0,a.jsx)("div",{className:"hr-employees-items",children:0===h.length?(0,a.jsx)("div",{className:"hr-no-employees",children:"Brak pracownik\xf3w spe\u0142niaj\u0105cych kryteria"}):h.map((e=>(0,a.jsxs)("div",{className:"hr-employee-item "+(i===e.id?"selected":""),onClick:()=>n(e),children:[(0,a.jsx)("div",{className:"hr-employee-name",children:e.name}),(0,a.jsxs)("div",{className:"hr-employee-info",children:[(0,a.jsx)("span",{children:My(e.typeShort)}),(0,a.jsx)("span",{children:Dy(e.level)})]}),(0,a.jsxs)("div",{className:"hr-employee-info",children:[(0,a.jsxs)("span",{children:["Umiej\u0119tno\u015b\u0107: ",e.skill,"/10"]}),(0,a.jsxs)("span",{children:["Do\u015bwiadczenie: ",p(e)]})]}),e.specialization&&(0,a.jsx)("div",{className:"hr-employee-specialization",children:e.specialization})]},e.id)))})]})},pv=e=>{let{employee:t,staffType:n,staffManagement:i,gameState:s}=e;const[o,l]=(0,r.useState)(!1);if(!t)return null;return(0,a.jsxs)("div",{className:"hr-employee-details",children:[(0,a.jsxs)("div",{className:"hr-employee-header",children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,a.jsx)("div",{className:"hr-employee-avatar",children:t.name.charAt(0)}),(0,a.jsxs)("div",{className:"hr-employee-title",children:[(0,a.jsx)("h3",{children:t.name}),(0,a.jsxs)("div",{className:"hr-employee-job",children:[Dy(t.level)," ",My(t.typeShort)]}),(0,a.jsx)("div",{children:t.specialization&&(0,a.jsxs)("span",{className:"hr-specialization",children:["Specjalizacja: ",t.specialization]})})]})]}),(0,a.jsxs)("div",{className:"hr-employee-actions",children:[(0,a.jsx)("button",{className:"train-btn",onClick:()=>{},children:"Szkolenie"}),(0,a.jsx)("button",{className:"fire-btn",onClick:()=>{o?(i.fireStaff(t.typeShort,t.id),l(!1)):l(!0)},children:o?"Potwierd\u017a zwolnienie":"Zwolnij"})]})]}),(0,a.jsxs)("div",{className:"hr-employee-grid",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"hr-employee-section",children:[(0,a.jsx)("h4",{children:"Statystyki"}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Sta\u017c pracy"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[s.turn-t.hiredOn," tur"]})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Umiej\u0119tno\u015bci"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.skill,"/10"]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value "+(t.skill>7?"high":t.skill>4?"medium":"low"),style:{width:10*t.skill+"%"}})})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Do\u015bwiadczenie"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.experience," p.d."]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value",style:{width:`${Math.min(100,t.experience/100)}%`}})})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Energia"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.energy,"/100"]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value "+(t.energy>70?"high":t.energy>40?"medium":"low"),style:{width:`${t.energy}%`}})})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Morale"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.morale,"/100"]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value "+(t.morale>70?"high":t.morale>40?"medium":"low"),style:{width:`${t.morale}%`}})})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Wynagrodzenie"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.salary.toLocaleString()," PLN / miesi\u0105c"]})]})]}),"developer"!==t.typeShort?null:t.technologyExperience&&0!==Object.keys(t.technologyExperience).length?(0,a.jsxs)("div",{className:"hr-employee-section",children:[(0,a.jsx)("h4",{children:"Do\u015bwiadczenie w technologiach"}),Object.entries(t.technologyExperience).map((e=>{let[t,n]=e;return(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:t}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[n," p.d."]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value",style:{width:`${Math.min(100,n/50)}%`}})})]},t)}))]}):(0,a.jsxs)("div",{className:"hr-employee-section",children:[(0,a.jsx)("h4",{children:"Do\u015bwiadczenie w technologiach"}),(0,a.jsx)("div",{className:"hr-no-data",children:"Brak do\u015bwiadczenia w konkretnych technologiach"})]}),"scout"!==t.typeShort?null:t.acquiredLands&&0!==t.acquiredLands?(0,a.jsxs)("div",{className:"hr-employee-section",children:[(0,a.jsx)("h4",{children:"Do\u015bwiadczenie dzier\u017cawcy"}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Pozyskane grunty"}),(0,a.jsx)("div",{className:"hr-stat-value",children:t.acquiredLands})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"\u0141\u0105czna powierzchnia"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.acquiredArea||0," ha"]})]})]}):(0,a.jsxs)("div",{className:"hr-employee-section",children:[(0,a.jsx)("h4",{children:"Do\u015bwiadczenie dzier\u017cawcy"}),(0,a.jsx)("div",{className:"hr-no-data",children:"Jeszcze nie pozyska\u0142 \u017cadnych grunt\xf3w"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"hr-employee-section",children:[(0,a.jsx)("h4",{children:"Cechy charakteru"}),t.traits&&t.traits.length>0?t.traits.map((e=>{const t=(e=>[...jg,...kg,...Ng].find((t=>t.id===e))||{label:e,description:""})(e);return(0,a.jsxs)("div",{className:"hr-trait-item",children:[(0,a.jsx)("div",{className:"hr-trait-name",children:t.label}),(0,a.jsx)("div",{className:"hr-trait-description",children:t.description})]},e)})):(0,a.jsx)("div",{className:"hr-no-data",children:"Brak zdefiniowanych cech charakteru"})]}),(0,a.jsxs)("div",{className:"hr-employee-section",children:[(0,a.jsx)("h4",{children:"Potrzeby"}),t.potrzeby?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Uznanie"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.potrzeby.uznanie,"/100"]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value",style:{width:`${t.potrzeby.uznanie}%`}})})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Rozw\xf3j"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.potrzeby.rozwoj,"/100"]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value",style:{width:`${t.potrzeby.rozwoj}%`}})})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Stabilizacja"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.potrzeby.stabilizacja,"/100"]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value",style:{width:`${t.potrzeby.stabilizacja}%`}})})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Autonomia"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.potrzeby.autonomia,"/100"]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value",style:{width:`${t.potrzeby.autonomia}%`}})})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Relacje spo\u0142eczne"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.potrzeby.relacjeSpoleczne,"/100"]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value",style:{width:`${t.potrzeby.relacjeSpoleczne}%`}})})]})]}):(0,a.jsx)("div",{className:"hr-no-data",children:"Brak zdefiniowanych potrzeb"})]}),(0,a.jsxs)("div",{className:"hr-employee-section",children:[(0,a.jsx)("h4",{children:"Historia"}),t.historia&&0!==t.historia.length?(0,a.jsx)("div",{className:"hr-history-list",children:t.historia.map(((e,t)=>(0,a.jsxs)("div",{className:"hr-history-item",children:[(0,a.jsxs)("div",{className:"hr-history-date",children:[new Date(e.data).toLocaleDateString("pl-PL")," (tura ",s.turn,")"]}),(0,a.jsx)("div",{className:"hr-history-description",children:e.opis})]},t)))}):(0,a.jsx)("div",{className:"hr-no-data",children:"Brak historii wydarze\u0144"})]})]})]})]})};var mv={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},fv=r.createContext&&r.createContext(mv),yv=["attr","size","title"];function gv(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function vv(){return vv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vv.apply(this,arguments)}function wv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wv(Object(n),!0).forEach((function(t){bv(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function bv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jv(e){return e&&e.map(((e,t)=>r.createElement(e.tag,xv({key:t},e.attr),jv(e.child))))}function kv(e){return t=>r.createElement(Nv,vv({attr:xv({},e.attr)},t),jv(e.child))}function Nv(e){var t=t=>{var n,{attr:i,size:a,title:s}=e,o=gv(e,yv),l=a||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),r.createElement("svg",vv({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,i,o,{className:n,style:xv(xv({color:e.color||t.color},t.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),s&&r.createElement("title",null,s),e.children)};return void 0!==fv?r.createElement(fv.Consumer,null,(e=>t(e))):t(mv)}function zv(e){return kv({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(e)}function _v(e){return kv({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},child:[]}]})(e)}const Ev=e=>{var t,n,i,s,o,l,c,u,h,p,m,f;let{playerState:y,gameState:g}=e;const{dispatch:v}=d(),[w,x]=(0,r.useState)("all"),b=[{id:"fancy_cars",name:"Luksusowe samochody s\u0142u\u017cbowe",category:"lessor",description:"\u0141adniejsze samochody do prezentowania przed rolnikami zwi\u0119kszaj\u0105 skuteczno\u015b\u0107 dzier\u017cawc\xf3w.",levels:[{level:1,cost:25e4,benefit:"+5% do skuteczno\u015bci pozyskiwania grunt\xf3w"},{level:2,cost:5e5,benefit:"+10% do skuteczno\u015bci pozyskiwania grunt\xf3w"},{level:3,cost:1e6,benefit:"+15% do skuteczno\u015bci pozyskiwania grunt\xf3w"}],currentLevel:(null===(t=y.companyUpgrades)||void 0===t?void 0:t.fancy_cars)||0},{id:"digital_mapping",name:"Cyfrowe mapy i analizy",category:"lessor",description:"Zaawansowane narz\u0119dzia do analizy grunt\xf3w pozwalaj\u0105 lepiej wybiera\u0107 lokalizacje.",levels:[{level:1,cost:5e5,benefit:"+10% do dok\u0142adno\u015bci analiz lokalizacyjnych"},{level:2,cost:1e6,benefit:"+20% do dok\u0142adno\u015bci analiz lokalizacyjnych"},{level:3,cost:2e6,benefit:"+35% do dok\u0142adno\u015bci analiz lokalizacyjnych"}],currentLevel:(null===(n=y.companyUpgrades)||void 0===n?void 0:n.digital_mapping)||0},{id:"drone_surveys",name:"Drony do inspekcji terenowych",category:"lessor",description:"Drony pozwalaj\u0105 szybko oceni\u0107 du\u017ce obszary i zidentyfikowa\u0107 najlepsze lokalizacje.",levels:[{level:1,cost:35e4,benefit:"+15% do szybko\u015bci analizy terenu"},{level:2,cost:7e5,benefit:"+25% do szybko\u015bci analizy terenu"},{level:3,cost:14e5,benefit:"+40% do szybko\u015bci analizy terenu"}],currentLevel:(null===(i=y.companyUpgrades)||void 0===i?void 0:i.drone_surveys)||0},{id:"dev_workstations",name:"Zaawansowane stacje robocze",category:"developer",description:"Wysokiej klasy komputery i oprogramowanie CAD dla developer\xf3w.",levels:[{level:1,cost:35e4,benefit:"+8% do szybko\u015bci rozwoju projekt\xf3w"},{level:2,cost:7e5,benefit:"+16% do szybko\u015bci rozwoju projekt\xf3w"},{level:3,cost:14e5,benefit:"+25% do szybko\u015bci rozwoju projekt\xf3w"}],currentLevel:(null===(s=y.companyUpgrades)||void 0===s?void 0:s.dev_workstations)||0},{id:"dev_software",name:"Specjalistyczne oprogramowanie",category:"developer",description:"Licencje na profesjonalne oprogramowanie dla developer\xf3w.",levels:[{level:1,cost:4e5,benefit:"+10% do jako\u015bci dokumentacji technicznej"},{level:2,cost:8e5,benefit:"+20% do jako\u015bci dokumentacji technicznej"},{level:3,cost:16e5,benefit:"+30% do jako\u015bci dokumentacji technicznej"}],currentLevel:(null===(o=y.companyUpgrades)||void 0===o?void 0:o.dev_software)||0},{id:"gis_tools",name:"Zaawansowane narz\u0119dzia GIS",category:"gis",description:"Profesjonalne oprogramowanie i sprz\u0119t do analizy przestrzennej.",levels:[{level:1,cost:5e5,benefit:"+10% do dok\u0142adno\u015bci analiz lokalizacyjnych"},{level:2,cost:1e6,benefit:"+20% do dok\u0142adno\u015bci analiz lokalizacyjnych"},{level:3,cost:2e6,benefit:"+35% do dok\u0142adno\u015bci analiz lokalizacyjnych"}],currentLevel:(null===(l=y.companyUpgrades)||void 0===l?void 0:l.gis_tools)||0},{id:"drone_fleet",name:"Flota dron\xf3w badawczych",category:"gis",description:"Drony z kamerami termowizyjnymi i multispektralnymi do badania terenu.",levels:[{level:1,cost:6e5,benefit:"+12% do szybko\u015bci analizy terenu"},{level:2,cost:12e5,benefit:"+25% do szybko\u015bci analizy terenu"},{level:3,cost:24e5,benefit:"+40% do szybko\u015bci analizy terenu"}],currentLevel:(null===(c=y.companyUpgrades)||void 0===c?void 0:c.drone_fleet)||0},{id:"law_database",name:"Baza danych prawniczych",category:"lawyer",description:"Dost\u0119p do profesjonalnych baz danych prawniczych i precedens\xf3w.",levels:[{level:1,cost:45e4,benefit:"+10% do skuteczno\u015bci w post\u0119powaniach administracyjnych"},{level:2,cost:9e5,benefit:"+20% do skuteczno\u015bci w post\u0119powaniach administracyjnych"},{level:3,cost:18e5,benefit:"+35% do skuteczno\u015bci w post\u0119powaniach administracyjnych"}],currentLevel:(null===(u=y.companyUpgrades)||void 0===u?void 0:u.law_database)||0},{id:"pr_campaigns",name:"Kampanie PR dla projekt\xf3w",category:"lobbyist",description:"Profesjonalne kampanie PR zwi\u0119kszaj\u0105ce akceptacj\u0119 spo\u0142eczn\u0105.",levels:[{level:1,cost:4e5,benefit:"+15% do akceptacji spo\u0142ecznej projekt\xf3w"},{level:2,cost:8e5,benefit:"+30% do akceptacji spo\u0142ecznej projekt\xf3w"},{level:3,cost:16e5,benefit:"+50% do akceptacji spo\u0142ecznej projekt\xf3w"}],currentLevel:(null===(h=y.companyUpgrades)||void 0===h?void 0:h.pr_campaigns)||0},{id:"company_offices",name:"Nowoczesna siedziba firmy",category:"company",description:"Presti\u017cowe biura zwi\u0119kszaj\u0105ce morale wszystkich pracownik\xf3w.",levels:[{level:1,cost:1e6,benefit:"+10% do morale wszystkich pracownik\xf3w"},{level:2,cost:25e5,benefit:"+20% do morale wszystkich pracownik\xf3w"},{level:3,cost:5e6,benefit:"+35% do morale wszystkich pracownik\xf3w"}],currentLevel:(null===(p=y.companyUpgrades)||void 0===p?void 0:p.company_offices)||0},{id:"employee_benefits",name:"Program benefit\xf3w pracowniczych",category:"company",description:"Kompleksowy pakiet benefit\xf3w poprawiaj\u0105cy zadowolenie i wydajno\u015b\u0107.",levels:[{level:1,cost:8e5,benefit:"+8% do wydajno\u015bci i -10% do rotacji pracownik\xf3w"},{level:2,cost:16e5,benefit:"+15% do wydajno\u015bci i -25% do rotacji pracownik\xf3w"},{level:3,cost:32e5,benefit:"+25% do wydajno\u015bci i -50% do rotacji pracownik\xf3w"}],currentLevel:(null===(m=y.companyUpgrades)||void 0===m?void 0:m.employee_benefits)||0},{id:"training_program",name:"Program szkole\u0144 wewn\u0119trznych",category:"company",description:"Systematyczne szkolenia zwi\u0119kszaj\u0105ce kompetencje ca\u0142ego zespo\u0142u.",levels:[{level:1,cost:6e5,benefit:"+10% szybszy wzrost do\u015bwiadczenia"},{level:2,cost:12e5,benefit:"+20% szybszy wzrost do\u015bwiadczenia"},{level:3,cost:24e5,benefit:"+35% szybszy wzrost do\u015bwiadczenia"}],currentLevel:(null===(f=y.companyUpgrades)||void 0===f?void 0:f.training_program)||0}],j="all"===w?b:b.filter((e=>e.category===w));return(0,a.jsxs)("div",{className:"company-upgrades",children:[(0,a.jsx)("h3",{children:"Ulepszenia firmowe"}),(0,a.jsx)("p",{className:"upgrades-description",children:"Inwestuj w rozw\xf3j swojej firmy, aby zwi\u0119kszy\u0107 wydajno\u015b\u0107 i skuteczno\u015b\u0107 twoich pracownik\xf3w. Ka\u017cde ulepszenie mo\u017cna rozwija\u0107 do trzeciego poziomu, zwi\u0119kszaj\u0105c efekty."}),(0,a.jsxs)("div",{className:"upgrades-filters",children:[(0,a.jsx)("button",{className:"filter-btn "+("all"===w?"active":""),onClick:()=>x("all"),children:"Wszystkie"}),(0,a.jsx)("button",{className:"filter-btn "+("lessor"===w?"active":""),onClick:()=>x("lessor"),children:"Dzier\u017cawcy"}),(0,a.jsx)("button",{className:"filter-btn "+("developer"===w?"active":""),onClick:()=>x("developer"),children:"Developerzy"}),(0,a.jsx)("button",{className:"filter-btn "+("gis"===w?"active":""),onClick:()=>x("gis"),children:"GIS"}),(0,a.jsx)("button",{className:"filter-btn "+("lawyer"===w?"active":""),onClick:()=>x("lawyer"),children:"Prawnicy"}),(0,a.jsx)("button",{className:"filter-btn "+("lobbyist"===w?"active":""),onClick:()=>x("lobbyist"),children:"Lobby\u015bci"}),(0,a.jsx)("button",{className:"filter-btn "+("company"===w?"active":""),onClick:()=>x("company"),children:"Firma"})]}),(0,a.jsx)("div",{className:"upgrades-grid",children:j.map((e=>{const t=e.currentLevel+1,n=t>e.levels.length,r=n?null:e.levels[t-1];return(0,a.jsxs)("div",{className:"upgrade-card",children:[(0,a.jsxs)("div",{className:"upgrade-header",children:[(0,a.jsx)("div",{className:"upgrade-title",children:e.name}),(0,a.jsxs)("div",{className:"upgrade-level",children:["Poziom ",e.currentLevel,"/",e.levels.length]})]}),(0,a.jsx)("div",{className:"upgrade-description",children:e.description}),(0,a.jsxs)("div",{className:"upgrade-current-benefits",children:[(0,a.jsx)("div",{className:"upgrade-benefit-title",children:"Obecne korzy\u015bci:"}),0===e.currentLevel?(0,a.jsx)("div",{className:"upgrade-no-benefits",children:"Brak (ulepszenie nie zakupione)"}):(0,a.jsxs)("div",{className:"upgrade-benefit",children:[(0,a.jsx)(zv,{className:"upgrade-benefit-icon"}),(0,a.jsx)("span",{children:e.levels[e.currentLevel-1].benefit})]})]}),!n&&(0,a.jsxs)("div",{className:"upgrade-next-level",children:[(0,a.jsx)("div",{className:"upgrade-benefit-title",children:"Nast\u0119pny poziom:"}),(0,a.jsxs)("div",{className:"upgrade-benefit",children:[(0,a.jsx)(_v,{className:"upgrade-benefit-icon"}),(0,a.jsx)("span",{children:r.benefit})]})]}),(0,a.jsx)("div",{className:"upgrade-cost",children:n?(0,a.jsx)("div",{className:"upgrade-max-level",children:"Osi\u0105gni\u0119to maksymalny poziom"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"upgrade-price",children:["Koszt: ",r.cost.toLocaleString()," PLN"]}),(0,a.jsx)("button",{className:"upgrade-button",onClick:()=>(e=>{const t=b.find((t=>t.id===e));if(!t)return;const n=t.currentLevel+1;if(n>t.levels.length)return;const r=t.levels[n-1].cost;y.cash<r?alert("Niewystarczaj\u0105ce \u015brodki!"):v({type:"PURCHASE_COMPANY_UPGRADE",payload:{upgradeId:e,level:n,cost:r}})})(e.id),disabled:y.cash<r.cost,children:y.cash>=r.cost?"Ulepsz":"Za ma\u0142o \u015brodk\xf3w"})]})})]},e.id)}))})]})},Sv=e=>{let{employees:t,staffManagement:n,gameState:i}=e;const[s,o]=(0,r.useState)(null),[l,c]=(0,r.useState)("skill"),[d,u]=(0,r.useState)("all"),h=(0,r.useMemo)((()=>"all"===d?t:t.filter((e=>e.typeShort===d))),[t,d]),p=(0,r.useMemo)((()=>t.find((e=>e.id===s))||null),[t,s]),m=(0,r.useMemo)((()=>(e=>{if(!e)return[];const t=[{id:"skill",name:"Rozw\xf3j umiej\u0119tno\u015bci",description:"Zwi\u0119ksza og\xf3lny poziom umiej\u0119tno\u015bci pracownika.",cost:e.skill/2*5e3},{id:"morale",name:"Budowanie morale",description:"Zwi\u0119ksza morale i zaanga\u017cowanie pracownika.",cost:3e3}];if("developer"===e.typeShort){const e=[{id:"tech_pv",name:"Technologia PV",description:"Pog\u0142\u0119biona wiedza o technologii fotowoltaicznej.",cost:8e3},{id:"tech_wind",name:"Technologia wiatrowa",description:"Specjalistyczna wiedza o turbinach wiatrowych.",cost:1e4},{id:"tech_bess",name:"Magazyny energii",description:"Specjalistyczna wiedza o magazynach energii.",cost:12e3},{id:"tech_hybrid",name:"Systemy hybrydowe",description:"Wiedza o \u0142\u0105czeniu r\xf3\u017cnych technologii OZE.",cost:15e3}];return[...t,...e]}if("lessor"===e.typeShort){const e=[{id:"negotiation_skills",name:"Techniki negocjacji",description:"Zwi\u0119ksza umiej\u0119tno\u015bci negocjacyjne dzier\u017cawcy, co przek\u0142ada si\u0119 na lepsze warunki um\xf3w dzier\u017cawy.",duration:5,cost:5e3,effects:{negotiation:15,landAcquisitionSpeed:10}},{id:"land_valuation",name:"Wycena grunt\xf3w",description:"Pozwala lepiej ocenia\u0107 warto\u015b\u0107 grunt\xf3w, co zmniejsza koszty dzier\u017cawy.",duration:4,cost:4e3,effects:{landCostReduction:8,landQualityAssessment:15}},{id:"local_relations",name:"Relacje lokalne",description:"Uczy budowania relacji z lokalnymi spo\u0142eczno\u015bciami, co u\u0142atwia pozyskiwanie grunt\xf3w.",duration:6,cost:6e3,effects:{localRelations:20,landAcquisitionSpeed:15}}];return[...t,...e]}if("lawyer"===e.typeShort){const e=[{id:"energy_law",name:"Prawo energetyczne",description:"Pog\u0142\u0119biona wiedza o prawie energetycznym.",cost:9e3},{id:"env_regulations",name:"Regulacje \u015brodowiskowe",description:"Pog\u0142\u0119biona wiedza o przepisach ochrony \u015brodowiska.",cost:8e3}];return[...t,...e]}if("envSpecialist"===e.typeShort){const e=[{id:"env_assessment",name:"Oceny oddzia\u0142ywania",description:"Zaawansowane techniki oceny wp\u0142ywu na \u015brodowisko.",cost:8e3},{id:"nature_protection",name:"Ochrona przyrody",description:"Specjalistyczna wiedza o obszarach chronionych.",cost:7e3}];return[...t,...e]}if("lobbyist"===e.typeShort){const e=[{id:"public_relations",name:"Relacje publiczne",description:"Techniki budowania pozytywnych relacji.",cost:6e3},{id:"community_management",name:"Zarz\u0105dzanie spo\u0142eczno\u015bci\u0105",description:"Sposoby anga\u017cowania lokalnych spo\u0142eczno\u015bci.",cost:7e3}];return[...t,...e]}return t})(p)),[p]),f=(0,r.useMemo)((()=>m.find((e=>e.id===l))||null),[m,l]);return(0,a.jsxs)("div",{className:"training-center",children:[(0,a.jsx)("h3",{children:"Centrum szkole\u0144"}),(0,a.jsx)("p",{className:"training-description",children:"Rozwijaj umiej\u0119tno\u015bci swoich pracownik\xf3w poprzez specjalistyczne szkolenia. Ka\u017cde szkolenie zwi\u0119ksza poziom umiej\u0119tno\u015bci i do\u015bwiadczenie pracownika."}),(0,a.jsx)("div",{className:"training-filters",children:(0,a.jsxs)("select",{value:d,onChange:e=>u(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"Wszyscy pracownicy"}),(0,a.jsx)("option",{value:"lessor",children:"Dzier\u017cawcy"}),(0,a.jsx)("option",{value:"developer",children:"Developerzy"}),(0,a.jsx)("option",{value:"lawyer",children:"Prawnicy"}),(0,a.jsx)("option",{value:"envSpecialist",children:"Spec. \u015brodowiskowi"}),(0,a.jsx)("option",{value:"lobbyist",children:"Lobby\u015bci"})]})}),(0,a.jsxs)("div",{className:"training-grid",children:[(0,a.jsxs)("div",{className:"employees-for-training",children:[(0,a.jsx)("h4",{children:"Wybierz pracownika do szkolenia"}),0===h.length?(0,a.jsx)("div",{className:"no-employees-message",children:"Brak pracownik\xf3w spe\u0142niaj\u0105cych kryteria"}):(0,a.jsx)("div",{className:"training-employees-list",children:h.map((e=>(0,a.jsxs)("div",{className:"training-employee-item "+(s===e.id?"selected":""),onClick:()=>o(e.id),children:[(0,a.jsx)("div",{className:"training-employee-name",children:e.name}),(0,a.jsxs)("div",{className:"training-employee-info",children:[(0,a.jsx)("span",{children:My(e.typeShort)}),(0,a.jsxs)("span",{children:["Poziom: ",e.skill,"/10"]})]}),(0,a.jsxs)("div",{className:"training-employee-exp",children:["Do\u015bwiadczenie: ",e.experience," p.d."]})]},e.id)))})]}),(0,a.jsx)("div",{className:"training-options",children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h4",{children:"Dost\u0119pne szkolenia"}),(0,a.jsx)("div",{className:"training-types-list",children:m.map((e=>(0,a.jsxs)("div",{className:"training-type-item "+(l===e.id?"selected":""),onClick:()=>c(e.id),children:[(0,a.jsx)("div",{className:"training-type-name",children:e.name}),(0,a.jsxs)("div",{className:"training-type-cost",children:[e.cost.toLocaleString()," PLN"]})]},e.id)))}),f&&(0,a.jsxs)("div",{className:"training-details",children:[(0,a.jsx)("h5",{children:f.name}),(0,a.jsx)("p",{children:f.description}),(0,a.jsxs)("div",{className:"training-cost",children:["Koszt: ",f.cost.toLocaleString()," PLN"]}),(0,a.jsxs)("div",{className:"training-benefits",children:[(0,a.jsx)("div",{className:"training-benefit-title",children:"Korzy\u015bci:"}),"skill"===l&&(0,a.jsx)("div",{className:"training-benefit-item",children:"\u2022 Wzrost umiej\u0119tno\u015bci o 1 punkt"}),"morale"===l&&(0,a.jsx)("div",{className:"training-benefit-item",children:"\u2022 Wzrost morale o 20 punkt\xf3w"}),l.startsWith("tech_")&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"training-benefit-item",children:"\u2022 Dodatkowe do\u015bwiadczenie w technologii"}),(0,a.jsx)("div",{className:"training-benefit-item",children:"\u2022 Szybszy rozw\xf3j projekt\xf3w tej technologii"})]}),"negotiation"===l&&(0,a.jsx)("div",{className:"training-benefit-item",children:"\u2022 Wy\u017csze szanse na pozyskanie grunt\xf3w"}),"land_valuation"===l&&(0,a.jsx)("div",{className:"training-benefit-item",children:"\u2022 Lepsza ocena potencja\u0142u grunt\xf3w"}),(0,a.jsx)("div",{className:"training-benefit-item",children:"\u2022 Wzrost do\u015bwiadczenia zawodowego"})]}),(0,a.jsx)("button",{className:"start-training-button",onClick:()=>{p&&f&&n.trainStaff(p.typeShort,p.id,l)},children:"Rozpocznij szkolenie"})]})]}):(0,a.jsx)("div",{className:"select-employee-prompt",children:"Wybierz pracownika z listy, aby zobaczy\u0107 dost\u0119pne szkolenia"})})]})]})},Cv=()=>{const{state:e,dispatch:t}=d(),{state:n,showNotification:i}=mf(),s=Ly(),[o,l]=(0,r.useState)("employees"),[c,u]=(0,r.useState)(null),[h,p]=(0,r.useState)(null),m=()=>{const t=[];return["lessors","developers","lawyers","envSpecialists","lobbyists"].forEach((n=>{e.staff[n]&&e.staff[n].forEach((e=>{t.push({...e,typePlural:n,typeShort:n.endsWith("s")?n.slice(0,-1):n})}))})),t};return(0,a.jsxs)("div",{className:"hr-system-container",children:[(0,a.jsxs)("div",{className:"hr-system-header",children:[(0,a.jsx)("h2",{children:"System zarz\u0105dzania zasobami ludzkimi"}),(0,a.jsxs)("div",{className:"hr-system-tabs",children:[(0,a.jsx)("button",{className:"employees"===o?"active":"",onClick:()=>l("employees"),children:"Pracownicy"}),(0,a.jsx)("button",{className:"training"===o?"active":"",onClick:()=>l("training"),children:"Szkolenia"}),(0,a.jsx)("button",{className:"upgrades"===o?"active":"",onClick:()=>l("upgrades"),children:"Ulepszenia firmy"}),(0,a.jsx)("button",{className:"employment"===o?"active":"",onClick:()=>l("employment"),children:"Zatrudnienie"})]})]}),(0,a.jsxs)("div",{className:"hr-system-content",children:["employees"===o&&(0,a.jsxs)("div",{className:"hr-employees-view",children:[(0,a.jsx)(hv,{employees:m(),onSelectEmployee:e=>{u(e),p(e.typeShort)},selectedEmployeeId:null===c||void 0===c?void 0:c.id}),c&&(0,a.jsx)(pv,{employee:c,staffType:h,staffManagement:s,gameState:n})]}),"training"===o&&(0,a.jsx)(Sv,{employees:m(),staffManagement:s,gameState:n}),"upgrades"===o&&(0,a.jsx)(Ev,{playerState:e,gameState:n}),"employment"===o&&(0,a.jsx)(gg,{staffManagement:s,gameState:n,playerState:e})]})]})},Tv=e=>{let{onLoginComplete:t}=e;const[n,i]=(0,r.useState)(""),[s,o]=(0,r.useState)(!1),[l,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(null);(0,r.useEffect)((()=>{const e=lf((e=>{u(e),e&&e.displayName&&t(e)}));return()=>e()}),[t]);return(0,a.jsxs)("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-b from-gray-900 to-gray-800 overflow-hidden relative",children:[(0,a.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute w-96 h-96 rounded-full bg-green-500 opacity-10 -top-20 -left-20 animate-pulse"}),(0,a.jsx)("div",{className:"absolute w-128 h-128 rounded-full bg-blue-500 opacity-10 -bottom-40 -right-40 animate-pulse",style:{animationDuration:"8s"}}),(0,a.jsx)("div",{className:"absolute top-1/4 left-1/4 w-12 h-12 bg-yellow-400 opacity-20 rounded-full animate-float",style:{animationDuration:"5s"}}),(0,a.jsx)("div",{className:"absolute bottom-1/3 right-1/3 w-16 h-16 bg-purple-500 opacity-20 rounded-full animate-float",style:{animationDuration:"7s"}}),(0,a.jsx)("div",{className:"absolute top-2/3 left-1/5 w-8 h-8 bg-red-400 opacity-15 rounded-full animate-float",style:{animationDuration:"6s"}}),(0,a.jsx)("div",{className:"absolute top-1/5 right-1/4 w-10 h-10 bg-indigo-400 opacity-15 rounded-full animate-float",style:{animationDuration:"9s"}}),(0,a.jsxs)("div",{className:"absolute inset-0 opacity-10",children:[(0,a.jsx)("div",{className:"absolute top-1/4 left-0 right-0 h-px bg-gradient-to-r from-transparent via-blue-500 to-transparent"}),(0,a.jsx)("div",{className:"absolute top-2/4 left-0 right-0 h-px bg-gradient-to-r from-transparent via-green-500 to-transparent"}),(0,a.jsx)("div",{className:"absolute top-3/4 left-0 right-0 h-px bg-gradient-to-r from-transparent via-purple-500 to-transparent"})]})]}),(0,a.jsxs)("div",{className:"w-full max-w-md p-8 space-y-8 bg-gray-800 rounded-xl shadow-[0_20px_50px_rgba(0,0,0,0.5)] relative z-10 border border-gray-700 transform transition-all duration-300 hover:scale-[1.01] hover:shadow-[0_25px_60px_rgba(0,0,0,0.5)]",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-blue-500",children:"OZE Developer Manager"}),(0,a.jsx)("p",{className:"mt-3 text-xl text-gray-300 font-light",children:"Witaj w symulatorze dewelopera OZE!"}),(0,a.jsx)("div",{className:"h-1 w-32 bg-gradient-to-r from-green-400 to-blue-500 mx-auto my-4 rounded-full"})]}),d?(0,a.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),n.trim()){o(!0),c(null);try{await(async e=>{try{return await Wr(ef.currentUser,{displayName:e}),ef.currentUser}catch(l){throw console.error("B\u0142\u0105d aktualizacji nazwy u\u017cytkownika:",l),l}})(n),t(d)}catch(l){c("B\u0142\u0105d ustawiania nazwy u\u017cytkownika. Spr\xf3buj ponownie."),console.error(l)}finally{o(!1)}}else c("Prosz\u0119 poda\u0107 nazw\u0119 u\u017cytkownika")},className:"mt-8 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"nickname",className:"block text-sm font-medium text-gray-300",children:"Tw\xf3j nickname do tablicy wynik\xf3w"}),(0,a.jsx)("input",{id:"nickname",name:"nickname",type:"text",required:!0,value:n,onChange:e=>i(e.target.value),placeholder:"Podaj sw\xf3j nickname",className:"w-full px-3 py-2 mt-1 text-gray-200 placeholder-gray-500 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 shadow-inner transition-all duration-200"})]}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"submit",disabled:s,className:"w-full px-4 py-3 font-bold text-white transition-all duration-300 bg-gradient-to-r from-green-600 to-blue-600 rounded-lg hover:from-green-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transform hover:scale-105 hover:shadow-[0_5px_15px_rgba(0,0,0,0.3)] shadow-lg",children:s?(0,a.jsxs)("span",{className:"flex items-center justify-center",children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Zapisywanie..."]}):"Zapisz i graj"})})]}):(0,a.jsx)("div",{className:"mt-8",children:(0,a.jsx)("button",{onClick:async()=>{o(!0),c(null);try{await nf()}catch(l){c("B\u0142\u0105d logowania. Spr\xf3buj ponownie."),console.error(l)}finally{o(!1)}},disabled:s,className:"w-full px-4 py-3 font-bold text-white transition-all duration-300 bg-gradient-to-r from-green-600 to-blue-600 rounded-lg hover:from-green-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transform hover:scale-105 hover:shadow-[0_5px_15px_rgba(0,0,0,0.3)] shadow-lg",children:s?(0,a.jsxs)("span",{className:"flex items-center justify-center",children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Logowanie..."]}):"Rozpocznij gr\u0119"})}),l&&(0,a.jsx)("div",{className:"p-4 mt-4 text-red-800 bg-red-100 rounded-md animate-pulse",children:(0,a.jsx)("p",{children:l})}),(0,a.jsxs)("div",{className:"text-center text-gray-500 text-sm mt-6",children:[(0,a.jsx)("p",{children:"\xa9 2023 OZE Developer Manager"}),(0,a.jsx)("style",{jsx:!0,children:"\n            @keyframes float {\n              0%, 100% { transform: translateY(0); }\n              50% { transform: translateY(-10px); }\n            }\n            .animate-float {\n              animation: float 5s ease-in-out infinite;\n            }\n          "})]})]})]})},Pv=e=>{let{onBack:t}=e;const[n,i]=(0,r.useState)([]),[s,o]=(0,r.useState)(!0),[l,c]=(0,r.useState)(null),[d,u]=(0,r.useState)("25GW");(0,r.useEffect)((()=>{h()}),[d]);const h=async()=>{o(!0),c(null);try{const e=await of(d);Array.isArray(e)?i(e):(i([]),c("Nie otrzymano poprawnych danych z serwera. Spr\xf3buj ponownie p\xf3\u017aniej."))}catch(l){console.error("B\u0142\u0105d \u0142adowania tablicy wynik\xf3w:",l),i([]),c("Nie uda\u0142o si\u0119 za\u0142adowa\u0107 tablicy wynik\xf3w. Spr\xf3buj ponownie p\xf3\u017aniej.")}finally{o(!1)}},p=e=>{if(!e)return"N/A";return(e.toDate?e.toDate():new Date(e)).toLocaleDateString("pl-PL")};return(0,a.jsx)("div",{className:"flex flex-col min-h-screen bg-gray-800 text-white p-6",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto w-full",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-green-500",children:"Tablica Wynik\xf3w"}),(0,a.jsx)("button",{onClick:t,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",children:"Powr\xf3t do gry"})]}),(0,a.jsxs)("div",{className:"flex mb-6 border-b border-gray-700",children:[(0,a.jsx)("button",{className:"px-4 py-2 "+("25GW"===d?"text-green-500 border-b-2 border-green-500":"text-gray-400"),onClick:()=>u("25GW"),children:"Cel: 25 GW mocy"}),(0,a.jsx)("button",{className:"px-4 py-2 "+("10BLN"===d?"text-green-500 border-b-2 border-green-500":"text-gray-400"),onClick:()=>u("10BLN"),children:"Cel: 10 mld PLN"})]}),s?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)("p",{className:"text-xl text-gray-400",children:"\u0141adowanie wynik\xf3w..."})}):l?(0,a.jsx)("div",{className:"bg-red-900/20 border border-red-800 p-4 rounded-lg",children:(0,a.jsx)("p",{children:l})}):0===n.length?(0,a.jsxs)("div",{className:"bg-gray-700 p-8 rounded-lg text-center",children:[(0,a.jsx)("p",{className:"text-xl mb-2",children:"Nikomu jeszcze si\u0119 nie uda\u0142o, czy b\u0119dziesz pierwszy?"}),(0,a.jsx)("p",{className:"text-gray-400",children:"B\u0105d\u017a pierwszym, kt\xf3ry uko\u0144czy gr\u0119 z tym celem!"})]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full bg-gray-700 rounded-lg overflow-hidden",children:[(0,a.jsx)("thead",{className:"bg-gray-800",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left",children:"Miejsce"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left",children:"Gracz"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left",children:"Liczba tur"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left",children:"Liczba dni"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left",children:"Data uko\u0144czenia"})]})}),(0,a.jsx)("tbody",{children:n.map(((e,t)=>(0,a.jsxs)("tr",{className:t%2===0?"bg-gray-700":"bg-gray-650",children:[(0,a.jsx)("td",{className:"px-6 py-4",children:0===t?(0,a.jsx)("span",{className:"text-yellow-400 font-bold",children:"\ud83c\udfc6 1"}):1===t?(0,a.jsx)("span",{className:"text-gray-300 font-bold",children:"\ud83e\udd48 2"}):2===t?(0,a.jsx)("span",{className:"text-amber-600 font-bold",children:"\ud83e\udd49 3"}):`${t+1}`}),(0,a.jsx)("td",{className:"px-6 py-4 font-medium",children:e.nickname}),(0,a.jsx)("td",{className:"px-6 py-4",children:e.turns}),(0,a.jsx)("td",{className:"px-6 py-4",children:e.days}),(0,a.jsx)("td",{className:"px-6 py-4",children:p(e.timestamp)})]},e.id)))})]})})]})})},Iv=()=>{const[e,t]=(0,r.useState)(null),[n,i]=(0,r.useState)(!1),{state:s,dispatch:o}=mf(),{state:l,dispatch:c}=d();(0,r.useEffect)((()=>{"leaderboard"===s.appView&&(i(!0),o({type:"SET_APP_VIEW",payload:null}))}),[s.appView,o]);const u=(0,r.useCallback)((()=>{n&&i(!1)}),[n]);(0,r.useEffect)((()=>(window.addEventListener("next-game-day",u),()=>{window.removeEventListener("next-game-day",u)})),[u]);const h=(0,r.useCallback)((e=>{e&&e.preventDefault&&e.preventDefault();try{window.history.pushState(null,document.title,window.location.href)}catch(t){console.error("B\u0142\u0105d przy manipulacji historii:",t)}n&&i(!1)}),[n]);(0,r.useEffect)((()=>{try{window.history.pushState(null,document.title,window.location.href),window.addEventListener("popstate",h)}catch(e){console.error("B\u0142\u0105d przy dodawaniu obs\u0142ugi historii:",e)}return()=>{try{window.removeEventListener("popstate",h)}catch(e){console.error("B\u0142\u0105d przy usuwaniu obs\u0142ugi historii:",e)}}}),[h]);const p=(0,r.useCallback)((async()=>{if(e)try{await rf(s,l),console.log("Stan gry zapisany")}catch(t){console.error("B\u0142\u0105d zapisywania stanu gry:",t)}}),[e,s,l]);(0,r.useEffect)((()=>{if(!e)return;const t=setInterval(p,6e4);return()=>clearInterval(t)}),[e,p]);const m=(0,r.useCallback)((async t=>{if(e)try{await sf(t,s.day),console.log(`Osi\u0105gni\u0119to cel: ${t}`)}catch(n){console.error("B\u0142\u0105d zapisywania wyniku:",n)}}),[e,s.day]);(0,r.useEffect)((()=>{e&&l&&(l.installedCapacity+l.rtbCapacity>=25e3&&m("25GW"),l.cash>=1e10&&m("10BLN"))}),[e,l,m]),(0,r.useEffect)((()=>{if(e)return window.saveGameFunction=p,()=>{window.saveGameFunction=void 0}}),[e,p]);const f=async e=>{t(e);try{const e=await af();e&&e.gameState&&(o({type:"LOAD_GAME",payload:e.gameState}),c({type:"LOAD_PLAYER",payload:e.playerState}),console.log("Wczytano zapisany stan gry"),o({type:"SET_NOTIFICATION",payload:{text:"Wczytano zapisany stan gry!",type:"success"}}))}catch(n){console.error("B\u0142\u0105d wczytywania stanu gry:",n)}},y=()=>{p()};if(!e)return(0,a.jsx)(Tv,{onLoginComplete:f});if(n)return(0,a.jsx)(Pv,{onBack:()=>i(!1)});const g=()=>{switch(s.currentScreen){case"home":default:return(0,a.jsx)(Iy,{onShowLeaderboard:()=>i(!0),onSaveGame:y});case"regions":return(0,a.jsx)(uv,{});case"company":return(0,a.jsx)(Mg,{});case"events":return(0,a.jsx)(Zg,{});case"competitors":return(0,a.jsx)(tv,{});case"market":return(0,a.jsx)(iv,{});case"hr":return(0,a.jsx)(Cv,{})}};return(0,a.jsx)(Sy,{children:(0,a.jsx)(g,{})})};const Av=function(){return(0,a.jsx)(Rf,{children:(0,a.jsx)(Iv,{})})};i.createRoot(document.getElementById("root")).render((0,a.jsx)(r.StrictMode,{children:(0,a.jsx)(Av,{})}))})();