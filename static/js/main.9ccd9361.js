/*! For license information please see main.9ccd9361.js.LICENSE.txt */
(()=>{"use strict";var e={49:(e,t)=>{var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,y={};function g(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||m}function v(){}function w(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||m}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=g.prototype;var x=w.prototype=new v;x.constructor=w,f(x,g.prototype),x.isPureReactComponent=!0;var b=Array.isArray,j=Object.prototype.hasOwnProperty,k={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function z(e,t,i){var a,r={},s=null,o=null;if(null!=t)for(a in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)j.call(t,a)&&!N.hasOwnProperty(a)&&(r[a]=t[a]);var l=arguments.length-2;if(1===l)r.children=i;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];r.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===r[a]&&(r[a]=l[a]);return{$$typeof:n,type:e,key:s,ref:o,props:r,_owner:k.current}}function _(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function S(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function T(e,t,a,r,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return s=s(l=e),e=""===r?"."+S(l,0):r,b(s)?(a="",null!=e&&(a=e.replace(E,"$&/")+"/"),T(s,t,a,"",(function(e){return e}))):null!=s&&(_(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,a+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(E,"$&/")+"/")+e)),t.push(s)),1;if(l=0,r=""===r?".":r+":",b(e))for(var c=0;c<e.length;c++){var d=r+S(o=e[c],c);l+=T(o,t,a,d,s)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(o=e.next()).done;)l+=T(o=o.value,t,a,d=r+S(o,c++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function C(e,t,n){if(null==e)return e;var i=[],a=0;return T(e,i,"","",(function(e){return t.call(n,e,a++)})),i}function P(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},A={transition:null},M={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:A,ReactCurrentOwner:k};function D(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:C,forEach:function(e,t,n){C(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return C(e,(function(){t++})),t},toArray:function(e){return C(e,(function(e){return e}))||[]},only:function(e){if(!_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=a,t.Profiler=s,t.PureComponent=w,t.StrictMode=r,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,t.act=D,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=f({},e.props),r=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=k.current),void 0!==t.key&&(r=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)j.call(t,c)&&!N.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=i;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];a.children=l}return{$$typeof:n,type:e.type,key:r,ref:s,props:a,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=z,t.createFactory=function(e){var t=z.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=_,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=A.transition;A.transition={};try{e()}finally{A.transition=t}},t.unstable_act=D,t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,n){return I.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,n){return I.current.useReducer(e,t,n)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return I.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return I.current.useTransition()},t.version="18.3.1"},119:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(345)},340:(e,t,n)=>{e.exports=n(761)},345:(e,t,n)=>{var i=n(950),a=n(340);function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function f(e,t,n,i,a,r,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=r,this.removeEmptyString=s}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){y[e]=new f(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];y[t]=new f(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){y[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){y[e]=new f(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){y[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){y[e]=new f(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){y[e]=new f(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){y[e]=new f(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){y[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function w(e,t,n,i){var a=y.hasOwnProperty(t)?y[t]:null;(null!==a?0!==a.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||"undefined"===typeof t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,i)&&(n=null),i||null===a?function(e){return!!u.call(m,e)||!u.call(p,e)&&(h.test(e)?m[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,i=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,v);y[t]=new f(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,v);y[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,v);y[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){y[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)})),y.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){y[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),j=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),E=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var A=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=M&&e[M]||e["@@iterator"])?e:null}var R,O=Object.assign;function L(e){if(void 0===R)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);R=t&&t[1]||""}return"\n"+R+e}var F=!1;function U(e,t){if(!e||F)return"";F=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),r=i.stack.split("\n"),s=a.length-1,o=r.length-1;1<=s&&0<=o&&a[s]!==r[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==r[o]){if(1!==s||1!==o)do{if(s--,0>--o||a[s]!==r[o]){var l="\n"+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=o);break}}}finally{F=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?L(e):""}function V(e){switch(e.tag){case 5:return L(e.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function $(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case k:return"Fragment";case j:return"Portal";case z:return"Profiler";case N:return"StrictMode";case T:return"Suspense";case C:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case _:return(e._context.displayName||"Context")+".Provider";case S:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:$(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return $(e(t))}catch(n){}}return null}function B(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $(t);case 8:return t===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,r=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){i=""+e,r.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function G(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=q(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(kr){return e.body}}function Q(e,t){var n=t.checked;return O({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Z(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&w(e,"checked",t,!1)}function J(e,t){Y(e,t);var n=W(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function X(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&i&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(i&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(r(91));return O({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(r(92));if(te(n)){if(1<n.length)throw Error(r(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function re(e,t){var n=W(t.value),i=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction((function(){return de(e,t)}))}:de);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ye(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),a=fe(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,a):e[n]=a}}Object.keys(pe).forEach((function(e){me.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ge=O({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(r(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(r(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(r(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(r(62))}}function we(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var je=null,ke=null,Ne=null;function ze(e){if(e=wa(e)){if("function"!==typeof je)throw Error(r(280));var t=e.stateNode;t&&(t=ba(t),je(e.stateNode,e.type,t))}}function _e(e){ke?Ne?Ne.push(e):Ne=[e]:ke=e}function Ee(){if(ke){var e=ke,t=Ne;if(Ne=ke=null,ze(e),t)for(e=0;e<t.length;e++)ze(t[e])}}function Se(e,t){return e(t)}function Te(){}var Ce=!1;function Pe(e,t,n){if(Ce)return e(t,n);Ce=!0;try{return Se(e,t,n)}finally{Ce=!1,(null!==ke||null!==Ne)&&(Te(),Ee())}}function Ie(e,t){var n=e.stateNode;if(null===n)return null;var i=ba(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(r(231,t,typeof n));return n}var Ae=!1;if(d)try{var Me={};Object.defineProperty(Me,"passive",{get:function(){Ae=!0}}),window.addEventListener("test",Me,Me),window.removeEventListener("test",Me,Me)}catch(de){Ae=!1}function De(e,t,n,i,a,r,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var Re=!1,Oe=null,Le=!1,Fe=null,Ue={onError:function(e){Re=!0,Oe=e}};function Ve(e,t,n,i,a,r,s,o,l){Re=!1,Oe=null,De.apply(Ue,arguments)}function $e(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Be(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if($e(e)!==e)throw Error(r(188))}function qe(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=$e(e)))throw Error(r(188));return t!==e?null:e}for(var n=e,i=t;;){var a=n.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(i=a.return)){n=i;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return We(a),e;if(s===i)return We(a),t;s=s.sibling}throw Error(r(188))}if(n.return!==i.return)n=a,i=s;else{for(var o=!1,l=a.child;l;){if(l===n){o=!0,n=a,i=s;break}if(l===i){o=!0,i=a,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,i=a;break}if(l===i){o=!0,i=s,n=a;break}l=l.sibling}if(!o)throw Error(r(189))}}if(n.alternate!==i)throw Error(r(190))}if(3!==n.tag)throw Error(r(188));return n.stateNode.current===n?e:t}(e),null!==e?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Ge=a.unstable_scheduleCallback,Ke=a.unstable_cancelCallback,Qe=a.unstable_shouldYield,Ze=a.unstable_requestPaint,Ye=a.unstable_now,Je=a.unstable_getCurrentPriorityLevel,Xe=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,it=a.unstable_IdlePriority,at=null,rt=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,a=e.suspendedLanes,r=e.pingedLanes,s=268435455&n;if(0!==s){var o=s&~a;0!==o?i=ut(o):0!==(r&=s)&&(i=ut(r))}else 0!==(s=n&~a)?i=ut(s):0!==r&&(i=ut(r));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&a)&&((a=i&-i)>=(r=t&-t)||16===a&&0!==(4194240&r)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)a=1<<(n=31-st(t)),i|=e[n],t&=~a;return i}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function yt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-st(n),a=1<<i;a&t|e[i]&t&&(e[i]|=t),n&=~a}}var wt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var bt,jt,kt,Nt,zt,_t=!1,Et=[],St=null,Tt=null,Ct=null,Pt=new Map,It=new Map,At=[],Mt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":St=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":Ct=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":It.delete(t.pointerId)}}function Rt(e,t,n,i,a,r){return null===e||e.nativeEvent!==r?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:r,targetContainers:[a]},null!==t&&(null!==(t=wa(t))&&jt(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Ot(e){var t=va(e.target);if(null!==t){var n=$e(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Be(n)))return e.blockedOn=t,void zt(e.priority,(function(){kt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Lt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=wa(n))&&jt(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);xe=i,n.target.dispatchEvent(i),xe=null,t.shift()}return!0}function Ft(e,t,n){Lt(e)&&n.delete(t)}function Ut(){_t=!1,null!==St&&Lt(St)&&(St=null),null!==Tt&&Lt(Tt)&&(Tt=null),null!==Ct&&Lt(Ct)&&(Ct=null),Pt.forEach(Ft),It.forEach(Ft)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,_t||(_t=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ut)))}function $t(e){function t(t){return Vt(t,e)}if(0<Et.length){Vt(Et[0],e);for(var n=1;n<Et.length;n++){var i=Et[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==St&&Vt(St,e),null!==Tt&&Vt(Tt,e),null!==Ct&&Vt(Ct,e),Pt.forEach(t),It.forEach(t),n=0;n<At.length;n++)(i=At[n]).blockedOn===e&&(i.blockedOn=null);for(;0<At.length&&null===(n=At[0]).blockedOn;)Ot(n),null===n.blockedOn&&At.shift()}var Bt=x.ReactCurrentBatchConfig,Wt=!0;function qt(e,t,n,i){var a=wt,r=Bt.transition;Bt.transition=null;try{wt=1,Gt(e,t,n,i)}finally{wt=a,Bt.transition=r}}function Ht(e,t,n,i){var a=wt,r=Bt.transition;Bt.transition=null;try{wt=4,Gt(e,t,n,i)}finally{wt=a,Bt.transition=r}}function Gt(e,t,n,i){if(Wt){var a=Qt(e,t,n,i);if(null===a)Wi(e,t,i,Kt,n),Dt(e,i);else if(function(e,t,n,i,a){switch(t){case"focusin":return St=Rt(St,e,t,n,i,a),!0;case"dragenter":return Tt=Rt(Tt,e,t,n,i,a),!0;case"mouseover":return Ct=Rt(Ct,e,t,n,i,a),!0;case"pointerover":var r=a.pointerId;return Pt.set(r,Rt(Pt.get(r)||null,e,t,n,i,a)),!0;case"gotpointercapture":return r=a.pointerId,It.set(r,Rt(It.get(r)||null,e,t,n,i,a)),!0}return!1}(a,e,t,n,i))i.stopPropagation();else if(Dt(e,i),4&t&&-1<Mt.indexOf(e)){for(;null!==a;){var r=wa(a);if(null!==r&&bt(r),null===(r=Qt(e,t,n,i))&&Wi(e,t,i,Kt,n),r===a)break;a=r}null!==a&&i.stopPropagation()}else Wi(e,t,i,null,n)}}var Kt=null;function Qt(e,t,n,i){if(Kt=null,null!==(e=va(e=be(i))))if(null===(t=$e(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Be(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Zt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Xe:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var Yt=null,Jt=null,Xt=null;function en(){if(Xt)return Xt;var e,t,n=Jt,i=n.length,a="value"in Yt?Yt.value:Yt.textContent,r=a.length;for(e=0;e<i&&n[e]===a[e];e++);var s=i-e;for(t=1;t<=s&&n[i-t]===a[r-t];t++);return Xt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function an(){return!1}function rn(e){function t(t,n,i,a,r){for(var s in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=r,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:an,this.isPropagationStopped=an,this}return O(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=rn(cn),un=O({},cn,{view:0,detail:0}),hn=rn(un),pn=O({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(sn=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=sn=0,ln=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),mn=rn(pn),fn=rn(O({},pn,{dataTransfer:0})),yn=rn(O({},un,{relatedTarget:0})),gn=rn(O({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=O({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),wn=rn(vn),xn=rn(O({},cn,{data:0})),bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=kn[e])&&!!t[e]}function zn(){return Nn}var _n=O({},un,{key:function(e){if(e.key){var t=bn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?jn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),En=rn(_n),Sn=rn(O({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=rn(O({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zn})),Cn=rn(O({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pn=O({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),In=rn(Pn),An=[9,13,27,32],Mn=d&&"CompositionEvent"in window,Dn=null;d&&"documentMode"in document&&(Dn=document.documentMode);var Rn=d&&"TextEvent"in window&&!Dn,On=d&&(!Mn||Dn&&8<Dn&&11>=Dn),Ln=String.fromCharCode(32),Fn=!1;function Un(e,t){switch(e){case"keyup":return-1!==An.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var $n=!1;var Bn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Bn[e.type]:"textarea"===t}function qn(e,t,n,i){_e(i),0<(t=Hi(t,"onChange")).length&&(n=new dn("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Hn=null,Gn=null;function Kn(e){Li(e,0)}function Qn(e){if(G(xa(e)))return e}function Zn(e,t){if("change"===e)return t}var Yn=!1;if(d){var Jn;if(d){var Xn="oninput"in document;if(!Xn){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),Xn="function"===typeof ei.oninput}Jn=Xn}else Jn=!1;Yn=Jn&&(!document.documentMode||9<document.documentMode)}function ti(){Hn&&(Hn.detachEvent("onpropertychange",ni),Gn=Hn=null)}function ni(e){if("value"===e.propertyName&&Qn(Gn)){var t=[];qn(t,Gn,e,be(e)),Pe(Kn,t)}}function ii(e,t,n){"focusin"===e?(ti(),Gn=n,(Hn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function ai(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Gn)}function ri(e,t){if("click"===e)return Qn(t)}function si(e,t){if("input"===e||"change"===e)return Qn(t)}var oi="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function li(e,t){if(oi(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var a=n[i];if(!u.call(t,a)||!oi(e[a],t[a]))return!1}return!0}function ci(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function di(e,t){var n,i=ci(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ci(i)}}function ui(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ui(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hi(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function pi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mi(e){var t=hi(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ui(n.ownerDocument.documentElement,n)){if(null!==i&&pi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,r=Math.min(i.start,a);i=void 0===i.end?r:Math.min(i.end,a),!e.extend&&r>i&&(a=i,i=r,r=a),a=di(n,r);var s=di(n,i);a&&s&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),r>i?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fi=d&&"documentMode"in document&&11>=document.documentMode,yi=null,gi=null,vi=null,wi=!1;function xi(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;wi||null==yi||yi!==K(i)||("selectionStart"in(i=yi)&&pi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},vi&&li(vi,i)||(vi=i,0<(i=Hi(gi,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=yi)))}function bi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ji={animationend:bi("Animation","AnimationEnd"),animationiteration:bi("Animation","AnimationIteration"),animationstart:bi("Animation","AnimationStart"),transitionend:bi("Transition","TransitionEnd")},ki={},Ni={};function zi(e){if(ki[e])return ki[e];if(!ji[e])return e;var t,n=ji[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ni)return ki[e]=n[t];return e}d&&(Ni=document.createElement("div").style,"AnimationEvent"in window||(delete ji.animationend.animation,delete ji.animationiteration.animation,delete ji.animationstart.animation),"TransitionEvent"in window||delete ji.transitionend.transition);var _i=zi("animationend"),Ei=zi("animationiteration"),Si=zi("animationstart"),Ti=zi("transitionend"),Ci=new Map,Pi="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ii(e,t){Ci.set(e,t),l(t,[e])}for(var Ai=0;Ai<Pi.length;Ai++){var Mi=Pi[Ai];Ii(Mi.toLowerCase(),"on"+(Mi[0].toUpperCase()+Mi.slice(1)))}Ii(_i,"onAnimationEnd"),Ii(Ei,"onAnimationIteration"),Ii(Si,"onAnimationStart"),Ii("dblclick","onDoubleClick"),Ii("focusin","onFocus"),Ii("focusout","onBlur"),Ii(Ti,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Di="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ri=new Set("cancel close invalid load scroll toggle".split(" ").concat(Di));function Oi(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,a,s,o,l,c){if(Ve.apply(this,arguments),Re){if(!Re)throw Error(r(198));var d=Oe;Re=!1,Oe=null,Le||(Le=!0,Fe=d)}}(i,t,void 0,e),e.currentTarget=null}function Li(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],a=i.event;i=i.listeners;e:{var r=void 0;if(t)for(var s=i.length-1;0<=s;s--){var o=i[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==r&&a.isPropagationStopped())break e;Oi(a,o,c),r=l}else for(s=0;s<i.length;s++){if(l=(o=i[s]).instance,c=o.currentTarget,o=o.listener,l!==r&&a.isPropagationStopped())break e;Oi(a,o,c),r=l}}}if(Le)throw e=Fe,Le=!1,Fe=null,e}function Fi(e,t){var n=t[fa];void 0===n&&(n=t[fa]=new Set);var i=e+"__bubble";n.has(i)||(Bi(t,e,2,!1),n.add(i))}function Ui(e,t,n){var i=0;t&&(i|=4),Bi(n,e,i,t)}var Vi="_reactListening"+Math.random().toString(36).slice(2);function $i(e){if(!e[Vi]){e[Vi]=!0,s.forEach((function(t){"selectionchange"!==t&&(Ri.has(t)||Ui(t,!1,e),Ui(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vi]||(t[Vi]=!0,Ui("selectionchange",!1,t))}}function Bi(e,t,n,i){switch(Zt(t)){case 1:var a=qt;break;case 4:a=Ht;break;default:a=Gt}n=a.bind(null,t,n,e),a=void 0,!Ae||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),i?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Wi(e,t,n,i,a){var r=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var s=i.tag;if(3===s||4===s){var o=i.stateNode.containerInfo;if(o===a||8===o.nodeType&&o.parentNode===a)break;if(4===s)for(s=i.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;s=s.return}for(;null!==o;){if(null===(s=va(o)))return;if(5===(l=s.tag)||6===l){i=r=s;continue e}o=o.parentNode}}i=i.return}Pe((function(){var i=r,a=be(n),s=[];e:{var o=Ci.get(e);if(void 0!==o){var l=dn,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=En;break;case"focusin":c="focus",l=yn;break;case"focusout":c="blur",l=yn;break;case"beforeblur":case"afterblur":l=yn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Tn;break;case _i:case Ei:case Si:l=gn;break;case Ti:l=Cn;break;case"scroll":l=hn;break;case"wheel":l=In;break;case"copy":case"cut":case"paste":l=wn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Sn}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==o?o+"Capture":null:o;d=[];for(var p,m=i;null!==m;){var f=(p=m).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==h&&(null!=(f=Ie(m,h))&&d.push(qi(m,f,p)))),u)break;m=m.return}0<d.length&&(o=new l(o,c,null,n,a),s.push({event:o,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!va(c)&&!c[ma])&&(l||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?va(c):null)&&(c!==(u=$e(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(d=mn,f="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=Sn,f="onPointerLeave",h="onPointerEnter",m="pointer"),u=null==l?o:xa(l),p=null==c?o:xa(c),(o=new d(f,m+"leave",l,n,a)).target=u,o.relatedTarget=p,f=null,va(a)===i&&((d=new d(h,m+"enter",c,n,a)).target=p,d.relatedTarget=u,f=d),u=f,l&&c)e:{for(h=c,m=0,p=d=l;p;p=Gi(p))m++;for(p=0,f=h;f;f=Gi(f))p++;for(;0<m-p;)d=Gi(d),m--;for(;0<p-m;)h=Gi(h),p--;for(;m--;){if(d===h||null!==h&&d===h.alternate)break e;d=Gi(d),h=Gi(h)}d=null}else d=null;null!==l&&Ki(s,o,l,d,!1),null!==c&&null!==u&&Ki(s,u,c,d,!0)}if("select"===(l=(o=i?xa(i):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var y=Zn;else if(Wn(o))if(Yn)y=si;else{y=ai;var g=ii}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(y=ri);switch(y&&(y=y(e,i))?qn(s,y,n,a):(g&&g(e,o,i),"focusout"===e&&(g=o._wrapperState)&&g.controlled&&"number"===o.type&&ee(o,"number",o.value)),g=i?xa(i):window,e){case"focusin":(Wn(g)||"true"===g.contentEditable)&&(yi=g,gi=i,vi=null);break;case"focusout":vi=gi=yi=null;break;case"mousedown":wi=!0;break;case"contextmenu":case"mouseup":case"dragend":wi=!1,xi(s,n,a);break;case"selectionchange":if(fi)break;case"keydown":case"keyup":xi(s,n,a)}var v;if(Mn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else $n?Un(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(On&&"ko"!==n.locale&&($n||"onCompositionStart"!==w?"onCompositionEnd"===w&&$n&&(v=en()):(Jt="value"in(Yt=a)?Yt.value:Yt.textContent,$n=!0)),0<(g=Hi(i,w)).length&&(w=new xn(w,e,null,n,a),s.push({event:w,listeners:g}),v?w.data=v:null!==(v=Vn(n))&&(w.data=v))),(v=Rn?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(Fn=!0,Ln);case"textInput":return(e=t.data)===Ln&&Fn?null:e;default:return null}}(e,n):function(e,t){if($n)return"compositionend"===e||!Mn&&Un(e,t)?(e=en(),Xt=Jt=Yt=null,$n=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return On&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=Hi(i,"onBeforeInput")).length&&(a=new xn("onBeforeInput","beforeinput",null,n,a),s.push({event:a,listeners:i}),a.data=v))}Li(s,t)}))}function qi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hi(e,t){for(var n=t+"Capture",i=[];null!==e;){var a=e,r=a.stateNode;5===a.tag&&null!==r&&(a=r,null!=(r=Ie(e,n))&&i.unshift(qi(e,r,a)),null!=(r=Ie(e,t))&&i.push(qi(e,r,a))),e=e.return}return i}function Gi(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Ki(e,t,n,i,a){for(var r=t._reactName,s=[];null!==n&&n!==i;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===i)break;5===o.tag&&null!==c&&(o=c,a?null!=(l=Ie(n,r))&&s.unshift(qi(n,l,o)):a||null!=(l=Ie(n,r))&&s.push(qi(n,l,o))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Qi=/\r\n?/g,Zi=/\u0000|\uFFFD/g;function Yi(e){return("string"===typeof e?e:""+e).replace(Qi,"\n").replace(Zi,"")}function Ji(e,t,n){if(t=Yi(t),Yi(e)!==t&&n)throw Error(r(425))}function Xi(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ia="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ra="function"===typeof Promise?Promise:void 0,sa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ra?function(e){return ra.resolve(null).then(e).catch(oa)}:ia;function oa(e){setTimeout((function(){throw e}))}function la(e,t){var n=t,i=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===i)return e.removeChild(a),void $t(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=a}while(n);$t(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function da(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ua=Math.random().toString(36).slice(2),ha="__reactFiber$"+ua,pa="__reactProps$"+ua,ma="__reactContainer$"+ua,fa="__reactEvents$"+ua,ya="__reactListeners$"+ua,ga="__reactHandles$"+ua;function va(e){var t=e[ha];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ma]||n[ha]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=da(e);null!==e;){if(n=e[ha])return n;e=da(e)}return t}n=(e=n).parentNode}return null}function wa(e){return!(e=e[ha]||e[ma])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(r(33))}function ba(e){return e[pa]||null}var ja=[],ka=-1;function Na(e){return{current:e}}function za(e){0>ka||(e.current=ja[ka],ja[ka]=null,ka--)}function _a(e,t){ka++,ja[ka]=e.current,e.current=t}var Ea={},Sa=Na(Ea),Ta=Na(!1),Ca=Ea;function Pa(e,t){var n=e.type.contextTypes;if(!n)return Ea;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var a,r={};for(a in n)r[a]=t[a];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function Ia(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Aa(){za(Ta),za(Sa)}function Ma(e,t,n){if(Sa.current!==Ea)throw Error(r(168));_a(Sa,t),_a(Ta,n)}function Da(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var a in i=i.getChildContext())if(!(a in t))throw Error(r(108,B(e)||"Unknown",a));return O({},n,i)}function Ra(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ea,Ca=Sa.current,_a(Sa,e),_a(Ta,Ta.current),!0}function Oa(e,t,n){var i=e.stateNode;if(!i)throw Error(r(169));n?(e=Da(e,t,Ca),i.__reactInternalMemoizedMergedChildContext=e,za(Ta),za(Sa),_a(Sa,e)):za(Ta),_a(Ta,n)}var La=null,Fa=!1,Ua=!1;function Va(e){null===La?La=[e]:La.push(e)}function $a(){if(!Ua&&null!==La){Ua=!0;var e=0,t=wt;try{var n=La;for(wt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}La=null,Fa=!1}catch(a){throw null!==La&&(La=La.slice(e+1)),Ge(Xe,$a),a}finally{wt=t,Ua=!1}}return null}var Ba=[],Wa=0,qa=null,Ha=0,Ga=[],Ka=0,Qa=null,Za=1,Ya="";function Ja(e,t){Ba[Wa++]=Ha,Ba[Wa++]=qa,qa=e,Ha=t}function Xa(e,t,n){Ga[Ka++]=Za,Ga[Ka++]=Ya,Ga[Ka++]=Qa,Qa=e;var i=Za;e=Ya;var a=32-st(i)-1;i&=~(1<<a),n+=1;var r=32-st(t)+a;if(30<r){var s=a-a%5;r=(i&(1<<s)-1).toString(32),i>>=s,a-=s,Za=1<<32-st(t)+a|n<<a|i,Ya=r+e}else Za=1<<r|n<<a|i,Ya=e}function er(e){null!==e.return&&(Ja(e,1),Xa(e,1,0))}function tr(e){for(;e===qa;)qa=Ba[--Wa],Ba[Wa]=null,Ha=Ba[--Wa],Ba[Wa]=null;for(;e===Qa;)Qa=Ga[--Ka],Ga[Ka]=null,Ya=Ga[--Ka],Ga[Ka]=null,Za=Ga[--Ka],Ga[Ka]=null}var nr=null,ir=null,ar=!1,rr=null;function sr(e,t){var n=Ic(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function or(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,nr=e,ir=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,nr=e,ir=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qa?{id:Za,overflow:Ya}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ic(18,null,null,0)).stateNode=t,n.return=e,e.child=n,nr=e,ir=null,!0);default:return!1}}function lr(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cr(e){if(ar){var t=ir;if(t){var n=t;if(!or(e,t)){if(lr(e))throw Error(r(418));t=ca(n.nextSibling);var i=nr;t&&or(e,t)?sr(i,n):(e.flags=-4097&e.flags|2,ar=!1,nr=e)}}else{if(lr(e))throw Error(r(418));e.flags=-4097&e.flags|2,ar=!1,nr=e}}}function dr(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;nr=e}function ur(e){if(e!==nr)return!1;if(!ar)return dr(e),ar=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ir)){if(lr(e))throw hr(),Error(r(418));for(;t;)sr(e,t),t=ca(t.nextSibling)}if(dr(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ir=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ir=null}}else ir=nr?ca(e.stateNode.nextSibling):null;return!0}function hr(){for(var e=ir;e;)e=ca(e.nextSibling)}function pr(){ir=nr=null,ar=!1}function mr(e){null===rr?rr=[e]:rr.push(e)}var fr=x.ReactCurrentBatchConfig;function yr(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(r(309));var i=n.stateNode}if(!i)throw Error(r(147,e));var a=i,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=a.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(r(284));if(!n._owner)throw Error(r(290,e))}return e}function gr(e,t){throw e=Object.prototype.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vr(e){return(0,e._init)(e._payload)}function wr(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Mc(e,t)).index=0,e.sibling=null,e}function s(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=Lc(n,e.mode,i)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,i){var r=n.type;return r===k?u(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===r||"object"===typeof r&&null!==r&&r.$$typeof===I&&vr(r)===t.type)?((i=a(t,n.props)).ref=yr(e,t,n),i.return=e,i):((i=Dc(n.type,n.key,n.props,null,e.mode,i)).ref=yr(e,t,n),i.return=e,i)}function d(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,i)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function u(e,t,n,i,r){return null===t||7!==t.tag?((t=Rc(n,e.mode,i,r)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case b:return(n=Dc(t.type,t.key,t.props,null,e.mode,n)).ref=yr(e,null,t),n.return=e,n;case j:return(t=Fc(t,e.mode,n)).return=e,t;case I:return h(e,(0,t._init)(t._payload),n)}if(te(t)||D(t))return(t=Rc(t,e.mode,n,null)).return=e,t;gr(e,t)}return null}function p(e,t,n,i){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:l(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===a?c(e,t,n,i):null;case j:return n.key===a?d(e,t,n,i):null;case I:return p(e,t,(a=n._init)(n._payload),i)}if(te(n)||D(n))return null!==a?null:u(e,t,n,i,null);gr(e,n)}return null}function m(e,t,n,i,a){if("string"===typeof i&&""!==i||"number"===typeof i)return l(t,e=e.get(n)||null,""+i,a);if("object"===typeof i&&null!==i){switch(i.$$typeof){case b:return c(t,e=e.get(null===i.key?n:i.key)||null,i,a);case j:return d(t,e=e.get(null===i.key?n:i.key)||null,i,a);case I:return m(e,t,n,(0,i._init)(i._payload),a)}if(te(i)||D(i))return u(t,e=e.get(n)||null,i,a,null);gr(t,i)}return null}function f(a,r,o,l){for(var c=null,d=null,u=r,f=r=0,y=null;null!==u&&f<o.length;f++){u.index>f?(y=u,u=null):y=u.sibling;var g=p(a,u,o[f],l);if(null===g){null===u&&(u=y);break}e&&u&&null===g.alternate&&t(a,u),r=s(g,r,f),null===d?c=g:d.sibling=g,d=g,u=y}if(f===o.length)return n(a,u),ar&&Ja(a,f),c;if(null===u){for(;f<o.length;f++)null!==(u=h(a,o[f],l))&&(r=s(u,r,f),null===d?c=u:d.sibling=u,d=u);return ar&&Ja(a,f),c}for(u=i(a,u);f<o.length;f++)null!==(y=m(u,a,f,o[f],l))&&(e&&null!==y.alternate&&u.delete(null===y.key?f:y.key),r=s(y,r,f),null===d?c=y:d.sibling=y,d=y);return e&&u.forEach((function(e){return t(a,e)})),ar&&Ja(a,f),c}function y(a,o,l,c){var d=D(l);if("function"!==typeof d)throw Error(r(150));if(null==(l=d.call(l)))throw Error(r(151));for(var u=d=null,f=o,y=o=0,g=null,v=l.next();null!==f&&!v.done;y++,v=l.next()){f.index>y?(g=f,f=null):g=f.sibling;var w=p(a,f,v.value,c);if(null===w){null===f&&(f=g);break}e&&f&&null===w.alternate&&t(a,f),o=s(w,o,y),null===u?d=w:u.sibling=w,u=w,f=g}if(v.done)return n(a,f),ar&&Ja(a,y),d;if(null===f){for(;!v.done;y++,v=l.next())null!==(v=h(a,v.value,c))&&(o=s(v,o,y),null===u?d=v:u.sibling=v,u=v);return ar&&Ja(a,y),d}for(f=i(a,f);!v.done;y++,v=l.next())null!==(v=m(f,a,y,v.value,c))&&(e&&null!==v.alternate&&f.delete(null===v.key?y:v.key),o=s(v,o,y),null===u?d=v:u.sibling=v,u=v);return e&&f.forEach((function(e){return t(a,e)})),ar&&Ja(a,y),d}return function e(i,r,s,l){if("object"===typeof s&&null!==s&&s.type===k&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case b:e:{for(var c=s.key,d=r;null!==d;){if(d.key===c){if((c=s.type)===k){if(7===d.tag){n(i,d.sibling),(r=a(d,s.props.children)).return=i,i=r;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===I&&vr(c)===d.type){n(i,d.sibling),(r=a(d,s.props)).ref=yr(i,d,s),r.return=i,i=r;break e}n(i,d);break}t(i,d),d=d.sibling}s.type===k?((r=Rc(s.props.children,i.mode,l,s.key)).return=i,i=r):((l=Dc(s.type,s.key,s.props,null,i.mode,l)).ref=yr(i,r,s),l.return=i,i=l)}return o(i);case j:e:{for(d=s.key;null!==r;){if(r.key===d){if(4===r.tag&&r.stateNode.containerInfo===s.containerInfo&&r.stateNode.implementation===s.implementation){n(i,r.sibling),(r=a(r,s.children||[])).return=i,i=r;break e}n(i,r);break}t(i,r),r=r.sibling}(r=Fc(s,i.mode,l)).return=i,i=r}return o(i);case I:return e(i,r,(d=s._init)(s._payload),l)}if(te(s))return f(i,r,s,l);if(D(s))return y(i,r,s,l);gr(i,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==r&&6===r.tag?(n(i,r.sibling),(r=a(r,s)).return=i,i=r):(n(i,r),(r=Lc(s,i.mode,l)).return=i,i=r),o(i)):n(i,r)}}var xr=wr(!0),br=wr(!1),jr=Na(null),Nr=null,zr=null,_r=null;function Er(){_r=zr=Nr=null}function Sr(e){var t=jr.current;za(jr),e._currentValue=t}function Tr(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Cr(e,t){Nr=e,_r=zr=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xo=!0),e.firstContext=null)}function Pr(e){var t=e._currentValue;if(_r!==e)if(e={context:e,memoizedValue:t,next:null},null===zr){if(null===Nr)throw Error(r(308));zr=e,Nr.dependencies={lanes:0,firstContext:e}}else zr=zr.next=e;return t}var Ir=null;function Ar(e){null===Ir?Ir=[e]:Ir.push(e)}function Mr(e,t,n,i){var a=t.interleaved;return null===a?(n.next=n,Ar(t)):(n.next=a.next,a.next=n),t.interleaved=n,Dr(e,i)}function Dr(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Rr=!1;function Or(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Lr(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ur(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Tl)){var a=i.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),i.pending=t,Dr(e,n)}return null===(a=i.interleaved)?(t.next=t,Ar(i)):(t.next=a.next,a.next=t),i.interleaved=t,Dr(e,n)}function Vr(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,vt(e,n)}}function $r(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var a=null,r=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===r?a=r=s:r=r.next=s,n=n.next}while(null!==n);null===r?a=r=t:r=r.next=t}else a=r=t;return n={baseState:i.baseState,firstBaseUpdate:a,lastBaseUpdate:r,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Br(e,t,n,i){var a=e.updateQueue;Rr=!1;var r=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?r=c:s.next=c,s=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==s&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==r){var u=a.baseState;for(s=0,d=c=l=null,o=r;;){var h=o.lane,p=o.eventTime;if((i&h)===h){null!==d&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,f=o;switch(h=t,p=n,f.tag){case 1:if("function"===typeof(m=f.payload)){u=m.call(p,u,h);break e}u=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(h="function"===typeof(m=f.payload)?m.call(p,u,h):m)||void 0===h)break e;u=O({},u,h);break e;case 2:Rr=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=p,l=u):d=d.next=p,s|=h;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(h=o).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===d&&(l=u),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=d,null!==(t=a.shared.interleaved)){a=t;do{s|=a.lane,a=a.next}while(a!==t)}else null===r&&(a.shared.lanes=0);Ol|=s,e.lanes=s,e.memoizedState=u}}function Wr(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],a=i.callback;if(null!==a){if(i.callback=null,i=n,"function"!==typeof a)throw Error(r(191,a));a.call(i)}}}var qr={},Hr=Na(qr),Gr=Na(qr),Kr=Na(qr);function Qr(e){if(e===qr)throw Error(r(174));return e}function Zr(e,t){switch(_a(Kr,t),_a(Gr,e),_a(Hr,qr),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}za(Hr),_a(Hr,t)}function Yr(){za(Hr),za(Gr),za(Kr)}function Jr(e){Qr(Kr.current);var t=Qr(Hr.current),n=le(t,e.type);t!==n&&(_a(Gr,e),_a(Hr,n))}function Xr(e){Gr.current===e&&(za(Hr),za(Gr))}var es=Na(0);function ts(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ns=[];function is(){for(var e=0;e<ns.length;e++)ns[e]._workInProgressVersionPrimary=null;ns.length=0}var as=x.ReactCurrentDispatcher,rs=x.ReactCurrentBatchConfig,ss=0,os=null,ls=null,cs=null,ds=!1,us=!1,hs=0,ps=0;function ms(){throw Error(r(321))}function fs(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!oi(e[n],t[n]))return!1;return!0}function ys(e,t,n,i,a,s){if(ss=s,os=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,as.current=null===e||null===e.memoizedState?Xs:eo,e=n(i,a),us){s=0;do{if(us=!1,hs=0,25<=s)throw Error(r(301));s+=1,cs=ls=null,t.updateQueue=null,as.current=to,e=n(i,a)}while(us)}if(as.current=Js,t=null!==ls&&null!==ls.next,ss=0,cs=ls=os=null,ds=!1,t)throw Error(r(300));return e}function gs(){var e=0!==hs;return hs=0,e}function vs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===cs?os.memoizedState=cs=e:cs=cs.next=e,cs}function ws(){if(null===ls){var e=os.alternate;e=null!==e?e.memoizedState:null}else e=ls.next;var t=null===cs?os.memoizedState:cs.next;if(null!==t)cs=t,ls=e;else{if(null===e)throw Error(r(310));e={memoizedState:(ls=e).memoizedState,baseState:ls.baseState,baseQueue:ls.baseQueue,queue:ls.queue,next:null},null===cs?os.memoizedState=cs=e:cs=cs.next=e}return cs}function xs(e,t){return"function"===typeof t?t(e):t}function bs(e){var t=ws(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var i=ls,a=i.baseQueue,s=n.pending;if(null!==s){if(null!==a){var o=a.next;a.next=s.next,s.next=o}i.baseQueue=a=s,n.pending=null}if(null!==a){s=a.next,i=i.baseState;var l=o=null,c=null,d=s;do{var u=d.lane;if((ss&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),i=d.hasEagerState?d.eagerState:e(i,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,o=i):c=c.next=h,os.lanes|=u,Ol|=u}d=d.next}while(null!==d&&d!==s);null===c?o=i:c.next=l,oi(i,t.memoizedState)||(xo=!0),t.memoizedState=i,t.baseState=o,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){a=e;do{s=a.lane,os.lanes|=s,Ol|=s,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function js(e){var t=ws(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var i=n.dispatch,a=n.pending,s=t.memoizedState;if(null!==a){n.pending=null;var o=a=a.next;do{s=e(s,o.action),o=o.next}while(o!==a);oi(s,t.memoizedState)||(xo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,i]}function ks(){}function Ns(e,t){var n=os,i=ws(),a=t(),s=!oi(i.memoizedState,a);if(s&&(i.memoizedState=a,xo=!0),i=i.queue,Rs(Es.bind(null,n,i,e),[e]),i.getSnapshot!==t||s||null!==cs&&1&cs.memoizedState.tag){if(n.flags|=2048,Ps(9,_s.bind(null,n,i,a,t),void 0,null),null===Cl)throw Error(r(349));0!==(30&ss)||zs(n,t,a)}return a}function zs(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=os.updateQueue)?(t={lastEffect:null,stores:null},os.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function _s(e,t,n,i){t.value=n,t.getSnapshot=i,Ss(t)&&Ts(e)}function Es(e,t,n){return n((function(){Ss(t)&&Ts(e)}))}function Ss(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!oi(e,n)}catch(i){return!0}}function Ts(e){var t=Dr(e,1);null!==t&&ic(t,e,1,-1)}function Cs(e){var t=vs();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:e},t.queue=e,e=e.dispatch=Ks.bind(null,os,e),[t.memoizedState,e]}function Ps(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=os.updateQueue)?(t={lastEffect:null,stores:null},os.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Is(){return ws().memoizedState}function As(e,t,n,i){var a=vs();os.flags|=e,a.memoizedState=Ps(1|t,n,void 0,void 0===i?null:i)}function Ms(e,t,n,i){var a=ws();i=void 0===i?null:i;var r=void 0;if(null!==ls){var s=ls.memoizedState;if(r=s.destroy,null!==i&&fs(i,s.deps))return void(a.memoizedState=Ps(t,n,r,i))}os.flags|=e,a.memoizedState=Ps(1|t,n,r,i)}function Ds(e,t){return As(8390656,8,e,t)}function Rs(e,t){return Ms(2048,8,e,t)}function Os(e,t){return Ms(4,2,e,t)}function Ls(e,t){return Ms(4,4,e,t)}function Fs(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Us(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ms(4,4,Fs.bind(null,t,e),n)}function Vs(){}function $s(e,t){var n=ws();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&fs(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Bs(e,t){var n=ws();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&fs(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Ws(e,t,n){return 0===(21&ss)?(e.baseState&&(e.baseState=!1,xo=!0),e.memoizedState=n):(oi(n,t)||(n=ft(),os.lanes|=n,Ol|=n,e.baseState=!0),t)}function qs(e,t){var n=wt;wt=0!==n&&4>n?n:4,e(!0);var i=rs.transition;rs.transition={};try{e(!1),t()}finally{wt=n,rs.transition=i}}function Hs(){return ws().memoizedState}function Gs(e,t,n){var i=nc(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Qs(e))Zs(t,n);else if(null!==(n=Mr(e,t,n,i))){ic(n,e,i,tc()),Ys(n,t,i)}}function Ks(e,t,n){var i=nc(e),a={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qs(e))Zs(t,a);else{var r=e.alternate;if(0===e.lanes&&(null===r||0===r.lanes)&&null!==(r=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=r(s,n);if(a.hasEagerState=!0,a.eagerState=o,oi(o,s)){var l=t.interleaved;return null===l?(a.next=a,Ar(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Mr(e,t,a,i))&&(ic(n,e,i,a=tc()),Ys(n,t,i))}}function Qs(e){var t=e.alternate;return e===os||null!==t&&t===os}function Zs(e,t){us=ds=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ys(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Js={readContext:Pr,useCallback:ms,useContext:ms,useEffect:ms,useImperativeHandle:ms,useInsertionEffect:ms,useLayoutEffect:ms,useMemo:ms,useReducer:ms,useRef:ms,useState:ms,useDebugValue:ms,useDeferredValue:ms,useTransition:ms,useMutableSource:ms,useSyncExternalStore:ms,useId:ms,unstable_isNewReconciler:!1},Xs={readContext:Pr,useCallback:function(e,t){return vs().memoizedState=[e,void 0===t?null:t],e},useContext:Pr,useEffect:Ds,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,As(4194308,4,Fs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return As(4194308,4,e,t)},useInsertionEffect:function(e,t){return As(4,2,e,t)},useMemo:function(e,t){var n=vs();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=vs();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=Gs.bind(null,os,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},vs().memoizedState=e},useState:Cs,useDebugValue:Vs,useDeferredValue:function(e){return vs().memoizedState=e},useTransition:function(){var e=Cs(!1),t=e[0];return e=qs.bind(null,e[1]),vs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=os,a=vs();if(ar){if(void 0===n)throw Error(r(407));n=n()}else{if(n=t(),null===Cl)throw Error(r(349));0!==(30&ss)||zs(i,t,n)}a.memoizedState=n;var s={value:n,getSnapshot:t};return a.queue=s,Ds(Es.bind(null,i,s,e),[e]),i.flags|=2048,Ps(9,_s.bind(null,i,s,n,t),void 0,null),n},useId:function(){var e=vs(),t=Cl.identifierPrefix;if(ar){var n=Ya;t=":"+t+"R"+(n=(Za&~(1<<32-st(Za)-1)).toString(32)+n),0<(n=hs++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ps++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},eo={readContext:Pr,useCallback:$s,useContext:Pr,useEffect:Rs,useImperativeHandle:Us,useInsertionEffect:Os,useLayoutEffect:Ls,useMemo:Bs,useReducer:bs,useRef:Is,useState:function(){return bs(xs)},useDebugValue:Vs,useDeferredValue:function(e){return Ws(ws(),ls.memoizedState,e)},useTransition:function(){return[bs(xs)[0],ws().memoizedState]},useMutableSource:ks,useSyncExternalStore:Ns,useId:Hs,unstable_isNewReconciler:!1},to={readContext:Pr,useCallback:$s,useContext:Pr,useEffect:Rs,useImperativeHandle:Us,useInsertionEffect:Os,useLayoutEffect:Ls,useMemo:Bs,useReducer:js,useRef:Is,useState:function(){return js(xs)},useDebugValue:Vs,useDeferredValue:function(e){var t=ws();return null===ls?t.memoizedState=e:Ws(t,ls.memoizedState,e)},useTransition:function(){return[js(xs)[0],ws().memoizedState]},useMutableSource:ks,useSyncExternalStore:Ns,useId:Hs,unstable_isNewReconciler:!1};function no(e,t){if(e&&e.defaultProps){for(var n in t=O({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function io(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:O({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ao={isMounted:function(e){return!!(e=e._reactInternals)&&$e(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=tc(),a=nc(e),r=Fr(i,a);r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=Ur(e,r,a))&&(ic(t,e,a,i),Vr(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=tc(),a=nc(e),r=Fr(i,a);r.tag=1,r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=Ur(e,r,a))&&(ic(t,e,a,i),Vr(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),i=nc(e),a=Fr(n,i);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Ur(e,a,i))&&(ic(t,e,i,n),Vr(t,e,i))}};function ro(e,t,n,i,a,r,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,r,s):!t.prototype||!t.prototype.isPureReactComponent||(!li(n,i)||!li(a,r))}function so(e,t,n){var i=!1,a=Ea,r=t.contextType;return"object"===typeof r&&null!==r?r=Pr(r):(a=Ia(t)?Ca:Sa.current,r=(i=null!==(i=t.contextTypes)&&void 0!==i)?Pa(e,a):Ea),t=new t(n,r),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ao,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=r),t}function oo(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&ao.enqueueReplaceState(t,t.state,null)}function lo(e,t,n,i){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Or(e);var r=t.contextType;"object"===typeof r&&null!==r?a.context=Pr(r):(r=Ia(t)?Ca:Sa.current,a.context=Pa(e,r)),a.state=e.memoizedState,"function"===typeof(r=t.getDerivedStateFromProps)&&(io(e,t,r,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&ao.enqueueReplaceState(a,a.state,null),Br(e,n,a,i),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function co(e,t){try{var n="",i=t;do{n+=V(i),i=i.return}while(i);var a=n}catch(r){a="\nError generating stack: "+r.message+"\n"+r.stack}return{value:e,source:t,stack:a,digest:null}}function uo(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ho(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var po="function"===typeof WeakMap?WeakMap:Map;function mo(e,t,n){(n=Fr(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){ql||(ql=!0,Hl=i),ho(0,t)},n}function fo(e,t,n){(n=Fr(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var a=t.value;n.payload=function(){return i(a)},n.callback=function(){ho(0,t)}}var r=e.stateNode;return null!==r&&"function"===typeof r.componentDidCatch&&(n.callback=function(){ho(0,t),"function"!==typeof i&&(null===Gl?Gl=new Set([this]):Gl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function yo(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new po;var a=new Set;i.set(t,a)}else void 0===(a=i.get(t))&&(a=new Set,i.set(t,a));a.has(n)||(a.add(n),e=_c.bind(null,e,t,n),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vo(e,t,n,i,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fr(-1,1)).tag=2,Ur(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var wo=x.ReactCurrentOwner,xo=!1;function bo(e,t,n,i){t.child=null===e?br(t,null,n,i):xr(t,e.child,n,i)}function jo(e,t,n,i,a){n=n.render;var r=t.ref;return Cr(t,a),i=ys(e,t,n,i,r,a),n=gs(),null===e||xo?(ar&&n&&er(t),t.flags|=1,bo(e,t,i,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,qo(e,t,a))}function ko(e,t,n,i,a){if(null===e){var r=n.type;return"function"!==typeof r||Ac(r)||void 0!==r.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Dc(n.type,null,i,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=r,No(e,t,r,i,a))}if(r=e.child,0===(e.lanes&a)){var s=r.memoizedProps;if((n=null!==(n=n.compare)?n:li)(s,i)&&e.ref===t.ref)return qo(e,t,a)}return t.flags|=1,(e=Mc(r,i)).ref=t.ref,e.return=t,t.child=e}function No(e,t,n,i,a){if(null!==e){var r=e.memoizedProps;if(li(r,i)&&e.ref===t.ref){if(xo=!1,t.pendingProps=i=r,0===(e.lanes&a))return t.lanes=e.lanes,qo(e,t,a);0!==(131072&e.flags)&&(xo=!0)}}return Eo(e,t,n,i,a)}function zo(e,t,n){var i=t.pendingProps,a=i.children,r=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},_a(Ml,Al),Al|=n;else{if(0===(1073741824&n))return e=null!==r?r.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,_a(Ml,Al),Al|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==r?r.baseLanes:n,_a(Ml,Al),Al|=i}else null!==r?(i=r.baseLanes|n,t.memoizedState=null):i=n,_a(Ml,Al),Al|=i;return bo(e,t,a,n),t.child}function _o(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Eo(e,t,n,i,a){var r=Ia(n)?Ca:Sa.current;return r=Pa(t,r),Cr(t,a),n=ys(e,t,n,i,r,a),i=gs(),null===e||xo?(ar&&i&&er(t),t.flags|=1,bo(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,qo(e,t,a))}function So(e,t,n,i,a){if(Ia(n)){var r=!0;Ra(t)}else r=!1;if(Cr(t,a),null===t.stateNode)Wo(e,t),so(t,n,i),lo(t,n,i,a),i=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=n.contextType;"object"===typeof c&&null!==c?c=Pr(c):c=Pa(t,c=Ia(n)?Ca:Sa.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof s.getSnapshotBeforeUpdate;u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==i||l!==c)&&oo(t,s,i,c),Rr=!1;var h=t.memoizedState;s.state=h,Br(t,i,s,a),l=t.memoizedState,o!==i||h!==l||Ta.current||Rr?("function"===typeof d&&(io(t,n,d,i),l=t.memoizedState),(o=Rr||ro(t,n,o,i,h,l,c))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),s.props=i,s.state=l,s.context=c,i=o):("function"===typeof s.componentDidMount&&(t.flags|=4194308),i=!1)}else{s=t.stateNode,Lr(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:no(t.type,o),s.props=c,u=t.pendingProps,h=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=Pr(l):l=Pa(t,l=Ia(n)?Ca:Sa.current);var p=n.getDerivedStateFromProps;(d="function"===typeof p||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==u||h!==l)&&oo(t,s,i,l),Rr=!1,h=t.memoizedState,s.state=h,Br(t,i,s,a);var m=t.memoizedState;o!==u||h!==m||Ta.current||Rr?("function"===typeof p&&(io(t,n,p,i),m=t.memoizedState),(c=Rr||ro(t,n,c,i,h,m,l)||!1)?(d||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(i,m,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(i,m,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=m),s.props=i,s.state=m,s.context=l,i=c):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return To(e,t,n,i,r,a)}function To(e,t,n,i,a,r){_o(e,t);var s=0!==(128&t.flags);if(!i&&!s)return a&&Oa(t,n,!1),qo(e,t,r);i=t.stateNode,wo.current=t;var o=s&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&s?(t.child=xr(t,e.child,null,r),t.child=xr(t,null,o,r)):bo(e,t,o,r),t.memoizedState=i.state,a&&Oa(t,n,!0),t.child}function Co(e){var t=e.stateNode;t.pendingContext?Ma(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ma(0,t.context,!1),Zr(e,t.containerInfo)}function Po(e,t,n,i,a){return pr(),mr(a),t.flags|=256,bo(e,t,n,i),t.child}var Io,Ao,Mo,Do,Ro={dehydrated:null,treeContext:null,retryLane:0};function Oo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Lo(e,t,n){var i,a=t.pendingProps,s=es.current,o=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&s)),i?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),_a(es,1&s),null===e)return cr(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=a.children,e=a.fallback,o?(a=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&a)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Oc(l,a,0,null),e=Rc(e,a,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Oo(n),t.memoizedState=Ro,e):Fo(t,l));if(null!==(s=e.memoizedState)&&null!==(i=s.dehydrated))return function(e,t,n,i,a,s,o){if(n)return 256&t.flags?(t.flags&=-257,Uo(e,t,o,i=uo(Error(r(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=i.fallback,a=t.mode,i=Oc({mode:"visible",children:i.children},a,0,null),(s=Rc(s,a,o,null)).flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,0!==(1&t.mode)&&xr(t,e.child,null,o),t.child.memoizedState=Oo(o),t.memoizedState=Ro,s);if(0===(1&t.mode))return Uo(e,t,o,null);if("$!"===a.data){if(i=a.nextSibling&&a.nextSibling.dataset)var l=i.dgst;return i=l,Uo(e,t,o,i=uo(s=Error(r(419)),i,void 0))}if(l=0!==(o&e.childLanes),xo||l){if(null!==(i=Cl)){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(i.suspendedLanes|o))?0:a)&&a!==s.retryLane&&(s.retryLane=a,Dr(e,a),ic(i,e,a,-1))}return yc(),Uo(e,t,o,i=uo(Error(r(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Sc.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,ir=ca(a.nextSibling),nr=t,ar=!0,rr=null,null!==e&&(Ga[Ka++]=Za,Ga[Ka++]=Ya,Ga[Ka++]=Qa,Za=e.id,Ya=e.overflow,Qa=t),t=Fo(t,i.children),t.flags|=4096,t)}(e,t,l,a,i,s,n);if(o){o=a.fallback,l=t.mode,i=(s=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&l)&&t.child!==s?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Mc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==i?o=Mc(i,o):(o=Rc(o,l,n,null)).flags|=2,o.return=t,a.return=t,a.sibling=o,t.child=a,a=o,o=t.child,l=null===(l=e.child.memoizedState)?Oo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Ro,a}return e=(o=e.child).sibling,a=Mc(o,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Fo(e,t){return(t=Oc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Uo(e,t,n,i){return null!==i&&mr(i),xr(t,e.child,null,n),(e=Fo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Vo(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Tr(e.return,t,n)}function $o(e,t,n,i,a){var r=e.memoizedState;null===r?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:a}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=i,r.tail=n,r.tailMode=a)}function Bo(e,t,n){var i=t.pendingProps,a=i.revealOrder,r=i.tail;if(bo(e,t,i.children,n),0!==(2&(i=es.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Vo(e,n,t);else if(19===e.tag)Vo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(_a(es,i),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===ts(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),$o(t,!1,a,n,r);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===ts(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}$o(t,!0,n,null,r);break;case"together":$o(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ol|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(n=Mc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Mc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ho(e,t){if(!ar)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Go(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,i|=14680064&a.subtreeFlags,i|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,i|=a.subtreeFlags,i|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Ko(e,t,n){var i=t.pendingProps;switch(tr(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Go(t),null;case 1:case 17:return Ia(t.type)&&Aa(),Go(t),null;case 3:return i=t.stateNode,Yr(),za(Ta),za(Sa),is(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(ur(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==rr&&(oc(rr),rr=null))),Ao(e,t),Go(t),null;case 5:Xr(t);var a=Qr(Kr.current);if(n=t.type,null!==e&&null!=t.stateNode)Mo(e,t,n,i,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(r(166));return Go(t),null}if(e=Qr(Hr.current),ur(t)){i=t.stateNode,n=t.type;var s=t.memoizedProps;switch(i[ha]=t,i[pa]=s,e=0!==(1&t.mode),n){case"dialog":Fi("cancel",i),Fi("close",i);break;case"iframe":case"object":case"embed":Fi("load",i);break;case"video":case"audio":for(a=0;a<Di.length;a++)Fi(Di[a],i);break;case"source":Fi("error",i);break;case"img":case"image":case"link":Fi("error",i),Fi("load",i);break;case"details":Fi("toggle",i);break;case"input":Z(i,s),Fi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Fi("invalid",i);break;case"textarea":ae(i,s),Fi("invalid",i)}for(var l in ve(n,s),a=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==s.suppressHydrationWarning&&Ji(i.textContent,c,e),a=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&Ji(i.textContent,c,e),a=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Fi("scroll",i)}switch(n){case"input":H(i),X(i,s,!0);break;case"textarea":H(i),se(i);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(i.onclick=Xi)}i=a,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[ha]=t,e[pa]=i,Io(e,t,!1,!1),t.stateNode=e;e:{switch(l=we(n,i),n){case"dialog":Fi("cancel",e),Fi("close",e),a=i;break;case"iframe":case"object":case"embed":Fi("load",e),a=i;break;case"video":case"audio":for(a=0;a<Di.length;a++)Fi(Di[a],e);a=i;break;case"source":Fi("error",e),a=i;break;case"img":case"image":case"link":Fi("error",e),Fi("load",e),a=i;break;case"details":Fi("toggle",e),a=i;break;case"input":Z(e,i),a=Q(e,i),Fi("invalid",e);break;case"option":default:a=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},a=O({},i,{value:void 0}),Fi("invalid",e);break;case"textarea":ae(e,i),a=ie(e,i),Fi("invalid",e)}for(s in ve(n,a),c=a)if(c.hasOwnProperty(s)){var d=c[s];"style"===s?ye(e,d):"dangerouslySetInnerHTML"===s?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===s?"string"===typeof d?("textarea"!==n||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=d&&"onScroll"===s&&Fi("scroll",e):null!=d&&w(e,s,d,l))}switch(n){case"input":H(e),X(e,i,!1);break;case"textarea":H(e),se(e);break;case"option":null!=i.value&&e.setAttribute("value",""+W(i.value));break;case"select":e.multiple=!!i.multiple,null!=(s=i.value)?ne(e,!!i.multiple,s,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Xi)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Go(t),null;case 6:if(e&&null!=t.stateNode)Do(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(r(166));if(n=Qr(Kr.current),Qr(Hr.current),ur(t)){if(i=t.stateNode,n=t.memoizedProps,i[ha]=t,(s=i.nodeValue!==n)&&null!==(e=nr))switch(e.tag){case 3:Ji(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Ji(i.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[ha]=t,t.stateNode=i}return Go(t),null;case 13:if(za(es),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ar&&null!==ir&&0!==(1&t.mode)&&0===(128&t.flags))hr(),pr(),t.flags|=98560,s=!1;else if(s=ur(t),null!==i&&null!==i.dehydrated){if(null===e){if(!s)throw Error(r(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(r(317));s[ha]=t}else pr(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Go(t),s=!1}else null!==rr&&(oc(rr),rr=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&es.current)?0===Dl&&(Dl=3):yc())),null!==t.updateQueue&&(t.flags|=4),Go(t),null);case 4:return Yr(),Ao(e,t),null===e&&$i(t.stateNode.containerInfo),Go(t),null;case 10:return Sr(t.type._context),Go(t),null;case 19:if(za(es),null===(s=t.memoizedState))return Go(t),null;if(i=0!==(128&t.flags),null===(l=s.rendering))if(i)Ho(s,!1);else{if(0!==Dl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ts(e))){for(t.flags|=128,Ho(s,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return _a(es,1&es.current|2),t.child}e=e.sibling}null!==s.tail&&Ye()>Bl&&(t.flags|=128,i=!0,Ho(s,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=ts(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ho(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ar)return Go(t),null}else 2*Ye()-s.renderingStartTime>Bl&&1073741824!==n&&(t.flags|=128,i=!0,Ho(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=s.last)?n.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ye(),t.sibling=null,n=es.current,_a(es,i?1&n|2:1&n),t):(Go(t),null);case 22:case 23:return hc(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Al)&&(Go(t),6&t.subtreeFlags&&(t.flags|=8192)):Go(t),null;case 24:case 25:return null}throw Error(r(156,t.tag))}function Qo(e,t){switch(tr(t),t.tag){case 1:return Ia(t.type)&&Aa(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Yr(),za(Ta),za(Sa),is(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xr(t),null;case 13:if(za(es),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));pr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return za(es),null;case 4:return Yr(),null;case 10:return Sr(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Io=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ao=function(){},Mo=function(e,t,n,i){var a=e.memoizedProps;if(a!==i){e=t.stateNode,Qr(Hr.current);var r,s=null;switch(n){case"input":a=Q(e,a),i=Q(e,i),s=[];break;case"select":a=O({},a,{value:void 0}),i=O({},i,{value:void 0}),s=[];break;case"textarea":a=ie(e,a),i=ie(e,i),s=[];break;default:"function"!==typeof a.onClick&&"function"===typeof i.onClick&&(e.onclick=Xi)}for(d in ve(n,i),n=null,a)if(!i.hasOwnProperty(d)&&a.hasOwnProperty(d)&&null!=a[d])if("style"===d){var l=a[d];for(r in l)l.hasOwnProperty(r)&&(n||(n={}),n[r]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(o.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in i){var c=i[d];if(l=null!=a?a[d]:void 0,i.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(r in l)!l.hasOwnProperty(r)||c&&c.hasOwnProperty(r)||(n||(n={}),n[r]="");for(r in c)c.hasOwnProperty(r)&&l[r]!==c[r]&&(n||(n={}),n[r]=c[r])}else n||(s||(s=[]),s.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(o.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Fi("scroll",e),s||l===c||(s=[])):(s=s||[]).push(d,c))}n&&(s=s||[]).push("style",n);var d=s;(t.updateQueue=d)&&(t.flags|=4)}},Do=function(e,t,n,i){n!==i&&(t.flags|=4)};var Zo=!1,Yo=!1,Jo="function"===typeof WeakSet?WeakSet:Set,Xo=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){zc(e,t,i)}else n.current=null}function tl(e,t,n){try{n()}catch(i){zc(e,t,i)}}var nl=!1;function il(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var a=i=i.next;do{if((a.tag&e)===e){var r=a.destroy;a.destroy=void 0,void 0!==r&&tl(t,n,r)}a=a.next}while(a!==i)}}function al(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function rl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[pa],delete t[fa],delete t[ya],delete t[ga])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Xi));else if(4!==i&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function dl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(dl(e,t,n),e=e.sibling;null!==e;)dl(e,t,n),e=e.sibling}var ul=null,hl=!1;function pl(e,t,n){for(n=n.child;null!==n;)ml(e,t,n),n=n.sibling}function ml(e,t,n){if(rt&&"function"===typeof rt.onCommitFiberUnmount)try{rt.onCommitFiberUnmount(at,n)}catch(o){}switch(n.tag){case 5:Yo||el(n,t);case 6:var i=ul,a=hl;ul=null,pl(e,t,n),hl=a,null!==(ul=i)&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?la(e.parentNode,n):1===e.nodeType&&la(e,n),$t(e)):la(ul,n.stateNode));break;case 4:i=ul,a=hl,ul=n.stateNode.containerInfo,hl=!0,pl(e,t,n),ul=i,hl=a;break;case 0:case 11:case 14:case 15:if(!Yo&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){a=i=i.next;do{var r=a,s=r.destroy;r=r.tag,void 0!==s&&(0!==(2&r)||0!==(4&r))&&tl(n,t,s),a=a.next}while(a!==i)}pl(e,t,n);break;case 1:if(!Yo&&(el(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(o){zc(n,t,o)}pl(e,t,n);break;case 21:pl(e,t,n);break;case 22:1&n.mode?(Yo=(i=Yo)||null!==n.memoizedState,pl(e,t,n),Yo=i):pl(e,t,n);break;default:pl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Jo),t.forEach((function(t){var i=Tc.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function yl(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var a=n[i];try{var s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(r(160));ml(s,o,a),ul=null,hl=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(d){zc(a,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(yl(t,e),vl(e),4&i){try{il(3,e,e.return),al(3,e)}catch(y){zc(e,e.return,y)}try{il(5,e,e.return)}catch(y){zc(e,e.return,y)}}break;case 1:yl(t,e),vl(e),512&i&&null!==n&&el(n,n.return);break;case 5:if(yl(t,e),vl(e),512&i&&null!==n&&el(n,n.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(y){zc(e,e.return,y)}}if(4&i&&null!=(a=e.stateNode)){var s=e.memoizedProps,o=null!==n?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&Y(a,s),we(l,o);var d=we(l,s);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];"style"===u?ye(a,h):"dangerouslySetInnerHTML"===u?ue(a,h):"children"===u?he(a,h):w(a,u,h,d)}switch(l){case"input":J(a,s);break;case"textarea":re(a,s);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var m=s.value;null!=m?ne(a,!!s.multiple,m,!1):p!==!!s.multiple&&(null!=s.defaultValue?ne(a,!!s.multiple,s.defaultValue,!0):ne(a,!!s.multiple,s.multiple?[]:"",!1))}a[pa]=s}catch(y){zc(e,e.return,y)}}break;case 6:if(yl(t,e),vl(e),4&i){if(null===e.stateNode)throw Error(r(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(y){zc(e,e.return,y)}}break;case 3:if(yl(t,e),vl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{$t(t.containerInfo)}catch(y){zc(e,e.return,y)}break;case 4:default:yl(t,e),vl(e);break;case 13:yl(t,e),vl(e),8192&(a=e.child).flags&&(s=null!==a.memoizedState,a.stateNode.isHidden=s,!s||null!==a.alternate&&null!==a.alternate.memoizedState||($l=Ye())),4&i&&fl(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?(Yo=(d=Yo)||u,yl(t,e),Yo=d):yl(t,e),vl(e),8192&i){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Xo=e,u=e.child;null!==u;){for(h=Xo=u;null!==Xo;){switch(m=(p=Xo).child,p.tag){case 0:case 11:case 14:case 15:il(4,p,p.return);break;case 1:el(p,p.return);var f=p.stateNode;if("function"===typeof f.componentWillUnmount){i=p,n=p.return;try{t=i,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(y){zc(i,n,y)}}break;case 5:el(p,p.return);break;case 22:if(null!==p.memoizedState){jl(h);continue}}null!==m?(m.return=p,Xo=m):jl(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{a=h.stateNode,d?"function"===typeof(s=a.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=fe("display",o))}catch(y){zc(e,e.return,y)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(y){zc(e,e.return,y)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:yl(t,e),vl(e),4&i&&fl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var i=n;break e}n=n.return}throw Error(r(160))}switch(i.tag){case 5:var a=i.stateNode;32&i.flags&&(he(a,""),i.flags&=-33),dl(e,ll(e),a);break;case 3:case 4:var s=i.stateNode.containerInfo;cl(e,ll(e),s);break;default:throw Error(r(161))}}catch(o){zc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function wl(e,t,n){Xo=e,xl(e,t,n)}function xl(e,t,n){for(var i=0!==(1&e.mode);null!==Xo;){var a=Xo,r=a.child;if(22===a.tag&&i){var s=null!==a.memoizedState||Zo;if(!s){var o=a.alternate,l=null!==o&&null!==o.memoizedState||Yo;o=Zo;var c=Yo;if(Zo=s,(Yo=l)&&!c)for(Xo=a;null!==Xo;)l=(s=Xo).child,22===s.tag&&null!==s.memoizedState?kl(a):null!==l?(l.return=s,Xo=l):kl(a);for(;null!==r;)Xo=r,xl(r,t,n),r=r.sibling;Xo=a,Zo=o,Yo=c}bl(e)}else 0!==(8772&a.subtreeFlags)&&null!==r?(r.return=a,Xo=r):bl(e)}}function bl(e){for(;null!==Xo;){var t=Xo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Yo||al(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Yo)if(null===n)i.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:no(t.type,n.memoizedProps);i.componentDidUpdate(a,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Wr(t,s,i);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Wr(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&$t(h)}}}break;default:throw Error(r(163))}Yo||512&t.flags&&rl(t)}catch(p){zc(t,t.return,p)}}if(t===e){Xo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xo=n;break}Xo=t.return}}function jl(e){for(;null!==Xo;){var t=Xo;if(t===e){Xo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xo=n;break}Xo=t.return}}function kl(e){for(;null!==Xo;){var t=Xo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{al(4,t)}catch(l){zc(t,n,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var a=t.return;try{i.componentDidMount()}catch(l){zc(t,a,l)}}var r=t.return;try{rl(t)}catch(l){zc(t,r,l)}break;case 5:var s=t.return;try{rl(t)}catch(l){zc(t,s,l)}}}catch(l){zc(t,t.return,l)}if(t===e){Xo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Xo=o;break}Xo=t.return}}var Nl,zl=Math.ceil,_l=x.ReactCurrentDispatcher,El=x.ReactCurrentOwner,Sl=x.ReactCurrentBatchConfig,Tl=0,Cl=null,Pl=null,Il=0,Al=0,Ml=Na(0),Dl=0,Rl=null,Ol=0,Ll=0,Fl=0,Ul=null,Vl=null,$l=0,Bl=1/0,Wl=null,ql=!1,Hl=null,Gl=null,Kl=!1,Ql=null,Zl=0,Yl=0,Jl=null,Xl=-1,ec=0;function tc(){return 0!==(6&Tl)?Ye():-1!==Xl?Xl:Xl=Ye()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Tl)&&0!==Il?Il&-Il:null!==fr.transition?(0===ec&&(ec=ft()),ec):0!==(e=wt)?e:e=void 0===(e=window.event)?16:Zt(e.type)}function ic(e,t,n,i){if(50<Yl)throw Yl=0,Jl=null,Error(r(185));gt(e,n,i),0!==(2&Tl)&&e===Cl||(e===Cl&&(0===(2&Tl)&&(Ll|=n),4===Dl&&lc(e,Il)),ac(e,i),1===n&&0===Tl&&0===(1&t.mode)&&(Bl=Ye()+500,Fa&&$a()))}function ac(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,a=e.expirationTimes,r=e.pendingLanes;0<r;){var s=31-st(r),o=1<<s,l=a[s];-1===l?0!==(o&n)&&0===(o&i)||(a[s]=pt(o,t)):l<=t&&(e.expiredLanes|=o),r&=~o}}(e,t);var i=ht(e,e===Cl?Il:0);if(0===i)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){Fa=!0,Va(e)}(cc.bind(null,e)):Va(cc.bind(null,e)),sa((function(){0===(6&Tl)&&$a()})),n=null;else{switch(xt(i)){case 1:n=Xe;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=Cc(n,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rc(e,t){if(Xl=-1,ec=0,0!==(6&Tl))throw Error(r(327));var n=e.callbackNode;if(kc()&&e.callbackNode!==n)return null;var i=ht(e,e===Cl?Il:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=gc(e,i);else{t=i;var a=Tl;Tl|=2;var s=fc();for(Cl===e&&Il===t||(Wl=null,Bl=Ye()+500,pc(e,t));;)try{wc();break}catch(l){mc(e,l)}Er(),_l.current=s,Tl=a,null!==Pl?t=0:(Cl=null,Il=0,t=Dl)}if(0!==t){if(2===t&&(0!==(a=mt(e))&&(i=a,t=sc(e,a))),1===t)throw n=Rl,pc(e,0),lc(e,i),ac(e,Ye()),n;if(6===t)lc(e,i);else{if(a=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var a=n[i],r=a.getSnapshot;a=a.value;try{if(!oi(r(),a))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=gc(e,i))&&(0!==(s=mt(e))&&(i=s,t=sc(e,s))),1===t))throw n=Rl,pc(e,0),lc(e,i),ac(e,Ye()),n;switch(e.finishedWork=a,e.finishedLanes=i,t){case 0:case 1:throw Error(r(345));case 2:case 5:jc(e,Vl,Wl);break;case 3:if(lc(e,i),(130023424&i)===i&&10<(t=$l+500-Ye())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&i)!==i){tc(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ia(jc.bind(null,e,Vl,Wl),t);break}jc(e,Vl,Wl);break;case 4:if(lc(e,i),(4194240&i)===i)break;for(t=e.eventTimes,a=-1;0<i;){var o=31-st(i);s=1<<o,(o=t[o])>a&&(a=o),i&=~s}if(i=a,10<(i=(120>(i=Ye()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*zl(i/1960))-i)){e.timeoutHandle=ia(jc.bind(null,e,Vl,Wl),i);break}jc(e,Vl,Wl);break;default:throw Error(r(329))}}}return ac(e,Ye()),e.callbackNode===n?rc.bind(null,e):null}function sc(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Vl,Vl=n,null!==t&&oc(t)),e}function oc(e){null===Vl?Vl=e:Vl.push.apply(Vl,e)}function lc(e,t){for(t&=~Fl,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),i=1<<n;e[n]=-1,t&=~i}}function cc(e){if(0!==(6&Tl))throw Error(r(327));kc();var t=ht(e,0);if(0===(1&t))return ac(e,Ye()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var i=mt(e);0!==i&&(t=i,n=sc(e,i))}if(1===n)throw n=Rl,pc(e,0),lc(e,t),ac(e,Ye()),n;if(6===n)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,jc(e,Vl,Wl),ac(e,Ye()),null}function dc(e,t){var n=Tl;Tl|=1;try{return e(t)}finally{0===(Tl=n)&&(Bl=Ye()+500,Fa&&$a())}}function uc(e){null!==Ql&&0===Ql.tag&&0===(6&Tl)&&kc();var t=Tl;Tl|=1;var n=Sl.transition,i=wt;try{if(Sl.transition=null,wt=1,e)return e()}finally{wt=i,Sl.transition=n,0===(6&(Tl=t))&&$a()}}function hc(){Al=Ml.current,za(Ml)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Pl)for(n=Pl.return;null!==n;){var i=n;switch(tr(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Aa();break;case 3:Yr(),za(Ta),za(Sa),is();break;case 5:Xr(i);break;case 4:Yr();break;case 13:case 19:za(es);break;case 10:Sr(i.type._context);break;case 22:case 23:hc()}n=n.return}if(Cl=e,Pl=e=Mc(e.current,null),Il=Al=t,Dl=0,Rl=null,Fl=Ll=Ol=0,Vl=Ul=null,null!==Ir){for(t=0;t<Ir.length;t++)if(null!==(i=(n=Ir[t]).interleaved)){n.interleaved=null;var a=i.next,r=n.pending;if(null!==r){var s=r.next;r.next=a,i.next=s}n.pending=i}Ir=null}return e}function mc(e,t){for(;;){var n=Pl;try{if(Er(),as.current=Js,ds){for(var i=os.memoizedState;null!==i;){var a=i.queue;null!==a&&(a.pending=null),i=i.next}ds=!1}if(ss=0,cs=ls=os=null,us=!1,hs=0,El.current=null,null===n||null===n.return){Dl=1,Rl=t,Pl=null;break}e:{var s=e,o=n.return,l=n,c=t;if(t=Il,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=go(o);if(null!==m){m.flags&=-257,vo(m,o,l,0,t),1&m.mode&&yo(s,d,t),c=d;var f=(t=m).updateQueue;if(null===f){var y=new Set;y.add(c),t.updateQueue=y}else f.add(c);break e}if(0===(1&t)){yo(s,d,t),yc();break e}c=Error(r(426))}else if(ar&&1&l.mode){var g=go(o);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),vo(g,o,l,0,t),mr(co(c,l));break e}}s=c=co(c,l),4!==Dl&&(Dl=2),null===Ul?Ul=[s]:Ul.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,$r(s,mo(0,c,t));break e;case 1:l=c;var v=s.type,w=s.stateNode;if(0===(128&s.flags)&&("function"===typeof v.getDerivedStateFromError||null!==w&&"function"===typeof w.componentDidCatch&&(null===Gl||!Gl.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t,$r(s,fo(s,l,t));break e}}s=s.return}while(null!==s)}bc(n)}catch(x){t=x,Pl===n&&null!==n&&(Pl=n=n.return);continue}break}}function fc(){var e=_l.current;return _l.current=Js,null===e?Js:e}function yc(){0!==Dl&&3!==Dl&&2!==Dl||(Dl=4),null===Cl||0===(268435455&Ol)&&0===(268435455&Ll)||lc(Cl,Il)}function gc(e,t){var n=Tl;Tl|=2;var i=fc();for(Cl===e&&Il===t||(Wl=null,pc(e,t));;)try{vc();break}catch(a){mc(e,a)}if(Er(),Tl=n,_l.current=i,null!==Pl)throw Error(r(261));return Cl=null,Il=0,Dl}function vc(){for(;null!==Pl;)xc(Pl)}function wc(){for(;null!==Pl&&!Qe();)xc(Pl)}function xc(e){var t=Nl(e.alternate,e,Al);e.memoizedProps=e.pendingProps,null===t?bc(e):Pl=t,El.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ko(n,t,Al)))return void(Pl=n)}else{if(null!==(n=Qo(n,t)))return n.flags&=32767,void(Pl=n);if(null===e)return Dl=6,void(Pl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Pl=t);Pl=t=e}while(null!==t);0===Dl&&(Dl=5)}function jc(e,t,n){var i=wt,a=Sl.transition;try{Sl.transition=null,wt=1,function(e,t,n,i){do{kc()}while(null!==Ql);if(0!==(6&Tl))throw Error(r(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-st(n),r=1<<a;t[a]=0,i[a]=-1,e[a]=-1,n&=~r}}(e,s),e===Cl&&(Pl=Cl=null,Il=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,Cc(tt,(function(){return kc(),null}))),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Sl.transition,Sl.transition=null;var o=wt;wt=1;var l=Tl;Tl|=4,El.current=null,function(e,t){if(ea=Wt,pi(e=hi())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var a=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch(b){n=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=e,p=null;t:for(;;){for(var m;h!==n||0!==a&&3!==h.nodeType||(l=o+a),h!==s||0!==i&&3!==h.nodeType||(c=o+i),3===h.nodeType&&(o+=h.nodeValue.length),null!==(m=h.firstChild);)p=h,h=m;for(;;){if(h===e)break t;if(p===n&&++d===a&&(l=o),p===s&&++u===i&&(c=o),null!==(m=h.nextSibling))break;p=(h=p).parentNode}h=m}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Wt=!1,Xo=t;null!==Xo;)if(e=(t=Xo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xo=e;else for(;null!==Xo;){t=Xo;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var y=f.memoizedProps,g=f.memoizedState,v=t.stateNode,w=v.getSnapshotBeforeUpdate(t.elementType===t.type?y:no(t.type,y),g);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(r(163))}}catch(b){zc(t,t.return,b)}if(null!==(e=t.sibling)){e.return=t.return,Xo=e;break}Xo=t.return}f=nl,nl=!1}(e,n),gl(n,e),mi(ta),Wt=!!ea,ta=ea=null,e.current=n,wl(n,e,a),Ze(),Tl=l,wt=o,Sl.transition=s}else e.current=n;if(Kl&&(Kl=!1,Ql=e,Zl=a),s=e.pendingLanes,0===s&&(Gl=null),function(e){if(rt&&"function"===typeof rt.onCommitFiberRoot)try{rt.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ac(e,Ye()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],i(a.value,{componentStack:a.stack,digest:a.digest});if(ql)throw ql=!1,e=Hl,Hl=null,e;0!==(1&Zl)&&0!==e.tag&&kc(),s=e.pendingLanes,0!==(1&s)?e===Jl?Yl++:(Yl=0,Jl=e):Yl=0,$a()}(e,t,n,i)}finally{Sl.transition=a,wt=i}return null}function kc(){if(null!==Ql){var e=xt(Zl),t=Sl.transition,n=wt;try{if(Sl.transition=null,wt=16>e?16:e,null===Ql)var i=!1;else{if(e=Ql,Ql=null,Zl=0,0!==(6&Tl))throw Error(r(331));var a=Tl;for(Tl|=4,Xo=e.current;null!==Xo;){var s=Xo,o=s.child;if(0!==(16&Xo.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Xo=d;null!==Xo;){var u=Xo;switch(u.tag){case 0:case 11:case 15:il(8,u,s)}var h=u.child;if(null!==h)h.return=u,Xo=h;else for(;null!==Xo;){var p=(u=Xo).sibling,m=u.return;if(sl(u),u===d){Xo=null;break}if(null!==p){p.return=m,Xo=p;break}Xo=m}}}var f=s.alternate;if(null!==f){var y=f.child;if(null!==y){f.child=null;do{var g=y.sibling;y.sibling=null,y=g}while(null!==y)}}Xo=s}}if(0!==(2064&s.subtreeFlags)&&null!==o)o.return=s,Xo=o;else e:for(;null!==Xo;){if(0!==(2048&(s=Xo).flags))switch(s.tag){case 0:case 11:case 15:il(9,s,s.return)}var v=s.sibling;if(null!==v){v.return=s.return,Xo=v;break e}Xo=s.return}}var w=e.current;for(Xo=w;null!==Xo;){var x=(o=Xo).child;if(0!==(2064&o.subtreeFlags)&&null!==x)x.return=o,Xo=x;else e:for(o=w;null!==Xo;){if(0!==(2048&(l=Xo).flags))try{switch(l.tag){case 0:case 11:case 15:al(9,l)}}catch(j){zc(l,l.return,j)}if(l===o){Xo=null;break e}var b=l.sibling;if(null!==b){b.return=l.return,Xo=b;break e}Xo=l.return}}if(Tl=a,$a(),rt&&"function"===typeof rt.onPostCommitFiberRoot)try{rt.onPostCommitFiberRoot(at,e)}catch(j){}i=!0}return i}finally{wt=n,Sl.transition=t}}return!1}function Nc(e,t,n){e=Ur(e,t=mo(0,t=co(n,t),1),1),t=tc(),null!==e&&(gt(e,1,t),ac(e,t))}function zc(e,t,n){if(3===e.tag)Nc(e,e,n);else for(;null!==t;){if(3===t.tag){Nc(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Gl||!Gl.has(i))){t=Ur(t,e=fo(t,e=co(n,e),1),1),e=tc(),null!==t&&(gt(t,1,e),ac(t,e));break}}t=t.return}}function _c(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Cl===e&&(Il&n)===n&&(4===Dl||3===Dl&&(130023424&Il)===Il&&500>Ye()-$l?pc(e,0):Fl|=n),ac(e,t)}function Ec(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var n=tc();null!==(e=Dr(e,t))&&(gt(e,t,n),ac(e,n))}function Sc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ec(e,n)}function Tc(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(r(314))}null!==i&&i.delete(t),Ec(e,n)}function Cc(e,t){return Ge(e,t)}function Pc(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ic(e,t,n,i){return new Pc(e,t,n,i)}function Ac(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Mc(e,t){var n=e.alternate;return null===n?((n=Ic(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Dc(e,t,n,i,a,s){var o=2;if(i=e,"function"===typeof e)Ac(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case k:return Rc(n.children,a,s,t);case N:o=8,a|=8;break;case z:return(e=Ic(12,n,t,2|a)).elementType=z,e.lanes=s,e;case T:return(e=Ic(13,n,t,a)).elementType=T,e.lanes=s,e;case C:return(e=Ic(19,n,t,a)).elementType=C,e.lanes=s,e;case A:return Oc(n,a,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case _:o=10;break e;case E:o=9;break e;case S:o=11;break e;case P:o=14;break e;case I:o=16,i=null;break e}throw Error(r(130,null==e?e:typeof e,""))}return(t=Ic(o,n,t,a)).elementType=e,t.type=i,t.lanes=s,t}function Rc(e,t,n,i){return(e=Ic(7,e,i,t)).lanes=n,e}function Oc(e,t,n,i){return(e=Ic(22,e,i,t)).elementType=A,e.lanes=n,e.stateNode={isHidden:!1},e}function Lc(e,t,n){return(e=Ic(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Ic(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,i,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yt(0),this.expirationTimes=yt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yt(0),this.identifierPrefix=i,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Vc(e,t,n,i,a,r,s,o,l){return e=new Uc(e,t,n,o,l),1===t?(t=1,!0===r&&(t|=8)):t=0,r=Ic(3,null,null,t),e.current=r,r.stateNode=e,r.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Or(r),e}function $c(e){if(!e)return Ea;e:{if($e(e=e._reactInternals)!==e||1!==e.tag)throw Error(r(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ia(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(r(171))}if(1===e.tag){var n=e.type;if(Ia(n))return Da(e,n,t)}return t}function Bc(e,t,n,i,a,r,s,o,l){return(e=Vc(n,i,!0,e,0,r,0,o,l)).context=$c(null),n=e.current,(r=Fr(i=tc(),a=nc(n))).callback=void 0!==t&&null!==t?t:null,Ur(n,r,a),e.current.lanes=a,gt(e,a,i),ac(e,i),e}function Wc(e,t,n,i){var a=t.current,r=tc(),s=nc(a);return n=$c(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fr(r,s)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Ur(a,t,s))&&(ic(e,a,s,r),Vr(e,a,s)),s}function qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Gc(e,t){Hc(e,t),(e=e.alternate)&&Hc(e,t)}Nl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ta.current)xo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xo=!1,function(e,t,n){switch(t.tag){case 3:Co(t),pr();break;case 5:Jr(t);break;case 1:Ia(t.type)&&Ra(t);break;case 4:Zr(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,a=t.memoizedProps.value;_a(jr,i._currentValue),i._currentValue=a;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(_a(es,1&es.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Lo(e,t,n):(_a(es,1&es.current),null!==(e=qo(e,t,n))?e.sibling:null);_a(es,1&es.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return Bo(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),_a(es,es.current),i)break;return null;case 22:case 23:return t.lanes=0,zo(e,t,n)}return qo(e,t,n)}(e,t,n);xo=0!==(131072&e.flags)}else xo=!1,ar&&0!==(1048576&t.flags)&&Xa(t,Ha,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Wo(e,t),e=t.pendingProps;var a=Pa(t,Sa.current);Cr(t,n),a=ys(null,t,i,e,a,n);var s=gs();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ia(i)?(s=!0,Ra(t)):s=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Or(t),a.updater=ao,t.stateNode=a,a._reactInternals=t,lo(t,i,e,n),t=To(null,t,i,!0,s,n)):(t.tag=0,ar&&s&&er(t),bo(null,t,a,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Wo(e,t),e=t.pendingProps,i=(a=i._init)(i._payload),t.type=i,a=t.tag=function(e){if("function"===typeof e)return Ac(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===S)return 11;if(e===P)return 14}return 2}(i),e=no(i,e),a){case 0:t=Eo(null,t,i,e,n);break e;case 1:t=So(null,t,i,e,n);break e;case 11:t=jo(null,t,i,e,n);break e;case 14:t=ko(null,t,i,no(i.type,e),n);break e}throw Error(r(306,i,""))}return t;case 0:return i=t.type,a=t.pendingProps,Eo(e,t,i,a=t.elementType===i?a:no(i,a),n);case 1:return i=t.type,a=t.pendingProps,So(e,t,i,a=t.elementType===i?a:no(i,a),n);case 3:e:{if(Co(t),null===e)throw Error(r(387));i=t.pendingProps,a=(s=t.memoizedState).element,Lr(e,t),Br(t,i,null,n);var o=t.memoizedState;if(i=o.element,s.isDehydrated){if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Po(e,t,i,n,a=co(Error(r(423)),t));break e}if(i!==a){t=Po(e,t,i,n,a=co(Error(r(424)),t));break e}for(ir=ca(t.stateNode.containerInfo.firstChild),nr=t,ar=!0,rr=null,n=br(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pr(),i===a){t=qo(e,t,n);break e}bo(e,t,i,n)}t=t.child}return t;case 5:return Jr(t),null===e&&cr(t),i=t.type,a=t.pendingProps,s=null!==e?e.memoizedProps:null,o=a.children,na(i,a)?o=null:null!==s&&na(i,s)&&(t.flags|=32),_o(e,t),bo(e,t,o,n),t.child;case 6:return null===e&&cr(t),null;case 13:return Lo(e,t,n);case 4:return Zr(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=xr(t,null,i,n):bo(e,t,i,n),t.child;case 11:return i=t.type,a=t.pendingProps,jo(e,t,i,a=t.elementType===i?a:no(i,a),n);case 7:return bo(e,t,t.pendingProps,n),t.child;case 8:case 12:return bo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,a=t.pendingProps,s=t.memoizedProps,o=a.value,_a(jr,i._currentValue),i._currentValue=o,null!==s)if(oi(s.value,o)){if(s.children===a.children&&!Ta.current){t=qo(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){o=s.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===s.tag){(c=Fr(-1,n&-n)).tag=2;var d=s.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),Tr(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(r(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Tr(o,n,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}bo(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,i=t.pendingProps.children,Cr(t,n),i=i(a=Pr(a)),t.flags|=1,bo(e,t,i,n),t.child;case 14:return a=no(i=t.type,t.pendingProps),ko(e,t,i,a=no(i.type,a),n);case 15:return No(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:no(i,a),Wo(e,t),t.tag=1,Ia(i)?(e=!0,Ra(t)):e=!1,Cr(t,n),so(t,i,a),lo(t,i,a,n),To(null,t,i,!0,e,n);case 19:return Bo(e,t,n);case 22:return zo(e,t,n)}throw Error(r(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Zc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function ed(e,t,n,i,a){var r=n._reactRootContainer;if(r){var s=r;if("function"===typeof a){var o=a;a=function(){var e=qc(s);o.call(e)}}Wc(t,s,e,a)}else s=function(e,t,n,i,a){if(a){if("function"===typeof i){var r=i;i=function(){var e=qc(s);r.call(e)}}var s=Bc(t,i,e,0,null,!1,0,"",Xc);return e._reactRootContainer=s,e[ma]=s.current,$i(8===e.nodeType?e.parentNode:e),uc(),s}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof i){var o=i;i=function(){var e=qc(l);o.call(e)}}var l=Vc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=l,e[ma]=l.current,$i(8===e.nodeType?e.parentNode:e),uc((function(){Wc(t,l,n,i)})),l}(n,t,e,a,i);return qc(s)}Zc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(r(409));Wc(e,t,null,null)},Zc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){Wc(null,e,null,null)})),t[ma]=null}},Zc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Nt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<At.length&&0!==t&&t<At[n].priority;n++);At.splice(n,0,e),0===n&&Ot(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(vt(t,1|n),ac(t,Ye()),0===(6&Tl)&&(Bl=Ye()+500,$a()))}break;case 13:uc((function(){var t=Dr(e,1);if(null!==t){var n=tc();ic(t,e,1,n)}})),Gc(e,1)}},jt=function(e){if(13===e.tag){var t=Dr(e,134217728);if(null!==t)ic(t,e,134217728,tc());Gc(e,134217728)}},kt=function(e){if(13===e.tag){var t=nc(e),n=Dr(e,t);if(null!==n)ic(n,e,t,tc());Gc(e,t)}},Nt=function(){return wt},zt=function(e,t){var n=wt;try{return wt=e,t()}finally{wt=n}},je=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var a=ba(i);if(!a)throw Error(r(90));G(i),J(i,a)}}}break;case"textarea":re(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Se=dc,Te=uc;var td={usingClientEntryPoint:!1,Events:[wa,xa,ba,_e,Ee,dc]},nd={findFiberByHostInstance:va,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},id={bundleType:nd.bundleType,version:nd.version,rendererPackageName:nd.rendererPackageName,rendererConfig:nd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:nd.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ad=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ad.isDisabled&&ad.supportsFiber)try{at=ad.inject(id),rt=ad}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=td,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(r(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:j,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yc(e))throw Error(r(299));var n=!1,i="",a=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Vc(e,1,!1,null,0,n,0,i,a),e[ma]=t.current,$i(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(r(188));throw e=Object.keys(e).join(","),Error(r(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(r(200));return ed(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yc(e))throw Error(r(405));var i=null!=n&&n.hydratedSources||null,a=!1,s="",o=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Bc(t,null,e,1,null!=n?n:null,a,0,s,o),e[ma]=t.current,$i(e),i)for(e=0;e<i.length;e++)a=(a=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Zc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(r(200));return ed(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(r(40));return!!e._reactRootContainer&&(uc((function(){ed(null,null,e,!1,(function(){e._reactRootContainer=null,e[ma]=null}))})),!0)},t.unstable_batchedUpdates=dc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Jc(n))throw Error(r(200));if(null==e||void 0===e._reactInternals)throw Error(r(38));return ed(e,t,n,!1,i)},t.version="18.3.1-next-f1338f8080-20240426"},352:(e,t,n)=>{var i=n(119);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},414:(e,t,n)=>{e.exports=n(654)},654:(e,t,n)=>{var i=n(950),a=Symbol.for("react.element"),r=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,r={},c=null,d=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)s.call(t,i)&&!l.hasOwnProperty(i)&&(r[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===r[i]&&(r[i]=t[i]);return{$$typeof:a,type:e,key:c,ref:d,props:r,_owner:o.current}}t.Fragment=r,t.jsx=c,t.jsxs=c},761:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,a=e[i];if(!(0<r(a,t)))break e;e[i]=t,e[n]=a,n=i}}function i(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,a=e.length,s=a>>>1;i<s;){var o=2*(i+1)-1,l=e[o],c=o+1,d=e[c];if(0>r(l,n))c<a&&0>r(d,l)?(e[i]=d,e[c]=n,i=c):(e[i]=l,e[o]=n,i=o);else{if(!(c<a&&0>r(d,n)))break e;e[i]=d,e[c]=n,i=c}}}return t}function r(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,p=3,m=!1,f=!1,y=!1,g="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=i(d);null!==t;){if(null===t.callback)a(d);else{if(!(t.startTime<=e))break;a(d),t.sortIndex=t.expirationTime,n(c,t)}t=i(d)}}function b(e){if(y=!1,x(e),!f)if(null!==i(c))f=!0,A(j);else{var t=i(d);null!==t&&M(b,t.startTime-e)}}function j(e,n){f=!1,y&&(y=!1,v(_),_=-1),m=!0;var r=p;try{for(x(n),h=i(c);null!==h&&(!(h.expirationTime>n)||e&&!T());){var s=h.callback;if("function"===typeof s){h.callback=null,p=h.priorityLevel;var o=s(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===i(c)&&a(c),x(n)}else a(c);h=i(c)}if(null!==h)var l=!0;else{var u=i(d);null!==u&&M(b,u.startTime-n),l=!1}return l}finally{h=null,p=r,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,N=!1,z=null,_=-1,E=5,S=-1;function T(){return!(t.unstable_now()-S<E)}function C(){if(null!==z){var e=t.unstable_now();S=e;var n=!0;try{n=z(!0,e)}finally{n?k():(N=!1,z=null)}}else N=!1}if("function"===typeof w)k=function(){w(C)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,I=P.port2;P.port1.onmessage=C,k=function(){I.postMessage(null)}}else k=function(){g(C,0)};function A(e){z=e,N||(N=!0,k())}function M(e,n){_=g((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||m||(f=!0,A(j))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,a,r){var s=t.unstable_now();switch("object"===typeof r&&null!==r?r="number"===typeof(r=r.delay)&&0<r?s+r:s:r=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:a,priorityLevel:e,startTime:r,expirationTime:o=r+o,sortIndex:-1},r>s?(e.sortIndex=r,n(d,e),null===i(c)&&e===i(d)&&(y?(v(_),_=-1):y=!0,M(b,r-s))):(e.sortIndex=o,n(c,e),f||m||(f=!0,A(j))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},950:(e,t,n)=>{e.exports=n(49)}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,n),r.exports}n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}();var i=n(950),a=n(352),r=n(414);const s={name:"Tw\xf3j Developer",cash:1e8,reputation:100,reputationHistory:[],reputationFactors:{legalCompliance:1,environmentalImpact:1,communityRelations:1,projectQuality:1,transparency:1,grayAreaActivity:1},activeReputationInitiatives:[],projects:[],rtbPower:0,totalPower:0,installedCapacity:0,rtbCapacity:0,staff:{lessors:[],developers:[],lawyers:[],envSpecialists:[],lobbyists:[]},illegals:{hasIllegalDatabase:!1,corruptionNetwork:0,intimidationPower:0,forgeryExpertise:0,auditRisk:20,lastAuditTurn:0,totalBribes:0,illegalActionHistory:[]},economicMetrics:{totalInvestment:0,totalRevenue:0,totalExpenses:0,avgROI:0,projectsCost:0,projectsValue:0},audits:{totalAudits:0,passedAudits:0,totalFines:0,lastAuditResult:null},loans:[],companyUpgrades:{}};function o(e,t){var n,i,a,r;switch(t.type){case"UPDATE_CASH":return{...e,cash:e.cash+t.payload};case"ADD_PROJECT":return{...e,projects:[...e.projects,t.payload],totalPower:e.totalPower+t.payload.power};case"UPDATE_PROJECT":return{...e,projects:e.projects.map((e=>e.id===t.payload.id?{...e,...t.payload.changes}:e))};case"SELL_PROJECT":return{...e,cash:e.cash+t.payload.price,projects:e.projects.filter((e=>e.id!==t.payload.projectId)),totalPower:e.totalPower-((null===(n=e.projects.find((e=>e.id===t.payload.projectId)))||void 0===n?void 0:n.power)||0),rtbPower:e.rtbPower-("ready_to_build"===(null===(i=e.projects.find((e=>e.id===t.payload.projectId)))||void 0===i?void 0:i.status)&&(null===(a=e.projects.find((e=>e.id===t.payload.projectId)))||void 0===a?void 0:a.power)||0),economicMetrics:{...e.economicMetrics,totalRevenue:e.economicMetrics.totalRevenue+t.payload.price,projectsValue:e.economicMetrics.projectsValue-((null===(r=e.projects.find((e=>e.id===t.payload.projectId)))||void 0===r?void 0:r.marketValue)||0)}};case"UPDATE_RTB_POWER":return{...e,rtbPower:e.rtbPower+t.payload};case"HIRE_STAFF":const s=t.payload.staffType.endsWith("s")?t.payload.staffType:`${t.payload.staffType}s`,o=e.staff[s]||[];return{...e,cash:e.cash-t.payload.cost,staff:{...e.staff,[s]:[...o,t.payload.staff]},economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+t.payload.cost}};case"FIRE_STAFF":const l=t.payload.staffType.endsWith("s")?t.payload.staffType:`${t.payload.staffType}s`;return{...e,cash:e.cash-t.payload.cost,staff:{...e.staff,[l]:(e.staff[l]||[]).filter((e=>e.id!==t.payload.staffId))},economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+t.payload.cost}};case"TRAIN_STAFF":const c=t.payload.staffType.endsWith("s")?t.payload.staffType:`${t.payload.staffType}s`;return{...e,cash:e.cash-t.payload.cost,staff:{...e.staff,[c]:(e.staff[c]||[]).map((e=>e.id===t.payload.staffId?{...e,skill:Math.min(10,e.skill+t.payload.skillGain),experience:e.experience+t.payload.experienceGain,training:[...e.training||[],{date:(new Date).toISOString(),type:t.payload.trainingType,cost:t.payload.cost,skillGain:t.payload.skillGain}]}:e))},economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+t.payload.cost}};case"UPDATE_STAFF":const d=t.payload.staffType.endsWith("s")?t.payload.staffType:`${t.payload.staffType}s`;return{...e,staff:{...e.staff,[d]:(e.staff[d]||[]).map((e=>e.id===t.payload.staffId?{...e,...t.payload.changes}:e))}};case"ASSIGN_STAFF_TO_PROJECT":return{...e,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,assignedStaff:{...e.assignedStaff||{},[t.payload.staffType]:t.payload.staffId}}:e)),staff:{...e.staff,[t.payload.staffType+"s"]:(e.staff[t.payload.staffType+"s"]||[]).map((e=>e.id===t.payload.staffId?{...e,assignedProject:t.payload.projectId,assignedSince:(new Date).toISOString()}:e))}};case"ADD_PROJECT_EVENT":return{...e,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,events:[...e.events,t.payload.event]}:e))};case"UPDATE_REPUTATION":return{...e,reputation:Math.max(0,Math.min(200,e.reputation+t.payload.change)),reputationHistory:[...e.reputationHistory,{date:(new Date).toISOString(),change:t.payload.change,reason:t.payload.reason,turn:t.payload.turn}]};case"USE_ILLEGAL_ACTION":return{...e,illegals:{...e.illegals,corruptionNetwork:t.payload.updateCorruption?Math.min(100,e.illegals.corruptionNetwork+t.payload.corruptionChange):e.illegals.corruptionNetwork,auditRisk:Math.min(100,e.illegals.auditRisk+t.payload.riskIncrease),totalBribes:e.illegals.totalBribes+(t.payload.bribeCost||0),illegalActionHistory:[...e.illegals.illegalActionHistory,{date:(new Date).toISOString(),type:t.payload.actionType,target:t.payload.target,cost:t.payload.bribeCost||0,turn:t.payload.turn}]},cash:e.cash-(t.payload.bribeCost||0),economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+(t.payload.bribeCost||0)}};case"TRIGGER_AUDIT":return{...e,illegals:{...e.illegals,auditRisk:Math.max(10,e.illegals.auditRisk-t.payload.riskReduction),lastAuditTurn:t.payload.turn},audits:{...e.audits,totalAudits:e.audits.totalAudits+1,passedAudits:t.payload.passed?e.audits.passedAudits+1:e.audits.passedAudits,totalFines:e.audits.totalFines+(t.payload.fine||0),lastAuditResult:{date:(new Date).toISOString(),turn:t.payload.turn,passed:t.payload.passed,fine:t.payload.fine||0,reputationLoss:t.payload.reputationLoss||0}},cash:e.cash-(t.payload.fine||0),economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+(t.payload.fine||0)}};case"UPDATE_PROJECT_MARKET_VALUE":return{...e,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,marketValue:t.payload.value}:e)),economicMetrics:{...e.economicMetrics,projectsValue:e.projects.reduce(((e,n)=>e+(n.id===t.payload.projectId?t.payload.value:n.marketValue||0)),0)}};case"UPDATE_PROJECT_TOTAL_COST":return{...e,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,totalCost:e.totalCost+t.payload.cost}:e)),economicMetrics:{...e.economicMetrics,totalInvestment:e.economicMetrics.totalInvestment+t.payload.cost,projectsCost:e.economicMetrics.projectsCost+t.payload.cost}};case"INITIALIZE_PROJECT_FORMAL_PARAMS":return{...e,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,formalParams:t.payload.params}:e))};case"UPDATE_ILLEGAL_DATABASE":return{...e,illegals:{...e.illegals,hasIllegalDatabase:t.payload.hasIllegalDatabase}};case"UPDATE_ILLEGALS_STATUS":return{...e,illegals:{...e.illegals,...t.payload}};case"ADD_ILLEGAL_HISTORY":return{...e,illegals:{...e.illegals,illegalActionHistory:[...e.illegals.illegalActionHistory,t.payload]}};case"ADD_ILLEGAL_ACTION":return{...e,cash:e.cash-t.payload.cost,illegals:{...e.illegals,auditRisk:Math.min(100,e.illegals.auditRisk+5),totalBribes:e.illegals.totalBribes+t.payload.cost,illegalActionHistory:[...e.illegals.illegalActionHistory,{date:(new Date).toISOString(),type:t.payload.type,target:t.payload.target,cost:t.payload.cost,turn:t.payload.turn,exposed:t.payload.exposed}]},economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+t.payload.cost}};case"ADD_LOAN":return{...e,loans:[...e.loans||[],t.payload],cash:e.cash+t.payload.amount};case"UPDATE_LOAN":return{...e,loans:(e.loans||[]).map((e=>e.id===t.payload.id?{...e,...t.payload.changes}:e))};case"REMOVE_LOAN":return{...e,loans:(e.loans||[]).filter((e=>e.id!==t.payload.id))};case"SEND_PROJECT_TO_MARKET":return e.projects.find((e=>e.id===t.payload.projectId))?{...e,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,isOnMarket:!0,marketPrice:t.payload.price,marketListingDate:(new Date).toISOString(),events:[...e.events,{date:(new Date).toISOString(),text:`Projekt zosta\u0142 wystawiony na rynek za ${t.payload.price.toLocaleString()} PLN`}]}:e))}:e;case"ACCELERATE_PROJECT":return e.projects.find((e=>e.id===t.payload.projectId))?{...e,cash:e.cash-t.payload.cost,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,progress:Math.min(100,(e.progress||0)+t.payload.progressGain),events:[...e.events,{date:(new Date).toISOString(),text:`Przyspieszono projekt o ${t.payload.progressGain}% za ${t.payload.cost.toLocaleString()} PLN`}]}:e)),economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+t.payload.cost,totalInvestment:e.economicMetrics.totalInvestment+t.payload.cost,projectsCost:e.economicMetrics.projectsCost+t.payload.cost}}:e;case"UPDATE_ECONOMIC_METRICS":return{...e,economicMetrics:{...e.economicMetrics,...t.payload}};case"PURCHASE_COMPANY_UPGRADE":return{...e,cash:e.cash-t.payload.cost,companyUpgrades:{...e.companyUpgrades||{},[t.payload.upgradeId]:t.payload.level}};case"UPDATE_PLAYER":case"LOAD_PLAYER":return{...e,...t.payload};case"UPDATE_STAFF_STRUCTURE":return{...e,staff:{...e.staff,...t.payload}};case"UPDATE_REPUTATION_FACTOR":return{...e,reputationFactors:{...e.reputationFactors,[t.payload.factor]:Math.max(.1,Math.min(2,e.reputationFactors[t.payload.factor]+t.payload.change))},reputationHistory:[...e.reputationHistory,{date:(new Date).toISOString(),type:"factor_change",factor:t.payload.factor,change:t.payload.change,reason:t.payload.reason,turn:t.payload.turn}]};case"START_REPUTATION_INITIATIVE":const u=e.activeReputationInitiatives.findIndex((e=>e.type===t.payload.initiative.type));if(-1!==u){const n=[...e.activeReputationInitiatives],i=n[u];return n[u]={...i,intensity:i.intensity+.5*t.payload.initiative.intensity,duration:Math.max(i.duration,t.payload.initiative.duration),cost:i.cost+t.payload.initiative.cost},{...e,activeReputationInitiatives:n,cash:e.cash-t.payload.initiative.cost}}return{...e,activeReputationInitiatives:[...e.activeReputationInitiatives,{...t.payload.initiative,startDate:(new Date).toISOString(),remainingDuration:t.payload.initiative.duration}],cash:e.cash-t.payload.initiative.cost};case"UPDATE_REPUTATION_INITIATIVES":const h=t.payload.daysPassed||1;let p=0,m={};const f=e.activeReputationInitiatives.map((e=>{const t=e.remainingDuration-h;if(e.continuousEffects)for(const n of e.continuousEffects)n.reputationPerDay&&(p+=n.reputationPerDay*h),n.factorChange&&n.factorPerDay&&(m[n.factorChange]=(m[n.factorChange]||0)+n.factorPerDay*h);if(t<=0){if(e.finalEffects)for(const t of e.finalEffects)t.reputationChange&&(p+=t.reputationChange),t.factorChange&&t.factorAmount&&(m[t.factorChange]=(m[t.factorChange]||0)+t.factorAmount);return null}return{...e,remainingDuration:t}})).filter(Boolean),y={...e.reputationFactors};for(const[e,t]of Object.entries(m))y[e]=Math.max(.1,Math.min(2,y[e]+t));return{...e,reputation:Math.max(0,Math.min(200,e.reputation+p)),reputationFactors:y,activeReputationInitiatives:f,reputationHistory:[...e.reputationHistory,...0!==p?[{date:(new Date).toISOString(),change:p,reason:"Efekt inicjatyw reputacyjnych",turn:t.payload.turn}]:[],...Object.entries(m).map((e=>{let[n,i]=e;return{date:(new Date).toISOString(),type:"factor_change",factor:n,change:i,reason:"Efekt inicjatyw reputacyjnych",turn:t.payload.turn}}))]};default:return e}}const l=(0,i.createContext)(),c=e=>{let{children:t}=e;const[n,a]=(0,i.useReducer)(o,s);return(0,r.jsx)(l.Provider,{value:{state:n,dispatch:a},children:t})},d=()=>{const e=(0,i.useContext)(l);if(!e)throw new Error("usePlayerContext musi by\u0107 u\u017cywany wewn\u0105trz PlayerProvider");return e},u=[{id:"competitor1",name:"GreenPower Polska",power:8e3,rtbPower:2e3,growth:1.1,strongRegions:["mazowieckie","wielkopolskie","slaskie"],strategy:"aggressive",reputation:70,description:"Najwi\u0119kszy deweloper OZE w Polsce, agresywnie rozwijaj\u0105cy sw\xf3j portfel projekt\xf3w. Koncentruje si\u0119 na du\u017cych farmach fotowoltaicznych i wiatrowych w centralnej i zachodniej Polsce.",focusTechnologies:["PV","WF"],foundedYear:2010},{id:"competitor2",name:"SolarTech",power:5e3,rtbPower:1500,growth:1.2,strongRegions:["malopolskie","podkarpackie","lubelskie"],strategy:"balanced",reputation:65,description:"Firma specjalizuj\u0105ca si\u0119 w projektach fotowoltaicznych, z rosn\u0105cym zainteresowaniem magazynami energii. Dzia\u0142a g\u0142\xf3wnie w po\u0142udniowo-wschodniej Polsce.",focusTechnologies:["PV","BESS"],foundedYear:2015},{id:"competitor3",name:"WindForce",power:6e3,rtbPower:1800,growth:1.15,strongRegions:["pomorskie","zachodniopomorskie","warminsko-mazurskie"],strategy:"conservative",reputation:80,description:"Do\u015bwiadczony deweloper farm wiatrowych z siln\u0105 pozycj\u0105 w p\xf3\u0142nocnej Polsce. Znany z wysokiej jako\u015bci projekt\xf3w i dobrych relacji z lokalnymi spo\u0142eczno\u015bciami.",focusTechnologies:["WF"],foundedYear:2008},{id:"competitor4",name:"EnergyStorage Systems",power:3e3,rtbPower:900,growth:1.25,strongRegions:["lodzkie","mazowieckie","slaskie"],strategy:"aggressive",reputation:60,description:"Nowy, szybko rozwijaj\u0105cy si\u0119 gracz specjalizuj\u0105cy si\u0119 w magazynach energii. Agresywnie pozyskuje lokalizacje w pobli\u017cu du\u017cych o\u015brodk\xf3w przemys\u0142owych i w\u0119z\u0142\xf3w energetycznych.",focusTechnologies:["BESS","PV"],foundedYear:2018},{id:"competitor5",name:"EcoEnergy",power:4500,rtbPower:1200,growth:1.05,strongRegions:["wielkopolskie","lubuskie","dolnoslaskie"],strategy:"conservative",reputation:75,description:"Stabilna firma z d\u0142ug\u0105 histori\u0105 na rynku OZE, dzia\u0142aj\u0105ca g\u0142\xf3wnie w zachodniej Polsce. Ostro\u017cnie podchodzi do nowych projekt\xf3w, ale ma solidny portfel aktyw\xf3w.",focusTechnologies:["PV","WF"],foundedYear:2005}],h=(e,t)=>{if(!t||!Array.isArray(t)||0===t.length)return null;const n=["land_acquisition","project_development","market_expansion","technology_shift","acquisition"],i=n[Math.floor(Math.random()*n.length)];let a={id:Date.now(),competitorId:e.id,competitorName:e.name,type:i,title:"",description:"",effects:[],regions:[]};switch(i){case"land_acquisition":const n=e.strongRegions[Math.floor(Math.random()*e.strongRegions.length)],i=t.find((e=>e.id===n));if(!i)return h(e,t);const r=Math.floor(30+50*Math.random());a.title=`${e.name} pozyskuje grunty w regionie ${i.name}`,a.description=`Konkurent zabezpieczy\u0142 ${r} ha grunt\xf3w pod nowy projekt OZE.`,a.effects.push({type:"regional_land_availability",value:.95,regionId:n}),a.regions.push(n);break;case"project_development":const s=Math.floor(20+60*Math.random()),o=e.focusTechnologies[Math.floor(Math.random()*e.focusTechnologies.length)];a.title=`${e.name} rozwija nowy projekt ${o}`,a.description=`Konkurent og\u0142osi\u0142 rozw\xf3j nowego projektu ${o} o mocy ${s} MW.`,a.effects.push({type:"competitor_power",value:s,competitorId:e.id});break;case"market_expansion":const l=t.filter((t=>!e.strongRegions.includes(t.id)));if(!(l.length>0))return h(e,t);{const t=l[Math.floor(Math.random()*l.length)];a.title=`${e.name} wchodzi na rynek w regionie ${t.name}`,a.description="Konkurent rozpoczyna dzia\u0142alno\u015b\u0107 w nowym regionie, zwi\u0119kszaj\u0105c konkurencj\u0119.",a.effects.push({type:"regional_competition",value:1.1,regionId:t.id}),a.regions.push(t.id)}break;case"technology_shift":const c=["PV","WF","BESS"].filter((t=>!e.focusTechnologies.includes(t)));if(!(c.length>0))return h(e,t);{const t=c[Math.floor(Math.random()*c.length)];a.title=`${e.name} wchodzi w now\u0105 technologi\u0119: ${t}`,a.description=`Konkurent og\u0142osi\u0142 strategiczn\u0105 decyzj\u0119 o rozwoju projekt\xf3w w technologii ${t}.`,a.effects.push({type:"competitor_technology",value:t,competitorId:e.id})}break;case"acquisition":a.title=`${e.name} przejmuje mniejszego dewelopera`,a.description="Konkurent og\u0142osi\u0142 przej\u0119cie mniejszej firmy deweloperskiej, zwi\u0119kszaj\u0105c sw\xf3j portfel projekt\xf3w.";const d=Math.floor(500+1e3*Math.random());a.effects.push({type:"competitor_power_boost",value:d,competitorId:e.id});break;default:return null}return a},p={marketModifier:{min:.7,max:1.5},permitTimeModifier:{min:.5,max:2},buildCostModifier:{min:.6,max:1.8},loanInterestRate:{min:.7,max:1.5},staffCostModifier:{min:.8,max:1.3},reputationChange:{min:-30,max:30},riskLevel:{min:-10,max:10},grayAreaImpact:{min:-25,max:25},projectEfficiency:{min:-20,max:30},staffProductivity:{min:-25,max:40}},m=(e,t)=>{if(!p[e])return t;const{min:n,max:i}=p[e];return Math.max(n,Math.min(i,t))},f=e=>{if(!e)return{};const t={};for(const[n,i]of Object.entries(e))t[n]="object"!==typeof i?m(n,i):i;if(e.regionalEffect){t.regionalEffect={...e.regionalEffect};for(const[n,i]of Object.entries(e.regionalEffect))"region"!==n&&(t.regionalEffect[n]=m(n,i))}if(e.technologyEffect){t.technologyEffect={...e.technologyEffect};for(const[n,i]of Object.entries(e.technologyEffect))"technology"!==n&&(t.technologyEffect[n]=m(n,i))}return t},y=e=>{const t={marketModifier:{min:.6,max:2},permitTimeModifier:{min:.4,max:2.5},buildCostModifier:{min:.5,max:2},loanInterestRate:{min:.5,max:2},staffCostModifier:{min:.7,max:1.5}},n={...e};for(const[i,a]of Object.entries(e))if(t[i]){const{min:e,max:r}=t[i];n[i]=Math.max(e,Math.min(r,a))}return n};class g{constructor(e,t,n,i){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.id=e||Date.now()+Math.random(),this.name=t,this.description=n,this.duration=i,this.image=a,this.startDate=null,this.expiryDate=null}activate(e){this.startDate=new Date(e);const t=new Date(e);return t.setDate(t.getDate()+this.duration),this.expiryDate=t,this}isExpired(e){return!!this.expiryDate&&e>this.expiryDate}getEffect(){return{}}}class v extends g{constructor(e,t,n,i,a){super(e,t,n,i,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="economic",this.effects=a}getEffect(){return this.effects}}class w extends g{constructor(e,t,n,i,a){super(e,t,n,i,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="political",this.effects=a}getEffect(){return this.effects}}class x extends g{constructor(e,t,n,i,a){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;super(e,t,n,i,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null),this.type="social",this.effects=a,this.region=r}getEffect(){const e={...this.effects};return this.region&&(e.regionalEffect={region:this.region,...e.regionalEffect}),e}}class b extends g{constructor(e,t,n,i,a){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;super(e,t,n,i,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null),this.type="environmental",this.effects=a,this.region=r}getEffect(){const e={...this.effects};return this.region&&(e.regionalEffect={region:this.region,...e.regionalEffect}),e}}class j extends g{constructor(e,t,n,i,a){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;super(e,t,n,i,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null),this.type="technological",this.effects=a,this.technology=r}getEffect(){const e={...this.effects};return this.technology&&(e.technologyEffect={technology:this.technology,...e.technologyEffect}),e}}class k extends g{constructor(e,t,n,i,a){super(e,t,n,i,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="media",this.effects=a}getEffect(){return this.effects}}class N extends g{constructor(e,t,n,i,a){super(e,t,n,i,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="regulatory",this.effects=a}getEffect(){return this.effects}}new j("quantum_battery","Prze\u0142om: Bateria kwantowa","Naukowcy z polskiego instytutu dokonali prze\u0142omu w technologii baterii kwantowych. Ta rewolucyjna technologia mo\u017ce zmieni\u0107 oblicze energetyki.",365,{investmentOpportunity:{cost:5e6,successChance:.4,potentialReturn:12,technologyAdvantage:3},energyStorageRevolution:!0,marketDisruption:.3}).rarity={weight:1,color:"#f59e0b"};const z=[new v("econ_1","Wzrost cen pr\u0105du na rynku","Ceny energii elektrycznej na rynku wzros\u0142y o 15%, zwi\u0119kszaj\u0105c atrakcyjno\u015b\u0107 projekt\xf3w OZE.",30,{marketModifier:1.15,permitTimeModifier:1}),new v("econ_2","Spadek cen pr\u0105du na rynku","Ceny energii elektrycznej na rynku spad\u0142y o 10%, zmniejszaj\u0105c op\u0142acalno\u015b\u0107 projekt\xf3w OZE.",21,{marketModifier:.9,permitTimeModifier:1}),new v("econ_3","Wzrost st\xf3p procentowych","NBP podni\xf3s\u0142 stopy procentowe, co utrudnia finansowanie projekt\xf3w i zwi\u0119ksza koszty kredyt\xf3w.",60,{buildCostModifier:1.1,marketModifier:.95}),new v("econ_4","Kryzys na rynku surowc\xf3w","Globalny kryzys na rynku surowc\xf3w zwi\u0119ksza koszty budowy farm PV i wiatrowych.",45,{buildCostModifier:1.2,marketModifier:1.05}),new v("econ_5","Nowe fundusze UE dla OZE","Unia Europejska uruchomi\u0142a nowe fundusze na rozw\xf3j OZE, co zwi\u0119ksza warto\u015b\u0107 projekt\xf3w.",90,{marketModifier:1.2,buildCostModifier:.95,reputationChange:5}),new v("eco_6","Dotacje dla hybryd PV+BESS","Rz\u0105d wprowadzi\u0142 program dotacji pokrywaj\u0105cy 30% koszt\xf3w magazyn\xf3w energii w projektach hybrydowych.",120,{marketModifier:1.2,permitTimeModifier:.9,technologyEffect:{technology:"BESS",marketModifier:1.3}}),new v("eco_7","Ulgi podatkowe dla inwestor\xf3w OZE","Wprowadzono 50% odliczenia VAT dla firm inwestuj\u0105cych w projekty energetyki odnawialnej.",180,{marketModifier:1.15,permitTimeModifier:.85}),new v("eco_8","Aukcje CPPA","Wprowadzono system d\u0142ugoterminowych kontrakt\xf3w dla przemys\u0142u, umo\u017cliwiaj\u0105cych stabilne finansowanie projekt\xf3w OZE.",150,{marketModifier:1.25}),new v("eco_9",'Program "Prosument 3.0"',"Nowy program rz\u0105dowy oferuje dotacje do 60% dla mikroinstalacji fotowoltaicznych.",90,{technologyEffect:{technology:"PV",marketModifier:1.2}}),new v("eco_10","C\u0142a na komponenty","Wprowadzono 20% c\u0142o na panele fotowoltaiczne z Chin, podnosz\u0105c koszty inwestycji.",120,{technologyEffect:{technology:"PV",marketModifier:.85,buildCostModifier:1.2},severity:"negative"})],_=[new w("pol_1","Nowelizacja ustawy o OZE","Sejm przyj\u0105\u0142 nowelizacj\u0119 ustawy o OZE, kt\xf3ra upraszcza procedury administracyjne.",120,{permitTimeModifier:.8,reputationChange:3}),new w("pol_2","Zaostrzenie wymaga\u0144 \u015brodowiskowych","Nowe przepisy zaostrzaj\u0105 wymagania dotycz\u0105ce ocen oddzia\u0142ywania na \u015brodowisko.",90,{permitTimeModifier:1.3,reputationChange:-2}),new w("pol_3","Reforma systemu aukcyjnego","Rz\u0105d zreformowa\u0142 system aukcyjny OZE, wprowadzaj\u0105c korzystniejsze zasady dla inwestor\xf3w.",180,{marketModifier:1.1,permitTimeModifier:.9,reputationChange:5}),new w("pol_4","Ograniczenie dotacji dla OZE","Rz\u0105d ograniczy\u0142 dotacje dla nowych projekt\xf3w OZE, co zmniejsza ich op\u0142acalno\u015b\u0107.",150,{marketModifier:.85,reputationChange:-3}),new w("pol_5","Nowe cele klimatyczne","Polska przyj\u0119\u0142a ambitniejsze cele klimatyczne, zwi\u0119kszaj\u0105c zapotrzebowanie na OZE.",210,{marketModifier:1.15,reputationChange:7}),new w("pol_6",'Ustawa "Fast-track"',"Sejm przyj\u0105\u0142 ustaw\u0119 znacz\u0105co skracaj\u0105c\u0105 proces pozwole\u0144 dla projekt\xf3w OZE z 5 do 2 lat.",365,{permitTimeModifier:.6,reputationChange:5}),new w("pol_7","Krajowy Plan Modernizacji Sieci","Rz\u0105d przeznaczy\u0142 10 mld z\u0142 na rozbudow\u0119 infrastruktury przesy\u0142owej, zwi\u0119kszaj\u0105c mo\u017cliwo\u015bci przy\u0142\u0105czeniowe.",240,{permitTimeModifier:.75,buildCostModifier:.9}),new w("pol_8","Strategia wodorowa","Przyj\u0119to strategi\u0119 rozwoju wodoru z OZE z celem 2 GW mocy do 2030 roku.",180,{marketModifier:1.15}),new w("pol_9","Zmiana ustawy odleg\u0142o\u015bciowej","Wprowadzono zakaz budowy wiatrak\xf3w w promieniu 1 km od zabudowa\u0144, co utrudnia rozw\xf3j energetyki wiatrowej.",300,{technologyEffect:{technology:"WF",marketModifier:.7,permitTimeModifier:1.5},severity:"negative"}),new w("pol_10","Op\xf3\u017anienie offshore","Brak ustawy o morskiej energetyce wstrzymuje projekty o \u0142\u0105cznej mocy 10 GW.",150,{technologyEffect:{technology:"WF",marketModifier:.8},severity:"negative"})],E=[new x("soc_1","Protesty przeciwko farmom wiatrowym","W wielu regionach kraju nasili\u0142y si\u0119 protesty lokalnych spo\u0142eczno\u015bci przeciwko farmom wiatrowym.",60,{permitTimeModifier:1.2,reputationChange:-3}),new x("soc_2","Wzrost poparcia dla OZE","Badania pokazuj\u0105 rekordowy wzrost poparcia spo\u0142ecznego dla energetyki odnawialnej.",90,{permitTimeModifier:.9,reputationChange:4}),new x("soc_3","Lokalna kampania przeciwko PV","W wojew\xf3dztwie ma\u0142opolskim rozwin\u0119\u0142a si\u0119 kampania przeciwko wielkoobszarowym farmom PV.",45,{regionalEffect:{permitTimeModifier:1.3}},"ma\u0142opolskie"),new x("soc_4","Program edukacyjny o OZE","Ministerstwo Klimatu uruchomi\u0142o og\xf3lnopolski program edukacyjny na temat korzy\u015bci z OZE.",120,{permitTimeModifier:.95,reputationChange:2}),new x("soc_5","Konflikt o turbiny przy wybrze\u017cu","Nasili\u0142 si\u0119 konflikt mi\u0119dzy rybakami a inwestorami farm wiatrowych na Ba\u0142tyku.",75,{regionalEffect:{permitTimeModifier:1.4}},"pomorskie"),new x("soc_6","Subsydia dla mieszka\u0144c\xf3w",'Program "Energia dla Spo\u0142eczno\u015bci" oferuje darmowe instalacje PV w zamian za zgod\u0119 na farmy wiatrowe.',120,{permitTimeModifier:.8,reputationChange:5}),new x("soc_7","Nowe miejsca pracy","Budowa farmy wiatrowej 50 MW stworzy\u0142a 100 sta\u0142ych miejsc pracy w regionie.",90,{reputationChange:3,technologyEffect:{technology:"WF",marketModifier:1.1}},"zachodniopomorskie"),new x("soc_8","Programy edukacyjne OZE",'Warsztaty "Zielona Gmina" w szko\u0142ach, finansowane przez deweloper\xf3w, zwi\u0119kszaj\u0105 spo\u0142eczn\u0105 akceptacj\u0119 projekt\xf3w.',150,{permitTimeModifier:.9,reputationChange:2}),new x("soc_9","Protesty NIMBY","Blokada budowy farmy wiatrowej przez mieszka\u0144c\xf3w gminy wzbudzi\u0142a obawy inwestor\xf3w.",60,{permitTimeModifier:1.3,reputationChange:-4,technologyEffect:{technology:"WF",marketModifier:.9}},"ma\u0142opolskie"),new x("soc_10","Bunt spo\u0142eczno\u015bci","Mieszka\u0144cy blokuj\u0105 wjazd ci\u0119\u017car\xf3wek na plac budowy farmy fotowoltaicznej.",45,{buildCostModifier:1.2,permitTimeModifier:1.4,reputationChange:-3},"podkarpackie")],S=[new b("env_1","Rekordowo s\u0142oneczne lato","Tegoroczne lato przynios\u0142o rekordow\u0105 liczb\u0119 dni s\u0142onecznych, co zwi\u0119ksza wydajno\u015b\u0107 PV.",90,{technologyEffect:{technology:"PV",marketModifier:1.1}}),new b("env_2","Silne wiatry na p\xf3\u0142nocy","Na p\xf3\u0142nocy Polski utrzymuj\u0105 si\u0119 wyj\u0105tkowo silne wiatry, zwi\u0119kszaj\u0105c potencja\u0142 farm wiatrowych.",60,{regionalEffect:{marketModifier:1.15},technologyEffect:{technology:"WF",marketModifier:1.1}},"pomorskie"),new b("env_3","Susze w centralnej Polsce","D\u0142ugotrwa\u0142e susze w centralnej Polsce powoduj\u0105 konflikty o wykorzystanie grunt\xf3w.",75,{regionalEffect:{permitTimeModifier:1.2}},"mazowieckie"),new b("env_4","Odkrycie cennego gatunku ptak\xf3w","W wojew\xf3dztwie podlaskim odkryto rzadki gatunek ptak\xf3w, co komplikuje projekty OZE.",120,{regionalEffect:{permitTimeModifier:1.5}},"podlaskie"),new b("env_5","Wysoki poziom zanieczyszczenia powietrza","Zim\u0105 odnotowano rekordowo wysokie poziomy zanieczyszczenia powietrza, co zwi\u0119ksza poparcie dla OZE.",60,{permitTimeModifier:.9,reputationChange:3}),new b("env_6","Korytarze bior\xf3\u017cnorodno\u015bci","Wsp\xf3\u0142projekty z ekologami, w tym tworzenie pasiek przy farmach PV, zwi\u0119kszaj\u0105 akceptacj\u0119 \u015brodowiskow\u0105.",120,{permitTimeModifier:.85,reputationChange:3,technologyEffect:{technology:"PV",buildCostModifier:1.05}}),new b("env_7","Ekstremalne warunki pogodowe","Gradobicie uszkodzi\u0142o znaczn\u0105 cz\u0119\u015b\u0107 paneli fotowoltaicznych w centralnej Polsce.",45,{buildCostModifier:1.2,technologyEffect:{technology:"PV",marketModifier:.9}},"\u0142\xf3dzkie"),new b("env_8","\u015amiertelno\u015b\u0107 ptak\xf3w","Aktywi\u015bci zaskar\u017cyli dewelopera za zabijanie chronionych gatunk\xf3w ptak\xf3w przez turbiny wiatrowe.",90,{permitTimeModifier:1.3,reputationChange:-3,technologyEffect:{technology:"WF",marketModifier:.85}},"warmi\u0144sko-mazurskie"),new b("env_9","Odkrycie cennego gatunku","W wojew\xf3dztwie lubelskim odkryto rzadki gatunek ro\u015blin, co komplikuje projekty OZE w regionie.",150,{regionalEffect:{permitTimeModifier:1.4}},"lubelskie"),new b("env_10","Degradacja \u015brodowiska","Wycinka 50 ha lasu pod farm\u0119 PV wywo\u0142a\u0142a skandal ekologiczny.",75,{permitTimeModifier:1.5,reputationChange:-5,technologyEffect:{technology:"PV",marketModifier:.8}})],T=[new j("tech_1","Prze\u0142om w wydajno\u015bci paneli PV","Naukowcy opracowali now\u0105 technologi\u0119 zwi\u0119kszaj\u0105c\u0105 wydajno\u015b\u0107 paneli fotowoltaicznych o 25%.",150,{technologyEffect:{technology:"PV",buildCostModifier:.9,marketModifier:1.15}},"PV"),new j("tech_2","Nowa generacja turbin wiatrowych","Na rynek wesz\u0142a nowa generacja turbin wiatrowych o lepszej wydajno\u015bci i ni\u017cszej emisji ha\u0142asu.",180,{technologyEffect:{technology:"WF",buildCostModifier:.85,marketModifier:1.2}},"WF"),new j("tech_3","Innowacje w magazynach energii","Prze\u0142omowe innowacje w technologii magazyn\xf3w energii zwi\u0119kszaj\u0105 ich op\u0142acalno\u015b\u0107.",120,{technologyEffect:{technology:"BESS",buildCostModifier:.8,marketModifier:1.3}},"BESS"),new j("tech_4","Problemy jako\u015bciowe z chi\u0144skimi panelami","Wykryto problemy jako\u015bciowe w panelach fotowoltaicznych importowanych z Chin.",90,{technologyEffect:{technology:"PV",buildCostModifier:1.15,marketModifier:.9}},"PV"),new j("tech_5","Nowy system prognozowania wiatru","Opracowano nowy system prognozowania wiatru, zwi\u0119kszaj\u0105cy efektywno\u015b\u0107 farm wiatrowych.",100,{technologyEffect:{technology:"WF",marketModifier:1.1}},"WF"),new j("tech_6","Innowacyjne trackery PV","Nowe systemy \u015bledzenia s\u0142o\u0144ca zwi\u0119kszaj\u0105 wydajno\u015b\u0107 paneli fotowoltaicznych o 25%.",180,{technologyEffect:{technology:"PV",buildCostModifier:.85,marketModifier:1.2}}),new j("tech_7","Hybrydyzacja OZE","Po\u0142\u0105czenie PV z wiatrem redukuje LCOE o 18%, zwi\u0119kszaj\u0105c op\u0142acalno\u015b\u0107 projekt\xf3w.",150,{buildCostModifier:.9,marketModifier:1.15}),new j("tech_8","Optymalizacja BESS","Nowe algorytmy zarz\u0105dzania zmniejszaj\u0105 straty energii w magazynach o 12%.",120,{technologyEffect:{technology:"BESS",marketModifier:1.25}}),new j("tech_9","Partnerstwo z Google","Wdro\u017cenie AI do prognozowania produkcji energii zwi\u0119ksza efektywno\u015b\u0107 zarz\u0105dzania farmami.",90,{marketModifier:1.1}),new j("tech_10","Awaria technologii","Magazyn BESS eksplodowa\u0142 z powodu b\u0142\u0119d\xf3w projektowych, wywo\u0142uj\u0105c obawy inwestor\xf3w.",60,{technologyEffect:{technology:"BESS",marketModifier:.75,buildCostModifier:1.3},severity:"negative"})];class C extends g{constructor(e,t,n,i,a,r){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;super(e,t,n,i,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null),this.type="local",this.effects=a,this.region=r,this.county=s}getEffect(){const e={...this.effects};return this.region&&(e.regionalEffect={region:this.region,...e.regionalEffect}),this.county&&(e.countyEffect={region:this.region,county:this.county,...e.countyEffect}),e}}const P=[new C("local_1","Modernizacja infrastruktury","Deweloperzy finansuj\u0105 remont dr\xf3g dojazdowych w gminie, zwi\u0119kszaj\u0105c przychylno\u015b\u0107 mieszka\u0144c\xf3w.",90,{permitTimeModifier:.8,reputationChange:3},"ma\u0142opolskie","krakowski"),new C("local_2","Wzrost przychod\xf3w gminy","Dodatkowe 500 000 z\u0142/rok z podatk\xf3w od farmy 20 MW zwi\u0119kszy\u0142o poparcie lokalnych w\u0142adz.",120,{permitTimeModifier:.7,reputationChange:4},"mazowieckie","p\u0142ocki"),new C("local_3","Projekty spo\u0142eczne","Budowa \u015bwietlicy i si\u0142owni plenerowej w zamian za zgod\u0119 na inwestycj\u0119 OZE.",180,{permitTimeModifier:.75,reputationChange:5},"podlaskie","bia\u0142ostocki"),new C("local_4","Klastry energii","Gminy \u0142\u0105cz\u0105 si\u0119 w lokalny system energetyczny, zwi\u0119kszaj\u0105c mo\u017cliwo\u015bci przy\u0142\u0105czeniowe.",150,{permitTimeModifier:.85,buildCostModifier:.9},"\u015bl\u0105skie","cz\u0119stochowski"),new C("local_5","Konflikty o grunty","W\u0142a\u015bciciele ziemi \u017c\u0105daj\u0105 podwy\u017cek czynszu o 300%, co utrudnia pozyskiwanie grunt\xf3w.",60,{buildCostModifier:1.3,permitTimeModifier:1.2},"wielkopolskie","pozna\u0144ski"),new C("local_6","Brak przy\u0142\u0105czy","Operator odmawia pod\u0142\u0105czenia farmy z powodu przeci\u0105\u017cenia sieci w regionie.",90,{permitTimeModifier:1.5},"\u0142\xf3dzkie","\u0142\xf3dzki wschodni"),new C("local_7","Spadek warto\u015bci nieruchomo\u015bci","Domy w pobli\u017cu farmy wiatrowej straci\u0142y 20% warto\u015bci, wywo\u0142uj\u0105c protesty mieszka\u0144c\xf3w.",75,{permitTimeModifier:1.3,reputationChange:-4},"pomorskie","s\u0142upski")];class I extends g{constructor(e,t,n,i,a){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;super(e,t,n,i,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null),this.type="project",this.effects=a,this.technology=r}getEffect(){const e={...this.effects};return this.technology&&(e.technologyEffect={technology:this.technology,...e.technologyEffect}),e}}const A=[new I("proj_1","Finansowanie z UE","Uzyskano grant 15 mln z\u0142 z Funduszu Sp\xf3jno\u015bci na budow\u0119 magazynu energii.",90,{buildCostModifier:.7,technologyEffect:{marketModifier:1.2}},"BESS"),new I("proj_2","Digital Twin","Cyfrowy model farmy zmniejsza ryzyko awarii o 40%, zwi\u0119kszaj\u0105c warto\u015b\u0107 projektu.",120,{marketModifier:1.15},"PV"),new I("proj_3","Certyfikat ESG","Uzyskanie ratingu AA+ przyci\u0105ga inwestor\xf3w i zwi\u0119ksza warto\u015b\u0107 projektu.",150,{marketModifier:1.2,reputationChange:3}),new I("proj_4","Recykling na miejscu","Mobilne zak\u0142ady przetwarzania zu\u017cytych paneli zwi\u0119kszaj\u0105 ekologiczno\u015b\u0107 projektu.",180,{marketModifier:1.1,reputationChange:4},"PV"),new I("proj_5","Op\xf3\u017anienie pozwole\u0144","Decyzja \u015brodowiskowa przeci\u0105ga si\u0119 o 18 miesi\u0119cy z powodu protest\xf3w ekolog\xf3w.",90,{permitTimeModifier:1.6}),new I("proj_6","Bank wycofuje finansowanie","Podwy\u017cka st\xf3p procentowych spowodowa\u0142a wycofanie si\u0119 banku z finansowania projektu.",60,{marketModifier:.8,buildCostModifier:1.2}),new I("proj_7","Wzrost sk\u0142adek ubezpieczeniowych","Po huraganie koszt polisy dla farm PV wzr\xf3s\u0142 o 200%.",120,{buildCostModifier:1.15},"PV")],M=[new v("land_war","Wojna surowcowa","Rolnicy masowo wstrzymuj\u0105 sprzeda\u017c ziemi z powodu rosn\u0105cych cen \u017cywno\u015bci. Zd\u0105\u017cysz pozyska\u0107 grunty przed kolejn\u0105 podwy\u017ck\u0105?",90,{leaseRate:1.3,projectType:"all",description:"Koszt dzier\u017cawy wzr\xf3s\u0142 o 30% w tym regionie"})],D=[...z,..._,...E,...S,...T,...P,...A,...M],R=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=[...D];if(e&&(t=t.filter((t=>t.type===e))),0===t.length)return null;return t[Math.floor(Math.random()*t.length)]},O=e=>{if(!e.effects)return"info";let t=0;return e.effects.marketModifier&&(t+=10*(e.effects.marketModifier-1)),e.effects.reputationChange&&(t+=e.effects.reputationChange/5),e.effects.permitTimeModifier&&(t-=10*(e.effects.permitTimeModifier-1)),e.effects.buildCostModifier&&(t-=10*(e.effects.buildCostModifier-1)),e.effects.riskLevel&&(t-=e.effects.riskLevel),e.effects.grayAreaImpact&&(t-=e.effects.grayAreaImpact/5),t>2?"positive":t<-2?"negative":t<-.5||t>.5?"warning":"info"},L=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const a=[],r=i?i.turn:null,s=(i?i.date:new Date,i&&i.day,{});return Object.entries({economic:.3,political:.25,social:.28,environmental:.27,technological:.24,local:.35,project:.3}).forEach((e=>{let[t,i]=e;s[t]=1-Math.pow(1-i,1/n)})),e&&Object.entries(e).forEach((e=>{let[t,n]=e;void 0!==s[t]&&(s[t]*=n)})),Object.entries(s).forEach((e=>{let[i,s]=e;for(let o=0;o<n;o++)if(Math.random()<s){const e=R(i);if(e){const n=new Date;if(e.effects&&(e.effects=f(e.effects)),a.push(e.activate(n)),t){const n={id:e.id||Date.now()+Math.random(),type:e.type,title:e.name,description:e.description,severity:O(e),turn:r||(new Date).getTime(),expires:r?r+Math.ceil(e.duration/2):Math.ceil(e.duration/2)};e.effects&&(n.effects={...e.effects}),e.region?(n.region=e.region,n.scope="regional"):n.scope="national",e.technology&&(n.technology=e.technology),e.projectType&&(n.projectType=e.projectType);Math.random()<.2&&(n.requiresDecision=!0,n.severity="special",n.decisions=[{id:"option1",label:"Opcja 1",effects:{reputationImpact:5}},{id:"option2",label:"Opcja 2",effects:{cashImpact:1e4}}]),t({type:"ADD_EVENT",payload:n})}}}})),a};F=new x("corruption_discovery","Korupcja w urz\u0119dzie","Tw\xf3j pracownik odkry\u0142 dowody na korupcj\u0119 w lokalnym urz\u0119dzie przy wydawaniu pozwole\u0144 dla OZE. Co zrobisz?",30,{decisions:[{id:"report",label:"Zg\u0142o\u015b spraw\u0119",reputation:10,permitTimeModifier:1.3},{id:"bribe",label:"Wykorzystaj sytuacj\u0119",reputation:-20,permitTimeModifier:.6,riskLevel:.7},{id:"ignore",label:"Zignoruj spraw\u0119",reputation:-5}]}),U={report:[new k("media_exposure","Sprawa w mediach","Twoje zg\u0142oszenie doprowadzi\u0142o do medialnego rozg\u0142osu wok\xf3\u0142 korupcji. Jeste\u015b postrzegany jako etyczna firma w bran\u017cy.",120,{reputationChange:15,marketAdvantage:.05,competitorRelations:-.1}),new w("investigation_started","Dochodzenie antykorupcyjne","CBA wszcz\u0119\u0142o dochodzenie w sprawie korupcji w urz\u0119dzie. Wszystkie pozwolenia s\u0105 teraz dok\u0142adniej sprawdzane.",180,{permitTimeModifier:1.2,permitSuccess:1.1})],bribe:[new C("expedited_permits","Przyspieszone pozwolenia","Twoje projekty otrzymuj\u0105 szybk\u0105 \u015bcie\u017ck\u0119, ale dzia\u0142asz na granicy prawa.",90,{permitTimeModifier:.5,riskEventChance:.3}),new class extends g{constructor(e,t,n,i,a){super(e,t,n,i,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="risk",this.effects=a}getEffect(){return this.effects}}("corruption_investigation","Dochodzenie antykorupcyjne","Twoje nieetyczne dzia\u0142ania wysz\u0142y na jaw. Firma stoi w obliczu powa\u017cnych konsekwencji prawnych.",null,{reputationChange:-50,legalFees:1e6,permitBlock:!0,projectFreeze:!0},.4)],ignore:[new class extends g{constructor(e,t,n,i,a){super(e,t,n,i,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="industry",this.effects=a}getEffect(){return this.effects}}("industry_perception","Z\u0142a reputacja bran\u017cy","Korupcja w bran\u017cy OZE nasila si\u0119. Spo\u0142ecze\u0144stwo coraz bardziej sceptycznie podchodzi do nowych projekt\xf3w.",365,{socialAcceptance:-.1,permitDifficulty:1.1})]};var F,U;new class extends g{constructor(e,t,n,i,a){super(e,t,n,null),this.type="dilemma",this.options=i,this.consequences=a,this.decisionMade=!1}makeDecision(e,t){if(this.decisionMade)return null;this.decisionMade=!0;this.options.find((t=>t.id===e));return t.playerDecisions.push({dilemmaId:this.id,decision:e,turn:t.turn}),this.consequences[e]}}("wetlands_project","Projekt na terenach podmok\u0142ych","Znalaz\u0142e\u015b idealn\u0105 lokalizacj\u0119 na farm\u0119 wiatrow\u0105, ale jest to cenny ekosystem podmok\u0142y, dom dla wielu rzadkich gatunk\xf3w. Eksperci \u015brodowiskowi apeluj\u0105 o ochron\u0119 tego terenu.",[{id:"protect",label:"Zrezygnuj z projektu i chro\u0144 ekosystem",description:"Zyskasz uznanie ekolog\xf3w, ale stracisz doskona\u0142\u0105 lokalizacj\u0119 biznesow\u0105."},{id:"relocate",label:"Zmodyfikuj projekt, by zminimalizowa\u0107 wp\u0142yw",description:"Kompromisowe rozwi\u0105zanie z mniejszym zyskiem, ale zachowaniem cz\u0119\u015bci ekosystemu."},{id:"develop",label:"Kontynuuj projekt zgodnie z planem",description:"Maksymalizuj zyski, ignoruj\u0105c sprzeciw ekolog\xf3w."}],{protect:{reputationChange:25,environmentalScore:30,investmentLoss:2e5,permitsEase:1.2,followUpEvents:["eco_partnership_offer"]},relocate:{reputationChange:10,environmentalScore:15,projectEfficiency:.85,investmentIncrease:15e4,permitsEase:1.05},develop:{reputationChange:-20,environmentalScore:-25,projectEfficiency:1,permitRisk:.4,followUpEvents:["eco_protest_campaign","media_backlash"]}});new class{constructor(e,t,n,i,a){this.id=e,this.name=t,this.description=n,this.trigger=i,this.stages=a,this.currentStage=0,this.isActive=!1,this.isCompleted=!1}checkTrigger(e,t){if(this.isActive||this.isCompleted)return!1;return!!this.trigger(e,t)&&(this.isActive=!0,this.stages[0])}progressToNextStage(e){return!this.isActive||this.isCompleted?null:(this.currentStage++,this.currentStage>=this.stages.length?(this.isCompleted=!0,this.isActive=!1,null):this.stages[this.currentStage])}}("green_revolution","Zielona Rewolucja Energetyczna","Seria wydarze\u0144 zwi\u0105zanych z prze\u0142omem w polityce energetycznej kraju.",((e,t)=>t.operationalProjects>=5&&e.turn>50),[new w("energy_policy_shift","Zmiana polityki energetycznej","Rz\u0105d og\u0142asza ambitny plan transformacji energetycznej z naciskiem na OZE. To mo\u017ce by\u0107 szansa dla Twojej firmy.",180,{marketGrowth:.2,subsidiesIncrease:.15,publicOpinion:20}),new k("public_debate","Debata publiczna o OZE","W ca\u0142ym kraju toczy si\u0119 intensywna debata o przysz\u0142o\u015bci energetyki. Tw\xf3j g\u0142os mo\u017ce by\u0107 znacz\u0105cy.",90,{decision:[{id:"advocate",label:"Aktywnie wspieraj zmiany",effect:{publicVisibility:.3,politicalInfluence:.2,cost:5e5}},{id:"neutral",label:"Zachowaj neutralno\u015b\u0107",effect:{}}]}),new v("investment_boom","Boom inwestycyjny w OZE","Banki i fundusze inwestycyjne masowo kieruj\u0105 kapita\u0142 w stron\u0119 zielonej energii.",365,{financingCost:.8,investorInterest:.4,competitionIntensity:1.3}),new N("new_regulations","Nowe regulacje OZE","Parlament przyj\u0105\u0142 pakiet ustaw znacz\u0105co upraszczaj\u0105cych procedury dla projekt\xf3w odnawialnych.",730,{permitTime:.6,gridConnectionEase:1.4,complianceRequirements:["Konieczno\u015b\u0107 certyfikacji zr\xf3wnowa\u017conego rozwoju","Obowi\u0105zkowy udzia\u0142 spo\u0142eczno\u015bci lokalnej w zyskach","Roczne audyty \u015brodowiskowe"]}),new class extends g{constructor(e,t,n,i,a){super(e,t,n,i,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="market",this.effects=a}getEffect(){return this.effects}}("market_maturity","Dojrza\u0142o\u015b\u0107 rynku OZE","Polski rynek OZE osi\u0105gn\u0105\u0142 dojrza\u0142o\u015b\u0107. Konkurencja jest intensywna, ale stabilne zasady gry tworz\u0105 przewidywalne \u015brodowisko biznesowe.",null,{marketStability:.4,profitMargins:.85,innovationPremium:.25})]);const V=(0,i.createContext)(),$={events:[{id:"initial-event-1",type:"economic_event",title:"Pocz\u0105tek dzia\u0142alno\u015bci",description:"Rozpoczynasz swoj\u0105 przygod\u0119 w sektorze OZE. Powodzenia!",severity:"positive",turn:1,expires:10},{id:"initial-event-2",type:"staff_event",title:"Zatrudnienie pierwszych pracownik\xf3w",description:"Czas zbudowa\u0107 zesp\xf3\u0142, kt\xf3ry b\u0119dzie realizowa\u0142 Twoje projekty.",severity:"info",turn:1,expires:8},{id:"initial-event-3",type:"project_event",title:"Rynek OZE w Polsce",description:"Rynek OZE w Polsce dynamicznie si\u0119 rozwija. To dobry moment na inwestycje.",severity:"info",turn:1,expires:12}],filters:{type:"all",severity:"all",staffId:null,projectId:null}};function B(e,t){switch(t.type){case"ADD_EVENT":{let n=[...e.events];if(n.length>=20&&(n.sort(((e,t)=>"info"===e.severity&&"info"!==t.severity?-1:"info"!==e.severity&&"info"===t.severity?1:e.turn-t.turn)),n.shift()),"info"===t.payload.severity){if(n.filter((e=>"info"===e.severity)).length>=5){const e=n.findIndex((e=>"info"===e.severity));-1!==e&&n.splice(e,1)}}if("staff_event"===(t.payload.type||"other")){if(n.filter((e=>"staff_event"===e.type)).length>=3){const e=n.findIndex((e=>"staff_event"===e.type));-1!==e&&n.splice(e,1)}}return{...e,events:[...n,t.payload]}}case"REMOVE_EVENT":return{...e,events:e.events.filter((e=>e.id!==t.payload))};case"CLEAR_EXPIRED_EVENTS":return{...e,events:e.events.filter((e=>!e.expires||e.expires>t.payload.currentTurn))};case"SET_FILTER":return{...e,filters:{...e.filters,[t.payload.filterType]:t.payload.value}};case"CLEAR_FILTERS":return{...e,filters:{type:"all",severity:"all",staffId:null,projectId:null}};case"LIMIT_EVENTS":{let t=[...e.events];t.length>20&&(t.sort(((e,t)=>"project_event"===e.type&&"project_event"!==t.type?1:"project_event"!==e.type&&"project_event"===t.type||"staff_event"===e.type&&"staff_event"!==t.type?-1:"staff_event"!==e.type&&"staff_event"===t.type?1:"info"===e.severity&&"info"!==t.severity?-1:"info"!==e.severity&&"info"===t.severity?1:e.turn-t.turn)),t=t.slice(t.length-20));const n=t.filter((e=>"info"===e.severity));if(n.length>5){n.sort(((e,t)=>e.turn-t.turn));const e=n.slice(0,n.length-5).map((e=>e.id));t=t.filter((t=>!("info"===t.severity&&e.includes(t.id))))}const i=t.filter((e=>"staff_event"===e.type));if(i.length>3){i.sort(((e,t)=>e.turn-t.turn));const e=new Set(i.slice(0,i.length-3).map((e=>e.id)));t=t.filter((t=>"staff_event"!==t.type||!e.has(t.id)))}return{...e,events:t}}default:return e}}function W(e){let{children:t}=e;const[n,a]=(0,i.useReducer)(B,$);return(0,r.jsx)(V.Provider,{value:{state:n,dispatch:a},children:t})}function q(){const e=(0,i.useContext)(V);if(!e)throw new Error("useEventsContext must be used within an EventsProvider");return e}const H=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let a=e.charCodeAt(i);a<128?t[n++]=a:a<2048?(t[n++]=a>>6|192,t[n++]=63&a|128):55296===(64512&a)&&i+1<e.length&&56320===(64512&e.charCodeAt(i+1))?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++i)),t[n++]=a>>18|240,t[n++]=a>>12&63|128,t[n++]=a>>6&63|128,t[n++]=63&a|128):(t[n++]=a>>12|224,t[n++]=a>>6&63|128,t[n++]=63&a|128)}return t},G={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let a=0;a<e.length;a+=3){const t=e[a],r=a+1<e.length,s=r?e[a+1]:0,o=a+2<e.length,l=o?e[a+2]:0,c=t>>2,d=(3&t)<<4|s>>4;let u=(15&s)<<2|l>>6,h=63&l;o||(h=64,r||(u=64)),i.push(n[c],n[d],n[u],n[h])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(H(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,i=0;for(;n<e.length;){const a=e[n++];if(a<128)t[i++]=String.fromCharCode(a);else if(a>191&&a<224){const r=e[n++];t[i++]=String.fromCharCode((31&a)<<6|63&r)}else if(a>239&&a<365){const r=((7&a)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[i++]=String.fromCharCode(55296+(r>>10)),t[i++]=String.fromCharCode(56320+(1023&r))}else{const r=e[n++],s=e[n++];t[i++]=String.fromCharCode((15&a)<<12|(63&r)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let a=0;a<e.length;){const t=n[e.charAt(a++)],r=a<e.length?n[e.charAt(a)]:0;++a;const s=a<e.length?n[e.charAt(a)]:64;++a;const o=a<e.length?n[e.charAt(a)]:64;if(++a,null==t||null==r||null==s||null==o)throw new K;const l=t<<2|r>>4;if(i.push(l),64!==s){const e=r<<4&240|s>>2;if(i.push(e),64!==o){const e=s<<6&192|o;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class K extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Q=function(e){return function(e){const t=H(e);return G.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Z=function(e){try{return G.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};const Y=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,J=()=>{try{return Y()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/oze-developer-manager",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_NODE_ENV:"development"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&Z(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},X=e=>{var t,n;return null===(n=null===(t=J())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},ee=()=>{var e;return null===(e=J())||void 0===e?void 0:e.config},te=e=>{var t;return null===(t=J())||void 0===t?void 0:t[`_${e}`]};class ne{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function ie(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function ae(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function re(){return!function(){var e;const t=null===(e=J())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(i){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function se(){try{return"object"===typeof indexedDB}catch(e){return!1}}function oe(){return new Promise(((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(i);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{var e;t((null===(e=a.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}))}class le extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,le.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ce.prototype.create)}}class ce{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,i=this.errors[e],a=i?function(e,t){return e.replace(de,((e,n)=>{const i=t[n];return null!=i?String(i):`<${n}?>`}))}(i,t):"Error",r=`${this.serviceName}: ${a} (${n}).`;return new le(n,r,t)}}const de=/\{\$([^}]+)}/g;function ue(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const a of n){if(!i.includes(a))return!1;const n=e[a],r=t[a];if(he(n)&&he(r)){if(!ue(n,r))return!1}else if(n!==r)return!1}for(const a of i)if(!n.includes(a))return!1;return!0}function he(e){return null!==e&&"object"===typeof e}function pe(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function me(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,i]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(i)}})),t}function fe(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class ye{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=ge),void 0===i.error&&(i.error=ge),void 0===i.complete&&(i.complete=ge);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(e){}})),this.observers.push(i),a}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function ge(){}function ve(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3)*Math.pow(t,e),i=Math.round(.5*n*(Math.random()-.5)*2);return Math.min(144e5,n+i)}function we(e){return e&&e._delegate?e._delegate:e}class xe{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const be="[DEFAULT]";class je{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new ne;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),i=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:be})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:i});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[a,r]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(a)&&r.resolve(i)}return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),a=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;a.add(e),this.onInitCallbacks.set(i,a);const r=this.instances.get(i);return r&&e(r,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const a of n)try{a(e,t)}catch(i){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(a=t,a===be?void 0:a),options:n}),this.instances.set(t,i),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch(r){}var a;return i||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be;return this.component?this.component.multipleInstances?e:be:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class ke{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new je(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const Ne=[];var ze;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(ze||(ze={}));const _e={debug:ze.DEBUG,verbose:ze.VERBOSE,info:ze.INFO,warn:ze.WARN,error:ze.ERROR,silent:ze.SILENT},Ee=ze.INFO,Se={[ze.DEBUG]:"log",[ze.VERBOSE]:"log",[ze.INFO]:"info",[ze.WARN]:"warn",[ze.ERROR]:"error"},Te=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),i=Se[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var a=arguments.length,r=new Array(a>2?a-2:0),s=2;s<a;s++)r[s-2]=arguments[s];console[i](`[${n}]  ${e.name}:`,...r)};class Ce{constructor(e){this.name=e,this._logLevel=Ee,this._logHandler=Te,this._userLogHandler=null,Ne.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ze))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?_e[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ze.DEBUG,...t),this._logHandler(this,ze.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ze.VERBOSE,...t),this._logHandler(this,ze.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ze.INFO,...t),this._logHandler(this,ze.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ze.WARN,...t),this._logHandler(this,ze.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ze.ERROR,...t),this._logHandler(this,ze.ERROR,...t)}}let Pe,Ie;const Ae=new WeakMap,Me=new WeakMap,De=new WeakMap,Re=new WeakMap,Oe=new WeakMap;let Le={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Me.get(e);if("objectStoreNames"===t)return e.objectStoreNames||De.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ve(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Fe(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Ie||(Ie=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.apply($e(this),n),Ve(Ae.get(this))}:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return Ve(e.apply($e(this),n))}:function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];const r=e.call($e(this),t,...i);return De.set(r,t.sort?t.sort():[t]),Ve(r)}}function Ue(e){return"function"===typeof e?Fe(e):(e instanceof IDBTransaction&&function(e){if(Me.has(e))return;const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",r),e.removeEventListener("abort",r)},a=()=>{t(),i()},r=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",a),e.addEventListener("error",r),e.addEventListener("abort",r)}));Me.set(e,t)}(e),t=e,(Pe||(Pe=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,Le):e);var t}function Ve(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("success",a),e.removeEventListener("error",r)},a=()=>{t(Ve(e.result)),i()},r=()=>{n(e.error),i()};e.addEventListener("success",a),e.addEventListener("error",r)}));return t.then((t=>{t instanceof IDBCursor&&Ae.set(t,e)})).catch((()=>{})),Oe.set(t,e),t}(e);if(Re.has(e))return Re.get(e);const t=Ue(e);return t!==e&&(Re.set(e,t),Oe.set(t,e)),t}const $e=e=>Oe.get(e);function Be(e,t){let{blocked:n,upgrade:i,blocking:a,terminated:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=indexedDB.open(e,t),o=Ve(s);return i&&s.addEventListener("upgradeneeded",(e=>{i(Ve(s.result),e.oldVersion,e.newVersion,Ve(s.transaction),e)})),n&&s.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),o.then((e=>{r&&e.addEventListener("close",(()=>r())),a&&e.addEventListener("versionchange",(e=>a(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}const We=["get","getKey","getAll","getAllKeys","count"],qe=["put","add","delete","clear"],He=new Map;function Ge(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(He.get(t))return He.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,a=qe.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!a&&!We.includes(n))return;const r=async function(e){const t=this.transaction(e,a?"readwrite":"readonly");let r=t.store;for(var s=arguments.length,o=new Array(s>1?s-1:0),l=1;l<s;l++)o[l-1]=arguments[l];return i&&(r=r.index(o.shift())),(await Promise.all([r[n](...o),a&&t.done]))[0]};return He.set(t,r),r}Le=(e=>({...e,get:(t,n,i)=>Ge(t,n)||e.get(t,n,i),has:(t,n)=>!!Ge(t,n)||e.has(t,n)}))(Le);class Ke{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const Qe="@firebase/app",Ze="0.10.13",Ye=new Ce("@firebase/app"),Je="@firebase/app-compat",Xe="@firebase/analytics-compat",et="@firebase/analytics",tt="@firebase/app-check-compat",nt="@firebase/app-check",it="@firebase/auth",at="@firebase/auth-compat",rt="@firebase/database",st="@firebase/data-connect",ot="@firebase/database-compat",lt="@firebase/functions",ct="@firebase/functions-compat",dt="@firebase/installations",ut="@firebase/installations-compat",ht="@firebase/messaging",pt="@firebase/messaging-compat",mt="@firebase/performance",ft="@firebase/performance-compat",yt="@firebase/remote-config",gt="@firebase/remote-config-compat",vt="@firebase/storage",wt="@firebase/storage-compat",xt="@firebase/firestore",bt="@firebase/vertexai-preview",jt="@firebase/firestore-compat",kt="firebase",Nt="[DEFAULT]",zt={[Qe]:"fire-core",[Je]:"fire-core-compat",[et]:"fire-analytics",[Xe]:"fire-analytics-compat",[nt]:"fire-app-check",[tt]:"fire-app-check-compat",[it]:"fire-auth",[at]:"fire-auth-compat",[rt]:"fire-rtdb",[st]:"fire-data-connect",[ot]:"fire-rtdb-compat",[lt]:"fire-fn",[ct]:"fire-fn-compat",[dt]:"fire-iid",[ut]:"fire-iid-compat",[ht]:"fire-fcm",[pt]:"fire-fcm-compat",[mt]:"fire-perf",[ft]:"fire-perf-compat",[yt]:"fire-rc",[gt]:"fire-rc-compat",[vt]:"fire-gcs",[wt]:"fire-gcs-compat",[xt]:"fire-fst",[jt]:"fire-fst-compat",[bt]:"fire-vertex","fire-js":"fire-js",[kt]:"fire-js-all"},_t=new Map,Et=new Map,St=new Map;function Tt(e,t){try{e.container.addComponent(t)}catch(n){Ye.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Ct(e){const t=e.name;if(St.has(t))return Ye.debug(`There were multiple attempts to register component ${t}.`),!1;St.set(t,e);for(const n of _t.values())Tt(n,e);for(const n of Et.values())Tt(n,e);return!0}function Pt(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function It(e){return void 0!==e.settings}const At=new ce("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Mt{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new xe("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw At.create("app-deleted",{appName:this._name})}}const Dt="10.14.1";function Rt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const i=Object.assign({name:Nt,automaticDataCollectionEnabled:!1},t),a=i.name;if("string"!==typeof a||!a)throw At.create("bad-app-name",{appName:String(a)});if(n||(n=ee()),!n)throw At.create("no-options");const r=_t.get(a);if(r){if(ue(n,r.options)&&ue(i,r.config))return r;throw At.create("duplicate-app",{appName:a})}const s=new ke(a);for(const l of St.values())s.addComponent(l);const o=new Mt(n,i,s);return _t.set(a,o),o}function Ot(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nt;const t=_t.get(e);if(!t&&e===Nt&&ee())return Rt();if(!t)throw At.create("no-app",{appName:e});return t}function Lt(e,t,n){var i;let a=null!==(i=zt[e])&&void 0!==i?i:e;n&&(a+=`-${n}`);const r=a.match(/\s|\//),s=t.match(/\s|\//);if(r||s){const e=[`Unable to register library "${a}" with version "${t}":`];return r&&e.push(`library name "${a}" contains illegal characters (whitespace or "/")`),r&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Ye.warn(e.join(" "))}Ct(new xe(`${a}-version`,(()=>({library:a,version:t})),"VERSION"))}const Ft="firebase-heartbeat-store";let Ut=null;function Vt(){return Ut||(Ut=Be("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Ft)}catch(n){console.warn(n)}}}).catch((e=>{throw At.create("idb-open",{originalErrorMessage:e.message})}))),Ut}async function $t(e,t){try{const n=(await Vt()).transaction(Ft,"readwrite"),i=n.objectStore(Ft);await i.put(t,Bt(e)),await n.done}catch(n){if(n instanceof le)Ye.warn(n.message);else{const e=At.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});Ye.warn(e.message)}}}function Bt(e){return`${e.name}!${e.options.appId}`}class Wt{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Ht(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=qt();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some((e=>e.date===i)))return;return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}catch(n){Ye.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=qt(),{heartbeatsToSend:n,unsentEntries:i}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let i=e.slice();for(const a of e){const e=n.find((e=>e.agent===a.agent));if(e){if(e.dates.push(a.date),Gt(n)>t){e.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),Gt(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),a=Q(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return Ye.warn(t),""}}}function qt(){return(new Date).toISOString().substring(0,10)}class Ht{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!se()&&oe().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await Vt()).transaction(Ft),n=await t.objectStore(Ft).get(Bt(e));return await t.done,n}catch(t){if(t instanceof le)Ye.warn(t.message);else{const e=At.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});Ye.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return $t(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return $t(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Gt(e){return Q(JSON.stringify({version:2,heartbeats:e})).length}var Kt;Kt="",Ct(new xe("platform-logger",(e=>new Ke(e)),"PRIVATE")),Ct(new xe("heartbeat",(e=>new Wt(e)),"PRIVATE")),Lt(Qe,Ze,Kt),Lt(Qe,Ze,"esm2017"),Lt("fire-js","");Lt("firebase","10.14.1","app");function Qt(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function Zt(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Yt=Zt,Jt=new ce("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Xt=new Ce("@firebase/auth");function en(e){if(Xt.logLevel<=ze.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];Xt.error(`Auth (${Dt}): ${e}`,...n)}}function tn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];throw sn(e,...n)}function nn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return sn(e,...n)}function an(e,t,n){const i=Object.assign(Object.assign({},Yt()),{[t]:n});return new ce("auth","Firebase",i).create(t,{appName:e.name})}function rn(e){return an(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function sn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if("string"!==typeof e){const t=n[0],i=[...n.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(t,...i)}return Jt.create(e,...n)}function on(e,t){if(!e){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];throw sn(t,...i)}}function ln(e){const t="INTERNAL ASSERTION FAILED: "+e;throw en(t),new Error(t)}function cn(e,t){e||ln(t)}function dn(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function un(){return"http:"===hn()||"https:"===hn()}function hn(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class pn{constructor(e,t){this.shortDelay=e,this.longDelay=t,cn(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ie())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(un()||ae()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function mn(e,t){cn(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class fn{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void ln("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void ln("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void ln("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const yn={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},gn=new pn(3e4,6e4);function vn(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function wn(e,t,n,i){return xn(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let a={},r={};i&&("GET"===t?r=i:a={body:JSON.stringify(i)});const s=pe(Object.assign({key:e.config.apiKey},r)).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:o},a);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),fn.fetch()(jn(e,e.config.apiHost,n,s),l)}))}async function xn(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},yn),t);try{const t=new Nn(e),a=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const r=await a.json();if("needConfirmation"in r)throw zn(e,"account-exists-with-different-credential",r);if(a.ok&&!("errorMessage"in r))return r;{const t=a.ok?r.errorMessage:r.error.message,[n,s]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw zn(e,"credential-already-in-use",r);if("EMAIL_EXISTS"===n)throw zn(e,"email-already-in-use",r);if("USER_DISABLED"===n)throw zn(e,"user-disabled",r);const o=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw an(e,o,s);tn(e,o)}}catch(a){if(a instanceof le)throw a;tn(e,"network-request-failed",{message:String(a)})}}async function bn(e,t,n,i){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const r=await wn(e,t,n,i,a);return"mfaPendingCredential"in r&&tn(e,"multi-factor-auth-required",{_serverResponse:r}),r}function jn(e,t,n,i){const a=`${t}${n}?${i}`;return e.config.emulator?mn(e.config,a):`${e.config.apiScheme}://${a}`}function kn(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Nn{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(nn(this.auth,"network-request-failed"))),gn.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function zn(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const a=nn(e,t,i);return a.customData._tokenResponse=n,a}function _n(e){return void 0!==e&&void 0!==e.enterprise}class En{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return kn(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function Sn(e,t){return wn(e,"GET","/v2/recaptchaConfig",vn(e,t))}async function Tn(e,t){return wn(e,"POST","/v1/accounts:lookup",t)}function Cn(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function Pn(e){return 1e3*Number(e)}function In(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return en("JWT malformed, contained fewer than 3 sections"),null;try{const e=Z(n);return e?JSON.parse(e):(en("Failed to decode base64 JWT payload"),null)}catch(a){return en("Caught error parsing JWT payload as JSON",null===a||void 0===a?void 0:a.toString()),null}}function An(e){const t=In(e);return on(t,"internal-error"),on("undefined"!==typeof t.exp,"internal-error"),on("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Mn(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof le&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class Dn{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null===e||void 0===e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class Rn{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Cn(this.lastLoginAt),this.creationTime=Cn(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function On(e){var t;const n=e.auth,i=await e.getIdToken(),a=await Mn(e,Tn(n,{idToken:i}));on(null===a||void 0===a?void 0:a.users.length,n,"internal-error");const r=a.users[0];e._notifyReloadListener(r);const s=(null===(t=r.providerUserInfo)||void 0===t?void 0:t.length)?Ln(r.providerUserInfo):[],o=(l=e.providerData,c=s,[...l.filter((e=>!c.some((t=>t.providerId===e.providerId)))),...c]);var l,c;const d=e.isAnonymous,u=!(e.email&&r.passwordHash)&&!(null===o||void 0===o?void 0:o.length),h=!!d&&u,p={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Rn(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(e,p)}function Ln(e){return e.map((e=>{var{providerId:t}=e,n=Qt(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class Fn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){on(e.idToken,"internal-error"),on("undefined"!==typeof e.idToken,"internal-error"),on("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):An(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){on(0!==e.length,"internal-error");const t=An(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(on(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:a}=await async function(e,t){const n=await xn(e,{},(async()=>{const n=pe({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:a}=e.config,r=jn(e,i,"/v1/token",`key=${a}`),s=await e._getAdditionalHeaders();return s["Content-Type"]="application/x-www-form-urlencoded",fn.fetch()(r,{method:"POST",headers:s,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:a}=t,r=new Fn;return n&&(on("string"===typeof n,"internal-error",{appName:e}),r.refreshToken=n),i&&(on("string"===typeof i,"internal-error",{appName:e}),r.accessToken=i),a&&(on("number"===typeof a,"internal-error",{appName:e}),r.expirationTime=a),r}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Fn,this.toJSON())}_performRefresh(){return ln("not implemented")}}function Un(e,t){on("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class Vn{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,a=Qt(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Dn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Rn(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await Mn(this,this.stsTokenManager.getToken(this.auth,e));return on(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=we(e),i=await n.getIdToken(t),a=In(i);on(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const r="object"===typeof a.firebase?a.firebase:void 0,s=null===r||void 0===r?void 0:r.sign_in_provider;return{claims:a,token:i,authTime:Cn(Pn(a.auth_time)),issuedAtTime:Cn(Pn(a.iat)),expirationTime:Cn(Pn(a.exp)),signInProvider:s||null,signInSecondFactor:(null===r||void 0===r?void 0:r.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=we(e);await On(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(on(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Vn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){on(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await On(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(It(this.auth.app))return Promise.reject(rn(this.auth));const e=await this.getIdToken();return await Mn(this,async function(e,t){return wn(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,a,r,s,o,l,c;const d=null!==(n=t.displayName)&&void 0!==n?n:void 0,u=null!==(i=t.email)&&void 0!==i?i:void 0,h=null!==(a=t.phoneNumber)&&void 0!==a?a:void 0,p=null!==(r=t.photoURL)&&void 0!==r?r:void 0,m=null!==(s=t.tenantId)&&void 0!==s?s:void 0,f=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,y=null!==(l=t.createdAt)&&void 0!==l?l:void 0,g=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:w,isAnonymous:x,providerData:b,stsTokenManager:j}=t;on(v&&j,e,"internal-error");const k=Fn.fromJSON(this.name,j);on("string"===typeof v,e,"internal-error"),Un(d,e.name),Un(u,e.name),on("boolean"===typeof w,e,"internal-error"),on("boolean"===typeof x,e,"internal-error"),Un(h,e.name),Un(p,e.name),Un(m,e.name),Un(f,e.name),Un(y,e.name),Un(g,e.name);const N=new Vn({uid:v,auth:e,email:u,emailVerified:w,displayName:d,isAnonymous:x,photoURL:p,phoneNumber:h,tenantId:m,stsTokenManager:k,createdAt:y,lastLoginAt:g});return b&&Array.isArray(b)&&(N.providerData=b.map((e=>Object.assign({},e)))),f&&(N._redirectEventId=f),N}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=new Fn;i.updateFromServerResponse(t);const a=new Vn({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await On(a),a}static async _fromGetAccountInfoResponse(e,t,n){const i=t.users[0];on(void 0!==i.localId,"internal-error");const a=void 0!==i.providerUserInfo?Ln(i.providerUserInfo):[],r=!(i.email&&i.passwordHash)&&!(null===a||void 0===a?void 0:a.length),s=new Fn;s.updateFromIdToken(n);const o=new Vn({uid:i.localId,auth:e,stsTokenManager:s,isAnonymous:r}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Rn(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(null===a||void 0===a?void 0:a.length)};return Object.assign(o,l),o}}const $n=new Map;function Bn(e){cn(e instanceof Function,"Expected a class definition");let t=$n.get(e);return t?(cn(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,$n.set(e,t),t)}class Wn{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Wn.type="NONE";const qn=Wn;function Hn(e,t,n){return`firebase:${e}:${t}:${n}`}class Gn{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:a}=this.auth;this.fullUserKey=Hn(this.userKey,i.apiKey,a),this.fullPersistenceKey=Hn("persistence",i.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Vn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new Gn(Bn(qn),e,n);const i=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let a=i[0]||Bn(qn);const r=Hn(n,e.config.apiKey,e.name);let s=null;for(const c of t)try{const t=await c._get(r);if(t){const n=Vn._fromJSON(e,t);c!==a&&(s=n),a=c;break}}catch(l){}const o=i.filter((e=>e._shouldAllowMigration));return a._shouldAllowMigration&&o.length?(a=o[0],s&&await a._set(r,s.toJSON()),await Promise.all(t.map((async e=>{if(e!==a)try{await e._remove(r)}catch(l){}}))),new Gn(a,e,n)):new Gn(a,e,n)}}function Kn(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Jn(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Qn(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ei(t))return"Blackberry";if(ti(t))return"Webos";if(Zn(t))return"Safari";if((t.includes("chrome/")||Yn(t))&&!t.includes("edge/"))return"Chrome";if(Xn(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function Qn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie();return/firefox\//i.test(e)}function Zn(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Yn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie();return/crios\//i.test(e)}function Jn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie();return/iemobile/i.test(e)}function Xn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie();return/android/i.test(e)}function ei(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie();return/blackberry/i.test(e)}function ti(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie();return/webos/i.test(e)}function ni(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function ii(){return function(){const e=ie();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function ai(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie();return ni(e)||Xn(e)||ti(e)||ei(e)||/windows phone/i.test(e)||Jn(e)}function ri(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Kn(ie());break;case"Worker":t=`${Kn(ie())}-${e}`;break;default:t=e}const i=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${Dt}/${i}`}class si{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,i)=>{try{n(e(t))}catch(a){i(a)}}));n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(i){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class oi{constructor(e){var t,n,i,a;const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=r.minPasswordLength)&&void 0!==t?t:6,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),void 0!==r.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),void 0!==r.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),void 0!==r.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),void 0!==r.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(a=e.forceUpgradeOnSignin)&&void 0!==a&&a,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,i,a,r,s;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(i=o.containsLowercaseLetter)||void 0===i||i),o.isValid&&(o.isValid=null===(a=o.containsUppercaseLetter)||void 0===a||a),o.isValid&&(o.isValid=null===(r=o.containsNumericCharacter)||void 0===r||r),o.isValid&&(o.isValid=null===(s=o.containsNonAlphanumericCharacter)||void 0===s||s),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class li{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new di(this),this.idTokenSubscription=new di(this),this.beforeStateQueue=new si(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Jt,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Bn(t)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Gn.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(a){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Tn(this,{idToken:e}),n=await Vn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(It(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,r=null===i||void 0===i?void 0:i._redirectEventId,s=await this.tryRedirectSignIn(e);n&&n!==r||!(null===s||void 0===s?void 0:s.user)||(i=s.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(r){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(r)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return on(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await On(e)}catch(t){if("auth/network-request-failed"!==(null===t||void 0===t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(It(this.app))return Promise.reject(rn(this));const t=e?we(e):null;return t&&on(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&on(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return It(this.app)?Promise.reject(rn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return It(this.app)?Promise.reject(rn(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(Bn(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return wn(e,"GET","/v2/passwordPolicy",vn(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new oi(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ce("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return wn(e,"POST","/v2/accounts:revokeToken",vn(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Bn(e)||this._popupRedirectResolver;on(t,this,"argument-error"),this.redirectPersistenceManager=await Gn.create(this,[Bn(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const a="function"===typeof t?t:t.next.bind(t);let r=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(on(s,this,"internal-error"),s.then((()=>{r||a(this.currentUser)})),"function"===typeof t){const a=e.addObserver(t,n,i);return()=>{r=!0,a()}}{const n=e.addObserver(t);return()=>{r=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return on(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ri(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(Xt.logLevel<=ze.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];Xt.warn(`Auth (${Dt}): ${e}`,...n)}}(`Error while retrieving App Check token: ${t.error}`),null===t||void 0===t?void 0:t.token}}function ci(e){return we(e)}class di{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new ye(e,t);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return on(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ui={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function hi(e){return ui.loadJS(e)}function pi(e){return`__${e}${Math.floor(1e6*Math.random())}`}class mi{constructor(e){this.type="recaptcha-enterprise",this.auth=ci(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,i){const a=window.grecaptcha;_n(a)?a.enterprise.ready((()=>{a.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,i)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{Sn(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new En(i);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((a=>{if(!t&&_n(window.grecaptcha))n(a,e,i);else{if("undefined"===typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));let t=ui.recaptchaEnterpriseScript;0!==t.length&&(t+=a),hi(t).then((()=>{n(a,e,i)})).catch((e=>{i(e)}))}})).catch((e=>{i(e)}))}))}}async function fi(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=new mi(e);let r;try{r=await a.verify(n)}catch(o){r=await a.verify(n,!0)}const s=Object.assign({},t);return i?Object.assign(s,{captchaResp:r}):Object.assign(s,{captchaResponse:r}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}async function yi(e,t,n,i){var a;if(null===(a=e._getRecaptchaConfig())||void 0===a?void 0:a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await fi(e,t,n,"getOobCode"===n);return i(e,a)}return i(e,t).catch((async a=>{if("auth/missing-recaptcha-token"===a.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await fi(e,t,n,"getOobCode"===n);return i(e,a)}return Promise.reject(a)}))}function gi(e,t,n){const i=ci(e);on(i._canInitEmulator,i,"emulator-config-failed"),on(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const a=!!(null===n||void 0===n?void 0:n.disableWarnings),r=vi(t),{host:s,port:o}=function(e){const t=vi(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){const e=a[1];return{host:e,port:wi(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:wi(t)}}}(t),l=null===o?"":`:${o}`;i.config.emulator={url:`${r}//${s}${l}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:s,port:o,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:a})}),a||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function vi(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function wi(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class xi{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ln("not implemented")}_getIdTokenResponse(e){return ln("not implemented")}_linkToIdToken(e,t){return ln("not implemented")}_getReauthenticationResolver(e){return ln("not implemented")}}async function bi(e,t){return wn(e,"POST","/v1/accounts:signUp",t)}async function ji(e,t){return bn(e,"POST","/v1/accounts:signInWithPassword",vn(e,t))}class ki extends xi{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new ki(e,t,"password")}static _fromEmailAndCode(e,t){return new ki(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return yi(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",ji);case"emailLink":return async function(e,t){return bn(e,"POST","/v1/accounts:signInWithEmailLink",vn(e,t))}(e,{email:this._email,oobCode:this._password});default:tn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return yi(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",bi);case"emailLink":return async function(e,t){return bn(e,"POST","/v1/accounts:signInWithEmailLink",vn(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:tn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ni(e,t){return bn(e,"POST","/v1/accounts:signInWithIdp",vn(e,t))}class zi extends xi{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new zi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):tn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,a=Qt(t,["providerId","signInMethod"]);if(!n||!i)return null;const r=new zi(n,i);return r.idToken=a.idToken||void 0,r.accessToken=a.accessToken||void 0,r.secret=a.secret,r.nonce=a.nonce,r.pendingToken=a.pendingToken||null,r}_getIdTokenResponse(e){return Ni(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ni(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ni(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=pe(t)}return e}}const _i={USER_NOT_FOUND:"user-not-found"};class Ei extends xi{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Ei({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Ei({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return bn(e,"POST","/v1/accounts:signInWithPhoneNumber",vn(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await bn(e,"POST","/v1/accounts:signInWithPhoneNumber",vn(e,t));if(n.temporaryProof)throw zn(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return bn(e,"POST","/v1/accounts:signInWithPhoneNumber",vn(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),_i)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:a}=e;return n||t||i||a?new Ei({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:a}):null}}class Si{constructor(e){var t,n,i,a,r,s;const o=me(fe(e)),l=null!==(t=o.apiKey)&&void 0!==t?t:null,c=null!==(n=o.oobCode)&&void 0!==n?n:null,d=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=o.mode)&&void 0!==i?i:null);on(l&&c&&d,"argument-error"),this.apiKey=l,this.operation=d,this.code=c,this.continueUrl=null!==(a=o.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(r=o.languageCode)&&void 0!==r?r:null,this.tenantId=null!==(s=o.tenantId)&&void 0!==s?s:null}static parseLink(e){const t=function(e){const t=me(fe(e)).link,n=t?me(fe(t)).deep_link_id:null,i=me(fe(e)).deep_link_id;return(i?me(fe(i)).link:null)||i||n||t||e}(e);try{return new Si(t)}catch(n){return null}}}class Ti{constructor(){this.providerId=Ti.PROVIDER_ID}static credential(e,t){return ki._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Si.parseLink(t);return on(n,"argument-error"),ki._fromEmailAndCode(e,n.code,n.tenantId)}}Ti.PROVIDER_ID="password",Ti.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Ti.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Ci{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Pi extends Ci{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ii extends Pi{constructor(){super("facebook.com")}static credential(e){return zi._fromParams({providerId:Ii.PROVIDER_ID,signInMethod:Ii.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ii.credentialFromTaggedObject(e)}static credentialFromError(e){return Ii.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Ii.credential(t.oauthAccessToken)}catch(n){return null}}}Ii.FACEBOOK_SIGN_IN_METHOD="facebook.com",Ii.PROVIDER_ID="facebook.com";class Ai extends Pi{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return zi._fromParams({providerId:Ai.PROVIDER_ID,signInMethod:Ai.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ai.credentialFromTaggedObject(e)}static credentialFromError(e){return Ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:i}=t;if(!n&&!i)return null;try{return Ai.credential(n,i)}catch(a){return null}}}Ai.GOOGLE_SIGN_IN_METHOD="google.com",Ai.PROVIDER_ID="google.com";class Mi extends Pi{constructor(){super("github.com")}static credential(e){return zi._fromParams({providerId:Mi.PROVIDER_ID,signInMethod:Mi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Mi.credentialFromTaggedObject(e)}static credentialFromError(e){return Mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Mi.credential(t.oauthAccessToken)}catch(n){return null}}}Mi.GITHUB_SIGN_IN_METHOD="github.com",Mi.PROVIDER_ID="github.com";class Di extends Pi{constructor(){super("twitter.com")}static credential(e,t){return zi._fromParams({providerId:Di.PROVIDER_ID,signInMethod:Di.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Di.credentialFromTaggedObject(e)}static credentialFromError(e){return Di.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=t;if(!n||!i)return null;try{return Di.credential(n,i)}catch(a){return null}}}async function Ri(e,t){return bn(e,"POST","/v1/accounts:signUp",vn(e,t))}Di.TWITTER_SIGN_IN_METHOD="twitter.com",Di.PROVIDER_ID="twitter.com";class Oi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=await Vn._fromIdTokenResponse(e,n,i),r=Li(n);return new Oi({user:a,providerId:r,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=Li(n);return new Oi({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function Li(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Fi extends le{constructor(e,t,n,i){var a;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Fi.prototype),this.customData={appName:e.name,tenantId:null!==(a=e.tenantId)&&void 0!==a?a:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new Fi(e,t,n,i)}}function Ui(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Fi._fromErrorAndOperation(e,n,t,i);throw n}))}async function Vi(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=await Mn(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Oi._forOperation(e,"link",i)}async function $i(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:i}=e;if(It(i.app))return Promise.reject(rn(i));const a="reauthenticate";try{const r=await Mn(e,Ui(i,a,t,e),n);on(r.idToken,i,"internal-error");const s=In(r.idToken);on(s,i,"internal-error");const{sub:o}=s;return on(e.uid===o,i,"user-mismatch"),Oi._forOperation(e,a,r)}catch(r){throw"auth/user-not-found"===(null===r||void 0===r?void 0:r.code)&&tn(i,"user-mismatch"),r}}async function Bi(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(It(e.app))return Promise.reject(rn(e));const i="signIn",a=await Ui(e,i,t),r=await Oi._fromIdTokenResponse(e,i,a);return n||await e._updateCurrentUser(r.user),r}async function Wi(e,t){let{displayName:n,photoURL:i}=t;if(void 0===n&&void 0===i)return;const a=we(e),r={idToken:await a.getIdToken(),displayName:n,photoUrl:i,returnSecureToken:!0},s=await Mn(a,async function(e,t){return wn(e,"POST","/v1/accounts:update",t)}(a.auth,r));a.displayName=s.displayName||null,a.photoURL=s.photoUrl||null;const o=a.providerData.find((e=>{let{providerId:t}=e;return"password"===t}));o&&(o.displayName=a.displayName,o.photoURL=a.photoURL),await a._updateTokensIfNecessary(s)}new WeakMap;const qi="__sak";class Hi{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(qi,"1"),this.storage.removeItem(qi),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Gi extends Hi{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ai(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},a=this.storage.getItem(n);ii()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Gi.type="LOCAL";const Ki=Gi;class Qi extends Hi{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Qi.type="SESSION";const Zi=Qi;class Yi{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Yi(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:a}=t.data,r=this.handlersMap[i];if(!(null===r||void 0===r?void 0:r.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const s=Array.from(r).map((async e=>e(t.origin,a))),o=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(s);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Ji(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let i=0;i<t;i++)n+=Math.floor(10*Math.random());return e+n}Yi.receivers=[];class Xi{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const i="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,r;return new Promise(((s,o)=>{const l=Ji("",20);i.port1.start();const c=setTimeout((()=>{o(new Error("unsupported_event"))}),n);r={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),a=setTimeout((()=>{o(new Error("timeout"))}),3e3);break;case"done":clearTimeout(a),s(t.data.response);break;default:clearTimeout(c),clearTimeout(a),o(new Error("invalid_response"))}}},this.handlers.add(r),i.port1.addEventListener("message",r.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])})).finally((()=>{r&&this.removeMessageHandler(r)}))}}function ea(){return window}function ta(){return"undefined"!==typeof ea().WorkerGlobalScope&&"function"===typeof ea().importScripts}const na="firebaseLocalStorageDb",ia="firebaseLocalStorage",aa="fbase_key";class ra{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function sa(e,t){return e.transaction([ia],t?"readwrite":"readonly").objectStore(ia)}function oa(){const e=indexedDB.open(na,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(ia,{keyPath:aa})}catch(i){n(i)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(ia)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(na);return new ra(e).toPromise()}(),t(await oa()))}))}))}async function la(e,t,n){const i=sa(e,!0).put({[aa]:t,value:n});return new ra(i).toPromise()}function ca(e,t){const n=sa(e,!0).delete(t);return new ra(n).toPromise()}class da{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await oa()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ta()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Yi._getInstance(ta()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Xi(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await oa();return await la(e,qi,"1"),await ca(e,qi),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>la(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=sa(e,!1).get(t),i=await new ra(n).toPromise();return void 0===i?null:i.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>ca(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=sa(e,!1).getAll();return new ra(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:i,value:a}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}da.type="LOCAL";const ua=da;pi("rcb"),new pn(3e4,6e4);const ha="recaptcha";async function pa(e,t,n){var i;const a=await n.verify();try{let r;if(on("string"===typeof a,e,"argument-error"),on(n.type===ha,e,"argument-error"),r="string"===typeof t?{phoneNumber:t}:t,"session"in r){const t=r.session;if("phoneNumber"in r){on("enroll"===t.type,e,"internal-error");const n=await function(e,t){return wn(e,"POST","/v2/accounts/mfaEnrollment:start",vn(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,recaptchaToken:a}});return n.phoneSessionInfo.sessionInfo}{on("signin"===t.type,e,"internal-error");const n=(null===(i=r.multiFactorHint)||void 0===i?void 0:i.uid)||r.multiFactorUid;on(n,e,"missing-multi-factor-info");const s=await function(e,t){return wn(e,"POST","/v2/accounts/mfaSignIn:start",vn(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:a}});return s.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return wn(e,"POST","/v1/accounts:sendVerificationCode",vn(e,t))}(e,{phoneNumber:r.phoneNumber,recaptchaToken:a});return t}}finally{n._reset()}}class ma{constructor(e){this.providerId=ma.PROVIDER_ID,this.auth=ci(e)}verifyPhoneNumber(e,t){return pa(this.auth,e,we(t))}static credential(e,t){return Ei._fromVerification(e,t)}static credentialFromResult(e){const t=e;return ma.credentialFromTaggedObject(t)}static credentialFromError(e){return ma.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:i}=t;return n&&i?Ei._fromTokenResponse(n,i):null}}function fa(e,t){return t?Bn(t):(on(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}ma.PROVIDER_ID="phone",ma.PHONE_SIGN_IN_METHOD="phone";class ya extends xi{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ni(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ni(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ni(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ga(e){return Bi(e.auth,new ya(e),e.bypassAuthState)}function va(e){const{auth:t,user:n}=e;return on(n,t,"internal-error"),$i(n,new ya(e),e.bypassAuthState)}async function wa(e){const{auth:t,user:n}=e;return on(n,t,"internal-error"),Vi(n,new ya(e),e.bypassAuthState)}class xa{constructor(e,t,n,i){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:a,error:r,type:s}=e;if(r)return void this.reject(r);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ga;case"linkViaPopup":case"linkViaRedirect":return wa;case"reauthViaPopup":case"reauthViaRedirect":return va;default:tn(this.auth,"internal-error")}}resolve(e){cn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){cn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const ba=new pn(2e3,1e4);class ja extends xa{constructor(e,t,n,i,a){super(e,t,i,a),this.provider=n,this.authWindow=null,this.pollId=null,ja.currentPopupAction&&ja.currentPopupAction.cancel(),ja.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return on(e,this.auth,"internal-error"),e}async onExecution(){cn(1===this.filter.length,"Popup operations only handle one event");const e=Ji();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(nn(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(nn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ja.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(nn(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,ba.get())};e()}}ja.currentPopupAction=null;const ka=new Map;class Na extends xa{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=ka.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Ea(t),i=_a(e);if(!await i._isAvailable())return!1;const a="true"===await i._get(n);return await i._remove(n),a}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}ka.set(this.auth._key(),e)}return this.bypassAuthState||ka.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function za(e,t){ka.set(e._key(),t)}function _a(e){return Bn(e._redirectPersistence)}function Ea(e){return Hn("pendingRedirect",e.config.apiKey,e.name)}async function Sa(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(It(e.app))return Promise.reject(rn(e));const i=ci(e),a=fa(i,t),r=new Na(i,a,n),s=await r.execute();return s&&!n&&(delete s.user._redirectEventId,await i._persistUserIfCurrent(s.user),await i._setRedirectUser(null,t)),s}class Ta{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Pa(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Pa(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(nn(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ca(e))}saveEventToCache(e){this.cachedEventUids.add(Ca(e)),this.lastProcessedEventTime=Date.now()}}function Ca(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Pa(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===(null===n||void 0===n?void 0:n.code)}const Ia=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Aa=/^https?/;async function Ma(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return wn(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const i of t)try{if(Da(i))return}catch(n){}tn(e,"unauthorized-domain")}function Da(e){const t=dn(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&a.hostname===i}if(!Aa.test(n))return!1;if(Ia.test(e))return i===e;const a=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(i)}const Ra=new pn(3e4,6e4);function Oa(){const e=ea().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function La(e){return new Promise(((t,n)=>{var i,a,r;function s(){Oa(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Oa(),n(nn(e,"network-request-failed"))},timeout:Ra.get()})}if(null===(a=null===(i=ea().gapi)||void 0===i?void 0:i.iframes)||void 0===a?void 0:a.Iframe)t(gapi.iframes.getContext());else{if(!(null===(r=ea().gapi)||void 0===r?void 0:r.load)){const t=pi("iframefcb");return ea()[t]=()=>{gapi.load?s():n(nn(e,"network-request-failed"))},hi(`${ui.gapiScript}?onload=${t}`).catch((e=>n(e)))}s()}})).catch((e=>{throw Fa=null,e}))}let Fa=null;const Ua=new pn(5e3,15e3),Va={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},$a=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ba(e){const t=e.config;on(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?mn(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,i={apiKey:t.apiKey,appName:e.name,v:Dt},a=$a.get(e.config.apiHost);a&&(i.eid=a);const r=e._getFrameworks();return r.length&&(i.fw=r.join(",")),`${n}?${pe(i).slice(1)}`}async function Wa(e){const t=await function(e){return Fa=Fa||La(e),Fa}(e),n=ea().gapi;return on(n,e,"internal-error"),t.open({where:document.body,url:Ba(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Va,dontclear:!0},(t=>new Promise((async(n,i)=>{await t.restyle({setHideOnLeave:!1});const a=nn(e,"network-request-failed"),r=ea().setTimeout((()=>{i(a)}),Ua.get());function s(){ea().clearTimeout(r),n(t)}t.ping(s).then(s,(()=>{i(a)}))}))))}const qa={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Ha{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Ga(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const r=Math.max((window.screen.availHeight-a)/2,0).toString(),s=Math.max((window.screen.availWidth-i)/2,0).toString();let o="";const l=Object.assign(Object.assign({},qa),{width:i.toString(),height:a.toString(),top:r,left:s}),c=ie().toLowerCase();n&&(o=Yn(c)?"_blank":n),Qn(c)&&(t=t||"http://localhost",l.scrollbars="yes");const d=Object.entries(l).reduce(((e,t)=>{let[n,i]=t;return`${e}${n}=${i},`}),"");if(function(){var e;return ni(arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(t||"",o),new Ha(null);const u=window.open(t||"",o,d);on(u,e,"popup-blocked");try{u.focus()}catch(h){}return new Ha(u)}const Ka="__/auth/handler",Qa="emulator/auth/handler",Za=encodeURIComponent("fac");async function Ya(e,t,n,i,a,r){on(e.config.authDomain,e,"auth-domain-config-required"),on(e.config.apiKey,e,"invalid-api-key");const s={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:Dt,eventId:a};if(t instanceof Ci){t.setDefaultLanguage(e.languageCode),s.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(s.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(r||{}))s[e]=t}if(t instanceof Pi){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(s.scopes=e.join(","))}e.tenantId&&(s.tid=e.tenantId);const o=s;for(const d of Object.keys(o))void 0===o[d]&&delete o[d];const l=await e._getAppCheckToken(),c=l?`#${Za}=${encodeURIComponent(l)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${Ka}`;return mn(t,Qa)}(e)}?${pe(o).slice(1)}${c}`}const Ja="webStorageSupport";const Xa=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Zi,this._completeRedirectFn=Sa,this._overrideRedirectResult=za}async _openPopup(e,t,n,i){var a;cn(null===(a=this.eventManagers[e._key()])||void 0===a?void 0:a.manager,"_initialize() not called before _openPopup()");return Ga(e,await Ya(e,t,n,dn(),i),Ji())}async _openRedirect(e,t,n,i){await this._originValidation(e);return function(e){ea().location.href=e}(await Ya(e,t,n,dn(),i)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(cn(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await Wa(e),n=new Ta(e);return t.register("authEvent",(t=>{on(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ja,{type:Ja},(n=>{var i;const a=null===(i=null===n||void 0===n?void 0:n[0])||void 0===i?void 0:i[Ja];void 0!==a&&t(!!a),tn(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Ma(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ai()||Zn()||ni()}};var er="@firebase/auth",tr="1.7.9";class nr{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){on(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const ir=te("authIdTokenMaxAge")||300;let ar=null;var rr;ui={loadJS:e=>new Promise(((t,n)=>{const i=document.createElement("script");i.setAttribute("src",e),i.onload=t,i.onerror=e=>{const t=nn("internal-error");t.customData=e,n(t)},i.type="text/javascript",i.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(i)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},rr="Browser",Ct(new xe("auth",((e,t)=>{let{options:n}=t;const i=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=i.options;on(s&&!s.includes(":"),"invalid-api-key",{appName:i.name});const l={apiKey:s,authDomain:o,clientPlatform:rr,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ri(rr)},c=new li(i,a,r,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Bn);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),Ct(new xe("auth-internal",(e=>(e=>new nr(e))(ci(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Lt(er,tr,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(rr)),Lt(er,tr,"esm2017");var sr,or,lr="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},cr={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var i=Array(16);if("string"===typeof t)for(var a=0;16>a;++a)i[a]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(a=0;16>a;++a)i[a]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],a=e.g[2];var r=e.g[3],s=t+(r^n&(a^r))+i[0]+3614090360&4294967295;s=(n=(a=(r=(t=(n=(a=(r=(t=(n=(a=(r=(t=(n=(a=(r=(t=(n=(a=(r=(t=(n=(a=(r=(t=(n=(a=(r=(t=(n=(a=(r=(t=(n=(a=(r=(t=(n=(a=(r=(t=(n=(a=(r=(t=(n=(a=(r=(t=(n=(a=(r=(t=(n=(a=(r=(t=(n=(a=(r=(t=n+(s<<7&4294967295|s>>>25))+((s=r+(a^t&(n^a))+i[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=a+(n^r&(t^n))+i[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^a&(r^t))+i[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=t+(r^n&(a^r))+i[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=r+(a^t&(n^a))+i[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=a+(n^r&(t^n))+i[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^a&(r^t))+i[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=t+(r^n&(a^r))+i[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=r+(a^t&(n^a))+i[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=a+(n^r&(t^n))+i[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^a&(r^t))+i[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=t+(r^n&(a^r))+i[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=r+(a^t&(n^a))+i[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=a+(n^r&(t^n))+i[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^a&(r^t))+i[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=t+(a^r&(n^a))+i[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=r+(n^a&(t^n))+i[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^n&(r^t))+i[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=n+(r^t&(a^r))+i[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=t+(a^r&(n^a))+i[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=r+(n^a&(t^n))+i[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^n&(r^t))+i[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=n+(r^t&(a^r))+i[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=t+(a^r&(n^a))+i[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=r+(n^a&(t^n))+i[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^n&(r^t))+i[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=n+(r^t&(a^r))+i[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=t+(a^r&(n^a))+i[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=r+(n^a&(t^n))+i[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^n&(r^t))+i[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=n+(r^t&(a^r))+i[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=t+(n^a^r)+i[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=r+(t^n^a)+i[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=a+(r^t^n)+i[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=n+(a^r^t)+i[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^a^r)+i[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=r+(t^n^a)+i[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=a+(r^t^n)+i[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=n+(a^r^t)+i[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^a^r)+i[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=r+(t^n^a)+i[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=a+(r^t^n)+i[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=n+(a^r^t)+i[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^a^r)+i[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=r+(t^n^a)+i[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=a+(r^t^n)+i[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=n+(a^r^t)+i[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=t+(a^(n|~r))+i[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=r+(n^(t|~a))+i[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=a+(t^(r|~n))+i[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=n+(r^(a|~t))+i[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=t+(a^(n|~r))+i[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=r+(n^(t|~a))+i[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=a+(t^(r|~n))+i[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=n+(r^(a|~t))+i[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=t+(a^(n|~r))+i[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=r+(n^(t|~a))+i[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=a+(t^(r|~n))+i[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=n+(r^(a|~t))+i[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((r=(t=n+((s=t+(a^(n|~r))+i[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=r+(n^(t|~a))+i[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((a=r+((s=a+(t^(r|~n))+i[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~t))+i[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(a+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+a&4294967295,e.g[3]=e.g[3]+r&4294967295}function i(e,t){this.h=t;for(var n=[],i=!0,a=e.length-1;0<=a;a--){var r=0|e[a];i&&r==t||(n[a]=r,i=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,i){for(var a=Array(arguments.length-2),r=2;r<arguments.length;r++)a[r-2]=arguments[r];return t.prototype[n].apply(e,a)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var i=t-this.blockSize,a=this.B,r=this.h,s=0;s<t;){if(0==r)for(;s<=i;)n(this,e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(a[r++]=e.charCodeAt(s++),r==this.blockSize){n(this,a),r=0;break}}else for(;s<t;)if(a[r++]=e[s++],r==this.blockSize){n(this,a),r=0;break}}this.h=r,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var i=0;32>i;i+=8)e[n++]=this.g[t]>>>i&255;return e};var a={};function r(e){return-128<=e&&128>e?function(e,t){var n=a;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new i([0|e],0>e?-1:0)})):new i([0|e],0>e?-1:0)}function s(e){if(isNaN(e)||!isFinite(e))return o;if(0>e)return h(s(-e));for(var t=[],n=1,a=0;e>=n;a++)t[a]=e/n|0,n*=4294967296;return new i(t,0)}var o=r(0),l=r(1),c=r(16777216);function d(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function u(e){return-1==e.h}function h(e){for(var t=e.g.length,n=[],a=0;a<t;a++)n[a]=~e.g[a];return new i(n,~e.h).add(l)}function p(e,t){return e.add(h(t))}function m(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function f(e,t){this.g=e,this.h=t}function y(e,t){if(d(t))throw Error("division by zero");if(d(e))return new f(o,o);if(u(e))return t=y(h(e),t),new f(h(t.g),h(t.h));if(u(t))return t=y(e,h(t)),new f(h(t.g),t.h);if(30<e.g.length){if(u(e)||u(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,i=t;0>=i.l(e);)n=g(n),i=g(i);var a=v(n,1),r=v(i,1);for(i=v(i,2),n=v(n,2);!d(i);){var c=r.add(i);0>=c.l(e)&&(a=a.add(n),r=c),i=v(i,1),n=v(n,1)}return t=p(e,a.j(t)),new f(a,t)}for(a=o;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),c=(r=s(n)).j(t);u(c)||0<c.l(e);)c=(r=s(n-=i)).j(t);d(r)&&(r=l),a=a.add(r),e=p(e,c)}return new f(a,e)}function g(e){for(var t=e.g.length+1,n=[],a=0;a<t;a++)n[a]=e.i(a)<<1|e.i(a-1)>>>31;return new i(n,e.h)}function v(e,t){var n=t>>5;t%=32;for(var a=e.g.length-n,r=[],s=0;s<a;s++)r[s]=0<t?e.i(s+n)>>>t|e.i(s+n+1)<<32-t:e.i(s+n);return new i(r,e.h)}(e=i.prototype).m=function(){if(u(this))return-h(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var i=this.i(n);e+=(0<=i?i:4294967296+i)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(d(this))return"0";if(u(this))return"-"+h(this).toString(e);for(var t=s(Math.pow(e,6)),n=this,i="";;){var a=y(n,t).g,r=((0<(n=p(n,a.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(d(n=a))return r+i;for(;6>r.length;)r="0"+r;i=r+i}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return u(e=p(this,e))?-1:d(e)?0:1},e.abs=function(){return u(this)?h(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0,r=0;r<=t;r++){var s=a+(65535&this.i(r))+(65535&e.i(r)),o=(s>>>16)+(this.i(r)>>>16)+(e.i(r)>>>16);a=o>>>16,s&=65535,o&=65535,n[r]=o<<16|s}return new i(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(d(this)||d(e))return o;if(u(this))return u(e)?h(this).j(h(e)):h(h(this).j(e));if(u(e))return h(this.j(h(e)));if(0>this.l(c)&&0>e.l(c))return s(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],a=0;a<2*t;a++)n[a]=0;for(a=0;a<this.g.length;a++)for(var r=0;r<e.g.length;r++){var l=this.i(a)>>>16,p=65535&this.i(a),f=e.i(r)>>>16,y=65535&e.i(r);n[2*a+2*r]+=p*y,m(n,2*a+2*r),n[2*a+2*r+1]+=l*y,m(n,2*a+2*r+1),n[2*a+2*r+1]+=p*f,m(n,2*a+2*r+1),n[2*a+2*r+2]+=l*f,m(n,2*a+2*r+2)}for(a=0;a<t;a++)n[a]=n[2*a+1]<<16|n[2*a];for(a=t;a<2*t;a++)n[a]=0;return new i(n,0)},e.A=function(e){return y(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0;a<t;a++)n[a]=this.i(a)&e.i(a);return new i(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0;a<t;a++)n[a]=this.i(a)|e.i(a);return new i(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0;a<t;a++)n[a]=this.i(a)^e.i(a);return new i(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,or=cr.Md5=t,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=s,i.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return h(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=s(Math.pow(n,8)),a=o,r=0;r<t.length;r+=8){var l=Math.min(8,t.length-r),c=parseInt(t.substring(r,r+l),n);8>l?(l=s(Math.pow(n,l)),a=a.j(l).add(s(c))):a=(a=a.j(i)).add(s(c))}return a},sr=cr.Integer=i}).apply("undefined"!==typeof lr?lr:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var dr,ur,hr,pr,mr,fr,yr,gr,vr="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},wr={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof vr&&vr];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,i){if(i)e:{var a=n;e=e.split(".");for(var r=0;r<e.length-1;r++){var s=e[r];if(!(s in a))break e;a=a[s]}(i=i(r=a[e=e[e.length-1]]))!=r&&null!=i&&t(a,e,{configurable:!0,writable:!0,value:i})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,i=!1,a={next:function(){if(!i&&n<e.length){var a=n++;return{value:t(a,e[a]),done:!1}}return i=!0,{done:!0,value:void 0}}};return a[Symbol.iterator]=function(){return a},a}(this,(function(e,t){return t}))}}));var i=i||{},a=this||self;function r(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function s(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function d(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function u(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,i){for(var a=Array(arguments.length-2),r=2;r<arguments.length;r++)a[r-2]=arguments[r];return t.prototype[n].apply(e,a)}}function h(e){const t=e.length;if(0<t){const n=Array(t);for(let i=0;i<t;i++)n[i]=e[i];return n}return[]}function p(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(r(t)){const n=e.length||0,i=t.length||0;e.length=n+i;for(let a=0;a<i;a++)e[n+a]=t[a]}else e.push(t)}}function m(e){return/^[\s\xa0]*$/.test(e)}function f(){var e=a.navigator;return e&&(e=e.userAgent)?e:""}function y(e){return y[" "](e),e}y[" "]=function(){};var g=-1!=f().indexOf("Gecko")&&!(-1!=f().toLowerCase().indexOf("webkit")&&-1==f().indexOf("Edge"))&&!(-1!=f().indexOf("Trident")||-1!=f().indexOf("MSIE"))&&-1==f().indexOf("Edge");function v(e,t,n){for(const i in e)t.call(n,e[i],i,e)}function w(e){const t={};for(const n in e)t[n]=e[n];return t}const x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(e,t){let n,i;for(let a=1;a<arguments.length;a++){for(n in i=arguments[a],i)e[n]=i[n];for(let t=0;t<x.length;t++)n=x[t],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}function j(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function k(e){a.setTimeout((()=>{throw e}),0)}function N(){var e=T;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var z=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new _),(e=>e.reset()));class _{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let E,S=!1,T=new class{constructor(){this.h=this.g=null}add(e,t){const n=z.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},C=()=>{const e=a.Promise.resolve(void 0);E=()=>{e.then(P)}};var P=()=>{for(var e;e=N();){try{e.h.call(e.g)}catch(n){k(n)}var t=z;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}S=!1};function I(){this.s=this.s,this.C=this.C}function A(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}I.prototype.s=!1,I.prototype.ma=function(){this.s||(this.s=!0,this.N())},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},A.prototype.h=function(){this.defaultPrevented=!0};var M=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};a.addEventListener("test",e,t),a.removeEventListener("test",e,t)}catch(n){}return e}();function D(e,t){if(A.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(g){e:{try{y(t.nodeName);var a=!0;break e}catch(r){}a=!1}a||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:R[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&D.aa.h.call(this)}}u(D,A);var R={2:"touch",3:"pen",4:"mouse"};D.prototype.h=function(){D.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var O="closure_listenable_"+(1e6*Math.random()|0),L=0;function F(e,t,n,i,a){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!i,this.ha=a,this.key=++L,this.da=this.fa=!1}function U(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function V(e){this.src=e,this.g={},this.h=0}function $(e,t){var n=t.type;if(n in e.g){var i,a=e.g[n],r=Array.prototype.indexOf.call(a,t,void 0);(i=0<=r)&&Array.prototype.splice.call(a,r,1),i&&(U(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function B(e,t,n,i){for(var a=0;a<e.length;++a){var r=e[a];if(!r.da&&r.listener==t&&r.capture==!!n&&r.ha==i)return a}return-1}V.prototype.add=function(e,t,n,i,a){var r=e.toString();(e=this.g[r])||(e=this.g[r]=[],this.h++);var s=B(e,t,i,a);return-1<s?(t=e[s],n||(t.fa=!1)):((t=new F(t,this.src,r,!!i,a)).fa=n,e.push(t)),t};var W="closure_lm_"+(1e6*Math.random()|0),q={};function H(e,t,n,i,a){if(i&&i.once)return K(e,t,n,i,a);if(Array.isArray(t)){for(var r=0;r<t.length;r++)H(e,t[r],n,i,a);return null}return n=te(n),e&&e[O]?e.K(t,n,s(i)?!!i.capture:!!i,a):G(e,t,n,!1,i,a)}function G(e,t,n,i,a,r){if(!t)throw Error("Invalid event type");var o=s(a)?!!a.capture:!!a,l=X(e);if(l||(e[W]=l=new V(e)),(n=l.add(t,n,i,o,r)).proxy)return n;if(i=function(){function e(n){return t.call(e.src,e.listener,n)}const t=J;return e}(),n.proxy=i,i.src=e,i.listener=n,e.addEventListener)M||(a=o),void 0===a&&(a=!1),e.addEventListener(t.toString(),i,a);else if(e.attachEvent)e.attachEvent(Y(t.toString()),i);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(i)}return n}function K(e,t,n,i,a){if(Array.isArray(t)){for(var r=0;r<t.length;r++)K(e,t[r],n,i,a);return null}return n=te(n),e&&e[O]?e.L(t,n,s(i)?!!i.capture:!!i,a):G(e,t,n,!0,i,a)}function Q(e,t,n,i,a){if(Array.isArray(t))for(var r=0;r<t.length;r++)Q(e,t[r],n,i,a);else i=s(i)?!!i.capture:!!i,n=te(n),e&&e[O]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=B(r=e.g[t],n,i,a))&&(U(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete e.g[t],e.h--)))):e&&(e=X(e))&&(t=e.g[t.toString()],e=-1,t&&(e=B(t,n,i,a)),(n=-1<e?t[e]:null)&&Z(n))}function Z(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[O])$(t.i,e);else{var n=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(n,i,e.capture):t.detachEvent?t.detachEvent(Y(n),i):t.addListener&&t.removeListener&&t.removeListener(i),(n=X(t))?($(n,e),0==n.h&&(n.src=null,t[W]=null)):U(e)}}}function Y(e){return e in q?q[e]:q[e]="on"+e}function J(e,t){if(e.da)e=!0;else{t=new D(t,this);var n=e.listener,i=e.ha||e.src;e.fa&&Z(e),e=n.call(i,t)}return e}function X(e){return(e=e[W])instanceof V?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){I.call(this),this.i=new V(this),this.M=this,this.F=null}function ie(e,t){var n,i=e.F;if(i)for(n=[];i;i=i.F)n.push(i);if(e=e.M,i=t.type||t,"string"===typeof t)t=new A(t,e);else if(t instanceof A)t.target=t.target||e;else{var a=t;b(t=new A(i,e),a)}if(a=!0,n)for(var r=n.length-1;0<=r;r--){var s=t.g=n[r];a=ae(s,i,!0,t)&&a}if(a=ae(s=t.g=e,i,!0,t)&&a,a=ae(s,i,!1,t)&&a,n)for(r=0;r<n.length;r++)a=ae(s=t.g=n[r],i,!1,t)&&a}function ae(e,t,n,i){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var a=!0,r=0;r<t.length;++r){var s=t[r];if(s&&!s.da&&s.capture==n){var o=s.listener,l=s.ha||s.src;s.fa&&$(e.i,s),a=!1!==o.call(l,i)&&a}}return a&&!i.defaultPrevented}function re(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:a.setTimeout(e,t||0)}function se(e){e.g=re((()=>{e.g=null,e.i&&(e.i=!1,se(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}u(ne,I),ne.prototype[O]=!0,ne.prototype.removeEventListener=function(e,t,n,i){Q(this,e,t,n,i)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],i=0;i<n.length;i++)U(n[i]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,i){return this.i.add(String(e),t,!1,n,i)},ne.prototype.L=function(e,t,n,i){return this.i.add(String(e),t,!0,n,i)};class oe extends I{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:se(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){I.call(this),this.h=e,this.g={}}u(le,I);var ce=[];function de(e){v(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Z(e)}),e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),de(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ue=a.JSON.stringify,he=a.JSON.parse,pe=class{stringify(e){return a.JSON.stringify(e,void 0)}parse(e){return a.JSON.parse(e,void 0)}};function me(){}function fe(e){return e.h||(e.h=e.i())}function ye(){}me.prototype.h=null;var ge={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ve(){A.call(this,"d")}function we(){A.call(this,"c")}u(ve,A),u(we,A);var xe={},be=null;function je(){return be=be||new ne}function ke(e){A.call(this,xe.La,e)}function Ne(e){const t=je();ie(t,new ke(t))}function ze(e,t){A.call(this,xe.STAT_EVENT,e),this.stat=t}function _e(e){const t=je();ie(t,new ze(t,e))}function Ee(e,t){A.call(this,xe.Ma,e),this.size=t}function Se(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return a.setTimeout((function(){e()}),t)}function Te(){this.g=!0}function Ce(e,t,n,i){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var i=n[e];if(!(2>i.length)){var a=i[1];if(Array.isArray(a)&&!(1>a.length)){var r=a[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var s=1;s<a.length;s++)a[s]=""}}}return ue(n)}catch(o){return t}}(e,n)+(i?" "+i:"")}))}xe.La="serverreachability",u(ke,A),xe.STAT_EVENT="statevent",u(ze,A),xe.Ma="timingevent",u(Ee,A),Te.prototype.xa=function(){this.g=!1},Te.prototype.info=function(){};var Pe,Ie={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ae={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Me(){}function De(e,t,n,i){this.j=e,this.i=t,this.l=n,this.R=i||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Re}function Re(){this.i=null,this.g="",this.h=!1}u(Me,me),Me.prototype.g=function(){return new XMLHttpRequest},Me.prototype.i=function(){return{}},Pe=new Me;var Oe={},Le={};function Fe(e,t,n){e.L=1,e.v=ut(st(t)),e.m=n,e.P=!0,Ue(e,null)}function Ue(e,t){e.F=Date.now(),Be(e),e.A=st(e.v);var n=e.A,i=e.R;Array.isArray(i)||(i=[String(i)]),zt(n.i,"t",i),e.C=0,n=e.j.J,e.h=new Re,e.g=pn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new oe(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,i=e.ca;var a="readystatechange";Array.isArray(a)||(a&&(ce[0]=a.toString()),a=ce);for(var r=0;r<a.length;r++){var s=H(n,a[r],i||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}t=e.H?w(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ne(),function(e,t,n,i,a,r){e.info((function(){if(e.g)if(r)for(var s="",o=r.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var d=c[0];c=c[1];var u=d.split("_");s=2<=u.length&&"type"==u[1]?s+(d+"=")+c+"&":s+(d+"=redacted&")}}else s=null;else s=r;return"XMLHTTP REQ ("+i+") [attempt "+a+"]: "+t+"\n"+n+"\n"+s}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function Ve(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function $e(e,t){var n=e.C,i=t.indexOf("\n",n);return-1==i?Le:(n=Number(t.substring(n,i)),isNaN(n)?Oe:(i+=1)+n>t.length?Le:(t=t.slice(i,i+n),e.C=i+n,t))}function Be(e){e.S=Date.now()+e.I,We(e,e.I)}function We(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Se(c(e.ba,e),t)}function qe(e){e.B&&(a.clearTimeout(e.B),e.B=null)}function He(e){0==e.j.G||e.J||ln(e.j,e)}function Ge(e){qe(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,de(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Ke(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Xe(n.h,e)))if(!e.K&&Xe(n.h,e)&&3==n.G){try{var i=n.Da.g.parse(t)}catch(d){i=null}if(Array.isArray(i)&&3==i.length){var a=i;if(0==a[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;on(n),Zt(n)}an(n),_e(18)}}else n.za=a[1],0<n.za-n.T&&37500>a[2]&&n.F&&0==n.v&&!n.C&&(n.C=Se(c(n.Za,n),6e3));if(1>=Je(n.h)&&n.ca){try{n.ca()}catch(d){}n.ca=void 0}}else dn(n,11)}else if((e.K||n.g==e)&&on(n),!m(t))for(a=n.Da.g.parse(t),t=0;t<a.length;t++){let c=a[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const a=c[4];null!=a&&(n.Aa=a,n.j.info("SVER="+n.Aa));const d=c[5];null!=d&&"number"===typeof d&&0<d&&(i=1.5*d,n.L=i,n.j.info("backChannelRequestTimeoutMs_="+i)),i=n;const u=e.g;if(u){const e=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var r=i.h;r.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(r.j=r.l,r.g=new Set,r.h&&(et(r,r.h),r.h=null))}if(i.D){const e=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(i.ya=e,dt(i.I,i.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var s=e;if((i=n).qa=hn(i,i.J?i.ia:null,i.W),s.K){tt(i.h,s);var o=s,l=i.L;l&&(o.I=l),o.B&&(qe(o),Be(o)),i.g=s}else nn(i);0<n.i.length&&Jt(n)}else"stop"!=c[0]&&"close"!=c[0]||dn(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?dn(n,7):Qt(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Ne()}catch(d){}}De.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==qt(e)?t.j():this.Y(e)},De.prototype.Y=function(e){try{if(e==this.g)e:{const h=qt(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||Ht(this.g)))){this.J||4!=h||7==t||Ne(),qe(this);var n=this.g.Z();this.X=n;t:if(Ve(this)){var i=Ht(this.g);e="";var r=i.length,s=4==qt(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ge(this),He(this);var o="";break t}this.h.i=new a.TextDecoder}for(t=0;t<r;t++)this.h.h=!0,e+=this.h.i.decode(i[t],{stream:!(s&&t==r-1)});i.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(e,t,n,i,a,r,s){e.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+a+"]: "+t+"\n"+n+"\n"+r+" "+s}))}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!m(l)){var d=l;break t}}d=null}if(!(n=d)){this.o=!1,this.s=3,_e(12),Ge(this),He(this);break e}Ce(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ke(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<o.length;){if(e=$e(this,o),e==Le){4==h&&(this.s=4,_e(14),n=!1),Ce(this.i,this.l,null,"[Incomplete Response]");break}if(e==Oe){this.s=4,_e(15),Ce(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}Ce(this.i,this.l,e,null),Ke(this,e)}if(Ve(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=o.length||this.h.h||(this.s=1,_e(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var u=this.j;u.g==this&&u.ba&&!u.M&&(u.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),rn(u),u.M=!0,_e(11))}}else Ce(this.i,this.l,o,"[Invalid Chunked Response]"),Ge(this),He(this)}else Ce(this.i,this.l,o,null),Ke(this,o);4==h&&Ge(this),this.o&&!this.J&&(4==h?ln(this.j,this):(this.o=!1,Be(this)))}else(function(e){const t={};e=(e.g&&2<=qt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<e.length;i++){if(m(e[i]))continue;var n=j(e[i]);const a=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const r=t[a]||[];t[a]=r,r.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,_e(12)):(this.s=0,_e(13)),Ge(this),He(this)}}}catch(xr){}},De.prototype.cancel=function(){this.J=!0,Ge(this)},De.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(Ne(),_e(17)),Ge(this),this.s=2,He(this)):We(this,this.S-e)};var Qe=class{constructor(e,t){this.g=e,this.map=t}};function Ze(e){this.l=e||10,a.PerformanceNavigationTiming?e=0<(e=a.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ye(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Je(e){return e.h?1:e.g?e.g.size:0}function Xe(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return h(e.i)}function it(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(r(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(r(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const i in e)t[n++]=i;return t}}}(e),i=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(r(e)){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}for(i in t=[],n=0,e)t[n++]=e[i];return t}(e),a=i.length,s=0;s<a;s++)t.call(void 0,i[s],n&&n[s],e)}Ze.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var at=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function rt(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof rt){this.h=e.h,ot(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new bt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ct(this,n),this.m=e.m}else e&&(t=String(e).match(at))?(this.h=!1,ot(this,t[1]||"",!0),this.o=ht(t[2]||""),this.g=ht(t[3]||"",!0),lt(this,t[4]),this.l=ht(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=ht(t[7]||"")):(this.h=!1,this.i=new bt(null,this.h))}function st(e){return new rt(e)}function ot(e,t,n){e.j=n?ht(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,n){t instanceof bt?(e.i=t,function(e,t){t&&!e.j&&(jt(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(kt(this,t),zt(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=pt(t,wt)),e.i=new bt(t,e.h))}function dt(e,t,n){e.i.set(t,n)}function ut(e){return dt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ht(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function pt(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,mt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function mt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}rt.prototype.toString=function(){var e=[],t=this.j;t&&e.push(pt(t,yt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(pt(t,yt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(pt(n,"/"==n.charAt(0)?vt:gt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",pt(n,xt)),e.join("")};var ft,yt=/[#\/\?@]/g,gt=/[#\?:]/g,vt=/[#\?]/g,wt=/[#\?@]/g,xt=/#/g;function bt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function jt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),a=null;if(0<=i){var r=e[n].substring(0,i);a=e[n].substring(i+1)}else r=e[n];t(r,a?decodeURIComponent(a.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function kt(e,t){jt(e),t=_t(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Nt(e,t){return jt(e),t=_t(e,t),e.g.has(t)}function zt(e,t,n){kt(e,t),0<n.length&&(e.i=null,e.g.set(_t(e,t),h(n)),e.h+=n.length)}function _t(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Et(e,t,n,i,a){try{a&&(a.onload=null,a.onerror=null,a.onabort=null,a.ontimeout=null),i(n)}catch(r){}}function St(){this.g=new pe}function Tt(e,t,n){const i=n||"";try{it(e,(function(e,n){let a=e;s(e)&&(a=ue(e)),t.push(i+n+"="+encodeURIComponent(a))}))}catch(a){throw t.push(i+"type="+encodeURIComponent("_badmap")),a}}function Ct(e){this.l=e.Ub||null,this.j=e.eb||!1}function Pt(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function It(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function At(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Mt(e)}function Mt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Dt(e){let t="";return v(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Rt(e,t,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=Dt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):dt(e,t,n))}function Ot(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=bt.prototype).add=function(e,t){jt(this),this.i=null,e=_t(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){jt(this),this.g.forEach((function(n,i){n.forEach((function(n){e.call(t,n,i,this)}),this)}),this)},e.na=function(){jt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let i=0;i<t.length;i++){const a=e[i];for(let e=0;e<a.length;e++)n.push(t[i])}return n},e.V=function(e){jt(this);let t=[];if("string"===typeof e)Nt(this,e)&&(t=t.concat(this.g.get(_t(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return jt(this),this.i=null,Nt(this,e=_t(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var i=t[n];const r=encodeURIComponent(String(i)),s=this.V(i);for(i=0;i<s.length;i++){var a=r;""!==s[i]&&(a+="="+encodeURIComponent(String(s[i]))),e.push(a)}}return this.i=e.join("&")},u(Ct,me),Ct.prototype.g=function(){return new Pt(this.l,this.j)},Ct.prototype.i=(ft={},function(){return ft}),u(Pt,ne),(e=Pt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Mt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||a).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,At(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Mt(this)),this.g&&(this.readyState=3,Mt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof a.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;It(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?At(this):Mt(this),3==this.readyState&&It(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,At(this))},e.Qa=function(e){this.g&&(this.response=e,At(this))},e.ga=function(){this.g&&At(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Pt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),u(Ot,ne);var Lt=/^https?$/i,Ft=["POST","PUT"];function Ut(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Vt(e),Bt(e)}function Vt(e){e.A||(e.A=!0,ie(e,"complete"),ie(e,"error"))}function $t(e){if(e.h&&"undefined"!=typeof i&&(!e.v[1]||4!=qt(e)||2!=e.Z()))if(e.u&&4==qt(e))re(e.Ea,0,e);else if(ie(e,"readystatechange"),4==qt(e)){e.h=!1;try{const i=e.Z();e:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===i){var s=String(e.D).match(at)[1]||null;!s&&a.self&&a.self.location&&(s=a.self.location.protocol.slice(0,-1)),r=!Lt.test(s?s.toLowerCase():"")}n=r}if(n)ie(e,"complete"),ie(e,"success");else{e.m=6;try{var o=2<qt(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",Vt(e)}}finally{Bt(e)}}}function Bt(e,t){if(e.g){Wt(e);const i=e.g,a=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||ie(e,"ready");try{i.onreadystatechange=a}catch(n){}}}function Wt(e){e.I&&(a.clearTimeout(e.I),e.I=null)}function qt(e){return e.g?e.g.readyState:0}function Ht(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(kr){return null}}function Gt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Kt(e){this.Aa=0,this.i=[],this.j=new Te,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Gt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Gt("baseRetryDelayMs",5e3,e),this.cb=Gt("retryDelaySeedMs",1e4,e),this.Wa=Gt("forwardChannelMaxRetries",2,e),this.wa=Gt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Ze(e&&e.concurrentRequestLimit),this.Da=new St,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Qt(e){if(Yt(e),3==e.G){var t=e.U++,n=st(e.I);if(dt(n,"SID",e.K),dt(n,"RID",t),dt(n,"TYPE","terminate"),en(e,n),(t=new De(e,e.j,t)).L=2,t.v=ut(st(n)),n=!1,a.navigator&&a.navigator.sendBeacon)try{n=a.navigator.sendBeacon(t.v.toString(),"")}catch(i){}!n&&a.Image&&((new Image).src=t.v,n=!0),n||(t.g=pn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),Be(t)}un(e)}function Zt(e){e.g&&(rn(e),e.g.cancel(),e.g=null)}function Yt(e){Zt(e),e.u&&(a.clearTimeout(e.u),e.u=null),on(e),e.h.cancel(),e.s&&("number"===typeof e.s&&a.clearTimeout(e.s),e.s=null)}function Jt(e){if(!Ye(e.h)&&!e.s){e.s=!0;var t=e.Ga;E||C(),S||(E(),S=!0),T.add(t,e),e.B=0}}function Xt(e,t){var n;n=t?t.l:e.U++;const i=st(e.I);dt(i,"SID",e.K),dt(i,"RID",n),dt(i,"AID",e.T),en(e,i),e.m&&e.o&&Rt(i,e.m,e.o),n=new De(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),Fe(n,i,t)}function en(e,t){e.H&&v(e.H,(function(e,n){dt(t,n,e)})),e.l&&it({},(function(e,n){dt(t,n,e)}))}function tn(e,t,n){n=Math.min(e.i.length,n);var i=e.l?c(e.l.Na,e.l,e):null;e:{var a=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=a[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let r=!0;for(let s=0;s<n;s++){let n=a[s].g;const o=a[s].map;if(n-=t,0>n)t=Math.max(0,a[s].g-100),r=!1;else try{Tt(o,e,"req"+n+"_")}catch(xr){i&&i(o)}}if(r){i=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,i}function nn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;E||C(),S||(E(),S=!0),T.add(t,e),e.v=0}}function an(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Se(c(e.Fa,e),cn(e,e.v)),e.v++,!0)}function rn(e){null!=e.A&&(a.clearTimeout(e.A),e.A=null)}function sn(e){e.g=new De(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=st(e.qa);dt(t,"RID","rpc"),dt(t,"SID",e.K),dt(t,"AID",e.T),dt(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&dt(t,"TO",e.ja),dt(t,"TYPE","xmlhttp"),en(e,t),e.m&&e.o&&Rt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=ut(st(t)),n.m=null,n.P=!0,Ue(n,e)}function on(e){null!=e.C&&(a.clearTimeout(e.C),e.C=null)}function ln(e,t){var n=null;if(e.g==t){on(e),rn(e),e.g=null;var i=2}else{if(!Xe(e.h,t))return;n=t.D,tt(e.h,t),i=1}if(0!=e.G)if(t.o)if(1==i){n=t.m?t.m.length:0,t=Date.now()-t.F;var a=e.B;ie(i=je(),new Ee(i,n)),Jt(e)}else nn(e);else if(3==(a=t.s)||0==a&&0<t.X||!(1==i&&function(e,t){return!(Je(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Se(c(e.Ga,e,t),cn(e,e.B)),e.B++,!0))}(e,t)||2==i&&an(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),a){case 1:dn(e,5);break;case 4:dn(e,10);break;case 3:dn(e,6);break;default:dn(e,2)}}function cn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function dn(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),i=e.Xa;const t=!i;i=new rt(i||"//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||ot(i,"https"),ut(i),t?function(e,t){const n=new Te;if(a.Image){const i=new Image;i.onload=d(Et,n,"TestLoadImage: loaded",!0,t,i),i.onerror=d(Et,n,"TestLoadImage: error",!1,t,i),i.onabort=d(Et,n,"TestLoadImage: abort",!1,t,i),i.ontimeout=d(Et,n,"TestLoadImage: timeout",!1,t,i),a.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=e}else t(!1)}(i.toString(),n):function(e,t){new Te;const n=new AbortController,i=setTimeout((()=>{n.abort(),Et(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(i),e.ok?Et(0,0,!0,t):Et(0,0,!1,t)})).catch((()=>{clearTimeout(i),Et(0,0,!1,t)}))}(i.toString(),n)}else _e(2);e.G=0,e.l&&e.l.sa(t),un(e),Yt(e)}function un(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(p(e.ka,t),p(e.ka,e.i),e.h.i.length=0,h(e.i),e.i.length=0),e.l.ra()}}function hn(e,t,n){var i=n instanceof rt?st(n):new rt(n);if(""!=i.g)t&&(i.g=t+"."+i.g),lt(i,i.s);else{var r=a.location;i=r.protocol,t=t?t+"."+r.hostname:r.hostname,r=+r.port;var s=new rt(null);i&&ot(s,i),t&&(s.g=t),r&&lt(s,r),n&&(s.l=n),i=s}return n=e.D,t=e.ya,n&&t&&dt(i,n,t),dt(i,"VER",e.la),en(e,i),i}function pn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Ot(new Ct({eb:n})):new Ot(e.pa)).Ha(e.J),t}function mn(){}function fn(){}function yn(e,t){ne.call(this),this.g=new Kt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!m(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!m(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new wn(this)}function gn(e){ve.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function vn(){we.call(this),this.status=1}function wn(e){this.g=e}(e=Ot.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Pe.g(),this.v=this.o?fe(this.o):fe(Pe),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(s){return void Ut(this,s)}if(e=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else{if("function"!==typeof i.keys||"function"!==typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const e of i.keys())n.set(e,i.get(e))}i=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),r=a.FormData&&e instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Ft,t,void 0))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,o]of n)this.g.setRequestHeader(a,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Wt(this),this.u=!0,this.g.send(e),this.u=!1}catch(s){Ut(this,s)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,ie(this,"complete"),ie(this,"abort"),Bt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Bt(this,!0)),Ot.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?$t(this):this.bb())},e.bb=function(){$t(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<qt(this)?this.g.status:-1}catch(ft){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(ft){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),he(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Kt.prototype).la=8,e.G=1,e.connect=function(e,t,n,i){_e(0),this.W=e,this.H=t||{},n&&void 0!==i&&(this.H.OSID=n,this.H.OAID=i),this.F=this.X,this.I=hn(this,null,this.W),Jt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const a=new De(this,this.j,e);let r=this.o;if(this.S&&(r?(r=w(r),b(r,this.S)):r=this.S),null!==this.m||this.O||(a.H=r,r=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var i=this.i[n];if(void 0===(i="__data__"in i.map&&"string"===typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(t+=i)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=tn(this,a,t),dt(n=st(this.I),"RID",e),dt(n,"CVER",22),this.D&&dt(n,"X-HTTP-Session-Id",this.D),en(this,n),r&&(this.O?t="headers="+encodeURIComponent(String(Dt(r)))+"&"+t:this.m&&Rt(n,this.m,r)),et(this.h,a),this.Ua&&dt(n,"TYPE","init"),this.P?(dt(n,"$req",t),dt(n,"SID","null"),a.T=!0,Fe(a,n,null)):Fe(a,n,t),this.G=2}}else 3==this.G&&(e?Xt(this,e):0==this.i.length||Ye(this.h)||Xt(this))},e.Fa=function(){if(this.u=null,sn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Se(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_e(10),Zt(this),sn(this))},e.Za=function(){null!=this.C&&(this.C=null,Zt(this),an(this),_e(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),_e(2)):(this.j.info("Failed to ping google.com"),_e(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=mn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},fn.prototype.g=function(e,t){return new yn(e,t)},u(yn,ne),yn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){Qt(this.g)},yn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=ue(e),e=n);t.i.push(new Qe(t.Ya++,e)),3==t.G&&Jt(t)},yn.prototype.N=function(){this.g.l=null,delete this.j,Qt(this.g),delete this.g,yn.aa.N.call(this)},u(gn,ve),u(vn,we),u(wn,mn),wn.prototype.ua=function(){ie(this.g,"a")},wn.prototype.ta=function(e){ie(this.g,new gn(e))},wn.prototype.sa=function(e){ie(this.g,new vn)},wn.prototype.ra=function(){ie(this.g,"b")},fn.prototype.createWebChannel=fn.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,gr=wr.createWebChannelTransport=function(){return new fn},yr=wr.getStatEventTarget=function(){return je()},fr=wr.Event=xe,mr=wr.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,pr=wr.ErrorCode=Ie,Ae.COMPLETE="complete",hr=wr.EventType=Ae,ye.EventType=ge,ge.OPEN="a",ge.CLOSE="b",ge.ERROR="c",ge.MESSAGE="d",ne.prototype.listen=ne.prototype.K,ur=wr.WebChannel=ye,wr.FetchXmlHttpFactory=Ct,Ot.prototype.listenOnce=Ot.prototype.L,Ot.prototype.getLastError=Ot.prototype.Ka,Ot.prototype.getLastErrorCode=Ot.prototype.Ba,Ot.prototype.getStatus=Ot.prototype.Z,Ot.prototype.getResponseJson=Ot.prototype.Oa,Ot.prototype.getResponseText=Ot.prototype.oa,Ot.prototype.send=Ot.prototype.ea,Ot.prototype.setWithCredentials=Ot.prototype.Ha,dr=wr.XhrIo=Ot}).apply("undefined"!==typeof vr?vr:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const xr="@firebase/firestore";class br{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}br.UNAUTHENTICATED=new br(null),br.GOOGLE_CREDENTIALS=new br("google-credentials-uid"),br.FIRST_PARTY=new br("first-party-uid"),br.MOCK_USER=new br("mock-user");let jr="10.14.0";const kr=new Ce("@firebase/firestore");function Nr(){return kr.logLevel}function zr(e){if(kr.logLevel<=ze.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const a=n.map(Sr);kr.debug(`Firestore (${jr}): ${e}`,...a)}}function _r(e){if(kr.logLevel<=ze.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const a=n.map(Sr);kr.error(`Firestore (${jr}): ${e}`,...a)}}function Er(e){if(kr.logLevel<=ze.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const a=n.map(Sr);kr.warn(`Firestore (${jr}): ${e}`,...a)}}function Sr(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function Tr(){const e=`FIRESTORE (${jr}) INTERNAL ASSERTION FAILED: `+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state");throw _r(e),new Error(e)}function Cr(e,t){e||Tr()}function Pr(e,t){return e}const Ir={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ar extends le{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Mr{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Dr{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Rr{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(br.UNAUTHENTICATED)))}shutdown(){}}class Or{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Lr{constructor(e){this.t=e,this.currentUser=br.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Cr(void 0===this.o);let n=this.i;const i=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let a=new Mr;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Mr,e.enqueueRetryable((()=>i(this.currentUser)))};const r=()=>{const t=a;e.enqueueRetryable((async()=>{await t.promise,await i(this.currentUser)}))},s=e=>{zr("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),r())};this.t.onInit((e=>s(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?s(e):(zr("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Mr)}}),0),r()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(zr("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Cr("string"==typeof t.accessToken),new Dr(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Cr(null===e||"string"==typeof e),new br(e)}}class Fr{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=br.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Ur{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Fr(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(br.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Vr{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $r{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Cr(void 0===this.o);const n=e=>{null!=e.error&&zr("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,zr("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const i=e=>{zr("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>i(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?i(e):zr("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Cr("string"==typeof e.token),this.R=e.token,new Vr(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Br(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let i=0;i<e;i++)n[i]=Math.floor(256*Math.random());return n}class Wr{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const i=Br(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<t&&(n+=e.charAt(i[a]%62))}return n}}function qr(e,t){return e<t?-1:e>t?1:0}function Hr(e,t,n){return e.length===t.length&&e.every(((e,i)=>n(e,t[i])))}class Gr{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ar(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ar(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Ar(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ar(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Gr.fromMillis(Date.now())}static fromDate(e){return Gr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Gr(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?qr(this.nanoseconds,e.nanoseconds):qr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Kr{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Kr(e)}static min(){return new Kr(new Gr(0,0))}static max(){return new Kr(new Gr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Qr{constructor(e,t,n){void 0===t?t=0:t>e.length&&Tr(),void 0===n?n=e.length-t:n>e.length-t&&Tr(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Qr.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Qr?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const n=e.get(i),a=t.get(i);if(n<a)return-1;if(n>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Zr extends Qr{construct(e,t,n){return new Zr(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(const a of n){if(a.indexOf("//")>=0)throw new Ar(Ir.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);e.push(...a.split("/").filter((e=>e.length>0)))}return new Zr(e)}static emptyPath(){return new Zr([])}}const Yr=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Jr extends Qr{construct(e,t,n){return new Jr(e,t,n)}static isValidIdentifier(e){return Yr.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Jr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Jr(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const a=()=>{if(0===n.length)throw new Ar(Ir.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let r=!1;for(;i<e.length;){const t=e[i];if("\\"===t){if(i+1===e.length)throw new Ar(Ir.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[i+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Ar(Ir.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,i+=2}else"`"===t?(r=!r,i++):"."!==t||r?(n+=t,i++):(a(),i++)}if(a(),r)throw new Ar(Ir.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Jr(t)}static emptyPath(){return new Jr([])}}class Xr{constructor(e){this.path=e}static fromPath(e){return new Xr(Zr.fromString(e))}static fromName(e){return new Xr(Zr.fromString(e).popFirst(5))}static empty(){return new Xr(Zr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Zr.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Zr.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Xr(new Zr(e.slice()))}}class es{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}}es.UNKNOWN_ID=-1;function ts(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,a=Kr.fromTimestamp(1e9===i?new Gr(n+1,0):new Gr(n,i));return new is(a,Xr.empty(),t)}function ns(e){return new is(e.readTime,e.key,-1)}class is{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new is(Kr.min(),Xr.empty(),-1)}static max(){return new is(Kr.max(),Xr.empty(),-1)}}function as(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Xr.comparator(e.documentKey,t.documentKey),0!==n?n:qr(e.largestBatchId,t.largestBatchId))}const rs="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ss{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function os(e){if(e.code!==Ir.FAILED_PRECONDITION||e.message!==rs)throw e;zr("LocalStore","Unexpectedly lost primary lease")}class ls{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Tr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ls(((n,i)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,i)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ls?t:ls.resolve(t)}catch(e){return ls.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ls.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ls.reject(t)}static resolve(e){return new ls(((t,n)=>{t(e)}))}static reject(e){return new ls(((t,n)=>{n(e)}))}static waitFor(e){return new ls(((t,n)=>{let i=0,a=0,r=!1;e.forEach((e=>{++i,e.next((()=>{++a,r&&a===i&&t()}),(e=>n(e)))})),r=!0,a===i&&t()}))}static or(e){let t=ls.resolve(!1);for(const n of e)t=t.next((e=>e?ls.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,i)=>{n.push(t.call(this,e,i))})),this.waitFor(n)}static mapArray(e,t){return new ls(((n,i)=>{const a=e.length,r=new Array(a);let s=0;for(let o=0;o<a;o++){const l=o;t(e[l]).next((e=>{r[l]=e,++s,s===a&&n(r)}),(e=>i(e)))}}))}static doWhile(e,t){return new ls(((n,i)=>{const a=()=>{!0===e()?t().next((()=>{a()}),i):n()};a()}))}}function cs(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ds(e){return"IndexedDbTransactionError"===e.name}class us{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function hs(e){return null==e}function ps(e){return 0===e&&1/e==-1/0}function ms(e){return"number"==typeof e&&Number.isInteger(e)&&!ps(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}us.oe=-1;const fs=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],ys=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],gs=ys,vs=[...gs,"indexConfiguration","indexState","indexEntries"];function ws(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function xs(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function bs(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class js{constructor(e,t){this.comparator=e,this.root=t||Ns.EMPTY}insert(e,t){return new js(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ns.BLACK,null,null))}remove(e){return new js(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ns.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ks(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ks(this.root,e,this.comparator,!1)}getReverseIterator(){return new ks(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ks(this.root,e,this.comparator,!0)}}class ks{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?n(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ns{constructor(e,t,n,i,a){this.key=e,this.value=t,this.color=null!=n?n:Ns.RED,this.left=null!=i?i:Ns.EMPTY,this.right=null!=a?a:Ns.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,a){return new Ns(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=a?a:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const a=n(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===a?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ns.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return Ns.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ns.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ns.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Tr();if(this.right.isRed())throw Tr();const e=this.left.check();if(e!==this.right.check())throw Tr();return e+(this.isRed()?0:1)}}Ns.EMPTY=null,Ns.RED=!0,Ns.BLACK=!1,Ns.EMPTY=new class{constructor(){this.size=0}get key(){throw Tr()}get value(){throw Tr()}get color(){throw Tr()}get left(){throw Tr()}get right(){throw Tr()}copy(e,t,n,i,a){return this}insert(e,t,n){return new Ns(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class zs{constructor(e){this.comparator=e,this.data=new js(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new _s(this.data.getIterator())}getIteratorFrom(e){return new _s(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof zs))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new zs(this.comparator);return t.data=e,t}}class _s{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Es{constructor(e){this.fields=e,e.sort(Jr.comparator)}static empty(){return new Es([])}unionWith(e){let t=new zs(Jr.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Es(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Hr(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Ss extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ts{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Ss("Invalid base64 string: "+e):e}}(e);return new Ts(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Ts(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ts.EMPTY_BYTE_STRING=new Ts("");const Cs=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ps(e){if(Cr(!!e),"string"==typeof e){let t=0;const n=Cs.exec(e);if(Cr(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Is(e.seconds),nanos:Is(e.nanos)}}function Is(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function As(e){return"string"==typeof e?Ts.fromBase64String(e):Ts.fromUint8Array(e)}function Ms(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ds(e){const t=e.mapValue.fields.__previous_value__;return Ms(t)?Ds(t):t}function Rs(e){const t=Ps(e.mapValue.fields.__local_write_time__.timestampValue);return new Gr(t.seconds,t.nanos)}class Os{constructor(e,t,n,i,a,r,s,o,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=a,this.forceLongPolling=r,this.autoDetectLongPolling=s,this.longPollingOptions=o,this.useFetchStreams=l}}class Ls{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Ls("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Ls&&e.projectId===this.projectId&&e.database===this.database}}const Fs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Us(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ms(e)?4:no(e)?9007199254740991:eo(e)?10:11:Tr()}function Vs(e,t){if(e===t)return!0;const n=Us(e);if(n!==Us(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Rs(e).isEqual(Rs(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Ps(e.timestampValue),i=Ps(t.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return As(e.bytesValue).isEqual(As(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Is(e.geoPointValue.latitude)===Is(t.geoPointValue.latitude)&&Is(e.geoPointValue.longitude)===Is(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Is(e.integerValue)===Is(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Is(e.doubleValue),i=Is(t.doubleValue);return n===i?ps(n)===ps(i):isNaN(n)&&isNaN(i)}return!1}(e,t);case 9:return Hr(e.arrayValue.values||[],t.arrayValue.values||[],Vs);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},i=t.mapValue.fields||{};if(ws(n)!==ws(i))return!1;for(const a in n)if(n.hasOwnProperty(a)&&(void 0===i[a]||!Vs(n[a],i[a])))return!1;return!0}(e,t);default:return Tr()}}function $s(e,t){return void 0!==(e.values||[]).find((e=>Vs(e,t)))}function Bs(e,t){if(e===t)return 0;const n=Us(e),i=Us(t);if(n!==i)return qr(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return qr(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Is(e.integerValue||e.doubleValue),i=Is(t.integerValue||t.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(e,t);case 3:return Ws(e.timestampValue,t.timestampValue);case 4:return Ws(Rs(e),Rs(t));case 5:return qr(e.stringValue,t.stringValue);case 6:return function(e,t){const n=As(e),i=As(t);return n.compareTo(i)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),i=t.split("/");for(let a=0;a<n.length&&a<i.length;a++){const e=qr(n[a],i[a]);if(0!==e)return e}return qr(n.length,i.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=qr(Is(e.latitude),Is(t.latitude));return 0!==n?n:qr(Is(e.longitude),Is(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return qs(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,i,a,r;const s=e.fields||{},o=t.fields||{},l=null===(n=s.value)||void 0===n?void 0:n.arrayValue,c=null===(i=o.value)||void 0===i?void 0:i.arrayValue,d=qr((null===(a=null==l?void 0:l.values)||void 0===a?void 0:a.length)||0,(null===(r=null==c?void 0:c.values)||void 0===r?void 0:r.length)||0);return 0!==d?d:qs(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Fs.mapValue&&t===Fs.mapValue)return 0;if(e===Fs.mapValue)return 1;if(t===Fs.mapValue)return-1;const n=e.fields||{},i=Object.keys(n),a=t.fields||{},r=Object.keys(a);i.sort(),r.sort();for(let s=0;s<i.length&&s<r.length;++s){const e=qr(i[s],r[s]);if(0!==e)return e;const t=Bs(n[i[s]],a[r[s]]);if(0!==t)return t}return qr(i.length,r.length)}(e.mapValue,t.mapValue);default:throw Tr()}}function Ws(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return qr(e,t);const n=Ps(e),i=Ps(t),a=qr(n.seconds,i.seconds);return 0!==a?a:qr(n.nanos,i.nanos)}function qs(e,t){const n=e.values||[],i=t.values||[];for(let a=0;a<n.length&&a<i.length;++a){const e=Bs(n[a],i[a]);if(e)return e}return qr(n.length,i.length)}function Hs(e){return Gs(e)}function Gs(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Ps(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return As(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return Xr.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const i of e.values||[])n?n=!1:t+=",",t+=Gs(i);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",i=!0;for(const a of t)i?i=!1:n+=",",n+=`${a}:${Gs(e.fields[a])}`;return n+"}"}(e.mapValue):Tr()}function Ks(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Qs(e){return!!e&&"integerValue"in e}function Zs(e){return!!e&&"arrayValue"in e}function Ys(e){return!!e&&"nullValue"in e}function Js(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Xs(e){return!!e&&"mapValue"in e}function eo(e){var t,n;return"__vector__"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function to(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return xs(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=to(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=to(e.arrayValue.values[n]);return t}return Object.assign({},e)}function no(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class io{constructor(e){this.value=e}static empty(){return new io({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Xs(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=to(t)}setAll(e){let t=Jr.emptyPath(),n={},i=[];e.forEach(((e,a)=>{if(!t.isImmediateParentOf(a)){const e=this.getFieldsMap(t);this.applyChanges(e,n,i),n={},i=[],t=a.popLast()}e?n[a.lastSegment()]=to(e):i.push(a.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,n,i)}delete(e){const t=this.field(e.popLast());Xs(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Vs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];Xs(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){xs(t,((t,n)=>e[t]=n));for(const i of n)delete e[i]}clone(){return new io(to(this.value))}}function ao(e){const t=[];return xs(e.fields,((e,n)=>{const i=new Jr([e]);if(Xs(n)){const e=ao(n.mapValue).fields;if(0===e.length)t.push(i);else for(const n of e)t.push(i.child(n))}else t.push(i)})),new Es(t)}class ro{constructor(e,t,n,i,a,r,s){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=a,this.data=r,this.documentState=s}static newInvalidDocument(e){return new ro(e,0,Kr.min(),Kr.min(),Kr.min(),io.empty(),0)}static newFoundDocument(e,t,n,i){return new ro(e,1,t,Kr.min(),n,i,0)}static newNoDocument(e,t){return new ro(e,2,t,Kr.min(),Kr.min(),io.empty(),0)}static newUnknownDocument(e,t){return new ro(e,3,t,Kr.min(),Kr.min(),io.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Kr.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=io.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=io.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Kr.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ro&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ro(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class so{constructor(e,t){this.position=e,this.inclusive=t}}function oo(e,t,n){let i=0;for(let a=0;a<e.position.length;a++){const r=t[a],s=e.position[a];if(i=r.field.isKeyField()?Xr.comparator(Xr.fromName(s.referenceValue),n.key):Bs(s,n.data.field(r.field)),"desc"===r.dir&&(i*=-1),0!==i)break}return i}function lo(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Vs(e.position[n],t.position[n]))return!1;return!0}class co{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function uo(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class ho{}class po extends ho{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new bo(e,t,n):"array-contains"===t?new zo(e,n):"in"===t?new _o(e,n):"not-in"===t?new Eo(e,n):"array-contains-any"===t?new So(e,n):new po(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new jo(e,n):new ko(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Bs(t,this.value)):null!==t&&Us(this.value)===Us(t)&&this.matchesComparison(Bs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Tr()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class mo extends ho{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new mo(e,t)}matches(e){return fo(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function fo(e){return"and"===e.op}function yo(e){return go(e)&&fo(e)}function go(e){for(const t of e.filters)if(t instanceof mo)return!1;return!0}function vo(e){if(e instanceof po)return e.field.canonicalString()+e.op.toString()+Hs(e.value);if(yo(e))return e.filters.map((e=>vo(e))).join(",");{const t=e.filters.map((e=>vo(e))).join(",");return`${e.op}(${t})`}}function wo(e,t){return e instanceof po?function(e,t){return t instanceof po&&e.op===t.op&&e.field.isEqual(t.field)&&Vs(e.value,t.value)}(e,t):e instanceof mo?function(e,t){return t instanceof mo&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,i)=>e&&wo(n,t.filters[i])),!0)}(e,t):void Tr()}function xo(e){return e instanceof po?function(e){return`${e.field.canonicalString()} ${e.op} ${Hs(e.value)}`}(e):e instanceof mo?function(e){return e.op.toString()+" {"+e.getFilters().map(xo).join(" ,")+"}"}(e):"Filter"}class bo extends po{constructor(e,t,n){super(e,t,n),this.key=Xr.fromName(n.referenceValue)}matches(e){const t=Xr.comparator(e.key,this.key);return this.matchesComparison(t)}}class jo extends po{constructor(e,t){super(e,"in",t),this.keys=No("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class ko extends po{constructor(e,t){super(e,"not-in",t),this.keys=No("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function No(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>Xr.fromName(e.referenceValue)))}class zo extends po{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Zs(t)&&$s(t.arrayValue,this.value)}}class _o extends po{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&$s(this.value.arrayValue,t)}}class Eo extends po{constructor(e,t){super(e,"not-in",t)}matches(e){if($s(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!$s(this.value.arrayValue,t)}}class So extends po{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Zs(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>$s(this.value.arrayValue,e)))}}class To{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=a,this.startAt=r,this.endAt=s,this.ue=null}}function Co(e){return new To(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Po(e){const t=Pr(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>vo(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),hs(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Hs(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Hs(e))).join(",")),t.ue=e}return t.ue}function Io(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!uo(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!wo(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!lo(e.startAt,t.startAt)&&lo(e.endAt,t.endAt)}function Ao(e){return Xr.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Mo{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=r,this.startAt=s,this.endAt=o,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Do(e,t,n,i,a,r,s,o){return new Mo(e,t,n,i,a,r,s,o)}function Ro(e){return new Mo(e)}function Oo(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Lo(e){return null!==e.collectionGroup}function Fo(e){const t=Pr(e);if(null===t.ce){t.ce=[];const e=new Set;for(const a of t.explicitOrderBy)t.ce.push(a),e.add(a.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",i=function(e){let t=new zs(Jr.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);i.forEach((i=>{e.has(i.canonicalString())||i.isKeyField()||t.ce.push(new co(i,n))})),e.has(Jr.keyField().canonicalString())||t.ce.push(new co(Jr.keyField(),n))}return t.ce}function Uo(e){const t=Pr(e);return t.le||(t.le=Vo(t,Fo(e))),t.le}function Vo(e,t){if("F"===e.limitType)return Co(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new co(e.field,t)}));const n=e.endAt?new so(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new so(e.startAt.position,e.startAt.inclusive):null;return Co(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}}function $o(e,t){const n=e.filters.concat([t]);return new Mo(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Bo(e,t,n){return new Mo(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Wo(e,t){return Io(Uo(e),Uo(t))&&e.limitType===t.limitType}function qo(e){return`${Po(Uo(e))}|lt:${e.limitType}`}function Ho(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>xo(e))).join(", ")}]`),hs(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Hs(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Hs(e))).join(",")),`Target(${t})`}(Uo(e))}; limitType=${e.limitType})`}function Go(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Xr.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Fo(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const i=oo(e,t,n);return e.inclusive?i<=0:i<0}(e.startAt,Fo(e),t))&&!(e.endAt&&!function(e,t,n){const i=oo(e,t,n);return e.inclusive?i>=0:i>0}(e.endAt,Fo(e),t))}(e,t)}function Ko(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Qo(e){return(t,n)=>{let i=!1;for(const a of Fo(e)){const e=Zo(a,t,n);if(0!==e)return e;i=i||a.field.isKeyField()}return 0}}function Zo(e,t,n){const i=e.field.isKeyField()?Xr.comparator(t.key,n.key):function(e,t,n){const i=t.data.field(e),a=n.data.field(e);return null!==i&&null!==a?Bs(i,a):Tr()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return Tr()}}class Yo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[i,a]of n)if(this.equalsFn(i,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){xs(this.inner,((t,n)=>{for(const[i,a]of n)e(i,a)}))}isEmpty(){return bs(this.inner)}size(){return this.innerSize}}const Jo=new js(Xr.comparator);function Xo(){return Jo}const el=new js(Xr.comparator);function tl(){let e=el;for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(const a of n)e=e.insert(a.key,a);return e}function nl(e){let t=el;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function il(){return rl()}function al(){return rl()}function rl(){return new Yo((e=>e.toString()),((e,t)=>e.isEqual(t)))}const sl=new js(Xr.comparator),ol=new zs(Xr.comparator);function ll(){let e=ol;for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(const a of n)e=e.add(a);return e}const cl=new zs(qr);function dl(){return cl}function ul(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ps(t)?"-0":t}}function hl(e){return{integerValue:""+e}}function pl(e,t){return ms(t)?hl(t):ul(e,t)}class ml{constructor(){this._=void 0}}function fl(e,t,n){return e instanceof vl?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Ms(t)&&(t=Ds(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof wl?xl(e,t):e instanceof bl?jl(e,t):function(e,t){const n=gl(e,t),i=Nl(n)+Nl(e.Pe);return Qs(n)&&Qs(e.Pe)?hl(i):ul(e.serializer,i)}(e,t)}function yl(e,t,n){return e instanceof wl?xl(e,t):e instanceof bl?jl(e,t):n}function gl(e,t){return e instanceof kl?function(e){return Qs(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class vl extends ml{}class wl extends ml{constructor(e){super(),this.elements=e}}function xl(e,t){const n=zl(t);for(const i of e.elements)n.some((e=>Vs(e,i)))||n.push(i);return{arrayValue:{values:n}}}class bl extends ml{constructor(e){super(),this.elements=e}}function jl(e,t){let n=zl(t);for(const i of e.elements)n=n.filter((e=>!Vs(e,i)));return{arrayValue:{values:n}}}class kl extends ml{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Nl(e){return Is(e.integerValue||e.doubleValue)}function zl(e){return Zs(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class _l{constructor(e,t){this.version=e,this.transformResults=t}}class El{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new El}static exists(e){return new El(void 0,e)}static updateTime(e){return new El(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Sl(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Tl{}function Cl(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Ul(e.key,El.none()):new Dl(e.key,e.data,El.none());{const n=e.data,i=io.empty();let a=new zs(Jr.comparator);for(let e of t.fields)if(!a.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?i.delete(e):i.set(e,t),a=a.add(e)}return new Rl(e.key,i,new Es(a.toArray()),El.none())}}function Pl(e,t,n){e instanceof Dl?function(e,t,n){const i=e.value.clone(),a=Ll(e.fieldTransforms,t,n.transformResults);i.setAll(a),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):e instanceof Rl?function(e,t,n){if(!Sl(e.precondition,t))return void t.convertToUnknownDocument(n.version);const i=Ll(e.fieldTransforms,t,n.transformResults),a=t.data;a.setAll(Ol(e)),a.setAll(i),t.convertToFoundDocument(n.version,a).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Il(e,t,n,i){return e instanceof Dl?function(e,t,n,i){if(!Sl(e.precondition,t))return n;const a=e.value.clone(),r=Fl(e.fieldTransforms,i,t);return a.setAll(r),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null}(e,t,n,i):e instanceof Rl?function(e,t,n,i){if(!Sl(e.precondition,t))return n;const a=Fl(e.fieldTransforms,i,t),r=t.data;return r.setAll(Ol(e)),r.setAll(a),t.convertToFoundDocument(t.version,r).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,i):function(e,t,n){return Sl(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Al(e,t){let n=null;for(const i of e.fieldTransforms){const e=t.data.field(i.field),a=gl(i.transform,e||null);null!=a&&(null===n&&(n=io.empty()),n.set(i.field,a))}return n||null}function Ml(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Hr(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof wl&&t instanceof wl||e instanceof bl&&t instanceof bl?Hr(e.elements,t.elements,Vs):e instanceof kl&&t instanceof kl?Vs(e.Pe,t.Pe):e instanceof vl&&t instanceof vl}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Dl extends Tl{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Rl extends Tl{constructor(e,t,n,i){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Ol(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}})),t}function Ll(e,t,n){const i=new Map;Cr(e.length===n.length);for(let a=0;a<n.length;a++){const r=e[a],s=r.transform,o=t.data.field(r.field);i.set(r.field,yl(s,o,n[a]))}return i}function Fl(e,t,n){const i=new Map;for(const a of e){const e=a.transform,r=n.data.field(a.field);i.set(a.field,fl(e,r,t))}return i}class Ul extends Tl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Vl extends Tl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class $l{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const t=this.mutations[i];t.key.isEqual(e.key)&&Pl(t,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Il(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Il(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=al();return this.mutations.forEach((i=>{const a=e.get(i.key),r=a.overlayedDocument;let s=this.applyToLocalView(r,a.mutatedFields);s=t.has(i.key)?null:s;const o=Cl(r,s);null!==o&&n.set(i.key,o),r.isValidDocument()||r.convertToNoDocument(Kr.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ll())}isEqual(e){return this.batchId===e.batchId&&Hr(this.mutations,e.mutations,((e,t)=>Ml(e,t)))&&Hr(this.baseMutations,e.baseMutations,((e,t)=>Ml(e,t)))}}class Bl{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){Cr(e.mutations.length===n.length);let i=sl;const a=e.mutations;for(let r=0;r<a.length;r++)i=i.insert(a[r].key,n[r].version);return new Bl(e,t,n,i)}}class Wl{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class ql{constructor(e,t){this.count=e,this.unchangedNames=t}}var Hl,Gl;function Kl(e){switch(e){default:return Tr();case Ir.CANCELLED:case Ir.UNKNOWN:case Ir.DEADLINE_EXCEEDED:case Ir.RESOURCE_EXHAUSTED:case Ir.INTERNAL:case Ir.UNAVAILABLE:case Ir.UNAUTHENTICATED:return!1;case Ir.INVALID_ARGUMENT:case Ir.NOT_FOUND:case Ir.ALREADY_EXISTS:case Ir.PERMISSION_DENIED:case Ir.FAILED_PRECONDITION:case Ir.ABORTED:case Ir.OUT_OF_RANGE:case Ir.UNIMPLEMENTED:case Ir.DATA_LOSS:return!0}}function Ql(e){if(void 0===e)return _r("GRPC error has no .code"),Ir.UNKNOWN;switch(e){case Hl.OK:return Ir.OK;case Hl.CANCELLED:return Ir.CANCELLED;case Hl.UNKNOWN:return Ir.UNKNOWN;case Hl.DEADLINE_EXCEEDED:return Ir.DEADLINE_EXCEEDED;case Hl.RESOURCE_EXHAUSTED:return Ir.RESOURCE_EXHAUSTED;case Hl.INTERNAL:return Ir.INTERNAL;case Hl.UNAVAILABLE:return Ir.UNAVAILABLE;case Hl.UNAUTHENTICATED:return Ir.UNAUTHENTICATED;case Hl.INVALID_ARGUMENT:return Ir.INVALID_ARGUMENT;case Hl.NOT_FOUND:return Ir.NOT_FOUND;case Hl.ALREADY_EXISTS:return Ir.ALREADY_EXISTS;case Hl.PERMISSION_DENIED:return Ir.PERMISSION_DENIED;case Hl.FAILED_PRECONDITION:return Ir.FAILED_PRECONDITION;case Hl.ABORTED:return Ir.ABORTED;case Hl.OUT_OF_RANGE:return Ir.OUT_OF_RANGE;case Hl.UNIMPLEMENTED:return Ir.UNIMPLEMENTED;case Hl.DATA_LOSS:return Ir.DATA_LOSS;default:return Tr()}}(Gl=Hl||(Hl={}))[Gl.OK=0]="OK",Gl[Gl.CANCELLED=1]="CANCELLED",Gl[Gl.UNKNOWN=2]="UNKNOWN",Gl[Gl.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Gl[Gl.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Gl[Gl.NOT_FOUND=5]="NOT_FOUND",Gl[Gl.ALREADY_EXISTS=6]="ALREADY_EXISTS",Gl[Gl.PERMISSION_DENIED=7]="PERMISSION_DENIED",Gl[Gl.UNAUTHENTICATED=16]="UNAUTHENTICATED",Gl[Gl.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Gl[Gl.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Gl[Gl.ABORTED=10]="ABORTED",Gl[Gl.OUT_OF_RANGE=11]="OUT_OF_RANGE",Gl[Gl.UNIMPLEMENTED=12]="UNIMPLEMENTED",Gl[Gl.INTERNAL=13]="INTERNAL",Gl[Gl.UNAVAILABLE=14]="UNAVAILABLE",Gl[Gl.DATA_LOSS=15]="DATA_LOSS";let Zl=null;function Yl(){return new TextEncoder}const Jl=new sr([4294967295,4294967295],0);function Xl(e){const t=Yl().encode(e),n=new or;return n.update(t),new Uint8Array(n.digest())}function ec(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),a=t.getUint32(8,!0),r=t.getUint32(12,!0);return[new sr([n,i],0),new sr([a,r],0)]}class tc{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new nc(`Invalid padding: ${t}`);if(n<0)throw new nc(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new nc(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new nc(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=sr.fromNumber(this.Ie)}Ee(e,t,n){let i=e.add(t.multiply(sr.fromNumber(n)));return 1===i.compare(Jl)&&(i=new sr([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=Xl(e),[n,i]=ec(t);for(let a=0;a<this.hashCount;a++){const e=this.Ee(n,i,a);if(!this.de(e))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),r=new tc(a,i,t);return n.forEach((e=>r.insert(e))),r}insert(e){if(0===this.Ie)return;const t=Xl(e),[n,i]=ec(t);for(let a=0;a<this.hashCount;a++){const e=this.Ee(n,i,a);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class nc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class ic{constructor(e,t,n,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,ac.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new ic(Kr.min(),i,new js(qr),Xo(),ll())}}class ac{constructor(e,t,n,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new ac(n,t,ll(),ll(),ll())}}class rc{constructor(e,t,n,i){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=i}}class sc{constructor(e,t){this.targetId=e,this.me=t}}class oc{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ts.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class lc{constructor(){this.fe=0,this.ge=uc(),this.pe=Ts.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ll(),t=ll(),n=ll();return this.ge.forEach(((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:Tr()}})),new ac(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=uc()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Cr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class cc{constructor(e){this.Le=e,this.Be=new Map,this.ke=Xo(),this.qe=dc(),this.Qe=new js(qr)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,(t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:Tr()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((e,n)=>{this.ze(n)&&t(n)}))}He(e){const t=e.targetId,n=e.me.count,i=this.Je(t);if(i){const a=i.target;if(Ao(a))if(0===n){const e=new Xr(a.path);this.Ue(t,e,ro.newNoDocument(e,Kr.min()))}else Cr(1===n);else{const i=this.Ye(t);if(i!==n){const n=this.Ze(e),a=n?this.Xe(n,e,i):1;if(0!==a){this.je(t);const e=2===a?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}null==Zl||Zl.et(function(e,t,n,i,a){var r,s,o,l,c,d;const u={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(u.bloomFilter={applied:0===a,hashCount:null!==(r=null==h?void 0:h.hashCount)&&void 0!==r?r:0,bitmapLength:null!==(l=null===(o=null===(s=null==h?void 0:h.bits)||void 0===s?void 0:s.bitmap)||void 0===o?void 0:o.length)&&void 0!==l?l:0,padding:null!==(d=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==d?d:0,mightContain:e=>{var t;return null!==(t=null==i?void 0:i.mightContain(e))&&void 0!==t&&t}}),u}(i,e.me,this.Le.tt(),n,a))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:a=0}=t;let r,s;try{r=As(n).toUint8Array()}catch(e){if(e instanceof Ss)return Er("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{s=new tc(r,i,a)}catch(e){return Er(e instanceof nc?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===s.Ie?null:s}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let i=0;return n.forEach((n=>{const a=this.Le.tt(),r=`projects/${a.projectId}/databases/${a.database}/documents/${n.path.canonicalString()}`;e.mightContain(r)||(this.Ue(t,n,null),i++)})),i}rt(e){const t=new Map;this.Be.forEach(((n,i)=>{const a=this.Je(i);if(a){if(n.current&&Ao(a.target)){const t=new Xr(a.target.path);null!==this.ke.get(t)||this.it(i,t)||this.Ue(i,t,ro.newNoDocument(t,e))}n.be&&(t.set(i,n.ve()),n.Ce())}}));let n=ll();this.qe.forEach(((e,t)=>{let i=!0;t.forEachWhile((e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(i=!1,!1)})),i&&(n=n.add(e))})),this.ke.forEach(((t,n)=>n.setReadTime(e)));const i=new ic(e,t,this.Qe,this.ke,n);return this.ke=Xo(),this.qe=dc(),this.Qe=new js(qr),i}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new lc,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new zs(qr),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||zr("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new lc),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.Ue(e,t,null)}))}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function dc(){return new js(Xr.comparator)}function uc(){return new js(Xr.comparator)}const hc={asc:"ASCENDING",desc:"DESCENDING"},pc={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},mc={and:"AND",or:"OR"};class fc{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function yc(e,t){return e.useProto3Json||hs(t)?t:{value:t}}function gc(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function vc(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function wc(e,t){return gc(e,t.toTimestamp())}function xc(e){return Cr(!!e),Kr.fromTimestamp(function(e){const t=Ps(e);return new Gr(t.seconds,t.nanos)}(e))}function bc(e,t){return jc(e,t).canonicalString()}function jc(e,t){const n=function(e){return new Zr(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function kc(e){const t=Zr.fromString(e);return Cr(Bc(t)),t}function Nc(e,t){return bc(e.databaseId,t.path)}function zc(e,t){const n=kc(t);if(n.get(1)!==e.databaseId.projectId)throw new Ar(Ir.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Ar(Ir.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Xr(Tc(n))}function _c(e,t){return bc(e.databaseId,t)}function Ec(e){const t=kc(e);return 4===t.length?Zr.emptyPath():Tc(t)}function Sc(e){return new Zr(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Tc(e){return Cr(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Cc(e,t,n){return{name:Nc(e,t),fields:n.value.mapValue.fields}}function Pc(e,t){let n;if(t instanceof Dl)n={update:Cc(e,t.key,t.value)};else if(t instanceof Ul)n={delete:Nc(e,t.key)};else if(t instanceof Rl)n={update:Cc(e,t.key,t.data),updateMask:$c(t.fieldMask)};else{if(!(t instanceof Vl))return Tr();n={verify:Nc(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof vl)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof wl)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof bl)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof kl)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw Tr()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:wc(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Tr()}(e,t.precondition)),n}function Ic(e,t){return{documents:[_c(e,t.path)]}}function Ac(e,t){const n={structuredQuery:{}},i=t.path;let a;null!==t.collectionGroup?(a=i,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(a=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=_c(e,a);const r=function(e){if(0!==e.length)return Vc(mo.create(e,"and"))}(t.filters);r&&(n.structuredQuery.where=r);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Fc(e.field),direction:Rc(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=yc(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:a}}function Mc(e){let t=Ec(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let a=null;if(i>0){Cr(1===i);const e=n.from[0];e.allDescendants?a=e.collectionId:t=t.child(e.collectionId)}let r=[];n.where&&(r=function(e){const t=Dc(e);return t instanceof mo&&yo(t)?t.getFilters():[t]}(n.where));let s=[];n.orderBy&&(s=function(e){return e.map((e=>function(e){return new co(Uc(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,hs(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new so(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new so(n,t)}(n.endAt)),Do(t,a,s,r,o,"F",l,c)}function Dc(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Uc(e.unaryFilter.field);return po.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Uc(e.unaryFilter.field);return po.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Uc(e.unaryFilter.field);return po.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Uc(e.unaryFilter.field);return po.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Tr()}}(e):void 0!==e.fieldFilter?function(e){return po.create(Uc(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Tr()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return mo.create(e.compositeFilter.filters.map((e=>Dc(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Tr()}}(e.compositeFilter.op))}(e):Tr()}function Rc(e){return hc[e]}function Oc(e){return pc[e]}function Lc(e){return mc[e]}function Fc(e){return{fieldPath:e.canonicalString()}}function Uc(e){return Jr.fromServerFormat(e.fieldPath)}function Vc(e){return e instanceof po?function(e){if("=="===e.op){if(Js(e.value))return{unaryFilter:{field:Fc(e.field),op:"IS_NAN"}};if(Ys(e.value))return{unaryFilter:{field:Fc(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Js(e.value))return{unaryFilter:{field:Fc(e.field),op:"IS_NOT_NAN"}};if(Ys(e.value))return{unaryFilter:{field:Fc(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fc(e.field),op:Oc(e.op),value:e.value}}}(e):e instanceof mo?function(e){const t=e.getFilters().map((e=>Vc(e)));return 1===t.length?t[0]:{compositeFilter:{op:Lc(e.op),filters:t}}}(e):Tr()}function $c(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Bc(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Wc{constructor(e,t,n,i){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Kr.min(),r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Kr.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Ts.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=r,this.resumeToken=s,this.expectedCount=o}withSequenceNumber(e){return new Wc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Wc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class qc{constructor(e){this.ct=e}}function Hc(e){const t=Mc({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Bo(t,t.limit,"L"):t}class Gc{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Is(e.integerValue));else if("doubleValue"in e){const n=Is(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),ps(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),"string"==typeof n&&(n=Ps(n)),t.Rt(`${n.seconds||""}`),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(As(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?no(e)?this.dt(t,Number.MAX_SAFE_INTEGER):eo(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Tr()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const n=e.fields||{};this.dt(t,55);for(const i of Object.keys(n))this.Vt(i,t),this.Tt(n[i],t)}wt(e,t){var n,i;const a=e.fields||{};this.dt(t,53);const r="value",s=(null===(i=null===(n=a[r].arrayValue)||void 0===n?void 0:n.values)||void 0===i?void 0:i.length)||0;this.dt(t,15),t.At(Is(s)),this.Vt(r,t),this.Tt(a[r],t)}bt(e,t){const n=e.values||[];this.dt(t,50);for(const i of n)this.Tt(i,t)}yt(e,t){this.dt(t,37),Xr.fromName(e).path.forEach((e=>{this.dt(t,60),this.Dt(e,t)}))}dt(e,t){e.At(t)}ft(e){e.At(2)}}Gc.vt=new Gc;class Kc{constructor(){this.un=new Qc}addToCollectionParentIndex(e,t){return this.un.add(t),ls.resolve()}getCollectionParents(e,t){return ls.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return ls.resolve()}deleteFieldIndex(e,t){return ls.resolve()}deleteAllFieldIndexes(e){return ls.resolve()}createTargetIndexes(e,t){return ls.resolve()}getDocumentsMatchingTarget(e,t){return ls.resolve(null)}getIndexType(e,t){return ls.resolve(0)}getFieldIndexes(e,t){return ls.resolve([])}getNextCollectionGroupToUpdate(e){return ls.resolve(null)}getMinOffset(e,t){return ls.resolve(is.min())}getMinOffsetFromCollectionGroup(e,t){return ls.resolve(is.min())}updateCollectionGroup(e,t,n){return ls.resolve()}updateIndexEntries(e,t){return ls.resolve()}}class Qc{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new zs(Zr.comparator),a=!i.has(n);return this.index[t]=i.add(n),a}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new zs(Zr.comparator)).toArray()}}new Uint8Array(0);class Zc{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Zc(e,Zc.DEFAULT_COLLECTION_PERCENTILE,Zc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Zc.DEFAULT_COLLECTION_PERCENTILE=10,Zc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Zc.DEFAULT=new Zc(41943040,Zc.DEFAULT_COLLECTION_PERCENTILE,Zc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Zc.DISABLED=new Zc(-1,0,0);class Yc{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Yc(0)}static kn(){return new Yc(-1)}}class Jc{constructor(){this.changes=new Yo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ro.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?ls.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Xc{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ed{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(n=i,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&Il(n.mutation,e,Es.empty(),Gr.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,ll()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ll();const i=il();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,n).next((e=>{let t=tl();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=il();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,ll())))}populateOverlays(e,t,n){const i=[];return n.forEach((e=>{t.has(e)||i.push(e)})),this.documentOverlayCache.getOverlays(e,i).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,i){let a=Xo();const r=rl(),s=rl();return t.forEach(((e,t)=>{const s=n.get(t.key);i.has(t.key)&&(void 0===s||s.mutation instanceof Rl)?a=a.insert(t.key,t):void 0!==s?(r.set(t.key,s.mutation.getFieldMask()),Il(s.mutation,t,s.mutation.getFieldMask(),Gr.now())):r.set(t.key,Es.empty())})),this.recalculateAndSaveOverlays(e,a).next((e=>(e.forEach(((e,t)=>r.set(e,t))),t.forEach(((e,t)=>{var n;return s.set(e,new Xc(t,null!==(n=r.get(e))&&void 0!==n?n:null))})),s)))}recalculateAndSaveOverlays(e,t){const n=rl();let i=new js(((e,t)=>e-t)),a=ll();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const a of e)a.keys().forEach((e=>{const r=t.get(e);if(null===r)return;let s=n.get(e)||Es.empty();s=a.applyToLocalView(r,s),n.set(e,s);const o=(i.get(a.batchId)||ll()).add(e);i=i.insert(a.batchId,o)}))})).next((()=>{const r=[],s=i.getReverseIterator();for(;s.hasNext();){const i=s.getNext(),o=i.key,l=i.value,c=al();l.forEach((e=>{if(!a.has(e)){const i=Cl(t.get(e),n.get(e));null!==i&&c.set(e,i),a=a.add(e)}})),r.push(this.documentOverlayCache.saveOverlays(e,o,c))}return ls.waitFor(r)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,i){return function(e){return Xr.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Lo(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next((a=>{const r=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-a.size):ls.resolve(il());let s=-1,o=a;return r.next((t=>ls.forEach(t,((t,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),a.get(t)?ls.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{o=o.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,a))).next((()=>this.computeViews(e,o,t,ll()))).next((e=>({batchId:s,changes:nl(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Xr(t)).next((e=>{let t=tl();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const a=t.collectionGroup;let r=tl();return this.indexManager.getCollectionParents(e,a).next((s=>ls.forEach(s,(s=>{const o=function(e,t){return new Mo(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(a));return this.getDocumentsMatchingCollectionQuery(e,o,n,i).next((e=>{e.forEach(((e,t)=>{r=r.insert(e,t)}))}))})).next((()=>r))))}getDocumentsMatchingCollectionQuery(e,t,n,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((r=>(a=r,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,a,i)))).next((e=>{a.forEach(((t,n)=>{const i=n.getKey();null===e.get(i)&&(e=e.insert(i,ro.newInvalidDocument(i)))}));let n=tl();return e.forEach(((e,i)=>{const r=a.get(e);void 0!==r&&Il(r.mutation,i,Es.empty(),Gr.now()),Go(t,i)&&(n=n.insert(e,i))})),n}))}}class td{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return ls.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:xc(e.createTime)}}(t)),ls.resolve()}getNamedQuery(e,t){return ls.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(e){return{name:e.name,query:Hc(e.bundledQuery),readTime:xc(e.readTime)}}(t)),ls.resolve()}}class nd{constructor(){this.overlays=new js(Xr.comparator),this.Ir=new Map}getOverlay(e,t){return ls.resolve(this.overlays.get(t))}getOverlays(e,t){const n=il();return ls.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,i)=>{this.ht(e,t,i)})),ls.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Ir.get(n);return void 0!==i&&(i.forEach((e=>this.overlays=this.overlays.remove(e))),this.Ir.delete(n)),ls.resolve()}getOverlaysForCollection(e,t,n){const i=il(),a=t.length+1,r=new Xr(t.child("")),s=this.overlays.getIteratorFrom(r);for(;s.hasNext();){const e=s.getNext().value,r=e.getKey();if(!t.isPrefixOf(r.path))break;r.path.length===a&&e.largestBatchId>n&&i.set(e.getKey(),e)}return ls.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let a=new js(((e,t)=>e-t));const r=this.overlays.getIterator();for(;r.hasNext();){const e=r.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=a.get(e.largestBatchId);null===t&&(t=il(),a=a.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const s=il(),o=a.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach(((e,t)=>s.set(e,t))),!(s.size()>=i)););return ls.resolve(s)}ht(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const e=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Wl(t,n));let a=this.Ir.get(t);void 0===a&&(a=ll(),this.Ir.set(t,a)),this.Ir.set(t,a.add(n.key))}}class id{constructor(){this.sessionToken=Ts.EMPTY_BYTE_STRING}getSessionToken(e){return ls.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ls.resolve()}}class ad{constructor(){this.Tr=new zs(rd.Er),this.dr=new zs(rd.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new rd(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Vr(new rd(e,t))}mr(e,t){e.forEach((e=>this.removeReference(e,t)))}gr(e){const t=new Xr(new Zr([])),n=new rd(t,e),i=new rd(t,e+1),a=[];return this.dr.forEachInRange([n,i],(e=>{this.Vr(e),a.push(e.key)})),a}pr(){this.Tr.forEach((e=>this.Vr(e)))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new Xr(new Zr([])),n=new rd(t,e),i=new rd(t,e+1);let a=ll();return this.dr.forEachInRange([n,i],(e=>{a=a.add(e.key)})),a}containsKey(e){const t=new rd(e,0),n=this.Tr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class rd{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return Xr.comparator(e.key,t.key)||qr(e.wr,t.wr)}static Ar(e,t){return qr(e.wr,t.wr)||Xr.comparator(e.key,t.key)}}class sd{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new zs(rd.Er)}checkEmpty(e){return ls.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const a=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const r=new $l(a,t,n,i);this.mutationQueue.push(r);for(const s of i)this.br=this.br.add(new rd(s.key,a)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast());return ls.resolve(r)}lookupMutationBatch(e,t){return ls.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.vr(n),a=i<0?0:i;return ls.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ls.resolve(0===this.mutationQueue.length?-1:this.Sr-1)}getAllMutationBatches(e){return ls.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new rd(t,0),i=new rd(t,Number.POSITIVE_INFINITY),a=[];return this.br.forEachInRange([n,i],(e=>{const t=this.Dr(e.wr);a.push(t)})),ls.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new zs(qr);return t.forEach((e=>{const t=new rd(e,0),i=new rd(e,Number.POSITIVE_INFINITY);this.br.forEachInRange([t,i],(e=>{n=n.add(e.wr)}))})),ls.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let a=n;Xr.isDocumentKey(a)||(a=a.child(""));const r=new rd(new Xr(a),0);let s=new zs(qr);return this.br.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===i&&(s=s.add(e.wr)),!0)}),r),ls.resolve(this.Cr(s))}Cr(e){const t=[];return e.forEach((e=>{const n=this.Dr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Cr(0===this.Fr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.br;return ls.forEach(t.mutations,(i=>{const a=new rd(i.key,t.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.br=n}))}On(e){}containsKey(e,t){const n=new rd(t,0),i=this.br.firstAfterOrEqual(n);return ls.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ls.resolve()}Fr(e,t){return this.vr(e)}vr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class od{constructor(e){this.Mr=e,this.docs=new js(Xr.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),a=i?i.size:0,r=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:r}),this.size+=r-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ls.resolve(n?n.document.mutableCopy():ro.newInvalidDocument(t))}getEntries(e,t){let n=Xo();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():ro.newInvalidDocument(e))})),ls.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let a=Xo();const r=t.path,s=new Xr(r.child("")),o=this.docs.getIteratorFrom(s);for(;o.hasNext();){const{key:e,value:{document:s}}=o.getNext();if(!r.isPrefixOf(e.path))break;e.path.length>r.length+1||as(ns(s),n)<=0||(i.has(s.key)||Go(t,s))&&(a=a.insert(s.key,s.mutableCopy()))}return ls.resolve(a)}getAllFromCollectionGroup(e,t,n,i){Tr()}Or(e,t){return ls.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new ld(this)}getSize(e){return ls.resolve(this.size)}}class ld extends Jc{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)})),ls.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}class cd{constructor(e){this.persistence=e,this.Nr=new Yo((e=>Po(e)),Io),this.lastRemoteSnapshotVersion=Kr.min(),this.highestTargetId=0,this.Lr=0,this.Br=new ad,this.targetCount=0,this.kr=Yc.Bn()}forEachTarget(e,t){return this.Nr.forEach(((e,n)=>t(n))),ls.resolve()}getLastRemoteSnapshotVersion(e){return ls.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ls.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),ls.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),ls.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Yc(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,ls.resolve()}updateTargetData(e,t){return this.Kn(t),ls.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,ls.resolve()}removeTargets(e,t,n){let i=0;const a=[];return this.Nr.forEach(((r,s)=>{s.sequenceNumber<=t&&null===n.get(s.targetId)&&(this.Nr.delete(r),a.push(this.removeMatchingKeysForTargetId(e,s.targetId)),i++)})),ls.waitFor(a).next((()=>i))}getTargetCount(e){return ls.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return ls.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),ls.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach((t=>{a.push(i.markPotentiallyOrphaned(e,t))})),ls.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),ls.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return ls.resolve(n)}containsKey(e,t){return ls.resolve(this.Br.containsKey(t))}}class dd{constructor(e,t){this.qr={},this.overlays={},this.Qr=new us(0),this.Kr=!1,this.Kr=!0,this.$r=new id,this.referenceDelegate=e(this),this.Ur=new cd(this),this.indexManager=new Kc,this.remoteDocumentCache=function(e){return new od(e)}((e=>this.referenceDelegate.Wr(e))),this.serializer=new qc(t),this.Gr=new td(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new nd,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new sd(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){zr("MemoryPersistence","Starting transaction:",e);const i=new ud(this.Qr.next());return this.referenceDelegate.zr(),n(i).next((e=>this.referenceDelegate.jr(i).next((()=>e)))).toPromise().then((e=>(i.raiseOnCommittedEvent(),e)))}Hr(e,t){return ls.or(Object.values(this.qr).map((n=>()=>n.containsKey(e,t))))}}class ud extends ss{constructor(e){super(),this.currentSequenceNumber=e}}class hd{constructor(e){this.persistence=e,this.Jr=new ad,this.Yr=null}static Zr(e){return new hd(e)}get Xr(){if(this.Yr)return this.Yr;throw Tr()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),ls.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),ls.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),ls.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach((e=>this.Xr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Xr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ls.forEach(this.Xr,(n=>{const i=Xr.fromPath(n);return this.ei(e,i).next((e=>{e||t.removeEntry(i,Kr.min())}))})).next((()=>(this.Yr=null,t.apply(e))))}updateLimboDocument(e,t){return this.ei(e,t).next((e=>{e?this.Xr.delete(t.toString()):this.Xr.add(t.toString())}))}Wr(e){return 0}ei(e,t){return ls.or([()=>ls.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class pd{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=i}static Wi(e,t){let n=ll(),i=ll();for(const a of t.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new pd(e,t.fromCache,n,i)}}class md{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class fd{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=re()?8:cs(ie())>0?6:4}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,i){const a={result:null};return this.Yi(e,t).next((e=>{a.result=e})).next((()=>{if(!a.result)return this.Zi(e,t,i,n).next((e=>{a.result=e}))})).next((()=>{if(a.result)return;const n=new md;return this.Xi(e,t,n).next((i=>{if(a.result=i,this.zi)return this.es(e,t,n,i.size)}))})).next((()=>a.result))}es(e,t,n,i){return n.documentReadCount<this.ji?(Nr()<=ze.DEBUG&&zr("QueryEngine","SDK will not create cache indexes for query:",Ho(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ls.resolve()):(Nr()<=ze.DEBUG&&zr("QueryEngine","Query:",Ho(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(Nr()<=ze.DEBUG&&zr("QueryEngine","The SDK decides to create cache indexes for query:",Ho(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Uo(t))):ls.resolve())}Yi(e,t){if(Oo(t))return ls.resolve(null);let n=Uo(t);return this.indexManager.getIndexType(e,n).next((i=>0===i?null:(null!==t.limit&&1===i&&(t=Bo(t,null,"F"),n=Uo(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const a=ll(...i);return this.Ji.getDocuments(e,a).next((i=>this.indexManager.getMinOffset(e,n).next((n=>{const r=this.ts(t,i);return this.ns(t,r,a,n.readTime)?this.Yi(e,Bo(t,null,"F")):this.rs(e,r,t,n)}))))})))))}Zi(e,t,n,i){return Oo(t)||i.isEqual(Kr.min())?ls.resolve(null):this.Ji.getDocuments(e,n).next((a=>{const r=this.ts(t,a);return this.ns(t,r,n,i)?ls.resolve(null):(Nr()<=ze.DEBUG&&zr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ho(t)),this.rs(e,r,t,ts(i,-1)).next((e=>e)))}))}ts(e,t){let n=new zs(Qo(e));return t.forEach(((t,i)=>{Go(e,i)&&(n=n.add(i))})),n}ns(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Xi(e,t,n){return Nr()<=ze.DEBUG&&zr("QueryEngine","Using full collection scan to execute query:",Ho(t)),this.Ji.getDocumentsMatchingQuery(e,t,is.min(),n)}rs(e,t,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class yd{constructor(e,t,n,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new js(qr),this._s=new Yo((e=>Po(e)),Io),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ed(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.os)))}}function gd(e,t,n,i){return new yd(e,t,n,i)}async function vd(e,t){const n=Pr(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let i;return n.mutationQueue.getAllMutationBatches(e).next((a=>(i=a,n.ls(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const a=[],r=[];let s=ll();for(const e of i){a.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}for(const e of t){r.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}return n.localDocuments.getDocuments(e,s).next((e=>({hs:e,removedBatchIds:a,addedBatchIds:r})))}))}))}function wd(e){const t=Pr(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Ur.getLastRemoteSnapshotVersion(e)))}function xd(e,t,n){let i=ll(),a=ll();return n.forEach((e=>i=i.add(e))),t.getEntries(e,i).next((e=>{let i=Xo();return n.forEach(((n,r)=>{const s=e.get(n);r.isFoundDocument()!==s.isFoundDocument()&&(a=a.add(n)),r.isNoDocument()&&r.version.isEqual(Kr.min())?(t.removeEntry(n,r.readTime),i=i.insert(n,r)):!s.isValidDocument()||r.version.compareTo(s.version)>0||0===r.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(r),i=i.insert(n,r)):zr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",r.version)})),{Ps:i,Is:a}}))}function bd(e,t){const n=Pr(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function jd(e,t){const n=Pr(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let i;return n.Ur.getTargetData(e,t).next((a=>a?(i=a,ls.resolve(i)):n.Ur.allocateTargetId(e).next((a=>(i=new Wc(t,a,"TargetPurposeListen",e.currentSequenceNumber),n.Ur.addTargetData(e,i).next((()=>i)))))))})).then((e=>{const i=n.os.get(e.targetId);return(null===i||e.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(e.targetId,e),n._s.set(t,e.targetId)),e}))}async function kd(e,t,n){const i=Pr(e),a=i.os.get(t),r=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",r,(e=>i.persistence.referenceDelegate.removeTarget(e,a)))}catch(e){if(!ds(e))throw e;zr("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}i.os=i.os.remove(t),i._s.delete(a.target)}function Nd(e,t,n){const i=Pr(e);let a=Kr.min(),r=ll();return i.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const i=Pr(e),a=i._s.get(n);return void 0!==a?ls.resolve(i.os.get(a)):i.Ur.getTargetData(t,n)}(i,e,Uo(t)).next((t=>{if(t)return a=t.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(e,t.targetId).next((e=>{r=e}))})).next((()=>i.ss.getDocumentsMatchingQuery(e,t,n?a:Kr.min(),n?r:ll()))).next((e=>(zd(i,Ko(t),e),{documents:e,Ts:r})))))}function zd(e,t,n){let i=e.us.get(t)||Kr.min();n.forEach(((e,t)=>{t.readTime.compareTo(i)>0&&(i=t.readTime)})),e.us.set(t,i)}class _d{constructor(){this.activeTargetIds=dl()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ed{constructor(){this.so=new _d,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new _d,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Sd{_o(e){}shutdown(){}}class Td{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){zr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){zr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Cd=null;function Pd(){return null===Cd?Cd=268435456+Math.round(2147483648*Math.random()):Cd++,"0x"+Cd.toString(16)}const Id={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Ad{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}const Md="WebChannelConnection";class Dd extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=t+"://"+e.host,this.vo=`projects/${n}/databases/${i}`,this.Co="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${i}`}get Fo(){return!1}Mo(e,t,n,i,a){const r=Pd(),s=this.xo(e,t.toUriEncodedString());zr("RestConnection",`Sending RPC '${e}' ${r}:`,s,n);const o={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(o,i,a),this.No(e,s,o,n).then((t=>(zr("RestConnection",`Received RPC '${e}' ${r}: `,t),t)),(t=>{throw Er("RestConnection",`RPC '${e}' ${r} failed with error: `,t,"url: ",s,"request:",n),t}))}Lo(e,t,n,i,a,r){return this.Mo(e,t,n,i,a)}Oo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+jr,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}xo(e,t){const n=Id[e];return`${this.Do}/v1/${t}:${n}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,i){const a=Pd();return new Promise(((r,s)=>{const o=new dr;o.setWithCredentials(!0),o.listenOnce(hr.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case pr.NO_ERROR:const t=o.getResponseJson();zr(Md,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(t)),r(t);break;case pr.TIMEOUT:zr(Md,`RPC '${e}' ${a} timed out`),s(new Ar(Ir.DEADLINE_EXCEEDED,"Request time out"));break;case pr.HTTP_ERROR:const n=o.getStatus();if(zr(Md,`RPC '${e}' ${a} failed with status:`,n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Ir).indexOf(t)>=0?t:Ir.UNKNOWN}(t.status);s(new Ar(e,t.message))}else s(new Ar(Ir.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Ar(Ir.UNAVAILABLE,"Connection failed."));break;default:Tr()}}finally{zr(Md,`RPC '${e}' ${a} completed.`)}}));const l=JSON.stringify(i);zr(Md,`RPC '${e}' ${a} sending request:`,i),o.send(t,"POST",l,n,15)}))}Bo(e,t,n){const i=Pd(),a=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],r=gr(),s=yr(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Oo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=a.join("");zr(Md,`Creating RPC '${e}' stream ${i}: ${c}`,o);const d=r.createWebChannel(c,o);let u=!1,h=!1;const p=new Ad({Io:t=>{h?zr(Md,`Not sending because RPC '${e}' stream ${i} is closed:`,t):(u||(zr(Md,`Opening RPC '${e}' stream ${i} transport.`),d.open(),u=!0),zr(Md,`RPC '${e}' stream ${i} sending:`,t),d.send(t))},To:()=>d.close()}),m=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return m(d,ur.EventType.OPEN,(()=>{h||(zr(Md,`RPC '${e}' stream ${i} transport opened.`),p.yo())})),m(d,ur.EventType.CLOSE,(()=>{h||(h=!0,zr(Md,`RPC '${e}' stream ${i} transport closed`),p.So())})),m(d,ur.EventType.ERROR,(t=>{h||(h=!0,Er(Md,`RPC '${e}' stream ${i} transport errored:`,t),p.So(new Ar(Ir.UNAVAILABLE,"The operation could not be completed")))})),m(d,ur.EventType.MESSAGE,(t=>{var n;if(!h){const a=t.data[0];Cr(!!a);const r=a,s=r.error||(null===(n=r[0])||void 0===n?void 0:n.error);if(s){zr(Md,`RPC '${e}' stream ${i} received error:`,s);const t=s.status;let n=function(e){const t=Hl[e];if(void 0!==t)return Ql(t)}(t),a=s.message;void 0===n&&(n=Ir.INTERNAL,a="Unknown error status: "+t+" with message "+s.message),h=!0,p.So(new Ar(n,a)),d.close()}else zr(Md,`RPC '${e}' stream ${i} received:`,a),p.bo(a)}})),m(s,fr.STAT_EVENT,(t=>{t.stat===mr.PROXY?zr(Md,`RPC '${e}' stream ${i} detected buffering proxy`):t.stat===mr.NOPROXY&&zr(Md,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{p.wo()}),0),p}}function Rd(){return"undefined"!=typeof document?document:null}function Od(e){return new fc(e,!0)}class Ld{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ui=e,this.timerId=t,this.ko=n,this.qo=i,this.Qo=a,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-n);i>0&&zr("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,(()=>(this.Uo=Date.now(),e()))),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){null!==this.$o&&(this.$o.skipDelay(),this.$o=null)}cancel(){null!==this.$o&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}class Fd{constructor(e,t,n,i,a,r,s,o){this.ui=e,this.Ho=n,this.Jo=i,this.connection=a,this.authCredentialsProvider=r,this.appCheckCredentialsProvider=s,this.listener=o,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Ld(e,t)}n_(){return 1===this.state||5===this.state||this.r_()}r_(){return 2===this.state||3===this.state}start(){this.e_=0,4!==this.state?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&null===this.Zo&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,(()=>this.__())))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,4!==e?this.t_.reset():t&&t.code===Ir.RESOURCE_EXHAUSTED?(_r(t.toString()),_r("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===Ir.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,i]=e;this.Yo===t&&this.P_(n,i)}),(t=>{e((()=>{const e=new Ar(Ir.UNKNOWN,"Fetching auth token failed: "+t.message);return this.I_(e)}))}))}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo((()=>{n((()=>this.listener.Eo()))})),this.stream.Ro((()=>{n((()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,(()=>(this.r_()&&(this.state=3),Promise.resolve()))),this.listener.Ro())))})),this.stream.mo((e=>{n((()=>this.I_(e)))})),this.stream.onMessage((e=>{n((()=>1==++this.e_?this.E_(e):this.onNext(e)))}))}i_(){this.state=5,this.t_.Go((async()=>{this.state=0,this.start()}))}I_(e){return zr("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget((()=>this.Yo===e?t():(zr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Ud extends Fd{constructor(e,t,n,i,a,r){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,r),this.serializer=a}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Tr()}(t.targetChange.targetChangeType||"NO_CHANGE"),a=t.targetChange.targetIds||[],r=function(e,t){return e.useProto3Json?(Cr(void 0===t||"string"==typeof t),Ts.fromBase64String(t||"")):(Cr(void 0===t||t instanceof Buffer||t instanceof Uint8Array),Ts.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,o=s&&function(e){const t=void 0===e.code?Ir.UNKNOWN:Ql(e.code);return new Ar(t,e.message||"")}(s);n=new oc(i,a,r,o||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const a=zc(e,i.document.name),r=xc(i.document.updateTime),s=i.document.createTime?xc(i.document.createTime):Kr.min(),o=new io({mapValue:{fields:i.document.fields}}),l=ro.newFoundDocument(a,r,s,o),c=i.targetIds||[],d=i.removedTargetIds||[];n=new rc(c,d,l.key,l)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const a=zc(e,i.document),r=i.readTime?xc(i.readTime):Kr.min(),s=ro.newNoDocument(a,r),o=i.removedTargetIds||[];n=new rc([],o,s.key,s)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const a=zc(e,i.document),r=i.removedTargetIds||[];n=new rc([],r,a,null)}else{if(!("filter"in t))return Tr();{t.filter;const e=t.filter;e.targetId;const{count:i=0,unchangedNames:a}=e,r=new ql(i,a),s=e.targetId;n=new sc(s,r)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Kr.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Kr.min():t.readTime?xc(t.readTime):Kr.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=Sc(this.serializer),t.addTarget=function(e,t){let n;const i=t.target;if(n=Ao(i)?{documents:Ic(e,i)}:{query:Ac(e,i)._t},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=vc(e,t.resumeToken);const i=yc(e,t.expectedCount);null!==i&&(n.expectedCount=i)}else if(t.snapshotVersion.compareTo(Kr.min())>0){n.readTime=gc(e,t.snapshotVersion.toTimestamp());const i=yc(e,t.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Tr()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=Sc(this.serializer),t.removeTarget=e,this.a_(t)}}class Vd extends Fd{constructor(e,t,n,i,a,r){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,r),this.serializer=a}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Cr(!!e.streamToken),this.lastStreamToken=e.streamToken,Cr(!e.writeResults||0===e.writeResults.length),this.listener.f_()}onNext(e){Cr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=function(e,t){return e&&e.length>0?(Cr(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?xc(e.updateTime):xc(t);return n.isEqual(Kr.min())&&(n=xc(t)),new _l(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=xc(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=Sc(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Pc(this.serializer,e)))};this.a_(t)}}class $d extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new Ar(Ir.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((a=>{let[r,s]=a;return this.connection.Mo(e,jc(t,n),i,r,s)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Ir.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Ar(Ir.UNKNOWN,e.toString())}))}Lo(e,t,n,i,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((r=>{let[s,o]=r;return this.connection.Lo(e,jc(t,n),i,s,o,a)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Ir.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Ar(Ir.UNKNOWN,e.toString())}))}terminate(){this.y_=!0,this.connection.terminate()}}class Bd{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){0===this.S_&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve()))))}M_(e){"Online"===this.state?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,"Online"===e&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(_r(t),this.D_=!1):zr("OnlineStateTracker",t)}x_(){null!==this.b_&&(this.b_.cancel(),this.b_=null)}}class Wd{constructor(e,t,n,i,a){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=a,this.k_._o((e=>{n.enqueueAndForget((async()=>{Xd(this)&&(zr("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Pr(e);t.L_.add(4),await Hd(t),t.q_.set("Unknown"),t.L_.delete(4),await qd(t)}(this))}))})),this.q_=new Bd(n,i)}}async function qd(e){if(Xd(e))for(const t of e.B_)await t(!0)}async function Hd(e){for(const t of e.B_)await t(!1)}function Gd(e,t){const n=Pr(e);n.N_.has(t.targetId)||(n.N_.set(t.targetId,t),Jd(n)?Yd(n):vu(n).r_()&&Qd(n,t))}function Kd(e,t){const n=Pr(e),i=vu(n);n.N_.delete(t),i.r_()&&Zd(n,t),0===n.N_.size&&(i.r_()?i.o_():Xd(n)&&n.q_.set("Unknown"))}function Qd(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Kr.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}vu(e).A_(t)}function Zd(e,t){e.Q_.xe(t),vu(e).R_(t)}function Yd(e){e.Q_=new cc({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),vu(e).start(),e.q_.v_()}function Jd(e){return Xd(e)&&!vu(e).n_()&&e.N_.size>0}function Xd(e){return 0===Pr(e).L_.size}function eu(e){e.Q_=void 0}async function tu(e){e.q_.set("Online")}async function nu(e){e.N_.forEach(((t,n)=>{Qd(e,t)}))}async function iu(e,t){eu(e),Jd(e)?(e.q_.M_(t),Yd(e)):e.q_.set("Unknown")}async function au(e,t,n){if(e.q_.set("Online"),t instanceof oc&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const i of t.targetIds)e.N_.has(i)&&(await e.remoteSyncer.rejectListen(i,n),e.N_.delete(i),e.Q_.removeTarget(i))}(e,t)}catch(n){zr("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await ru(e,n)}else if(t instanceof rc?e.Q_.Ke(t):t instanceof sc?e.Q_.He(t):e.Q_.We(t),!n.isEqual(Kr.min()))try{const t=await wd(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Q_.rt(t);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const a=e.N_.get(i);a&&e.N_.set(i,a.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const i=e.N_.get(t);if(!i)return;e.N_.set(t,i.withResumeToken(Ts.EMPTY_BYTE_STRING,i.snapshotVersion)),Zd(e,t);const a=new Wc(i.target,t,n,i.sequenceNumber);Qd(e,a)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){zr("RemoteStore","Failed to raise snapshot:",t),await ru(e,t)}}async function ru(e,t,n){if(!ds(t))throw t;e.L_.add(1),await Hd(e),e.q_.set("Offline"),n||(n=()=>wd(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{zr("RemoteStore","Retrying IndexedDB access"),await n(),e.L_.delete(1),await qd(e)}))}function su(e,t){return t().catch((n=>ru(e,n,t)))}async function ou(e){const t=Pr(e),n=wu(t);let i=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;lu(t);)try{const e=await bd(t.localStore,i);if(null===e){0===t.O_.length&&n.o_();break}i=e.batchId,cu(t,e)}catch(e){await ru(t,e)}du(t)&&uu(t)}function lu(e){return Xd(e)&&e.O_.length<10}function cu(e,t){e.O_.push(t);const n=wu(e);n.r_()&&n.V_&&n.m_(t.mutations)}function du(e){return Xd(e)&&!wu(e).n_()&&e.O_.length>0}function uu(e){wu(e).start()}async function hu(e){wu(e).p_()}async function pu(e){const t=wu(e);for(const n of e.O_)t.m_(n.mutations)}async function mu(e,t,n){const i=e.O_.shift(),a=Bl.from(i,t,n);await su(e,(()=>e.remoteSyncer.applySuccessfulWrite(a))),await ou(e)}async function fu(e,t){t&&wu(e).V_&&await async function(e,t){if(function(e){return Kl(e)&&e!==Ir.ABORTED}(t.code)){const n=e.O_.shift();wu(e).s_(),await su(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await ou(e)}}(e,t),du(e)&&uu(e)}async function yu(e,t){const n=Pr(e);n.asyncQueue.verifyOperationInProgress(),zr("RemoteStore","RemoteStore received new credentials");const i=Xd(n);n.L_.add(3),await Hd(n),i&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.L_.delete(3),await qd(n)}async function gu(e,t){const n=Pr(e);t?(n.L_.delete(2),await qd(n)):t||(n.L_.add(2),await Hd(n),n.q_.set("Unknown"))}function vu(e){return e.K_||(e.K_=function(e,t,n){const i=Pr(e);return i.w_(),new Ud(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{Eo:tu.bind(null,e),Ro:nu.bind(null,e),mo:iu.bind(null,e),d_:au.bind(null,e)}),e.B_.push((async t=>{t?(e.K_.s_(),Jd(e)?Yd(e):e.q_.set("Unknown")):(await e.K_.stop(),eu(e))}))),e.K_}function wu(e){return e.U_||(e.U_=function(e,t,n){const i=Pr(e);return i.w_(),new Vd(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:hu.bind(null,e),mo:fu.bind(null,e),f_:pu.bind(null,e),g_:mu.bind(null,e)}),e.B_.push((async t=>{t?(e.U_.s_(),await ou(e)):(await e.U_.stop(),e.O_.length>0&&(zr("RemoteStore",`Stopping write stream with ${e.O_.length} pending writes`),e.O_=[]))}))),e.U_}class xu{constructor(e,t,n,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new Mr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,a){const r=Date.now()+n,s=new xu(e,t,r,i,a);return s.start(n),s}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ar(Ir.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function bu(e,t){if(_r("AsyncQueue",`${t}: ${e}`),ds(e))return new Ar(Ir.UNAVAILABLE,`${t}: ${e}`);throw e}class ju{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Xr.comparator(t.key,n.key):(e,t)=>Xr.comparator(e.key,t.key),this.keyedMap=tl(),this.sortedSet=new js(this.comparator)}static emptySet(e){return new ju(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ju))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(!e.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new ju;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class ku{constructor(){this.W_=new js(Xr.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?0!==e.type&&3===n.type?this.W_=this.W_.insert(t,e):3===e.type&&1!==n.type?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.W_=this.W_.remove(t):1===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Tr():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Nu{constructor(e,t,n,i,a,r,s,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=a,this.fromCache=r,this.syncStateChanged=s,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,i,a){const r=[];return t.forEach((e=>{r.push({type:0,doc:e})})),new Nu(e,t,ju.emptySet(t),r,n,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Wo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}class zu{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some((e=>e.J_()))}}class _u{constructor(){this.queries=Eu(),this.onlineState="Unknown",this.Y_=new Set}terminate(){!function(e,t){const n=Pr(e),i=n.queries;n.queries=Eu(),i.forEach(((e,n)=>{for(const i of n.j_)i.onError(t)}))}(this,new Ar(Ir.ABORTED,"Firestore shutting down"))}}function Eu(){return new Yo((e=>qo(e)),Wo)}async function Su(e,t){const n=Pr(e);let i=3;const a=t.query;let r=n.queries.get(a);r?!r.H_()&&t.J_()&&(i=2):(r=new zu,i=t.J_()?0:1);try{switch(i){case 0:r.z_=await n.onListen(a,!0);break;case 1:r.z_=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(e){const n=bu(e,`Initialization of query '${Ho(t.query)}' failed`);return void t.onError(n)}n.queries.set(a,r),r.j_.push(t),t.Z_(n.onlineState),r.z_&&t.X_(r.z_)&&Iu(n)}async function Tu(e,t){const n=Pr(e),i=t.query;let a=3;const r=n.queries.get(i);if(r){const e=r.j_.indexOf(t);e>=0&&(r.j_.splice(e,1),0===r.j_.length?a=t.J_()?0:1:!r.H_()&&t.J_()&&(a=2))}switch(a){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function Cu(e,t){const n=Pr(e);let i=!1;for(const a of t){const e=a.query,t=n.queries.get(e);if(t){for(const e of t.j_)e.X_(a)&&(i=!0);t.z_=a}}i&&Iu(n)}function Pu(e,t,n){const i=Pr(e),a=i.queries.get(t);if(a)for(const r of a.j_)r.onError(n);i.queries.delete(t)}function Iu(e){e.Y_.forEach((e=>{e.next()}))}var Au,Mu;(Mu=Au||(Au={})).ea="default",Mu.Cache="cache";class Du{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Nu(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache)return!0;if(!this.J_())return!0;const n="Offline"!==t;return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}oa(e){e=Nu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Au.Cache}}class Ru{constructor(e){this.key=e}}class Ou{constructor(e){this.key=e}}class Lu{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ll(),this.mutatedKeys=ll(),this.Aa=Qo(e),this.Ra=new ju(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new ku,i=t?t.Ra:this.Ra;let a=t?t.mutatedKeys:this.mutatedKeys,r=i,s=!1;const o="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((e,t)=>{const c=i.get(e),d=Go(this.query,t)?t:null,u=!!c&&this.mutatedKeys.has(c.key),h=!!d&&(d.hasLocalMutations||this.mutatedKeys.has(d.key)&&d.hasCommittedMutations);let p=!1;c&&d?c.data.isEqual(d.data)?u!==h&&(n.track({type:3,doc:d}),p=!0):this.ga(c,d)||(n.track({type:2,doc:d}),p=!0,(o&&this.Aa(d,o)>0||l&&this.Aa(d,l)<0)&&(s=!0)):!c&&d?(n.track({type:0,doc:d}),p=!0):c&&!d&&(n.track({type:1,doc:c}),p=!0,(o||l)&&(s=!0)),p&&(d?(r=r.add(d),a=h?a.add(e):a.delete(e)):(r=r.delete(e),a=a.delete(e)))})),null!==this.query.limit)for(;r.size>this.query.limit;){const e="F"===this.query.limitType?r.last():r.first();r=r.delete(e.key),a=a.delete(e.key),n.track({type:1,doc:e})}return{Ra:r,fa:n,ns:s,mutatedKeys:a}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const a=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const r=e.fa.G_();r.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Tr()}};return n(e)-n(t)}(e.type,t.type)||this.Aa(e.doc,t.doc))),this.pa(n),i=null!=i&&i;const s=t&&!i?this.ya():[],o=0===this.da.size&&this.current&&!i?1:0,l=o!==this.Ea;return this.Ea=o,0!==r.length||l?{snapshot:new Nu(this.query,e.Ra,a,r,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:s}:{wa:s}}Z_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new ku,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach((e=>this.Ta=this.Ta.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Ta=this.Ta.delete(e))),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ll(),this.Ra.forEach((e=>{this.Sa(e.key)&&(this.da=this.da.add(e.key))}));const t=[];return e.forEach((e=>{this.da.has(e)||t.push(new Ou(e))})),this.da.forEach((n=>{e.has(n)||t.push(new Ru(n))})),t}ba(e){this.Ta=e.Ts,this.da=ll();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Nu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,0===this.Ea,this.hasCachedResults)}}class Fu{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Uu{constructor(e){this.key=e,this.va=!1}}class Vu{constructor(e,t,n,i,a,r){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=r,this.Ca={},this.Fa=new Yo((e=>qo(e)),Wo),this.Ma=new Map,this.xa=new Set,this.Oa=new js(Xr.comparator),this.Na=new Map,this.La=new ad,this.Ba={},this.ka=new Map,this.qa=Yc.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return!0===this.Qa}}async function $u(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=ch(e);let a;const r=i.Fa.get(t);return r?(i.sharedClientState.addLocalQueryTarget(r.targetId),a=r.view.Da()):a=await Wu(i,t,n,!0),a}async function Bu(e,t){const n=ch(e);await Wu(n,t,!0,!1)}async function Wu(e,t,n,i){const a=await jd(e.localStore,Uo(t)),r=a.targetId,s=e.sharedClientState.addLocalQueryTarget(r,n);let o;return i&&(o=await qu(e,t,r,"current"===s,a.resumeToken)),e.isPrimaryClient&&n&&Gd(e.remoteStore,a),o}async function qu(e,t,n,i,a){e.Ka=(t,n,i)=>async function(e,t,n,i){let a=t.view.ma(n);a.ns&&(a=await Nd(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.ma(n,a)})));const r=i&&i.targetChanges.get(t.targetId),s=i&&null!=i.targetMismatches.get(t.targetId),o=t.view.applyChanges(a,e.isPrimaryClient,r,s);return ih(e,t.targetId,o.wa),o.snapshot}(e,t,n,i);const r=await Nd(e.localStore,t,!0),s=new Lu(t,r.Ts),o=s.ma(r.documents),l=ac.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==e.onlineState,a),c=s.applyChanges(o,e.isPrimaryClient,l);ih(e,n,c.wa);const d=new Fu(t,n,s);return e.Fa.set(t,d),e.Ma.has(n)?e.Ma.get(n).push(t):e.Ma.set(n,[t]),c.snapshot}async function Hu(e,t,n){const i=Pr(e),a=i.Fa.get(t),r=i.Ma.get(a.targetId);if(r.length>1)return i.Ma.set(a.targetId,r.filter((e=>!Wo(e,t)))),void i.Fa.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(a.targetId),i.sharedClientState.isActiveQueryTarget(a.targetId)||await kd(i.localStore,a.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(a.targetId),n&&Kd(i.remoteStore,a.targetId),th(i,a.targetId)})).catch(os)):(th(i,a.targetId),await kd(i.localStore,a.targetId,!0))}async function Gu(e,t){const n=Pr(e),i=n.Fa.get(t),a=n.Ma.get(i.targetId);n.isPrimaryClient&&1===a.length&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),Kd(n.remoteStore,i.targetId))}async function Ku(e,t){const n=Pr(e);try{const e=await function(e,t){const n=Pr(e),i=t.snapshotVersion;let a=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const r=n.cs.newChangeBuffer({trackRemovals:!0});a=n.os;const s=[];t.targetChanges.forEach(((r,o)=>{const l=a.get(o);if(!l)return;s.push(n.Ur.removeMatchingKeys(e,r.removedDocuments,o).next((()=>n.Ur.addMatchingKeys(e,r.addedDocuments,o))));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(Ts.EMPTY_BYTE_STRING,Kr.min()).withLastLimboFreeSnapshotVersion(Kr.min()):r.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(r.resumeToken,i)),a=a.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,c,r)&&s.push(n.Ur.updateTargetData(e,c))}));let o=Xo(),l=ll();if(t.documentUpdates.forEach((i=>{t.resolvedLimboDocuments.has(i)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(e,i))})),s.push(xd(e,r,t.documentUpdates).next((e=>{o=e.Ps,l=e.Is}))),!i.isEqual(Kr.min())){const t=n.Ur.getLastRemoteSnapshotVersion(e).next((t=>n.Ur.setTargetsMetadata(e,e.currentSequenceNumber,i)));s.push(t)}return ls.waitFor(s).next((()=>r.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,o,l))).next((()=>o))})).then((e=>(n.os=a,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const i=n.Na.get(t);i&&(Cr(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?i.va=!0:e.modifiedDocuments.size>0?Cr(i.va):e.removedDocuments.size>0&&(Cr(i.va),i.va=!1))})),await sh(n,e,t)}catch(e){await os(e)}}function Qu(e,t,n){const i=Pr(e);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const e=[];i.Fa.forEach(((n,i)=>{const a=i.view.Z_(t);a.snapshot&&e.push(a.snapshot)})),function(e,t){const n=Pr(e);n.onlineState=t;let i=!1;n.queries.forEach(((e,n)=>{for(const a of n.j_)a.Z_(t)&&(i=!0)})),i&&Iu(n)}(i.eventManager,t),e.length&&i.Ca.d_(e),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function Zu(e,t,n){const i=Pr(e);i.sharedClientState.updateQueryState(t,"rejected",n);const a=i.Na.get(t),r=a&&a.key;if(r){let e=new js(Xr.comparator);e=e.insert(r,ro.newNoDocument(r,Kr.min()));const n=ll().add(r),a=new ic(Kr.min(),new Map,new js(qr),e,n);await Ku(i,a),i.Oa=i.Oa.remove(r),i.Na.delete(t),rh(i)}else await kd(i.localStore,t,!1).then((()=>th(i,t,n))).catch(os)}async function Yu(e,t){const n=Pr(e),i=t.batch.batchId;try{const e=await function(e,t){const n=Pr(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const i=t.batch.keys(),a=n.cs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,i){const a=n.batch,r=a.keys();let s=ls.resolve();return r.forEach((e=>{s=s.next((()=>i.getEntry(t,e))).next((t=>{const r=n.docVersions.get(e);Cr(null!==r),t.version.compareTo(r)<0&&(a.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),i.addEntry(t)))}))})),s.next((()=>e.mutationQueue.removeMutationBatch(t,a)))}(n,e,t,a).next((()=>a.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=ll();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,i)))}))}(n.localStore,t);eh(n,i,null),Xu(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await sh(n,e)}catch(e){await os(e)}}async function Ju(e,t,n){const i=Pr(e);try{const e=await function(e,t){const n=Pr(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let i;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(Cr(null!==t),i=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,i))).next((()=>n.localDocuments.getDocuments(e,i)))}))}(i.localStore,t);eh(i,t,n),Xu(i,t),i.sharedClientState.updateMutationState(t,"rejected",n),await sh(i,e)}catch(n){await os(n)}}function Xu(e,t){(e.ka.get(t)||[]).forEach((e=>{e.resolve()})),e.ka.delete(t)}function eh(e,t,n){const i=Pr(e);let a=i.Ba[i.currentUser.toKey()];if(a){const e=a.get(t);e&&(n?e.reject(n):e.resolve(),a=a.remove(t)),i.Ba[i.currentUser.toKey()]=a}}function th(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.Ma.get(t))e.Fa.delete(i),n&&e.Ca.$a(i,n);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach((t=>{e.La.containsKey(t)||nh(e,t)}))}function nh(e,t){e.xa.delete(t.path.canonicalString());const n=e.Oa.get(t);null!==n&&(Kd(e.remoteStore,n),e.Oa=e.Oa.remove(t),e.Na.delete(n),rh(e))}function ih(e,t,n){for(const i of n)i instanceof Ru?(e.La.addReference(i.key,t),ah(e,i)):i instanceof Ou?(zr("SyncEngine","Document no longer in limbo: "+i.key),e.La.removeReference(i.key,t),e.La.containsKey(i.key)||nh(e,i.key)):Tr()}function ah(e,t){const n=t.key,i=n.path.canonicalString();e.Oa.get(n)||e.xa.has(i)||(zr("SyncEngine","New document in limbo: "+n),e.xa.add(i),rh(e))}function rh(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const n=new Xr(Zr.fromString(t)),i=e.qa.next();e.Na.set(i,new Uu(n)),e.Oa=e.Oa.insert(n,i),Gd(e.remoteStore,new Wc(Uo(Ro(n.path)),i,"TargetPurposeLimboResolution",us.oe))}}async function sh(e,t,n){const i=Pr(e),a=[],r=[],s=[];i.Fa.isEmpty()||(i.Fa.forEach(((e,o)=>{s.push(i.Ka(o,t,n).then((e=>{var t;if((e||n)&&i.isPrimaryClient){const a=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;i.sharedClientState.updateQueryState(o.targetId,a?"current":"not-current")}if(e){a.push(e);const t=pd.Wi(o.targetId,e);r.push(t)}})))})),await Promise.all(s),i.Ca.d_(a),await async function(e,t){const n=Pr(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>ls.forEach(t,(t=>ls.forEach(t.$i,(i=>n.persistence.referenceDelegate.addReference(e,t.targetId,i))).next((()=>ls.forEach(t.Ui,(i=>n.persistence.referenceDelegate.removeReference(e,t.targetId,i)))))))))}catch(e){if(!ds(e))throw e;zr("LocalStore","Failed to update sequence numbers: "+e)}for(const i of t){const e=i.targetId;if(!i.fromCache){const t=n.os.get(e),i=t.snapshotVersion,a=t.withLastLimboFreeSnapshotVersion(i);n.os=n.os.insert(e,a)}}}(i.localStore,r))}async function oh(e,t){const n=Pr(e);if(!n.currentUser.isEqual(t)){zr("SyncEngine","User change. New user:",t.toKey());const e=await vd(n.localStore,t);n.currentUser=t,function(e,t){e.ka.forEach((e=>{e.forEach((e=>{e.reject(new Ar(Ir.CANCELLED,t))}))})),e.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await sh(n,e.hs)}}function lh(e,t){const n=Pr(e),i=n.Na.get(t);if(i&&i.va)return ll().add(i.key);{let e=ll();const i=n.Ma.get(t);if(!i)return e;for(const t of i){const i=n.Fa.get(t);e=e.unionWith(i.view.Va)}return e}}function ch(e){const t=Pr(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Ku.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=lh.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Zu.bind(null,t),t.Ca.d_=Cu.bind(null,t.eventManager),t.Ca.$a=Pu.bind(null,t.eventManager),t}function dh(e){const t=Pr(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Yu.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Ju.bind(null,t),t}class uh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Od(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return gd(this.persistence,new fd,e.initialUser,this.serializer)}Ga(e){return new dd(hd.Zr,this.serializer)}Wa(e){return new Ed}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}uh.provider={build:()=>new uh};class hh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Qu(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=oh.bind(null,this.syncEngine),await gu(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new _u}createDatastore(e){const t=Od(e.databaseInfo.databaseId),n=function(e){return new Dd(e)}(e.databaseInfo);return function(e,t,n,i){return new $d(e,t,n,i)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,i,a){return new Wd(e,t,n,i,a)}(this.localStore,this.datastore,e.asyncQueue,(e=>Qu(this.syncEngine,e,0)),Td.D()?new Td:new Sd)}createSyncEngine(e,t){return function(e,t,n,i,a,r,s){const o=new Vu(e,t,n,i,a,r);return s&&(o.Qa=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=Pr(e);zr("RemoteStore","RemoteStore shutting down."),t.L_.add(5),await Hd(t),t.k_.shutdown(),t.q_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}hh.provider={build:()=>new hh};class ph{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):_r("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class mh{constructor(e,t,n,i,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=br.UNAUTHENTICATED,this.clientId=Wr.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,(async e=>{zr("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(zr("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Mr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=bu(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function fh(e,t){e.asyncQueue.verifyOperationInProgress(),zr("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener((async e=>{i.isEqual(e)||(await vd(t.localStore,e),i=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function yh(e,t){e.asyncQueue.verifyOperationInProgress();const n=await gh(e);zr("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>yu(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>yu(t.remoteStore,n))),e._onlineComponents=t}async function gh(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){zr("FirestoreClient","Using user provided OfflineComponentProvider");try{await fh(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===Ir.FAILED_PRECONDITION||e.code===Ir.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;Er("Error using user provided cache. Falling back to memory cache: "+n),await fh(e,new uh)}}else zr("FirestoreClient","Using default OfflineComponentProvider"),await fh(e,new uh);return e._offlineComponents}async function vh(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(zr("FirestoreClient","Using user provided OnlineComponentProvider"),await yh(e,e._uninitializedComponentsProvider._online)):(zr("FirestoreClient","Using default OnlineComponentProvider"),await yh(e,new hh))),e._onlineComponents}function wh(e){return vh(e).then((e=>e.syncEngine))}async function xh(e){const t=await vh(e),n=t.eventManager;return n.onListen=$u.bind(null,t.syncEngine),n.onUnlisten=Hu.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Bu.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Gu.bind(null,t.syncEngine),n}function bh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=new Mr;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,i,a){const r=new ph({next:o=>{r.Za(),t.enqueueAndForget((()=>Tu(e,s)));const l=o.docs.has(n);!l&&o.fromCache?a.reject(new Ar(Ir.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&i&&"server"===i.source?a.reject(new Ar(Ir.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):a.resolve(o)},error:e=>a.reject(e)}),s=new Du(Ro(n.path),r,{includeMetadataChanges:!0,_a:!0});return Su(e,s)}(await xh(e),e.asyncQueue,t,n,i))),i.promise}function jh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=new Mr;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,i,a){const r=new ph({next:n=>{r.Za(),t.enqueueAndForget((()=>Tu(e,s))),n.fromCache&&"server"===i.source?a.reject(new Ar(Ir.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):a.resolve(n)},error:e=>a.reject(e)}),s=new Du(n,r,{includeMetadataChanges:!0,_a:!0});return Su(e,s)}(await xh(e),e.asyncQueue,t,n,i))),i.promise}function kh(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Nh=new Map;function zh(e,t,n){if(!n)throw new Ar(Ir.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function _h(e){if(!Xr.isDocumentKey(e))throw new Ar(Ir.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Eh(e){if(Xr.isDocumentKey(e))throw new Ar(Ir.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Sh(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Tr()}function Th(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Ar(Ir.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Sh(e);throw new Ar(Ir.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}class Ch{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Ar(Ir.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Ar(Ir.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,i){if(!0===t&&!0===i)throw new Ar(Ir.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kh(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Ar(Ir.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Ar(Ir.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Ar(Ir.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ph{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ch({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ar(Ir.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Ar(Ir.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ch(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Rr;switch(e.type){case"firstParty":return new Ur(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Ar(Ir.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Nh.get(e);t&&(zr("ComponentProvider","Removing Datastore"),Nh.delete(e),t.terminate())}(this),Promise.resolve()}}function Ih(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var a;const r=(e=Th(e,Ph))._getSettings(),s=`${t}:${n}`;if("firestore.googleapis.com"!==r.host&&r.host!==s&&Er("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},r),{host:s,ssl:!1})),i.mockUserToken){let t,n;if("string"==typeof i.mockUserToken)t=i.mockUserToken,n=br.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const r=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Q(JSON.stringify({alg:"none",type:"JWT"})),Q(JSON.stringify(r)),""].join(".")}(i.mockUserToken,null===(a=e._app)||void 0===a?void 0:a.options.projectId);const r=i.mockUserToken.sub||i.mockUserToken.user_id;if(!r)throw new Ar(Ir.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new br(r)}e._authCredentials=new Or(new Dr(t,n))}}class Ah{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ah(this.firestore,e,this._query)}}class Mh{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Dh(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Mh(this.firestore,e,this._key)}}class Dh extends Ah{constructor(e,t,n){super(e,t,Ro(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Mh(this.firestore,null,new Xr(e))}withConverter(e){return new Dh(this.firestore,e,this._path)}}function Rh(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];if(e=we(e),zh("collection","path",t),e instanceof Ph){const n=Zr.fromString(t,...i);return Eh(n),new Dh(e,null,n)}{if(!(e instanceof Mh||e instanceof Dh))throw new Ar(Ir.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Zr.fromString(t,...i));return Eh(n),new Dh(e.firestore,null,n)}}function Oh(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];if(e=we(e),1===arguments.length&&(t=Wr.newId()),zh("doc","path",t),e instanceof Ph){const n=Zr.fromString(t,...i);return _h(n),new Mh(e,null,new Xr(n))}{if(!(e instanceof Mh||e instanceof Dh))throw new Ar(Ir.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Zr.fromString(t,...i));return _h(n),new Mh(e.firestore,e instanceof Dh?e.converter:null,new Xr(n))}}class Lh{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Ld(this,"async_queue_retry"),this.Vu=()=>{const e=Rd();e&&zr("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()},this.mu=e;const t=Rd();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Rd();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise((()=>{}));const t=new Mr;return this.gu((()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Pu.push(e),this.pu())))}async pu(){if(0!==this.Pu.length){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!ds(e))throw e;zr("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go((()=>this.pu()))}}gu(e){const t=this.mu.then((()=>(this.du=!0,e().catch((e=>{this.Eu=e,this.du=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw _r("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.du=!1,e))))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=xu.createAndSchedule(this,e,t,n,(e=>this.yu(e)));return this.Tu.push(i),i}fu(){this.Eu&&Tr()}verifyOperationInProgress(){}async wu(){let e;do{e=this.mu,await e}while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then((()=>{this.Tu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.Tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.wu()}))}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}class Fh extends Ph{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new Lh,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Lh(e),this._firestoreClient=void 0,await e}}}function Uh(e){if(e._terminated)throw new Ar(Ir.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Vh(e),e._firestoreClient}function Vh(e){var t,n,i;const a=e._freezeSettings(),r=function(e,t,n,i){return new Os(e,t,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,kh(i.experimentalLongPollingOptions),i.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,a);e._componentsProvider||(null===(n=a.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=a.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(e._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),e._firestoreClient=new mh(e._authCredentials,e._appCheckCredentials,e._queue,r,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class $h{constructor(e){this._byteString=e}static fromBase64String(e){try{return new $h(Ts.fromBase64String(e))}catch(e){throw new Ar(Ir.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new $h(Ts.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Bh{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let i=0;i<t.length;++i)if(0===t[i].length)throw new Ar(Ir.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Jr(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Wh{constructor(e){this._methodName=e}}class qh{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ar(Ir.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ar(Ir.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return qr(this._lat,e._lat)||qr(this._long,e._long)}}class Hh{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const Gh=/^__.*__$/;class Kh{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Rl(e,this.data,this.fieldMask,t,this.fieldTransforms):new Dl(e,this.data,t,this.fieldTransforms)}}function Qh(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Tr()}}class Zh{constructor(e,t,n,i,a,r){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===a&&this.vu(),this.fieldTransforms=a||[],this.fieldMask=r||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Zh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return lp(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(0===e.length)throw this.Bu("Document fields must not be empty");if(Qh(this.Cu)&&Gh.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Yh{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Od(e)}Qu(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Zh({Cu:e,methodName:t,qu:n,path:Jr.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Jh(e){const t=e._freezeSettings(),n=Od(e._databaseId);return new Yh(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Xh(e,t,n,i,a){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const s=e.Qu(r.merge||r.mergeFields?2:0,t,n,a);ap("Data must be an object, but it was:",s,i);const o=np(i,s);let l,c;if(r.merge)l=new Es(s.fieldMask),c=s.fieldTransforms;else if(r.mergeFields){const e=[];for(const i of r.mergeFields){const a=rp(t,i,n);if(!s.contains(a))throw new Ar(Ir.INVALID_ARGUMENT,`Field '${a}' is specified in your field mask but missing from your input data.`);cp(e,a)||e.push(a)}l=new Es(e),c=s.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,c=s.fieldTransforms;return new Kh(new io(o),l,c)}function ep(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return tp(n,e.Qu(i?4:3,t))}function tp(e,t){if(ip(e=we(e)))return ap("Unsupported field value:",t,e),np(e,t);if(e instanceof Wh)return function(e,t){if(!Qh(t.Cu))throw t.Bu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Bu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&4!==t.Cu)throw t.Bu("Nested arrays are not supported");return function(e,t){const n=[];let i=0;for(const a of e){let e=tp(a,t.Lu(i));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),i++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=we(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return pl(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Gr.fromDate(e);return{timestampValue:gc(t.serializer,n)}}if(e instanceof Gr){const n=new Gr(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:gc(t.serializer,n)}}if(e instanceof qh)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof $h)return{bytesValue:vc(t.serializer,e._byteString)};if(e instanceof Mh){const n=t.databaseId,i=e.firestore._databaseId;if(!i.isEqual(n))throw t.Bu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:bc(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Hh)return function(e,t){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw t.Bu("VectorValues must only contain numeric values.");return ul(t.serializer,e)}))}}}}}}(e,t);throw t.Bu(`Unsupported field value: ${Sh(e)}`)}(e,t)}function np(e,t){const n={};return bs(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):xs(e,((e,i)=>{const a=tp(i,t.Mu(e));null!=a&&(n[e]=a)})),{mapValue:{fields:n}}}function ip(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Gr||e instanceof qh||e instanceof $h||e instanceof Mh||e instanceof Wh||e instanceof Hh)}function ap(e,t,n){if(!ip(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const i=Sh(n);throw"an object"===i?t.Bu(e+" a custom object"):t.Bu(e+" "+i)}}function rp(e,t,n){if((t=we(t))instanceof Bh)return t._internalPath;if("string"==typeof t)return op(e,t);throw lp("Field path arguments must be of type string or ",e,!1,void 0,n)}const sp=new RegExp("[~\\*/\\[\\]]");function op(e,t,n){if(t.search(sp)>=0)throw lp(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Bh(...t.split("."))._internalPath}catch(i){throw lp(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function lp(e,t,n,i,a){const r=i&&!i.isEmpty(),s=void 0!==a;let o=`Function ${t}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(r||s)&&(l+=" (found",r&&(l+=` in field ${i}`),s&&(l+=` in document ${a}`),l+=")"),new Ar(Ir.INVALID_ARGUMENT,o+e+l)}function cp(e,t){return e.some((e=>e.isEqual(t)))}class dp{constructor(e,t,n,i,a){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Mh(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new up(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(hp("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class up extends dp{data(){return super.data()}}function hp(e,t){return"string"==typeof t?op(e,t):t instanceof Bh?t._internalPath:t._delegate._internalPath}function pp(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Ar(Ir.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mp{}class fp extends mp{}class yp extends fp{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new yp(e,t,n)}_apply(e){const t=this._parse(e);return bp(e._query,t),new Ah(e.firestore,e.converter,$o(e._query,t))}_parse(e){const t=Jh(e.firestore),n=function(e,t,n,i,a,r,s){let o;if(a.isKeyField()){if("array-contains"===r||"array-contains-any"===r)throw new Ar(Ir.INVALID_ARGUMENT,`Invalid Query. You can't perform '${r}' queries on documentId().`);if("in"===r||"not-in"===r){xp(s,r);const t=[];for(const n of s)t.push(wp(i,e,n));o={arrayValue:{values:t}}}else o=wp(i,e,s)}else"in"!==r&&"not-in"!==r&&"array-contains-any"!==r||xp(s,r),o=ep(n,t,s,"in"===r||"not-in"===r);return po.create(a,r,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class gp extends mp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new gp(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:mo.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const i=t.getFlattenedFilters();for(const a of i)bp(n,a),n=$o(n,a)}(e._query,t),new Ah(e.firestore,e.converter,$o(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class vp extends fp{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new vp(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Ar(Ir.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Ar(Ir.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new co(t,n)}(e._query,this._field,this._direction);return new Ah(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Mo(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function wp(e,t,n){if("string"==typeof(n=we(n))){if(""===n)throw new Ar(Ir.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Lo(t)&&-1!==n.indexOf("/"))throw new Ar(Ir.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=t.path.child(Zr.fromString(n));if(!Xr.isDocumentKey(i))throw new Ar(Ir.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Ks(e,new Xr(i))}if(n instanceof Mh)return Ks(e,n._key);throw new Ar(Ir.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Sh(n)}.`)}function xp(e,t){if(!Array.isArray(e)||0===e.length)throw new Ar(Ir.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function bp(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Ar(Ir.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Ar(Ir.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class jp{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Us(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Is(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(As(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Tr()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return xs(e,((e,i)=>{n[e]=this.convertValue(i,t)})),n}convertVectorValue(e){var t,n,i;const a=null===(i=null===(n=null===(t=e.fields)||void 0===t?void 0:t.value.arrayValue)||void 0===n?void 0:n.values)||void 0===i?void 0:i.map((e=>Is(e.doubleValue)));return new Hh(a)}convertGeoPoint(e){return new qh(Is(e.latitude),Is(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Ds(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Rs(e));default:return null}}convertTimestamp(e){const t=Ps(e);return new Gr(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Zr.fromString(e);Cr(Bc(n));const i=new Ls(n.get(1),n.get(3)),a=new Xr(n.popFirst(5));return i.isEqual(t)||_r(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function kp(e,t,n){let i;return i=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,i}class Np{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class zp extends dp{constructor(e,t,n,i,a,r){super(e,t,n,i,r),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new _p(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(hp("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class _p extends zp{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Ep{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Np(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new _p(this._firestore,this._userDataWriter,n.key,n,new Np(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Ar(Ir.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const i=new _p(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Np(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const i=new _p(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Np(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let a=-1,r=-1;return 0!==t.type&&(a=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),r=n.indexOf(t.doc.key)),{type:Sp(t.type),doc:i,oldIndex:a,newIndex:r}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Sp(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Tr()}}class Tp extends jp{constructor(e){super(),this.firestore=e}convertBytes(e){return new $h(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Mh(this.firestore,null,t)}}function Cp(e,t){return function(e,t){const n=new Mr;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const i=dh(e);try{const e=await function(e,t){const n=Pr(e),i=Gr.now(),a=t.reduce(((e,t)=>e.add(t.key)),ll());let r,s;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let o=Xo(),l=ll();return n.cs.getEntries(e,a).next((e=>{o=e,o.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,o))).next((a=>{r=a;const s=[];for(const e of t){const t=Al(e,r.get(e.key).overlayedDocument);null!=t&&s.push(new Rl(e.key,t,ao(t.value.mapValue),El.exists(!0)))}return n.mutationQueue.addMutationBatch(e,i,s,t)})).next((t=>{s=t;const i=t.applyToLocalDocumentSet(r,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,i)}))})).then((()=>({batchId:s.batchId,changes:nl(r)})))}(i.localStore,t);i.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let i=e.Ba[e.currentUser.toKey()];i||(i=new js(qr)),i=i.insert(t,n),e.Ba[e.currentUser.toKey()]=i}(i,e.batchId,n),await sh(i,e.changes),await ou(i.remoteStore)}catch(e){const t=bu(e,"Failed to persist write");n.reject(t)}}(await wh(e),t,n))),n.promise}(Uh(e),t)}function Pp(e,t,n){const i=n.docs.get(t._key),a=new Tp(e);return new zp(e,a,t._key,i,new Np(n.hasPendingWrites,n.fromCache),t.converter)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){jr=e}(Dt),Ct(new xe("firestore",((e,n)=>{let{instanceIdentifier:i,options:a}=n;const r=e.getProvider("app").getImmediate(),s=new Fh(new Lr(e.getProvider("auth-internal")),new $r(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Ar(Ir.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ls(e.options.projectId,t)}(r,i),r);return a=Object.assign({useFetchStreams:t},a),s._setSettings(a),s}),"PUBLIC").setMultipleInstances(!0)),Lt(xr,"4.7.3",e),Lt(xr,"4.7.3","esm2017")}();const Ip="@firebase/installations",Ap="0.6.9",Mp=1e4,Dp=`w:${Ap}`,Rp="FIS_v2",Op=36e5,Lp=new ce("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Fp(e){return e instanceof le&&e.code.includes("request-failed")}function Up(e){let{projectId:t}=e;return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function Vp(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function $p(e,t){const n=(await t.json()).error;return Lp.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Bp(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function Wp(e,t){let{refreshToken:n}=t;const i=Bp(e);return i.append("Authorization",function(e){return`${Rp} ${e}`}(n)),i}async function qp(e){const t=await e();return t.status>=500&&t.status<600?e():t}function Hp(e){return new Promise((t=>{setTimeout(t,e)}))}const Gp=/^[cdef][\w-]{21}$/;function Kp(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}(e);return Gp.test(t)?t:""}catch(e){return""}}function Qp(e){return`${e.appName}!${e.appId}`}const Zp=new Map;function Yp(e,t){const n=Qp(e);Jp(n,t),function(e,t){const n=em();n&&n.postMessage({key:e,fid:t});tm()}(n,t)}function Jp(e,t){const n=Zp.get(e);if(n)for(const i of n)i(t)}let Xp=null;function em(){return!Xp&&"BroadcastChannel"in self&&(Xp=new BroadcastChannel("[Firebase] FID Change"),Xp.onmessage=e=>{Jp(e.data.key,e.data.fid)}),Xp}function tm(){0===Zp.size&&Xp&&(Xp.close(),Xp=null)}const nm="firebase-installations-store";let im=null;function am(){return im||(im=Be("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(nm)}})),im}async function rm(e,t){const n=Qp(e),i=(await am()).transaction(nm,"readwrite"),a=i.objectStore(nm),r=await a.get(n);return await a.put(t,n),await i.done,r&&r.fid===t.fid||Yp(e,t.fid),t}async function sm(e){const t=Qp(e),n=(await am()).transaction(nm,"readwrite");await n.objectStore(nm).delete(t),await n.done}async function om(e,t){const n=Qp(e),i=(await am()).transaction(nm,"readwrite"),a=i.objectStore(nm),r=await a.get(n),s=t(r);return void 0===s?await a.delete(n):await a.put(s,n),await i.done,!s||r&&r.fid===s.fid||Yp(e,s.fid),s}async function lm(e){let t;const n=await om(e.appConfig,(n=>{const i=function(e){const t=e||{fid:Kp(),registrationStatus:0};return um(t)}(n),a=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(Lp.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(e,t){try{const n=await async function(e,t){let{appConfig:n,heartbeatServiceProvider:i}=e,{fid:a}=t;const r=Up(n),s=Bp(n),o=i.getImmediate({optional:!0});if(o){const e=await o.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const l={fid:a,authVersion:Rp,appId:n.appId,sdkVersion:Dp},c={method:"POST",headers:s,body:JSON.stringify(l)},d=await qp((()=>fetch(r,c)));if(d.ok){const e=await d.json();return{fid:e.fid||a,registrationStatus:2,refreshToken:e.refreshToken,authToken:Vp(e.authToken)}}throw await $p("Create Installation",d)}(e,t);return rm(e.appConfig,n)}catch(n){throw Fp(n)&&409===n.customData.serverCode?await sm(e.appConfig):await rm(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:i}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:cm(e)}:{installationEntry:t}}(e,i);return t=a.registrationPromise,a.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function cm(e){let t=await dm(e.appConfig);for(;1===t.registrationStatus;)await Hp(100),t=await dm(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await lm(e);return n||t}return t}function dm(e){return om(e,(e=>{if(!e)throw Lp.create("installation-not-found");return um(e)}))}function um(e){return 1===(t=e).registrationStatus&&t.registrationTime+Mp<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function hm(e,t){let{appConfig:n,heartbeatServiceProvider:i}=e;const a=function(e,t){let{fid:n}=t;return`${Up(e)}/${n}/authTokens:generate`}(n,t),r=Wp(n,t),s=i.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&r.append("x-firebase-client",e)}const o={installation:{sdkVersion:Dp,appId:n.appId}},l={method:"POST",headers:r,body:JSON.stringify(o)},c=await qp((()=>fetch(a,l)));if(c.ok){return Vp(await c.json())}throw await $p("Generate Auth Token",c)}async function pm(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=await om(e.appConfig,(i=>{if(!fm(i))throw Lp.create("not-registered");const a=i.authToken;if(!n&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+Op}(e)}(a))return i;if(1===a.requestStatus)return t=async function(e,t){let n=await mm(e.appConfig);for(;1===n.authToken.requestStatus;)await Hp(100),n=await mm(e.appConfig);const i=n.authToken;return 0===i.requestStatus?pm(e,t):i}(e,n),i;{if(!navigator.onLine)throw Lp.create("app-offline");const n=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(i);return t=async function(e,t){try{const n=await hm(e,t),i=Object.assign(Object.assign({},t),{authToken:n});return await rm(e.appConfig,i),n}catch(n){if(!Fp(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await rm(e.appConfig,n)}else await sm(e.appConfig);throw n}}(e,n),n}}));return t?await t:i.authToken}function mm(e){return om(e,(e=>{if(!fm(e))throw Lp.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+Mp<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n}))}function fm(e){return void 0!==e&&2===e.registrationStatus}async function ym(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;await async function(e){const{registrationPromise:t}=await lm(e);t&&await t}(n);return(await pm(n,t)).token}function gm(e){return Lp.create("missing-app-config-values",{valueName:e})}const vm="installations",wm=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw gm("App Configuration");if(!e.name)throw gm("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw gm(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:Pt(t,"heartbeat"),_delete:()=>Promise.resolve()}},xm=e=>{const t=Pt(e.getProvider("app").getImmediate(),vm).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:i}=await lm(t);return i?i.catch(console.error):pm(t).catch(console.error),n.fid}(t),getToken:e=>ym(t,e)}};Ct(new xe(vm,wm,"PUBLIC")),Ct(new xe("installations-internal",xm,"PRIVATE")),Lt(Ip,Ap),Lt(Ip,Ap,"esm2017");const bm="analytics",jm="https://www.googletagmanager.com/gtag/js",km=new Ce("@firebase/analytics"),Nm=new ce("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function zm(e){if(!e.startsWith(jm)){const t=Nm.create("invalid-gtag-resource",{gtagURL:e});return km.warn(t.message),""}return e}function _m(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}function Em(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}("firebase-js-sdk-policy",{createScriptURL:zm}),i=document.createElement("script"),a=`${jm}?l=${e}&id=${t}`;i.src=n?null===n||void 0===n?void 0:n.createScriptURL(a):a,i.async=!0,document.head.appendChild(i)}function Sm(e,t,n,i){return async function(a){try{for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];if("event"===a){const[i,a]=s;await async function(e,t,n,i,a){try{let r=[];if(a&&a.send_to){let e=a.send_to;Array.isArray(e)||(e=[e]);const i=await _m(n);for(const n of e){const e=i.find((e=>e.measurementId===n)),a=e&&t[e.appId];if(!a){r=[];break}r.push(a)}}0===r.length&&(r=Object.values(t)),await Promise.all(r),e("event",i,a||{})}catch(r){km.error(r)}}(e,t,n,i,a)}else if("config"===a){const[a,r]=s;await async function(e,t,n,i,a,r){const s=i[a];try{if(s)await t[s];else{const e=(await _m(n)).find((e=>e.measurementId===a));e&&await t[e.appId]}}catch(o){km.error(o)}e("config",a,r)}(e,t,n,i,a,r)}else if("consent"===a){const[t,n]=s;e("consent",t,n)}else if("get"===a){const[t,n,i]=s;e("get",t,n,i)}else if("set"===a){const[t]=s;e("set",t)}else e(a,...s)}catch(l){km.error(l)}}}const Tm=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function Cm(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function Pm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tm,n=arguments.length>2?arguments[2]:void 0;const{appId:i,apiKey:a,measurementId:r}=e.options;if(!i)throw Nm.create("no-app-id");if(!a){if(r)return{measurementId:r,appId:i};throw Nm.create("no-api-key")}const s=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new Am;return setTimeout((async()=>{o.abort()}),void 0!==n?n:6e4),Im({appId:i,apiKey:a,measurementId:r},s,o,t)}async function Im(e,t,n){let{throttleEndTimeMillis:i,backoffCount:a}=t,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Tm;var s;const{appId:o,measurementId:l}=e;try{await function(e,t){return new Promise(((n,i)=>{const a=Math.max(t-Date.now(),0),r=setTimeout(n,a);e.addEventListener((()=>{clearTimeout(r),i(Nm.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(n,i)}catch(c){if(l)return km.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null===c||void 0===c?void 0:c.message}]`),{appId:o,measurementId:l};throw c}try{const t=await async function(e){var t;const{appId:n,apiKey:i}=e,a={method:"GET",headers:Cm(i)},r="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),s=await fetch(r,a);if(200!==s.status&&304!==s.status){let e="";try{const n=await s.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(o){}throw Nm.create("config-fetch-failed",{httpStatus:s.status,responseMessage:e})}return s.json()}(e);return r.deleteThrottleMetadata(o),t}catch(c){const t=c;if(!function(e){if(!(e instanceof le)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t)){if(r.deleteThrottleMetadata(o),l)return km.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null===t||void 0===t?void 0:t.message}]`),{appId:o,measurementId:l};throw c}const i=503===Number(null===(s=null===t||void 0===t?void 0:t.customData)||void 0===s?void 0:s.httpStatus)?ve(a,r.intervalMillis,30):ve(a,r.intervalMillis),d={throttleEndTimeMillis:Date.now()+i,backoffCount:a+1};return r.setThrottleMetadata(o,d),km.debug(`Calling attemptFetch again in ${i} millis`),Im(e,d,n,r)}}class Am{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let Mm,Dm;function Rm(e){Dm=e}function Om(e){Mm=e}async function Lm(e,t,n,i,a,r,s){var o;const l=Pm(e);l.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&km.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>km.error(e))),t.push(l);const c=async function(){if(!se())return km.warn(Nm.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await oe()}catch(e){return km.warn(Nm.create("indexeddb-unavailable",{errorInfo:null===e||void 0===e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?i.getId():void 0)),[d,u]=await Promise.all([l,c]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(jm)&&n.src.includes(e))return n;return null})(r)||Em(r,d.measurementId),Dm&&(a("consent","default",Dm),Rm(void 0)),a("js",new Date);const h=null!==(o=null===s||void 0===s?void 0:s.config)&&void 0!==o?o:{};return h.origin="firebase",h.update=!0,null!=u&&(h.firebase_id=u),a("config",d.measurementId,h),Mm&&(a("set",Mm),Om(void 0)),d.measurementId}class Fm{constructor(e){this.app=e}_delete(){return delete Um[this.app.options.appId],Promise.resolve()}}let Um={},Vm=[];const $m={};let Bm,Wm,qm="dataLayer",Hm="gtag",Gm=!1;function Km(){const e=[];if(ae()&&e.push("This is a browser extension environment."),"undefined"!==typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=Nm.create("invalid-analytics-context",{errorInfo:t});km.warn(n.message)}}function Qm(e,t,n){Km();const i=e.options.appId;if(!i)throw Nm.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw Nm.create("no-api-key");km.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Um[i])throw Nm.create("already-exists",{id:i});if(!Gm){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(qm);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,i,a){let r=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[i].push(arguments)};return window[a]&&"function"===typeof window[a]&&(r=window[a]),window[a]=Sm(r,e,t,n),{gtagCore:r,wrappedGtag:window[a]}}(Um,Vm,$m,qm,Hm);Wm=e,Bm=t,Gm=!0}Um[i]=Lm(e,Vm,$m,t,Bm,qm,n);return new Fm(e)}function Zm(e,t,n,i){e=we(e),async function(e,t,n,i,a){if(a&&a.global)e("event",n,i);else{const a=await t;e("event",n,Object.assign(Object.assign({},i),{send_to:a}))}}(Wm,Um[e.app.options.appId],t,n,i).catch((e=>km.error(e)))}const Ym="@firebase/analytics",Jm="0.10.8";Ct(new xe(bm,((e,t)=>{let{options:n}=t;return Qm(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)}),"PUBLIC")),Ct(new xe("analytics-internal",(function(e){try{const t=e.getProvider(bm).getImmediate();return{logEvent:(e,n,i)=>Zm(t,e,n,i)}}catch(t){throw Nm.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),Lt(Ym,Jm),Lt(Ym,Jm,"esm2017");const Xm=Rt({apiKey:"AIzaSyDB6GPLf6XY8zdm3X_v5IpGy1RsKvzmxCs",authDomain:"oze-developer.firebaseapp.com",projectId:"oze-developer",storageBucket:"oze-developer.firebasestorage.app",messagingSenderId:"846053756987",appId:"1:846053756987:web:6a6e5954c24f3932fccc1e",measurementId:"G-3FJW0FC6S7"}),ef=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ot();const t=Pt(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Pt(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(ue(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;tn(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Xa,persistence:[ua,Ki,Zi]}),i=te("authTokenSyncURL");if(i&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(i,location.origin);if(location.origin===e.origin){const t=(a=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>ir)return;const i=null===t||void 0===t?void 0:t.token;ar!==i&&(ar=i,await fetch(a,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});!function(e,t,n){we(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e,t,n,i){we(e).onIdTokenChanged(t,n,i)}(n,(e=>t(e)))}}var a;const r=X("auth");return r&&gi(n,`http://${r}`),n}(Xm),tf=function(e,t){const n="string"==typeof e?e:t||"(default)",i=Pt("object"==typeof e?e:Ot(),"firestore").getImmediate({identifier:n});if(!i._initialized){const e=(e=>{const t=X(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),i]:[t.substring(0,n),i]})("firestore");e&&Ih(i,...e)}return i}(Xm),nf=(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ot();e=we(e);const t=Pt(e,bm);t.isInitialized()?t.getImmediate():function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Pt(e,bm);if(n.isInitialized()){const e=n.getImmediate();if(ue(t,n.getOptions()))return e;throw Nm.create("already-initialized")}const i=n.initialize({options:t})}(e)}(Xm),async()=>{try{const e=await async function(e){var t;if(It(e.app))return Promise.reject(rn(e));const n=ci(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new Oi({user:n.currentUser,providerId:null,operationType:"signIn"});const i=await Ri(n,{returnSecureToken:!0}),a=await Oi._fromIdTokenResponse(n,"signIn",i,!0);return await n._updateCurrentUser(a.user),a}(ef);return e.user}catch(e){throw console.error("B\u0142\u0105d logowania anonimowego:",e),e}}),af=async(e,t)=>{if(!ef.currentUser)return null;try{const n=ef.currentUser.uid,i={userId:n,nickname:ef.currentUser.displayName||"Anonimowy gracz",gameState:{day:e.day,turn:e.turn,gameDate:e.gameDate,currentScreen:e.currentScreen,gameSpeed:e.gameSpeed,competitors:e.competitors,marketProjects:e.marketProjects,marketHistory:e.marketHistory},playerState:{cash:t.cash,reputation:t.reputation,installedCapacity:t.installedCapacity,rtbCapacity:t.rtbCapacity,rtbPower:t.rtbPower,economicMetrics:t.economicMetrics,staff:t.staff,projects:t.projects,gameGoals:t.gameGoals,knownRegions:t.knownRegions,capabilities:t.capabilities,modifiers:t.modifiers},timestamp:new Date};return await function(e,t,n){e=Th(e,Mh);const i=Th(e.firestore,Fh),a=kp(e.converter,t,n);return Cp(i,[Xh(Jh(i),"setDoc",e._key,a,null!==e.converter,n).toMutation(e._key,El.none())])}(Oh(tf,"saves",n),i),i}catch(n){throw console.error("B\u0142\u0105d zapisywania stanu gry:",n),n}},rf=async()=>{if(!ef.currentUser)return null;try{const e=ef.currentUser.uid,t=await function(e){e=Th(e,Mh);const t=Th(e.firestore,Fh);return bh(Uh(t),e._key).then((n=>Pp(t,e,n)))}(Oh(tf,"saves",e));return t.exists()?t.data():null}catch(e){throw console.error("B\u0142\u0105d wczytywania stanu gry:",e),e}},sf=async(e,t)=>{if(!ef.currentUser)return null;try{const n={userId:ef.currentUser.uid,nickname:ef.currentUser.displayName||"Anonimowy gracz",goal:e,days:t,timestamp:new Date};return await function(e,t){const n=Th(e.firestore,Fh),i=Oh(e),a=kp(e.converter,t);return Cp(n,[Xh(Jh(e.firestore),"addDoc",i._key,a,null!==e.converter,{}).toMutation(i._key,El.exists(!1))]).then((()=>i))}(Rh(tf,"leaderboard"),n),n}catch(n){throw console.error("B\u0142\u0105d zapisywania wyniku do tablicy wynik\xf3w:",n),n}},of=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{e||(e="25GW"),"number"!==typeof t&&(t=10);const i=function(e,t){let n=[];for(var i=arguments.length,a=new Array(i>2?i-2:0),r=2;r<i;r++)a[r-2]=arguments[r];t instanceof mp&&n.push(t),n=n.concat(a),function(e){const t=e.filter((e=>e instanceof gp)).length,n=e.filter((e=>e instanceof yp)).length;if(t>1||t>0&&n>0)throw new Ar(Ir.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)e=s._apply(e);return e}(Rh(tf,"leaderboard"),function(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=hp("orderBy",e);return vp._create(n,t)}("turns","asc"),t(t));try{const e=await function(e){e=Th(e,Ah);const t=Th(e.firestore,Fh),n=Uh(t),i=new Tp(t);return pp(e._query),jh(n,e._query).then((n=>new Ep(t,i,e,n)))}(i),t=[];return e.forEach((e=>{t.push({id:e.id,...e.data()})})),t}catch(n){return console.error("B\u0142\u0105d podczas wykonywania zapytania:",n),[]}}catch(i){return console.error("B\u0142\u0105d pobierania tablicy wynik\xf3w:",i),[]}},lf=e=>function(e,t,n,i){return we(e).onAuthStateChanged(t,n,i)}(ef,e),cf=e=>e.toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"}),df={day:1,turn:1,gameDate:new Date("2024-01-01"),gameSpeed:1,currentScreen:"home",appView:null,notification:null,selectedRegion:null,selectedCounty:null,selectedProject:null,globalEvents:{currentEvents:[],eventProbabilities:{economic:.2,political:.1,social:.15,environmental:.1,technological:.15},historicalEvents:[]},competitors:u,marketProjects:[],marketHistory:[],marketPriceModifiers:{PV:1,WF:1,BESS:1},reputationModifiers:{projectCost:1,constructionSpeed:1,projectQuality:1,permitSpeed:1,leasingSuccess:1,gridConnectionCost:1},economyModifiers:{inflationRate:.05,interestRate:.06,gridConnectionCost:1,permitCost:1,energyPrice:1,constructionCost:1},parallelProcessing:{enabled:!0,maxParallelTasks:3},goals:{installedCapacity:{target:25e3,achieved:!1,achievedOn:null},money:{target:1e10,achieved:!1,achievedOn:null}}};function uf(e,t){switch(t.type){case"SET_SCREEN":return{...e,currentScreen:t.payload};case"SELECT_REGION":return{...e,selectedRegion:t.payload,selectedCounty:null};case"SELECT_COUNTY":return{...e,selectedCounty:t.payload};case"SELECT_PROJECT":return{...e,selectedProject:t.payload};case"SET_NOTIFICATION":return{...e,notification:t.payload};case"ADVANCE_DAY":const n=e.gameSpeed,i=((e,t)=>{const n=new Date(e);return n.setDate(n.getDate()+t),n})(e.gameDate,n);return{...e,day:e.day+n,gameDate:i,lastDateUpdate:new Date};case"SET_GAME_SPEED":return{...e,gameSpeed:t.payload};case"UPDATE_MARKET_PROJECTS":return{...e,marketProjects:t.payload};case"ADD_MARKET_PROJECT":return{...e,marketProjects:[...e.marketProjects,t.payload]};case"REMOVE_MARKET_PROJECT":return{...e,marketProjects:e.marketProjects.filter((e=>e.id!==t.payload))};case"ADD_MARKET_HISTORY":return{...e,marketHistory:[...e.marketHistory,t.payload]};case"UPDATE_MARKET_PRICE_MODIFIERS":return{...e,marketPriceModifiers:{...e.marketPriceModifiers,...t.payload}};case"UPDATE_REPUTATION_MODIFIERS":return{...e,reputationModifiers:{...e.reputationModifiers,...t.payload}};case"UPDATE_ECONOMY_STATE":return{...e,economyModifiers:{...e.economyModifiers,...t.payload}};case"SET_PARALLEL_PROCESSING":return{...e,parallelProcessing:{...e.parallelProcessing,...t.payload}};case"UPDATE_GAME_GOALS":return{...e,goals:{...e.goals,...t.payload}};case"SET_WIN_CONDITION":return{...e,goals:{...e.goals,isWon:!0,winReason:t.payload}};case"ADD_GLOBAL_EVENT":return{...e,globalEvents:{...e.globalEvents,currentEvents:[...e.globalEvents.currentEvents,t.payload]}};case"ADD_GLOBAL_EVENTS":return{...e,globalEvents:{...e.globalEvents,currentEvents:[...e.globalEvents.currentEvents,...t.payload]}};case"REMOVE_GLOBAL_EVENT":return{...e,globalEvents:{...e.globalEvents,currentEvents:e.globalEvents.currentEvents.filter((e=>e.id!==t.payload))}};case"UPDATE_EVENT_PROBABILITIES":return{...e,globalEvents:{...e.globalEvents,eventProbabilities:{...e.globalEvents.eventProbabilities,...t.payload}}};case"LOAD_GAME":return{...e,...t.payload,notification:e.notification,appView:e.appView};case"SET_APP_VIEW":return{...e,appView:t.payload};default:return e}}const hf=(0,i.createContext)();function pf(e){let{children:t}=e;const[n,a]=(0,i.useReducer)(uf,df),{dispatch:s}=q();(0,i.useEffect)((()=>{c()}),[]);const o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";try{window.notificationQueue||(window.notificationQueue=[],window.activeNotifications=0,window.lastNotificationTime=0);const n="error"===t,i=Date.now();if(window.notificationQueue.some((t=>t.text===e&&i-t.addedAt<5e3))&&!n)return void console.log("Podobne powiadomienie ju\u017c zosta\u0142o wy\u015bwietlone niedawno:",e);window.notificationQueue.push({text:e,type:t,addedAt:i});const r=5;window.notificationQueue.length>r&&(window.notificationQueue=window.notificationQueue.sort(((e,t)=>"error"===e.type&&"error"!==t.type?1:"error"!==e.type&&"error"===t.type?-1:e.addedAt-t.addedAt)).slice(-r));const s=()=>{if(0===window.notificationQueue.length||window.activeNotifications>=2)return;if(i-window.lastNotificationTime<500&&!n)return void setTimeout(s,500);const e=window.notificationQueue.shift();window.lastNotificationTime=Date.now(),window.activeNotifications++,a({type:"SET_NOTIFICATION",payload:{text:e.text,type:e.type}});const t="error"===e.type?8e3:"success"===e.type?5e3:3e3;setTimeout((()=>{a({type:"SET_NOTIFICATION",payload:null}),window.activeNotifications--,setTimeout(s,300)}),t)};s()}catch(n){console.error("B\u0142\u0105d podczas wy\u015bwietlania powiadomienia:",n),a({type:"SET_NOTIFICATION",payload:{text:e,type:t}}),setTimeout((()=>{a({type:"SET_NOTIFICATION",payload:null})}),5e3)}},l=()=>{const e={},t=.02*Math.random()-.01;e.inflationRate=Math.max(0,Math.min(.15,n.economyModifiers.inflationRate+t));const i=.01*Math.random()-.005;e.economicGrowth=Math.max(-.05,Math.min(.08,n.economyModifiers.economicGrowth+i)),n.economyModifiers.inflationRate>n.economyModifiers.interestRate+.02?e.interestRate=n.economyModifiers.interestRate+.01:n.economyModifiers.inflationRate<n.economyModifiers.interestRate-.02&&(e.interestRate=n.economyModifiers.interestRate-.01),a({type:"UPDATE_ECONOMY_STATE",payload:e})},c=()=>{const e=(e=>{if(!e||0===e.length)return{marketModifier:1,permitTimeModifier:1,buildCostModifier:1,riskLevel:0,grayAreaImpact:0,reputationChange:0};const t={marketModifier:1,permitTimeModifier:1,buildCostModifier:1,riskLevel:0,grayAreaImpact:0,reputationChange:0};return e.forEach((e=>{if(!e.effects)return;const n=f(e.effects);n.marketModifier&&(t.marketModifier*=n.marketModifier),n.permitTimeModifier&&(t.permitTimeModifier*=n.permitTimeModifier),n.buildCostModifier&&(t.buildCostModifier*=n.buildCostModifier),n.riskLevel&&(t.riskLevel+=n.riskLevel),n.grayAreaImpact&&(t.grayAreaImpact+=n.grayAreaImpact),n.reputationChange&&(t.reputationChange+=n.reputationChange)})),y(t)})(n.globalEvents.currentEvents.filter((e=>!e.expiryDate||new Date(e.expiryDate)>n.gameDate)));a({type:"UPDATE_MODIFIERS",payload:{marketPriceModifiers:{PV:e.marketModifier,WF:e.marketModifier,BESS:e.marketModifier}}})},d=(e,t)=>{if(e&&!n.goals.isWon)return e.rtbPower>=n.goals.rtbPowerTarget?(a({type:"SET_WIN_CONDITION",payload:"rtb_power"}),o(`Gratulacje! Osi\u0105gn\u0105\u0142e\u015b cel mocy RTB - ${n.goals.rtbPowerTarget.toLocaleString()} MW!`,"success"),void(e.installedCapacity+e.rtbCapacity>=25e3&&!e.goals.includes("25GW")&&(t({type:"PLAYER_ADD_GOAL_ACHIEVED",payload:"25GW"}),a({type:"SET_NOTIFICATION",payload:{text:"GRATULACJE! Osi\u0105gni\u0119to cel 25GW mocy zainstalowanej i gotowej do budowy!",type:"success"}}),sf("25GW",n.day).catch((e=>console.error("B\u0142\u0105d zapisywania wyniku 25GW:",e)))))):e.cash>=n.goals.cashTarget?(a({type:"SET_WIN_CONDITION",payload:"cash"}),o(`Gratulacje! Osi\u0105gn\u0105\u0142e\u015b cel finansowy - ${n.goals.cashTarget.toLocaleString()} PLN!`,"success"),void(e.cash>=1e10&&!e.goals.includes("10BLN")&&(t({type:"PLAYER_ADD_GOAL_ACHIEVED",payload:"10BLN"}),a({type:"SET_NOTIFICATION",payload:{text:"GRATULACJE! Osi\u0105gni\u0119to cel 10 miliard\xf3w PLN!",type:"success"}}),sf("10BLN",n.day).catch((e=>console.error("B\u0142\u0105d zapisywania wyniku 10BLN:",e)))))):void 0};return(0,r.jsx)(hf.Provider,{value:{state:n,dispatch:a,showNotification:o,nextDay:(e,t)=>{if(e&&t)try{const u={...e};u.projects||(u.projects={underConstruction:[],completed:[],readyToBuild:[]}),Array.isArray(u.projects.underConstruction)&&u.projects.underConstruction.length>0&&(u.projects.underConstruction=u.projects.underConstruction.map((e=>e?(e.constructionDaysLeft>0&&(e.constructionDaysLeft-=n.gameSpeed,e.constructionDaysLeft<=0&&(e.constructionDaysLeft=0,e.status="completed",e.completionDate=new Date(n.gameDate),o(`Projekt ${e.name||"bez nazwy"} zosta\u0142 zbudowany i jest gotowy do produkcji!`,"success"),Array.isArray(u.projects.completed)||(u.projects.completed=[]),u.projects.completed.push(e),u.projects.underConstruction=u.projects.underConstruction.filter((t=>t&&t.id!==e.id)))),e):e)));try{c()}catch(r){console.error("B\u0142\u0105d podczas aktualizacji modyfikator\xf3w gry:",r)}a({type:"ADVANCE_DAY"});try{l()}catch(r){console.error("B\u0142\u0105d podczas aktualizacji ekonomii:",r)}if(s)try{s({type:"LIMIT_EVENTS"}),s({type:"CLEAR_EXPIRED_EVENTS",payload:{currentTurn:n.turn}})}catch(r){console.error("B\u0142\u0105d podczas obs\u0142ugi wydarze\u0144:",r)}try{const e=.1,t=.3,a=Math.min(e*(n.gameSpeed||1),t),r=n.globalEvents.currentEvents.length;if(!(r>16)&&Math.random()<a&&s){var i;const e={turn:n.turn||1,date:new Date(n.gameDate||new Date),day:n.day||1};L((null===(i=n.globalEvents)||void 0===i?void 0:i.eventProbabilities)||{},s,Math.min(n.gameSpeed||1,2),e)}}catch(r){console.error("B\u0142\u0105d podczas generowania wydarze\u0144:",r)}try{d(u,t)}catch(r){console.error("B\u0142\u0105d podczas sprawdzania cel\xf3w gry:",r)}t({type:"UPDATE_PLAYER",payload:u});try{window.dispatchEvent(new Event("next-game-day"))}catch(r){console.error("B\u0142\u0105d podczas wysy\u0142ania zdarzenia next-game-day:",r)}}catch(r){console.error("Krytyczny b\u0142\u0105d w funkcji nextDay:",r),o("Wyst\u0105pi\u0142 b\u0142\u0105d podczas przechodzenia do nast\u0119pnego dnia. Spr\xf3buj ponownie.","error")}else console.error("nextDay wywo\u0142ane z nieprawid\u0142owymi parametrami",{playerState:e,playerDispatch:t})},calculateEventsEffect:e=>{if(!n.globalEvents||!n.globalEvents.currentEvents)return 1;const t=n.globalEvents.currentEvents.filter((t=>t.effects&&t.effects[e]));let i=1;return t.forEach((t=>{t.effects&&t.effects[e]&&(i*=t.effects[e])})),i},formatDate:cf,updateReputationModifiers:e=>{a({type:"UPDATE_REPUTATION_MODIFIERS",payload:e})}},children:t})}const mf=()=>{const e=(0,i.useContext)(hf);if(!e)throw new Error("useGameContext musi by\u0107 u\u017cywany wewn\u0105trz GameProvider");return e},ff=[{id:"dolnoslaskie",name:"Dolno\u015bl\u0105skie",gridCapacity:500,solarConditions:70,windConditions:60,socialAcceptance:60,environmentalComplexity:1.2,adminEfficiency:.9,availableLand:12e3,landPriceMultiplier:1.1,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"kujawsko-pomorskie",name:"Kujawsko-Pomorskie",gridCapacity:400,solarConditions:65,windConditions:75,socialAcceptance:50,environmentalComplexity:1,adminEfficiency:1,availableLand:15e3,landPriceMultiplier:.9,projects:[],protests:[],dominantPlayer:null,isOPRO:!0},{id:"lubelskie",name:"Lubelskie",gridCapacity:380,solarConditions:75,windConditions:55,socialAcceptance:65,environmentalComplexity:.9,adminEfficiency:1.1,availableLand:18e3,landPriceMultiplier:.8,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"lubuskie",name:"Lubuskie",gridCapacity:320,solarConditions:65,windConditions:70,socialAcceptance:55,environmentalComplexity:.8,adminEfficiency:1,availableLand:13e3,landPriceMultiplier:.9,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"lodzkie",name:"\u0141\xf3dzkie",gridCapacity:450,solarConditions:70,windConditions:65,socialAcceptance:60,environmentalComplexity:1,adminEfficiency:1,availableLand:14e3,landPriceMultiplier:1,projects:[],protests:[],dominantPlayer:null,isOPRO:!0},{id:"malopolskie",name:"Ma\u0142opolskie",gridCapacity:420,solarConditions:65,windConditions:50,socialAcceptance:55,environmentalComplexity:1.3,adminEfficiency:.9,availableLand:9e3,landPriceMultiplier:1.3,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"mazowieckie",name:"Mazowieckie",gridCapacity:550,solarConditions:70,windConditions:65,socialAcceptance:65,environmentalComplexity:1,adminEfficiency:.8,availableLand:2e4,landPriceMultiplier:1.2,projects:[],protests:[],dominantPlayer:null,isOPRO:!0},{id:"opolskie",name:"Opolskie",gridCapacity:300,solarConditions:65,windConditions:60,socialAcceptance:60,environmentalComplexity:1,adminEfficiency:1.1,availableLand:8e3,landPriceMultiplier:.9,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"podkarpackie",name:"Podkarpackie",gridCapacity:340,solarConditions:70,windConditions:50,socialAcceptance:60,environmentalComplexity:1.2,adminEfficiency:1,availableLand:12e3,landPriceMultiplier:.8,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"podlaskie",name:"Podlaskie",gridCapacity:320,solarConditions:65,windConditions:60,socialAcceptance:55,environmentalComplexity:1.1,adminEfficiency:1,availableLand:16e3,landPriceMultiplier:.7,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"pomorskie",name:"Pomorskie",gridCapacity:430,solarConditions:60,windConditions:85,socialAcceptance:70,environmentalComplexity:1.1,adminEfficiency:.9,availableLand:13e3,landPriceMultiplier:1.1,projects:[],protests:[],dominantPlayer:null,isOPRO:!0},{id:"slaskie",name:"\u015al\u0105skie",gridCapacity:520,solarConditions:65,windConditions:55,socialAcceptance:50,environmentalComplexity:1.4,adminEfficiency:.8,availableLand:7e3,landPriceMultiplier:1.2,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"swietokrzyskie",name:"\u015awi\u0119tokrzyskie",gridCapacity:310,solarConditions:70,windConditions:55,socialAcceptance:60,environmentalComplexity:1,adminEfficiency:1.1,availableLand:1e4,landPriceMultiplier:.8,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"warminsko-mazurskie",name:"Warmi\u0144sko-Mazurskie",gridCapacity:350,solarConditions:60,windConditions:75,socialAcceptance:65,environmentalComplexity:1.2,adminEfficiency:1,availableLand:17e3,landPriceMultiplier:.8,projects:[],protests:[],dominantPlayer:null,isOPRO:!0},{id:"wielkopolskie",name:"Wielkopolskie",gridCapacity:480,solarConditions:65,windConditions:70,socialAcceptance:60,environmentalComplexity:1,adminEfficiency:.9,availableLand:19e3,landPriceMultiplier:1,projects:[],protests:[],dominantPlayer:null,isOPRO:!0},{id:"zachodniopomorskie",name:"Zachodniopomorskie",gridCapacity:400,solarConditions:60,windConditions:90,socialAcceptance:70,environmentalComplexity:1,adminEfficiency:1,availableLand:15e3,landPriceMultiplier:.9,projects:[],protests:[],dominantPlayer:null,isOPRO:!0}],yf=(0,i.createContext)();function gf(e,t){switch(t.type){case"UPDATE_REGION":return e.map((e=>e.id===t.payload.id?{...e,...t.payload.changes}:e));case"ADD_PROJECT_TO_REGION":return e.map((e=>e.id===t.payload.regionId?{...e,projects:[...e.projects,t.payload.project],availableLand:Math.max(0,e.availableLand-t.payload.project.size)}:e));case"UPDATE_REGIONAL_CONDITIONS":return e.map((e=>{const t=Math.floor(5*Math.random())-2,n=Math.floor(5*Math.random())-2,i=Math.floor(3*Math.random())-1;return{...e,solarConditions:Math.min(100,Math.max(0,e.solarConditions+t)),windConditions:Math.min(100,Math.max(0,e.windConditions+n)),socialAcceptance:Math.min(100,Math.max(0,e.socialAcceptance+i))}}));case"ADD_LAND_ACQUISITION_PROCESS":return e.map((e=>e.id===t.payload.regionId?{...e,landAcquisitionProcesses:[...e.landAcquisitionProcesses||[],t.payload.process]}:e));case"UPDATE_LAND_ACQUISITION_PROCESS":return e.map((e=>e.id===t.payload.regionId?{...e,landAcquisitionProcesses:(e.landAcquisitionProcesses||[]).map((e=>e.id===t.payload.processId?{...e,...t.payload.changes}:e))}:e));case"REMOVE_LAND_ACQUISITION_PROCESS":return e.map((e=>e.id===t.payload.regionId?{...e,landAcquisitionProcesses:(e.landAcquisitionProcesses||[]).filter((e=>e.id!==t.payload.processId))}:e));case"UPDATE_LAND_ACQUISITION_PROCESSES_PROGRESS":return e.map((e=>{const n=(e.landAcquisitionProcesses||[]).map((n=>{if("in_progress"===n.status){const i=new Date(t.payload.currentDate),a=new Date(n.startDate),r=new Date(n.completionDate);if(console.log("Aktualizacja procesu pozyskiwania gruntu:",{processId:n.id,regionId:e.id,currentDate:i.toISOString(),startDate:a.toISOString(),completionDate:r.toISOString()}),i>=r)return console.log(`Proces ${n.id} zako\u0144czony, post\u0119p 100%`),{...n,status:"ready_for_negotiation",progress:100};if(i>a){const e=r.getTime()-a.getTime(),t=i.getTime()-a.getTime(),s=Math.min(99,Math.floor(t/e*100));return console.log(`Proces ${n.id} w trakcie, post\u0119p ${s}%`),{...n,progress:s}}}return n}));return{...e,landAcquisitionProcesses:n}}));default:return e}}const vf=e=>{let{children:t}=e;const[n,a]=(0,i.useReducer)(gf,ff),{state:s,showNotification:o}=mf();return(0,i.useEffect)((()=>{const e=e=>{console.log("Wywo\u0142anie wydarzenia update-land-acquisition",e.detail),a({type:"UPDATE_LAND_ACQUISITION_PROCESSES_PROGRESS",payload:{currentDate:e.detail.currentDate||new Date(s.gameDate)}})},t=()=>{console.log("Wywo\u0142anie wydarzenia next-game-day, aktualizacja proces\xf3w gruntowych");const e=new Date(s.gameDate);a({type:"UPDATE_LAND_ACQUISITION_PROCESSES_PROGRESS",payload:{currentDate:e}}),n.forEach((e=>{e.landAcquisitionProcesses&&e.landAcquisitionProcesses.forEach((t=>{"ready_for_negotiation"===t.status&&100===t.progress&&o(`Proces poszukiwania dzia\u0142ki ${t.size}ha w regionie ${e.name} zako\u0144czony. Skaut ${t.scoutName} czeka na rozpocz\u0119cie negocjacji.`,"success")}))}))};return window.addEventListener("update-land-acquisition",e),window.addEventListener("next-game-day",t),()=>{window.removeEventListener("update-land-acquisition",e),window.removeEventListener("next-game-day",t)}}),[a,n,s.gameDate,o]),(0,r.jsx)(yf.Provider,{value:{state:n,dispatch:a},children:t})},wf=()=>{const e=(0,i.useContext)(yf);if(!e)throw new Error("useRegionsContext must be used within a RegionsProvider");return e},xf={dolnoslaskie:[{id:"wroclawski",name:"Wroc\u0142awski",capital:"Wroc\u0142aw",population:64e4,area:2930,solarPotential:75,windPotential:60,availableLand:1800,gridCapacity:120,environmentalRestrictions:45,administrativeEfficiency:70,localOpposition:35,propertyPrices:1.8,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}},{id:"jeleniogorski",name:"Jeleniog\xf3rski",capital:"Jelenia G\xf3ra",population:12e4,area:1880,solarPotential:65,windPotential:85,availableLand:1200,gridCapacity:80,environmentalRestrictions:75,administrativeEfficiency:65,localOpposition:45,propertyPrices:1.2,projects:[],events:[],isNatura2000:!0,isProtectedLandscape:!0,powerLines:{hv:!0,mv:!0}},{id:"walbrzyski",name:"Wa\u0142brzyski",capital:"Wa\u0142brzych",population:17e4,area:1650,solarPotential:60,windPotential:70,availableLand:900,gridCapacity:70,environmentalRestrictions:65,administrativeEfficiency:60,localOpposition:50,propertyPrices:.9,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!0,powerLines:{hv:!0,mv:!0}}],mazowieckie:[{id:"warszawski",name:"Warszawski",capital:"Warszawa",population:18e5,area:3200,solarPotential:70,windPotential:55,availableLand:1300,gridCapacity:250,environmentalRestrictions:50,administrativeEfficiency:80,localOpposition:40,propertyPrices:3.2,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}},{id:"radomski",name:"Radomski",capital:"Radom",population:25e4,area:2500,solarPotential:75,windPotential:60,availableLand:2100,gridCapacity:90,environmentalRestrictions:35,administrativeEfficiency:65,localOpposition:30,propertyPrices:.8,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}},{id:"plocki",name:"P\u0142ocki",capital:"P\u0142ock",population:17e4,area:1800,solarPotential:65,windPotential:70,availableLand:1900,gridCapacity:110,environmentalRestrictions:40,administrativeEfficiency:60,localOpposition:25,propertyPrices:.9,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}}],wielkopolskie:[{id:"poznanski",name:"Pozna\u0144ski",capital:"Pozna\u0144",population:54e4,area:2800,solarPotential:65,windPotential:80,availableLand:2200,gridCapacity:150,environmentalRestrictions:40,administrativeEfficiency:75,localOpposition:30,propertyPrices:2.1,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}},{id:"kaliski",name:"Kaliski",capital:"Kalisz",population:16e4,area:2100,solarPotential:70,windPotential:65,availableLand:1800,gridCapacity:85,environmentalRestrictions:35,administrativeEfficiency:70,localOpposition:25,propertyPrices:1.1,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}}],malopolskie:[{id:"krakowski",name:"Krakowski",capital:"Krak\xf3w",population:76e4,area:2300,solarPotential:65,windPotential:40,availableLand:1100,gridCapacity:130,environmentalRestrictions:70,administrativeEfficiency:75,localOpposition:55,propertyPrices:2.5,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!0,powerLines:{hv:!0,mv:!0}},{id:"tarnowski",name:"Tarnowski",capital:"Tarn\xf3w",population:15e4,area:1900,solarPotential:70,windPotential:45,availableLand:1500,gridCapacity:70,environmentalRestrictions:55,administrativeEfficiency:65,localOpposition:40,propertyPrices:1,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}}],pomorskie:[{id:"gdanski",name:"Gda\u0144ski",capital:"Gda\u0144sk",population:47e4,area:2200,solarPotential:60,windPotential:95,availableLand:1400,gridCapacity:160,environmentalRestrictions:60,administrativeEfficiency:75,localOpposition:35,propertyPrices:2.3,projects:[],events:[],isNatura2000:!0,isProtectedLandscape:!0,powerLines:{hv:!0,mv:!0}},{id:"slupski",name:"S\u0142upski",capital:"S\u0142upsk",population:12e4,area:2500,solarPotential:55,windPotential:100,availableLand:2e3,gridCapacity:120,environmentalRestrictions:55,administrativeEfficiency:60,localOpposition:30,propertyPrices:.9,projects:[],events:[],isNatura2000:!0,isProtectedLandscape:!0,powerLines:{hv:!0,mv:!0}}]},bf=(0,i.createContext)(),jf=(()=>{const e=[];return Object.keys(xf).forEach((t=>{xf[t].forEach((n=>{e.push({...n,voivodeship:t})}))})),e})();function kf(e,t){switch(t.type){case"UPDATE_COUNTY":return e.map((e=>e.id===t.payload.id&&e.voivodeship===t.payload.voivodeship?{...e,...t.payload.changes}:e));case"ADD_PROJECT_TO_COUNTY":return e.map((e=>e.id===t.payload.countyId&&e.voivodeship===t.payload.voivodeship?{...e,projects:[...e.projects,t.payload.project],availableLand:Math.max(0,e.availableLand-t.payload.project.size)}:e));case"REMOVE_PROJECT_FROM_COUNTY":return e.map((e=>e.id===t.payload.countyId&&e.voivodeship===t.payload.voivodeship?{...e,projects:e.projects.filter((e=>e.id!==t.payload.projectId)),availableLand:e.availableLand+t.payload.projectSize}:e));case"ADD_EVENT_TO_COUNTY":return e.map((e=>e.id===t.payload.countyId&&e.voivodeship===t.payload.voivodeship?{...e,events:[...e.events,t.payload.event]}:e));case"REMOVE_EVENT_FROM_COUNTY":return e.map((e=>e.id===t.payload.countyId&&e.voivodeship===t.payload.voivodeship?{...e,events:e.events.filter((e=>e.id!==t.payload.eventId))}:e));case"UPDATE_COUNTY_PARAMETERS":return e.map((e=>e.id===t.payload.countyId&&e.voivodeship===t.payload.voivodeship?{...e,...t.payload.parameters}:e));case"UPDATE_ALL_COUNTIES":return e.map((e=>{const t=5*Math.random()-2.5,n=5*Math.random()-2.5,i=3*Math.random()-1.5,a=(.1*Math.random()-.05)*e.propertyPrices;return{...e,solarPotential:Math.max(0,Math.min(100,e.solarPotential+t)),windPotential:Math.max(0,Math.min(100,e.windPotential+n)),localOpposition:Math.max(0,Math.min(100,e.localOpposition+i)),propertyPrices:Math.max(.5,e.propertyPrices+a)}}));default:return e}}const Nf=e=>{let{children:t}=e;const[n,a]=(0,i.useReducer)(kf,jf);return(0,r.jsx)(bf.Provider,{value:{state:n,dispatch:a},children:t})},zf={competitors:u,competitorEvents:[],lastUpdateTurn:0},_f="UPDATE_COMPETITORS",Ef="ADD_COMPETITOR_EVENT",Sf="INCREASE_COMPETITOR_POWER",Tf="ADD_COMPETITOR_REGION",Cf="ADD_COMPETITOR_TECHNOLOGY",Pf=(e,t)=>{switch(t.type){case _f:return{...e,competitors:t.payload,lastUpdateTurn:t.turn};case Ef:return{...e,competitorEvents:[...e.competitorEvents,t.payload]};case Sf:return{...e,competitors:e.competitors.map((e=>e.id===t.payload.competitorId?{...e,power:e.power+t.payload.value,rtbPower:e.rtbPower+Math.floor(.3*t.payload.value)}:e))};case Tf:return{...e,competitors:e.competitors.map((e=>e.id===t.payload.competitorId?{...e,strongRegions:[...e.strongRegions,t.payload.regionId]}:e))};case Cf:return{...e,competitors:e.competitors.map((e=>e.id===t.payload.competitorId?{...e,focusTechnologies:[...e.focusTechnologies,t.payload.technology]}:e))};default:return e}},If=(0,i.createContext)(),Af=e=>{let{children:t}=e;const[n,a]=(0,i.useReducer)(Pf,zf),{state:s}=mf(),{state:o}=wf();(0,i.useEffect)((()=>{s.turn>n.lastUpdateTurn&&(l(),c())}),[s.turn]);const l=()=>{const e=n.competitors.map((e=>{const t=Math.floor(e.power*(e.growth-1)),n=Math.floor(.3*t);return{...e,power:e.power+t,rtbPower:e.rtbPower+n}}));a({type:_f,payload:e,turn:s.turn})},c=()=>{if(!o||!o.regions||0===o.regions.length)return;const e=n.competitors[Math.floor(Math.random()*n.competitors.length)],t=h(e,o.regions);t&&(a({type:Ef,payload:{...t,turn:s.turn}}),t.effects.forEach((e=>{switch(e.type){case"competitor_power":case"competitor_power_boost":a({type:Sf,payload:{competitorId:e.competitorId,value:e.value}});break;case"competitor_technology":a({type:Cf,payload:{competitorId:e.competitorId,technology:e.value}})}})))};return(0,r.jsx)(If.Provider,{value:{state:n,dispatch:a},children:t})},Mf=()=>{const{state:e,dispatch:t}=d(),{state:n,dispatch:a}=mf(),r=(0,i.useCallback)((()=>{try{console.log("Odebrano zdarzenie next-game-day, gameSpeed:",(null===n||void 0===n?void 0:n.gameSpeed)||1),n&&n.appView&&a({type:"SET_APP_VIEW",payload:null});try{window.dispatchEvent(new CustomEvent("process-time-acceleration",{detail:{gameSpeed:(null===n||void 0===n?void 0:n.gameSpeed)||1,day:(null===n||void 0===n?void 0:n.day)||1,turn:(null===n||void 0===n?void 0:n.turn)||1}}))}catch(e){console.error("B\u0142\u0105d przy wysy\u0142aniu zdarzenia process-time-acceleration:",e)}}catch(e){console.error("B\u0142\u0105d w obs\u0142udze zdarzenia next-game-day:",e)}}),[n,a]);return(0,i.useEffect)((()=>(window.addEventListener("next-game-day",r),()=>{window.removeEventListener("next-game-day",r)})),[r]),null};class Df extends i.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("B\u0142\u0105d w komponencie Store:",e,t),this.setState({errorInfo:t})}render(){var e;return this.state.hasError?(0,r.jsxs)("div",{className:"store-error-boundary",children:[(0,r.jsx)("h2",{children:"Wyst\u0105pi\u0142 b\u0142\u0105d w aplikacji"}),(0,r.jsx)("p",{children:(null===(e=this.state.error)||void 0===e?void 0:e.message)||"Nieznany b\u0142\u0105d"}),(0,r.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-500 text-white rounded",children:"Od\u015bwie\u017c stron\u0119"})]}):this.props.children}}const Rf=e=>{let{children:t}=e;return(0,r.jsx)(Df,{children:(0,r.jsx)(W,{children:(0,r.jsx)(c,{children:(0,r.jsx)(pf,{children:(0,r.jsx)(vf,{children:(0,r.jsx)(Nf,{children:(0,r.jsxs)(Af,{children:[(0,r.jsx)(Mf,{}),t]})})})})})})})};var Of={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Lf=(e,t)=>{const n=(0,i.forwardRef)(((n,a)=>{let{color:r="currentColor",size:s=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:d,...u}=n;return(0,i.createElement)("svg",{ref:a,...Of,width:s,height:s,stroke:r,strokeWidth:l?24*Number(o)/Number(s):o,className:["lucide",`lucide-${h=e,h.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()}`,c].join(" "),...u},[...t.map((e=>{let[t,n]=e;return(0,i.createElement)(t,n)})),...Array.isArray(d)?d:[d]]);var h}));return n.displayName=`${e}`,n},Ff=Lf("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Uf=Lf("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Vf=Lf("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]),$f=Lf("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),Bf=Lf("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),Wf=Lf("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]),qf=Lf("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Hf=Lf("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Gf=Lf("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Kf=Lf("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Qf=Lf("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),Zf=Lf("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Yf=Lf("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),Jf=Lf("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Xf=e=>{let{text:t,type:n="info",onClose:a,autoClose:s=!0,duration:o=5e3}=e;(0,i.useEffect)((()=>{if(s){const e=setTimeout((()=>{a()}),o);return()=>clearTimeout(e)}}),[s,o,a]);return(0,r.jsxs)("div",{className:(()=>{const e="notification flex items-center";switch(n){case"win":case"success":return`${e} bg-green-500 text-white`;case"error":return`${e} bg-red-500 text-white`;case"warning":return`${e} bg-yellow-500 text-black`;default:return`${e} bg-blue-500 text-white`}})(),children:[(0,r.jsx)("div",{className:"mr-4",children:t}),(0,r.jsx)("button",{className:"ml-4 px-2 py-1 rounded bg-opacity-20 bg-black hover:bg-opacity-30 transition-all",onClick:a,children:"\u2715"})]})},ey=Lf("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),ty=Lf("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),ny=Lf("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),iy=Lf("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);class ay{constructor(e,t,n){this.playerState=e,this.playerDispatch=t,this.gameState=n}getReputationStatus(){const{reputation:e,reputationFactors:t,reputationHistory:n}=this.playerState;return{current:e,category:this.getReputationCategory(e),factors:t,trend:this.calculateReputationTrend(n)}}calculateReputationTrend(e){if(!e||e.length<5)return"stable";const t=e.filter((e=>void 0!==e.change)).slice(-5).map((e=>e.change));if(0===t.length)return"stable";const n=t.reduce(((e,t)=>e+t),0);return n>5?"rising":n<-5?"falling":"stable"}getReputationCategory(e){return e>=150?"excellent":e>=100?"good":e>=50?"average":e>=25?"poor":"terrible"}getReputationModifiers(){const{reputation:e,reputationFactors:t}=this.playerState,n={projectCost:1,constructionSpeed:1,projectQuality:1,staffRecruitmentCost:1,loanInterestRate:1,projectSalePrice:1,auditFrequency:1,stakeholderTrust:1};e>=150?(n.projectCost*=.85,n.constructionSpeed*=1.2,n.staffRecruitmentCost*=.9,n.loanInterestRate*=.8,n.projectSalePrice*=1.25,n.auditFrequency*=.5,n.stakeholderTrust*=1.5):e>=100?(n.projectCost*=.95,n.constructionSpeed*=1.1,n.loanInterestRate*=.9,n.projectSalePrice*=1.1,n.auditFrequency*=.8,n.stakeholderTrust*=1.2):e>=50||(e>=25?(n.projectCost*=1.1,n.constructionSpeed*=.9,n.staffRecruitmentCost*=1.1,n.loanInterestRate*=1.2,n.projectSalePrice*=.9,n.auditFrequency*=1.5,n.stakeholderTrust*=.8):(n.projectCost*=1.25,n.constructionSpeed*=.8,n.staffRecruitmentCost*=1.25,n.loanInterestRate*=1.5,n.projectSalePrice*=.75,n.auditFrequency*=2.5,n.stakeholderTrust*=.5));const{legalCompliance:i,environmentalImpact:a,communityRelations:r,projectQuality:s,transparency:o,grayAreaActivity:l}=t;return n.auditFrequency*=1-i+1,n.loanInterestRate*=1+.3*(1-i),n.projectSalePrice*=1+.2*(a-1),n.stakeholderTrust*=1+.2*(a-1),n.constructionSpeed*=1+.1*(r-1),n.stakeholderTrust*=1+.3*(r-1),n.projectSalePrice*=1+.3*(s-1),n.projectCost*=1-.1*(s-1),n.loanInterestRate*=1-.2*(o-1),n.auditFrequency*=1-.1*(o-1),n.auditFrequency*=1+.5*(l-1),n.stakeholderTrust*=1-.3*(l-1),n}calculateReputationBonus(e){const{reputation:t,reputationFactors:n}=this.playerState;let i=0;i=t>=150?.2:t>=100?.1:t>=50?0:t>=25?-.1:-.2;const a={negotiate_land:["communityRelations","transparency"],apply_for_permit:["legalCompliance","transparency"],environmental_study:["environmentalImpact","projectQuality"],lobby_officials:["transparency","legalCompliance"],project_design:["projectQuality","environmentalImpact"],build_project:["projectQuality","communityRelations"],get_grid_connection:["legalCompliance","transparency"],get_loan:["legalCompliance","transparency"]}[e]||[];let r=0;if(a.length>0){const e=a.reduce(((e,t)=>e+(n[t]||1)),0);r=.2*(e/a.length-1)}const s=i+r;return Math.max(-.3,Math.min(.3,s))}updateReputationForEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={project_success:{reputationChange:5,factorChanges:{projectQuality:.05}},project_delay:{reputationChange:-3,factorChanges:{projectQuality:-.03,transparency:-.02}},local_protest:{reputationChange:-8,factorChanges:{communityRelations:-.1,transparency:-.05}},environmental_award:{reputationChange:10,factorChanges:{environmentalImpact:.1,projectQuality:.05}},project_overbudget:{reputationChange:-5,factorChanges:{projectQuality:-.05,transparency:-.03}},positive_media_coverage:{reputationChange:7,factorChanges:{transparency:.05}},negative_media_coverage:{reputationChange:-7,factorChanges:{transparency:-.05}},successful_audit:{reputationChange:8,factorChanges:{legalCompliance:.08,transparency:.05}},innovation_breakthrough:{reputationChange:12,factorChanges:{projectQuality:.1,environmentalImpact:.08}},staff_incident:{reputationChange:-6,factorChanges:{transparency:-.04,projectQuality:-.03}}}[e];if(n&&(this.playerDispatch({type:"UPDATE_REPUTATION",payload:{change:n.reputationChange,reason:t.reason||`Zdarzenie: ${e}`,turn:this.gameState.turn}}),n.factorChanges))for(const[i,a]of Object.entries(n.factorChanges))this.playerDispatch({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:i,change:a,reason:t.reason||`Zdarzenie: ${e}`,turn:this.gameState.turn}})}triggerRandomEvent(){const{reputation:e,reputationFactors:t}=this.playerState,n=[{type:"positive_media_coverage",weight:10+(e-100)/5,condition:()=>e>70&&t.transparency>.8},{type:"negative_media_coverage",weight:10+(100-e)/5,condition:()=>e<130&&t.transparency<1.2},{type:"local_protest",weight:8+20*(1-t.communityRelations),condition:()=>t.communityRelations<1.3},{type:"environmental_award",weight:5+20*(t.environmentalImpact-1),condition:()=>t.environmentalImpact>1.2&&e>80},{type:"innovation_breakthrough",weight:3+10*(t.projectQuality-1),condition:()=>t.projectQuality>1.1},{type:"staff_incident",weight:7-10*(t.projectQuality-1),condition:()=>t.projectQuality<1.3}].filter((e=>e.condition()));if(0===n.length)return null;const i=n.reduce(((e,t)=>e+Math.max(1,t.weight)),0);let a=Math.random()*i,r=null;for(const s of n){const e=Math.max(1,s.weight);if(a<=e){r=s;break}a-=e}return r||(r=n[0]),this.updateReputationForEvent(r.type),{type:r.type,description:this.getEventDescription(r.type),turn:this.gameState.turn}}getEventDescription(e){return{project_success:"Tw\xf3j projekt zosta\u0142 uko\u0144czony przed terminem, co spotka\u0142o si\u0119 z uznaniem bran\u017cy.",project_delay:"Op\xf3\u017anienia w realizacji projektu wywo\u0142a\u0142y niezadowolenie inwestor\xf3w.",local_protest:"Mieszka\u0144cy protestuj\u0105 przeciwko Twojej inwestycji, obawiaj\u0105c si\u0119 jej wp\u0142ywu na lokaln\u0105 spo\u0142eczno\u015b\u0107.",environmental_award:"Twoja firma otrzyma\u0142a nagrod\u0119 za wk\u0142ad w ochron\u0119 \u015brodowiska i zr\xf3wnowa\u017cony rozw\xf3j.",project_overbudget:"Jeden z Twoich projekt\xf3w znacznie przekroczy\u0142 bud\u017cet, wzbudzaj\u0105c obawy o zarz\u0105dzanie finansami.",positive_media_coverage:"Media pozytywnie opisa\u0142y dzia\u0142alno\u015b\u0107 Twojej firmy, podkre\u015blaj\u0105c jej etyczne praktyki.",negative_media_coverage:"Krytyczny artyku\u0142 w mediach rzuci\u0142 cie\u0144 na reputacj\u0119 Twojej firmy.",successful_audit:"Twoja firma przesz\u0142a audyt z wyr\xf3\u017cnieniem, potwierdzaj\u0105c zgodno\u015b\u0107 z przepisami.",innovation_breakthrough:"Tw\xf3j zesp\xf3\u0142 opracowa\u0142 innowacyjne rozwi\u0105zanie, kt\xf3re zosta\u0142o docenione przez bran\u017c\u0119.",staff_incident:"Incydent z udzia\u0142em pracownika Twojej firmy wywo\u0142a\u0142 negatywne komentarze."}[e]||"Nieznane zdarzenie wp\u0142yn\u0119\u0142o na reputacj\u0119 Twojej firmy."}generateReputationReport(){const{reputation:e,reputationFactors:t,reputationHistory:n}=this.playerState,i=n.filter((e=>e.turn>=this.gameState.turn-10)).map((e=>({turn:e.turn,reason:e.reason,change:e.change,type:e.type,factor:e.factor}))),a=Object.entries(t);a.sort(((e,t)=>t[1]-e[1]));const r=a.slice(0,2).map((e=>{let[t,n]=e;return{factor:t,value:n}}));a.sort(((e,t)=>e[1]-t[1]));const s=a.slice(0,2).map((e=>{let[t,n]=e;return{factor:t,value:n}})),o=this.calculateReputationTrend(n),l=this.generateRecommendations(e,t,s.map((e=>e.factor)));return{currentReputation:e,category:this.getReputationCategory(e),trend:o,factors:t,strongestFactors:r,weakestFactors:s,recentChanges:i,recommendations:l,modifiers:this.getReputationModifiers()}}generateRecommendations(e,t,n){const i=[];return e<50&&i.push({text:"Rozwa\u017c przeprowadzenie kompleksowej kampanii naprawczej reputacji.",priority:"high"}),e<80&&e>=50&&i.push({text:"Zwi\u0119ksz przejrzysto\u015b\u0107 komunikacji z interesariuszami.",priority:"medium"}),n.forEach((e=>{const n=t[e];if(n<.7){const t={legalCompliance:"Zainwestuj w program zgodno\u015bci prawnej i szkolenia dla pracownik\xf3w.",environmentalImpact:"Zainwestuj w inicjatywy \u015brodowiskowe i ulepsz standardy projektowe.",communityRelations:"Nawi\u0105\u017c dialog ze spo\u0142eczno\u015bciami lokalnymi i wspieraj lokalne inicjatywy.",projectQuality:"Wprowad\u017a rygorystyczne kontrole jako\u015bci i zainwestuj w szkolenia zespo\u0142u.",transparency:"Zwi\u0119ksz przejrzysto\u015b\u0107 dzia\u0142a\u0144 firmy i komunikacj\u0119 z interesariuszami.",grayAreaActivity:"Przeprowad\u017a wewn\u0119trzny audyt i wyeliminuj praktyki z szarej strefy."};t.push({text:t[e]||`Popraw czynnik: ${e}`,priority:"high",factor:e})}else if(n<1){const t={legalCompliance:"Regularnie przegl\u0105daj zgodno\u015b\u0107 z przepisami i wytycznymi bran\u017cowymi.",environmentalImpact:"Monitoruj wp\u0142yw projekt\xf3w na \u015brodowisko i wprowadzaj ulepszenia.",communityRelations:"Organizuj regularne konsultacje spo\u0142eczne i wydarzenia dla spo\u0142eczno\u015bci.",projectQuality:"Zbieraj i analizuj feedback dotycz\u0105cy jako\u015bci projekt\xf3w.",transparency:"Publikuj regularne raporty z dzia\u0142alno\u015bci firmy.",grayAreaActivity:"Wprowad\u017a program etyczny i mechanizmy zg\u0142aszania nieprawid\u0142owo\u015bci."};t.push({text:t[e]||`Popraw czynnik: ${e}`,priority:"medium",factor:e})}})),t.grayAreaActivity>=1.3&&i.push({text:"Uwaga! Wysoki poziom aktywno\u015bci w szarej strefie zwi\u0119ksza ryzyko audytu!",priority:"critical",factor:"grayAreaActivity"}),i}}class ry{constructor(e,t,n){this.playerState=e,this.playerDispatch=t,this.gameState=n}calculateAuditRisk(){const{illegals:e,reputationFactors:t}=this.playerState,n=e.auditRisk,i=.2*e.corruptionNetwork,a=40*(t.grayAreaActivity-1),r=3*e.illegalActionHistory.filter((e=>e.turn>this.gameState.turn-10)).length;return Math.min(95,Math.max(5,n-i+a+r))}executeIllegalAction(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{cost:n=0,target:i=null,riskIncrease:a=5}=t;if(this.playerState.cash<n)return{success:!1,reason:"Niewystarczaj\u0105ca ilo\u015b\u0107 got\xf3wki"};this.playerDispatch({type:"ADD_ILLEGAL_ACTION",payload:{type:e,target:i,cost:n,turn:this.gameState.turn,exposed:!1}}),this.playerDispatch({type:"UPDATE_ILLEGALS_STATUS",payload:{auditRisk:Math.min(100,this.playerState.illegals.auditRisk+a)}}),this.updateReputationForIllegalAction(e,t);const r=this.calculateDetectionRisk(e);return 100*Math.random()<r?(this.handleDetection(e,t),{success:!0,detected:!0,consequences:"Dzia\u0142anie zosta\u0142o wykryte, co mia\u0142o negatywny wp\u0142yw na reputacj\u0119 firmy."}):{success:!0,detected:!1}}updateReputationForIllegalAction(e,t){const n={bribe_official:{transparency:-.05,legalCompliance:-.1,grayAreaActivity:.08},falsify_documents:{transparency:-.08,legalCompliance:-.15,grayAreaActivity:.1},intimidate_opposition:{communityRelations:-.12,transparency:-.07,grayAreaActivity:.12},create_illegal_database:{transparency:-.1,legalCompliance:-.15,grayAreaActivity:.2},build_corruption_network:{transparency:-.15,legalCompliance:-.2,grayAreaActivity:.25},buy_land_illegally:{legalCompliance:-.12,grayAreaActivity:.15}}[e]||{};for(const[i,a]of Object.entries(n))this.playerDispatch({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:i,change:a,reason:`Nielegalne dzia\u0142anie: ${this.getActionName(e)}`,turn:this.gameState.turn}});this.playerDispatch({type:"UPDATE_REPUTATION",payload:{change:-5,reason:`Nielegalne dzia\u0142anie: ${this.getActionName(e)}`,turn:this.gameState.turn}})}calculateDetectionRisk(e){const{illegals:t,reputationFactors:n}=this.playerState,i={bribe_official:15,falsify_documents:20,intimidate_opposition:25,create_illegal_database:10,build_corruption_network:15,buy_land_illegally:30}[e]||20,a=.15*t.corruptionNetwork,r=10*n.transparency;return Math.min(90,Math.max(5,i-a+r))}handleDetection(e,t){this.playerDispatch({type:"UPDATE_REPUTATION",payload:{change:-15,reason:`Wykryto nielegalne dzia\u0142anie: ${this.getActionName(e)}`,turn:this.gameState.turn}}),this.playerDispatch({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:"transparency",change:-.2,reason:`Wykryto nielegalne dzia\u0142anie: ${this.getActionName(e)}`,turn:this.gameState.turn}}),this.playerDispatch({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:"legalCompliance",change:-.25,reason:`Wykryto nielegalne dzia\u0142anie: ${this.getActionName(e)}`,turn:this.gameState.turn}});const n=this.playerState.illegals.illegalActionHistory.length-1;if(n>=0){const e=[...this.playerState.illegals.illegalActionHistory];e[n]={...e[n],exposed:!0},this.playerDispatch({type:"UPDATE_ILLEGALS_STATUS",payload:{illegalActionHistory:e,auditRisk:Math.min(100,this.playerState.illegals.auditRisk+20)}})}}conductAudit(){const{illegals:e,reputationFactors:t}=this.playerState;let n=30;n-=.3*e.corruptionNetwork,n+=20*t.grayAreaActivity;const i=e.illegalActionHistory.filter((e=>e.turn>this.gameState.turn-20)).length;n+=5*i;const a=100*Math.random()<n;let r=0,s=0;return a&&(r=5e5,r+=25e4*i,r*=1-e.corruptionNetwork/200,s=15+2*i,this.playerDispatch({type:"UPDATE_REPUTATION",payload:{change:-s,reason:"Nieprawid\u0142owo\u015bci wykryte podczas audytu",turn:this.gameState.turn}}),this.playerDispatch({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:"legalCompliance",change:-.15,reason:"Nieprawid\u0142owo\u015bci wykryte podczas audytu",turn:this.gameState.turn}}),this.playerDispatch({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:"transparency",change:-.1,reason:"Nieprawid\u0142owo\u015bci wykryte podczas audytu",turn:this.gameState.turn}})),this.playerDispatch({type:"TRIGGER_AUDIT",payload:{passed:!a,fine:r,reputationLoss:s,turn:this.gameState.turn,riskReduction:20}}),{passed:!a,fine:r,reputationLoss:s}}getActionName(e){return{bribe_official:"Przekupienie urz\u0119dnika",falsify_documents:"Fa\u0142szowanie dokument\xf3w",intimidate_opposition:"Zastraszanie opozycji",create_illegal_database:"Stworzenie nielegalnej bazy danych",build_corruption_network:"Budowa sieci korupcyjnej",buy_land_illegally:"Nielegalne nabycie grunt\xf3w"}[e]||e}getGrayAreaStatus(){const{illegals:e,reputationFactors:t}=this.playerState;return{auditRisk:this.calculateAuditRisk(),corruptionNetwork:e.corruptionNetwork,grayAreaActivity:t.grayAreaActivity,recentIllegalActions:e.illegalActionHistory.filter((e=>e.turn>this.gameState.turn-10)).length,lastAuditTurn:e.lastAuditTurn,turnsSinceLastAudit:this.gameState.turn-e.lastAuditTurn,hasIllegalDatabase:e.hasIllegalDatabase}}}class sy{constructor(e,t,n,i){this.playerState=e,this.playerDispatch=t,this.gameState=n,this.reputationManager=i}calculateMaxCreditLimit(){const{cash:e,economicMetrics:t,reputation:n,projects:i}=this.playerState;let a=1;a=n>=150?1.5:n>=100?1.2:n>=50?1:n>=25?.7:.5;const r=(2*e+.75*i.reduce(((e,t)=>e+(t.marketValue||0)),0))*a,s=Math.min(5e7+this.gameState.turn/30*5e7,5e8);return Math.min(r,s)}calculateInterestRate(e,t){var n;const i=this.reputationManager.getReputationModifiers().loanInterestRate,a=(null===(n=this.gameState.economyState)||void 0===n?void 0:n.baseInterestRate)||3;let r=0;t<=12?r=-.5:t>=36&&(r=1);let s=0;e<=1e6?s=.5:e>=1e7&&(s=-.5);const o=this.getTotalOutstandingLoans(),l=(a+r+s+Math.min(2,o/1e7))*i;return Math.max(1.5,Math.min(12,l))}getTotalOutstandingLoans(){const{loans:e}=this.playerState;return e&&0!==e.length?e.reduce(((e,t)=>t.remainingAmount?e+t.remainingAmount:e),0):0}calculateMonthlyPayment(e,t,n){const i=t/100/12;return e*i*Math.pow(1+i,n)/(Math.pow(1+i,n)-1)}applyForLoan(e,t,n){const i=this.calculateMaxCreditLimit();if(e>i)return{success:!1,reason:`Przekroczono limit kredytowy ${i.toLocaleString()} PLN`};const a=this.calculateInterestRate(e,t),r=this.calculateMonthlyPayment(e,a,t),s=this.generateLoanSchedule(e,a,t),o=`loan_${Date.now()}`;return this.playerDispatch({type:"ADD_LOAN",payload:{id:o,amount:e,interestRate:a,durationMonths:t,monthlyPayment:r,remainingAmount:e,remainingPayments:t,startDate:(new Date).toISOString(),purpose:n,schedule:s,status:"active"}}),{success:!0,loanId:o,amount:e,interestRate:a,monthlyPayment:r,durationMonths:t}}generateLoanSchedule(e,t,n){const i=t/100/12,a=this.calculateMonthlyPayment(e,t,n);let r=e;const s=[];for(let o=1;o<=n;o++){const e=r*i,t=a-e;r-=t,s.push({paymentNumber:o,date:this.addMonths(new Date,o),payment:a,principal:t,interest:e,remainingPrincipal:Math.max(0,r),paid:!1})}return s}processMonthlyPayments(){const{loans:e,cash:t}=this.playerState;if(!e||0===e.length)return{success:!0,message:"Brak aktywnych kredyt\xf3w"};let n=0;const i=[],a=[];for(const r of e)"active"===r.status&&(n+=r.monthlyPayment);if(t<n)return{success:!1,message:`Niewystarczaj\u0105ce \u015brodki na sp\u0142at\u0119 rat kredyt\xf3w (${n.toLocaleString()} PLN)`,shortfall:n-t};this.playerDispatch({type:"UPDATE_CASH",payload:-n});for(const r of e){if("active"!==r.status)continue;const e=r.remainingPayments-1,t=r.schedule[r.durationMonths-r.remainingPayments];if(t){const n=[...r.schedule];n[r.durationMonths-r.remainingPayments]={...t,paid:!0,paidDate:(new Date).toISOString()};const s={...r,remainingPayments:e,remainingAmount:r.remainingAmount-t.principal,schedule:n,status:0===e?"completed":"active"};this.playerDispatch({type:"UPDATE_LOAN",payload:{id:r.id,changes:s}}),0===e?a.push(r.id):i.push(r.id)}}return{success:!0,message:`Dokonano sp\u0142aty rat na \u0142\u0105czn\u0105 kwot\u0119 ${n.toLocaleString()} PLN`,updatedLoans:i,completedLoans:a}}makeLoanPrepayment(e,t){const{loans:n,cash:i}=this.playerState,a=n.find((t=>t.id===e));if(!a)return{success:!1,message:"Nie znaleziono kredytu"};if("active"!==a.status)return{success:!1,message:`Kredyt ma status ${a.status} i nie mo\u017ce by\u0107 sp\u0142acony`};if(i<t)return{success:!1,message:`Niewystarczaj\u0105ce \u015brodki (${t.toLocaleString()} PLN)`};t>a.remainingAmount&&(t=a.remainingAmount),this.playerDispatch({type:"UPDATE_CASH",payload:-t});const r=a.remainingAmount-t;if(r<=0)return this.playerDispatch({type:"UPDATE_LOAN",payload:{id:e,changes:{remainingAmount:0,remainingPayments:0,status:"completed"}}}),{success:!0,message:"Kredyt zosta\u0142 ca\u0142kowicie sp\u0142acony",fullyPaid:!0};{const n=this.recalculateLoanSchedule(r,a.interestRate,a.remainingPayments),i=n.length>0?n[0].payment:0;return this.playerDispatch({type:"UPDATE_LOAN",payload:{id:e,changes:{remainingAmount:r,monthlyPayment:i,schedule:this.mergeSchedule(a.schedule,n,a.durationMonths-a.remainingPayments)}}}),{success:!0,message:`Dokonano przedp\u0142aty w kwocie ${t.toLocaleString()} PLN`,newRemainingAmount:r,newMonthlyPayment:i}}}recalculateLoanSchedule(e,t,n){const i=t/100/12,a=this.calculateMonthlyPayment(e,t,n);let r=e;const s=[];for(let o=1;o<=n;o++){const e=r*i,t=a-e;r-=t,s.push({paymentNumber:o,date:this.addMonths(new Date,o),payment:a,principal:t,interest:e,remainingPrincipal:Math.max(0,r),paid:!1})}return s}mergeSchedule(e,t,n){const i=[...e];for(let a=0;a<n;a++)i[a]&&(i[a].paid=!0);for(let a=0;a<t.length;a++){const e=a+n;e<i.length&&(i[e]={...i[e],payment:t[a].payment,principal:t[a].principal,interest:t[a].interest,remainingPrincipal:t[a].remainingPrincipal})}return i}getLoanOffers(){const e=this.calculateMaxCreditLimit(),{reputation:t}=this.playerState,n=[{name:"Kredyt kr\xf3tkoterminowy",description:"Kredyt na pokrycie bie\u017c\u0105cych potrzeb firmy",durationMonths:12,maxAmount:Math.min(e,1e7),interestRate:this.calculateInterestRate(5e6,12),type:"standard"},{name:"Kredyt \u015brednioterminowy",description:"Kredyt na rozw\xf3j i inwestycje \u015bredniej wielko\u015bci",durationMonths:24,maxAmount:Math.min(e,2e7),interestRate:this.calculateInterestRate(1e7,24),type:"standard"},{name:"Kredyt d\u0142ugoterminowy",description:"Kredyt na du\u017ce projekty inwestycyjne",durationMonths:36,maxAmount:Math.min(e,5e7),interestRate:this.calculateInterestRate(25e6,36),type:"standard"}];let i=[];t>=120&&i.push({name:"Kredyt preferencyjny",description:"Specjalna oferta dla firm o wyj\u0105tkowej reputacji",durationMonths:60,maxAmount:Math.min(e,1e8),interestRate:.9*this.calculateInterestRate(5e7,60),type:"special"}),t>=150&&i.push({name:"Finansowanie strategiczne",description:"Ekskluzywna oferta dla lider\xf3w rynku",durationMonths:120,maxAmount:Math.min(e,2e8),interestRate:.85*this.calculateInterestRate(1e8,120),type:"premium"});let a=[];return this.playerState.reputationFactors.environmentalImpact>=1.3&&a.push({name:"Zielone finansowanie",description:"Preferencyjny kredyt na projekty z pozytywnym wp\u0142ywem \u015brodowiskowym",durationMonths:48,maxAmount:Math.min(e,8e7),interestRate:.8*this.calculateInterestRate(4e7,48),type:"green",requirements:"Tylko na projekty ekologiczne z certyfikatem"}),[...n,...i,...a]}addMonths(e,t){const n=new Date(e);return n.setMonth(n.getMonth()+t),n.toISOString()}}const oy=()=>{const{state:e,dispatch:t}=d(),{state:n}=mf(),a=(0,i.useMemo)((()=>new ay(e,t,n)),[e,t,n]),r=(0,i.useMemo)((()=>new ry(e,t,n)),[e,t,n]),s=(0,i.useMemo)((()=>new sy(e,t,n,a)),[e,t,n,a]);return{reputationManager:a,grayAreaManager:r,bankingSystem:s}},ly=Lf("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]),cy=Lf("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),dy=Lf("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),uy=Lf("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),hy=Lf("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),py=Lf("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),my=e=>{let{children:t,variant:n="primary",size:i="medium",onClick:a,className:s="",disabled:o=!1,...l}=e;return(0,r.jsx)("button",{className:`${{primary:"bg-blue-700 hover:bg-blue-800 text-white",success:"bg-green-500 hover:bg-green-600 text-white",danger:"bg-red-500 hover:bg-red-600 text-white",warning:"bg-yellow-500 hover:bg-yellow-600 text-black",info:"bg-blue-500 hover:bg-blue-600 text-white",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-800"}[n]} ${{small:"px-2 py-1 text-xs",medium:"px-3 py-1",large:"px-4 py-2 text-lg"}[i]} rounded font-medium transition-colors ${o?"opacity-50 cursor-not-allowed":""} ${s}`,onClick:a,disabled:o,...l,children:t})},fy=e=>{let{onClose:t}=e;const{state:n}=d(),{state:a}=mf(),{reputationManager:s}=oy(),[o,l]=(0,i.useState)(null),[c,u]=(0,i.useState)("overview");(0,i.useEffect)((()=>{s&&l(s.generateReputationReport())}),[n.reputation,n.reputationFactors,s]);const h=e=>"rising"===e?(0,r.jsx)(ny,{className:"w-5 h-5 text-green-500"}):"falling"===e?(0,r.jsx)(iy,{className:"w-5 h-5 text-red-500"}):(0,r.jsx)(ty,{className:"w-5 h-5 text-gray-500"}),p=e=>({legalCompliance:(0,r.jsx)(ey,{className:"w-5 h-5 text-blue-500"}),environmentalImpact:(0,r.jsx)(ly,{className:"w-5 h-5 text-green-500"}),communityRelations:(0,r.jsx)(Gf,{className:"w-5 h-5 text-purple-500"}),projectQuality:(0,r.jsx)(cy,{className:"w-5 h-5 text-yellow-500"}),transparency:(0,r.jsx)(dy,{className:"w-5 h-5 text-cyan-500"}),grayAreaActivity:(0,r.jsx)(uy,{className:"w-5 h-5 text-gray-500"})}[e]||(0,r.jsx)(Hf,{className:"w-5 h-5 text-gray-500"})),m=e=>({legalCompliance:"Zgodno\u015b\u0107 z prawem",environmentalImpact:"Wp\u0142yw na \u015brodowisko",communityRelations:"Relacje ze spo\u0142eczno\u015bci\u0105",projectQuality:"Jako\u015b\u0107 projekt\xf3w",transparency:"Przejrzysto\u015b\u0107",grayAreaActivity:"Aktywno\u015b\u0107 w szarej strefie"}[e]||e),f=(e,t)=>"grayAreaActivity"===e?t<=.7?"text-green-600 font-medium":t<=1?"text-blue-600":t<=1.3?"text-yellow-600":"text-red-600":t>=1.5?"text-green-600 font-medium":t>=1?"text-blue-600":t>=.7?"text-yellow-600":"text-red-600",y=(e,t)=>"grayAreaActivity"===e?t<=.7?"bg-green-500":t<=1?"bg-blue-500":t<=1.3?"bg-yellow-500":"bg-red-500":t>=1.5?"bg-green-500":t>=1?"bg-blue-500":t>=.7?"bg-yellow-500":"bg-red-500",g=e=>({projectCost:"Koszt projekt\xf3w",constructionSpeed:"Szybko\u015b\u0107 budowy",projectQuality:"Jako\u015b\u0107 projekt\xf3w",staffRecruitmentCost:"Koszt rekrutacji",loanInterestRate:"Oprocentowanie kredyt\xf3w",projectSalePrice:"Cena sprzeda\u017cy projekt\xf3w",auditFrequency:"Cz\u0119stotliwo\u015b\u0107 audyt\xf3w",stakeholderTrust:"Zaufanie interesariuszy"}[e]||e),v=(e,t)=>{const n=["projectCost","loanInterestRate","staffRecruitmentCost","auditFrequency"].includes(e),i=t-1,a=Math.abs(100*i).toFixed(0);return 0===i?(0,r.jsx)("span",{className:"text-gray-600",children:"Neutralny"}):n?i<0?(0,r.jsxs)("span",{className:"text-green-600",children:["-",a,"%"]}):(0,r.jsxs)("span",{className:"text-red-600",children:["+",a,"%"]}):i>0?(0,r.jsxs)("span",{className:"text-green-600",children:["+",a,"%"]}):(0,r.jsxs)("span",{className:"text-red-600",children:["-",a,"%"]})};return(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold",children:"Reputacja Firmy"}),(0,r.jsx)(my,{onClick:t,variant:"secondary",size:"sm",children:"Zamknij"})]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsxs)("div",{className:"flex border-b",children:[(0,r.jsx)("button",{className:"px-4 py-2 font-medium "+("overview"===c?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),onClick:()=>u("overview"),children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(Kf,{className:"w-4 h-4 mr-1"}),(0,r.jsx)("span",{children:"Przegl\u0105d"})]})}),(0,r.jsx)("button",{className:"px-4 py-2 font-medium "+("modifiers"===c?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),onClick:()=>u("modifiers"),children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(hy,{className:"w-4 h-4 mr-1"}),(0,r.jsx)("span",{children:"Modyfikatory"})]})}),(0,r.jsx)("button",{className:"px-4 py-2 font-medium "+("history"===c?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),onClick:()=>u("history"),children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(py,{className:"w-4 h-4 mr-1"}),(0,r.jsx)("span",{children:"Historia"})]})})]})}),(0,r.jsxs)("div",{children:["overview"===c&&(()=>{if(!o)return(0,r.jsx)("div",{children:"\u0141adowanie danych..."});const{currentReputation:e,category:t,trend:n,factors:i}=o,a=(s=e)>=150?{label:"Doskona\u0142a",color:"text-green-600"}:s>=100?{label:"Dobra",color:"text-blue-600"}:s>=50?{label:"Przeci\u0119tna",color:"text-yellow-600"}:s>=25?{label:"S\u0142aba",color:"text-orange-600"}:{label:"Bardzo s\u0142aba",color:"text-red-600"};var s;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:[(0,r.jsx)("h3",{className:"font-medium mb-2 text-blue-700",children:"Reputacja Firmy"}),(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[(0,r.jsx)("div",{className:"w-full h-4 bg-gray-200 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"h-full "+(e>=150?"bg-green-500":e>=100?"bg-blue-500":e>=50?"bg-yellow-500":e>=25?"bg-orange-500":"bg-red-500"),style:{width:`${Math.min(100,e/2)}%`}})}),(0,r.jsx)("span",{className:"ml-3 font-medium",children:e})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:`${a.color} font-medium`,children:a.label}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"text-sm mr-1",children:"Trend:"}),h(n)]})]})]}),(0,r.jsx)("h3",{className:"font-medium mb-2",children:"Czynniki Reputacji"}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:Object.entries(i).map((e=>{let[t,n]=e;return(0,r.jsxs)("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:[(0,r.jsxs)("div",{className:"flex items-center mb-1",children:[p(t),(0,r.jsx)("span",{className:"ml-2 font-medium",children:m(t)})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Warto\u015b\u0107:"}),(0,r.jsxs)("span",{className:f(t,n),children:[(100*n).toFixed(0),"%"]})]}),(0,r.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:y(t,n),style:{width:`${Math.min(100,50*n)}%`}})})]},t)}))}),(0,r.jsx)("h3",{className:"font-medium mb-2",children:"Rekomendacje"}),(0,r.jsx)("div",{className:"space-y-2 mb-6",children:o.recommendations.length>0?o.recommendations.map(((e,t)=>{return(0,r.jsx)("div",{className:"bg-white p-3 rounded-lg shadow-sm border-l-4 border-yellow-500",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(n=e.priority,"critical"===n?(0,r.jsx)(Hf,{className:"w-5 h-5 text-red-500"}):"high"===n?(0,r.jsx)(Hf,{className:"w-5 h-5 text-orange-500"}):"medium"===n?(0,r.jsx)(Hf,{className:"w-5 h-5 text-yellow-500"}):(0,r.jsx)(Hf,{className:"w-5 h-5 text-blue-500"})),(0,r.jsxs)("div",{className:"ml-2",children:[(0,r.jsx)("p",{className:"text-sm",children:e.text}),e.factor&&(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Dotyczy: ",m(e.factor)]})]})]})},t);var n})):(0,r.jsxs)("div",{className:"text-center py-4 text-gray-500",children:[(0,r.jsx)(hy,{className:"h-12 w-12 mx-auto mb-2 text-green-300"}),(0,r.jsx)("p",{children:"Brak rekomendacji - Twoja reputacja jest w doskona\u0142ym stanie!"})]})})]})})(),"modifiers"===c&&(()=>{if(!o)return(0,r.jsx)("div",{children:"\u0141adowanie danych..."});const{modifiers:e}=o;return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:(0,r.jsx)("p",{className:"text-sm text-blue-800",children:"Modyfikatory pokazuj\u0105, jak Twoja reputacja wp\u0142ywa na r\xf3\u017cne aspekty gry. Warto\u015b\u0107 100% oznacza brak wp\u0142ywu, warto\u015bci ni\u017csze lub wy\u017csze oznaczaj\u0105 odpowiednio negatywny lub pozytywny wp\u0142yw."})}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(e).map((e=>{let[t,n]=e;return(0,r.jsxs)("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("span",{className:"font-medium",children:g(t)}),v(t,n)]}),(0,r.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:n<1?"bg-green-500":n>1?"bg-red-500":"bg-blue-500",style:{width:`${Math.min(100,50*n)}%`}})}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:n<1?`${Math.abs(100*(n-1)).toFixed(0)}% ni\u017csze koszty/czasy`:n>1?`${(100*(n-1)).toFixed(0)}% wy\u017csze koszty/czasy`:"Neutralny wp\u0142yw"})]},t)}))})]})})(),"history"===c&&(()=>{if(!n.reputationHistory||0===n.reputationHistory.length)return(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)(py,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),(0,r.jsx)("p",{className:"text-gray-500",children:"Brak historii zmian reputacji"})]});const e=[...n.reputationHistory].reverse().slice(0,20);return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:(0,r.jsx)("p",{className:"text-sm text-blue-800",children:"Historia ostatnich 20 zmian reputacji Twojej firmy."})}),(0,r.jsx)("div",{className:"space-y-2",children:e.map(((e,t)=>(0,r.jsxs)("div",{className:"bg-white p-3 rounded-lg shadow-sm border-l-4 border-blue-500",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,r.jsx)("span",{className:"font-medium",children:"factor_change"===e.type?`Zmiana czynnika: ${m(e.factor)}`:"Zmiana reputacji"}),(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:["Tura ",e.turn]})]}),(0,r.jsx)("p",{className:"text-sm",children:e.reason}),(0,r.jsxs)("div",{className:"flex items-center mt-1",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600 mr-2",children:"Zmiana:"}),(0,r.jsxs)("span",{className:e.change>0?"text-green-600":e.change<0?"text-red-600":"text-gray-600",children:[e.change>0?"+":"","factor_change"===e.type?`${(100*e.change).toFixed(0)}%`:e.change]})]})]},t)))})]})})()]})]})},yy=Lf("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),gy=Lf("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),vy=Lf("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),wy=Lf("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),xy=Lf("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),by=Lf("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),jy={INDUSTRY_CONFERENCE:{type:"conference",name:"Udzia\u0142 w konferencji bran\u017cowej",description:"Aktywny udzia\u0142 w konferencji bran\u017cowej buduje wizerunek eksperta i lidera sektora OZE.",cost:5e4,duration:30,intensity:1,icon:(0,r.jsx)(hy,{className:"w-5 h-5 text-blue-500"}),immediateEffects:[{reputationChange:2,factor:"transparency"}],continuousEffects:[{reputationPerDay:.05,factor:"transparency"}],finalEffects:[{factorChange:"transparency",factorAmount:.05}]},SPEAKING_ENGAGEMENT:{type:"conference",name:"Wyst\u0105pienie na konferencji jako ekspert",description:"Prezentacja Twojej ekspertyzy na presti\u017cowej konferencji znacz\u0105co podnosi reputacj\u0119 firmy.",cost:1e5,duration:60,intensity:2,icon:(0,r.jsx)(yy,{className:"w-5 h-5 text-indigo-500"}),immediateEffects:[{reputationChange:5,factor:"transparency"}],continuousEffects:[{reputationPerDay:.1,factor:"transparency"}],finalEffects:[{factorChange:"transparency",factorAmount:.1}]},ENVIRONMENTAL_NGO_PARTNERSHIP:{type:"ngo_partnership",name:"Partnerstwo z organizacj\u0105 ekologiczn\u0105",description:"D\u0142ugoterminowe partnerstwo z uznan\u0105 organizacj\u0105 ekologiczn\u0105 uwiarygadnia Twoje zaanga\u017cowanie w ochron\u0119 \u015brodowiska.",cost:2e5,duration:365,intensity:2,icon:(0,r.jsx)(ly,{className:"w-5 h-5 text-green-500"}),immediateEffects:[{reputationChange:3,factor:"environmentalImpact"}],continuousEffects:[{reputationPerDay:.03,factor:"environmentalImpact"},{factorChange:"environmentalImpact",factorPerDay:2e-4}],finalEffects:[{reputationChange:5,factor:"environmentalImpact"}]},COMMUNITY_FUND:{type:"ngo_partnership",name:"Fundusz wspierania spo\u0142eczno\u015bci lokalnych",description:"Utworzenie funduszu wspieraj\u0105cego inicjatywy spo\u0142eczno\u015bci lokalnych w regionach Twoich inwestycji OZE.",cost:5e5,duration:365,intensity:3,icon:(0,r.jsx)(Gf,{className:"w-5 h-5 text-purple-500"}),immediateEffects:[{reputationChange:7,factor:"communityRelations"}],continuousEffects:[{reputationPerDay:.04,factor:"communityRelations"},{factorChange:"communityRelations",factorPerDay:3e-4}],finalEffects:[{factorChange:"communityRelations",factorAmount:.15}]},PR_CAMPAIGN:{type:"media_campaign",name:"Kampania PR",description:"Profesjonalna kampania PR buduj\u0105ca pozytywny wizerunek Twojej firmy w mediach i opinii publicznej.",cost:3e5,duration:90,intensity:2,icon:(0,r.jsx)(gy,{className:"w-5 h-5 text-cyan-500"}),immediateEffects:[{reputationChange:4}],continuousEffects:[{reputationPerDay:.07}],finalEffects:[]},TRANSPARENCY_REPORT:{type:"media_campaign",name:"Raport transparentno\u015bci",description:"Publikacja szczeg\xf3\u0142owego raportu o dzia\u0142alno\u015bci Twojej firmy, wp\u0142ywie na \u015brodowisko i spo\u0142ecze\u0144stwo.",cost:15e4,duration:120,intensity:1,icon:(0,r.jsx)(dy,{className:"w-5 h-5 text-sky-500"}),immediateEffects:[{reputationChange:3,factor:"transparency"},{factorChange:"transparency",factorAmount:.1}],continuousEffects:[{reputationPerDay:.02,factor:"transparency"}],finalEffects:[{reputationChange:2,factor:"transparency"}]},LEGAL_COMPLIANCE_PROGRAM:{type:"legal_repair",name:"Program zgodno\u015bci prawnej",description:"Kompleksowy program naprawczy zapewniaj\u0105cy pe\u0142n\u0105 zgodno\u015b\u0107 z przepisami i najlepszymi praktykami bran\u017cowymi.",cost:4e5,duration:270,intensity:3,icon:(0,r.jsx)(ey,{className:"w-5 h-5 text-red-500"}),immediateEffects:[{factorChange:"grayAreaActivity",factorAmount:-.2}],continuousEffects:[{factorChange:"grayAreaActivity",factorPerDay:-.001},{factorChange:"legalCompliance",factorPerDay:5e-4}],finalEffects:[{reputationChange:8,factor:"legalCompliance"},{factorChange:"legalCompliance",factorAmount:.2}]},WHISTLEBLOWER_PROTECTION:{type:"legal_repair",name:"Program ochrony sygnalist\xf3w",description:"Wdro\u017cenie mechanizm\xf3w zg\u0142aszania nieprawid\u0142owo\u015bci i ochrony sygnalist\xf3w w Twojej firmie.",cost:15e4,duration:120,intensity:2,icon:(0,r.jsx)(uy,{className:"w-5 h-5 text-amber-500"}),immediateEffects:[{reputationChange:2,factor:"transparency"}],continuousEffects:[{factorChange:"grayAreaActivity",factorPerDay:-8e-4}],finalEffects:[{reputationChange:5,factor:"transparency"},{factorChange:"transparency",factorAmount:.1}]}},ky=e=>{var t;let{onClose:n}=e;const{state:a,dispatch:s}=d(),{state:o,showNotification:l}=mf(),[c,u]=(0,i.useState)(null),h=(0,i.useRef)(null),p=e=>{h.current&&!h.current.contains(e.target)&&n()};(0,i.useEffect)((()=>(document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p)})),[]);const m=Object.values(jy).reduce(((e,t)=>(e[t.type]||(e[t.type]=[]),e[t.type].push(t),e)),{}),f=e=>{const t=[];return e.immediateEffects&&e.immediateEffects.forEach((e=>{t.push({...e,type:"immediate"})})),e.continuousEffects&&e.continuousEffects.forEach((e=>{t.push({...e,type:"continuous"})})),e.finalEffects&&e.finalEffects.forEach((e=>{t.push({...e,type:"final"})})),(0,r.jsx)("div",{className:"grid gap-2",children:t.map(((e,t)=>(0,r.jsxs)("div",{className:"flex items-center border-b pb-2",children:[x(e),(0,r.jsxs)("div",{className:"ml-2",children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:v(e)}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:w(e.type)})]})]},t)))})},y=e=>({conference:"Konferencje i wydarzenia",ngo_partnership:"Wsp\xf3\u0142praca z NGO",media_campaign:"Kampanie medialne",certification:"Certyfikacje i standardy",legal_repair:"Naprawy wizerunkowe"}[e]||e),g=e=>{switch(e){case 1:return"Niska";case 2:return"\u015arednia";case 3:return"Wysoka";default:return"Nieznana"}},v=e=>{if(e.reputationChange){return`Zmiana reputacji: ${e.reputationChange>0?"+":""}${e.reputationChange}`}if(e.reputationPerDay){return`Reputacja dziennie: ${e.reputationPerDay>0?"+":""}${e.reputationPerDay}`}if(e.factorChange){const t={legalCompliance:"Zgodno\u015b\u0107 z prawem",environmentalImpact:"Wp\u0142yw na \u015brodowisko",communityRelations:"Relacje ze spo\u0142eczno\u015bci\u0105",projectQuality:"Jako\u015b\u0107 projekt\xf3w",transparency:"Przejrzysto\u015b\u0107",grayAreaActivity:"Aktywno\u015b\u0107 w szarej strefie"}[e.factorChange]||e.factorChange;let n="";if(e.factorAmount){n=`${e.factorAmount>0?"+":""}${(100*e.factorAmount).toFixed(0)}%`}else if(e.factorPerDay){n=`${e.factorPerDay>0?"+":""}${(100*e.factorPerDay).toFixed(2)}% dziennie`}return`${t}: ${n}`}return"Nieznany efekt"},w=e=>{switch(e){case"immediate":return"Efekt natychmiastowy";case"continuous":return"Efekt ci\u0105g\u0142y";case"final":return"Efekt ko\u0144cowy";default:return""}},x=e=>{if(e.reputationChange||e.reputationPerDay){return e.reputationChange&&e.reputationChange>0||e.reputationPerDay&&e.reputationPerDay>0?(0,r.jsx)(wy,{className:"w-4 h-4 text-green-500"}):(0,r.jsx)(xy,{className:"w-4 h-4 text-red-500"})}if(e.factorChange){return{legalCompliance:(0,r.jsx)(ey,{className:"w-4 h-4 text-blue-500"}),environmentalImpact:(0,r.jsx)(ly,{className:"w-4 h-4 text-green-500"}),communityRelations:(0,r.jsx)(Gf,{className:"w-4 h-4 text-purple-500"}),projectQuality:(0,r.jsx)(cy,{className:"w-4 h-4 text-yellow-500"}),transparency:(0,r.jsx)(dy,{className:"w-4 h-4 text-cyan-500"}),grayAreaActivity:(0,r.jsx)(uy,{className:"w-4 h-4 text-gray-500"})}[e.factorChange]||(0,r.jsx)(by,{className:"w-4 h-4 text-gray-500"})}return(0,r.jsx)(by,{className:"w-4 h-4 text-gray-500"})},b=e=>({legalCompliance:"Zgodno\u015b\u0107 z prawem",environmentalImpact:"Wp\u0142yw na \u015brodowisko",communityRelations:"Relacje ze spo\u0142eczno\u015bci\u0105",projectQuality:"Jako\u015b\u0107 projekt\xf3w",transparency:"Przejrzysto\u015b\u0107",grayAreaActivity:"Aktywno\u015b\u0107 w szarej strefie"}[e]||e),j=e=>e>=1.5?"text-green-600 font-medium":e>=1?"text-blue-600":e>=.7?"text-yellow-600":"text-red-600",k=(e,t)=>"grayAreaActivity"===e?t<=.7?"bg-green-500":t<=1?"bg-blue-500":t<=1.3?"bg-yellow-500":"bg-red-500":t>=1.5?"bg-green-500":t>=1?"bg-blue-500":t>=.7?"bg-yellow-500":"bg-red-500",N=e=>{const t=Object.values(jy).find((t=>t.type===e.type&&t.name===e.name));return(null===t||void 0===t?void 0:t.icon)||(0,r.jsx)(by,{className:"w-5 h-5 text-gray-500"})};return(0,r.jsxs)("div",{ref:h,className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold",children:"Inicjatywy Reputacyjne"}),(0,r.jsx)("button",{onClick:n,className:"p-2 rounded-full hover:bg-gray-100",children:(0,r.jsx)(vy,{className:"w-5 h-5"})})]}),(0,r.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:[(0,r.jsx)("h3",{className:"font-medium mb-2 text-blue-700",children:"Reputacja Firmy"}),(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[(0,r.jsx)("div",{className:"w-full h-4 bg-gray-200 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"h-full "+(z=a.reputation,z>=150?"bg-green-500":z>=100?"bg-blue-500":z>=50?"bg-yellow-500":"bg-red-500"),style:{width:`${Math.min(100,a.reputation/2)}%`}})}),(0,r.jsx)("span",{className:"ml-3 font-medium",children:a.reputation})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:(e=>e>=150?"Doskona\u0142a reputacja - jeste\u015b liderem etycznym w bran\u017cy":e>=100?"Dobra reputacja - jeste\u015b szanowanym graczem na rynku":e>=50?"Przeci\u0119tna reputacja - masz neutralny wizerunek":e>=25?"S\u0142aba reputacja - budzisz pewne kontrowersje":"Bardzo s\u0142aba reputacja - jeste\u015b powszechnie krytykowany")(a.reputation)})]}),(0,r.jsx)("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(a.reputationFactors||{}).map((e=>{let[t,n]=e;return(0,r.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:b(t)}),(0,r.jsxs)("span",{className:j(n),children:[(100*n).toFixed(0),"%"]})]}),(0,r.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:k(t,n),style:{width:`${Math.min(100,50*n)}%`}})})]},t)}))}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h3",{className:"font-medium mb-2",children:"Aktywne Inicjatywy"}),(null===(t=a.activeReputationInitiatives)||void 0===t?void 0:t.length)>0?(0,r.jsx)("div",{className:"grid gap-3",children:a.activeReputationInitiatives.map(((e,t)=>(0,r.jsx)("div",{className:"border rounded-lg p-3",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center overflow-hidden",children:[N(e),(0,r.jsxs)("div",{className:"ml-2 overflow-hidden",children:[(0,r.jsx)("div",{className:"font-medium text-ellipsis overflow-hidden",children:e.name}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 whitespace-nowrap",children:["Pozosta\u0142o: ",e.remainingDuration," dni"]})]})]}),(0,r.jsx)("div",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full whitespace-nowrap",children:g(e.intensity)})]})},t)))}):(0,r.jsxs)("div",{className:"text-center py-4 text-gray-500",children:[(0,r.jsx)(by,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),(0,r.jsx)("p",{children:"Brak aktywnych inicjatyw"})]})]}),(0,r.jsx)("h3",{className:"font-medium mb-3",children:"Dost\u0119pne Inicjatywy"}),Object.entries(m).map((e=>{let[t,n]=e;return((e,t)=>(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:y(e)}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((e=>(0,r.jsx)("div",{className:"border rounded-lg p-4 hover:border-blue-300 cursor-pointer",onClick:()=>u(e),children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"mr-3",children:e.icon}),(0,r.jsxs)("div",{className:"flex-grow overflow-hidden",children:[(0,r.jsx)("h4",{className:"font-medium text-ellipsis overflow-hidden",children:e.name}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 break-words",children:[e.description.substring(0,80),"..."]}),(0,r.jsxs)("div",{className:"mt-2 text-sm text-blue-600 whitespace-nowrap",children:["Koszt: ",e.cost.toLocaleString()," z\u0142"]})]})]})},e.name)))})]}))(t,n)})),c&&(c?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[c.icon,(0,r.jsx)("h2",{className:"text-xl font-semibold ml-3 break-words",children:c.name})]}),(0,r.jsx)("button",{className:"text-gray-400 hover:text-gray-600",onClick:()=>u(null),children:(0,r.jsx)(vy,{className:"w-6 h-6"})})]}),(0,r.jsx)("p",{className:"text-gray-700 mb-4 break-words",children:c.description}),(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:[(0,r.jsx)("h3",{className:"font-medium mb-2",children:"Szczeg\xf3\u0142y:"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center overflow-hidden",children:[(0,r.jsx)("span",{className:"text-gray-600 mr-2 whitespace-nowrap",children:"Koszt:"}),(0,r.jsxs)("span",{className:"font-medium whitespace-nowrap",children:[c.cost.toLocaleString()," z\u0142"]})]}),(0,r.jsxs)("div",{className:"flex items-center overflow-hidden",children:[(0,r.jsx)("span",{className:"text-gray-600 mr-2 whitespace-nowrap",children:"Czas trwania:"}),(0,r.jsxs)("span",{className:"font-medium whitespace-nowrap",children:[c.duration," dni"]})]}),(0,r.jsxs)("div",{className:"flex items-center overflow-hidden",children:[(0,r.jsx)("span",{className:"text-gray-600 mr-2 whitespace-nowrap",children:"Intensywno\u015b\u0107:"}),(0,r.jsx)("span",{className:"font-medium whitespace-nowrap",children:g(c.intensity)})]})]})]}),(0,r.jsx)("h3",{className:"font-medium mb-2",children:"Efekty:"}),(0,r.jsx)("div",{className:"mb-4",children:f(c)}),(0,r.jsxs)("div",{className:"flex justify-end mt-6",children:[(0,r.jsx)("button",{className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md mr-3",onClick:()=>u(null),children:"Anuluj"}),(0,r.jsxs)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md "+(a.cash<c.cost?"opacity-50 cursor-not-allowed":""),onClick:()=>(e=>{if(a.cash<e.cost)l(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w (potrzeba ${e.cost.toLocaleString()} PLN)`,"error");else{if(s({type:"START_REPUTATION_INITIATIVE",payload:{initiative:e}}),e.immediateEffects)for(const t of e.immediateEffects)t.reputationChange&&s({type:"UPDATE_REPUTATION",payload:{change:t.reputationChange,reason:`Inicjatywa: ${e.name} (natychmiastowy efekt)`,turn:o.turn}}),t.factorChange&&t.factorAmount&&s({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:t.factorChange,change:t.factorAmount,reason:`Inicjatywa: ${e.name} (natychmiastowy efekt)`,turn:o.turn}});l(`Rozpocz\u0119to inicjatyw\u0119: ${e.name}`,"success"),u(null)}})(c),disabled:a.cash<c.cost,children:["Rozpocznij (",c.cost.toLocaleString()," z\u0142)"]})]})]})}):null)]});var z},Ny=()=>{const{state:e}=d(),[t,n]=(0,i.useState)(!1),[a,s]=(0,i.useState)(!1),o=e.activeReputationInitiatives&&e.activeReputationInitiatives.length>0,l=e.reputation<50||e.reputationFactors&&Object.values(e.reputationFactors).some((e=>e<.7));return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center px-3 py-1.5 rounded-md cursor-pointer "+(c=e.reputation,c>=150?"bg-green-100":c>=100?"bg-blue-100":c>=50?"bg-yellow-100":c>=25?"bg-orange-100":"bg-red-100"),onClick:()=>n(!0),children:[(0,r.jsx)("div",{className:"mr-2",children:(e=>e>=100?(0,r.jsx)(ey,{className:"w-4 h-4"}):e>=50?(0,r.jsx)(ty,{className:"w-4 h-4"}):(0,r.jsx)(Hf,{className:"w-4 h-4"}))(e.reputation)}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:`font-medium ${(e=>e>=150?"text-green-600":e>=100?"text-blue-600":e>=50?"text-yellow-600":e>=25?"text-orange-600":"text-red-600")(e.reputation)}`,children:e.reputation}),(()=>{if(!e.reputationHistory||e.reputationHistory.length<5)return null;const t=e.reputationHistory.filter((e=>void 0!==e.change)).slice(-5).map((e=>e.change));if(0===t.length)return null;const n=t.reduce(((e,t)=>e+t),0);return n>5?(0,r.jsx)(ny,{className:"w-4 h-4 text-green-500"}):n<-5?(0,r.jsx)(iy,{className:"w-4 h-4 text-red-500"}):null})()]}),(0,r.jsx)("div",{className:"text-xs text-gray-600",children:(e=>e>=150?"Doskona\u0142a":e>=100?"Dobra":e>=50?"Przeci\u0119tna":e>=25?"S\u0142aba":"Bardzo s\u0142aba")(e.reputation)})]}),o&&(0,r.jsx)("div",{className:"ml-2 bg-blue-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center cursor-pointer",onClick:e=>{e.stopPropagation(),s(!0)},title:"Aktywne inicjatywy reputacyjne",children:e.activeReputationInitiatives.length}),l&&(0,r.jsx)("div",{className:"ml-2 text-red-500",title:"Problemy z reputacj\u0105",children:(0,r.jsx)(Hf,{className:"w-4 h-4"})})]}),t&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsx)(fy,{onClose:()=>n(!1)})})}),a&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsx)(ky,{onClose:()=>s(!1)})})})]});var c},zy=(0,i.memo)((e=>{let{icon:t,screenName:n,label:i,currentScreen:a,onClick:s}=e;const o=a===n;return(0,r.jsxs)("button",{onClick:s,className:"nav-button flex items-center px-3 py-1 rounded text-white "+(o?"active":""),children:[(0,r.jsx)("span",{className:"mr-1",children:t})," ",i]})})),_y=(0,i.memo)((e=>{let{currentDay:t,gameSpeed:n}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center mr-4",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(Ff,{size:18,className:"mr-1"}),(0,r.jsxs)("span",{className:"font-medium",children:["Dzie\u0144 ",t]})]}),n>1&&(0,r.jsxs)("div",{className:"flex items-center text-sm",children:[(0,r.jsx)(Uf,{size:16,className:"mr-1"}),(0,r.jsxs)("span",{className:`\n            ${3===n?"text-yellow-300":""}\n            ${5===n?"text-orange-300":""}\n            ${10===n?"text-red-300":""}\n            font-semibold\n          `,children:["Pr\u0119dko\u015b\u0107 x",n]})]})]})})),Ey=(0,i.memo)((e=>{let{cash:t,installedCapacity:n,reputation:i}=e;return(0,r.jsxs)("div",{className:"stats-container flex space-x-6",children:[(0,r.jsxs)("div",{className:"stat flex items-center",children:[(0,r.jsx)(Vf,{size:18,className:"mr-1 text-green-400"}),(0,r.jsxs)("span",{children:[(s=t,void 0===s||null===s||isNaN(s)?"0.00":s>=1e9?`${(s/1e9).toFixed(2)} mld`:s>=1e6?`${(s/1e6).toFixed(2)} mln`:s>=1e3?`${(s/1e3).toFixed(2)} tys.`:`${s.toFixed(2)}`)," PLN"]})]}),(0,r.jsxs)("div",{className:"stat flex items-center",children:[(0,r.jsx)($f,{size:18,className:"mr-1 text-yellow-400"}),(0,r.jsxs)("span",{children:[(a=n,void 0===a||null===a||isNaN(a)?"0.00":(a/1e3).toFixed(2))," GW"]})]}),(0,r.jsx)("div",{className:"stat flex items-center",children:(0,r.jsx)(Ny,{value:i,showValue:!0})})]});var a,s})),Sy=e=>{let{children:t}=e;const{state:n,dispatch:a,nextDay:s}=mf(),{state:o,dispatch:l}=d(),{state:c}=q(),u=(0,i.useCallback)((e=>(e.preventDefault(),e.returnValue="Czy na pewno chcesz opu\u015bci\u0107 gr\u0119? Niezapisane zmiany mog\u0105 zosta\u0107 utracone.",e.returnValue)),[]),h=(0,i.useCallback)((e=>{e.preventDefault(),history.pushState(null,document.title,window.location.href),n.selectedProject?a({type:"SELECT_PROJECT",payload:null}):n.selectedRegion?a({type:"SELECT_REGION",payload:null}):n.selectedCounty&&a({type:"SELECT_COUNTY",payload:null})}),[n.selectedProject,n.selectedRegion,n.selectedCounty,a]);(0,i.useEffect)((()=>(window.addEventListener("popstate",h),window.addEventListener("beforeunload",u),history.pushState(null,document.title,window.location.href),()=>{window.removeEventListener("popstate",h),window.removeEventListener("beforeunload",u)})),[h,u]);const p=(0,i.useCallback)((()=>{var e;const t=null===c||void 0===c||null===(e=c.events)||void 0===e?void 0:e.filter((e=>e&&!0===e.requiresDecision&&!0!==e.decided));t&&t.length>0?a({type:"SET_NOTIFICATION",payload:{text:"Musisz rozwi\u0105za\u0107 wszystkie oczekuj\u0105ce decyzje przed przej\u015bciem do nast\u0119pnego dnia!",type:"warning"}}):(s(o,l),window.dispatchEvent(new CustomEvent("next-game-day")),n.selectedProject&&a({type:"SELECT_PROJECT",payload:null}),n.selectedRegion&&a({type:"SELECT_REGION",payload:null}),n.selectedCounty&&a({type:"SELECT_COUNTY",payload:null}))}),[n,a,s,o,l,c]),m=(0,i.useCallback)((e=>{a({type:"SET_GAME_SPEED",payload:e});a({type:"SET_NOTIFICATION",payload:{text:`Ustawiono ${{1:"normaln\u0105",3:"przyspieszon\u0105 (x3)",5:"szybk\u0105 (x5)",10:"bardzo szybk\u0105 (x10)"}[e]} pr\u0119dko\u015b\u0107 up\u0142ywu czasu.`,type:"info"}})}),[a]),f=(0,i.useCallback)((()=>{a({type:"SET_APP_VIEW",payload:"leaderboard"})}),[a]),y=(0,i.useCallback)((()=>{"function"===typeof window.saveGameFunction&&(window.saveGameFunction(),a({type:"SET_NOTIFICATION",payload:{text:"Gra zosta\u0142a zapisana!",type:"success"}}))}),[a]),g=(0,i.useCallback)((e=>{a({type:"SET_SCREEN",payload:e}),n.selectedProject&&a({type:"SELECT_PROJECT",payload:null}),n.selectedRegion&&a({type:"SELECT_REGION",payload:null}),n.selectedCounty&&a({type:"SELECT_COUNTY",payload:null})}),[a,n.selectedProject,n.selectedRegion,n.selectedCounty]),v=(0,i.useCallback)((()=>{"function"===typeof window.saveGameFunction&&window.saveGameFunction(),ef.signOut().then((()=>{console.log("U\u017cytkownik wylogowany")})).catch((e=>{console.error("B\u0142\u0105d wylogowania:",e)}))}),[]),w=(0,i.useCallback)((()=>{const e=[{screen:"home",icon:(0,r.jsx)(Bf,{size:18}),label:"G\u0142\xf3wna"},{screen:"regions",icon:(0,r.jsx)(Wf,{size:18}),label:"Mapa"},{screen:"company",icon:(0,r.jsx)(qf,{size:18}),label:"Firma"},{screen:"events",icon:(0,r.jsx)(Hf,{size:18}),label:"Wydarzenia"},{screen:"competitors",icon:(0,r.jsx)(Gf,{size:18}),label:"Konkurencja"},{screen:"market",icon:(0,r.jsx)(Kf,{size:18}),label:"Rynek"}];return(0,r.jsx)("div",{className:"flex space-x-2",children:e.map((e=>(0,r.jsx)(zy,{icon:e.icon,screenName:e.screen,label:e.label,currentScreen:n.currentScreen,onClick:()=>g(e.screen)},e.screen)))})}),[n.currentScreen,g]);return(0,r.jsxs)("div",{className:"game-container min-h-screen flex flex-col",children:[(0,r.jsxs)("div",{className:"top-bar bg-gray-800 text-white py-2 px-4 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"left-section flex items-center",children:[(0,r.jsx)(_y,{currentDay:n.day,gameSpeed:n.gameSpeed}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("button",{onClick:p,className:"next-day-btn flex items-center bg-blue-700 hover:bg-blue-800 px-3 py-1 rounded mr-2",children:[(0,r.jsx)(Qf,{size:18})," ",(0,r.jsx)("span",{className:"ml-1",children:"Nowy dzie\u0144"})]}),(0,r.jsxs)("div",{className:"game-speed-controls flex space-x-1",children:[(0,r.jsx)("button",{onClick:()=>m(1),className:"px-2 py-1 rounded text-xs font-bold "+(1===n.gameSpeed?"bg-green-600":"bg-gray-600 hover:bg-gray-500"),title:"Normalna pr\u0119dko\u015b\u0107",children:"x1"}),(0,r.jsx)("button",{onClick:()=>m(3),className:"px-2 py-1 rounded text-xs font-bold "+(3===n.gameSpeed?"bg-yellow-600":"bg-gray-600 hover:bg-gray-500"),title:"Przyspieszona pr\u0119dko\u015b\u0107",children:"x3"}),(0,r.jsx)("button",{onClick:()=>m(5),className:"px-2 py-1 rounded text-xs font-bold "+(5===n.gameSpeed?"bg-orange-600":"bg-gray-600 hover:bg-gray-500"),title:"Szybka pr\u0119dko\u015b\u0107",children:"x5"}),(0,r.jsx)("button",{onClick:()=>m(10),className:"px-2 py-1 rounded text-xs font-bold "+(10===n.gameSpeed?"bg-red-600":"bg-gray-600 hover:bg-gray-500"),title:"Bardzo szybka pr\u0119dko\u015b\u0107",children:"x10"})]})]})]}),(0,r.jsx)(Ey,{cash:o.cash,installedCapacity:o.installedCapacity,reputation:o.reputation}),(0,r.jsxs)("div",{className:"right-section flex items-center space-x-2",children:[(0,r.jsxs)("button",{onClick:y,className:"save-btn flex items-center bg-green-700 hover:bg-green-800 px-3 py-1 rounded",children:[(0,r.jsx)(Zf,{size:18})," ",(0,r.jsx)("span",{className:"ml-1",children:"Zapisz"})]}),(0,r.jsxs)("button",{onClick:f,className:"leaderboard-btn flex items-center bg-yellow-700 hover:bg-yellow-800 px-3 py-1 rounded",children:[(0,r.jsx)(Yf,{size:18})," ",(0,r.jsx)("span",{className:"ml-1",children:"Wyniki"})]}),(0,r.jsxs)("button",{onClick:v,className:"logout-btn flex items-center bg-red-700 hover:bg-red-800 px-3 py-1 rounded",children:[(0,r.jsx)(Jf,{size:18})," ",(0,r.jsx)("span",{className:"ml-1",children:"Wyloguj"})]})]})]}),(0,r.jsx)("div",{className:"nav-bar bg-gray-700 py-2 px-4",children:w()}),(0,r.jsx)("div",{className:"main-content flex-grow p-4 relative",children:t}),(0,r.jsx)(Xf,{})]})},Ty=Lf("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Cy=Lf("Wind",[["path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2",key:"1k4u03"}],["path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2",key:"b7d0fd"}],["path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2",key:"1p5cb3"}]]),Py=Lf("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Iy=e=>{var t,n;let{onSaveGame:i,onShowLeaderboard:a}=e;const{state:s,dispatch:o}=mf(),{state:l}=d(),{state:c}=wf(),u=e=>{o({type:"SET_SCREEN",payload:e})},h=(()=>{const e=[];return c.forEach((t=>{t.landAcquisitionProcesses&&t.landAcquisitionProcesses.length>0&&t.landAcquisitionProcesses.forEach((n=>{if("in_progress"===n.status){const i=l.staff.scouts.find((e=>e.id===n.scoutId))||{name:"Nieznany skaut"};e.push({...n,regionName:t.name,regionId:t.id,scout:i})}}))})),e})();return(0,r.jsxs)("div",{className:"home-view-container",children:[(0,r.jsxs)("div",{className:"welcome-banner",children:[(0,r.jsx)("h1",{children:"Symulator Rozwoju OZE"}),(0,r.jsxs)("div",{className:"game-date",children:[(0,r.jsxs)("div",{className:"date-item",children:[(0,r.jsx)(Ff,{className:"date-icon"}),(0,r.jsx)("span",{children:new Date(2023,0,s.day).toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"})})]}),(0,r.jsxs)("div",{className:"date-item",children:[(0,r.jsx)(Uf,{className:"date-icon"}),(0,r.jsxs)("span",{children:["Tura ",s.turn]})]})]})]}),(0,r.jsxs)("div",{className:"company-summary",children:[(0,r.jsxs)("h2",{children:["Twoja Firma: ",l.companyName||"OZE Developer"]}),(0,r.jsxs)("div",{className:"stats-grid",children:[(0,r.jsxs)("div",{className:"stat-card",children:[(0,r.jsx)("h3",{children:"Stan konta"}),(0,r.jsxs)("p",{className:"stat-value",children:[(null===(t=l.cash)||void 0===t?void 0:t.toLocaleString())||0," PLN"]})]}),(0,r.jsxs)("div",{className:"stat-card",children:[(0,r.jsx)("h3",{children:"Liczba projekt\xf3w"}),(0,r.jsx)("p",{className:"stat-value",children:(null===(n=l.projects)||void 0===n?void 0:n.length)||0})]}),(0,r.jsxs)("div",{className:"stat-card",children:[(0,r.jsx)("h3",{children:"Pracownicy"}),(0,r.jsx)("p",{className:"stat-value",children:l&&l.staff?Object.values(l.staff).filter(Boolean).flat().length:0})]}),(0,r.jsxs)("div",{className:"stat-card",children:[(0,r.jsx)("h3",{children:"Reputacja"}),(0,r.jsxs)("p",{className:"stat-value",children:[l.reputation||50,"/100"]})]})]})]}),(0,r.jsxs)("div",{className:"quick-actions-section",children:[(0,r.jsx)("h2",{children:"Szybkie Akcje"}),(0,r.jsxs)("div",{className:"quick-actions-grid",children:[(0,r.jsxs)("button",{className:"action-card",onClick:()=>u("company"),children:[(0,r.jsx)(qf,{className:"action-icon"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"Zarz\u0105dzanie Sp\xf3\u0142k\u0105"}),(0,r.jsx)("p",{children:"Przegl\u0105daj finanse, projekty i pracownik\xf3w"})]}),(0,r.jsx)(Ty,{className:"arrow-icon"})]}),(0,r.jsxs)("button",{className:"action-card",onClick:()=>u("company"),children:[(0,r.jsx)(Gf,{className:"action-icon"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"Zatrudnij pracownik\xf3w"}),(0,r.jsx)("p",{children:"Skauci, developerzy i inni specjali\u015bci"})]}),(0,r.jsx)(Ty,{className:"arrow-icon"})]}),(0,r.jsxs)("button",{className:"action-card",onClick:()=>u("regions"),children:[(0,r.jsx)(Wf,{className:"action-icon"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"Wyb\xf3r Region\xf3w"}),(0,r.jsx)("p",{children:"Wybierz wojew\xf3dztwo do dzia\u0142a\u0144"})]}),(0,r.jsx)(Ty,{className:"arrow-icon"})]}),(0,r.jsxs)("button",{className:"action-card",onClick:()=>u("market"),children:[(0,r.jsx)($f,{className:"action-icon"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"Gie\u0142da Projekt\xf3w"}),(0,r.jsx)("p",{children:"Kupuj i sprzedawaj projekty OZE"})]}),(0,r.jsx)(Ty,{className:"arrow-icon"})]})]})]}),(0,r.jsxs)("div",{className:"guides-section",children:[(0,r.jsx)("h2",{children:"Przewodnik"}),(0,r.jsxs)("div",{className:"guides-grid",children:[(0,r.jsxs)("div",{className:"guide-card",children:[(0,r.jsx)(by,{className:"guide-icon"}),(0,r.jsx)("h3",{children:"Jak zacz\u0105\u0107?"}),(0,r.jsx)("p",{children:"Aby rozpocz\u0105\u0107 rozw\xf3j projekt\xf3w OZE, najpierw zatrudnij skaut\xf3w, kt\xf3rzy b\u0119d\u0105 szuka\u0107 odpowiednich lokalizacji pod projekty."}),(0,r.jsx)("button",{className:"guide-action-btn",onClick:()=>u("company"),children:"Zatrudnij skauta"})]}),(0,r.jsxs)("div",{className:"guide-card",children:[(0,r.jsx)(Cy,{className:"guide-icon"}),(0,r.jsx)("h3",{children:"Rozw\xf3j Projektu"}),(0,r.jsx)("p",{children:"Projekty OZE przechodz\u0105 przez kilka etap\xf3w rozwoju, od pozyskania dzia\u0142ki do gotowej inwestycji. Ka\u017cdy etap wymaga odpowiednich specjalist\xf3w."}),(0,r.jsx)("button",{className:"guide-action-btn",onClick:()=>u("regions"),children:"Wybierz region"})]})]})]}),(0,r.jsx)("div",{className:"next-turn-section",children:(0,r.jsx)("button",{className:"next-turn-btn",onClick:()=>o({type:"NEXT_DAY"}),children:"Nast\u0119pny dzie\u0144"})}),(0,r.jsx)("div",{className:"dashboard-container",children:(0,r.jsxs)("div",{className:"dashboard-panel land-acquisition-panel",children:[(0,r.jsxs)("h3",{className:"panel-header",children:[(0,r.jsx)(Py,{className:"panel-icon"}),"Aktualne poszukiwania w regionie"]}),0===h.length?(0,r.jsx)("div",{className:"no-processes",children:(0,r.jsx)("p",{children:"Brak aktywnych proces\xf3w pozyskiwania grunt\xf3w"})}):(0,r.jsx)("div",{className:"active-processes",children:h.map((e=>(0,r.jsxs)("div",{className:"process-card",children:[(0,r.jsxs)("div",{className:"process-header",children:[(0,r.jsxs)("div",{className:"process-title",children:["Poszukiwanie dzia\u0142ki ",e.size,"ha"]}),(0,r.jsx)("div",{className:"process-region",children:e.regionName})]}),(0,r.jsxs)("div",{className:"process-details",children:[(0,r.jsxs)("div",{className:"scout-info",children:[(0,r.jsx)("span",{className:"label",children:"Skaut:"}),(0,r.jsx)("span",{className:"value",children:e.scout.name})]}),(0,r.jsxs)("div",{className:"date-info",children:[(0,r.jsxs)("div",{className:"date-item",children:[(0,r.jsx)("span",{className:"label",children:"Rozpocz\u0119cie:"}),(0,r.jsx)("span",{className:"value",children:new Date(e.startDate).toLocaleDateString("pl-PL")})]}),(0,r.jsxs)("div",{className:"date-item",children:[(0,r.jsx)("span",{className:"label",children:"Zako\u0144czenie:"}),(0,r.jsx)("span",{className:"value",children:new Date(e.completionDate).toLocaleDateString("pl-PL")})]})]})]}),(0,r.jsxs)("div",{className:"progress-container",children:[(0,r.jsxs)("div",{className:"progress-label",children:[(0,r.jsx)("span",{children:"Post\u0119p poszukiwania:"}),(0,r.jsxs)("span",{children:[Math.floor(e.progress),"%"]})]}),(0,r.jsx)("div",{className:"progress-bar",children:(0,r.jsx)("div",{className:"progress-fill",style:{width:`${e.progress}%`}})})]})]},e.id)))})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,r.jsxs)("button",{onClick:i,className:"flex items-center justify-center gap-2 p-3 text-white transition-colors rounded-lg bg-emerald-700 hover:bg-emerald-800",children:[(0,r.jsx)(Zf,{size:20}),(0,r.jsx)("span",{children:"Zapisz gr\u0119"})]}),(0,r.jsxs)("button",{onClick:a,className:"flex items-center justify-center gap-2 p-3 text-white transition-colors bg-amber-600 rounded-lg hover:bg-amber-700",children:[(0,r.jsx)(Yf,{size:20}),(0,r.jsx)("span",{children:"Tablica wynik\xf3w"})]})]})]})},Ay=e=>{switch(e){case"land_acquisition":return"Pozyskiwanie grunt\xf3w (Greenfield)";case"environmental_decision":return"Decyzja \u015brodowiskowa (EIA/D\u015aU)";case"zoning_conditions":return"Warunki zabudowy (MPZP/WZ)";case"grid_connection":return"Warunki przy\u0142\u0105czenia (WP)";case"ready_to_build":return"Gotowy do budowy (RTB)";case"construction":return"Budowa (COD-1)";case"operating":return"Operacyjny (COD)";default:return e}},My=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return"";e.endsWith("s");const n=e.endsWith("s")?e.slice(0,-1):e;if("lessor"===n||"scout"===n)return t?"Skauta":"Skaut";return{developer:t?"Developera":"Developer",lawyer:t?"Prawnika":"Prawnik",envSpecialist:t?"Specjalist\u0119 ds. \u015brodowiska":"Specjalista ds. \u015brodowiska",lobbyist:t?"Lobbyst\u0119":"Lobbysta"}[n]||n},Dy=e=>{switch(e){case"junior":return"pocz\u0105tkuj\u0105cego";case"mid":return"do\u015bwiadczonego";case"senior":return"eksperta";default:return e}},Ry=e=>{switch(e){case"aggressive":return"Agresywna";case"balanced":return"Zr\xf3wnowa\u017cona";case"conservative":return"Konserwatywna";default:return e}},Oy=(e,t)=>e.rtbPower>1.5*t?`Silny lider, posiada ${e.rtbPower.toLocaleString()} MW mocy RTB. Unikaj bezpo\u015bredniej konkurencji.`:e.rtbPower>t?`Nieznacznie wyprzedza Ci\u0119 z moc\u0105 ${e.rtbPower.toLocaleString()} MW. Mo\u017cliwe do nadrobienia.`:e.rtbPower>.7*t?`Blisko za Tob\u0105 z moc\u0105 ${e.rtbPower.toLocaleString()} MW. Pilnuj przewagi.`:`S\u0142abszy konkurent z moc\u0105 ${e.rtbPower.toLocaleString()} MW. Koncentruje si\u0119 na regionach ${e.strongRegions.slice(0,2).join(", ")}.`,Ly=()=>{const{state:e,dispatch:t}=d(),{state:n,showNotification:a}=mf(),{dispatch:r}=q(),[s,o]=(0,i.useState)([]),l={junior:{minSkill:1,maxSkill:3,salaryMultiplier:1},mid:{minSkill:4,maxSkill:7,salaryMultiplier:1.5},senior:{minSkill:8,maxSkill:10,salaryMultiplier:2.2}},c={scout:2500,developer:3e3,lawyer:0,envSpecialist:0,lobbyist:5e3},u={lawyer:3e4,envSpecialist:25e3},h=(0,i.useCallback)((()=>{n.turn>1&&f()}),[n.turn]);(0,i.useEffect)((()=>{h()}),[h]);const p=(e,t)=>{switch(e){case"scout":case"scouts":return"land_acquisition"===t;case"developer":case"developers":case"lobbyist":case"lobbyists":return!0;default:return!1}},m=(n,i)=>{const r=n.endsWith("s")?n:`${n}s`,s=e.staff[r];if(!s)return!1;const o=s.find((e=>e.id===i));if(!o||!o.assignedProject)return!1;const l=o.assignedProject,c=e.projects.find((e=>e.id===l));t({type:"UPDATE_STAFF",payload:{staffType:r,staffId:i,changes:{assignedProject:null,assignedSince:null}}});const d=n.endsWith("s")?n.slice(0,-1):n;return c&&(t({type:"UPDATE_PROJECT",payload:{id:l,changes:{assignedStaff:{...c.assignedStaff||{},[d]:null}}}}),a(`Od\u0142\u0105czono ${My(n)} ${o.name} od projektu ${c.name}`,"info")),!0},f=()=>{const t=[];Object.keys(e.staff).forEach((n=>{const i=e.staff[n];i&&0!==i.length&&i.forEach((e=>{if(Math.random()<.05){const n=y(e);n&&(t.push(n),g(e.type,e.id,n))}v(e.type,e.id)}))})),t.length>0&&o((e=>[...e,...t]))},y=e=>{let t=[.15,.1,.05,.1,.1,.2,.3];e.morale<50&&(t[2]*=3,t[4]*=2),e.energy<50&&(t[1]*=2,t[6]*=1.5),e.skill>7&&(t[5]*=2,t[3]*=1.5);const i=t.reduce(((e,t)=>e+t),0);t=t.map((e=>e/i));const a=Math.random();let r=0,s=-1;for(let n=0;n<t.length;n++)if(r+=t[n],a<=r){s=n;break}if(-1===s)return null;const o=["vacation","illness","burnout","promotion","conflict","innovation","mistake"][s];let l={id:Date.now(),staffId:e.id,staffName:e.name,staffType:e.type,type:o,turn:n.turn,title:"",description:"",effects:[]};switch(o){case"vacation":l.title=`${e.name} bierze urlop`,l.description=`Pracownik bierze ${Math.floor(1+3*Math.random())} dni urlopu.`,l.effects.push({type:"energy",value:30}),l.effects.push({type:"morale",value:20}),l.effects.push({type:"productivity",value:-1});break;case"illness":l.title=`${e.name} zachorowa\u0142`,l.description=`Pracownik jest chory i nie mo\u017ce pracowa\u0107 przez ${Math.floor(1+5*Math.random())} dni.`,l.effects.push({type:"energy",value:-20}),l.effects.push({type:"productivity",value:-1});break;case"burnout":l.title=`${e.name} cierpi na wypalenie zawodowe`,l.description="Pracownik jest przem\u0119czony i jego wydajno\u015b\u0107 spada o 50%.",l.effects.push({type:"energy",value:-40}),l.effects.push({type:"morale",value:-30}),l.effects.push({type:"productivity",value:-.5});break;case"promotion":l.title=`${e.name} zas\u0142uguje na awans`,l.description="Pracownik wykazuje si\u0119 du\u017cym zaanga\u017cowaniem i zas\u0142uguje na awans.",l.effects.push({type:"morale",value:40}),l.effects.push({type:"skill",value:1}),l.effects.push({type:"salary",value:.1});break;case"conflict":l.title=`${e.name} ma konflikt w zespole`,l.description="Pracownik ma konflikt z innymi cz\u0142onkami zespo\u0142u, co wp\u0142ywa na jego morale.",l.effects.push({type:"morale",value:-25}),l.effects.push({type:"productivity",value:-.2});break;case"innovation":l.title=`${e.name} ma innowacyjny pomys\u0142`,l.description="Pracownik wpad\u0142 na innowacyjny pomys\u0142, kt\xf3ry mo\u017ce przyspieszy\u0107 rozw\xf3j projekt\xf3w.",l.effects.push({type:"morale",value:15}),l.effects.push({type:"productivity",value:.2}),l.effects.push({type:"experience",value:10});break;case"mistake":l.title=`${e.name} pope\u0142ni\u0142 b\u0142\u0105d`,l.description="Pracownik pope\u0142ni\u0142 b\u0142\u0105d, kt\xf3ry mo\u017ce op\xf3\u017ani\u0107 rozw\xf3j projektu.",l.effects.push({type:"morale",value:-10}),l.effects.push({type:"productivity",value:-.15});break;default:return null}return l},g=(e,n,i)=>{const r={id:n};i.effects.forEach((e=>{switch(e.type){case"energy":r.energy=e.value;break;case"morale":r.morale=e.value;break;case"productivity":r.productivityModifier=e.value;break;case"skill":r.skillIncrease=e.value;break;case"experience":r.experienceIncrease=e.value;break;case"salary":r.salaryModifier=e.value}})),t({type:"UPDATE_STAFF",payload:{staffType:e,staffUpdate:r}}),a(i.title,"info")},v=function(n,i){var a;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10;const l=n.endsWith("s")?n:`${n}s`,c=e.staff[l];if(!c)return;const d=c.findIndex((e=>e.id===i));if(-1===d)return;const u=c[d];let h=o;if(h*=[1,1.1,1.2,1.35][(null===(a=e.companyUpgrades)||void 0===a?void 0:a.training_program)||0],"developer"===n||"developers"===n)if(r&&r.technology){const e=u.technologyExperience||{},a=e[r.technology]||0,s=Math.floor(1.5*h);e[r.technology]=a+s;const o={data:(new Date).toISOString(),typ:"do\u015bwiadczenie",opis:`Zdoby\u0142 ${s} p.d. w technologii ${r.technology}`};t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:i,changes:{experience:u.experience+h,technologyExperience:e,historia:[...u.historia||[],o]}}})}else t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:i,changes:{experience:u.experience+h,historia:[...u.historia||[],{data:(new Date).toISOString(),typ:"do\u015bwiadczenie",opis:`Zdoby\u0142 ${h} p.d.`}]}}});else if("lessor"===n||"lessors"===n)if("land_acquisition"===s&&r){const e=(u.acquiredLands||0)+1,a=(u.acquiredArea||0)+(r.area||0),s=Math.floor(2*h),o={data:(new Date).toISOString(),typ:"pozyskanie_gruntu",opis:`Pozyska\u0142 grunt o powierzchni ${r.area} ha w lokalizacji ${r.location||"nieznana"}`};t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:i,changes:{experience:u.experience+s,acquiredLands:e,acquiredArea:a,historia:[...u.historia||[],o]}}})}else t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:i,changes:{experience:u.experience+h,historia:[...u.historia||[],{data:(new Date).toISOString(),typ:"do\u015bwiadczenie",opis:`Zdoby\u0142 ${h} p.d.`}]}}});else t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:i,changes:{experience:u.experience+h,historia:[...u.historia||[],{data:(new Date).toISOString(),typ:"do\u015bwiadczenie",opis:`Zdoby\u0142 ${h} p.d.`}]}}});k(n,i)},w=(e,t)=>{const n="junior"===e.level?1:"mid"===e.level?1.5:2,i="skill"===t?1:1.5;return Math.floor(5e3*n*i)},x=()=>{const e=["Adam","Anna","Piotr","Katarzyna","Micha\u0142","Magdalena","Jan","Aleksandra","Tomasz","Ma\u0142gorzata","Marek","Barbara","Andrzej","Ewa","Krzysztof","Zofia","Pawe\u0142","Monika","Rafa\u0142","Joanna"],t=["Nowak","Kowalski","Wi\u015bniewski","W\xf3jcik","Kowalczyk","Kami\u0144ski","Lewandowski","Zieli\u0144ski","Wo\u017aniak","Szyma\u0144ski","D\u0105browski","Koz\u0142owski","Jankowski","Mazur","Kwiatkowski","Krawczyk","Piotrowski","Grabowski","Nowakowski","Paw\u0142owski"];return`${e[Math.floor(Math.random()*e.length)]} ${t[Math.floor(Math.random()*t.length)]}`},b=e=>{const t={scout:["PV","WF","BESS","Negocjacje","Analiza grunt\xf3w"],developer:["PV","WF","BESS","Zarz\u0105dzanie projektami","Analiza techniczna"],lawyer:["Prawo energetyczne","Prawo \u015brodowiskowe","Prawo budowlane","Negocjacje"],envSpecialist:["Oceny oddzia\u0142ywania","Ochrona gatunkowa","Rekultywacja","Monitoring"],lobbyist:["W\u0142adze lokalne","Media","NGO","Spo\u0142eczno\u015bci lokalne"]}[e]||["Og\xf3lna"];return t[Math.floor(Math.random()*t.length)]},j=()=>{const e=["Pracowity","Leniwy","Kreatywny","Analityczny","Komunikatywny","Introwertyczny","Dok\u0142adny","Chaotyczny","Ambitny","Ostro\u017cny","Optymista","Pesymista","Zespo\u0142owy","Indywidualista","Elastyczny","Sztywny","Odporny na stres","Wra\u017cliwy","Punktualny","Sp\xf3\u017anialski"],t=1+Math.floor(3*Math.random()),n=[];for(let i=0;i<t;i++){const t=e.filter((e=>!n.includes(e)));if(0===t.length)break;const i=t[Math.floor(Math.random()*t.length)];n.push(i)}return n},k=(n,i)=>{const r=n.endsWith("s")?n:`${n}s`,s=e.staff[r];if(!s)return;const o=s.findIndex((e=>e.id===i));if(-1===o)return;const l=s[o],c={junior:{min:0,max:3e3,next:"mid"},mid:{min:3001,max:8e3,next:"senior"},senior:{min:8001,max:1/0,next:null}},d=l.level;if(l.experience>c[d].max&&c[d].next){const e=c[d].next;if(t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:i,changes:{level:e,historia:[...l.historia||[],{data:(new Date).toISOString(),typ:"awans",opis:`Awansowa\u0142 na pozycj\u0119 ${Dy(e)}`}]}}}),"mid"===e){const r=Math.max(1,Math.floor(3*Math.random())+1);t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:i,changes:{skill:Math.min(10,l.skill+r)}}}),a(`${l.name} zdoby\u0142 awans na poziom ${Dy(e)}! Umiej\u0119tno\u015bci +${r}`,"success")}else if("senior"===e){const r=Math.max(2,Math.floor(3*Math.random())+2);t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:i,changes:{skill:Math.min(10,l.skill+r)}}}),a(`${l.name} zdoby\u0142 awans na poziom ${Dy(e)}! Umiej\u0119tno\u015bci +${r}`,"success")}}const u=[1e3,2e3,4e3,6e3,8e3,1e4,12e3,14e3,16e3].filter((e=>l.experience>=e));if(u.length>l.skill-1&&l.skill<10){const e=Math.min(10,u.length+1);e>l.skill&&(t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:i,changes:{skill:e,historia:[...l.historia||[],{data:(new Date).toISOString(),typ:"rozw\xf3j",opis:`Zwi\u0119kszy\u0142 umiej\u0119tno\u015bci do poziomu ${e}/10`}]}}}),a(`${l.name} zwi\u0119kszy\u0142 swoje umiej\u0119tno\u015bci do poziomu ${e}/10!`,"success"))}},N=()=>e.projects.filter((e=>"waiting_for_developer"===e.status||"new"===e.status&&(!e.assignedStaff||!e.assignedStaff.developer))),z=e=>{const n=N();if(0===n.length)return!1;const i=n[0];return t({type:"ASSIGN_STAFF_TO_PROJECT",payload:{staffType:"developer",staffId:e,projectId:i.id}}),t({type:"UPDATE_PROJECT",payload:{projectId:i.id,changes:{status:"in_development",progress:0}}}),!0};return{hireStaff:function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"junior";const s=l[r],o=c[i],d=Math.floor(o*s.salaryMultiplier),h="lawyer"===i||"envSpecialist"===i?u[i]:2*d;if(e.cash<h)return a(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w! Potrzebujesz ${h.toLocaleString()} PLN.`,"error"),!1;const p=Date.now(),m=Math.floor(s.minSkill+Math.random()*(s.maxSkill-s.minSkill+1)),f={id:p,type:i,name:x(),skill:m,experience:0,level:r,salary:d,hiredOn:n.turn,morale:100,energy:100,specialization:b(i),traits:j()};if(t({type:"HIRE_STAFF",payload:{staffType:i,staff:f,cost:h}}),a(`Zatrudniono ${Dy(r)} ${My(i,!0)}: ${f.name}`,"success"),"developer"===i){if(z(p)){const e=N();e.length>0&&a(`Developer ${f.name} zosta\u0142 automatycznie przydzielony do projektu ${e[0].name}`,"success")}}return!0},fireStaff:(n,i)=>{const r=e.staff[`${n}s`];if(!r)return!1;const s=r.findIndex((e=>e.id===i));if(-1===s)return!1;const o=r[s],l=o.salary;return e.cash<l?(a(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w na odpraw\u0119! Potrzebujesz ${l.toLocaleString()} PLN.`,"error"),!1):(t({type:"FIRE_STAFF",payload:{staffType:n,staffId:i,cost:l}}),a(`Zwolniono pracownika: ${o.name}`,"warning"),!0)},trainStaff:(n,i,r)=>{const s=e.staff[`${n}s`];if(!s)return!1;const o=s.findIndex((e=>e.id===i));if(-1===o)return!1;const l=s[o],c=w(l,r);return e.cash<c?(a(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w na szkolenie! Potrzebujesz ${c.toLocaleString()} PLN.`,"error"),!1):(t({type:"TRAIN_STAFF",payload:{staffType:n,staffId:i,trainingType:r,cost:c}}),a(`Wys\u0142ano pracownika ${l.name} na szkolenie`,"success"),!0)},assignStaffToProject:(i,s,o)=>{const l=i.endsWith("s")?i:`${i}s`,c=e.staff[l];if(!c)return!1;const d=c.find((e=>e.id===s));if(!d)return!1;const u=e.projects.find((e=>e.id===o));if(!u)return!1;if(!p(i,u.status))return a(`${My(i)} nie mo\u017ce by\u0107 przypisany do projektu na etapie ${Ay(u.status)}`,"error"),!1;if(("developer"===i||"developers"===i)&&!d.assignedProject){const t=e.projects.filter((e=>e.assignedStaff&&e.assignedStaff.developer===s)).length;if(t>=5)return a(`Developer ${d.name} osi\u0105gn\u0105\u0142 limit 5 projekt\xf3w. Od\u0142\u0105cz go od istniej\u0105cego projektu, aby przypisa\u0107 do nowego.`,"error"),!1}return d.assignedProject&&m(i,s),t({type:"ASSIGN_STAFF_TO_PROJECT",payload:{staffType:i.endsWith("s")?i.slice(0,-1):i,staffId:s,projectId:o}}),r({type:"ADD_EVENT",payload:{id:Date.now()+Math.random(),type:"staff_event",title:"Przypisanie pracownika",description:`${d.name} (${My(i)}) zosta\u0142 przypisany do projektu ${u.name}`,severity:"info",turn:n.turn,expires:n.turn+5,staffId:d.id,staffName:d.name}}),a(`Przypisano ${My(i)} ${d.name} do projektu ${u.name}`,"success"),!0},unassignStaffFromProject:m,generateStaffEvents:f,applyStaffEventEffect:g,updateStaffExperience:v,calculateTrainingCost:w,isStaffValidForProjectStage:p,checkForLevelUp:k,calculateStaffProjectBonus:t=>{var n,i;const a=e.projects.find((e=>e.id===t));if(!a||!a.assignedStaff)return 1;let r=1;if(a.assignedStaff.developer){const t=e.staff.developers.find((e=>e.id===a.assignedStaff.developer));if(t){r+=.02*t.skill+({junior:.05,mid:.1,senior:.15}[t.level]||.05)}}if(a.assignedStaff.lobbyist){const t=e.staff.lobbyists.find((e=>e.id===a.assignedStaff.lobbyist));if(t){r+=.01*t.skill+({junior:.03,mid:.06,senior:.1}[t.level]||.03)}}const s=(null===(n=e.staff.lawyers)||void 0===n?void 0:n.length)||0,o=(null===(i=e.staff.envSpecialists)||void 0===i?void 0:i.length)||0;if(s>0&&["environmental_decision","zoning_conditions","grid_connection"].includes(a.status)){const t=e.staff.lawyers.reduce(((e,t)=>e+t.skill),0)/s;r+=Math.min(.03*s,.15)+.005*t}if(o>0&&"environmental_decision"===a.status){const t=e.staff.envSpecialists.reduce(((e,t)=>e+t.skill),0)/o;r+=Math.min(.04*o,.2)+.005*t}return Math.min(r,1.5)},findProjectsWaitingForDeveloper:N,assignDeveloperToWaitingProject:z}},Fy={PV:{name:"Fotowoltaika",shortName:"PV",icon:"Sun",color:"yellow",stages:{land_acquisition:{time:{min:1,max:3},costPerMW:{min:1e4,max:1e4},description:"Pozyskiwanie grunt\xf3w pod instalacje fotowoltaiczne"},environmental_decision:{time:{min:4,max:8},costPerMW:{min:15e3,max:25e3},description:"Uzyskanie decyzji \u015brodowiskowej dla instalacji PV"},zoning_conditions:{time:{min:2,max:4},costPerMW:{min:3e4,max:4e4},description:"Uzyskanie warunk\xf3w zabudowy dla instalacji PV"},grid_connection:{time:{min:3,max:6},costPerMW:{min:12e4,max:15e4},description:"Przy\u0142\u0105czenie do sieci instalacji fotowoltaicznej"},construction:{time:{min:6,max:10},costPerMW:{min:25e5,max:35e5},description:"Budowa instalacji fotowoltaicznej"}},marketPrices:{greenfield:{min:15e3,max:25e3,currency:"PLN"},development:{min:5e4,max:8e4,currency:"EUR"},rtb:{min:61e4,max:61e4,currency:"PLN"},cod:{min:8e5,max:12e5,currency:"EUR"}},specificRisks:[{name:"Problemy z sieci\u0105",probability:.25,impact:"grid_connection_delay",description:"Ograniczenia w przy\u0142\u0105czeniu do sieci"},{name:"Zmiany w systemie wsparcia",probability:.15,impact:"financial_impact",description:"Zmiany w aukcjach OZE"}]},WF:{name:"Farmy Wiatrowe",shortName:"WF",icon:"Wind",color:"blue",stages:{land_acquisition:{time:{min:7,max:12},costPerMW:{min:1e4,max:1e4},description:"Pozyskiwanie grunt\xf3w pod farmy wiatrowe"},environmental_decision:{time:{min:12,max:20},costPerMW:{min:15e3,max:25e3},description:"Uzyskanie decyzji \u015brodowiskowej dla farm wiatrowych"},zoning_conditions:{time:{min:10,max:16},costPerMW:{min:3e4,max:4e4},description:"Uzyskanie warunk\xf3w zabudowy dla farm wiatrowych"},grid_connection:{time:{min:12,max:24},costPerMW:{min:12e4,max:15e4},description:"Przy\u0142\u0105czenie do sieci farm wiatrowych"},construction:{time:{min:18,max:30},costPerMW:{min:4e6,max:6e6},description:"Budowa farm wiatrowych"}},marketPrices:{greenfield:{min:2e5,max:7e5,currency:"PLN"},development:{min:25e4,max:35e4,currency:"PLN"},rtb:{min:4e5,max:4e5,currency:"PLN"},cod:{min:15e5,max:2e6,currency:"EUR"}},specificRisks:[{name:"Protesty ekologiczne",probability:.35,impact:"environmental_decision_delay",description:"Protesty organizacji ekologicznych"},{name:"Zasada 10H",probability:.2,impact:"land_limitation",description:"Ograniczenia lokalizacji turbin"}]},BESS:{name:"Magazyny Energii",shortName:"BESS",icon:"Battery",color:"green",stages:{land_acquisition:{time:{min:4,max:8},costPerMW:{min:1e4,max:1e4},description:"Pozyskiwanie grunt\xf3w pod magazyny energii"},environmental_decision:{time:{min:6,max:12},costPerMW:{min:15e3,max:25e3},description:"Uzyskanie decyzji \u015brodowiskowej dla magazyn\xf3w energii"},zoning_conditions:{time:{min:4,max:10},costPerMW:{min:3e4,max:4e4},description:"Uzyskanie warunk\xf3w zabudowy dla magazyn\xf3w energii"},grid_connection:{time:{min:10,max:18},costPerMW:{min:12e4,max:15e4},description:"Przy\u0142\u0105czenie do sieci magazyn\xf3w energii"},construction:{time:{min:12,max:18},costPerMW:{min:28e5,max:36e5},description:"Budowa magazyn\xf3w energii"}},marketPrices:{greenfield:{min:5e4,max:1e5,currency:"PLN"},development:{min:15e4,max:25e4,currency:"PLN"},rtb:{min:18e5,max:18e5,currency:"PLN"},cod:{min:3e6,max:45e5,currency:"PLN"}},specificRisks:[{name:"Regulacje bezpiecze\u0144stwa",probability:.3,impact:"additional_costs",description:"Dodatkowe wymagania bezpiecze\u0144stwa"},{name:"Problemy z \u0142a\u0144cuchem dostaw",probability:.25,impact:"construction_delay",description:"Op\xf3\u017anienia w dostawie komponent\xf3w"}]}},Uy={"PV+BESS":{name:"Fotowoltaika z Magazynem",shortName:"PV+BESS",icon:"SunBattery",color:"teal",components:["PV","BESS"],componentWeights:{PV:.7,BESS:.3}},"WF+BESS":{name:"Wiatrowa z Magazynem",shortName:"WF+BESS",icon:"WindBattery",color:"indigo",components:["WF","BESS"],componentWeights:{WF:.7,BESS:.3}},"PV+WF":{name:"Fotowoltaika i Wiatrowa",shortName:"PV+WF",icon:"SunWind",color:"green",components:["PV","WF"],componentWeights:{PV:.5,WF:.5}},"PV+WF+BESS":{name:"Kompleksowy System OZE",shortName:"PV+WF+BESS",icon:"SunWindBattery",color:"purple",components:["PV","WF","BESS"],componentWeights:{PV:.4,WF:.4,BESS:.2}}};function Vy(e,t,n){const i={PV:15e4,WF:2e5,BESS:25e4,"PV+BESS":18e4,"WF+BESS":23e4,"PV+WF":19e4,"PV+WF+BESS":22e4}[e]||a50000,a={land_acquisition:.15,environmental_decision:.35,zoning_conditions:.55,grid_connection:.85,ready_to_build:1}[n]||.1;return Math.round(t*i*a)}const $y=()=>{const{state:e,dispatch:t}=d(),{state:n,dispatch:a}=wf(),{state:r,dispatch:s}=(()=>{const e=(0,i.useContext)(bf);if(!e)throw new Error("useCountyContext musi by\u0107 u\u017cywany wewn\u0105trz CountyProvider");return e})(),{state:o,dispatch:l,showNotification:c}=mf(),{dispatch:u}=q(),h=(0,i.useCallback)((e=>{let t=0;return r.forEach((n=>{n.leasePools&&Object.values(n.leasePools).forEach((n=>{n.lessors&&n.lessors.includes(e)&&t++}))})),t}),[r]),p=(0,i.useCallback)((()=>{const t=e.staff.lessors;if(0===t.length)return null;const n=t.map((e=>({lessor:e,countyCount:h(e.id)})));return n.sort(((e,t)=>e.countyCount-t.countyCount)),n[0].lessor}),[e.staff.lessors,h]),m=(0,i.useCallback)(((e,t)=>{if(!e||!e.specialization)return!1;const n=e.specialization.toLowerCase();if("PV"===t&&n.includes("fotowoltaika"))return!0;if("WF"===t&&n.includes("wiatrowe"))return!0;if("BESS"===t&&n.includes("magazyn"))return!0;if(t.includes("+")&&n.includes("hybrydowe")){t.split("+");if("PV+BESS"===t&&n.includes("pv+bess"))return!0;if("WF+BESS"===t&&n.includes("fw+bess"))return!0;if("PV+WF"===t&&n.includes("pv+wf"))return!0;if("PV+WF+BESS"===t&&n.includes("pv+wf+bess"))return!0}return!1}),[]),f=(0,i.useCallback)(((e,t,n)=>{const i=r.find((n=>n.voivodeship===e&&n.id===t));if(!i)return!1;if(!i.leasePools)return s({type:"UPDATE_COUNTY",payload:{id:t,voivodeship:e,changes:{leasePools:{PV:{lessors:[],projects:[]},WF:{lessors:[],projects:[]},BESS:{lessors:[],projects:[]},"PV+BESS":{lessors:[],projects:[]},"WF+BESS":{lessors:[],projects:[]},"PV+WF":{lessors:[],projects:[]},"PV+WF+BESS":{lessors:[],projects:[]}}}}}),!0;if(!i.leasePools[n]){const a={...i.leasePools};a[n]={lessors:[],projects:[]},s({type:"UPDATE_COUNTY",payload:{id:t,voivodeship:e,changes:{leasePools:a}}})}return!0}),[r,s]),y=(0,i.useCallback)(((e,t,n,i)=>{const a=r.find((e=>e.voivodeship===t&&e.id===n));if(!a||!a.leasePools||!a.leasePools[i])return!1;if(a.leasePools[i].lessors.includes(e))return!0;const o={...a.leasePools};return o[i]={...o[i],lessors:[...o[i].lessors,e]},s({type:"UPDATE_COUNTY",payload:{id:n,voivodeship:t,changes:{leasePools:o}}}),!0}),[r,s]),g=(0,i.useCallback)(((e,t,n)=>{const i=r.find((n=>n.voivodeship===e&&n.id===t));return!!(i&&i.leasePools&&i.leasePools[n])&&i.leasePools[n].lessors.length>0}),[r]),v=(0,i.useCallback)(((t,n,i)=>{const a=r.find((e=>e.voivodeship===t&&e.id===n));if(!a||!a.leasePools||!a.leasePools[i])return null;if(0===a.leasePools[i].lessors.length)return null;const s=a.leasePools[i].lessors[0];return e.staff.lessors.find((e=>e.id===s))}),[r,e.staff.lessors]),w=(0,i.useCallback)((function(i){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"PV",d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!n.find((e=>e.id===i)))return null;if(0===e.staff.lessors.length)return c("Potrzebujesz zatrudni\u0107 przynajmniej jednego dzier\u017cawc\u0119, aby rozpocz\u0105\u0107 projekt!","error"),null;if(!d)return c("Wybierz powiat, w kt\xf3rym chcesz rozpocz\u0105\u0107 projekt!","error"),null;if(!f(i,d,l))return c("Nie uda\u0142o si\u0119 zainicjowa\u0107 puli dzier\u017cawy dla powiatu!","error"),null;if(!g(i,d,l)){const e=p();if(!e)return c("Wszyscy twoi dzier\u017cawcy obs\u0142uguj\u0105 ju\u017c maksymaln\u0105 liczb\u0119 powiat\xf3w (5). Zatrudnij wi\u0119cej dzier\u017cawc\xf3w!","error"),null;if(!y(e.id,i,d,l))return c("Nie uda\u0142o si\u0119 przypisa\u0107 dzier\u017cawcy do puli dzier\u017cawy!","error"),null;m(e,l)||c(`Dzier\u017cawca ${e.name} nie ma specjalizacji pasuj\u0105cej do technologii ${l}. Efektywno\u015b\u0107 dzier\u017cawy b\u0119dzie ni\u017csza.`,"warning")}v(i,d,l);const u=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=e.includes("+");let a,r,s=[];if(i){if(r=Uy[e],!r)return null;if(s=r.components.map((e=>Fy[e])),s.some((e=>!e)))return null}else if(a=Fy[e],!a)return null;const o=n.size||Math.floor(30+50*Math.random());let l;if(i)l="PV+BESS"===e?Math.floor(o*(1.2+.6*Math.random())):"WF+BESS"===e?Math.floor(o*(.6+.3*Math.random())):"PV+WF"===e?Math.floor(o*(.8+.4*Math.random())):Math.floor(o*(1+.5*Math.random()));else switch(e){case"PV":l=Math.floor(o*(1+.5*Math.random()));break;case"WF":l=Math.floor(o*(.5+.3*Math.random()));break;case"BESS":l=Math.floor(o*(2+1*Math.random()));break;default:l=Math.floor(o*(1.2+.8*Math.random()))}const c=Date.now()+Math.floor(1e3*Math.random()),d=i?`${r.shortName} ${t.slice(0,3).toUpperCase()}${Math.floor(100*Math.random())}`:`${a.shortName} ${t.slice(0,3).toUpperCase()}${Math.floor(100*Math.random())}`;let u={},h={};if(i){u=r.components.reduce(((e,t)=>{const n=Fy[t],i=r.componentWeights[t];return Object.entries(n.stages).forEach((t=>{let[n,a]=t;e[n]||(e[n]={time:{min:0,max:0},costPerMW:{min:0,max:0},description:`${r.name}: ${a.description}`}),e[n].time.min+=a.time.min*i,e[n].time.max+=a.time.max*i,e[n].costPerMW.min+=a.costPerMW.min*i,e[n].costPerMW.max+=a.costPerMW.max*i})),e}),{});const e=r.components.reduce(((e,t)=>{const n=Fy[t],i=r.componentWeights[t];return Object.entries(n.marketPrices).forEach((t=>{let[n,a]=t;e[n]||(e[n]={min:0,max:0,currency:a.currency}),e[n].min+=a.min*i,e[n].max+=a.max*i})),e}),{}),t=1.1+.1*Math.random();Object.keys(e).forEach((n=>{h[n]={min:Math.round(e[n].min*t),max:Math.round(e[n].max*t),currency:e[n].currency}}))}else u=a.stages,h=a.marketPrices;const p={};return Object.entries(u).forEach((e=>{let[t,n]=e;const i=n.costPerMW.min,a=n.costPerMW.max,r=i+Math.random()*(a-i);p[t]=Math.round(r*l)})),{id:c,name:d,technology:e,isHybrid:i,hybridComponents:i?r.components:[e],region:t,size:o,power:l,status:"land_acquisition",statusIndex:0,progress:0,turn:n.turn||1,etapCosts:p,marketValue:Vy(e,l,"land_acquisition"),totalCost:0,events:[],assignedStaff:{},specialRisks:i?r.components.flatMap((e=>Fy[e].specificRisks||[])):a.specificRisks||[]}}(l,i,{turn:o.turn,countyId:d}),h=r.find((e=>e.voivodeship===i&&e.id===d));if(!h)return c("Nie znaleziono powiatu!","error"),null;if(h.availableLand<u.size)return c(`W tym powiecie nie ma wystarczaj\u0105cej ilo\u015bci grunt\xf3w na projekt o mocy ${u.power} MW!`,"error"),null;if(h.gridCapacity<u.power)return c(`W tym powiecie nie ma wystarczaj\u0105cej mocy przy\u0142\u0105czeniowej dla projektu o mocy ${u.power} MW!`,"error"),null;u.county={id:h.id,name:h.name,voivodeship:h.voivodeship},u.technology=l,l.includes("+")?(u.isHybrid=!0,u.hybridComponents=l.split("+")):(u.isHybrid=!1,u.hybridComponents=[l]),l.includes("PV")?u.productionFactor=h.solarPotential/100:l.includes("WF")?u.productionFactor=h.windPotential/100:"BESS"===l&&(u.productionFactor=1);const w=1+h.environmentalRestrictions/100*.5;u.environmentalDelayFactor=w;const x=1+h.localOpposition/100*.3;u.oppositionDelayFactor=x;const b=2-h.administrativeEfficiency/100;u.administrationEfficiencyFactor=b,u.totalDelayFactor=(w+x+b)/3;const j=Math.floor(10*Math.random())+1,k=Math.min(j*(500+500*Math.random()),7e3),N=Math.max(1e4-k,3e3)*h.propertyPrices,z=Math.round(N*u.size);u.etapCosts.land_acquisition=z,u.leaseDetails={baseRate:1e4,adjustedRate:N,distanceToTransformer:j,hasIndexationClause:Math.random()<.7,securityDeposit:Math.floor((3e4+2e4*Math.random())*u.power)},u.assignedStaff={},u.etapPaid={land_acquisition:!1,environmental_decision:!1,zoning_conditions:!1,grid_connection:!1,construction:!1},t({type:"ADD_PROJECT",payload:u}),a({type:"ADD_PROJECT_TO_REGION",payload:{regionId:i,project:{id:u.id,name:u.name,power:u.power,status:u.status,technology:u.technology}}}),s({type:"ADD_PROJECT_TO_COUNTY",payload:{countyId:d,voivodeship:i,project:{id:u.id,name:u.name,size:u.size,power:u.power,technology:u.technology}}});const _=r.find((e=>e.voivodeship===i&&e.id===d));if(_&&_.leasePools&&_.leasePools[l]){const e={..._.leasePools};e[l]={...e[l],projects:[...e[l].projects,u.id]},s({type:"UPDATE_COUNTY",payload:{id:d,voivodeship:i,changes:{leasePools:e}}})}return c(`Rozpocz\u0119to nowy projekt ${u.name} w powiecie ${h.name}`,"success"),u}),[e,n,r,o,t,a,s,c,p,m,f,g,y,v]),x=(0,i.useCallback)((n=>{var i,a;console.log("Wywo\u0142anie advanceProject dla projektu ID:",n);const r=e.projects.find((e=>e.id===n));if(!r)return console.error("Nie znaleziono projektu o ID:",n),c("Nie znaleziono wybranego projektu","error"),!1;if("ready_to_build"===r.status)return console.log("Projekt jest ju\u017c w stanie ready_to_build, nie mo\u017cna go dalej rozwija\u0107"),c("Projekt jest ju\u017c gotowy do budowy","info"),!1;const s=["development_ready","in_development","land_acquisition","environmental_decision","zoning_conditions","grid_connection","ready_to_build"],o=s.indexOf(r.status);if(-1===o)return console.error("Nieznany status projektu:",r.status),c("Nieznany status projektu","error"),!1;const l=s[o+1];console.log("Przej\u015bcie z etapu",r.status,"do",l);const d=j(r,l);if(!d.canTransition)return c(`Nie mo\u017cna przej\u015b\u0107 do etapu ${l}: ${d.reason}`,"error"),!1;const u=k(r,l),h=Math.random();if(console.log(`Ryzyko niepowodzenia: ${u}, Wylosowana warto\u015b\u0107: ${h}`),h<u)return t({type:"ADD_PROJECT_EVENT",payload:{projectId:n,event:{date:(new Date).toISOString(),text:`Pr\xf3ba przej\u015bcia do etapu ${Ay(l)} nie powiod\u0142a si\u0119. Konieczne jest podj\u0119cie dodatkowych dzia\u0142a\u0144.`,type:"failure"}}}),t({type:"UPDATE_PROJECT",payload:{projectId:n,changes:{transitionFailures:(r.transitionFailures||0)+1,issues:[...r.issues||[],N(l)]}}}),c(`Przej\u015bcie do etapu ${Ay(l)} nie powiod\u0142o si\u0119. Konieczne s\u0105 dodatkowe dzia\u0142ania.`,"warning"),!1;if("development_ready"===r.status){const i=e.staff.developers.filter((e=>!e.assignedProject&&(!e.busy||!1===e.busy)));if(0===i.length)return console.log("Brak dost\u0119pnych developer\xf3w do przypisania do projektu"),c("Potrzebujesz przypisa\u0107 developera do projektu!","error"),!1;const a=b(i,r.technology);return t({type:"ASSIGN_STAFF_TO_PROJECT",payload:{staffType:"developer",staffId:a.id,projectId:n}}),t({type:"UPDATE_PROJECT",payload:{projectId:n,changes:{status:"in_development",progress:0,assignedStaff:{...r.assignedStaff||{},developer:a.id}}}}),c(`Developer ${a.name} zosta\u0142 przypisany do projektu.`,"success"),!0}t({type:"UPDATE_PROJECT",payload:{projectId:n,changes:{status:l,progress:0,transitionFailures:0,stageHistory:{...r.stageHistory||{},[r.status]:{completed:(new Date).toISOString(),duration:null!==(i=r.stageHistory)&&void 0!==i&&null!==(a=i[r.status])&&void 0!==a&&a.started?(new Date-new Date(r.stageHistory[r.status].started))/864e5:null},[l]:{started:(new Date).toISOString()}}}}});const p=.3+.2*(r.complexity||0);if(Math.random()<p){const e=N(l);t({type:"UPDATE_PROJECT",payload:{projectId:n,changes:{issues:[...r.issues||[],e]}}}),c(`Pojawi\u0142 si\u0119 nowy problem: ${e.name}`,"warning")}return t({type:"ADD_PROJECT_EVENT",payload:{projectId:n,event:{date:(new Date).toISOString(),text:`Projekt przeszed\u0142 do etapu ${Ay(l)}.`,type:"transition"}}}),c(`Projekt przeszed\u0142 do etapu ${Ay(l)}.`,"success"),!0}),[e.projects,e.staff.developers,t,c]),b=(e,t)=>{if(!e||0===e.length)return null;const n=e.map((e=>{let n=e.skill||0;if(e.specialization===t&&(n+=30),e.completedProjects&&e.completedProjects.length>0){const i=e.completedProjects.filter((e=>e.technology===t));n+=5*i.length}return{...e,score:n}}));return n.sort(((e,t)=>t.score-e.score))[0]},j=(e,t)=>{var n,i;const a={canTransition:!0,reason:""};if(e.issues&&e.issues.some((e=>!e.resolved)))return a.canTransition=!1,a.reason="Projekt ma nierozwi\u0105zane problemy",a;switch(t){case"environmental_decision":e.hasEnvironmentalAssessment||(a.canTransition=!1,a.reason="Brak oceny oddzia\u0142ywania na \u015brodowisko");break;case"zoning_conditions":null!==(n=e.stageHistory)&&void 0!==n&&null!==(i=n.environmental_decision)&&void 0!==i&&i.completed||(a.canTransition=!1,a.reason="Brak decyzji \u015brodowiskowej");break;case"grid_connection":e.hasGridConnectionDesign||(a.canTransition=!1,a.reason="Brak projektu przy\u0142\u0105cza do sieci");break;case"ready_to_build":e.hasConstructionPermit||(a.canTransition=!1,a.reason="Brak pozwolenia na budow\u0119")}return a},k=(t,n)=>{let i=0;switch(n){case"environmental_decision":i=.2;break;case"zoning_conditions":i=.15;break;case"grid_connection":i=.25;break;case"ready_to_build":i=.1;break;default:i=.05}i+=.1*(t.complexity||0);const a=e.reputation||50;a>=80?i*=.7:a<30&&(i*=1.3);const r=e.staff.developers.find((e=>{var n;return e.id===(null===(n=t.assignedStaff)||void 0===n?void 0:n.developer)}));if(r){i*=1-(r.skill||50)/100*.5-(r.specialization===t.technology?.2:0)}return i+=.1*(t.transitionFailures||0),Math.max(.05,Math.min(.95,i))},N=e=>{const t={land_acquisition:[{name:"Problemy prawne z w\u0142asno\u015bci\u0105 gruntu",cost:5e3,time:10,complexity:.2},{name:"Sp\xf3r graniczny",cost:3e3,time:7,complexity:.15},{name:"Nieoczekiwane ograniczenia dzier\u017cawy",cost:4e3,time:5,complexity:.1}],environmental_decision:[{name:"Wymagana dodatkowa ocena wp\u0142ywu na gatunki chronione",cost:8e3,time:15,complexity:.3},{name:"Sprzeciw lokalnych ekolog\xf3w",cost:1e4,time:20,complexity:.25},{name:"Niekompletna dokumentacja \u015brodowiskowa",cost:6e3,time:10,complexity:.2}],zoning_conditions:[{name:"Negatywna opinia s\u0105siad\xf3w",cost:5e3,time:12,complexity:.2},{name:"Konflikt z miejscowym planem zagospodarowania",cost:12e3,time:25,complexity:.4},{name:"Wymagane dodatkowe konsultacje spo\u0142eczne",cost:7e3,time:15,complexity:.3}],grid_connection:[{name:"Niewystarczaj\u0105ca przepustowo\u015b\u0107 sieci",cost:15e3,time:20,complexity:.35},{name:"Konieczno\u015b\u0107 budowy dodatkowej infrastruktury",cost:25e3,time:30,complexity:.5},{name:"Wysoki koszt przy\u0142\u0105czenia",cost:2e4,time:15,complexity:.25}],ready_to_build:[{name:"Konieczno\u015b\u0107 aktualizacji projektu budowlanego",cost:1e4,time:15,complexity:.3},{name:"Dodatkowe wymogi bezpiecze\u0144stwa",cost:8e3,time:10,complexity:.2},{name:"Problemy z finansowaniem",cost:3e4,time:20,complexity:.4}]}[e]||[];if(0===t.length)return{id:`issue-${Date.now()}-${Math.floor(1e3*Math.random())}`,name:"Nieoczekiwany problem administracyjny",description:"Pojawi\u0142 si\u0119 nieoczekiwany problem administracyjny.",cost:5e3,time:10,complexity:.2,resolved:!1,createdAt:(new Date).toISOString()};const n=t[Math.floor(Math.random()*t.length)];return{id:`issue-${Date.now()}-${Math.floor(1e3*Math.random())}`,name:n.name,description:`${n.name}. Wymaga dodatkowych dzia\u0142a\u0144.`,cost:n.cost,time:n.time,complexity:n.complexity,resolved:!1,createdAt:(new Date).toISOString()}},z=((0,i.useCallback)(((n,i)=>{const a=e.projects.find((e=>e.id===n));if(!a||!a.issues)return c("Nie znaleziono projektu lub problem\xf3w","error"),!1;const r=a.issues.find((e=>e.id===i));if(!r)return c("Nie znaleziono problemu","error"),!1;if(e.cash<r.cost)return c(`Niewystarczaj\u0105ce \u015brodki. Potrzeba: ${r.cost.toLocaleString()} PLN`,"error"),!1;t({type:"UPDATE_CASH",payload:{amount:-r.cost,reason:`Rozwi\u0105zanie problemu: ${r.name} w projekcie ${a.name}`}});const s=a.issues.map((e=>e.id===i?{...e,resolved:!0,resolvedAt:(new Date).toISOString()}:e));return t({type:"UPDATE_PROJECT",payload:{projectId:n,changes:{issues:s}}}),t({type:"ADD_PROJECT_EVENT",payload:{projectId:n,event:{date:(new Date).toISOString(),text:`Rozwi\u0105zano problem: ${r.name}`,type:"issue_resolved"}}}),c(`Problem "${r.name}" zosta\u0142 rozwi\u0105zany`,"success"),!0}),[e.projects,e.cash,t,c]),(0,i.useCallback)((function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const a=e.projects.find((e=>e.id===n));if(!a)return c("Nie znaleziono projektu","error"),!1;if("ready_to_build"===a.status)return c("Projekt jest ju\u017c gotowy do budowy","warning"),!1;let r=0,s=0;switch(a.status){case"land_acquisition":r=i||Math.round(5e3*a.size),s=Math.min(50,Math.round(r/(5e3*a.size)*50));break;case"environmental_decision":r=i||Math.max(5e4,1e4*a.power),s=Math.min(40,Math.round(r/(1e4*a.power)*40));break;case"zoning_conditions":r=i||Math.max(3e4,7e3*a.power),s=Math.min(35,Math.round(r/(7e3*a.power)*35));break;case"grid_connection":r=i||Math.max(8e4,15e3*a.power),s=Math.min(30,Math.round(r/(15e3*a.power)*30))}return e.cash<r?(c(`Niewystarczaj\u0105ca ilo\u015b\u0107 got\xf3wki. Potrzebujesz ${r.toLocaleString()} PLN.`,"error"),!1):(t({type:"UPDATE_PROJECT",payload:{id:n,changes:{progress:Math.min(100,(a.progress||0)+s),events:[...a.events,{turn:o.turn,text:`Przyspieszono projekt o ${s}% za ${r.toLocaleString()} PLN`}]}}}),t({type:"UPDATE_CASH",payload:-r}),t({type:"UPDATE_PROJECT_TOTAL_COST",payload:{projectId:a.id,cost:r}}),c(`Przyspieszono projekt ${a.name} o ${s}%!`,"success"),!0)}),[e,o,t])),_=(0,i.useCallback)((function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const a=e.projects.find((e=>e.id===n));if(!a)return c("Nie znaleziono projektu","error"),!1;if("ready_to_build"!==a.status)return c("Tylko projekty gotowe do budowy mog\u0105 by\u0107 wystawione na rynek","warning"),!1;const r=15e4*a.power,s=i||r;return t({type:"SEND_PROJECT_TO_MARKET",payload:{projectId:n,price:s}}),c(`Projekt "${a.name}" zosta\u0142 wystawiony na rynek za ${s.toLocaleString()} PLN`,"success"),!0}),[e,t,c]),E=(0,i.useCallback)((function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bribery";const a=e.projects.find((e=>e.id===n));if(!a)return c("Nie znaleziono projektu","error"),!1;if(e.reputation<120)return c("Niewystarczaj\u0105ca reputacja do wykonania nielegalnych dzia\u0142a\u0144","error"),!1;const r={bribery:{cost:Math.round(25e3*a.power),progressGain:25,reputationLoss:10,riskOfExposure:.3},forgery:{cost:Math.round(15e3*a.power),progressGain:15,reputationLoss:15,riskOfExposure:.4},intimidation:{cost:Math.round(1e4*a.power),progressGain:10,reputationLoss:20,riskOfExposure:.5}},s=r[i]||r.bribery;if(e.cash<s.cost)return c("Niewystarczaj\u0105ca ilo\u015b\u0107 got\xf3wki","error"),!1;const l=Math.random()<s.riskOfExposure;return t({type:"UPDATE_PROJECT",payload:{id:n,changes:{progress:Math.min(100,(a.progress||0)+s.progressGain),useIllegalMethods:!0,events:[...a.events,{turn:o.turn,text:`U\u017cyto nielegalnych metod (${i}) do przyspieszenia projektu o ${s.progressGain}%`,isIllegal:!0}]}}}),t({type:"UPDATE_CASH",payload:-s.cost}),l&&t({type:"UPDATE_REPUTATION",payload:{change:-s.reputationLoss,reason:`Wykryto nielegalne dzia\u0142ania w projekcie ${a.name}`}}),t({type:"ADD_ILLEGAL_ACTION",payload:{type:i,target:a.name,cost:s.cost,turn:o.turn,exposed:l}}),l?c(`Twoje nielegalne dzia\u0142ania zosta\u0142y wykryte! Strata reputacji: ${s.reputationLoss}`,"error"):c(`U\u017cyto nielegalnych metod do przyspieszenia projektu o ${s.progressGain}%`,"success"),!0}),[e,o,t,c]);return{projects:e.projects,startNewProject:w,advanceProject:x,accelerateProject:z,sendProjectToMarket:_,applyIllegalMethod:E,translateStage:Ay}},By=Lf("Battery",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]),Wy=Lf("ShieldOff",[["path",{d:"M19.7 14a6.9 6.9 0 0 0 .3-2V5l-8-3-3.2 1.2",key:"342pvf"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M4.7 4.7 4 5v7c0 6 8 10 8 10a20.3 20.3 0 0 0 5.62-4.38",key:"p0ycf4"}]]),qy=Lf("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),Hy=Lf("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Gy=e=>{let{value:t=0,status:n="medium",showPercent:i=!1,className:a="",...s}=e;const o=Math.min(100,Math.max(0,t)),l=`progress-${n}`;return(0,r.jsxs)("div",{className:`relative ${a}`,...s,children:[(0,r.jsx)("div",{className:"progress-bar-container",children:(0,r.jsx)("div",{className:`progress-bar-fill ${l}`,style:{width:`${o}%`}})}),i&&(0,r.jsxs)("div",{className:"text-xs font-medium text-gray-700 text-right mt-1",children:[o,"%"]})]})},Ky=e=>{let{status:t="active",text:n,icon:i,className:a="",...s}=e;const o=`status-${t}`;return(0,r.jsxs)("span",{className:`status-indicator ${o} ${a}`,...s,children:[i&&(0,r.jsx)("span",{className:"mr-1",children:i}),n]})},Qy=e=>{var t,n;let{project:a,onAdvance:s,onAssignStaff:o,onDetails:l,onSell:c,onApplyIllegalMethod:u,onAccelerate:h}=e;const{state:p}=d(),{showNotification:m}=mf(),[f,y]=(0,i.useState)(!1);if(!a)return null;const g=e=>e>=1e6?`${(e/1e6).toFixed(2)} mln z\u0142`:e>=1e3?`${(e/1e3).toFixed(1)} tys. z\u0142`:`${e} z\u0142`,v=()=>"ready_to_build"===a.status?100:Math.min(100,Math.round(a.progress)),w={land_acquisition:{index:0,label:"Grunty"},environmental_decision:{index:1,label:"\u015arodowisko"},zoning_conditions:{index:2,label:"Warunki zabudowy"},grid_connection:{index:3,label:"Przy\u0142\u0105czenie"},ready_to_build:{index:4,label:"RTB"}},x=()=>{const e=25e4*a.power,t={land_acquisition:.15,environmental_decision:.35,zoning_conditions:.55,grid_connection:.85,ready_to_build:1}[a.status]||.1,n=a.progress/100*.2;return Math.round(e*(t+n))},b=()=>x()-a.totalCost,j=e=>{if(!u)return void m("Funkcja u\u017cywania nielegalnych metod nie jest dost\u0119pna","error");if(p.reputation<30)return void m("Reputacja jest zbyt niska, aby ryzykowa\u0107 kolejne nielegalne dzia\u0142ania","error");let t=0;switch(e){case"bribe_official":t=25e3+1e3*a.power;break;case"forge_documents":t=15e3+500*a.power;break;case"pressure_officials":t=3e4+2e3*a.power;break;default:t=2e4}p.cash<t?m(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w na t\u0119 akcj\u0119 (${t.toLocaleString()} z\u0142)`,"error"):(u(a.id,e,t),y(!1))};return(0,r.jsxs)("div",{className:"bg-white rounded shadow-md overflow-hidden flex flex-col h-full",children:[(0,r.jsxs)("div",{className:"p-3 border-b bg-gray-50 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"font-medium",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(e=>{switch(e){case"PV":return(0,r.jsx)($f,{className:"h-4 w-4 text-yellow-500"});case"WF":return(0,r.jsx)(Cy,{className:"h-4 w-4 text-blue-500"});case"BESS":return(0,r.jsx)(By,{className:"h-4 w-4 text-purple-500"});default:return null}})(a.technology),(0,r.jsx)("span",{className:"ml-1",children:a.name}),a.useIllegalMethods&&(0,r.jsx)("div",{className:"ml-2 text-red-500",title:"Ten projekt wykorzystuje nielegalne metody",children:(0,r.jsx)(Wy,{className:"h-4 w-4"})})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 flex items-center",children:[(0,r.jsx)(Py,{className:"h-3 w-3 mr-1"}),a.county?`${a.county.name}, ${a.region}`:a.region]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"font-bold flex items-center justify-end",children:[a.power," MW"]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 flex items-center justify-end",children:[(0,r.jsx)(Ff,{className:"h-3 w-3 mr-1"})," Tura ",a.startedOn]})]})]}),(0,r.jsxs)("div",{className:"px-4 py-3",children:[(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[(0,r.jsxs)("span",{children:["Etap: ",Ay(a.status)]}),(0,r.jsxs)("span",{children:[v(),"%"]})]}),(0,r.jsx)(Gy,{value:v(),status:a.useIllegalMethods?"warning":v()>=75?"high":v()>=30?"medium":"low"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[(0,r.jsx)("span",{children:"Ca\u0142kowity post\u0119p"}),(0,r.jsxs)("span",{children:[20*(null===(t=w[a.status])||void 0===t?void 0:t.index)+v()/5,"%"]})]}),(0,r.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"h-full "+(a.useIllegalMethods?"bg-amber-500":"bg-blue-500"),style:{width:20*(null===(n=w[a.status])||void 0===n?void 0:n.index)+v()/5+"%"}})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-4 text-xs",children:[(0,r.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,r.jsx)("div",{className:"text-gray-500",children:"Ca\u0142kowity koszt"}),(0,r.jsx)("div",{className:"font-medium",children:g(a.totalCost)})]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,r.jsx)("div",{className:"text-gray-500",children:"Szacowana warto\u015b\u0107"}),(0,r.jsx)("div",{className:"font-medium",children:g(x())})]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,r.jsx)("div",{className:"text-gray-500",children:"Potencjalny zysk"}),(0,r.jsxs)("div",{className:"font-medium "+(b()>=0?"text-green-600":"text-red-600"),children:[g(b())," (",(()=>{const e=b();return 0===a.totalCost?0:Math.round(e/a.totalCost*100)})(),"%)"]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,r.jsx)("div",{className:"text-gray-500",children:"Status"}),(0,r.jsx)("div",{className:"font-medium",children:(0,r.jsx)(Ky,{status:(k=a.status,N=a.progress,"ready_to_build"===k?"completed":N<25?"warning":"active"),text:a.progress>=100?"Gotowy do rozwoju":"W trakcie"})})]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap justify-between mt-auto pt-2 border-t",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("button",{onClick:()=>l(a.id),className:"text-xs px-2 py-1 text-gray-600 hover:bg-gray-100 rounded",children:"Szczeg\xf3\u0142y"}),(0,r.jsxs)("button",{onClick:()=>o(a.id),className:"text-xs px-2 py-1 text-gray-600 hover:bg-gray-100 rounded ml-1",children:[(0,r.jsx)(Gf,{className:"h-3 w-3 inline mr-1"}),"Personel"]})]}),(0,r.jsxs)("div",{className:"relative",children:[f&&(0,r.jsxs)("div",{className:"absolute bottom-8 right-0 bg-white shadow-md rounded border p-2 w-48 z-10",children:[(0,r.jsxs)("div",{className:"text-xs font-medium mb-2 text-red-600 flex items-center",children:[(0,r.jsx)(Wy,{className:"h-3 w-3 mr-1"}),"Dzia\u0142ania niejawne"]}),(0,r.jsx)("button",{onClick:()=>j("bribe_official"),className:"text-xs w-full text-left p-1 hover:bg-red-50 text-gray-700 mb-1 rounded",children:"\u0141ap\xf3wka dla urz\u0119dnika (25k+ z\u0142)"}),(0,r.jsx)("button",{onClick:()=>j("forge_documents"),className:"text-xs w-full text-left p-1 hover:bg-red-50 text-gray-700 mb-1 rounded",children:"Fa\u0142szowanie dokument\xf3w (15k+ z\u0142)"}),(0,r.jsx)("button",{onClick:()=>j("pressure_officials"),className:"text-xs w-full text-left p-1 hover:bg-red-50 text-gray-700 mb-1 rounded",children:"Naciski na urz\u0119dnik\xf3w (30k+ z\u0142)"}),(0,r.jsx)("button",{onClick:()=>y(!1),className:"text-xs w-full text-left p-1 hover:bg-gray-100 text-gray-500 rounded",children:"Anuluj"})]}),a.progress>=100&&"ready_to_build"!==a.status&&(0,r.jsx)("button",{onClick:()=>s(a.id),className:"text-xs px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600",children:"Nast\u0119pny etap"}),"land_acquisition"!==a.status&&(0,r.jsxs)("button",{onClick:()=>c(a.id),className:"text-xs px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 ml-1",children:[(0,r.jsx)(qy,{className:"h-3 w-3 inline mr-1"}),"Sprzedaj"]}),"ready_to_build"!==a.status&&(0,r.jsx)("button",{onClick:()=>y(!f),className:`text-xs px-2 py-1 ${a.useIllegalMethods?"bg-amber-500":"bg-gray-700"} text-white rounded hover:bg-gray-800 ml-1`,title:a.useIllegalMethods?"Ten projekt ju\u017c u\u017cywa nielegalnych metod":"U\u017cyj nielegalnych metod, aby przyspieszy\u0107 projekt",children:(0,r.jsx)(Hy,{className:"h-3 w-3 inline"})})]})]})]}),(0,r.jsxs)("div",{className:"px-4 py-3 bg-gray-50 flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-xs text-gray-500",children:"Status: "}),(0,r.jsx)("span",{className:"text-sm font-medium "+(a.useIllegalMethods?"text-amber-600":"text-blue-600"),children:Ay(a.status)})]}),"ready_to_build"!==a.status&&(0,r.jsx)(my,{variant:"secondary",size:"sm",onClick:()=>{"function"===typeof h&&h(a.id)},children:"Przyspiesz projekt"})]})]});var k,N},Zy=(Lf("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),Lf("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])),Yy=Lf("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),Jy=Lf("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Xy=Lf("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),eg=Lf("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),tg={filterGroup:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},filterBtn:{padding:"0.375rem 0.75rem",borderRadius:"0.375rem",fontSize:"0.875rem",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",border:"1px solid #e5e7eb",cursor:"pointer",position:"relative"},active:{backgroundColor:"#3b82f6",color:"white",border:"1px solid #2563eb"},badge:{position:"absolute",top:"-8px",right:"-8px",minWidth:"20px",height:"20px",borderRadius:"10px",backgroundColor:"#ef4444",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"bold",padding:"0 6px"}},ng=()=>{const{state:e,dispatch:t}=d(),{state:n,showNotification:a}=mf(),{projects:s,accelerateProject:o,sendProjectToMarket:l,applyIllegalMethod:c,advanceProject:u}=$y(),[h,p]=(Ly(),(0,i.useState)(null)),[m,f]=(0,i.useState)("all"),[y,g]=(0,i.useState)("progress"),[v,w]=(0,i.useState)("desc"),x=(0,i.useMemo)((()=>e.projects.filter((e=>"all"===m||("waiting"===m?"development_ready"===e.status:"pv"===m?"PV"===e.technology:"wf"===m?"WF"===e.technology:"development"===m?"in_development"===e.status:"rtb"!==m||"ready_to_build"===e.status)))),[e.projects,m]),b=(0,i.useMemo)((()=>[...x].sort(((e,t)=>{if("progress"===y){const n=e.progress||0,i=t.progress||0;return"asc"===v?n-i:i-n}if("power"===y)return"asc"===v?e.power-t.power:t.power-e.power;if("stage"===y){const n=["land_acquisition","environmental_decision","zoning_conditions","grid_connection","ready_to_build"],i=n.indexOf(e.status),a=n.indexOf(t.status);return"asc"===v?i-a:a-i}if("value"===y){const n=e=>15e4*e.power*({land_acquisition:.15,environmental_decision:.35,zoning_conditions:.55,grid_connection:.85,ready_to_build:1}[e.status]||.1),i=n(e),a=n(t);return"asc"===v?i-a:a-i}return 0}))),[x,y,v]),j=(0,i.useMemo)((()=>{const t={total:e.projects.length,pv:0,wf:0,rtb:0,development:0,totalPower:0,totalEstimatedValue:0};return e.projects.forEach((e=>{"PV"===e.technology&&t.pv++,"WF"===e.technology&&t.wf++,"ready_to_build"===e.status&&t.rtb++,"ready_to_build"!==e.status&&t.development++,t.totalPower+=e.power||0;const n=15e4*e.power;t.totalEstimatedValue+=n*({land_acquisition:.15,environmental_decision:.35,zoning_conditions:.55,grid_connection:.85,ready_to_build:1}[e.status]||.1)})),t}),[e.projects]),k=t=>{const n=e.projects.find((e=>e.id===t));if(!n)return;let i=0;switch(n.status){case"land_acquisition":i=Math.round(5e3*n.size);break;case"environmental_decision":i=Math.max(5e4,1e4*n.power);break;case"zoning_conditions":i=Math.max(3e4,7e3*n.power);break;case"grid_connection":i=Math.max(8e4,15e3*n.power)}const r=window.prompt(`Podaj kwot\u0119 przyspieszenia projektu (sugerowana: ${i.toLocaleString()} PLN):`,i);if(null===r)return;const s=parseInt(r.replace(/\D/g,""),10);if(isNaN(s)||s<=0)return void a("Nieprawid\u0142owa kwota","error");o(t,s)&&a(`Przyspieszono projekt za ${s.toLocaleString()} PLN`,"success")};return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[(0,r.jsx)(Yy,{className:"h-6 w-6 mr-2 text-blue-600"}),"Podsumowanie projekt\xf3w",e.projects.filter((e=>"development_ready"===e.status)).length>0&&(0,r.jsxs)("span",{style:{marginLeft:"0.5rem",padding:"0.25rem 0.5rem",backgroundColor:"#ef4444",color:"white",borderRadius:"0.375rem",fontSize:"0.75rem",fontWeight:"bold"},children:[e.projects.filter((e=>"development_ready"===e.status)).length," projekt(\xf3w) czeka na developera"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-3 mb-4",children:[(0,r.jsxs)("div",{className:"bg-blue-50 p-3 rounded-md",children:[(0,r.jsx)("div",{className:"text-xs text-blue-800",children:"Wszystkie projekty"}),(0,r.jsx)("div",{className:"text-xl font-bold text-blue-900",children:j.total})]}),(0,r.jsxs)("div",{className:"bg-yellow-50 p-3 rounded-md",children:[(0,r.jsx)("div",{className:"text-xs text-yellow-800",children:"Fotowoltaika (PV)"}),(0,r.jsx)("div",{className:"text-xl font-bold text-yellow-900",children:j.pv})]}),(0,r.jsxs)("div",{className:"bg-green-50 p-3 rounded-md",children:[(0,r.jsx)("div",{className:"text-xs text-green-800",children:"Farmy wiatrowe (WF)"}),(0,r.jsx)("div",{className:"text-xl font-bold text-green-900",children:j.wf})]}),(0,r.jsxs)("div",{className:"bg-purple-50 p-3 rounded-md",children:[(0,r.jsx)("div",{className:"text-xs text-purple-800",children:"W developmencie"}),(0,r.jsx)("div",{className:"text-xl font-bold text-purple-900",children:j.development})]}),(0,r.jsxs)("div",{className:"bg-indigo-50 p-3 rounded-md",children:[(0,r.jsx)("div",{className:"text-xs text-indigo-800",children:"Ready-to-Build"}),(0,r.jsx)("div",{className:"text-xl font-bold text-indigo-900",children:j.rtb})]}),(0,r.jsxs)("div",{className:"bg-red-50 p-3 rounded-md",children:[(0,r.jsx)("div",{className:"text-xs text-red-800",children:"Moc ca\u0142kowita"}),(0,r.jsxs)("div",{className:"text-xl font-bold text-red-900",children:[j.totalPower," MW"]})]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4 items-center text-sm",children:[(0,r.jsx)("div",{className:"font-medium",children:"Filtruj:"}),(0,r.jsxs)("div",{style:tg.filterGroup,children:[(0,r.jsx)("button",{style:{...tg.filterBtn,..."all"===m?tg.active:{}},onClick:()=>f("all"),children:"Wszystkie"}),(0,r.jsxs)("button",{style:{...tg.filterBtn,..."waiting"===m?tg.active:{}},onClick:()=>f("waiting"),children:["Oczekuj\u0105ce na developera",e.projects.filter((e=>"development_ready"===e.status)).length>0&&(0,r.jsx)("span",{style:tg.badge,children:e.projects.filter((e=>"development_ready"===e.status)).length})]}),(0,r.jsx)("button",{style:{...tg.filterBtn,..."development"===m?tg.active:{}},onClick:()=>f("development"),children:"W rozwoju"}),(0,r.jsx)("button",{style:{...tg.filterBtn,..."rtb"===m?tg.active:{}},onClick:()=>f("rtb"),children:"Gotowe do budowy"})]}),(0,r.jsx)("div",{className:"font-medium ml-4",children:"Sortuj:"}),(0,r.jsxs)("select",{value:y,onChange:e=>g(e.target.value),className:"border rounded px-2 py-1 text-sm",children:[(0,r.jsx)("option",{value:"progress",children:"Post\u0119p"}),(0,r.jsx)("option",{value:"power",children:"Moc (MW)"}),(0,r.jsx)("option",{value:"stage",children:"Etap"}),(0,r.jsx)("option",{value:"value",children:"Warto\u015b\u0107"})]}),(0,r.jsx)("button",{onClick:()=>w("asc"===v?"desc":"asc"),className:"border rounded px-2 py-1 flex items-center",children:"asc"===v?(0,r.jsx)(Jy,{className:"h-4 w-4"}):(0,r.jsx)(Xy,{className:"h-4 w-4"})})]}),b.length>0?(0,r.jsx)("div",{className:"space-y-3",children:b.map((e=>(0,r.jsx)(Qy,{project:e,onAdvance:()=>u(e.id),onAccelerate:k,onApplyIllegalMethod:t=>c(e.id,t)},e.id)))}):(0,r.jsxs)("div",{className:"bg-gray-50 p-8 rounded-lg text-center",children:[(0,r.jsx)("div",{className:"text-gray-400 mb-3",children:(0,r.jsx)(eg,{className:"h-10 w-10 mx-auto"})}),(0,r.jsx)("p",{className:"text-gray-600",children:"Brak projekt\xf3w spe\u0142niaj\u0105cych kryteria filtrowania"}),(0,r.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:"Zmie\u0144 filtry lub rozpocznij nowe projekty"})]})]})},ig=e=>{let{title:t,isOpen:n,onClose:a,children:s,variant:o="default"}=e;if(!n)return null;const l=(0,i.useRef)(null),c=e=>{l.current&&!l.current.contains(e.target)&&a()};(0,i.useEffect)((()=>(document.addEventListener("mousedown",c),()=>{document.removeEventListener("mousedown",c)})),[]);return(0,r.jsxs)("div",{ref:l,className:`fixed top-0 right-0 h-full w-96 shadow-lg border-l-4 z-30 transition-all duration-300 ease-in-out ${(()=>{switch(o){case"illegal":return"border-l-red-600 bg-red-50";case"staff":return"border-l-blue-600 bg-blue-50";case"project":return"border-l-green-600 bg-green-50";case"finance":return"border-l-purple-600 bg-purple-50";default:return"border-l-gray-600 bg-gray-50"}})()}`,style:{transform:n?"translateX(0)":"translateX(100%)",overflowY:"auto"},children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,r.jsx)("h2",{className:"text-xl font-bold break-words",children:t}),(0,r.jsx)("button",{onClick:a,className:"p-1 rounded-full hover:bg-gray-200 transition-colors",children:(0,r.jsx)(vy,{size:20})})]}),(0,r.jsx)("div",{className:"p-4 overflow-hidden",children:s})]})},ag=Lf("FileX",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"9.5",x2:"14.5",y1:"12.5",y2:"17.5",key:"izs6du"}],["line",{x1:"14.5",x2:"9.5",y1:"12.5",y2:"17.5",key:"1lehlj"}]]),rg=Lf("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),sg=Lf("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]),og=Lf("ShieldAlert",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]),lg=Lf("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),cg=Lf("ActivitySquare",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M17 12h-2l-2 5-2-10-2 5H7",key:"15hlnc"}]]),dg=e=>{let{onClose:t}=e;const{state:n,dispatch:a}=d(),{state:s,showNotification:o}=mf(),{dispatch:l}=q(),[c,u]=(0,i.useState)(null),[h,p]=(0,i.useState)(null),m=new ry(n,a,s);(0,i.useEffect)((()=>{p(m.getGrayAreaStatus())}),[n.illegals,n.reputationFactors]);const f=[{id:"bribe_officials",name:"Przekupstwo urz\u0119dnik\xf3w",description:"Wykorzystaj \u0142ap\xf3wki, aby przyspieszy\u0107 proces administracyjny i uzyska\u0107 przychylne decyzje.",icon:(0,r.jsx)(Vf,{className:"h-5 w-5 text-yellow-600"}),riskLevel:"high",cost:5e4,reputation:-10,effects:"Przyspiesza proces uzyskiwania decyzji administracyjnych o 40% dla wskazanego projektu.",requirements:"Minimum 100 000 PLN i reputacja > 30",details:"Przekupstwo urz\u0119dnik\xf3w to powszechna praktyka w krajach o wysokim poziomie korupcji. W sektorze OZE mo\u017ce dotyczy\u0107 przyspieszenia wydania decyzji \u015brodowiskowych, warunk\xf3w zabudowy lub przy\u0142\u0105czenia do sieci.",requiredCorruption:10,targetType:"project"},{id:"falsify_documents",name:"Fa\u0142szowanie dokumentacji",description:"Zmodyfikuj dokumentacj\u0119 techniczn\u0105 lub \u015brodowiskow\u0105, aby ukry\u0107 potencjalne problemy.",icon:(0,r.jsx)(ag,{className:"h-5 w-5 text-red-600"}),riskLevel:"extreme",cost:1e5,reputation:-20,effects:"Eliminuje negatywne czynniki techniczne lub \u015brodowiskowe blokuj\u0105ce rozw\xf3j projektu.",requirements:"Konieczne posiadanie nielegalnej bazy danych i reputacja > 50",details:"Fa\u0142szowanie dokumentacji to powa\u017cne przest\u0119pstwo, kt\xf3re mo\u017ce dotyczy\u0107 raport\xf3w oddzia\u0142ywania na \u015brodowisko, bada\u0144 ornitologicznych lub dokumentacji technicznej. Wykrycie mo\u017ce skutkowa\u0107 nie tylko karami finansowymi, ale nawet odpowiedzialno\u015bci\u0105 karn\u0105.",requiredCorruption:30,targetType:"project"},{id:"insider_info",name:"Informacje poufne",description:"Uzyskaj dost\u0119p do poufnych informacji o planach przestrzennych i aukcjach energii.",icon:(0,r.jsx)(dy,{className:"h-5 w-5 text-blue-600"}),riskLevel:"medium",cost:25e3,reputation:-5,effects:"Udost\u0119pnia informacje o najlepszych lokalizacjach i nadchodz\u0105cych aukcjach, zwi\u0119kszaj\u0105c szanse sukcesu.",requirements:"Posiadanie co najmniej jednego lobbysty",details:"Wykorzystanie informacji poufnych to dzia\u0142alno\u015b\u0107 na granicy prawa, kt\xf3ra polega na uzyskiwaniu dost\u0119pu do niepublicznych danych o planach zagospodarowania, przetargach czy zmianach regulacyjnych. Mo\u017ce dawa\u0107 znacz\u0105c\u0105 przewag\u0119 konkurencyjn\u0105.",requiredCorruption:5,targetType:"company"},{id:"intimidate_landowners",name:"Zastraszanie w\u0142a\u015bcicieli grunt\xf3w",description:"Wywieranie presji na w\u0142a\u015bcicieli grunt\xf3w, aby sprzedali ziemi\u0119 po zani\u017conej cenie.",icon:(0,r.jsx)(rg,{className:"h-5 w-5 text-purple-600"}),riskLevel:"high",cost:3e4,reputation:-15,effects:"Obni\u017ca koszty zakupu grunt\xf3w o 30-50%.",requirements:"Reputacja > 40",details:"Zastraszanie w\u0142a\u015bcicieli grunt\xf3w to metoda nieetyczna i nielegalna, stosowana przez nieuczciwych deweloper\xf3w. Polega na wywieraniu presji poprzez gro\u017aby lub wykorzystywanie luk prawnych, aby zmusi\u0107 w\u0142a\u015bcicieli do sprzeda\u017cy po zani\u017conych cenach.",requiredCorruption:20,targetType:"project"},{id:"build_corruption_network",name:"Budowa sieci korupcyjnej",description:"Rozwijaj sie\u0107 kontakt\xf3w w urz\u0119dach i instytucjach kontrolnych, aby u\u0142atwi\u0107 przysz\u0142e dzia\u0142ania.",icon:(0,r.jsx)(sg,{className:"h-5 w-5 text-green-600"}),riskLevel:"medium",cost:2e5,reputation:-10,effects:"Zwi\u0119ksza poziom sieci korupcyjnej o 10 punkt\xf3w, obni\u017caj\u0105c koszty przysz\u0142ych nielegalnych dzia\u0142a\u0144.",requirements:"Minimum 200 000 PLN",details:"Budowa sieci korupcyjnej to d\u0142ugofalowa inwestycja w nieformalne kontakty z urz\u0119dnikami, politykami i przedstawicielami instytucji kontrolnych. Im silniejsza sie\u0107, tym \u0142atwiejsze i ta\u0144sze staj\u0105 si\u0119 przysz\u0142e nielegalne dzia\u0142ania.",requiredCorruption:0,targetType:"company"},{id:"sabotage_competitors",name:"Sabota\u017c konkurencji",description:"Zlecenie dzia\u0142a\u0144 sabota\u017cowych przeciwko konkurencyjnym projektom w regionie.",icon:(0,r.jsx)(og,{className:"h-5 w-5 text-orange-600"}),riskLevel:"extreme",cost:15e4,reputation:-25,effects:"Op\xf3\u017ania projekty konkurencji w regionie o 3-6 miesi\u0119cy.",requirements:"Reputacja > 60 i poziom sieci korupcyjnej > 30",details:"Sabota\u017c konkurencji to bezpo\u015brednie dzia\u0142ania wymierzone w projekty konkurencyjnych firm. Mo\u017ce obejmowa\u0107 manipulowanie konsultacjami spo\u0142ecznymi, sztuczne wywo\u0142ywanie protest\xf3w lub nawet fizyczne uszkodzenia infrastruktury. Niesie wysokie ryzyko wykrycia i powa\u017cnych konsekwencji prawnych.",requiredCorruption:40,targetType:"region"},{id:"create_illegal_database",name:"Stw\xf3rz nielegaln\u0105 baz\u0119 danych",description:"Zlecenie stworzenia bazy danych zawieraj\u0105cej poufne informacje o urz\u0119dnikach, planach i procedurach.",icon:(0,r.jsx)(lg,{className:"h-5 w-5 text-gray-600"}),riskLevel:"low",cost:75e3,reputation:-5,effects:"Odblokowuje dodatkowe nielegalne akcje i zwi\u0119ksza skuteczno\u015b\u0107 istniej\u0105cych o 20%.",requirements:"Minimum 75 000 PLN",details:"Nielegalna baza danych to zbi\xf3r poufnych informacji o urz\u0119dnikach, procedurach i lukach prawnych. Jej posiadanie umo\u017cliwia bardziej precyzyjne planowanie nielegalnych dzia\u0142a\u0144 i zwi\u0119ksza ich skuteczno\u015b\u0107. Pozyskanie takich danych wymaga zaanga\u017cowania os\xf3b z dost\u0119pem do poufnych informacji.",requiredCorruption:0,targetType:"company"}],y=e=>!(e.requirements.includes("minimum")&&n.cash<e.cost)&&(!(e.requirements.includes("reputacja")&&n.reputation<parseInt(e.requirements.match(/reputacja > (\d+)/)[1]))&&(!(e.requiredCorruption>n.illegals.corruptionNetwork)&&(!("falsify_documents"===e.id&&!n.illegals.hasIllegalDatabase)&&(("insider_info"!==e.id||0!==n.staff.lobbyists.length)&&("create_illegal_database"!==e.id||!n.illegals.hasIllegalDatabase))))),g=e=>{switch(e){case"low":return(0,r.jsx)("span",{className:"text-green-600 font-medium",children:"Niskie"});case"medium":return(0,r.jsx)("span",{className:"text-yellow-600 font-medium",children:"\u015arednie"});case"high":return(0,r.jsx)("span",{className:"text-orange-600 font-medium",children:"Wysokie"});case"extreme":return(0,r.jsx)("span",{className:"text-red-600 font-medium",children:"Ekstremalne"});default:return(0,r.jsx)("span",{className:"text-gray-600",children:"Nieznane"})}},v=e=>{const t=y(e);return(0,r.jsxs)("div",{className:"border rounded-lg p-4 mb-4 hover:shadow-md transition-shadow",children:[(0,r.jsxs)("div",{className:"flex items-start mb-2",children:[(0,r.jsx)("div",{className:"mr-3",children:e.icon}),(0,r.jsxs)("div",{className:"flex-grow",children:[(0,r.jsx)("h3",{className:"font-bold text-gray-800",children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]}),(0,r.jsxs)("div",{className:"ml-2 text-right",children:[(0,r.jsxs)("div",{className:"text-sm mb-1",children:["Ryzyko: ",g(e.riskLevel)]}),(0,r.jsxs)("div",{className:"text-sm",children:["Koszt: ",(0,r.jsxs)("span",{className:"font-medium",children:[e.cost.toLocaleString()," PLN"]})]})]})]}),(0,r.jsxs)("div",{className:"mt-2 space-y-2 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Efekt:"})," ",e.effects]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Wymagania:"})," ",e.requirements]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Wp\u0142yw na reputacj\u0119:"})," ",(0,r.jsx)("span",{className:"text-red-600",children:e.reputation})]})]}),(0,r.jsx)("div",{className:"mt-3",children:(0,r.jsx)(my,{onClick:()=>(e=>{if(!y(e))return void o("Nie mo\u017cesz wykona\u0107 tej akcji - nie spe\u0142niasz wymaga\u0144!","error");if(n.cash<e.cost)return void o(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w (potrzeba ${e.cost.toLocaleString()} PLN)`,"error");const t=m.executeIllegalAction(e.id,{cost:e.cost,target:e.targetType,riskIncrease:"extreme"===e.riskLevel?20:"high"===e.riskLevel?15:"medium"===e.riskLevel?10:5});if(t.success){switch(e.id){case"create_illegal_database":a({type:"UPDATE_ILLEGAL_DATABASE",payload:{hasIllegalDatabase:!0}}),l({type:"ADD_EVENT",payload:{id:Date.now(),type:"illegal_activity",title:"Stworzenie nielegalnej bazy danych",description:"Stworzy\u0142e\u015b nielegaln\u0105 baz\u0119 danych, kt\xf3ra umo\u017cliwi Ci bardziej skuteczne planowanie nielegalnych dzia\u0142a\u0144.",severity:"warning",turn:s.turn,expires:s.turn+10}}),o("Stworzy\u0142e\u015b nielegaln\u0105 baz\u0119 danych!","success");break;case"build_corruption_network":l({type:"ADD_EVENT",payload:{id:Date.now(),type:"illegal_activity",title:"Rozbudowa sieci korupcyjnej",description:"Rozwin\u0105\u0142e\u015b swoj\u0105 sie\u0107 kontakt\xf3w korupcyjnych, co u\u0142atwi Ci przysz\u0142e nielegalne dzia\u0142ania.",severity:"warning",turn:s.turn,expires:s.turn+15}}),o("Rozbudowa\u0142e\u015b swoj\u0105 sie\u0107 korupcyjn\u0105!","success");break;default:u(e)}p(m.getGrayAreaStatus()),t.detected&&(o(t.consequences,"warning"),l({type:"ADD_EVENT",payload:{id:Date.now(),type:"scandal",title:`Wykryto nielegalne dzia\u0142anie: ${e.name}`,description:"Twoje nielegalne dzia\u0142anie zosta\u0142o wykryte, co znacz\u0105co wp\u0142yn\u0119\u0142o na reputacj\u0119 firmy.",severity:"danger",turn:s.turn,expires:s.turn+20}}))}else o(t.reason,"error")})(e),disabled:!t,variant:t?"warning":"disabled",className:"w-full",icon:(0,r.jsx)(Hf,{className:"h-4 w-4"}),children:t?"Wykonaj akcj\u0119":"Niedost\u0119pne"})})]})};return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)(Hf,{className:"h-6 w-6 text-red-600 mr-2"}),(0,r.jsx)("h2",{className:"text-xl font-bold",children:"Szara strefa"})]}),(0,r.jsx)("div",{className:"bg-red-100 border border-red-300 rounded-lg p-3 mb-4",children:(0,r.jsxs)("p",{className:"text-red-800 text-sm",children:[(0,r.jsx)("strong",{children:"UWAGA:"})," Dzia\u0142ania w szarej strefie s\u0105 nielegalne i wi\u0105\u017c\u0105 si\u0119 z ryzykiem. Wykrycie mo\u017ce skutkowa\u0107 karami finansowymi, utrat\u0105 reputacji, a nawet zako\u0144czeniem gry."]})}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h3",{className:"font-bold mb-2",children:"Tw\xf3j status:"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("div",{className:"bg-white rounded p-2 shadow-sm",children:[(0,r.jsx)("div",{className:"text-gray-600 text-sm",children:"Sie\u0107 korupcyjna:"}),(0,r.jsxs)("div",{className:"font-medium",children:[n.illegals.corruptionNetwork,"/100"]})]}),(0,r.jsxs)("div",{className:"bg-white rounded p-2 shadow-sm",children:[(0,r.jsx)("div",{className:"text-gray-600 text-sm",children:"Ryzyko audytu:"}),(0,r.jsxs)("div",{className:"font-medium",children:[(null===h||void 0===h?void 0:h.auditRisk)||n.illegals.auditRisk,"%"]})]}),(0,r.jsxs)("div",{className:"bg-white rounded p-2 shadow-sm",children:[(0,r.jsx)("div",{className:"text-gray-600 text-sm",children:"Baza danych:"}),(0,r.jsx)("div",{className:"font-medium",children:n.illegals.hasIllegalDatabase?"Posiadasz":"Brak"})]}),(0,r.jsxs)("div",{className:"bg-white rounded p-2 shadow-sm",children:[(0,r.jsx)("div",{className:"text-gray-600 text-sm",children:"\u0141ap\xf3wki wydane:"}),(0,r.jsxs)("div",{className:"font-medium",children:[n.illegals.totalBribes.toLocaleString()," PLN"]})]})]})]}),n.reputationFactors&&(0,r.jsxs)("div",{className:"mb-4 bg-gray-50 p-3 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h3",{className:"font-bold",children:"Poziom aktywno\u015bci w szarej strefie:"}),(e=>{let t,n,i;return e<=.7?(t="bg-green-100 text-green-800",n=(0,r.jsx)(iy,{className:"h-4 w-4 text-green-600"}),i="Niski"):e<=1?(t="bg-blue-100 text-blue-800",n=(0,r.jsx)(cg,{className:"h-4 w-4 text-blue-600"}),i="Normalny"):e<=1.3?(t="bg-yellow-100 text-yellow-800",n=(0,r.jsx)(ny,{className:"h-4 w-4 text-yellow-600"}),i="Podwy\u017cszony"):(t="bg-red-100 text-red-800",n=(0,r.jsx)(Hf,{className:"h-4 w-4 text-red-600"}),i="Wysoki"),(0,r.jsxs)("div",{className:`flex items-center ${t} px-2 py-1 rounded`,children:[n,(0,r.jsx)("span",{className:"ml-1 text-sm font-medium",children:i})]})})(n.reputationFactors.grayAreaActivity)]}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"h-full "+(n.reputationFactors.grayAreaActivity<=.7?"bg-green-500":n.reputationFactors.grayAreaActivity<=1?"bg-blue-500":n.reputationFactors.grayAreaActivity<=1.3?"bg-yellow-500":"bg-red-500"),style:{width:`${Math.min(100,50*n.reputationFactors.grayAreaActivity)}%`}})})}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Wysoki poziom aktywno\u015bci w szarej strefie zwi\u0119ksza ryzyko audytu i kontroli."})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h3",{className:"font-bold mb-2",children:"Dost\u0119pne akcje:"}),(0,r.jsx)("div",{className:"space-y-3",children:f.map((e=>v(e)))})]}),n.illegals.illegalActionHistory&&n.illegals.illegalActionHistory.length>0&&(0,r.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[(0,r.jsx)("h3",{className:"font-bold mb-2",children:"Historia dzia\u0142a\u0144:"}),(0,r.jsx)("div",{className:"space-y-2",children:n.illegals.illegalActionHistory.slice(-5).reverse().map(((e,t)=>(0,r.jsxs)("div",{className:`p-2 rounded ${e.exposed?"bg-red-100":"bg-white"} text-sm border`,children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:m.getActionName(e.type)}),(0,r.jsx)("span",{className:"text-gray-500",children:new Date(e.date).toLocaleDateString()})]}),(0,r.jsxs)("div",{className:"flex justify-between mt-1",children:[(0,r.jsxs)("span",{className:"text-gray-500",children:["Koszt: ",e.cost.toLocaleString()," PLN"]}),e.exposed&&(0,r.jsx)("span",{className:"text-red-600",children:"Wykryte"})]})]},t)))})]})]})},ug=Lf("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),hg=Lf("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),pg=Lf("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),mg=e=>{var t,n,i,a,s;let{staffId:o,staffType:l,onClose:c,onFire:u,onTrain:h,onAssign:p}=e;const{state:m}=d(),{state:f}=mf(),y=l.endsWith("s")?l:`${l}s`,g=null===(t=m.staff[y])||void 0===t?void 0:t.find((e=>e.id===o));if(!g)return(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("div",{className:"bg-red-100 p-4 rounded",children:(0,r.jsx)("p",{className:"text-red-800",children:"Nie znaleziono pracownika."})}),(0,r.jsx)(my,{onClick:c,className:"mt-4",children:"Zamknij"})]});const v=e=>`${e.toLocaleString()} PLN / mies.`,w=m.projects.find((e=>e.id===g.assignedProject)),x=(null===(n=g.traits)||void 0===n?void 0:n.filter((e=>e.effect>0)))||[],b=(null===(i=g.traits)||void 0===i?void 0:i.filter((e=>e.effect<0)))||[],j=(null===(a=g.traits)||void 0===a?void 0:a.filter((e=>0===e.effect)))||[],k=e=>(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:(e.effect>0?"text-green-600":e.effect<0?"text-red-600":"text-gray-600")+" font-medium mr-2",children:e.name}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:e.description})]},e.name);return(0,r.jsxs)("div",{className:"overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex items-center mb-6",children:[(0,r.jsx)("div",{className:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center mr-4",children:(0,r.jsx)(ug,{className:"h-6 w-6 text-blue-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-bold",children:g.name}),(0,r.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,r.jsx)(Yy,{className:"h-4 w-4 mr-1"}),(0,r.jsxs)("span",{children:[My(l)," (",Dy(g.level),")"]})]})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("h3",{className:"font-bold text-lg mb-2 flex items-center",children:[(0,r.jsx)(hg,{className:"h-5 w-5 mr-2 text-purple-600"}),"Umiej\u0119tno\u015bci i rozw\xf3j"]}),(0,r.jsxs)("div",{className:"bg-white rounded shadow p-4",children:[(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,r.jsx)("span",{className:"text-gray-700",children:"Poziom umiej\u0119tno\u015bci:"}),(0,r.jsxs)("span",{className:"font-medium",children:[g.skill,"/10"]})]}),(0,r.jsx)(Gy,{value:10*g.skill,max:100,colorClass:"bg-purple-500"})]}),(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,r.jsx)("span",{className:"text-gray-700",children:"Do\u015bwiadczenie:"}),(0,r.jsxs)("span",{className:"font-medium",children:[g.experience," pkt"]})]}),(0,r.jsx)(Gy,{value:g.experience%100,max:100,colorClass:"bg-blue-500"}),(0,r.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:["Do awansu: ",100-g.experience%100," pkt"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-gray-700 mb-1",children:"Specjalizacja:"}),(0,r.jsx)("div",{className:"font-medium",children:g.specialization||"Brak"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-gray-700 mb-1",children:"Odbyte szkolenia:"}),(0,r.jsx)("div",{className:"font-medium",children:(null===(s=g.training)||void 0===s?void 0:s.length)||0})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,r.jsx)(my,{onClick:()=>h(o,l),variant:"primary",className:"flex-1",icon:(0,r.jsx)(ny,{className:"h-4 w-4"}),children:"Trenuj"}),(0,r.jsx)(my,{onClick:()=>p(o,l),variant:"secondary",className:"flex-1",icon:(0,r.jsx)(Yy,{className:"h-4 w-4"}),children:"Przydziel do projektu"})]})]}),g.traits&&g.traits.length>0&&(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h3",{className:"font-bold text-lg mb-2",children:"Cechy charakteru"}),(0,r.jsxs)("div",{className:"bg-white rounded shadow p-4",children:[x.length>0&&(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("h4",{className:"font-medium text-green-600 mb-1",children:"Pozytywne:"}),(0,r.jsx)("div",{className:"space-y-1",children:x.map(k)})]}),j.length>0&&(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-600 mb-1",children:"Neutralne:"}),(0,r.jsx)("div",{className:"space-y-1",children:j.map(k)})]}),b.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-red-600 mb-1",children:"Negatywne:"}),(0,r.jsx)("div",{className:"space-y-1",children:b.map(k)})]})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("h3",{className:"font-bold text-lg mb-2 flex items-center",children:[(0,r.jsx)(Uf,{className:"h-5 w-5 mr-2 text-blue-600"}),"Historia zatrudnienia"]}),(0,r.jsxs)("div",{className:"bg-white rounded shadow p-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-gray-700 mb-1",children:"Data zatrudnienia:"}),(0,r.jsx)("div",{className:"font-medium",children:(_=g.hiredOn,new Date(_).toLocaleDateString("pl-PL"))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-gray-700 mb-1",children:"Czas zatrudnienia:"}),(0,r.jsx)("div",{className:"font-medium",children:(()=>{const e=new Date(g.hiredOn),t=new Date,n=Math.abs(t-e),i=Math.ceil(n/864e5);return`${i} dni (${Math.floor(i/30)} miesi\u0119cy)`})()})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-gray-700 mb-1",children:"Wynagrodzenie:"}),(0,r.jsx)("div",{className:"font-medium",children:v(g.salary)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-gray-700 mb-1",children:"Koszt zatrudnienia:"}),(0,r.jsx)("div",{className:"font-medium",children:v(g.hiringCost||0)})]})]}),w&&(0,r.jsxs)("div",{className:"mt-3 p-2 bg-blue-50 rounded",children:[(0,r.jsx)("div",{className:"text-blue-800 font-medium",children:"Przypisany do projektu:"}),(0,r.jsxs)("div",{children:[w.name," (",w.technology,")"]})]})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("h3",{className:"font-bold text-lg mb-2 flex items-center",children:[(0,r.jsx)(pg,{className:"h-5 w-5 mr-2 text-red-600"}),"Status"]}),(0,r.jsx)("div",{className:"bg-white rounded shadow p-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,r.jsx)("span",{children:"Morale:"}),(0,r.jsxs)("span",{className:(z=g.morale,z>=80?"text-green-600":z>=50?"text-blue-600":z>=30?"text-yellow-600":"text-red-600"),children:[g.morale,"%"]})]}),(0,r.jsx)(Gy,{value:g.morale,max:100,colorClass:g.morale>=50?"bg-green-500":"bg-red-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,r.jsx)("span",{children:"Energia:"}),(0,r.jsxs)("span",{className:(N=g.energy,N>=80?"text-green-600":N>=50?"text-blue-600":N>=30?"text-yellow-600":"text-red-600"),children:[g.energy,"%"]})]}),(0,r.jsx)(Gy,{value:g.energy,max:100,colorClass:g.energy>=50?"bg-blue-500":"bg-orange-500"})]})]})})]}),(0,r.jsxs)("div",{className:"mt-6 flex justify-between",children:[(0,r.jsx)(my,{onClick:()=>u(o,l),variant:"danger",icon:(0,r.jsx)(rg,{className:"h-4 w-4"}),children:"Zwolnij pracownika"}),(0,r.jsx)(my,{onClick:c,variant:"secondary",children:"Zamknij"})]})]});var N,z,_},fg=e=>{let{onClose:t}=e;const{state:n,dispatch:a}=d(),{state:s,showNotification:o}=mf(),[l,c]=(0,i.useState)(null),[u,h]=(0,i.useState)(1e6),[p,m]=(0,i.useState)(12),f=(0,i.useRef)(null),y=e=>{f.current&&!f.current.contains(e.target)&&t()};(0,i.useEffect)((()=>(document.addEventListener("mousedown",y),()=>{document.removeEventListener("mousedown",y)})),[]);const g=e=>!(e.requiresProjects>0&&n.projects.length<e.requiresProjects)&&(!(e.requiresReputation>0&&n.reputation<e.requiresReputation)&&(!(e.requiresRTB&&!n.projects.some((e=>"ready_to_build"===e.status)))&&!(e.requiresCorruption&&n.illegals.corruptionNetwork<e.requiresCorruption))),v=e=>{let t=e.baseInterestRate;e.reputationBonus&&n.reputation>80&&(t-=.01);const i=n.projects.filter((e=>"ready_to_build"===e.status)).length;return i>0&&(t-=.005*i),Math.max(.05,t)},w=(e,t,n)=>{const i=t/12;return e*i/(1-Math.pow(1+i,-n))},x=e=>e.toLocaleString()+" PLN",b=e=>(100*e).toFixed(2)+"%";return(0,r.jsxs)("div",{ref:f,children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)(qy,{className:"h-6 w-6 text-green-600 mr-2"}),(0,r.jsx)("h2",{className:"text-xl font-bold",children:"Panel finansowy"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,r.jsx)("h3",{className:"font-bold mb-3",children:"Twoje finanse"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-gray-600 text-sm",children:"Got\xf3wka:"}),(0,r.jsx)("div",{className:"font-bold text-lg text-green-700",children:x(n.cash)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-gray-600 text-sm",children:"Warto\u015b\u0107 projekt\xf3w:"}),(0,r.jsx)("div",{className:"font-bold text-lg",children:x(n.economicMetrics.projectsValue||0)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-gray-600 text-sm",children:"Przychody:"}),(0,r.jsx)("div",{className:"font-bold text-green-700",children:x(n.economicMetrics.totalRevenue||0)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-gray-600 text-sm",children:"Wydatki:"}),(0,r.jsx)("div",{className:"font-bold text-red-700",children:x(n.economicMetrics.totalExpenses||0)})]})]})]}),n.loans&&n.loans.length>0&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,r.jsx)("h3",{className:"font-bold mb-3",children:"Aktywne kredyty"}),n.loans.map((e=>(0,r.jsxs)("div",{className:"border-b pb-3 mb-3 last:border-0 last:mb-0 last:pb-0",children:[(0,r.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,r.jsx)("span",{className:"font-medium",children:e.bankName}),(0,r.jsx)("span",{className:"text-blue-600",children:x(e.remainingAmount)})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Rata miesi\u0119czna:"}),(0,r.jsx)("span",{className:"ml-1",children:x(e.monthlyPayment)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Oprocentowanie:"}),(0,r.jsx)("span",{className:"ml-1",children:b(e.interestRate)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Pozosta\u0142o rat:"}),(0,r.jsx)("span",{className:"ml-1",children:e.remainingTerm})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Nast\u0119pna p\u0142atno\u015b\u0107:"}),(0,r.jsxs)("span",{className:"ml-1",children:["Tura ",e.nextPaymentTurn]})]})]}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-xs mb-1",children:[(0,r.jsx)("span",{children:"Sp\u0142acono"}),(0,r.jsxs)("span",{children:[Math.round(100*(1-e.remainingAmount/e.amount)),"%"]})]}),(0,r.jsx)(Gy,{value:e.amount-e.remainingAmount,max:e.amount,colorClass:"bg-green-500"})]})]},e.id)))]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,r.jsx)("h3",{className:"font-bold mb-3",children:"Zaci\u0105gnij kredyt"}),l?(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[(0,r.jsx)(gy,{className:"h-5 w-5 text-blue-600 mr-2"}),(0,r.jsx)("h4",{className:"font-bold text-blue-800 break-words",children:l.name})]}),(0,r.jsx)("p",{className:"text-sm text-gray-700 break-words",children:l.description})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 mb-1",children:"Kwota kredytu"}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"range",min:1e5,max:l.maxLoan,step:1e5,value:u,onChange:e=>h(parseInt(e.target.value)),className:"flex-grow mr-3"}),(0,r.jsx)("span",{className:"font-medium w-32 text-right",children:x(u)})]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 mb-1",children:"Okres sp\u0142aty (miesi\u0105ce)"}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"range",min:3,max:36,step:3,value:p,onChange:e=>m(parseInt(e.target.value)),className:"flex-grow mr-3"}),(0,r.jsxs)("span",{className:"font-medium w-32 text-right",children:[p," mies."]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-3 rounded mb-4",children:[(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Podsumowanie kredytu"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("div",{className:"text-sm overflow-hidden",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Kwota kredytu:"}),(0,r.jsx)("span",{className:"ml-1 font-medium whitespace-nowrap",children:x(u)})]}),(0,r.jsxs)("div",{className:"text-sm overflow-hidden",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Okres sp\u0142aty:"}),(0,r.jsxs)("span",{className:"ml-1 font-medium whitespace-nowrap",children:[p," miesi\u0119cy"]})]}),(0,r.jsxs)("div",{className:"text-sm overflow-hidden",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Oprocentowanie:"}),(0,r.jsx)("span",{className:"ml-1 font-medium whitespace-nowrap",children:b(v(l))})]}),(0,r.jsxs)("div",{className:"text-sm overflow-hidden",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Rata miesi\u0119czna:"}),(0,r.jsx)("span",{className:"ml-1 font-medium whitespace-nowrap",children:x(w(u,v(l),p))})]}),(0,r.jsxs)("div",{className:"text-sm col-span-2 overflow-hidden",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Ca\u0142kowity koszt kredytu:"}),(0,r.jsx)("span",{className:"ml-1 font-medium text-red-600 whitespace-nowrap",children:x(w(u,v(l),p)*p-u)})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(my,{onClick:()=>{if(!l)return void o("Wybierz bank, aby zaci\u0105gn\u0105\u0107 kredyt","error");if(!g(l))return void o("Nie spe\u0142niasz wymaga\u0144 tego banku","error");if(u>l.maxLoan)return void o(`Maksymalna kwota kredytu to ${l.maxLoan.toLocaleString()} PLN`,"error");if(n.loans&&n.loans.length>0)return void o("Mo\u017cesz mie\u0107 tylko jeden aktywny kredyt","error");const e=v(l),t=w(u,e,p),i=t*p,r=i-u;a({type:"ADD_LOAN",payload:{id:Date.now(),bankId:l.id,bankName:l.name,amount:u,remainingAmount:u,interestRate:e,term:p,remainingTerm:p,monthlyPayment:t,totalInterest:r,totalPayment:i,takenOnTurn:s.turn,nextPaymentTurn:s.turn+1}}),a({type:"UPDATE_CASH",payload:u}),a({type:"UPDATE_ECONOMIC_METRICS",payload:{totalLoansTaken:(n.economicMetrics.totalLoansTaken||0)+u}}),l.reputationPenalty&&a({type:"UPDATE_REPUTATION",payload:{change:-l.reputationPenalty,reason:`Zaci\u0105gni\u0119cie kredytu w ${l.name}`,turn:s.turn}}),o(`Zaci\u0105gni\u0119to kredyt na kwot\u0119 ${u.toLocaleString()} PLN`,"success"),c(null)},variant:"success",className:"flex-1",icon:(0,r.jsx)(Ty,{className:"h-4 w-4"}),children:"Zaci\u0105gnij kredyt"}),(0,r.jsx)(my,{onClick:()=>c(null),variant:"secondary",className:"flex-1",children:"Anuluj"})]})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-700 mb-4",children:"Wybierz bank, aby zaci\u0105gn\u0105\u0107 kredyt:"}),(0,r.jsx)("div",{className:"space-y-3",children:[{id:"eco_bank",name:"EcoBank",description:"Bank specjalizuj\u0105cy si\u0119 w finansowaniu projekt\xf3w OZE",maxLoan:5e6,baseInterestRate:.08,reputationBonus:!0,requirementsDescription:"Wymaga min. 3 projekt\xf3w i reputacji > 70",requiresProjects:3,requiresReputation:70},{id:"investment_bank",name:"InvestBank",description:"Du\u017cy bank komercyjny z programem dla projekt\xf3w energetycznych",maxLoan:1e7,baseInterestRate:.095,reputationBonus:!0,requirementsDescription:"Wymaga min. 5 projekt\xf3w i reputacji > 50, lub projektu RTB",requiresProjects:5,requiresReputation:50,requiresRTB:!0},{id:"small_bank",name:"LocalBank",description:"Mniejszy bank lokalny, mniej wymagaj\u0105cy, ale dro\u017csza oferta",maxLoan:2e6,baseInterestRate:.12,reputationBonus:!1,requirementsDescription:"Brak szczeg\xf3lnych wymaga\u0144",requiresProjects:0,requiresReputation:0},{id:"shadow_bank",name:"ShadowFinance",description:"Nieoficjalne \u017ar\xf3d\u0142o finansowania, wysokie odsetki, brak formalno\u015bci",maxLoan:15e5,baseInterestRate:.25,reputationBonus:!1,reputationPenalty:5,requirementsDescription:"Wymaga poziomu sieci korupcyjnej > 20",requiresCorruption:20}].map((e=>{const t=g(e),n=v(e);return(0,r.jsx)("div",{className:"border rounded-lg p-4 mb-4 hover:shadow-md transition-shadow "+((null===l||void 0===l?void 0:l.id)===e.id?"border-blue-500 bg-blue-50":""),onClick:()=>t&&c(e),children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"mr-3",children:(0,r.jsx)(gy,{className:"h-6 w-6 "+(t?"text-blue-600":"text-gray-400")})}),(0,r.jsxs)("div",{className:"flex-grow overflow-hidden",children:[(0,r.jsx)("h3",{className:`font-bold ${t?"text-gray-800":"text-gray-500"} text-ellipsis overflow-hidden`,children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray-600 break-words",children:e.description}),(0,r.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[(0,r.jsxs)("div",{className:"overflow-hidden",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Max kredyt:"}),(0,r.jsx)("span",{className:"ml-1 font-medium whitespace-nowrap",children:x(e.maxLoan)})]}),(0,r.jsxs)("div",{className:"overflow-hidden",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Oprocentowanie:"}),(0,r.jsx)("span",{className:`ml-1 font-medium ${n>.15?"text-red-600":"text-blue-600"} whitespace-nowrap`,children:b(n)})]})]}),(0,r.jsxs)("div",{className:"mt-1 text-sm overflow-hidden",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Wymagania:"}),(0,r.jsx)("span",{className:`ml-1 ${t?"text-green-600":"text-red-600"} break-words`,children:t?"Spe\u0142nione":e.requirementsDescription})]})]})]})},e.id)}))})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,r.jsxs)("h3",{className:"font-bold mb-3 flex items-center",children:[(0,r.jsx)(Kf,{className:"h-5 w-5 mr-2 text-purple-600"}),"Statystyki finansowe"]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between p-2 bg-gray-50 rounded",children:[(0,r.jsx)("span",{className:"text-gray-700",children:"\u0141\u0105czne inwestycje:"}),(0,r.jsx)("span",{className:"font-medium",children:x(n.economicMetrics.totalInvestment||0)})]}),(0,r.jsxs)("div",{className:"flex justify-between p-2 bg-gray-50 rounded",children:[(0,r.jsx)("span",{className:"text-gray-700",children:"\u0141\u0105czne kredyty:"}),(0,r.jsx)("span",{className:"font-medium",children:x(n.economicMetrics.totalLoansTaken||0)})]}),(0,r.jsxs)("div",{className:"flex justify-between p-2 bg-gray-50 rounded",children:[(0,r.jsx)("span",{className:"text-gray-700",children:"\u015aredni ROI:"}),(0,r.jsxs)("span",{className:"font-medium "+((n.economicMetrics.avgROI||0)>0?"text-green-600":"text-red-600"),children:[(100*(n.economicMetrics.avgROI||0)).toFixed(1),"%"]})]}),(0,r.jsxs)("div",{className:"flex justify-between p-2 bg-gray-50 rounded",children:[(0,r.jsx)("span",{className:"text-gray-700",children:"Bilans:"}),(0,r.jsx)("span",{className:"font-medium "+((n.economicMetrics.totalRevenue||0)>(n.economicMetrics.totalExpenses||0)?"text-green-600":"text-red-600"),children:x((n.economicMetrics.totalRevenue||0)-(n.economicMetrics.totalExpenses||0))})]})]})]})]})},yg=Lf("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),gg=Lf("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),vg=e=>{var t;let{staffManagement:n,gameState:a,playerState:s}=e;const[o,l]=(0,i.useState)(null),[c,d]=(0,i.useState)("junior"),[u,h]=(0,i.useState)(""),[p,m]=(0,i.useState)("all"),f=[{id:"scouts",name:"Skauci",icon:(0,r.jsx)(Gf,{className:"h-4 w-4"}),description:"Zajmuj\u0105 si\u0119 pozyskiwaniem grunt\xf3w pod projekty OZE. Niezb\u0119dni do rozpocz\u0119cia nowych projekt\xf3w."},{id:"developers",name:"Developerzy",icon:(0,r.jsx)(Yy,{className:"h-4 w-4"}),description:"Prowadz\u0105 projekty OZE od pozyskanej ziemi do RTB. Ka\u017cdy developer mo\u017ce prowadzi\u0107 maksymalnie 5 projekt\xf3w."},{id:"lawyers",name:"Prawnicy",icon:(0,r.jsx)(hy,{className:"h-4 w-4"}),description:"Specjalizuj\u0105 si\u0119 w kwestiach prawnych i pozwoleniach. Przyspieszaj\u0105 rozw\xf3j wszystkich projekt\xf3w."},{id:"envSpecialists",name:"Specjali\u015bci ds. \u015brodowiska",icon:(0,r.jsx)(hy,{className:"h-4 w-4"}),description:"Eksperci od ocen oddzia\u0142ywania na \u015brodowisko. Przyspieszaj\u0105 rozw\xf3j wszystkich projekt\xf3w."},{id:"lobbyists",name:"Lobby\u015bci",icon:(0,r.jsx)(hy,{className:"h-4 w-4"}),description:"Pomagaj\u0105 uzyska\u0107 przychylno\u015b\u0107 w\u0142adz lokalnych i krajowych. Mog\u0105 by\u0107 r\u0119cznie przypisywani do projekt\xf3w dla dodatkowego przyspieszenia."}],y=[{id:"junior",name:"Junior",cost:1,description:"Pocz\u0105tkuj\u0105cy specjali\u015bci z podstawowymi umiej\u0119tno\u015bciami. Ta\u0144si, ale mniej efektywni."},{id:"mid",name:"Mid",cost:1.5,description:"Specjali\u015bci ze \u015brednim do\u015bwiadczeniem. Dobry balans mi\u0119dzy kosztem a efektywno\u015bci\u0105."},{id:"senior",name:"Senior",cost:2.5,description:"Eksperci z wieloletnim do\u015bwiadczeniem. Drodzy, ale bardzo efektywni."}],g=()=>f.filter((e=>{if("all"!==p&&e.id!==p)return!1;if(u){const t=u.toLowerCase();return e.name.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)}return!0})),v=(e,t)=>{const n={scout:15e3,developer:25e3,lawyer:3e4,envSpecialist:2e4,lobbyist:4e4}[e.endsWith("s")?e.slice(0,-1):e]||2e4,i={junior:1,mid:1.5,senior:2.2}[t]||1;return Math.round(n*i)},w=(e,t)=>s.cash>=v(e,t);return(0,r.jsxs)("div",{className:"employment-center",children:[(0,r.jsxs)("div",{className:"employment-header",children:[(0,r.jsx)("h2",{children:"Centrum Zatrudnienia"}),(0,r.jsx)("p",{children:"Zatrudnij nowych pracownik\xf3w, aby rozwija\u0107 projekty OZE. Ka\u017cdy typ specjalisty ma swoj\u0105 rol\u0119 w procesie rozwoju projekt\xf3w."})]}),(0,r.jsxs)("div",{className:"employment-filters",children:[(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsxs)("div",{className:"filter-label",children:[(0,r.jsx)(yg,{className:"h-4 w-4 mr-1"}),(0,r.jsx)("span",{children:"Filtruj:"})]}),(0,r.jsxs)("select",{value:p,onChange:e=>m(e.target.value),className:"filter-select",children:[(0,r.jsx)("option",{value:"all",children:"Wszyscy specjali\u015bci"}),f.map((e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,r.jsxs)("div",{className:"search-group",children:[(0,r.jsx)(gg,{className:"search-icon"}),(0,r.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),placeholder:"Szukaj specjalist\xf3w...",className:"search-input"})]})]}),(0,r.jsxs)("div",{className:"staff-types-grid",children:[g().map((e=>{var t;e.id.endsWith("s")?e.id.slice(0,-1):e.id;const n=o===e.id;return(0,r.jsxs)("div",{className:"staff-type-card "+(n?"selected":""),onClick:()=>l(e.id),children:[(0,r.jsx)("div",{className:"staff-type-icon",children:e.icon}),(0,r.jsxs)("div",{className:"staff-type-content",children:[(0,r.jsx)("h3",{children:e.name}),(0,r.jsx)("p",{children:e.description})]}),(0,r.jsxs)("div",{className:"staff-current-count",children:[(0,r.jsx)(ug,{className:"h-4 w-4 mr-1"}),(0,r.jsxs)("span",{children:[(null===(t=s.staff[e.id])||void 0===t?void 0:t.length)||0," zatrudnionych"]})]})]},e.id)})),0===g().length&&(0,r.jsx)("div",{className:"no-results",children:(0,r.jsx)("p",{children:"Nie znaleziono specjalist\xf3w spe\u0142niaj\u0105cych kryteria wyszukiwania."})})]}),o&&(0,r.jsxs)("div",{className:"hiring-panel",children:[(0,r.jsxs)("h3",{children:["Zatrudnij: ",My(o)]}),(0,r.jsxs)("div",{className:"level-selection",children:[(0,r.jsx)("div",{className:"level-options",children:y.map((e=>(0,r.jsx)("button",{className:"level-option "+(c===e.id?"selected":""),onClick:()=>d(e.id),children:e.name},e.id)))}),(0,r.jsx)("div",{className:"level-description",children:(0,r.jsx)("p",{children:null===(t=y.find((e=>e.id===c)))||void 0===t?void 0:t.description})})]}),(0,r.jsxs)("div",{className:"hiring-costs",children:[(0,r.jsxs)("div",{className:"cost-item",children:[(0,r.jsx)("span",{children:"Koszt zatrudnienia:"}),(0,r.jsxs)("span",{className:"cost-value",children:[v(o,c).toLocaleString()," PLN"]})]}),(0,r.jsxs)("div",{className:"cost-item",children:[(0,r.jsx)("span",{children:"Miesi\u0119czne wynagrodzenie:"}),(0,r.jsxs)("span",{className:"cost-value",children:[(x=o,b=c,Math.round(.04*v(x,b))).toLocaleString()," PLN"]})]})]}),(0,r.jsxs)("div",{className:"hiring-actions",children:[(0,r.jsx)("button",{className:"cancel-btn",onClick:()=>l(null),children:"Anuluj"}),(0,r.jsx)("button",{className:"hire-btn",disabled:!w(o,c),onClick:()=>{if(!o||!c)return;const e=o.endsWith("s")?o.slice(0,-1):o;n.hireStaff(e,c),l(null)},children:w(o,c)?"Zatrudnij":"Brak \u015brodk\xf3w"})]})]})]});var x,b},wg=e=>{let{staff:t,onFire:n,onTrain:i,onAssign:a,onDetails:s}=e;if(!t)return null;const o=e=>e>=75?"staff-morale-high":e>=40?"staff-morale-medium":"staff-morale-low",l=e=>e>=75?"staff-energy-high":e>=40?"staff-energy-medium":"staff-energy-low",c=e=>{switch(e){case"pracowity":return(0,r.jsx)(Hy,{size:14,className:"text-yellow-500"});case"kreatywny":return(0,r.jsx)(hg,{size:14,className:"text-blue-500"});case"dok\u0142adny":return(0,r.jsx)(hy,{size:14,className:"text-purple-500"});case"konfliktowy":return(0,r.jsx)(pg,{size:14,className:"text-red-500"});default:return null}};return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-200 hover:shadow-lg transition-shadow",children:[(0,r.jsxs)("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center "+("senior"===t.level?"bg-purple-100":"mid"===t.level?"bg-blue-100":"bg-green-100"),children:(0,r.jsx)("span",{className:"text-sm font-bold",children:t.name?t.name[0]:"P"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900",children:t.name||"Pracownik"}),(0,r.jsxs)("p",{className:"text-xs text-gray-600",children:["scout"===t.type?"Pozyskiwacz":"developer"===t.type?"Developer":"lobbyist"===t.type?"Lobbysta":"Specjalista"," \u2022 ","junior"===t.level?"Pocz\u0105tkuj\u0105cy":"mid"===t.level?"Do\u015bwiadczony":"Ekspert"]})]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"Pensja"}),(0,r.jsx)("div",{className:"text-sm font-medium",children:(d=t.salary||0,`${(d/1e3).toFixed(1)}k PLN`)})]})]}),(0,r.jsxs)("div",{className:"px-4 py-3",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(hy,{className:"h-4 w-4 text-blue-500 mr-1"}),(0,r.jsxs)("div",{className:"text-xs text-gray-700",children:["Umiej\u0119tno\u015b\u0107: ",(0,r.jsxs)("span",{className:"font-medium",children:[t.skill||0,"/10"]})]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(Yy,{className:"h-4 w-4 text-gray-500 mr-1"}),(0,r.jsxs)("div",{className:"text-xs text-gray-700",children:["Do\u015bwiadczenie: ",(0,r.jsxs)("span",{className:"font-medium",children:[Math.floor((t.experience||0)/365)," lat"]})]})]})]}),(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[(0,r.jsx)("span",{children:"Rozw\xf3j kariery"}),(0,r.jsx)("span",{children:"junior"===t.level?"Junior \u2192 Mid":"mid"===t.level?"Mid \u2192 Senior":"Senior"})]}),(0,r.jsx)(Gy,{value:(()=>{const e={junior:0,mid:1,senior:2}[t.level]||0,n=e<2?e+1:2;if(2===e)return 100;const i=[0,3e3,8e3],a=t.experience||0,r=i[e],s=(a-r)/(i[n]-r)*100;return Math.min(100,Math.max(0,s))})(),status:"senior"===t.level?"high":"medium"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(pg,{className:`h-4 w-4 mr-1 ${o(t.morale||0)}`}),(0,r.jsx)("span",{className:"text-xs text-gray-600",children:"Morale"})]}),(0,r.jsxs)("span",{className:`text-xs font-medium ${o(t.morale||0)}`,children:[t.morale||0,"%"]})]}),(0,r.jsx)(Gy,{value:t.morale||0,status:t.morale>=75?"high":t.morale>=40?"medium":"low"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(By,{className:`h-4 w-4 mr-1 ${l(t.energy||0)}`}),(0,r.jsx)("span",{className:"text-xs text-gray-600",children:"Energia"})]}),(0,r.jsxs)("span",{className:`text-xs font-medium ${l(t.energy||0)}`,children:[t.energy||0,"%"]})]}),(0,r.jsx)(Gy,{value:t.energy||0,status:t.energy>=75?"high":t.energy>=40?"medium":"low"})]})]}),t.traits&&t.traits.length>0&&(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"Cechy charakteru"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:t.traits.map(((e,t)=>(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-800",children:[c(e),(0,r.jsx)("span",{className:"ml-1 capitalize",children:e})]},t)))})]}),(0,r.jsxs)("div",{className:"flex space-x-2 mt-3",children:[(0,r.jsx)("button",{onClick:()=>s&&s(t),className:"flex-1 text-xs py-1 px-2 bg-blue-50 text-blue-600 rounded border border-blue-200 hover:bg-blue-100 transition-colors",children:"Szczeg\xf3\u0142y"}),(0,r.jsx)("button",{onClick:()=>i&&i(t),className:"flex-1 text-xs py-1 px-2 bg-green-50 text-green-600 rounded border border-green-200 hover:bg-green-100 transition-colors",children:"Szkolenie"}),"developer"===t.type&&!t.assignedProject&&a&&(0,r.jsx)("button",{onClick:()=>a&&a(t),className:"flex-1 text-xs py-1 px-2 bg-purple-50 text-purple-600 rounded border border-purple-200 hover:bg-purple-100 transition-colors",children:"Przypisz"}),(0,r.jsx)("button",{onClick:()=>n&&n(t),className:"flex-1 text-xs py-1 px-2 bg-red-50 text-red-600 rounded border border-red-200 hover:bg-red-100 transition-colors",children:"Zwolnij"})]})]})]});var d},xg=[{id:"pracowity",label:"Pracowity",description:"+15% wydajno\u015b\u0107, -10% zm\u0119czenie",effects:{efficiency:.15,energyLoss:-.1}},{id:"kreatywny",label:"Kreatywny",description:"+20% szansa na innowacje",effects:{innovationChance:.2}},{id:"charyzmatyczny",label:"Charyzmatyczny",description:"+15% negocjacje, +10% relacje",effects:{negotiation:.15,relations:.1}},{id:"dokladny",label:"Dok\u0142adny",description:"-30% ryzyko b\u0142\u0119d\xf3w, +10% czas",effects:{errorRisk:-.3,timeNeeded:.1}},{id:"ambitny",label:"Ambitny",description:"+25% praca po godzinach, szybszy rozw\xf3j",effects:{workOvertime:.25,careerGrowth:.15}},{id:"analityczny",label:"Analityczny",description:"+20% rozwi\u0105zywanie problem\xf3w",effects:{problemSolving:.2}},{id:"optymista",label:"Optymista",description:"+15% morale, -10% stres",effects:{moraleGain:.15,stressGain:-.1}},{id:"lojalny",label:"Lojalny",description:"-50% szansa odej\u015bcia, +15% morale przy d\u0142ugim sta\u017cu",effects:{leaveChance:-.5,longTermMorale:.15}}],bg=[{id:"perfekcjonista",label:"Perfekcjonista",description:"+30% jako\u015b\u0107, +20% czas",effects:{quality:.3,timeNeeded:.2}},{id:"indywidualista",label:"Indywidualista",description:"+10% solo, -15% zesp\xf3\u0142",effects:{soloWork:.1,teamWork:-.15}},{id:"ryzykant",label:"Ryzykant",description:"+25% szansa przyspieszenia, +15% b\u0142\u0119dy",effects:{speedBoost:.25,errorRisk:.15}},{id:"tradycjonalista",label:"Tradycjonalista",description:"-20% adaptacja do zmian, +15% standardowe procedury",effects:{adaptability:-.2,standardProcedures:.15}}],jg=[{id:"konfliktowy",label:"Konfliktowy",description:"-20% relacje, ryzyko spor\xf3w",effects:{relations:-.2,conflictRisk:.3}},{id:"prokrastynator",label:"Prokrastynator",description:"+25% op\xf3\u017anienia, -15% wydajno\u015b\u0107",effects:{delayRisk:.25,efficiency:-.15}},{id:"wypalony",label:"Wypalony",description:"-25% wydajno\u015b\u0107, -20% morale",effects:{efficiency:-.25,morale:-.2}},{id:"chaotyczny",label:"Chaotyczny",description:"-15% organizacja, +10% kreatywno\u015b\u0107",effects:{organization:-.15,creativity:.1}},{id:"pesymista",label:"Pesymista",description:"-15% morale zespo\u0142u, cz\u0119stsze zg\u0142aszanie problem\xf3w",effects:{teamMorale:-.15,problemReporting:.2}},{id:"niecierpliwy",label:"Niecierpliwy",description:"-20% zadania d\u0142ugoterminowe, +10% kr\xf3tkie zadania",effects:{longTasks:-.2,shortTasks:.1}}],kg=e=>{let{staff:t,onClose:n,onFire:a,onTrain:s}=e;if(!t)return null;const o=(0,i.useRef)(null),l=e=>{o.current&&!o.current.contains(e.target)&&n()};(0,i.useEffect)((()=>(document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)})),[]);const c=e=>{if(!e)return"-";try{return new Date(e).toLocaleDateString("pl-PL",{day:"2-digit",month:"2-digit",year:"numeric"})}catch(t){return e}},d=e=>e>=80?{text:"Doskona\u0142e",status:"high"}:e>=60?{text:"Dobre",status:"high"}:e>=40?{text:"Neutralne",status:"medium"}:e>=20?{text:"S\u0142abe",status:"low"}:{text:"Krytyczne",status:"low"},u=e=>e>=80?{text:"Pe\u0142na",status:"high"}:e>=60?{text:"Wysoka",status:"high"}:e>=40?{text:"\u015arednia",status:"medium"}:e>=20?{text:"Niska",status:"low"}:{text:"Wyczerpanie",status:"low"},h=e=>xg.some((t=>t.id===e))?"bg-green-100 text-green-800 border-green-200":jg.some((t=>t.id===e))?"bg-red-100 text-red-800 border-red-200":"bg-blue-100 text-blue-800 border-blue-200";return(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{ref:o,className:"bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center bg-gray-50",children:[(0,r.jsxs)("div",{className:"flex items-center overflow-hidden",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0",children:(0,r.jsx)(ug,{className:"h-6 w-6 text-blue-600"})}),(0,r.jsxs)("div",{className:"overflow-hidden",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-ellipsis overflow-hidden",children:t.name}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 whitespace-nowrap text-ellipsis overflow-hidden",children:["scout"===t.type?"Pozyskiwacz":"developer"===t.type?"Developer":"lobbyist"===t.type?"Lobbysta":"lawyer"===t.type?"Prawnik":"envSpecialist"===t.type?"Specjalista \u015brodowiskowy":"Pracownik"," \u2022 ","junior"===t.level?"Pocz\u0105tkuj\u0105cy":"mid"===t.level?"Do\u015bwiadczony":"Ekspert"]})]})]}),(0,r.jsx)("button",{onClick:n,className:"h-8 w-8 rounded-full flex items-center justify-center hover:bg-gray-200 flex-shrink-0",children:(0,r.jsx)(vy,{className:"h-5 w-5 text-gray-500"})})]}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"md:col-span-2 space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,r.jsx)(ug,{className:"h-5 w-5 mr-2 text-blue-500"}),"Informacje podstawowe"]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"overflow-hidden",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Data zatrudnienia"}),(0,r.jsx)("div",{className:"font-medium whitespace-nowrap",children:c(t.hiredOn)})]}),(0,r.jsxs)("div",{className:"overflow-hidden",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Czas zatrudnienia"}),(0,r.jsx)("div",{className:"font-medium whitespace-nowrap",children:(()=>{if(!t.hiredOn)return"-";const e=new Date(t.hiredOn),n=new Date,i=Math.abs(n-e),a=Math.ceil(i/864e5);if(a<30)return`${a} dni`;if(a<365){return`${Math.floor(a/30)} mies.`}{const e=Math.floor(a/365),t=Math.floor(a%365/30);return`${e} lat${t>0?`, ${t} mies.`:""}`}})()})]}),(0,r.jsxs)("div",{className:"overflow-hidden",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Wynagrodzenie"}),(0,r.jsx)("div",{className:"font-medium whitespace-nowrap",children:(p=t.salary||0,`${p.toLocaleString()} PLN`)})]}),(0,r.jsxs)("div",{className:"overflow-hidden",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Specjalizacja"}),(0,r.jsx)("div",{className:"font-medium text-ellipsis overflow-hidden",children:t.specialization||"-"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,r.jsx)(hy,{className:"h-5 w-5 mr-2 text-blue-500"}),"Umiej\u0119tno\u015bci i rozw\xf3j"]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,r.jsx)("span",{className:"text-sm",children:"Umiej\u0119tno\u015b\u0107 podstawowa"}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:[t.skill||0,"/10"]})]}),(0,r.jsx)(Gy,{value:10*(t.skill||0),status:(t.skill||0)>=7?"high":(t.skill||0)>=4?"medium":"low"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,r.jsx)("span",{className:"text-sm",children:"Do\u015bwiadczenie"}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:[t.experience||0," pkt"]})]}),(0,r.jsx)(Gy,{value:"senior"===t.level?100:"mid"===t.level?(t.experience-3e3)/5e3*100:t.experience/3e3*100,status:"medium"}),(0,r.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"junior"===t.level?"Do awansu na poziom Do\u015bwiadczony":"mid"===t.level?"Do awansu na poziom Ekspert":"Najwy\u017cszy poziom do\u015bwiadczenia"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,r.jsx)(hg,{className:"h-5 w-5 mr-2 text-blue-500"}),"Cechy charakteru"]}),t.traits&&t.traits.length>0?(0,r.jsx)("div",{className:"space-y-3",children:t.traits.map((e=>{const t=(e=>[...xg,...bg,...jg].find((t=>t.id===e))||{label:e,description:""})(e);return(0,r.jsxs)("div",{className:`p-2 rounded border ${h(e)} break-words`,children:[(0,r.jsx)("div",{className:"font-medium",children:t.label||e}),(0,r.jsx)("div",{className:"text-sm",children:t.description})]},e)}))}):(0,r.jsx)("p",{className:"text-gray-500 italic",children:"Brak zdefiniowanych cech"})]}),t.historia&&t.historia.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,r.jsx)(Ff,{className:"h-5 w-5 mr-2 text-blue-500"}),"Historia pracownika"]}),(0,r.jsx)("div",{className:"border rounded divide-y",children:t.historia.map(((e,t)=>(0,r.jsx)("div",{className:"p-3",children:(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("div",{className:"font-medium",children:e.opis}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:c(e.data)})]})},t)))})]})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-3",children:"Status"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,r.jsxs)("span",{className:"text-sm flex items-center",children:[(0,r.jsx)(pg,{className:"h-4 w-4 mr-1 text-red-500"}),"Morale"]}),(0,r.jsx)("span",{className:"text-sm font-medium "+("high"===d(t.morale||0).status?"text-green-600":"medium"===d(t.morale||0).status?"text-yellow-600":"text-red-600"),children:d(t.morale||0).text})]}),(0,r.jsx)(Gy,{value:t.morale||0,status:d(t.morale||0).status})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,r.jsxs)("span",{className:"text-sm flex items-center",children:[(0,r.jsx)(By,{className:"h-4 w-4 mr-1 text-green-500"}),"Energia"]}),(0,r.jsx)("span",{className:"text-sm font-medium "+("high"===u(t.energy||0).status?"text-green-600":"medium"===u(t.energy||0).status?"text-yellow-600":"text-red-600"),children:u(t.energy||0).text})]}),(0,r.jsx)(Gy,{value:t.energy||0,status:u(t.energy||0).status})]})]}),t.potrzeby&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("h4",{className:"font-medium text-sm mb-2",children:"Potrzeby"}),(0,r.jsx)("div",{className:"space-y-2",children:Object.entries(t.potrzeby).map((e=>{let[t,n]=e,i="";switch(t){case"uznanie":i="Uznanie";break;case"rozwoj":i="Rozw\xf3j";break;case"stabilizacja":i="Stabilizacja";break;case"autonomia":i="Autonomia";break;case"relacjeSpoleczne":i="Relacje";break;default:i=t}return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,r.jsx)("span",{className:"text-xs",children:i}),(0,r.jsxs)("span",{className:"text-xs font-medium",children:[n,"/100"]})]}),(0,r.jsx)("div",{className:"w-full h-1 bg-gray-200 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"h-full "+(n>=70?"bg-green-500":n>=40?"bg-yellow-500":"bg-red-500"),style:{width:`${n}%`}})})]},t)}))})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[(0,r.jsx)("h3",{className:"text-md font-bold mb-3",children:"Przypisane projekty"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 italic",children:"Brak przypisanych projekt\xf3w"})]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[(0,r.jsx)("h3",{className:"text-md font-bold mb-3",children:"Akcje"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("button",{onClick:()=>s&&s(t),className:"w-full flex items-center justify-center py-2 px-4 bg-blue-100 text-blue-700 rounded border border-blue-200 hover:bg-blue-200",children:[(0,r.jsx)(hy,{className:"h-4 w-4 mr-2"}),"Wy\u015blij na szkolenie"]}),(0,r.jsxs)("button",{onClick:()=>a&&a(t),className:"w-full flex items-center justify-center py-2 px-4 bg-red-100 text-red-700 rounded border border-red-200 hover:bg-red-200",children:[(0,r.jsx)(vy,{className:"h-4 w-4 mr-2"}),"Zwolnij pracownika"]})]})]})]})]})})]})});var p},Ng=()=>{const{state:e}=d();return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mt-6",children:[(0,r.jsx)("h3",{className:"font-bold text-lg mb-2",children:"Reputacja firmy"}),(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mr-2",children:(0,r.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${e.reputation||50}%`}})}),(0,r.jsxs)("span",{className:"font-medium "+(t=e.reputation||50,t>=80?"text-green-500":t>=60?"text-blue-500":t>=40?"text-yellow-500":t>=20?"text-orange-500":"text-red-500"),children:[e.reputation||50,"%"]})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-700",children:["Poziom: ",(0,r.jsx)("span",{className:"font-medium",children:(e=>e>=80?"Doskona\u0142a":e>=60?"Dobra":e>=40?"Przeci\u0119tna":e>=20?"S\u0142aba":"Bardzo s\u0142aba")(e.reputation||50)})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Reputacja wp\u0142ywa na negocjacje, sukces projekt\xf3w i relacje z interesariuszami"})]});var t},zg=()=>{const{state:e,dispatch:t}=d(),{state:n,showNotification:a}=mf(),s=Ly(),[o,l]=(0,i.useState)("all"),[c,u]=(0,i.useState)("all"),[h,p]=(0,i.useState)(""),[m,f]=(0,i.useState)("skill"),[y,g]=(0,i.useState)("desc"),[v,w]=(0,i.useState)(null),[x,b]=(0,i.useState)(!1),[j,k]=(0,i.useState)(!1),[N,z]=(0,i.useState)(!1),[_,E]=(0,i.useState)(null),S=()=>{const t=[];return Object.entries(e.staff).forEach((e=>{let[n,i]=e;i&&i.length>0&&i.forEach((e=>{t.push({...e,staffCategory:n.replace(/s$/,"")})}))})),t},T=()=>{let e=S();if("all"!==o&&(e=e.filter((e=>e.staffCategory===o||e.type===o))),"all"!==c&&(e=e.filter((e=>e.level===c))),h){const t=h.toLowerCase();e=e.filter((e=>e.name.toLowerCase().includes(t)||e.specialization&&e.specialization.toLowerCase().includes(t)))}return e.sort(((e,t)=>{let n=0;switch(m){case"name":n=e.name.localeCompare(t.name);break;case"skill":n=(t.skill||0)-(e.skill||0);break;case"experience":n=(t.experience||0)-(e.experience||0);break;case"salary":n=(t.salary||0)-(e.salary||0);break;case"morale":n=(t.morale||0)-(e.morale||0);break;case"energy":n=(t.energy||0)-(e.energy||0);break;default:n=0}return"asc"===y?-n:n})),e},C=(e,t)=>{s.hireStaff(e,t),a("Nowy pracownik zosta\u0142 zatrudniony","success")},P=e=>{event.preventDefault(),event.stopPropagation(),s.fireStaff(e.staffCategory,e.id),a(`Pracownik ${e.name} zosta\u0142 zwolniony`,"success")},I=t=>{event.preventDefault(),event.stopPropagation();const n=s.calculateTrainingCost(t,"standard");if(e.cash<n)return void a(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w na szkolenie (${n.toLocaleString()} PLN)`,"error");s.trainStaff(t.staffCategory,t.id,"standard")&&a(`Pracownik ${t.name} zosta\u0142 wys\u0142any na szkolenie`,"success")},A=e=>{event.preventDefault(),event.stopPropagation(),w(e),b(!0)},M={scouts:T().filter((e=>"scout"===e.staffCategory)),developers:T().filter((e=>"developer"===e.staffCategory)),specialists:T().filter((e=>"scout"!==e.staffCategory&&"developer"!==e.staffCategory))},D=(()=>{const e=S(),t=e.filter((e=>"scout"===e.staffCategory)).length,n=e.filter((e=>"developer"===e.staffCategory)).length,i=e.filter((e=>"scout"!==e.staffCategory&&"developer"!==e.staffCategory)).length,a=e.reduce(((e,t)=>e+(t.salary||0)),0),r=e.length>0?e.reduce(((e,t)=>e+(t.skill||0)),0)/e.length:0,s=e.length>0?e.reduce(((e,t)=>e+(t.morale||0)),0)/e.length:0,o=e.length>0?e.reduce(((e,t)=>e+(t.energy||0)),0)/e.length:0;return{totalCount:e.length,scoutCount:t,developerCount:n,specialistCount:i,totalSalaries:a,avgSkill:r,avgMorale:s,avgEnergy:o}})(),R=e=>{event.preventDefault(),event.stopPropagation();0!==s.findProjectsWaitingForDeveloper().length?(E(e),z(!0)):a("Brak projekt\xf3w oczekuj\u0105cych na przypisanie developera.","warning")};(0,i.useCallback)(((e,t,n)=>{if(!e||!t||!n)return;const i=e.lastReputationUpdate||0,a=t.turn||0;if(i>=a)return;const r=t.daysPerTurn||2,s=a*r;let o=0;for(let l=i*r+1;l<=s;l++)l%2===0&&o++;o>0&&n({type:"UPDATE_REPUTATION_INITIATIVES",payload:{daysPassed:2*o,turn:t.turn}})}),[]);return(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Zarz\u0105dzanie Kadrami"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"Zarz\u0105dzaj swoimi pracownikami, zatrudniaj nowych, szkolenia i przydzielaj do projekt\xf3w."}),(0,r.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 border-l-4 border-blue-500",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"\u0141\u0105czna liczba pracownik\xf3w"}),(0,r.jsx)("div",{className:"text-2xl font-bold",children:D.totalCount})]}),(0,r.jsx)(Gf,{className:"h-10 w-10 text-blue-500 opacity-40"})]}),(0,r.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["Skauci: ",D.scoutCount," \u2022 Developerzy: ",D.developerCount," \u2022 Specjali\u015bci: ",D.specialistCount]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 border-l-4 border-green-500",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Miesi\u0119czne wynagrodzenia"}),(0,r.jsxs)("div",{className:"text-2xl font-bold",children:[D.totalSalaries.toLocaleString()," PLN"]})]}),(0,r.jsx)(Yy,{className:"h-10 w-10 text-green-500 opacity-40"})]}),(0,r.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["\u015arednio na pracownika: ",D.totalCount>0?(D.totalSalaries/D.totalCount).toLocaleString():0," PLN"]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 border-l-4 border-purple-500",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"\u015arednie umiej\u0119tno\u015bci"}),(0,r.jsxs)("div",{className:"text-2xl font-bold",children:[D.avgSkill.toFixed(1),"/10"]})]}),(0,r.jsx)(hg,{className:"h-10 w-10 text-purple-500 opacity-40"})]}),(0,r.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["Skauci: ",M.scouts.length>0?(M.scouts.reduce(((e,t)=>e+(t.skill||0)),0)/M.scouts.length).toFixed(1):"0"," \u2022 Developerzy: ",M.developers.length>0?(M.developers.reduce(((e,t)=>e+(t.skill||0)),0)/M.developers.length).toFixed(1):"0"]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 border-l-4 border-red-500",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"\u015arednie morale zespo\u0142u"}),(0,r.jsxs)("div",{className:"text-2xl font-bold",children:[D.avgMorale.toFixed(0),"%"]})]}),(0,r.jsx)(pg,{className:"h-10 w-10 text-red-500 opacity-40"})]}),(0,r.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["Energia zespo\u0142u: ",D.avgEnergy.toFixed(0),"%"]})]})]}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:(0,r.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Typ pracownika"}),(0,r.jsxs)("select",{value:o,onChange:e=>l(e.target.value),className:"border rounded px-3 py-1 text-sm",children:[(0,r.jsx)("option",{value:"all",children:"Wszyscy"}),(0,r.jsx)("option",{value:"scout",children:"Skauci"}),(0,r.jsx)("option",{value:"developer",children:"Developerzy"}),(0,r.jsx)("option",{value:"lobbyist",children:"Lobby\u015bci"}),(0,r.jsx)("option",{value:"lawyer",children:"Prawnicy"}),(0,r.jsx)("option",{value:"envSpecialist",children:"Specjali\u015bci \u015brodowiskowi"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Poziom"}),(0,r.jsxs)("select",{value:c,onChange:e=>u(e.target.value),className:"border rounded px-3 py-1 text-sm",children:[(0,r.jsx)("option",{value:"all",children:"Wszystkie"}),(0,r.jsx)("option",{value:"junior",children:"Junior"}),(0,r.jsx)("option",{value:"mid",children:"Mid"}),(0,r.jsx)("option",{value:"senior",children:"Senior"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Sortuj wg"}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsxs)("select",{value:m,onChange:e=>f(e.target.value),className:"border-l border-t border-b rounded-l px-3 py-1 text-sm",children:[(0,r.jsx)("option",{value:"name",children:"Imi\u0119 i nazwisko"}),(0,r.jsx)("option",{value:"skill",children:"Umiej\u0119tno\u015bci"}),(0,r.jsx)("option",{value:"experience",children:"Do\u015bwiadczenie"}),(0,r.jsx)("option",{value:"salary",children:"Wynagrodzenie"}),(0,r.jsx)("option",{value:"morale",children:"Morale"}),(0,r.jsx)("option",{value:"energy",children:"Energia"})]}),(0,r.jsx)("button",{onClick:()=>g("asc"===y?"desc":"asc"),className:"border rounded-r px-2 bg-gray-100 hover:bg-gray-200",children:"asc"===y?"\u2191":"\u2193"})]})]})]}),(0,r.jsx)("div",{className:"flex items-center space-x-4",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"text",value:h,onChange:e=>p(e.target.value),placeholder:"Szukaj pracownika...",className:"border rounded pl-9 pr-3 py-1.5 w-64"}),(0,r.jsx)(gg,{className:"h-4 w-4 text-gray-400 absolute top-2 left-3"})]})})]})}),(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,r.jsx)(Gf,{className:"h-5 w-5 mr-2"}),"Skauci - Pozyskiwanie grunt\xf3w",(0,r.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",M.scouts.length,")"]})]}),(0,r.jsx)("p",{className:"text-gray-600 mb-4 text-sm",children:"Skauci szukaj\u0105 i negocjuj\u0105 umowy dzier\u017cawy grunt\xf3w pod projekty OZE. Do\u015bwiadczeni skauci przy\u015bpieszaj\u0105 pozyskiwanie grunt\xf3w i wynegocjuj\u0105 lepsze ceny."}),M.scouts.length>0?(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:M.scouts.map((e=>(0,r.jsx)(wg,{staff:e,onFire:P,onTrain:I,onDetails:A},e.id)))}):(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 text-center",children:[(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:"Nie masz jeszcze \u017cadnych pozyskiwaczy"}),(0,r.jsxs)("div",{className:"flex justify-center space-x-3",children:[(0,r.jsx)("button",{onClick:()=>C("scout","junior"),className:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Zatrudnij pocz\u0105tkuj\u0105cego"}),(0,r.jsx)("button",{onClick:()=>C("scout","mid"),className:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Zatrudnij do\u015bwiadczonego"}),(0,r.jsx)("button",{onClick:()=>C("scout","senior"),className:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Zatrudnij eksperta"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,r.jsx)(Gf,{className:"h-5 w-5 mr-2"}),"Developerzy - Zarz\u0105dzanie projektami",(0,r.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",M.developers.length,")"]})]}),(0,r.jsx)("p",{className:"text-gray-600 mb-4 text-sm",children:"Developerzy zarz\u0105dzaj\u0105 projektami i przyspieszaj\u0105 proces realizacji. Do\u015bwiadczeni developerzy zwi\u0119kszaj\u0105 szanse na powodzenie projektu i redukuj\u0105 ryzyko."}),M.developers.length>0?(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:M.developers.map((e=>(0,r.jsx)(wg,{staff:e,onFire:P,onTrain:I,onDetails:A,onAssign:e.assignedProject?null:R},e.id)))}):(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 text-center",children:[(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:"Nie masz jeszcze \u017cadnych developer\xf3w"}),(0,r.jsxs)("div",{className:"flex justify-center space-x-3",children:[(0,r.jsx)("button",{onClick:()=>C("developer","junior"),className:"px-3 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"Zatrudnij pocz\u0105tkuj\u0105cego"}),(0,r.jsx)("button",{onClick:()=>C("developer","mid"),className:"px-3 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"Zatrudnij do\u015bwiadczonego"}),(0,r.jsx)("button",{onClick:()=>C("developer","senior"),className:"px-3 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"Zatrudnij eksperta"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,r.jsx)(Gf,{className:"h-5 w-5 mr-2"}),"Specjali\u015bci wysokiego szczebla",(0,r.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",M.specialists.length,")"]})]}),(0,r.jsx)("p",{className:"text-gray-600 mb-4 text-sm",children:"Specjali\u015bci wysokiego szczebla to kluczowi eksperci, kt\xf3rzy znacz\u0105co przyspieszaj\u0105 uzyskiwanie pozwole\u0144 i rozw\xf3j projekt\xf3w."}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"font-bold text-md mb-2",children:"Prawnik"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Przyspiesza uzyskiwanie warunk\xf3w zabudowy i decyzji lokalizacyjnych o 30%."}),(0,r.jsx)("button",{onClick:()=>C("lawyer","senior"),className:"w-full px-3 py-2 bg-purple-500 text-white rounded hover:bg-purple-600",children:"Zatrudnij (30 mln z\u0142)"})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"font-bold text-md mb-2",children:"Specjalista ds. \u015brodowiska"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Przyspiesza uzyskiwanie decyzji \u015brodowiskowych o 30% i zmniejsza ryzyko blokad."}),(0,r.jsx)("button",{onClick:()=>C("envSpecialist","senior"),className:"w-full px-3 py-2 bg-purple-500 text-white rounded hover:bg-purple-600",children:"Zatrudnij (25 mln z\u0142)"})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"font-bold text-md mb-2",children:"Lobbysta"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Wp\u0142ywa na decyzje lokalne, przyspiesza procesy administracyjne i zwi\u0119ksza akceptacj\u0119 spo\u0142eczn\u0105."}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>C("lobbyist","junior"),className:"flex-1 px-2 py-2 bg-purple-500 text-white rounded hover:bg-purple-600 text-sm",children:"Junior (5k z\u0142/m-c)"}),(0,r.jsx)("button",{onClick:()=>C("lobbyist","senior"),className:"flex-1 px-2 py-2 bg-purple-500 text-white rounded hover:bg-purple-600 text-sm",children:"Expert (11k z\u0142/m-c)"})]})]})]})]})]}),x&&v&&(0,r.jsx)(kg,{staff:v,onClose:()=>b(!1),onFire:()=>{P(v),b(!1)},onTrain:()=>{I(v)}}),N&&_&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Przypisz developera do projektu"}),(0,r.jsxs)("p",{className:"mb-4",children:["Wybierz projekt, do kt\xf3rego chcesz przypisa\u0107 developera ",(0,r.jsx)("strong",{children:_.name}),":"]}),(0,r.jsx)("div",{className:"space-y-3 mb-6",children:s.findProjectsWaitingForDeveloper().map((e=>(0,r.jsxs)("div",{className:"bg-gray-50 p-3 rounded border border-gray-200 hover:bg-blue-50 cursor-pointer",onClick:()=>(()=>{if(!_)return;s.assignDeveloperToWaitingProject(_.id)?a(`Developer ${_.name} zosta\u0142 przypisany do projektu.`,"success"):a("Nie uda\u0142o si\u0119 przypisa\u0107 developera do projektu.","error"),z(!1),E(null)})(e.id),children:[(0,r.jsx)("div",{className:"font-medium",children:e.name}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["Region: ",e.region,", Powierzchnia: ",e.size,"ha"]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["Typ projektu: ",e.projectType||"Standardowy"]})]},e.id)))}),(0,r.jsx)("div",{className:"flex justify-end space-x-3",children:(0,r.jsx)("button",{onClick:()=>{z(!1),E(null)},className:"px-4 py-2 bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:"Anuluj"})})]})}),(0,r.jsx)(Ng,{})]})},_g=Lf("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),Eg=()=>{var e;const{state:t,dispatch:n}=d(),{showNotification:a}=mf(),[s,o]=(0,i.useState)("efficiency"),l=[{id:"efficiency",name:"Efektywno\u015b\u0107",icon:(0,r.jsx)(ny,{size:16})},{id:"training",name:"Szkolenia",icon:(0,r.jsx)(hg,{size:16})},{id:"equipment",name:"Sprz\u0119t",icon:(0,r.jsx)(_g,{size:16})},{id:"reputation",name:"Reputacja",icon:(0,r.jsx)(hy,{size:16})}],c=e=>t.companyUpgrades&&t.companyUpgrades[e]||0,u=e=>{const t=c(e.id);return t>=e.levels?1/0:Math.floor(e.baseCost*Math.pow(e.costMultiplier,t))};return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mt-6",children:[(0,r.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Ulepszenia firmy"}),(0,r.jsx)("div",{className:"flex border-b border-gray-200 mb-4",children:l.map((e=>(0,r.jsxs)("button",{className:"flex items-center px-4 py-2 "+(s===e.id?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),onClick:()=>o(e.id),children:[(0,r.jsx)("span",{className:"mr-2",children:e.icon}),e.name]},e.id)))}),(0,r.jsx)("div",{className:"space-y-4",children:null===(e={efficiency:[{id:"project_management",name:"System zarz\u0105dzania projektami",description:"Zwi\u0119ksza efektywno\u015b\u0107 pracy developer\xf3w o 10% na poziom",levels:3,baseCost:25e3,costMultiplier:2,effects:[{target:"developer_efficiency",value:.1},{target:"project_progress_rate",value:.05}]},{id:"document_templates",name:"Szablony dokument\xf3w",description:"Przyspiesza uzyskiwanie pozwole\u0144 o 5% na poziom",levels:3,baseCost:15e3,costMultiplier:1.5,effects:[{target:"permit_speed",value:.05}]},{id:"automation",name:"Automatyzacja proces\xf3w",description:"Zmniejsza koszty operacyjne o 5% na poziom",levels:3,baseCost:3e4,costMultiplier:1.8,effects:[{target:"operational_costs",value:-.05}]}],training:[{id:"training_program",name:"Program szkole\u0144",description:"Przyspiesza zdobywanie do\u015bwiadczenia pracownik\xf3w o 10% na poziom",levels:3,baseCost:2e4,costMultiplier:1.7,effects:[{target:"experience_gain_rate",value:.1}]},{id:"mentoring",name:"Program mentoringu",description:"Zwi\u0119ksza umiej\u0119tno\u015bci nowych pracownik\xf3w o 1 na poziom",levels:2,baseCost:25e3,costMultiplier:2,effects:[{target:"starting_skill_bonus",value:1}]}],equipment:[{id:"office_equipment",name:"Sprz\u0119t biurowy",description:"Zwi\u0119ksza zadowolenie pracownik\xf3w o 5% na poziom",levels:3,baseCost:1e4,costMultiplier:1.5,effects:[{target:"staff_morale",value:.05}]},{id:"field_equipment",name:"Sprz\u0119t terenowy",description:"Zwi\u0119ksza efektywno\u015b\u0107 skaut\xf3w o 10% na poziom",levels:3,baseCost:15e3,costMultiplier:1.6,effects:[{target:"scout_efficiency",value:.1}]}],reputation:[{id:"marketing",name:"Marketing i PR",description:"Zwi\u0119ksza reputacj\u0119 firmy o 5 punkt\xf3w na poziom",levels:3,baseCost:2e4,costMultiplier:1.8,effects:[{target:"reputation",value:5}]},{id:"social_responsibility",name:"Odpowiedzialno\u015b\u0107 spo\u0142eczna",description:"Zwi\u0119ksza akceptacj\u0119 spo\u0142eczn\u0105 projekt\xf3w o 10% na poziom",levels:2,baseCost:3e4,costMultiplier:2,effects:[{target:"social_acceptance",value:.1}]}]}[s])||void 0===e?void 0:e.map((e=>{const i=c(e.id),s=u(e),o=i>=e.levels;return(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold",children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"text-sm font-medium",children:["Poziom: ",i,"/",e.levels]}),o?(0,r.jsxs)("div",{className:"flex items-center mt-2 text-green-600 text-sm",children:[(0,r.jsx)(hy,{size:16,className:"mr-1"}),"Maksymalny poziom"]}):(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("button",{onClick:()=>(e=>{const i=c(e.id);if(i>=e.levels)return void a("Osi\u0105gni\u0119to maksymalny poziom tego ulepszenia","warning");const r=u(e);t.cash<r?a(`Niewystarczaj\u0105ce \u015brodki. Potrzeba ${r.toLocaleString()} PLN`,"error"):(n({type:"PURCHASE_COMPANY_UPGRADE",payload:{upgradeId:e.id,cost:r,newLevel:i+1}}),e.effects.forEach((e=>{"reputation"===e.target&&n({type:"UPDATE_REPUTATION",payload:e.value})})),a(`Zakupiono ulepszenie: ${e.name} (poziom ${i+1}/${e.levels})`,"success"))})(e),disabled:t.cash<s||o,className:"px-3 py-1.5 text-sm rounded "+(t.cash<s||o?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"),children:o?"Maksymalny poziom":`Ulepsz (${s.toLocaleString()} PLN)`})})]})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5 mt-3",children:(0,r.jsx)("div",{className:"bg-blue-600 h-1.5 rounded-full",style:{width:i/e.levels*100+"%"}})})]},e.id)}))}),(0,r.jsxs)("div",{className:"flex items-start mt-4 p-3 bg-blue-50 rounded-lg text-sm",children:[(0,r.jsx)(Hf,{size:18,className:"text-blue-500 mr-2 mt-0.5"}),(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"text-blue-800",children:"Ulepszenia firmy daj\u0105 trwa\u0142e premie, kt\xf3re wp\u0142ywaj\u0105 na wszystkie aspekty dzia\u0142alno\u015bci. Wybieraj je zgodnie ze swoj\u0105 strategi\u0105 rozwoju."})})]})]})},Sg=()=>{var e;const{state:t}=d(),{state:n}=mf(),i=e=>new Intl.NumberFormat("pl-PL",{style:"currency",currency:"PLN",maximumFractionDigits:0}).format(e),a=(()=>{let e=0,n=5e3;t.staff&&Object.values(t.staff).forEach((t=>{Array.isArray(t)&&t.forEach((t=>{t.salary&&(e+=t.salary)}))}));const i=Object.values(t.staff||{}).reduce(((e,t)=>e+(Array.isArray(t)?t.length:0)),0);return n+=1e3*i,{staffCosts:e,officeCosts:n,otherCosts:2e3,total:e+n+2e3}})(),s=t.projects&&0!==t.projects.length?t.projects.reduce(((e,t)=>{let n=0;switch(t.status){case"new":n=0;break;case"land_acquisition":default:n=5e3*t.size;break;case"environmental_decision":n=1e4*t.size;break;case"zoning_conditions":n=15e3*t.size;break;case"grid_connection":n=25e3*t.size;break;case"ready_to_build":n=5e4*t.size}return e+n*("PV"===t.technology?1:"Wind"===t.technology?1.2:1.5)}),0):0;return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mt-6",children:[(0,r.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Przegl\u0105d firmy"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"rounded-full bg-blue-100 p-2 mr-3",children:(0,r.jsx)(gy,{size:20,className:"text-blue-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Aktywa pieni\u0119\u017cne"}),(0,r.jsx)("p",{className:"font-semibold",children:i(t.cash||0)})]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"rounded-full bg-green-100 p-2 mr-3",children:(0,r.jsx)(uy,{size:20,className:"text-green-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Warto\u015b\u0107 projekt\xf3w"}),(0,r.jsx)("p",{className:"font-semibold",children:i(s)})]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"rounded-full bg-purple-100 p-2 mr-3",children:(0,r.jsx)(Gf,{size:20,className:"text-purple-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Miesi\u0119czne koszty personelu"}),(0,r.jsx)("p",{className:"font-semibold",children:i(a.staffCosts)})]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"rounded-full bg-red-100 p-2 mr-3",children:(0,r.jsx)(Hy,{size:20,className:"text-red-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Ca\u0142kowite koszty miesi\u0119czne"}),(0,r.jsx)("p",{className:"font-semibold",children:i(a.total)})]})]})]}),(0,r.jsxs)("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Liczba projekt\xf3w"}),(0,r.jsx)("p",{className:"font-medium",children:(null===(e=t.projects)||void 0===e?void 0:e.length)||0})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Liczba pracownik\xf3w"}),(0,r.jsx)("p",{className:"font-medium",children:Object.values(t.staff||{}).reduce(((e,t)=>e+(Array.isArray(t)?t.length:0)),0)})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Dzie\u0144 operacyjny"}),(0,r.jsx)("p",{className:"font-medium",children:n.turn*(n.daysPerTurn||2)})]})]})]})},Tg=Lf("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),Cg=Lf("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),Pg=()=>{var e,t,n;const{state:a,dispatch:s}=d(),{state:o,showNotification:l}=mf(),[c,u]=(0,i.useState)(null),[h,p]=(0,i.useState)(!1),m=Array.isArray(a.leases)?a.leases:[];(0,i.useEffect)((()=>{const e=()=>{if(c){const e=m.find((e=>e.id===c.id));e?u(e):(u(null),p(!1))}};return window.addEventListener("next-game-day",e),()=>{window.removeEventListener("next-game-day",e)}}),[c,m]);const f=e=>{if(!e)return"Data nieznana";try{return new Date(e).toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"})}catch(t){return console.error("B\u0142\u0105d formatowania daty:",t),"B\u0142\u0105d formatu daty"}},y=e=>{if(e&&window.confirm("Czy na pewno chcesz wypowiedzie\u0107 umow\u0119 dzier\u017cawy? Utracisz prawa do dzia\u0142ki i nie otrzymasz zwrotu kaucji."))try{var t;const n=null===(t=a.projects)||void 0===t?void 0:t.find((t=>t.leaseId===e));if(n)return void l(`Nie mo\u017cna wypowiedzie\u0107 umowy dzier\u017cawy, poniewa\u017c jest przypisana do projektu "${n.name}". Najpierw musisz zako\u0144czy\u0107 projekt.`,"error");s({type:"REMOVE_LEASE",payload:e}),c&&c.id===e&&(u(null),p(!1)),l("Umowa dzier\u017cawy zosta\u0142a wypowiedziana.","success")}catch(n){console.error("B\u0142\u0105d podczas wypowiadania umowy dzier\u017cawy:",n),l("Wyst\u0105pi\u0142 b\u0142\u0105d podczas wypowiadania umowy dzier\u017cawy.","error")}};(0,i.useEffect)((()=>{if(c){const e=m.find((e=>e.id===c.id));e?u(e):(u(null),p(!1))}}),[m,c]);const g=[...m].sort(((e,t)=>{const n=new Date(e.startDate);return new Date(t.startDate)-n}));return(0,r.jsxs)("div",{className:"p-4 bg-white rounded-lg shadow-md",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold mb-4 flex items-center",children:[(0,r.jsx)(uy,{className:"mr-2 h-5 w-5 text-blue-500"}),"Aktywne umowy dzier\u017cawy (",m.length,")"]}),0===m.length?(0,r.jsxs)("div",{className:"text-center py-6 bg-gray-50 rounded-lg",children:[(0,r.jsx)(uy,{className:"mx-auto h-12 w-12 text-gray-300 mb-2"}),(0,r.jsx)("p",{className:"text-gray-500 mb-1",children:"Brak aktywnych um\xf3w dzier\u017cawy"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Zawrzyj umowy dzier\u017cawy, aby rozpocz\u0105\u0107 nowe projekty OZE"})]}):(0,r.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:g.map((e=>{var t;return(0,r.jsxs)("div",{className:"border rounded-lg p-3 transition-all duration-200 "+(c&&c.id===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"),onClick:()=>{u(e),p(!0)},children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"font-medium",children:["Dzia\u0142ka ",e.size,"ha (",e.projectType||"Brak typu",")"]}),(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,r.jsx)(Py,{className:"h-3 w-3 mr-1"}),e.regionName||"Nieznany region"]})]}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),(e=>{var t;const n=null===(t=a.projects)||void 0===t?void 0:t.find((t=>t.leaseId===e));n?l(`Znaleziono powi\u0105zany projekt: ${n.name}`,"info"):l("Nie znaleziono projektu powi\u0105zanego z t\u0105 umow\u0105 dzier\u017cawy.","error")})(e.id)},className:"text-blue-500 hover:text-blue-700 p-1",title:"Zobacz powi\u0105zany projekt",children:(0,r.jsx)(Tg,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),y(e.id)},className:"text-red-500 hover:text-red-700 p-1 ml-1",title:"Wypowiedz umow\u0119",children:(0,r.jsx)(Cg,{className:"h-4 w-4"})})]})]}),(0,r.jsxs)("div",{className:"text-sm space-y-1",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Czynsz miesi\u0119czny:"}),(0,r.jsxs)("span",{className:"font-medium",children:[null===(t=e.monthlyRent)||void 0===t?void 0:t.toLocaleString()," PLN"]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Umowa zawarta:"}),(0,r.jsx)("span",{children:f(e.startDate)})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Wygasa:"}),(0,r.jsx)("span",{children:f(e.endDate)})]})]})]},e.id)}))}),h&&c&&(0,r.jsxs)("div",{className:"mt-6 bg-gray-50 p-4 rounded-lg border border-gray-200",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,r.jsx)("h3",{className:"text-lg font-bold",children:"Szczeg\xf3\u0142y umowy dzier\u017cawy"}),(0,r.jsx)("button",{onClick:()=>p(!1),className:"text-gray-500 hover:text-gray-700",children:"Zamknij"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Informacje podstawowe"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"ID umowy:"}),(0,r.jsx)("span",{className:"font-mono",children:c.id})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Region:"}),(0,r.jsx)("span",{children:c.regionName})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Powierzchnia:"}),(0,r.jsxs)("span",{children:[c.size," ha"]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Jako\u015b\u0107 dzia\u0142ki:"}),(0,r.jsx)("span",{children:"high"===c.quality?"Wysoka":"medium"===c.quality?"\u015arednia":"Niska"})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Typ projektu:"}),(0,r.jsx)("span",{children:c.projectType||"Nie okre\u015blono"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Warunki finansowe"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Cena ca\u0142kowita:"}),(0,r.jsxs)("span",{className:"font-medium",children:[null===(e=c.totalPrice)||void 0===e?void 0:e.toLocaleString()," PLN"]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Czynsz miesi\u0119czny:"}),(0,r.jsxs)("span",{children:[null===(t=c.monthlyRent)||void 0===t?void 0:t.toLocaleString()," PLN"]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Kaucja:"}),(0,r.jsxs)("span",{children:[null===(n=c.deposit)||void 0===n?void 0:n.toLocaleString()," PLN"]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"D\u0142ugo\u015b\u0107 umowy:"}),(0,r.jsxs)("span",{children:[c.contractLength||29," lat"]})]})]})]})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Terminy"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Data zawarcia:"}),(0,r.jsx)("span",{children:f(c.startDate)})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Data wyga\u015bni\u0119cia:"}),(0,r.jsx)("span",{children:f(c.endDate)})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Pozosta\u0142y czas:"}),(0,r.jsx)("span",{children:(()=>{try{const e=new Date(c.endDate),t=new Date(o.gameDate),n=Math.abs(e-t);return`${Math.floor(n/31536e6)} lat`}catch(e){return"B\u0142\u0105d obliczenia"}})()})]})]})]}),(0,r.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:()=>(c.id,void l("Funkcja renegocjacji umowy dzier\u017cawy jest w trakcie rozwoju.","info")),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Renegocjuj umow\u0119"}),(0,r.jsx)("button",{onClick:()=>y(c.id),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Wypowiedz umow\u0119"})]})]})]})},Ig=()=>{const[e,t]=(0,i.useState)("overview"),{state:n,dispatch:a}=d(),{state:s,showNotification:o,dispatch:l}=mf(),c=Ly(),[u,h]=(0,i.useState)(!1),[p,m]=(0,i.useState)(!1),[f,y]=(0,i.useState)(""),[g,v]=(0,i.useState)(!1),[w,x]=(0,i.useState)(null),[b,j]=(0,i.useState)(null);(0,i.useEffect)((()=>{try{if(!n)throw new Error("Dane gracza s\u0105 niedost\u0119pne");if(n.staff){const e=["scouts","developers","lawyers","envSpecialists","lobbyists"].filter((e=>!n.staff[e]));if(e.length>0){const t={};e.forEach((e=>{t[e]=[]})),a({type:"UPDATE_STAFF_STRUCTURE",payload:t}),o("Zaktualizowano struktur\u0119 danych personelu","info")}n.projects||a({type:"UPDATE_PLAYER",payload:{projects:[]}}),n.reputationHistory||a({type:"UPDATE_PLAYER",payload:{reputationHistory:[]}}),n.illegals&&n.illegals.illegalActionHistory||a({type:"UPDATE_PLAYER",payload:{illegals:{...n.illegals||{},illegalActionHistory:[]}}}),n.economicMetrics||a({type:"UPDATE_PLAYER",payload:{economicMetrics:{totalInvestment:0,totalRevenue:0,totalExpenses:0,avgROI:0}}}),n.reputationFactors||a({type:"UPDATE_PLAYER",payload:{reputationFactors:{legalCompliance:1,environmentalImpact:1,communityRelations:1,projectQuality:1,transparency:1,grayAreaActivity:1}}}),n.activeReputationInitiatives||a({type:"UPDATE_PLAYER",payload:{activeReputationInitiatives:[]}}),h(!0)}else a({type:"INITIALIZE_PLAYER",payload:{cash:1e6,reputation:50,installedCapacity:0,rtbCapacity:0,staff:{scouts:[],developers:[],lawyers:[],envSpecialists:[],lobbyists:[]},projects:[],reputationHistory:[],illegals:{illegalActionHistory:[]},economicMetrics:{totalInvestment:0,totalRevenue:0,totalExpenses:0,avgROI:0}}}),o("Inicjalizacja danych gracza...","info")}catch(e){console.error("B\u0142\u0105d podczas inicjalizacji danych:",e),m(!0),y(e.message||"B\u0142\u0105d podczas \u0142adowania zarz\u0105dzania sp\xf3\u0142k\u0105"),o("B\u0142\u0105d podczas \u0142adowania zarz\u0105dzania sp\xf3\u0142k\u0105.","error")}}),[n,a,o]);const k=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{x(e),j(t),v(!0)}catch(n){console.error("B\u0142\u0105d podczas otwierania panelu bocznego:",n),o("Wyst\u0105pi\u0142 b\u0142\u0105d podczas otwierania panelu","error")}},N=()=>{try{v(!1),setTimeout((()=>{x(null),j(null)}),300)}catch(e){console.error("B\u0142\u0105d podczas zamykania panelu bocznego:",e)}},z=(n,i)=>(0,r.jsx)("button",{className:`px-4 py-2 ${e===n?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"} rounded-md shadow-sm transition`,onClick:e=>{e.preventDefault(),e.stopPropagation(),t(n)},children:i});(0,i.useEffect)((()=>{const e=e=>{if(e.target.closest(".company-view-container"))return;const t=e.target.closest("a[href], button[data-nav]");if(t){const n=t.getAttribute("href")||t.getAttribute("data-nav");if("company"!==n&&"#company"!==n)return;e.preventDefault(),e.stopPropagation()}};return document.addEventListener("click",e,!0),()=>{document.removeEventListener("click",e,!0)}}),[]),(0,i.useEffect)((()=>{try{localStorage.setItem("companyViewActiveTab",e)}catch(t){console.error("Nie mo\u017cna zapisa\u0107 stanu zak\u0142adki:",t)}}),[e]),(0,i.useEffect)((()=>{try{const e=localStorage.getItem("companyViewActiveTab");e&&t(e)}catch(e){console.error("Nie mo\u017cna wczyta\u0107 stanu zak\u0142adki:",e)}}),[]);return p?(0,r.jsx)("div",{className:"container mx-auto p-4",children:(0,r.jsxs)("div",{className:"bg-red-100 p-8 rounded-lg text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-red-700 mb-4",children:"B\u0142\u0105d podczas \u0142adowania"}),(0,r.jsx)("p",{className:"text-red-700 mb-4",children:f||"Wyst\u0105pi\u0142 problem podczas \u0142adowania danych zarz\u0105dzania sp\xf3\u0142k\u0105."}),(0,r.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",onClick:()=>{l({type:"SET_SCREEN",payload:"home"})},children:"Wr\xf3\u0107 do ekranu g\u0142\xf3wnego"})]})}):u?(0,r.jsxs)("div",{className:"container mx-auto p-4 company-view-container",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Zarz\u0105dzanie firm\u0105"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:e=>{e.preventDefault(),e.stopPropagation(),k("reputation_initiatives")},children:"Inicjatywy reputacyjne"}),(0,r.jsx)("button",{className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",onClick:e=>{e.preventDefault(),e.stopPropagation(),k("illegal_actions")},children:"Szara strefa"})]})]}),(0,r.jsxs)("div",{className:"flex mb-6 space-x-2 border-b pb-3",children:[z("overview","Przegl\u0105d firmy"),z("projects","Projekty"),z("staff","Pracownicy"),z("finances","Finanse"),z("reputation","Reputacja"),z("upgrades","Ulepszenia")]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg min-h-[600px]",children:["overview"===e&&(0,r.jsx)(Sg,{}),"projects"===e&&(0,r.jsx)(ng,{}),"staff"===e&&(0,r.jsx)(zg,{}),"finances"===e&&(0,r.jsx)(fg,{}),"reputation"===e&&(0,r.jsx)(Ng,{}),"upgrades"===e&&(0,r.jsx)(Eg,{}),"staff"!==e&&(0,r.jsx)("div",{className:"mt-8",children:(0,r.jsx)(Pg,{})})]}),(()=>{if(!g)return null;try{switch(w){case"illegal_actions":return(0,r.jsx)(ig,{title:"Szara strefa",isOpen:g,onClose:N,variant:"illegal",children:(0,r.jsx)(dg,{onClose:N})});case"reputation_initiatives":return(0,r.jsx)(ig,{title:"Inicjatywy reputacyjne",isOpen:g,onClose:N,variant:"reputation",children:(0,r.jsx)(ky,{onClose:N})});case"staff_details":return(0,r.jsx)(ig,{title:"Szczeg\xf3\u0142y pracownika",isOpen:g,onClose:N,variant:"staff",children:(0,r.jsx)(mg,{staffId:null===b||void 0===b?void 0:b.id,staffType:null===b||void 0===b?void 0:b.type,onClose:N,onFire:(e,t)=>{c&&"function"===typeof c.fireStaff?(c.fireStaff(t,e),N()):o("Funkcja zwalniania pracownik\xf3w jest niedost\u0119pna","error")},onTrain:()=>{o("Funkcja szkolenia jest w trakcie rozwoju","info"),N()},onAssign:()=>{o("Funkcja przydzielania jest w trakcie rozwoju","info"),N()}})});case"finance":return(0,r.jsx)(ig,{title:"Panel finansowy",isOpen:g,onClose:N,variant:"finance",children:(0,r.jsx)(fg,{onClose:N})});case"company_upgrades":return(0,r.jsx)(ig,{title:"Ulepszenia firmowe",isOpen:g,onClose:N,variant:"upgrade",children:(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Ulepszenia firmowe"}),(0,r.jsx)("p",{className:"mb-4",children:"W tym miejscu b\u0119dziesz m\xf3g\u0142 ulepsza\u0107 swoj\u0105 firm\u0119, zwi\u0119kszaj\u0105c jej efektywno\u015b\u0107, reputacj\u0119 i mo\u017cliwo\u015bci."}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:[(0,r.jsxs)("div",{className:"border p-3 rounded-lg",children:[(0,r.jsx)("h3",{className:"font-bold",children:"Biuro"}),(0,r.jsx)("p",{className:"text-sm mb-2",children:"Zwi\u0119ksza morale pracownik\xf3w i szybko\u015b\u0107 pracy"}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"Poziom: 1"}),(0,r.jsx)("button",{className:"px-3 py-1 bg-blue-500 text-white rounded disabled:bg-gray-300",disabled:!0,children:"Ulepsz (250,000 PLN)"})]})]}),(0,r.jsxs)("div",{className:"border p-3 rounded-lg",children:[(0,r.jsx)("h3",{className:"font-bold",children:"Laboratoria"}),(0,r.jsx)("p",{className:"text-sm mb-2",children:"Przyspiesza badania i analizy"}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{children:"Poziom: 0"}),(0,r.jsx)("button",{className:"px-3 py-1 bg-blue-500 text-white rounded",children:"Kup (150,000 PLN)"})]})]})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-gray-500 italic mb-2",children:"Wi\u0119cej ulepsze\u0144 b\u0119dzie dost\u0119pnych wkr\xf3tce"}),(0,r.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:N,children:"Zamknij"})]})]})});default:return null}}catch(e){return console.error("B\u0142\u0105d podczas renderowania panelu bocznego:",e),(0,r.jsx)(ig,{title:"B\u0142\u0105d",isOpen:g,onClose:N,variant:"error",children:(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-red-600 mb-4",children:"Wyst\u0105pi\u0142 b\u0142\u0105d"}),(0,r.jsx)("p",{className:"mb-4",children:"Nie uda\u0142o si\u0119 za\u0142adowa\u0107 \u017c\u0105danego panelu."}),(0,r.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:N,children:"Zamknij"})]})})}})()]}):(0,r.jsx)("div",{className:"container mx-auto p-4",children:(0,r.jsxs)("div",{className:"bg-blue-50 p-8 rounded-lg text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-blue-700 mb-4",children:"\u0141adowanie danych"}),(0,r.jsx)("p",{className:"text-blue-700 mb-4",children:"Trwa \u0142adowanie danych zarz\u0105dzania sp\xf3\u0142k\u0105..."}),(0,r.jsx)("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto"})]})})},Ag=Lf("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Mg=Lf("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),Dg=Lf("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),Rg=Lf("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),Og={container:{display:"flex",flexDirection:"column",height:"100%",width:"100%",maxHeight:"85vh",position:"relative",overflowY:"hidden"},header:{padding:"1rem",borderBottom:"1px solid #e5e7eb"},tabsContainer:{display:"flex",borderBottom:"1px solid #e5e7eb",overflow:"hidden",position:"relative"},mainContent:{display:"flex",flexGrow:1,overflow:"hidden",position:"relative"},sidebar:{width:"220px",borderRight:"1px solid #e5e7eb",background:"#f9fafb",overflow:"auto",height:"100%",padding:"0.75rem"},content:{flexGrow:1,height:"100%",overflowY:"auto",position:"relative"},eventsList:{padding:"1rem",overflowY:"auto",height:"100%",transition:"width 0.3s ease-in-out"},eventDetails:{padding:"1rem",borderLeft:"1px solid #e5e7eb",background:"#f9fafb",width:"50%",height:"100%",overflowY:"auto"},noEvents:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",padding:"2rem",color:"#6b7280",textAlign:"center"}},Lg=[],Fg={},Ug={},Vg=e=>{let{children:t,fallback:n}=e;const[a,s]=(0,i.useState)(!1),[o,l]=(0,i.useState)(null);return(0,i.useEffect)((()=>{const e=e=>{console.error("Przechwycony b\u0142\u0105d w EventsView:",e),l(e),s(!0)};return window.addEventListener("error",e),()=>window.removeEventListener("error",e)}),[]),a?(0,r.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md text-red-700",children:[(0,r.jsxs)("h3",{className:"font-bold mb-2 flex items-center",children:[(0,r.jsx)(Hf,{className:"w-5 h-5 mr-2"}),"Wyst\u0105pi\u0142 b\u0142\u0105d w panelu wydarze\u0144"]}),(0,r.jsx)("p",{className:"mb-2",children:(null===o||void 0===o?void 0:o.message)||"Nieznany b\u0142\u0105d podczas renderowania komponentu EventsView."}),(0,r.jsx)("button",{className:"px-3 py-1 bg-red-600 text-white rounded-md hover:bg-red-700",onClick:()=>{s(!1),l(null)},children:"Spr\xf3buj ponownie"})]}):(0,r.jsx)(r.Fragment,{children:t})};function $g(e){return(0,r.jsx)(Vg,{children:(0,r.jsx)(Bg,{...e})})}const Bg=e=>{let{eventsState:t={events:Lg},eventsDispatch:n,gameState:a=Fg,gameDispatch:s,playerState:o=Ug,playerDispatch:l,selectedEvent:c=null,setSelectedEvent:d=null}=e;if(!t||!a||!o)return(0,r.jsxs)("div",{className:"p-4 text-center",children:[(0,r.jsx)(Hf,{className:"w-12 h-12 mx-auto text-red-500 mb-2"}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-red-600",children:"Brak danych"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Nie mo\u017cna za\u0142adowa\u0107 panelu wydarze\u0144 z powodu braku wymaganych danych. Od\u015bwie\u017c stron\u0119 lub skontaktuj si\u0119 z administratorem."})]});const[u,h]=(0,i.useState)("all"),[p,m]=(0,i.useState)(null),[f,y]=(0,i.useState)(""),[g,v]=(0,i.useState)(!1),[w,x]=(0,i.useState)("all"),[b,j]=(0,i.useState)("all"),[k,N]=(0,i.useState)("all"),[z,_]=(0,i.useState)("all"),[E,S]=(0,i.useState)(!1),[T,C]=(0,i.useState)(!1),[P,I]=(0,i.useState)(!1),[A,M]=(0,i.useState)(!1),D=(0,i.useRef)(null),R=(0,i.useRef)(null),O=((0,i.useRef)(null),null!==c?c:p),L=e=>{d?d(e):m(e)};(0,i.useEffect)((()=>{const e=e=>{try{R.current&&!R.current.contains(e.target)&&v(!1)}catch(t){console.error("B\u0142\u0105d przy obs\u0142udze klikni\u0119cia poza filtry:",t)}};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),(0,i.useEffect)((()=>{if(O){I(!0);const e=setTimeout((()=>{I(!1)}),300);return()=>clearTimeout(e)}}),[O]),(0,i.useEffect)((()=>{if(O&&n)try{const e=setTimeout((()=>{O.read||n({type:"MARK_EVENT_READ",payload:O.id})}),5e3);return()=>clearTimeout(e)}catch(e){console.error("B\u0142\u0105d przy oznaczaniu wydarzenia jako przeczytane:",e)}}),[O,n]);const F=(0,i.useMemo)((()=>Array.isArray(null===t||void 0===t?void 0:t.events)?t.events:[]),[null===t||void 0===t?void 0:t.events]),U=(0,i.useMemo)((()=>F&&a?F.filter((e=>!e.expires||e.expires>(a.day||0))):[]),[F,null===a||void 0===a?void 0:a.day]),V=(0,i.useMemo)((()=>{if(!U)return{national:[],regional:[],local:[],projects:[],organization:[],special:[],regionalByVoivodeship:{}};const e=U.filter((e=>"national"===e.scope||"global"===e.scope)),t=U.filter((e=>"regional"===e.scope)),n=U.filter((e=>"county"===e.scope)),i=U.filter((e=>"project"===e.scope||"project_event"===e.type)),a=U.filter((e=>"staff_event"===e.type||"audit_event"===e.type||"illegal_event"===e.type||"reputation_event"===e.type||"organization"===e.scope)),r=U.filter((e=>e.requiresDecision||"special_event"===e.type||"special"===e.severity)),s={};return t.forEach((e=>{e.regionId&&(s[e.regionId]||(s[e.regionId]=[]),s[e.regionId].push(e))})),{national:e,regional:t,local:n,projects:i,organization:a,special:r,regionalByVoivodeship:s}}),[U]),$=(0,i.useMemo)((()=>[{id:"dolnoslaskie",name:"Dolno\u015bl\u0105skie"},{id:"kujawsko-pomorskie",name:"Kujawsko-Pomorskie"},{id:"lubelskie",name:"Lubelskie"},{id:"lubuskie",name:"Lubuskie"},{id:"lodzkie",name:"\u0141\xf3dzkie"},{id:"malopolskie",name:"Ma\u0142opolskie"},{id:"mazowieckie",name:"Mazowieckie"},{id:"opolskie",name:"Opolskie"},{id:"podkarpackie",name:"Podkarpackie"},{id:"podlaskie",name:"Podlaskie"},{id:"pomorskie",name:"Pomorskie"},{id:"slaskie",name:"\u015al\u0105skie"},{id:"swietokrzyskie",name:"\u015awi\u0119tokrzyskie"},{id:"warminsko-mazurskie",name:"Warmi\u0144sko-Mazurskie"},{id:"wielkopolskie",name:"Wielkopolskie"},{id:"zachodniopomorskie",name:"Zachodniopomorskie"}]),[]),B=(0,i.useMemo)((()=>{let e=(()=>{if(!V)return[];let e=[];switch(z){case"krajowe":e=V.national||[];break;case"regionalne":e=V.regional||[],"all"!==k&&(e=e.filter((e=>e.region===k)));break;case"lokalne":e=V.local||[];break;case"organizacja":e=V.organization||[];break;case"projekty":e=V.projects||[];break;case"specjalne":e=V.special||[];break;default:e=[...V.national||[],...V.regional||[],...V.local||[],...V.projects||[],...V.organization||[],...V.special||[]]}return e})();if("all"!==w&&(e=e.filter((e=>e.type===w))),"all"!==b&&(e=e.filter((e=>e.priority===b))),f.trim()){const t=f.toLowerCase();e=e.filter((e=>e.title&&e.title.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t)))}return e.sort(((e,t)=>{if(e.read!==t.read)return e.read?1:-1;if(e.priority!==t.priority){const n={high:3,medium:2,low:1};return n[t.priority]-n[e.priority]}return t.date-e.date}))}),[V,w,b,k,f,z]),W=e=>{const t=()=>{const t=e.toString().split("").reduce(((e,t)=>0|(e=(e<<5)-e+t.charCodeAt(0))),0);return.99999*Math.abs(Math.sin(t))},n=["To wydarzenie mo\u017ce wp\u0142yn\u0105\u0107 na ca\u0142y sektor OZE w Polsce.","Warto obserwowa\u0107, jak to wp\u0142ynie na inne projekty w regionie.","Sytuacja rozwija si\u0119 w interesuj\u0105cym kierunku.","Kluczowe b\u0119dzie, jak zareaguj\u0105 inni gracze na rynku.","Mo\u017ce to stworzy\u0107 nowe mo\u017cliwo\u015bci dla inwestor\xf3w.","To mo\u017ce by\u0107 punkt zwrotny dla ca\u0142ej bran\u017cy.","Podobne wydarzenia w przesz\u0142o\u015bci mia\u0142y du\u017cy wp\u0142yw na rynek.","Warto przeanalizowa\u0107, jak to wp\u0142ynie na lokaln\u0105 spo\u0142eczno\u015b\u0107.","Interesuj\u0105ca sytuacja, wymaga dalszej obserwacji.","To mo\u017ce zmieni\u0107 ca\u0142\u0105 dynamik\u0119 rynku OZE."],i=["Analityk rynku","Ekspert OZE","Konsultant bran\u017cowy","Ekonomista","Inwestor","Dziennikarz gospodarczy","Lokalny samorz\u0105dowiec","Przedstawiciel sektora","Ekspert ds. regulacji","Obserwator rynku"],a=Array.isArray(n)?n:[],r=Array.isArray(i)?i:[];if(0===a.length||0===r.length)return{text:"Brak dost\u0119pnych komentarzy.",author:"System"};const s=Math.floor(t()*a.length),o=Math.floor(t()*r.length);return{text:a[s],author:r[o],date:new Date}},q=((0,i.useMemo)((()=>a&&o?(()=>{if(!a||!o)return{date:new Date,text:"\u0141adowanie danych...",author:"System",projectReference:null};const e=["Rozpocz\u0119li\u015bmy proces screeningu grunt\xf3w pod k\u0105tem nas\u0142onecznienia i dost\u0119pu do sieci.","Odbyli\u015bmy pierwsze spotkanie z w\u0142a\u015bcicielem terenu \u2013 wykazuje zainteresowanie d\u0142ugoterminow\u0105 dzier\u017caw\u0105 pod PV.","Podpisali\u015bmy list intencyjny na dzier\u017caw\u0119 45 ha pod farm\u0119 wiatrow\u0105.","GIS wskazuje na korzystny wsp\xf3\u0142czynnik irradiacji solarnej na analizowanym terenie.","Wst\u0119pne modelowanie wskazuje na \u015brednioroczny wind yield na poziomie 2800 h.","Analiza warunk\xf3w glebowych potwierdza mo\u017cliwo\u015b\u0107 posadowienia magazynu BESS.","Zaplanowano badania gruntu pod k\u0105tem no\u015bno\u015bci dla turbin wiatrowych.","Umowa przedwst\u0119pna podpisana z opcj\u0105 przed\u0142u\u017cenia po uzyskaniu warunk\xf3w przy\u0142\u0105czenia.","Rozpocz\u0119li\u015bmy coroczny monitoring ornitologiczny i chiropterologiczny.","Wie\u017ca pomiarowa zainstalowana, zbieramy dane wietrzno\u015bci przez minimum 12 miesi\u0119cy.","Analiza zacieniania wykaza\u0142a konieczno\u015b\u0107 odsuni\u0119cia instalacji od granicy lasu.","Optymalizacja zagospodarowania terenu pozwala na zwi\u0119kszenie mocy instalacji do 40 MW.","Shadow flicker w granicach dopuszczalnych norm odleg\u0142o\u015bciowych.","Model akustyczny wykaza\u0142 konieczno\u015b\u0107 ograniczenia mocy turbin w porze nocnej.","Projekt zgodny z miejscowym planem zagospodarowania przestrzennego.","Z\u0142o\u017cyli\u015bmy wniosek o decyzj\u0119 \u015brodowiskow\u0105 dla farmy PV o mocy 100 MW.","Konsultacje spo\u0142eczne planowane na przysz\u0142y miesi\u0105c w \u015bwietlicy gminnej.","Regionalna Dyrekcja Ochrony \u015arodowiska za\u017c\u0105da\u0142a uzupe\u0142nienia raportu OO\u015a.","Gmina wyda\u0142a pozytywn\u0105 opini\u0119 dla projektu magazynu energii BESS.","Z\u0142o\u017cyli\u015bmy wniosek o wydanie warunk\xf3w przy\u0142\u0105czenia do sieci 110 kV.","OSD za\u017c\u0105da\u0142 wykonania ekspertyzy wp\u0142ywu przy\u0142\u0105czenia na system elektroenergetyczny.","Mikrositing turbin wiatrowych zoptymalizowany pod k\u0105tem wydajno\u015bci parku.","Dob\xf3r falownik\xf3w z funkcj\u0105 Q(U) i P(f) zgodnie z wymogami NC RfG.","Uzyskali\u015bmy pozwolenie na budow\u0119 dla farmy PV o mocy 50 MW."],t="number"===typeof a.day?a.day:0,n="number"===typeof a.turn?a.turn:0,i=Array.isArray(e)?e:[];if(0===i.length)return{date:new Date,text:"Brak wpis\xf3w w pami\u0119tniku.",author:"System",projectReference:null};const r=(t+n)%i.length,s=(null===o||void 0===o?void 0:o.projects)||{},l=Array.isArray(s.inDevelopment)?s.inDevelopment:[],c=Array.isArray(s.underConstruction)?s.underConstruction:[],d=Array.isArray(s.completed)?s.completed:[];let u=null;l.length>0?u=l[0]:c.length>0?u=c[0]:d.length>0&&(u=d[0]);let h={date:new Date(a.gameDate||new Date),text:i[r],author:"Developer OZE",projectReference:u?u.name:null};if(u&&u.type)switch(u.type){case"PV":h.text+=" Projekt fotowoltaiczny wymaga szczeg\xf3lnej analizy nas\u0142onecznienia i k\u0105ta nachylenia paneli.";break;case"WF":h.text+=" Dla farm wiatrowych kluczowe jest zbadanie wietrzno\u015bci terenu przez minimum 12 miesi\u0119cy.";break;case"BESS":h.text+=" Magazyn energii wymaga szczeg\xf3lnego uwzgl\u0119dnienia infrastruktury przy\u0142\u0105czeniowej i bezpiecze\u0144stwa."}return h})():{date:new Date,text:"\u0141adowanie danych...",author:"System",projectReference:null}),[null===a||void 0===a?void 0:a.day,null===a||void 0===a?void 0:a.turn,null===o||void 0===o?void 0:o.projects]),e=>{if(!e||!e.type)return(0,r.jsx)(by,{size:16,className:"text-gray-500"});switch(e.type){case"staff_event":return(0,r.jsx)(Gf,{size:16,className:"text-indigo-500"});case"project_event":return(0,r.jsx)(Yy,{size:16,className:"text-teal-500"});case"economic_event":return(0,r.jsx)(ny,{size:16,className:"text-emerald-500"});case"audit_event":return(0,r.jsx)(uy,{size:16,className:"text-amber-500"});case"illegal_event":return(0,r.jsx)(Ag,{size:16,className:"text-rose-500"});case"law_change":return(0,r.jsx)(gy,{size:16,className:"text-blue-500"});case"market_change":return(0,r.jsx)(Mg,{size:16,className:"text-purple-500"});case"regional_event":return(0,r.jsx)(Wf,{size:16,className:"text-orange-500"});case"national_event":return(0,r.jsx)(Dg,{size:16,className:"text-blue-500"});case"special_event":return(0,r.jsx)(Hf,{size:16,className:"text-red-500"});default:return(0,r.jsx)(by,{size:16,className:"text-gray-500"})}}),H=e=>{if(!e)return"text-blue-600 bg-blue-50 border-blue-200";switch(e){case"positive":return"text-green-600 bg-green-50 border-green-200";case"negative":case"high":return"text-red-600 bg-red-50 border-red-200";case"warning":case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"special":return"text-purple-600 bg-purple-50 border-purple-200";default:return"text-blue-600 bg-blue-50 border-blue-200"}},G=e=>{if(!e)return"Inne";return{staff_event:"Personel",project_event:"Projekt",economic_event:"Gospodarka",political_event:"Polityka",social_event:"Spo\u0142eczne",audit_event:"Audyt",illegal_event:"Naruszenie",law_change:"Prawodawstwo",market_change:"Rynek",regional_event:"Regionalne",national_event:"Krajowe",special_event:"Specjalne"}[e]||"Inne"},K=e=>{if(!e)return"Inny";return{global:"Globalny",national:"Krajowy",regional:"Regionalny",county:"Powiatowy",project:"Projektowy",organization:"Organizacja",company:"Firma",local:"Lokalny"}[e]||e},Q=e=>{if(!e)return"Data nieznana";if(e instanceof Date||"number"===typeof e&&e>1e5){return new Date(e).toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"})}if(!a||!a.gameDate)return`Tura ${e}`;const t=(a.turn||0)-e,n=new Date(a.gameDate),i=new Date(n);return i.setDate(n.getDate()-2*t),i.toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"})},Z=e=>{let{effects:t,variant:n="list"}=e;if(!t||"object"!==typeof t)return(0,r.jsx)("div",{className:"text-gray-500 text-sm",children:"Brak danych o efektach"});const i=Object.entries(t).filter((e=>{let[t,n]=e;return void 0!==n}));if(0===i.length)return(0,r.jsx)("div",{className:"text-gray-500 text-sm",children:"Brak efekt\xf3w"});const a=e=>({marketModifier:"Wp\u0142yw na rynek",loanInterestRate:"Stopy procentowe",permitTimeModifier:"Czas uzyskania pozwole\u0144",reputationChange:"Zmiana reputacji",buildCostModifier:"Koszty budowy",projectEfficiency:"Efektywno\u015b\u0107 projektu",staffProductivity:"Produktywno\u015b\u0107 personelu"}[e]||e),s=(e,t)=>{if(e.includes("Modifier")){const e=(100*(t-1)).toFixed(1);return`${e>0?"+":""}${e}%`}return"reputationChange"===e||"projectEfficiency"===e||"staffProductivity"===e?`${t>0?"+":""}${t}`:t.toString()};return"grid"===n?(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2",children:i.map((e=>{let[t,n]=e;return(0,r.jsxs)("div",{className:"flex justify-between p-2 bg-gray-100 rounded",children:[(0,r.jsxs)("span",{className:"font-medium",children:[a(t),":"]}),(0,r.jsx)("span",{className:n>1||n>0?"text-green-600 font-bold":"text-red-600 font-bold",children:s(t,n)})]},t)}))}):(0,r.jsx)("ul",{className:"list-disc pl-5 space-y-1",children:i.map((e=>{let[t,n]=e;return(0,r.jsxs)("li",{children:[(0,r.jsxs)("span",{className:"font-medium",children:[a(t),":"]}),(0,r.jsx)("span",{className:n>1||n>0?"text-green-600 ml-1":"text-red-600 ml-1",children:s(t,n)})]},t)}))})};(0,i.useMemo)((()=>{if(!O)return[];try{const e=O.severity||"medium",t="high"===e||"special"===e?3:"medium"===e?2:1,n=[];for(let i=0;i<t;i++)n.push(W(O.id+i));return n}catch(e){return console.error("B\u0142\u0105d przy generowaniu komentarzy:",e),[]}}),[O]),(0,i.useMemo)((()=>{if(!O)return null;const e={};try{switch(O.type){case"economic_event":e.marketModifier=1.05,e.loanInterestRate=.98;break;case"political_event":e.permitTimeModifier=1.1,e.reputationChange=-2;break;case"project_event":e.buildCostModifier=1.03,e.projectEfficiency=5;break;case"staff_event":e.staffProductivity=-3;break;default:Math.random()>.5&&(e.marketModifier=1.02)}return O.effects||e}catch(t){return console.error("B\u0142\u0105d przy generowaniu wp\u0142ywu globalnego:",t),{}}}),[O]),(0,i.useMemo)((()=>{if(!t||!Array.isArray(t.events))return[];try{return t.events.filter((e=>e&&(e.isMilestone||e.requiresDecision||"high"===e.severity||"special"===e.severity||"high"===e.priority))).sort(((e,t)=>{const n=e.turn||e.date||0;return(t.turn||t.date||0)-n})).slice(0,5)}catch(e){return console.error("B\u0142\u0105d przy generowaniu kamieni milowych:",e),[]}}),[null===t||void 0===t?void 0:t.events]);return(0,r.jsxs)("div",{style:Og.container,className:"events-view-container",children:[(0,r.jsxs)("div",{style:Og.header,className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-bold",children:"Panel Wydarze\u0144"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"\u015aled\u017a wa\u017cne wydarzenia w bran\u017cy OZE i reaguj na zmieniaj\u0105c\u0105 si\u0119 sytuacj\u0119"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("div",{className:"relative mr-2",children:[(0,r.jsx)("input",{type:"text",value:f,onChange:e=>y(e.target.value),placeholder:"Szukaj wydarze\u0144...",className:"border rounded pl-9 pr-3 py-1.5 w-64"}),(0,r.jsx)(gg,{className:"h-4 w-4 text-gray-400 absolute top-2 left-3"})]}),(0,r.jsxs)("button",{onClick:()=>v(!g),className:"flex items-center rounded border px-3 py-1.5 hover:bg-gray-50",children:[(0,r.jsx)(yg,{className:"h-4 w-4 mr-1"}),"Filtry"]})]})]}),(0,r.jsxs)("div",{style:Og.tabsContainer,className:"overflow-x-auto whitespace-nowrap",children:[(0,r.jsx)("button",{onClick:()=>_("all"),className:"px-4 py-2 font-medium "+("all"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(Dg,{size:16,className:"mr-1"}),"Wszystkie",(0,r.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(U)?U.length:0})]})}),(0,r.jsx)("button",{onClick:()=>_("krajowe"),className:"px-4 py-2 font-medium "+("krajowe"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(Dg,{size:16,className:"mr-1"}),"Krajowe",(0,r.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(null===V||void 0===V?void 0:V.national)?V.national.length:0})]})}),(0,r.jsx)("button",{onClick:()=>_("regionalne"),className:"px-4 py-2 font-medium "+("regionalne"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(Wf,{size:16,className:"mr-1"}),"Regionalne",(0,r.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(null===V||void 0===V?void 0:V.regional)?V.regional.length:0})]})}),(0,r.jsx)("button",{onClick:()=>_("lokalne"),className:"px-4 py-2 font-medium "+("lokalne"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(Wf,{size:16,className:"mr-1"}),"Lokalne",(0,r.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(null===V||void 0===V?void 0:V.local)?V.local.length:0})]})}),(0,r.jsx)("button",{onClick:()=>_("organizacja"),className:"px-4 py-2 font-medium "+("organizacja"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(gy,{size:16,className:"mr-1"}),"Organizacja",(0,r.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(null===V||void 0===V?void 0:V.organization)?V.organization.length:0})]})}),(0,r.jsx)("button",{onClick:()=>_("projekty"),className:"px-4 py-2 font-medium "+("projekty"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(Yy,{size:16,className:"mr-1"}),"Projekty",(0,r.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(null===V||void 0===V?void 0:V.projects)?V.projects.length:0})]})}),(0,r.jsx)("button",{onClick:()=>_("specjalne"),className:"px-4 py-2 font-medium "+("specjalne"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(Ag,{size:16,className:"mr-1"}),"Specjalne",(0,r.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(null===V||void 0===V?void 0:V.special)?V.special.length:0})]})})]}),g&&(0,r.jsx)("div",{className:"p-3 border-b",ref:R,children:(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Typ wydarzenia"}),(0,r.jsxs)("select",{value:w,onChange:e=>x(e.target.value),className:"w-full border rounded px-2 py-1.5 text-sm",children:[(0,r.jsx)("option",{value:"all",children:"Wszystkie typy"}),(0,r.jsx)("option",{value:"economic_event",children:"Ekonomiczne"}),(0,r.jsx)("option",{value:"political_event",children:"Polityczne"}),(0,r.jsx)("option",{value:"social_event",children:"Spo\u0142eczne"}),(0,r.jsx)("option",{value:"environmental_event",children:"\u015arodowiskowe"}),(0,r.jsx)("option",{value:"technological_event",children:"Technologiczne"}),(0,r.jsx)("option",{value:"project_event",children:"Projektowe"}),(0,r.jsx)("option",{value:"staff_event",children:"Kadrowe"}),(0,r.jsx)("option",{value:"reputation_event",children:"Reputacyjne"}),(0,r.jsx)("option",{value:"special_event",children:"Specjalne"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Priorytet"}),(0,r.jsxs)("select",{value:b,onChange:e=>j(e.target.value),className:"w-full border rounded px-2 py-1.5 text-sm",children:[(0,r.jsx)("option",{value:"all",children:"Wszystkie priorytety"}),(0,r.jsx)("option",{value:"high",children:"Wysoki"}),(0,r.jsx)("option",{value:"medium",children:"\u015aredni"}),(0,r.jsx)("option",{value:"low",children:"Niski"})]})]}),"regionalne"===z&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Wojew\xf3dztwo"}),(0,r.jsxs)("select",{value:k,onChange:e=>N(e.target.value),className:"w-full border rounded px-2 py-1.5 text-sm",children:[(0,r.jsx)("option",{value:"all",children:"Wszystkie wojew\xf3dztwa"}),$.map((e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id)))]})]})]})}),(0,r.jsx)("div",{style:Og.mainContent,className:"flex-grow overflow-hidden",children:(0,r.jsxs)("div",{className:"flex gap-4 h-full",children:[(0,r.jsx)("div",{style:Og.eventsList,className:"transition-all duration-300 ease-in-out "+(O?"w-1/2":"w-full"),children:(0,r.jsx)("div",{children:Array.isArray(B)&&B.length>0?B.map((e=>(0,r.jsxs)("div",{className:"mb-3 p-3 border rounded-lg cursor-pointer transition-shadow hover:shadow-md "+(null!==e&&void 0!==e&&e.read?"bg-white":"bg-blue-50"),onClick:()=>{e&&(L(e),!e.read&&n&&n({type:"MARK_EVENT_READ",payload:e.id}))},children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:`flex h-6 w-6 rounded-full items-center justify-center ${H((null===e||void 0===e?void 0:e.severity)||"neutral")}`,children:q(e)}),(0,r.jsx)("h3",{className:"font-medium ml-2 flex-1",children:(null===e||void 0===e?void 0:e.title)||"Wydarzenie bez tytu\u0142u"})]}),(0,r.jsx)("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:Q((null===e||void 0===e?void 0:e.turn)||new Date)})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:(null===e||void 0===e?void 0:e.description)||"Brak opisu"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[(null===e||void 0===e?void 0:e.scope)&&(0,r.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 rounded-full text-xs",children:K(e.scope)}),(null===e||void 0===e?void 0:e.type)&&(0,r.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 rounded-full text-xs",children:G(e.type)}),(null===e||void 0===e?void 0:e.requiresDecision)&&(0,r.jsx)("span",{className:"px-2 py-0.5 bg-red-100 text-red-800 rounded-full text-xs",children:"Wymaga decyzji"})]})]},(null===e||void 0===e?void 0:e.id)||Math.random().toString()))):(0,r.jsxs)("div",{style:Og.noEvents,children:[(0,r.jsx)(Rg,{className:"h-12 w-12 text-gray-300 mb-2"}),(0,r.jsx)("h3",{className:"text-lg font-medium mb-1",children:"Brak wydarze\u0144"}),(0,r.jsx)("p",{className:"text-sm",children:"Nie ma obecnie \u017cadnych wydarze\u0144 do wy\u015bwietlenia w wybranej kategorii."})]})})}),O&&(0,r.jsxs)("div",{style:Og.eventDetails,className:"animate-slide-in",ref:D,children:[(0,r.jsxs)("div",{className:"mb-4 pb-3 border-b flex justify-between items-start",children:[(0,r.jsx)("h2",{className:"text-xl font-bold",children:O.title||"Szczeg\xf3\u0142y wydarzenia"}),(0,r.jsx)("button",{onClick:()=>L(null),className:"p-1 hover:bg-gray-100 rounded",children:(0,r.jsx)(vy,{size:18})})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("p",{className:"text-gray-700 mb-4",children:O.description}),(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,r.jsx)(Ff,{size:16,className:"mr-1"}),(0,r.jsxs)("span",{children:["Data: ",Q(O.turn||new Date)]})]}),(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,r.jsx)(Uf,{size:16,className:"mr-1"}),(0,r.jsxs)("span",{children:["Wygasa: ",O.expires?Q(O.expires):"Nigdy"]})]}),O.region&&(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,r.jsx)(Wf,{size:16,className:"mr-1"}),(0,r.jsxs)("span",{children:["Region: ",O.region]})]}),O.projectId&&(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,r.jsx)(Yy,{size:16,className:"mr-1"}),(0,r.jsxs)("span",{children:["Projekt: ",O.projectName||O.projectId]})]}),(0,r.jsxs)("div",{className:"mt-3 flex flex-wrap gap-1",children:[O.scope&&(0,r.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 rounded-full text-xs",children:K(O.scope)}),O.type&&(0,r.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 rounded-full text-xs",children:G(O.type)}),O.severity&&(0,r.jsx)("span",{className:`px-2 py-0.5 rounded-full text-xs ${H(O.severity)}`,children:translateSeverity(O.severity)})]})]}),O.effects&&Object.keys(O.effects).length>0&&(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h3",{className:"font-medium mb-2",children:"Efekty wydarzenia:"}),(0,r.jsx)(Z,{effects:O.effects})]}),O.requiresDecision&&O.decisions&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("h3",{className:"font-medium mb-2",children:"Wymagana decyzja:"}),(0,r.jsx)("div",{className:"space-y-2",children:O.decisions.map((e=>(0,r.jsxs)("button",{className:"w-full p-3 border rounded hover:bg-gray-50 text-left flex justify-between items-center",onClick:()=>(e=>{if(O&&O.options&&n)try{if(!O.options.find((t=>t.id===e)))return;n({type:"EVENT_DECISION",payload:{eventId:O.id,optionId:e}}),L(null)}catch(t){console.error("B\u0142\u0105d przy podejmowaniu decyzji:",t)}})(O.id,e.id),children:[(0,r.jsx)("span",{children:e.label}),(0,r.jsx)("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:e.effects.reputationImpact?`Reputacja: ${e.effects.reputationImpact>0?"+":""}${e.effects.reputationImpact}`:e.effects.cashImpact?`Got\xf3wka: ${e.effects.cashImpact>0?"+":""}${e.effects.cashImpact.toLocaleString()} PLN`:"Efekt specjalny"})]},e.id)))})]})]})]})})]})};class Wg extends i.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("B\u0142\u0105d w EventsView:",e,t)}render(){return this.state.hasError?(0,r.jsxs)("div",{className:"p-8 flex flex-col items-center justify-center",children:[(0,r.jsx)(Ag,{className:"w-16 h-16 text-red-500 mb-4"}),(0,r.jsx)("h2",{className:"text-xl font-bold text-red-700 mb-2",children:"B\u0142\u0105d w panelu wydarze\u0144"}),(0,r.jsx)("p",{className:"text-gray-600 text-center mb-4",children:"Panel wydarze\u0144 wymaga odpowiednich kontekst\xf3w aplikacji. Upewnij si\u0119, \u017ce komponent jest u\u017cywany wewn\u0105trz:"}),(0,r.jsxs)("ul",{className:"list-disc pl-5 text-gray-600 mb-4",children:[(0,r.jsx)("li",{children:"EventsProvider"}),(0,r.jsx)("li",{children:"GameProvider"}),(0,r.jsx)("li",{children:"PlayerProvider"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:this.state.error?this.state.error.message:"Nieznany b\u0142\u0105d"})]}):this.props.children}}const qg=e=>e&&"object"===typeof e,Hg=(e,t)=>{try{const n=e();return n||(console.warn(`${t} nie jest dost\u0119pny`),null)}catch(n){return console.error(`B\u0142\u0105d przy pobieraniu ${t}:`,n),null}},Gg=()=>{const[e,t]=(0,i.useState)(null),[n,a]=(0,i.useState)(!1),[s,o]=(0,i.useState)(null),l=Hg(q,"EventsContext"),c=Hg(mf,"GameContext"),u=Hg(d,"PlayerContext");(0,i.useEffect)((()=>{try{const e=()=>{t(null)};return window.addEventListener("next-game-day",e),l&&c&&u?a(!0):o("Brak wymaganych kontekst\xf3w"),()=>{window.removeEventListener("next-game-day",e)}}catch(s){console.error("B\u0142\u0105d w useEffect EventsView:",s),o(s.message||"Nieznany b\u0142\u0105d")}}),[l,c,u]);const h=e=>{let{message:t}=e;return(0,r.jsxs)("div",{className:"p-8 flex flex-col items-center justify-center",children:[(0,r.jsx)(Ag,{className:"w-16 h-16 text-red-500 mb-4"}),(0,r.jsx)("h2",{className:"text-xl font-bold text-red-700 mb-2",children:"B\u0142\u0105d kontekstu"}),(0,r.jsx)("p",{className:"text-gray-600 text-center mb-4",children:"Panel wydarze\u0144 wymaga odpowiednich kontekst\xf3w aplikacji. Upewnij si\u0119, \u017ce komponent jest u\u017cywany wewn\u0105trz:"}),(0,r.jsxs)("ul",{className:"list-disc pl-5 text-gray-600 mb-4",children:[(0,r.jsx)("li",{children:"EventsProvider"}),(0,r.jsx)("li",{children:"GameProvider"}),(0,r.jsx)("li",{children:"PlayerProvider"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:t})]})};return s?(0,r.jsx)(h,{message:s}):n?qg(null===l||void 0===l?void 0:l.state)&&null!==l&&void 0!==l&&l.dispatch?qg(null===c||void 0===c?void 0:c.state)&&null!==c&&void 0!==c&&c.dispatch?qg(null===u||void 0===u?void 0:u.state)&&null!==u&&void 0!==u&&u.dispatch?(Array.isArray(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{const i=t.split(".");let a=e;for(const e of i){if(null===a||void 0===a)return n;a=a[e]}return null===a||void 0===a?n:a}catch(i){return console.error(`B\u0142\u0105d dost\u0119pu do \u015bcie\u017cki: ${t}`,i),n}}(l,"state.events"))||(console.warn("Events w EventsContext nie jest tablic\u0105. Inicjalizacja pust\u0105 tablic\u0105."),l.state&&(l.state.events=[])),(0,r.jsx)(Wg,{children:(0,r.jsx)($g,{eventsState:l.state,eventsDispatch:l.dispatch,gameState:c.state,gameDispatch:c.dispatch,playerState:u.state,playerDispatch:u.dispatch,selectedEvent:e,setSelectedEvent:t})})):(0,r.jsx)(h,{message:"PlayerContext jest niekompletny"}):(0,r.jsx)(h,{message:"GameContext jest niekompletny"}):(0,r.jsx)(h,{message:"EventsContext jest niekompletny"}):(0,r.jsxs)("div",{className:"p-8 flex flex-col items-center justify-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500 mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"\u0141adowanie panelu wydarze\u0144..."})]})},Kg=()=>(0,r.jsx)(Wg,{children:(0,r.jsx)(Gg,{})}),Qg=e=>{let{competitor:t,playerPower:n}=e;return(0,r.jsxs)("div",{className:"border rounded p-3",children:[(0,r.jsx)("h4",{className:"font-medium mb-2",children:t.name}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-medium",children:"Strategia:"})," ",Ry(t.strategy)]}),(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-medium",children:"Reputacja:"})," ",t.reputation,"/100"]}),(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-medium",children:"Tempo wzrostu:"})," ",(100*(t.growth-1)).toFixed(1),"% na tur\u0119"]}),(0,r.jsx)("div",{className:"text-sm",children:(0,r.jsx)("span",{className:"font-medium",children:"Silne regiony:"})}),(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:t.strongRegions.map((e=>(0,r.jsx)("div",{className:"text-xs bg-gray-200 px-2 py-1 rounded",children:e},e)))}),(0,r.jsx)("div",{className:"text-sm mt-2 text-gray-600 italic",children:Oy(t,n)})]})]})},Zg=e=>{let{ranking:t}=e;return(0,r.jsxs)("div",{className:"bg-white p-4 rounded shadow mb-4",children:[(0,r.jsx)("h3",{className:"font-bold text-lg mb-3",children:"Ranking deweloper\xf3w OZE"}),(0,r.jsxs)("table",{className:"min-w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-100",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"text-center p-2",children:"Miejsce"}),(0,r.jsx)("th",{className:"text-left p-2",children:"Firma"}),(0,r.jsx)("th",{className:"text-center p-2",children:"Moc RTB"}),(0,r.jsx)("th",{className:"text-center p-2",children:"Portfel projekt\xf3w"}),(0,r.jsx)("th",{className:"text-right p-2",children:"Udzia\u0142 w rynku"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-200",children:t.map(((e,n)=>{const i="player"===e.id,a=(e.rtbPower/t.reduce(((e,t)=>e+t.rtbPower),0)*100).toFixed(1);return(0,r.jsxs)("tr",{className:""+(i?"bg-blue-50":"hover:bg-gray-50"),children:[(0,r.jsx)("td",{className:"text-center p-2 font-medium",children:n+1}),(0,r.jsx)("td",{className:"p-2",children:i?(0,r.jsx)("div",{className:"font-bold text-blue-600",children:e.name}):e.name}),(0,r.jsxs)("td",{className:"text-center p-2",children:[e.rtbPower.toLocaleString()," MW"]}),(0,r.jsxs)("td",{className:"text-center p-2",children:[e.power.toLocaleString()," MW"]}),(0,r.jsx)("td",{className:"text-right p-2",children:(0,r.jsxs)("div",{className:"flex items-center justify-end",children:[(0,r.jsxs)("div",{children:[a,"%"]}),(0,r.jsx)("div",{className:"ml-2 w-16 bg-gray-200 h-2 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"h-full "+(i?"bg-blue-500":"bg-gray-500"),style:{width:`${a}%`}})})]})})]},e.id)}))})]})]})},Yg=e=>{let{playerRank:t,ranking:n,playerPower:i}=e;return(0,r.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Twoja pozycja na rynku"}),1===t?(0,r.jsxs)("div",{className:"p-3 bg-green-100 text-green-800 rounded",children:[(0,r.jsx)("div",{className:"font-bold",children:"Jeste\u015b liderem rynku!"}),(0,r.jsx)("p",{className:"text-sm mt-1",children:"Utrzymuj przewag\u0119 nad konkurencj\u0105 rozwijaj\u0105c projekty w r\xf3\u017cnych regionach."})]}):(0,r.jsxs)("div",{className:"p-3 bg-blue-100 text-blue-800 rounded",children:[(0,r.jsxs)("div",{className:"font-bold",children:["Jeste\u015b na ",t,". miejscu"]}),(0,r.jsxs)("p",{className:"text-sm mt-1",children:["Do lidera brakuje Ci ",(n[0].rtbPower-i).toLocaleString()," MW mocy w projektach RTB."]})]}),(0,r.jsxs)("div",{className:"mt-3 text-sm",children:[(0,r.jsxs)("p",{children:["Tw\xf3j udzia\u0142 w rynku: ",(i/n.reduce(((e,t)=>e+t.rtbPower),0)*100).toFixed(1),"%"]}),(0,r.jsx)("p",{className:"mt-1",children:"Tempo wzrostu twojego portfela zale\u017cy od liczby projekt\xf3w i zatrudnionych specjalist\xf3w."})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("div",{className:"font-medium mb-2",children:"Post\u0119p do celu (100 GW):"}),(0,r.jsx)("div",{className:"w-full bg-gray-200 h-4 rounded-full overflow-hidden mt-1",children:(0,r.jsx)("div",{className:"h-full bg-green-500 relative",style:{width:`${Math.min(100,i/1e5*100)}%`},children:(0,r.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center text-xs text-white font-bold",children:[(i/1e5*100).toFixed(1),"%"]})})})]})]})},Jg=e=>{let{competitors:t,playerPower:n}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Analiza konkurent\xf3w"}),(0,r.jsx)("ul",{className:"text-sm space-y-2",children:t.map((e=>(0,r.jsxs)("li",{className:"flex",children:[(0,r.jsx)("div",{className:"text-blue-600 font-bold mr-2",children:"\u2022"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("span",{className:"font-medium",children:[e.name,":"]})," ",Oy(e,n)]})]},e.id)))})]}),(0,r.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Porady strategiczne"}),(0,r.jsxs)("ul",{className:"text-sm space-y-2",children:[(0,r.jsxs)("li",{className:"flex",children:[(0,r.jsx)("div",{className:"text-green-600 font-bold mr-2",children:"\u2022"}),(0,r.jsx)("div",{children:"Skupiaj si\u0119 na regionach z dobrymi warunkami wiatrowymi/s\u0142onecznymi i nisk\u0105 konkurencj\u0105."})]}),(0,r.jsxs)("li",{className:"flex",children:[(0,r.jsx)("div",{className:"text-green-600 font-bold mr-2",children:"\u2022"}),(0,r.jsx)("div",{children:"Zatrudniaj do\u015bwiadczonych specjalist\xf3w, aby przyspieszy\u0107 rozw\xf3j projekt\xf3w."})]}),(0,r.jsxs)("li",{className:"flex",children:[(0,r.jsx)("div",{className:"text-green-600 font-bold mr-2",children:"\u2022"}),(0,r.jsx)("div",{children:"Dywersyfikuj portfolio projekt\xf3w geograficznie, aby minimalizowa\u0107 ryzyko."})]}),(0,r.jsxs)("li",{className:"flex",children:[(0,r.jsx)("div",{className:"text-green-600 font-bold mr-2",children:"\u2022"}),(0,r.jsx)("div",{children:"Monitoruj ruchy konkurencji i unikaj region\xf3w, w kt\xf3rych s\u0105 dominuj\u0105cy gracze."})]}),(0,r.jsxs)("li",{className:"flex",children:[(0,r.jsx)("div",{className:"text-green-600 font-bold mr-2",children:"\u2022"}),(0,r.jsx)("div",{children:"Inwestuj w projekty z wysokim ROI, aby maksymalizowa\u0107 zwrot z inwestycji."})]})]})]}),(0,r.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Cel gry"}),(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("p",{children:"Twoim celem jest osi\u0105gni\u0119cie 100,000 MW (100 GW) mocy w projektach RTB jako pierwszy deweloper."}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("div",{className:"font-medium",children:"Post\u0119p do celu:"}),(0,r.jsx)("div",{className:"w-full bg-gray-200 h-4 rounded-full overflow-hidden mt-1",children:(0,r.jsx)("div",{className:"h-full bg-green-500 relative",style:{width:`${Math.min(100,n/1e5*100)}%`},children:(0,r.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center text-xs text-white font-bold",children:[(n/1e5*100).toFixed(1),"%"]})})})]})]})]})]})},Xg=()=>{const{state:e}=mf(),{state:t}=d(),n=[...e.competitors].sort(((e,t)=>t.rtbPower-e.rtbPower)),i=[...n,{id:"player",name:"Twoja firma",rtbPower:t.rtbPower,power:1.2*t.rtbPower}].sort(((e,t)=>t.rtbPower-e.rtbPower)),a=i.findIndex((e=>"player"===e.id))+1;return(0,r.jsxs)("div",{className:"flex flex-1",children:[(0,r.jsxs)("div",{className:"flex-1 p-4 overflow-y-auto",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Analiza konkurencji"}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,r.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Twoja pozycja"}),(0,r.jsxs)("div",{className:"text-xl font-bold",children:[a," miejsce"]})]}),(0,r.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Twoja moc RTB"}),(0,r.jsxs)("div",{className:"text-xl font-bold",children:[t.rtbPower.toLocaleString()," MW"]})]}),(0,r.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Lider rynku"}),(0,r.jsx)("div",{className:"text-xl font-bold",children:i[0].name}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[i[0].rtbPower.toLocaleString()," MW"]})]})]}),(0,r.jsx)(Zg,{ranking:i}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,r.jsx)("h3",{className:"font-bold text-lg mb-3",children:"Strategie konkurent\xf3w"}),(0,r.jsx)("div",{className:"grid grid-cols-3 gap-4",children:n.map((e=>(0,r.jsx)(Qg,{competitor:e,playerPower:t.rtbPower},e.id)))})]})]}),(0,r.jsxs)("div",{className:"w-1/3 bg-gray-100 p-4 overflow-y-auto",children:[(0,r.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Analiza rynku i porady"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(Yg,{playerRank:a,ranking:i,playerPower:t.rtbPower}),(0,r.jsx)(Jg,{competitors:n,playerPower:t.rtbPower})]})]})]})},ev=e=>{let{children:t,title:n,className:i="",headerAction:a=null,footer:s=null,...o}=e;return(0,r.jsxs)("div",{className:`bg-white p-4 rounded shadow ${i}`,...o,children:[n&&(0,r.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,r.jsx)("h3",{className:"font-bold text-lg",children:n}),a]}),(0,r.jsx)("div",{className:"card-content",children:t}),s&&(0,r.jsx)("div",{className:"card-footer mt-4 pt-3 border-t border-gray-200",children:s})]})},tv=()=>{const{state:e,dispatch:t}=d(),{state:n,dispatch:a,showNotification:s,calculateEventsEffect:o}=mf(),{dispatch:l}=q(),[c,u]=(0,i.useState)("all"),[h,p]=(0,i.useState)("power"),[m,f]=(0,i.useState)("desc"),y=[...e.projects.filter((e=>"all"===c||("pv"===c?"PV"===e.technology:"wf"===c?"WF"===e.technology:"rtb"!==c||"ready_to_build"===e.status)))].sort(((e,t)=>{if("power"===h)return"asc"===m?e.power-t.power:t.power-e.power;if("price"===h)return"asc"===m?e.totalCost-t.totalCost:t.totalCost-e.totalCost;if("stage"===h){const n=["land_acquisition","environmental_decision","zoning_conditions","grid_connection","ready_to_build"],i=n.indexOf(e.status),a=n.indexOf(t.status);return"asc"===m?i-a:a-i}return 0})),g=t=>{var i;const a=15e4*t.power,r=o("marketModifier"),c={PV:1*n.marketPriceModifiers.PV*r,WF:1.2*n.marketPriceModifiers.WF*r,BESS:1.5*n.marketPriceModifiers.BESS*r},d=1;n.globalEvents.currentEvents.length>0&&n.globalEvents.currentEvents.forEach((e=>{const n=e.getEffect();n.technologyEffect&&n.technologyEffect.technology===t.technology&&n.technologyEffect.marketModifier&&(d*=n.technologyEffect.marketModifier)}));const u={land_acquisition:.15,environmental_decision:.35,zoning_conditions:.55,grid_connection:.85,ready_to_build:1}[t.status]||.1,h=c[t.technology]*d||1,p=1+t.power/100*.2;let m=1;n.globalEvents.currentEvents.length>0&&n.globalEvents.currentEvents.forEach((e=>{const n=e.getEffect();n.regionalEffect&&n.regionalEffect.region===t.regionId&&n.regionalEffect.marketModifier&&(m*=n.regionalEffect.marketModifier)}));const f=null===(i=e.staff.developers)||void 0===i?void 0:i.find((e=>e.id===t.assignedDeveloper)),y=f?1+f.skill/20:1;let g=null,v=1;const w=n.globalEvents.currentEvents.length>0?.05:.1;if(Math.random()<w){g=[{name:"Nag\u0142y spadek cen energii",impact:.85,description:"Ceny energii na rynku spad\u0142y o 15%, obni\u017caj\u0105c warto\u015b\u0107 projekt\xf3w OZE."},{name:"Zmiana regulacji",impact:.8,description:"Niekorzystne zmiany w ustawie o OZE obni\u017cy\u0142y warto\u015b\u0107 projekt\xf3w."},{name:"Lokalne protesty",impact:.9,description:"Protesty mieszka\u0144c\xf3w zniech\u0119caj\u0105 potencjalnych inwestor\xf3w."},{name:"Problem geologiczny",impact:.7,description:"Wykryto potencjalne problemy geologiczne na terenie projektu."},{name:"Korzystna zmiana warunk\xf3w aukcji",impact:1.15,description:"Planowane aukcje OZE z korzystnymi warunkami podnios\u0142y warto\u015b\u0107 projektu."},{name:"Wzmo\u017cone zainteresowanie inwestor\xf3w",impact:1.2,description:"Duzi inwestorzy poszukuj\u0105 projekt\xf3w w tym regionie."}][Math.random()<.7?Math.floor(4*Math.random()):Math.floor(2*Math.random())+4],v=g.impact}const x=Math.floor(a*u*h*p*m*y*v);if(g){const e=v<1?"warning":"positive";l({type:"ADD_EVENT",payload:{id:Date.now()+Math.random(),type:"economic_event",title:g.name,description:g.description,severity:e,turn:n.turn,expires:n.turn+10,projectId:t.id,effect:{type:"market_price_modifier",value:v,technology:t.technology}}}),s(`${g.name}: ${g.description} Wp\u0142yw na cen\u0119: ${(100*g.impact).toFixed(0)}%`,e)}return x},v=e=>{switch(e){case"land_acquisition":return(0,r.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:"Pozyskiwanie grunt\xf3w"});case"environmental_decision":return(0,r.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs",children:"Decyzja \u015brodowiskowa"});case"zoning_conditions":return(0,r.jsx)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs",children:"Warunki zabudowy"});case"grid_connection":return(0,r.jsx)("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 rounded-full text-xs",children:"Przy\u0142\u0105czenie"});case"ready_to_build":return(0,r.jsx)("span",{className:"px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs",children:"RTB"});default:return(0,r.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 rounded-full text-xs",children:e})}};return(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Sprzeda\u017c projekt\xf3w na gie\u0142dzie"}),(0,r.jsx)("div",{className:"bg-white p-4 rounded shadow mb-4",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Filtruj"}),(0,r.jsxs)("select",{value:c,onChange:e=>u(e.target.value),className:"border rounded px-2 py-1",children:[(0,r.jsx)("option",{value:"all",children:"Wszystkie projekty"}),(0,r.jsx)("option",{value:"pv",children:"Tylko PV"}),(0,r.jsx)("option",{value:"wf",children:"Tylko wiatrowe"}),(0,r.jsx)("option",{value:"rtb",children:"Tylko RTB"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Sortuj wed\u0142ug"}),(0,r.jsxs)("select",{value:h,onChange:e=>p(e.target.value),className:"border rounded px-2 py-1",children:[(0,r.jsx)("option",{value:"power",children:"Mocy [MW]"}),(0,r.jsx)("option",{value:"price",children:"Ceny"}),(0,r.jsx)("option",{value:"stage",children:"Etapu"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Kolejno\u015b\u0107"}),(0,r.jsxs)("select",{value:m,onChange:e=>f(e.target.value),className:"border rounded px-2 py-1",children:[(0,r.jsx)("option",{value:"asc",children:"Rosn\u0105co"}),(0,r.jsx)("option",{value:"desc",children:"Malej\u0105co"})]})]})]})}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded shadow mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-3",children:"Aktualna wycena projekt\xf3w"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Warto\u015b\u0107 projekt\xf3w zale\u017cy od etapu rozwoju, technologii, lokalizacji i jako\u015bci pracy developera. Rynek mo\u017ce ulega\u0107 wahaniom w zale\u017cno\u015bci od zdarze\u0144 ekonomicznych."}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[(0,r.jsxs)("div",{className:"border rounded p-3",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Etap RTB"}),(0,r.jsx)("div",{className:"font-bold",children:"x10 wy\u017csza wycena"})]}),(0,r.jsxs)("div",{className:"border rounded p-3",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Technologia"}),(0,r.jsx)("div",{className:"font-bold",children:"PV: x1.0 | WF: x1.2 | BESS: x1.5"})]}),(0,r.jsxs)("div",{className:"border rounded p-3",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Umiej\u0119tno\u015bci developera"}),(0,r.jsx)("div",{className:"font-bold",children:"do +50% dla eksperta"})]}),(0,r.jsxs)("div",{className:"border rounded p-3",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Wielko\u015b\u0107 projektu"}),(0,r.jsx)("div",{className:"font-bold",children:"+20% dla 100MW"})]})]})]}),(0,r.jsx)("div",{className:"bg-white rounded shadow overflow-hidden",children:(0,r.jsxs)("table",{className:"min-w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-100",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"text-left p-3",children:"Projekt"}),(0,r.jsx)("th",{className:"text-center p-3",children:"Technologia"}),(0,r.jsx)("th",{className:"text-center p-3",children:"Moc"}),(0,r.jsx)("th",{className:"text-center p-3",children:"Status"}),(0,r.jsx)("th",{className:"text-right p-3",children:"Cena sprzeda\u017cy"}),(0,r.jsx)("th",{className:"text-right p-3",children:"Zysk"}),(0,r.jsx)("th",{className:"text-center p-3",children:"Akcje"})]})}),(0,r.jsx)("tbody",{className:"divide-y",children:y.length>0?y.map((i=>{const o=g(i),c=o-i.totalCost,d=(c/i.totalCost*100).toFixed(1),u=["land_acquisition","environmental_decision","zoning_conditions","grid_connection","ready_to_build"],h=u.indexOf("environmental_decision"),p=u.indexOf(i.status)>=h;return(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsxs)("td",{className:"p-3",children:[(0,r.jsx)("div",{className:"font-medium",children:i.name}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:i.county?`Powiat ${i.county.name}`:"Brak lokalizacji"})]}),(0,r.jsx)("td",{className:"text-center p-3",children:i.technology}),(0,r.jsxs)("td",{className:"text-center p-3",children:[i.power," MW"]}),(0,r.jsx)("td",{className:"text-center p-3",children:v(i.status)}),(0,r.jsxs)("td",{className:"text-right p-3 font-medium",children:[o.toLocaleString()," PLN"]}),(0,r.jsxs)("td",{className:"text-right p-3",children:[(0,r.jsxs)("div",{className:c>=0?"text-green-600":"text-red-600",children:[c.toLocaleString()," PLN"]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:[d,"%"]})]}),(0,r.jsx)("td",{className:"text-center p-3",children:(0,r.jsx)("button",{onClick:()=>(i=>{const r=e.projects.find((e=>e.id===i));if(!r)return;const o=["land_acquisition","environmental_decision","zoning_conditions","grid_connection","ready_to_build"],c=o.indexOf("environmental_decision");if(o.indexOf(r.status)<c)return void s(`Nie mo\u017cna sprzeda\u0107 projektu na etapie "${Ay(r.status)}". Projekt musi osi\u0105gn\u0105\u0107 co najmniej etap decyzji \u015brodowiskowej.`,"error");const d=g(r);a({type:"ADD_MARKET_TRANSACTION",payload:{id:Date.now(),projectId:r.id,projectName:r.name,technology:r.technology,power:r.power,status:r.status,price:d,turn:n.turn,seller:"player",date:(new Date).toISOString()}}),t({type:"SELL_PROJECT",payload:{projectId:r.id,price:d}}),r.county,l({type:"ADD_EVENT",payload:{id:Date.now()+Math.random(),type:"project_event",title:`Sprzeda\u017c projektu: ${r.name}`,description:`Projekt ${r.name} zosta\u0142 sprzedany za ${d.toLocaleString()} z\u0142.`,severity:"positive",turn:n.turn,expires:n.turn+5,projectId:r.id}}),s(`Sprzedano projekt "${r.name}" za ${d.toLocaleString()} PLN na gie\u0142dzie`,"success")})(i.id),className:`px-3 py-1 ${p?"bg-green-500 hover:bg-green-600":"bg-gray-400 cursor-not-allowed"} text-white rounded text-sm`,disabled:!p,title:p?"":"Projekt musi osi\u0105gn\u0105\u0107 etap decyzji \u015brodowiskowej",children:"Sprzedaj"})})]},i.id)})):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:"7",className:"p-4 text-center text-gray-500",children:"Brak projekt\xf3w spe\u0142niaj\u0105cych kryteria filtrowania"})})})]})}),(0,r.jsxs)("div",{className:"bg-white rounded shadow overflow-hidden mt-6",children:[(0,r.jsx)("div",{className:"p-4 border-b",children:(0,r.jsx)("h3",{className:"text-lg font-bold",children:"Historia sprzeda\u017cy"})}),n.marketHistory.length>0?(0,r.jsxs)("table",{className:"min-w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-100",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"text-left p-3",children:"Projekt"}),(0,r.jsx)("th",{className:"text-center p-3",children:"Technologia"}),(0,r.jsx)("th",{className:"text-center p-3",children:"Moc"}),(0,r.jsx)("th",{className:"text-center p-3",children:"Status"}),(0,r.jsx)("th",{className:"text-right p-3",children:"Cena"}),(0,r.jsx)("th",{className:"text-center p-3",children:"Tura"})]})}),(0,r.jsx)("tbody",{className:"divide-y",children:n.marketHistory.map((e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"p-3",children:e.projectName}),(0,r.jsx)("td",{className:"text-center p-3",children:e.technology}),(0,r.jsxs)("td",{className:"text-center p-3",children:[e.power," MW"]}),(0,r.jsx)("td",{className:"text-center p-3",children:v(e.status)}),(0,r.jsxs)("td",{className:"text-right p-3 font-medium",children:[e.price.toLocaleString()," PLN"]}),(0,r.jsx)("td",{className:"text-center p-3",children:e.turn})]},e.id)))})]}):(0,r.jsx)("p",{className:"p-4 text-center text-gray-500",children:"Brak historii transakcji"})]})]})},nv=()=>{const[e,t]=(0,i.useState)("available"),[n,a]=(0,i.useState)("all"),[s,o]=(0,i.useState)("all"),{state:l,dispatch:c}=d(),{state:u,showNotification:h}=mf(),p=["land_acquisition","environmental_decision","zoning_conditions","grid_connection","ready_to_build","constructed"],[m,f]=(0,i.useState)([{id:1,name:"PV-MAZ1234",technology:"PV",status:"greenfield",developmentStatus:"land_acquisition",developmentProgress:0,region:"mazowieckie",power:15,price:225e3,seller:"Inny deweloper",listedOn:new Date(2025,2,1)},{id:2,name:"WF-ZAP4321",technology:"WF",status:"development",developmentStatus:"environmental_decision",developmentProgress:35,region:"zachodniopomorskie",power:30,price:1392e3,seller:"Fundusz inwestycyjny",listedOn:new Date(2025,2,5)},{id:3,name:"BESS-MAL5678",technology:"BESS",status:"development",developmentStatus:"zoning_conditions",developmentProgress:65,region:"ma\u0142opolskie",power:10,price:4e6,seller:"Prywatny inwestor",listedOn:new Date(2025,2,8)},{id:4,name:"PV-POM7890",technology:"PV",status:"development",developmentStatus:"grid_connection",developmentProgress:80,region:"pomorskie",power:25,price:315e4,seller:"Fundusz OZE",listedOn:new Date(2025,2,10)},{id:5,name:"WF-LUB2468",technology:"WF",status:"rtb",developmentStatus:"ready_to_build",developmentProgress:100,region:"lubelskie",power:45,price:189e5,seller:"Mi\u0119dzynarodowy Deweloper",listedOn:new Date(2025,2,12)},{id:6,name:"PV-KUJ1357",technology:"PV",status:"development",developmentStatus:"environmental_decision",developmentProgress:40,region:"kujawsko-pomorskie",power:18,price:198e4,seller:"Sp\xf3\u0142ka projektowa",listedOn:new Date(2025,2,15),isResale:!0,originalPrice:22e5},{id:7,name:"BESS-DOL9753",technology:"BESS",status:"cod",developmentStatus:"constructed",developmentProgress:100,region:"dolno\u015bl\u0105skie",power:8,price:12e6,seller:"Fundusz Infrastrukturalny",listedOn:new Date(2025,2,18)}]),y=m.filter((e=>("all"===n||e.technology===n)&&("all"===s||e.status===s))),g=()=>{const e=Object.keys(Fy),t=e[Math.floor(Math.random()*e.length)],n=Fy[t],i=["greenfield","development","development","development","rtb","cod"],a=i[Math.floor(Math.random()*i.length)],r=Math.floor(Math.random()*p.length),s=p[r],o="land_acquisition"===s?10:"environmental_decision"===s?30:"zoning_conditions"===s?55:"grid_connection"===s?75:100,l=["mazowieckie","ma\u0142opolskie","wielkopolskie","zachodniopomorskie","podlaskie","kujawsko-pomorskie","pomorskie","lubelskie","dolno\u015bl\u0105skie","\u015bl\u0105skie","podkarpackie","lubuskie"],c=l[Math.floor(Math.random()*l.length)],d=Math.floor(5+45*Math.random()),u=n.marketPrices[a]||n.marketPrices.development,h=u.min+Math.random()*(u.max-u.min),m=.85+.3*Math.random(),f=Math.floor(h*d*m),y=Math.random()<.15,g=y?Math.floor(f*(.05+.1*Math.random()+1)):f,v=["Inny deweloper","Fundusz inwestycyjny","Prywatny inwestor","Sp\xf3\u0142ka projektowa","Fundusz OZE","Mi\u0119dzynarodowy Deweloper","Fundusz Infrastrukturalny","Sp\xf3\u0142ka energetyczna","Bank inwestycyjny"],w=v[Math.floor(Math.random()*v.length)];return{id:Date.now()+Math.floor(1e3*Math.random()),name:`${n.shortName}-${c.substring(0,3).toUpperCase()}${Math.floor(1e4*Math.random())}`,technology:t,status:a,developmentStatus:s,developmentProgress:o,region:c,power:d,price:f,seller:w,listedOn:new Date,isResale:y,originalPrice:y?g:f}},v=()=>{try{const e=10;let t=[...m];t.length>e&&(t=t.slice(-Math.floor(e/2)));const n=e-t.length,i=Math.min(Math.floor(1+3*Math.random()),n),a=Date.now();if(window.lastMarketRefresh||(window.lastMarketRefresh=0),a-window.lastMarketRefresh<5e3)return void console.log("Zbyt cz\u0119ste od\u015bwie\u017canie gie\u0142dy. Poczekaj chwil\u0119.");window.lastMarketRefresh=a;const r=[];for(let s=0;s<i;s++)r.push(g());f([...t,...r]),r.length>0&&h(`Dodano ${r.length} ${1===r.length?"nowy projekt":"nowe projekty"} na gie\u0142d\u0119`,"info")}catch(e){console.error("B\u0142\u0105d podczas od\u015bwie\u017cania gie\u0142dy:",e),h("Wyst\u0105pi\u0142 b\u0142\u0105d podczas od\u015bwie\u017cania gie\u0142dy projekt\xf3w","error")}};(0,i.useEffect)((()=>{m.length<=7&&v(),u.turn%3===0&&(()=>{try{const e=10;if(m.length>=e)return void console.log("Osi\u0105gni\u0119to maksymaln\u0105 liczb\u0119 projekt\xf3w na gie\u0142dzie");const t=Date.now();if(window.lastMarketGeneration||(window.lastMarketGeneration=0),t-window.lastMarketGeneration<1e4)return void console.log("Zbyt cz\u0119ste generowanie projekt\xf3w. Poczekaj chwil\u0119.");window.lastMarketGeneration=t;const n=e-m.length,i=Math.min(1+Math.floor(2*Math.random()),n),a=[];for(let r=0;r<i;r++)a.push(g());f((t=>t.length>=e?t:(a.length>0&&h(`Na gie\u0142dzie pojawi\u0142o si\u0119 ${a.length} ${1===a.length?"nowy projekt":"nowe projekty"}`,"info"),[...t,...a])))}catch(e){console.error("B\u0142\u0105d przy generowaniu nowych ofert:",e)}})()}),[u.turn]);const w=e=>{switch(e){case"PV":return(0,r.jsx)($f,{className:"h-5 w-5 text-yellow-500"});case"WF":return(0,r.jsx)(Cy,{className:"h-5 w-5 text-blue-500"});case"BESS":return(0,r.jsx)(By,{className:"h-5 w-5 text-purple-500"});default:return null}},x=e=>{switch(e){case"greenfield":return"Greenfield";case"development":return"W rozwoju";case"rtb":return"Ready-to-Build";case"cod":return"Commercial Operation";default:return e}},b=e=>{switch(e){case"land_acquisition":return"Pozyskiwanie dzia\u0142ki";case"environmental_decision":return"Decyzja \u015brodowiskowa";case"zoning_conditions":return"Warunki zabudowy";case"grid_connection":return"Przy\u0142\u0105cze do sieci";case"ready_to_build":return"Ready-to-Build";case"constructed":return"Wybudowany";default:return"Nieznany etap"}};return(0,r.jsxs)("div",{className:"flex flex-1",children:[(0,r.jsxs)("div",{className:"flex-1 p-4 overflow-y-auto",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Gie\u0142da Projekt\xf3w OZE"}),(0,r.jsxs)("div",{className:"flex border-b border-gray-200 mb-4",children:[(0,r.jsx)("button",{onClick:()=>t("available"),className:"py-2 px-4 font-medium "+("available"===e?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),children:"Dost\u0119pne Projekty"}),(0,r.jsx)("button",{onClick:()=>t("history"),className:"py-2 px-4 font-medium "+("history"===e?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),children:"Historia Transakcji"}),(0,r.jsx)("button",{onClick:()=>t("sell"),className:"py-2 px-4 font-medium "+("sell"===e?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),children:"Sprzeda\u017c"})]}),"available"===e&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex mb-4",children:[(0,r.jsx)("button",{onClick:()=>a("all"),className:"px-3 py-1 rounded "+("all"===n?"bg-gray-700 text-white":"bg-gray-200"),children:"Wszystkie"}),(0,r.jsxs)("button",{onClick:()=>a("PV"),className:"px-3 py-1 rounded ml-2 flex items-center "+("PV"===n?"bg-yellow-500 text-white":"bg-gray-200"),children:[(0,r.jsx)($f,{className:"h-4 w-4 mr-1"})," Fotowoltaika"]}),(0,r.jsxs)("button",{onClick:()=>a("WF"),className:"px-3 py-1 rounded ml-2 flex items-center "+("WF"===n?"bg-blue-500 text-white":"bg-gray-200"),children:[(0,r.jsx)(Cy,{className:"h-4 w-4 mr-1"})," Farmy Wiatrowe"]}),(0,r.jsxs)("button",{onClick:()=>a("BESS"),className:"px-3 py-1 rounded ml-2 flex items-center "+("BESS"===n?"bg-purple-500 text-white":"bg-gray-200"),children:[(0,r.jsx)(By,{className:"h-4 w-4 mr-1"})," Magazyny Energii"]})]}),(0,r.jsxs)("div",{className:"flex mb-4",children:[(0,r.jsx)("button",{onClick:()=>o("all"),className:"px-3 py-1 rounded "+("all"===s?"bg-gray-700 text-white":"bg-gray-200"),children:"Wszystkie etapy"}),(0,r.jsx)("button",{onClick:()=>o("greenfield"),className:"px-3 py-1 rounded ml-2 "+("greenfield"===s?"bg-green-500 text-white":"bg-gray-200"),children:"Greenfield"}),(0,r.jsx)("button",{onClick:()=>o("development"),className:"px-3 py-1 rounded ml-2 "+("development"===s?"bg-orange-500 text-white":"bg-gray-200"),children:"Development"}),(0,r.jsx)("button",{onClick:()=>o("rtb"),className:"px-3 py-1 rounded ml-2 "+("rtb"===s?"bg-red-500 text-white":"bg-gray-200"),children:"Ready-to-Build"}),(0,r.jsx)("button",{onClick:()=>o("cod"),className:"px-3 py-1 rounded ml-2 "+("cod"===s?"bg-purple-500 text-white":"bg-gray-200"),children:"Commercial Operation"})]}),(0,r.jsx)(ev,{title:"Dost\u0119pne projekty",headerAction:(0,r.jsx)(my,{onClick:v,variant:"info",size:"small",children:"Od\u015bwie\u017c gie\u0142d\u0119"}),children:y.length>0?(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-100",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"text-left p-2",children:"Projekt"}),(0,r.jsx)("th",{className:"text-center p-2",children:"Technologia"}),(0,r.jsx)("th",{className:"text-center p-2",children:"Etap"}),(0,r.jsx)("th",{className:"text-center p-2",children:"Status developmentu"}),(0,r.jsx)("th",{className:"text-center p-2",children:"Region"}),(0,r.jsx)("th",{className:"text-center p-2",children:"Moc"}),(0,r.jsx)("th",{className:"text-center p-2",children:"Cena"}),(0,r.jsx)("th",{className:"text-center p-2",children:"Sprzedaj\u0105cy"}),(0,r.jsx)("th",{className:"text-center p-2",children:"Akcja"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-200",children:y.map((e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50 "+(e.isResale?"bg-green-50":""),children:[(0,r.jsx)("td",{className:"p-2",children:e.name}),(0,r.jsx)("td",{className:"text-center p-2",children:(0,r.jsxs)("div",{className:"flex justify-center items-center",children:[w(e.technology),(0,r.jsx)("span",{className:"ml-1",children:e.technology})]})}),(0,r.jsx)("td",{className:"text-center p-2",children:x(e.status)}),(0,r.jsxs)("td",{className:"text-center p-2",children:["development"===e.status&&(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("span",{children:b(e.developmentStatus)}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-1",children:(0,r.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${e.developmentProgress}%`}})})]}),"development"!==e.status&&"-"]}),(0,r.jsx)("td",{className:"text-center p-2",children:e.region}),(0,r.jsxs)("td",{className:"text-center p-2",children:[e.power," MW"]}),(0,r.jsx)("td",{className:"text-center p-2",children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsxs)("span",{className:"font-medium",children:[e.price.toLocaleString()," PLN"]}),e.isResale&&(0,r.jsxs)("span",{className:"text-xs text-green-600",children:["Oszcz\u0119dno\u015b\u0107: ",(e.originalPrice-e.price).toLocaleString()," PLN"]})]})}),(0,r.jsx)("td",{className:"text-center p-2",children:e.seller}),(0,r.jsx)("td",{className:"text-center p-2",children:(0,r.jsx)(my,{variant:"success",size:"small",onClick:()=>(e=>{const t=m.find((t=>t.id===e));if(!t||l.cash<t.price)return;c({type:"ADD_PROJECT",payload:{...t,status:"greenfield"===t.status?"land_acquisition":"rtb"===t.status?"ready_to_build":"cod"===t.status?"constructed":t.developmentStatus||"environmental_decision",etapPaid:(()=>{const e=p.indexOf(t.developmentStatus);return{land_acquisition:e>=0,environmental_decision:e>=1,zoning_conditions:e>=2,grid_connection:e>=3,ready_to_build:e>=4,construction:e>=5}})(),progress:t.developmentProgress||0,totalCost:t.price,assignedScout:null,assignedDeveloper:null,events:[{date:(new Date).toISOString(),text:`Projekt zakupiony na gie\u0142dzie za ${t.price.toLocaleString()} PLN${t.isResale?` (oszcz\u0119dno\u015b\u0107: ${(t.originalPrice-t.price).toLocaleString()} PLN)`:""}`}]}}),c({type:"UPDATE_CASH",payload:-t.price}),c({type:"UPDATE_ECONOMIC_METRICS",payload:{totalInvestment:l.economicMetrics.totalInvestment+t.price}}),h(`Zakupiono projekt ${t.name} za ${t.price.toLocaleString()} PLN`,"success"),f(m.filter((t=>t.id!==e)))})(e.id),disabled:l.cash<e.price,children:"Kup"})})]},e.id)))})]})}):(0,r.jsx)("p",{className:"text-gray-500",children:"Brak dost\u0119pnych projekt\xf3w spe\u0142niaj\u0105cych kryteria"})})]}),"history"===e&&(0,r.jsx)(ev,{title:"Historia transakcji",children:(0,r.jsx)("p",{className:"text-gray-500",children:"Brak historii transakcji."})}),"sell"===e&&(0,r.jsx)(tv,{})]}),(0,r.jsxs)("div",{className:"w-1/3 bg-gray-100 p-4 overflow-y-auto",children:[(0,r.jsx)(ev,{title:"Analiza rynku",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Aktualne trendy cenowe"}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"PV (Greenfield):"})," 15 000\u201325 000 z\u0142/MWp"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"PV (RTB):"})," 100 000\u2013250 000 EUR/MWp"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Farmy Wiatrowe (RTB):"})," 340 000\u2013464 000 z\u0142/MW"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Magazyny Energii (RTB):"})," ","1.2\u20131.8 mln z\u0142/MW"]})]})]}),(0,r.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg",children:[(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Okazje rynkowe"}),(0,r.jsxs)("ul",{className:"space-y-1 text-sm",children:[(0,r.jsx)("li",{children:"\u2022 Projekty z oznaczeniem odsprzeda\u017cy mog\u0105 by\u0107 ta\u0144sze o 5-15% od warto\u015bci rynkowej!"}),(0,r.jsx)("li",{children:"\u2022 Magazyny energii w fazie developmentu staj\u0105 si\u0119 coraz bardziej atrakcyjne"}),(0,r.jsx)("li",{children:"\u2022 Projekty w fazie przy\u0142\u0105cza do sieci maj\u0105 najwy\u017csze ROI przy szybkim uko\u0144czeniu"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Porady inwestycyjne"}),(0,r.jsxs)("ul",{className:"space-y-1 text-sm",children:[(0,r.jsx)("li",{children:"\u2022 Projekty hybrydowe (PV + magazyn) osi\u0105gaj\u0105 premi\u0119 cenow\u0105 30-40%"}),(0,r.jsx)("li",{children:"\u2022 Obecnie najlepsze IRR maj\u0105 projekty w wojew\xf3dztwach mazowieckim i pomorskim"}),(0,r.jsx)("li",{children:"\u2022 Nadchodz\u0105ce zmiany regulacyjne mog\u0105 zwi\u0119kszy\u0107 warto\u015b\u0107 projekt\xf3w BESS"})]})]})]})}),(0,r.jsxs)(ev,{title:"Twoja got\xf3wka",className:"mt-4",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-green-600 mb-2",children:[l.cash?l.cash.toLocaleString():"0"," PLN"]}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Pami\u0119taj, \u017ce zakupione projekty wymagaj\u0105 dalszego finansowania w trakcie developmentu."})]})]})]})},iv=Lf("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),av=e=>{let{className:t}=e;return(0,r.jsx)("svg",{className:t,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M5 12H19M19 12L12 5M19 12L12 19",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})},rv=e=>{var t;let{region:n,regionId:a,negotiationData:s,onComplete:o,onCancel:l}=e;const{state:c,dispatch:u}=d(),{state:h,dispatch:p,showNotification:m}=mf(),{state:f,dispatch:y}=wf(),{state:g}=q(),[v,w]=(0,i.useState)(s?"negotiation":"initial"),[x,b]=(0,i.useState)(s?100:0),[j,k]=(0,i.useState)(null),[N,z]=(0,i.useState)(null),[_,E]=(0,i.useState)({size:s?s.size:100,quality:s?s.quality:"medium",expectedPrice:s?s.negotiatedPrice:0,negotiatedPrice:s?s.negotiatedPrice:0,monthlyRent:0,contractLength:29,depositRequired:0,annualRate:.6,startDate:s?new Date(s.startDate):new Date(h.gameDate),completionDate:s?new Date(s.completionDate):null,durationMonths:Math.floor(3*Math.random())+1,processId:s?s.processId:null,projectType:s?s.projectType:"PV",riskFactors:{environmentalRisk:0,socialRisk:0,competitionRisk:0,legalRisk:0},seasonalFactors:{availabilityModifier:1,priceModifier:1}}),[S,T]=(0,i.useState)([]),[C,P]=(0,i.useState)(!1),[I,A]=(0,i.useState)(!1),[M,D]=(0,i.useState)(0),R=f.find((e=>e.id===a)),O=(0,i.useMemo)((()=>c&&c.staff&&c.staff.scouts?c.staff.scouts.filter((e=>!e.busy||e.assignedRegion===a)):[]),[c,a]);(0,i.useEffect)((()=>{if(s){console.log("Otrzymano dane negocjacji:",s),w("negotiation"),b(100);const e=s.negotiatedPrice||1e4*(s.size||100),{monthlyRent:t,depositRequired:n}=L(s.size||100,s.quality||"medium",e,s.projectType||"PV");if(E((i=>({...i,size:s.size||100,quality:s.quality||"medium",negotiatedPrice:e,expectedPrice:1.1*e,monthlyRent:t,depositRequired:n,processId:s.processId,startDate:new Date(s.startDate||h.gameDate),completionDate:new Date(s.completionDate||h.gameDate),projectType:s.projectType||"PV"}))),s.scoutId){const e=c.staff.scouts.find((e=>e.id===s.scoutId));e?(console.log("Znaleziono skauta:",e),k(e)):console.warn("Nie znaleziono skauta o ID:",s.scoutId)}}}),[s,null===(t=c.staff)||void 0===t?void 0:t.scouts,h.gameDate]),(0,i.useEffect)((()=>{if("initial"===v&&!s){const e=new Date(_.startDate);e.setMonth(e.getMonth()+_.durationMonths),E((t=>({...t,completionDate:e})))}}),[v,_.startDate,_.durationMonths,s]),(0,i.useEffect)((()=>{if("scouting"===v&&I){const e=new Date(h.gameDate),t=new Date(_.startDate),n=new Date(_.completionDate);if(e>=n)b(100),y({type:"UPDATE_LAND_ACQUISITION_PROCESS",payload:{regionId:a,processId:_.processId,changes:{status:"ready_for_negotiation",progress:100}}});else if(e>t){const i=n.getTime()-t.getTime(),a=e.getTime()-t.getTime(),r=Math.min(99,Math.floor(a/i*100));b(r),Math.floor(r/25)>Math.floor((x||0)/25)&&V()}}}),[h.gameDate,v,I,_.startDate,_.completionDate,x,_.processId,a,y]),(0,i.useEffect)((()=>()=>{j&&!I&&u({type:"UPDATE_STAFF",payload:{staffType:"scouts",staffId:j.id,changes:{busy:!1}}})}),[j,u,I]);(0,i.useCallback)((()=>R?R.availableLand<_.size?{isValid:!1,message:`W tym regionie nie ma wystarczaj\u0105co dost\u0119pnych grunt\xf3w. Dost\u0119pne: ${R.availableLand} ha`}:{isValid:!0}:{isValid:!1,message:"Nie znaleziono regionu"}),[R,_.size]);const L=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=e||100,a=t||"medium";let r,s=1;switch(arguments.length>3&&void 0!==arguments[3]?arguments[3]:"PV"){case"PV":default:s=1;break;case"WF":s=1.2;break;case"BESS":s=1.15;break;case"MIX":s=1.25}if(n&&n>0)r=n/i;else{r="high"===a?35e3:"medium"===a?25e3:15e3,r*=h.landPriceModifier||1,r*=s;r*=F(),r*=_.seasonalFactors.priceModifier;r*=1+.3*_.riskFactors.competitionRisk}const o=n||r*i,l=_.annualRate||.006,c=Math.round(o*l/12);return{expectedPrice:o,monthlyRent:c,depositRequired:6*c}},F=()=>{if(!c||"number"!==typeof c.reputation)return 1;const e=c.reputation;return e>=80?.85+(100-e)/100*.15:e>=50?.95+(80-e)/30*.05:e>=30?1+(50-e)/20*.1:1.1+(30-e)/30*.1},U=()=>{if(!j)return void m("Musisz wybra\u0107 skauta do poszukiwania gruntu","warning");if(!N)return void m("Wybierz powiat, w kt\xf3rym chcesz szuka\u0107 dzia\u0142ki","warning");const{expectedPrice:e,monthlyRent:t,depositRequired:n}=L(_.size,_.quality,_.negotiatedPrice,_.projectType),i=new Date(h.gameDate),r=Math.floor(3*Math.random())+1,s=new Date(i);s.setMonth(s.getMonth()+r);const o=`${a}-${Date.now()}`,{riskFactors:l,seasonalFactors:c}=((e,t)=>{const n=f.find((t=>t.id===e)),i=(t&&n&&n.counties&&n.counties.find((e=>e.id===t)),{environmentalRisk:0,socialRisk:0,competitionRisk:0,legalRisk:0});switch(_.projectType||"PV"){case"WF":i.socialRisk=.3,i.environmentalRisk=.25;break;case"PV":default:i.socialRisk=.15,i.environmentalRisk=.1;break;case"BESS":i.socialRisk=.1,i.legalRisk=.2;break;case"MIX":i.socialRisk=.25,i.environmentalRisk=.2,i.legalRisk=.15}n&&(n.protectedAreas>20&&(i.environmentalRisk+=.15),n.populationDensity>200&&(i.socialRisk+=.2),n.renewableEnergyDensity>50&&(i.competitionRisk+=.3));const a={availabilityModifier:1,priceModifier:1};try{const e=new Date(h.gameDate).getMonth();e>=2&&e<=4?(a.availabilityModifier=1.2,a.priceModifier=.9):e>=5&&e<=7?(a.availabilityModifier=1,a.priceModifier=1):e>=8&&e<=10?(a.availabilityModifier=.9,a.priceModifier=1.1):(a.availabilityModifier=.7,a.priceModifier=1.3)}catch(r){console.error("B\u0142\u0105d podczas obliczania czynnik\xf3w sezonowych:",r)}g&&g.events&&g.events.filter((t=>t&&t.region===e&&(!t.expires||t.expires>h.turn))).forEach((e=>{if(e&&e.effects&&e.effects.riskFactors){const t=e.effects.riskFactors;"undefined"!==typeof t.environmentalRisk&&(i.environmentalRisk+=t.environmentalRisk),"undefined"!==typeof t.socialRisk&&(i.socialRisk+=t.socialRisk),"undefined"!==typeof t.competitionRisk&&(i.competitionRisk+=t.competitionRisk),"undefined"!==typeof t.legalRisk&&(i.legalRisk+=t.legalRisk)}}));return Object.keys(i).forEach((e=>{i[e]=Math.max(0,Math.min(1,i[e]))})),{riskFactors:i,seasonalFactors:a}})(a,N);E({..._,expectedPrice:e,monthlyRent:t,depositRequired:n,startDate:i,completionDate:s,durationMonths:r,processId:o,riskFactors:l,seasonalFactors:c}),u({type:"UPDATE_STAFF",payload:{staffType:"scouts",staffId:j.id,changes:{busy:!0,assignedRegion:a,taskName:`Poszukiwanie gruntu (${null===R||void 0===R?void 0:R.name})`,taskDescription:`Poszukiwanie dzia\u0142ki ${_.size}ha w regionie ${null===R||void 0===R?void 0:R.name}. Zako\u0144czy si\u0119 ${s.toLocaleDateString("pl-PL")}.`,taskProgress:0,taskStartDate:i,taskEndDate:s}}}),y({type:"ADD_LAND_ACQUISITION_PROCESS",payload:{regionId:a,process:{id:o,scoutId:j.id,scoutName:j.name,size:_.size,quality:_.quality,startDate:i,completionDate:s,durationMonths:r,progress:0,status:"in_progress",events:[]}}}),w("scouting"),b(0),T([]),A(!0),m(`Skaut ${j.name} rozpocz\u0105\u0142 poszukiwanie gruntu w regionie ${null===R||void 0===R?void 0:R.name}. Proces potrwa ${r} ${1===r?"miesi\u0105c":"miesi\u0105ce"}.`,"info")},V=()=>{const e=[{type:"positive",title:"Znaleziono obiecuj\u0105c\u0105 lokalizacj\u0119",description:"Skaut znalaz\u0142 dzia\u0142k\u0119 z dobrym nas\u0142onecznieniem i blisko GPZ.",effect:{quality:"high"}},{type:"negative",title:"Problemy z dojazdem",description:"Dzia\u0142ka ma utrudniony dojazd, co mo\u017ce zwi\u0119kszy\u0107 koszty.",effect:{price:1.1}},{type:"neutral",title:"Spotkanie z mieszka\u0144cami",description:"Lokalna spo\u0142eczno\u015b\u0107 jest zainteresowana projektem OZE.",effect:null},{type:"opportunity",title:"Mo\u017cliwo\u015b\u0107 powi\u0119kszenia dzia\u0142ki",description:"S\u0105siednia dzia\u0142ka r\xf3wnie\u017c mo\u017ce by\u0107 dost\u0119pna.",effect:{size:1.5}},{type:"risk",title:"Ryzyka \u015brodowiskowe",description:"Zidentyfikowano potencjalne problemy \u015brodowiskowe na dzia\u0142ce.",effect:{quality:"low"}},{type:"positive",title:"Do\u015bwiadczony w\u0142a\u015bciciel",description:"W\u0142a\u015bciciel gruntu ma do\u015bwiadczenie we wsp\xf3\u0142pracy z firmami OZE.",effect:{negotiation:.9}}],t=e[Math.floor(Math.random()*e.length)];T((e=>[...e,{...t,timestamp:(new Date).toISOString()}])),t.effect&&E((e=>{const n={...e};return t.effect.quality&&(n.quality=t.effect.quality),t.effect.price&&(n.expectedPrice*=t.effect.price),t.effect.size&&(n.size=Math.min(n.size*t.effect.size,(null===R||void 0===R?void 0:R.availableLand)||n.size)),t.effect.negotiation&&(n.negotiationMultiplier=t.effect.negotiation),n})),m(t.title,"negative"===t.type||"risk"===t.type?"warning":"info")},$=e=>{console.log("Pr\xf3ba negocjacji ceny z procentem:",e);try{if(C)return;if(!_||!_.expectedPrice)return console.error("Brak wymaganych danych do negocjacji"),void m("Wyst\u0105pi\u0142 b\u0142\u0105d podczas negocjacji. Spr\xf3buj ponownie.","error");D((e=>e+1));const n=.7,i=Math.max(e,n),r=Math.round(_.expectedPrice*i);let s=.5;c&&"undefined"!==typeof c.reputation&&(c.reputation>=80?s+=.2:c.reputation>=50?s+=.1:c.reputation<30&&(s-=.15)),j&&"undefined"!==typeof j.skill&&(s+=j.skill/100*.3),_.riskFactors&&("undefined"!==typeof _.riskFactors.competitionRisk&&(s-=.1*_.riskFactors.competitionRisk),"undefined"!==typeof _.riskFactors.socialRisk&&(s-=.15*_.riskFactors.socialRisk)),s=Math.max(.1,Math.min(.9,s));const o=Math.random()<s;if(console.log("Negocjacje - szansa akceptacji:",s),o){if(E((e=>({...e,negotiatedPrice:r,monthlyRent:Math.round(r*(e.annualRate||.05)/12),depositRequired:6*Math.round(r*(e.annualRate||.05)/12)}))),T((e=>[...e,{type:"success",title:"Negocjacje zako\u0144czone pomy\u015blnie",description:`Wynegocjowano cen\u0119 ${r.toLocaleString()} PLN (${Math.round(100*i)}% ceny wyj\u015bciowej)`,timestamp:(new Date).toISOString()}])),P(!0),_.processId&&a)try{y({type:"UPDATE_LAND_ACQUISITION_PROCESS",payload:{regionId:a,processId:_.processId,changes:{status:"negotiated",negotiatedPrice:r}}})}catch(t){console.error("B\u0142\u0105d podczas aktualizacji statusu procesu:",t)}m("Negocjacje zako\u0144czone pomy\u015blnie! Mo\u017cesz teraz sfinalizowa\u0107 umow\u0119 dzier\u017cawy.","success")}else if(T((e=>[...e,{type:"negative",title:"W\u0142a\u015bciciel odrzuci\u0142 propozycj\u0119",description:`W\u0142a\u015bciciel odrzuci\u0142 propozycj\u0119 ${Math.round(100*i)}% ceny wyj\u015bciowej.`,timestamp:(new Date).toISOString()}])),M>=3){if(Math.random()<.3){if(T((e=>[...e,{type:"warning",title:"W\u0142a\u015bciciel wycofa\u0142 si\u0119 z negocjacji",description:"Po kilku nieudanych pr\xf3bach w\u0142a\u015bciciel postanowi\u0142 wycofa\u0107 si\u0119 z negocjacji. Proces pozyskania dzia\u0142ki zosta\u0142 zako\u0144czony.",timestamp:(new Date).toISOString()}])),_.processId&&a)try{y({type:"UPDATE_LAND_ACQUISITION_PROCESS",payload:{regionId:a,processId:_.processId,changes:{status:"cancelled",reason:"Owner withdrew after failed negotiations"}}})}catch(t){console.error("B\u0142\u0105d podczas aktualizacji statusu procesu:",t)}m("W\u0142a\u015bciciel wycofa\u0142 si\u0119 z negocjacji. Proces pozyskania dzia\u0142ki zosta\u0142 zako\u0144czony.","error"),l()}}}catch(t){console.error("Nieoczekiwany b\u0142\u0105d podczas negocjacji:",t),m("Wyst\u0105pi\u0142 nieoczekiwany b\u0142\u0105d podczas negocjacji. Spr\xf3buj ponownie.","error")}},B=()=>{try{if(console.log("Pr\xf3ba finalizacji umowy dzier\u017cawy:",{region:n,regionId:a,landParameters:_,isNegotiationComplete:C}),!a||!_)return console.error("Brak wymaganych danych do finalizacji umowy"),void m("Wyst\u0105pi\u0142 b\u0142\u0105d podczas finalizacji umowy. Brakuj\u0105ce dane.","error");if(!C)return void m("Najpierw musisz zako\u0144czy\u0107 negocjacje ceny","warning");if(c.cash<_.depositRequired)return void m(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w na wp\u0142at\u0119 kaucji (${_.depositRequired.toLocaleString()} PLN)`,"error");u({type:"UPDATE_CASH",payload:{amount:-_.depositRequired,reason:`Kaucja za dzier\u017caw\u0119 dzia\u0142ki ${_.size}ha w ${n}`}});const t=`lease-${Date.now()}-${Math.floor(1e3*Math.random())}`;u({type:"ADD_LEASE",payload:{id:t,regionId:a,regionName:n,size:_.size,quality:_.quality,monthlyRent:_.monthlyRent,deposit:_.depositRequired,startDate:new Date(h.gameDate).toISOString(),endDate:new Date(new Date(h.gameDate).getFullYear()+_.contractLength,new Date(h.gameDate).getMonth(),new Date(h.gameDate).getDate()).toISOString(),totalPrice:_.negotiatedPrice,contractLength:_.contractLength,scoutId:j?j.id:(null===s||void 0===s?void 0:s.scoutId)||null,projectType:_.projectType}}),console.log("Umowa dzier\u017cawy dodana:",{id:t,regionId:a,regionName:n,size:_.size,startDate:new Date(h.gameDate).toISOString()});const i=`project-${Date.now()}-${Math.floor(1e3*Math.random())}`,r=c.staff&&c.staff.developers?c.staff.developers.filter((e=>!e.busy&&!e.assignedProject)):[],l=r.length>0?"in_development":"development_ready";let d=null,p=null;if(r.length>0){const e=r[0];d=e.id,p=e.name,u({type:"UPDATE_STAFF",payload:{staffType:"developers",staffId:e.id,changes:{busy:!0,assignedProject:i,taskName:`Przygotowanie dokumentacji (${n})`,taskDescription:`Przygotowanie dokumentacji dla projektu ${_.projectType} na dzia\u0142ce ${_.size}ha w regionie ${n}`}}})}const f=Math.floor(4*Math.random())+3,g=new Date(h.gameDate);g.setMonth(g.getMonth()+f);try{u({type:"ADD_PROJECT",payload:{id:i,name:`Projekt ${_.projectType} ${n} ${_.size}ha`,regionId:a,regionName:n,leaseId:t,size:_.size,type:_.projectType,status:l,qualityLevel:_.quality,developerId:d,developerName:p,startDate:new Date(h.gameDate).toISOString(),estimatedCompletionDate:g.toISOString(),currentStage:"documentation",progress:0,totalInvestment:0,expectedROI:0,environmentalImpact:0,socialAcceptance:100,risks:{environmental:_.riskFactors.environmentalRisk||0,social:_.riskFactors.socialRisk||0,legal:_.riskFactors.legalRisk||0}}}),console.log("Projekt dodany:",{id:i,name:`Projekt ${_.projectType} ${n} ${_.size}ha`,status:l})}catch(e){console.error("B\u0142\u0105d podczas dodawania projektu:",e)}if(_.processId&&a)try{y({type:"UPDATE_LAND_ACQUISITION_PROCESS",payload:{regionId:a,processId:_.processId,changes:{status:"completed",projectId:i}}})}catch(e){console.error("B\u0142\u0105d podczas aktualizacji statusu procesu:",e)}try{y({type:"UPDATE_REGION",payload:{regionId:a,updates:{availableLand:Math.max(0,((null===R||void 0===R?void 0:R.availableLand)||0)-_.size)}}})}catch(e){console.error("B\u0142\u0105d podczas aktualizacji dost\u0119pnej ziemi w regionie:",e)}m(`Umowa dzier\u017cawy zosta\u0142a sfinalizowana! Projekt ${_.projectType} zosta\u0142 dodany do Twojego portfolio.`,"success"),o&&o({leaseId:t,projectId:i})}catch(e){console.error("Nieoczekiwany b\u0142\u0105d podczas finalizacji umowy:",e),m("Wyst\u0105pi\u0142 nieoczekiwany b\u0142\u0105d podczas finalizacji umowy. Spr\xf3buj ponownie.","error")}};return(0,r.jsxs)("div",{className:"land-acquisition-wrapper",children:["initial"===v&&(0,r.jsxs)(ev,{className:"acquisition-card",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-blue-800 mb-4",children:["Pozyskiwanie dzia\u0142ki w regionie ",n]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Parametry poszukiwania"}),(0,r.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Lokalizacja:"}),(0,r.jsx)("span",{className:"font-medium",children:n})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Przewidywany czas:"}),(0,r.jsxs)("span",{className:"font-medium",children:[_.durationMonths," miesi\u0119cy"]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Poszukiwana powierzchnia:"}),(0,r.jsxs)("span",{className:"font-medium",children:[_.size," ha"]})]})]})]}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Dost\u0119pno\u015b\u0107 w regionie"}),(0,r.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Dost\u0119pne grunty:"}),(0,r.jsxs)("span",{className:"font-medium",children:[(null===R||void 0===R?void 0:R.availableLand)||0," ha"]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"\u015arednia cena dzier\u017cawy:"}),(0,r.jsxs)("span",{className:"font-medium",children:[Math.round(((null===R||void 0===R?void 0:R.landPrice)||1e3)*h.landPriceModifier)," PLN/ha/rok"]})]})]})]})]}),0===O.length?(0,r.jsxs)("div",{className:"no-scouts-message",children:[(0,r.jsx)(Hf,{className:"w-8 h-8 text-amber-500 mb-2"}),(0,r.jsx)("p",{children:"Brak dost\u0119pnych skaut\xf3w. Zatrudnij nowych lub poczekaj, a\u017c obecni skauci zako\u0144cz\u0105 swoje zadania."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"scouts-list",children:O.map((e=>(0,r.jsxs)("div",{className:`scout-card ${(null===j||void 0===j?void 0:j.id)===e.id?"selected":""} ${e.busy?"busy":""}`,onClick:()=>k(e),children:[(0,r.jsxs)("div",{className:"scout-avatar",children:[(0,r.jsx)(Gf,{className:"h-8 w-8 text-blue-500"}),e.busy&&(0,r.jsx)("div",{className:"busy-indicator",title:"Skaut jest zaj\u0119ty",children:"\u231b"})]}),(0,r.jsxs)("div",{className:"scout-info",children:[(0,r.jsx)("h3",{className:"scout-name",children:e.name}),(0,r.jsxs)("div",{className:"scout-skills",children:[(0,r.jsxs)("div",{className:"skill",children:[(0,r.jsx)("span",{className:"skill-label",children:"Do\u015bwiadczenie:"}),(0,r.jsx)("div",{className:"skill-bar",children:(0,r.jsx)("div",{className:"skill-fill",style:{width:10*e.skill+"%"}})}),(0,r.jsxs)("span",{className:"skill-value",children:[e.skill,"/10"]})]}),(0,r.jsxs)("div",{className:"skill",children:[(0,r.jsx)("span",{className:"skill-label",children:"Negocjacje:"}),(0,r.jsx)("div",{className:"skill-bar",children:(0,r.jsx)("div",{className:"skill-fill",style:{width:10*e.negotiation+"%"}})}),(0,r.jsxs)("span",{className:"skill-value",children:[e.negotiation,"/10"]})]})]})]}),(0,r.jsx)("div",{className:"scout-salary",children:e.busy?(0,r.jsxs)("span",{className:"text-amber-500 text-sm",children:["Zaj\u0119ty",e.assignedRegion===a?" (w tym regionie)":""]}):(0,r.jsxs)("span",{children:[e.skill,"/",(e.salary||0).toLocaleString()," PLN/mies"]})})]},e.id)))}),(0,r.jsxs)("div",{className:"action-buttons",children:[(0,r.jsx)("button",{className:"cancel-btn",onClick:l,children:"Anuluj"}),(0,r.jsx)("button",{className:"action-btn",onClick:U,disabled:!j,children:"Rozpocznij poszukiwanie dzia\u0142ki"})]})]})]}),"scouting"===v&&(0,r.jsxs)(ev,{className:"acquisition-card",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-blue-800 mb-4",children:"Poszukiwanie dzia\u0142ki w toku"}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow mb-4",children:[(0,r.jsxs)("div",{className:"scout-info-banner",children:[(0,r.jsx)("div",{className:"avatar",children:(0,r.jsx)(Gf,{className:"h-8 w-8 text-blue-500"})}),(0,r.jsxs)("div",{className:"info",children:[(0,r.jsxs)("h3",{children:[j.name," szuka dzia\u0142ki w regionie ",n]}),(0,r.jsxs)("p",{children:["Poszukiwana powierzchnia: ",(0,r.jsxs)("strong",{children:[_.size," ha"]})]})]})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,r.jsx)("span",{className:"text-gray-700 font-medium",children:"Post\u0119p poszukiwania:"}),(0,r.jsxs)("span",{className:"text-blue-600 font-bold",children:[Math.floor(x),"%"]})]}),(0,r.jsx)("div",{className:"h-4 w-full bg-gray-200 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${x}%`}})})]})]}),(0,r.jsxs)("div",{className:"events-timeline",children:[(0,r.jsx)("h3",{children:"Historia poszukiwania"}),(0,r.jsx)("div",{className:"timeline",children:0===S.length?(0,r.jsx)("p",{className:"no-events",children:"Brak wydarze\u0144 do wy\u015bwietlenia"}):S.map(((e,t)=>(0,r.jsxs)("div",{className:`timeline-event event-${e.type}`,children:[(0,r.jsx)("div",{className:"event-time",children:new Date(e.timestamp).toLocaleTimeString()}),(0,r.jsxs)("div",{className:"event-content",children:[(0,r.jsx)("h4",{className:"event-title",children:e.title}),(0,r.jsx)("p",{className:"event-description",children:e.description})]})]},t)))})]}),(0,r.jsx)("div",{className:"action-buttons",children:(0,r.jsx)("button",{className:"cancel-btn",onClick:()=>{window.confirm("Czy na pewno chcesz przerwa\u0107 poszukiwanie dzia\u0142ki?")&&(j&&u({type:"UPDATE_STAFF",payload:{staffType:"scouts",staffId:j.id,changes:{busy:!1,assignedRegion:null,progress:0}}}),w("initial"),b(0),l())},children:"Przerwij poszukiwanie"})})]}),"negotiation"===v&&(0,r.jsxs)(ev,{className:"acquisition-card",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-blue-800 mb-4",children:"Negocjacje warunk\xf3w"}),(0,r.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"avatar mr-3",children:(0,r.jsx)(Gf,{className:"h-6 w-6 text-blue-500"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-medium",children:["Skaut: ",(null===s||void 0===s?void 0:s.scoutName)||(null===j||void 0===j?void 0:j.name)||"Nieznany skaut"]}),j&&(0,r.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:[(0,r.jsxs)("span",{className:"mr-3",children:["Do\u015bwiadczenie: ",j.skill,"/10"]}),(0,r.jsxs)("span",{children:["Negocjacje: ",j.negotiation,"/10"]})]})]})]})}),(0,r.jsxs)("div",{className:"negotiation-body",children:[(0,r.jsxs)("div",{className:"negotiation-price-container",children:[(0,r.jsxs)("div",{className:"price-card expected",children:[(0,r.jsx)("div",{className:"price-title",children:"Cena wyj\u015bciowa"}),(0,r.jsxs)("div",{className:"price-value",children:[(_.expectedPrice||0).toLocaleString()," PLN"]}),(0,r.jsxs)("div",{className:"price-details",children:["(",Math.round((_.expectedPrice||0)/_.size).toLocaleString()," PLN/ha)"]})]}),(0,r.jsx)("div",{className:"negotiation-arrow",children:(0,r.jsx)(av,{className:"arrow-icon"})}),(0,r.jsxs)("div",{className:"price-card negotiated "+(C?"success":""),children:[(0,r.jsx)("div",{className:"price-title",children:"Wynegocjowana cena"}),(0,r.jsx)("div",{className:"price-value",children:C?(0,r.jsxs)("span",{children:[(_.negotiatedPrice||0).toLocaleString()," PLN"]}):(0,r.jsx)("span",{children:"---"})}),C&&(0,r.jsxs)("div",{className:"price-details",children:["(",Math.round((_.negotiatedPrice||0)/_.size).toLocaleString()," PLN/ha)",(0,r.jsx)("div",{className:"discount-badge",children:(0,r.jsxs)("span",{children:[Math.round(100*(1-(_.negotiatedPrice||0)/(_.expectedPrice||1))),"% taniej"]})})]})]})]}),(0,r.jsxs)("div",{className:"negotiation-options",children:[(0,r.jsx)("h4",{children:"Propozycje negocjacyjne:"}),(0,r.jsxs)("div",{className:"options-container",children:[(0,r.jsxs)("button",{className:"negotiation-option "+(C?"disabled":""),onClick:()=>$(.9),disabled:C,children:[(0,r.jsxs)("div",{className:"option-icon safe",children:[(0,r.jsx)(xy,{size:16}),(0,r.jsx)("span",{children:"10%"})]}),(0,r.jsxs)("div",{className:"option-content",children:[(0,r.jsx)("div",{className:"option-title",children:"Bezpieczna propozycja"}),(0,r.jsx)("div",{className:"option-description",children:"Zaoferuj 90% ceny wyj\u015bciowej - du\u017ca szansa powodzenia"}),(0,r.jsxs)("div",{className:"option-value",children:[Math.round(.9*_.expectedPrice).toLocaleString()," PLN"]})]})]}),(0,r.jsxs)("button",{className:"negotiation-option "+(C?"disabled":""),onClick:()=>$(.8),disabled:C,children:[(0,r.jsxs)("div",{className:"option-icon medium",children:[(0,r.jsx)(xy,{size:16}),(0,r.jsx)("span",{children:"20%"})]}),(0,r.jsxs)("div",{className:"option-content",children:[(0,r.jsx)("div",{className:"option-title",children:"\u015arednia propozycja"}),(0,r.jsx)("div",{className:"option-description",children:"Zaoferuj 80% ceny wyj\u015bciowej - umiarkowana szansa powodzenia"}),(0,r.jsxs)("div",{className:"option-value",children:[Math.round(.8*_.expectedPrice).toLocaleString()," PLN"]})]})]}),(0,r.jsxs)("button",{className:"negotiation-option "+(C?"disabled":""),onClick:()=>$(.7),disabled:C,children:[(0,r.jsxs)("div",{className:"option-icon risky",children:[(0,r.jsx)(xy,{size:16}),(0,r.jsx)("span",{children:"30%"})]}),(0,r.jsxs)("div",{className:"option-content",children:[(0,r.jsx)("div",{className:"option-title",children:"Ryzykowna propozycja"}),(0,r.jsx)("div",{className:"option-description",children:"Zaoferuj 70% ceny wyj\u015bciowej - ma\u0142a szansa powodzenia"}),(0,r.jsxs)("div",{className:"option-value",children:[Math.round(.7*_.expectedPrice).toLocaleString()," PLN"]})]})]})]})]}),(0,r.jsxs)("div",{className:"lease-details",children:[(0,r.jsx)("h4",{children:"Szczeg\xf3\u0142y umowy dzier\u017cawy:"}),(0,r.jsxs)("div",{className:"lease-grid",children:[(0,r.jsxs)("div",{className:"lease-item",children:[(0,r.jsx)("span",{className:"label",children:"Miesi\u0119czny czynsz:"}),(0,r.jsxs)("span",{className:"value",children:[_.monthlyRent.toLocaleString()," PLN/mies."]})]}),(0,r.jsxs)("div",{className:"lease-item",children:[(0,r.jsx)("span",{className:"label",children:"D\u0142ugo\u015b\u0107 umowy:"}),(0,r.jsxs)("span",{className:"value",children:[_.contractLength," lat"]})]}),(0,r.jsxs)("div",{className:"lease-item",children:[(0,r.jsx)("span",{className:"label",children:"Kaucja zabezpieczaj\u0105ca:"}),(0,r.jsxs)("span",{className:"value",children:[_.depositRequired.toLocaleString()," PLN"]})]}),(0,r.jsxs)("div",{className:"lease-item",children:[(0,r.jsx)("span",{className:"label",children:"Stopa roczna:"}),(0,r.jsxs)("span",{className:"value",children:[100*_.annualRate,"%"]})]})]})]}),(0,r.jsxs)("div",{className:"negotiation-events",children:[(0,r.jsx)("h4",{children:"Przebieg negocjacji:"}),(0,r.jsx)("div",{className:"events-container",children:0===S.length?(0,r.jsx)("div",{className:"no-events",children:"Brak wydarze\u0144. Rozpocznij negocjacje."}):S.map(((e,t)=>(0,r.jsxs)("div",{className:`event-item ${e.type}`,children:[(0,r.jsx)("div",{className:"event-icon",children:"success"===e.type?(0,r.jsx)(iv,{size:16}):"negative"===e.type?(0,r.jsx)(Zy,{size:16}):(0,r.jsx)(Hf,{size:16})}),(0,r.jsxs)("div",{className:"event-content",children:[(0,r.jsx)("div",{className:"event-title",children:e.title}),(0,r.jsx)("div",{className:"event-description",children:e.description})]})]},t)))})]})]}),(0,r.jsxs)("div",{className:"negotiation-footer",children:[(0,r.jsxs)("div",{className:"wallet-status",children:[(0,r.jsx)("span",{children:"Stan konta:"}),(0,r.jsxs)("span",{className:c.cash<_.depositRequired?"insufficient":"",children:[c.cash.toLocaleString()," PLN"]}),c.cash<_.depositRequired&&(0,r.jsx)("span",{className:"warning-text",children:"Niewystarczaj\u0105ce \u015brodki na kaucj\u0119!"})]}),(0,r.jsxs)("div",{className:"action-buttons",children:[(0,r.jsx)("button",{className:"cancel-btn",onClick:l,children:"Anuluj"}),(0,r.jsx)("button",{className:"finalize-btn "+(!C||c.cash<_.depositRequired?"disabled":""),onClick:B,disabled:!C||c.cash<_.depositRequired,children:"Podpisz umow\u0119 i wp\u0142a\u0107 kaucj\u0119"})]})]})]}),"agreement"===v&&(0,r.jsxs)(ev,{className:"acquisition-card",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-blue-800 mb-4",children:"Podsumowanie umowy"}),(0,r.jsxs)("div",{className:"agreement-summary",children:[(0,r.jsxs)("div",{className:"summary-item",children:[(0,r.jsx)("span",{className:"label",children:"Powierzchnia:"}),(0,r.jsxs)("span",{className:"value",children:[_.size," ha"]})]}),(0,r.jsxs)("div",{className:"summary-item",children:[(0,r.jsx)("span",{className:"label",children:"Jako\u015b\u0107 lokalizacji:"}),(0,r.jsx)("span",{className:"value",children:"low"===_.quality?"Niska":"medium"===_.quality?"\u015arednia":"Wysoka"})]}),(0,r.jsxs)("div",{className:"summary-item",children:[(0,r.jsx)("span",{className:"label",children:"Cena wyj\u015bciowa:"}),(0,r.jsxs)("span",{className:"value",children:[_.expectedPrice.toLocaleString()," PLN"]})]}),(0,r.jsxs)("div",{className:"summary-item",children:[(0,r.jsx)("span",{className:"label",children:"Negocjowana cena:"}),(0,r.jsxs)("span",{className:"value",children:[_.negotiatedPrice.toLocaleString()," PLN"]})]}),(0,r.jsxs)("div",{className:"summary-item",children:[(0,r.jsx)("span",{className:"label",children:"D\u0142ugo\u015b\u0107 umowy:"}),(0,r.jsxs)("span",{className:"value",children:[_.contractLength," lat"]})]}),(0,r.jsxs)("div",{className:"summary-item",children:[(0,r.jsx)("span",{className:"label",children:"Miesi\u0119czny czynsz:"}),(0,r.jsxs)("span",{className:"value",children:[_.monthlyRent.toLocaleString()," PLN"]})]}),(0,r.jsxs)("div",{className:"summary-item",children:[(0,r.jsx)("span",{className:"label",children:"Kaucja zabezpieczaj\u0105ca:"}),(0,r.jsxs)("span",{className:"value",children:[_.depositRequired.toLocaleString()," PLN"]})]})]}),(0,r.jsx)("div",{className:"action-buttons",children:(0,r.jsx)("button",{className:"finalize-btn",onClick:B,children:"Podpisz umow\u0119 dzier\u017cawy i wp\u0142a\u0107 kaucj\u0119"})})]})]})},sv=[{id:"zachodniopomorskie",name:"Zachodniopomorskie",x:0,y:0},{id:"pomorskie",name:"Pomorskie",x:1,y:0},{id:"warminsko-mazurskie",name:"Warmi\u0144sko-Mazurskie",x:2,y:0},{id:"podlaskie",name:"Podlaskie",x:3,y:0},{id:"lubuskie",name:"Lubuskie",x:0,y:1},{id:"wielkopolskie",name:"Wielkopolskie",x:1,y:1},{id:"kujawsko-pomorskie",name:"Kujawsko-Pomorskie",x:2,y:1},{id:"mazowieckie",name:"Mazowieckie",x:3,y:1},{id:"dolnoslaskie",name:"Dolno\u015bl\u0105skie",x:0,y:2},{id:"lodzkie",name:"\u0141\xf3dzkie",x:1,y:2},{id:"swietokrzyskie",name:"\u015awi\u0119tokrzyskie",x:2,y:2},{id:"lubelskie",name:"Lubelskie",x:3,y:2},{id:"opolskie",name:"Opolskie",x:0,y:3},{id:"slaskie",name:"\u015al\u0105skie",x:1,y:3},{id:"malopolskie",name:"Ma\u0142opolskie",x:2,y:3},{id:"podkarpackie",name:"Podkarpackie",x:3,y:3}],ov=()=>{var e,t;const{state:n,dispatch:a}=mf(),{state:s,dispatch:o}=d(),{state:l,dispatch:c}=wf(),[u,h]=(0,i.useState)(null),[p,m]=(0,i.useState)(null),[f,y]=(0,i.useState)(!1),[g,v]=(0,i.useState)(!1),[w,x]=(0,i.useState)(!1),[b,j]=(0,i.useState)(null),[k,N]=(0,i.useState)(!1),[z,_]=(0,i.useState)(null),[E,S]=(0,i.useState)("lands"),[T,C]=(0,i.useState)([]),[P,I]=(0,i.useState)([]),[A,M]=(0,i.useState)(!1);(0,i.useEffect)((()=>{n.selectedRegion!==u&&(h(n.selectedRegion),n.selectedRegion&&y(!0))}),[n.selectedRegion]),(0,i.useEffect)((()=>{var e;if(null!==(e=s.staff)&&void 0!==e&&e.scouts){const e=s.staff.scouts.filter((e=>e.busy));I(e)}}),[null===(e=s.staff)||void 0===e?void 0:e.scouts]);const D=e=>{var t,n;const i=l.find((t=>t.id===e));return(null===i||void 0===i||null===(t=i.projects)||void 0===t||null===(n=t.filter((e=>"land_acquisition"!==e.status)))||void 0===n?void 0:n.length)||0},R=e=>P.filter((t=>t.assignedRegion===e)),O=e=>{const t=l.find((t=>t.id===e));return t&&t.projects?t.projects.reduce(((e,t)=>"constructed"===t.status?e+(t.capacity||0):e),0):0},L=()=>!!(s&&s.staff&&s.staff.scouts)&&s.staff.scouts.some((e=>!e.busy)),F=()=>{var e;if(!u)return;0!==(Array.isArray(null===(e=s.staff)||void 0===e?void 0:e.scouts)?s.staff.scouts.filter((e=>!e.busy)):[]).length?(x(!0),y(!1)):a({type:"NOTIFY",payload:{text:"Nie masz dost\u0119pnych skaut\xf3w do wyszukiwania dzia\u0142ek!",type:"error"}})},U=()=>{if(!u)return;const e=l.find((e=>e.id===u));0!==((null===e||void 0===e?void 0:e.landAcquisitionProcesses)||[]).length?(v(!0),y(!1)):a({type:"NOTIFY",payload:{text:"Brak aktualnych poszukiwa\u0144 w tym regionie. Wy\u015blij skauta, aby rozpocz\u0105\u0107 pozyskiwanie dzia\u0142ki.",type:"info"}})},V=e=>{var t;const n=l.find((t=>t.id===e));return(null===n||void 0===n||null===(t=n.landAcquisitionProcesses)||void 0===t?void 0:t.length)||0},$=e=>{const t=l.find((t=>t.id===e));return((null===t||void 0===t?void 0:t.landAcquisitionProcesses)||[]).some((e=>"ready_for_negotiation"===e.status))},B=e=>{const t=R(e).length;return 0===t?null:(0,r.jsxs)("div",{className:"scout-indicator",title:`${t} aktywnych skaut\xf3w`,children:[(0,r.jsx)(Gf,{size:14}),(0,r.jsx)("span",{children:t})]})},W=e=>{const t=D(e);return 0===t?null:(0,r.jsxs)("div",{className:"projects-indicator",title:`${t} projekt\xf3w`,children:[(0,r.jsx)(uy,{size:14}),(0,r.jsx)("span",{children:t})]})},q=e=>{const t=l.find((t=>t.id===e));if(!t)return null;const n=t.solarConditions;let i="";return i=n>=80?"excellent":n>=60?"good":n>=40?"average":"poor",(0,r.jsx)("div",{className:`condition-indicator solar-condition ${i}`,title:`Nas\u0142onecznienie: ${n}/100`,children:(0,r.jsx)($f,{size:14})})},H=e=>{const t=l.find((t=>t.id===e));if(!t)return null;const n=t.windConditions;let i="";return i=n>=80?"excellent":n>=60?"good":n>=40?"average":"poor",(0,r.jsx)("div",{className:`condition-indicator wind-condition ${i}`,title:`Warunki wiatrowe: ${n}/100`,children:(0,r.jsx)(Cy,{size:14})})},G=e=>{try{if(!u)return console.error("Nie wybrano regionu do negocjacji"),void a({type:"NOTIFY",payload:{text:"B\u0142\u0105d: Nie wybrano regionu do negocjacji.",type:"error"}});const t=l.find((e=>e.id===u));if(!t||!t.landAcquisitionProcesses)return console.error("Brak danych regionu lub proces\xf3w pozyskiwania grunt\xf3w"),void a({type:"NOTIFY",payload:{text:"B\u0142\u0105d: Nie mo\u017cna uzyska\u0107 dost\u0119pu do danych regionu.",type:"error"}});const n=t.landAcquisitionProcesses.find((t=>t.id===e));if(!n)return console.error("Nie znaleziono procesu do negocjacji o ID:",e),void a({type:"NOTIFY",payload:{text:"B\u0142\u0105d: Nie znaleziono procesu do negocjacji.",type:"error"}});console.log("Przygotowanie do negocjacji procesu:",n);const i=n.negotiatedPrice||1e4*n.size;let r=null;s&&s.staff&&s.staff.scouts&&(r=s.staff.scouts.find((e=>e.id===n.scoutId))),j({processId:n.id,scoutId:n.scoutId,scoutName:n.scoutName||(r?r.name:"Nieznany skaut"),size:n.size||100,quality:n.quality||"medium",negotiatedPrice:i,expectedPrice:n.expectedPrice||i,regionId:u,annualRate:n.annualRate||.05,status:n.status||"ready_for_negotiation"}),M(!0)}catch(t){console.error("Wyst\u0105pi\u0142 nieoczekiwany b\u0142\u0105d podczas przygotowania negocjacji:",t),a({type:"NOTIFY",payload:{text:"Wyst\u0105pi\u0142 nieoczekiwany b\u0142\u0105d podczas przygotowania negocjacji. Spr\xf3buj ponownie.",type:"error"}})}},K=e=>{var t;const n=l.find((e=>e.id===u)),i=null===n||void 0===n||null===(t=n.landAcquisitionProcesses)||void 0===t?void 0:t.find((t=>t.id===e));if(!i)return;const r=s.staff.scouts.find((e=>e.id===i.scoutId));r&&o({type:"UPDATE_STAFF",payload:{staffType:"scouts",staffId:r.id,changes:{busy:!1,assignedRegion:null}}}),c({type:"REMOVE_LAND_ACQUISITION_PROCESS",payload:{regionId:u,processId:e}}),a({type:"NOTIFY",payload:{text:`Anulowano proces poszukiwania gruntu w regionie ${null===n||void 0===n?void 0:n.name}.`,type:"info"}})};return(0,r.jsxs)("div",{className:"region-selection-view",children:[(0,r.jsxs)("div",{className:"region-selection-header",children:[(0,r.jsx)("h2",{children:"Wyb\xf3r regionu"}),(0,r.jsx)("p",{children:"Wybierz wojew\xf3dztwo, aby rozpocz\u0105\u0107 poszukiwanie dzia\u0142ek lub zarz\u0105dza\u0107 projektami"})]}),(0,r.jsxs)("div",{className:"regions-map-container",children:[(0,r.jsxs)("div",{className:"region-map-section",children:[(0,r.jsx)("div",{className:"regions-grid",children:sv.map((e=>{var t;const n=u===e.id,i=p===e.id,s=l.find((t=>t.id===e.id));return(0,r.jsx)("div",{className:`region-cell ${n?"selected":""} ${i?"hovered":""}`,style:{gridColumn:e.x+1,gridRow:e.y+1},children:(0,r.jsxs)("button",{className:`region-btn ${o=e.id,(e=>{const t=(e.solarConditions+e.windConditions)/2;return t>=70?"bg-green-200":t>=55?"bg-yellow-200":"bg-red-200"})(l.find((e=>e.id===o)))} ${n?"selected":""}`,onClick:()=>(e=>{if(u===e)return y(!f),void v(!1);l.find((t=>t.id===e)),h(e),a({type:"SELECT_REGION",payload:e}),y(!0),v(!1)})(e.id),onMouseEnter:()=>m(e.id),onMouseLeave:()=>m(null),children:[(0,r.jsx)("div",{className:"region-name",children:e.name}),(0,r.jsxs)("div",{className:"region-indicators",children:[q(e.id),H(e.id),B(e.id),W(e.id)]}),i&&s&&(0,r.jsxs)("div",{className:"region-hover-info",children:[(0,r.jsxs)("div",{className:"hover-info-item",children:[(0,r.jsx)("span",{children:"Dost\u0119pne grunty:"}),(0,r.jsxs)("span",{children:[null===(t=s.availableLand)||void 0===t?void 0:t.toLocaleString()," ha"]})]}),(0,r.jsxs)("div",{className:"hover-info-item",children:[(0,r.jsx)("span",{children:"Projekty:"}),(0,r.jsx)("span",{children:D(e.id)})]}),R(e.id).length>0&&(0,r.jsxs)("div",{className:"hover-info-item",children:[(0,r.jsx)("span",{children:"Aktywni skauci:"}),(0,r.jsx)("span",{children:R(e.id).length})]})]})]})},e.id);var o}))}),(0,r.jsxs)("div",{className:"regions-legend",children:[(0,r.jsx)("h3",{children:"Legenda"}),(0,r.jsxs)("div",{className:"legend-items",children:[(0,r.jsxs)("div",{className:"legend-item",children:[(0,r.jsx)("span",{className:"color-box color-low"}),(0,r.jsx)("span",{children:"Brak projekt\xf3w"})]}),(0,r.jsxs)("div",{className:"legend-item",children:[(0,r.jsx)("span",{className:"color-box color-medium"}),(0,r.jsx)("span",{children:"1-2 projekty"})]}),(0,r.jsxs)("div",{className:"legend-item",children:[(0,r.jsx)("span",{className:"color-box color-high"}),(0,r.jsx)("span",{children:"3+ projekt\xf3w"})]}),(0,r.jsxs)("div",{className:"legend-item",children:[(0,r.jsx)("span",{className:"color-box color-selected"}),(0,r.jsx)("span",{children:"Wybrany region"})]})]})]})]}),(0,r.jsxs)("div",{className:"region-panel-section",children:[(()=>{var e;if(!u||!f)return null;const t=l.find((e=>e.id===u)),n=R(u);return(0,r.jsxs)("div",{className:"region-action-panel",children:[(0,r.jsxs)("div",{className:"action-panel-header",children:[(0,r.jsx)("h3",{children:(null===t||void 0===t?void 0:t.name)||"Wybrany region"}),(0,r.jsx)("button",{className:"close-panel-btn",onClick:()=>y(!1),children:(0,r.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),(0,r.jsxs)("div",{className:"region-key-stats",children:[(0,r.jsxs)("div",{className:"key-stat",children:[(0,r.jsx)(Py,{size:18}),(0,r.jsxs)("div",{className:"stat-content",children:[(0,r.jsx)("span",{className:"stat-label",children:"Dost\u0119pne grunty"}),(0,r.jsxs)("span",{className:"stat-value",children:[null===t||void 0===t||null===(e=t.availableLand)||void 0===e?void 0:e.toLocaleString()," ha"]})]})]}),(0,r.jsxs)("div",{className:"key-stat",children:[(0,r.jsx)($f,{size:18}),(0,r.jsxs)("div",{className:"stat-content",children:[(0,r.jsx)("span",{className:"stat-label",children:"Nas\u0142onecznienie"}),(0,r.jsxs)("span",{className:"stat-value",children:[null===t||void 0===t?void 0:t.solarConditions,"/100"]})]})]}),(0,r.jsxs)("div",{className:"key-stat",children:[(0,r.jsx)(Cy,{size:18}),(0,r.jsxs)("div",{className:"stat-content",children:[(0,r.jsx)("span",{className:"stat-label",children:"Warunki wiatrowe"}),(0,r.jsxs)("span",{className:"stat-value",children:[null===t||void 0===t?void 0:t.windConditions,"/100"]})]})]}),(0,r.jsxs)("div",{className:"key-stat",children:[(0,r.jsx)(Mg,{size:18}),(0,r.jsxs)("div",{className:"stat-content",children:[(0,r.jsx)("span",{className:"stat-label",children:"Moc zainstalowana"}),(0,r.jsxs)("span",{className:"stat-value",children:[O(u)," MW"]})]})]})]}),(0,r.jsxs)("div",{className:"action-buttons",children:[(0,r.jsxs)("button",{className:"action-btn scout-btn "+(L()?"":"disabled"),onClick:F,disabled:!L(),children:[(0,r.jsx)("div",{className:"btn-icon",children:(0,r.jsx)(Py,{size:18})}),(0,r.jsxs)("div",{className:"btn-content",children:[(0,r.jsx)("div",{className:"btn-title",children:"Wy\u015blij skauta"}),(0,r.jsx)("div",{className:"btn-description",children:"Znajd\u017a i wynegocjuj dzier\u017caw\u0119 dzia\u0142ki"})]})]}),(0,r.jsxs)("button",{className:"action-btn projects-btn "+(0===V(u)?"disabled":""),onClick:U,disabled:0===V(u),children:[(0,r.jsxs)("div",{className:"btn-icon",children:[(0,r.jsx)(uy,{size:18}),$(u)&&(0,r.jsx)("div",{className:"notification-badge",children:"!"})]}),(0,r.jsxs)("div",{className:"btn-content",children:[(0,r.jsxs)("div",{className:"btn-title",children:["Aktualne poszukiwania",$(u)&&(0,r.jsx)("span",{className:"attention-marker",children:" \u2022 "})]}),(0,r.jsxs)("div",{className:"btn-description",children:["Przejrzyj post\u0119p poszukiwania grunt\xf3w w tym regionie",$(u)&&(0,r.jsx)("span",{className:"text-yellow-500",children:" (Wymagana akcja!)"})]})]})]})]}),n.length>0&&(0,r.jsxs)("div",{className:"active-scouts-section",children:[(0,r.jsxs)("h4",{children:[(0,r.jsx)(Uf,{size:16,className:"section-icon"}),"Aktywne procesy w regionie"]}),(0,r.jsx)("div",{className:"active-scouts-list",children:n.map((e=>(0,r.jsxs)("div",{className:"active-scout-item",children:[(0,r.jsx)("div",{className:"scout-avatar",children:(0,r.jsx)(Gf,{size:20})}),(0,r.jsxs)("div",{className:"scout-info",children:[(0,r.jsx)("div",{className:"scout-name",children:e.name}),(0,r.jsx)("div",{className:"scout-status",children:"Poszukiwanie dzia\u0142ki"}),(0,r.jsxs)("div",{className:"scout-progress",children:[(0,r.jsx)("div",{className:"progress-bar",children:(0,r.jsx)("div",{className:"progress-fill",style:{width:`${e.progress||0}%`}})}),(0,r.jsxs)("span",{className:"progress-text",children:[Math.floor(e.progress||0),"%"]})]})]})]},e.id)))})]}),!(s&&s.staff&&s.staff.scouts&&s.staff.scouts.length>0)&&(0,r.jsxs)("div",{className:"region-warning",children:[(0,r.jsx)(Hf,{size:16,className:"warning-icon"}),(0,r.jsx)("span",{children:"Nie masz zatrudnionych skaut\xf3w. Zatrudnij skauta w panelu HR, aby m\xf3c poszukiwa\u0107 dzia\u0142ek."})]})]})})(),(()=>{if(!u||!g)return null;const e=l.find((e=>e.id===u)),t=(null===e||void 0===e?void 0:e.landAcquisitionProcesses)||[],n=e=>new Date(e).toLocaleDateString("pl-PL"),i={in_progress:"W trakcie",ready_for_negotiation:"Gotowy do negocjacji",negotiating:"W negocjacjach",completed:"Zako\u0144czony"},a={in_progress:"bg-blue-100 text-blue-800",ready_for_negotiation:"bg-green-200 text-green-900 font-bold",negotiating:"bg-amber-100 text-amber-800",completed:"bg-gray-100 text-gray-800"};return(0,r.jsxs)("div",{className:"region-projects-panel",children:[(0,r.jsxs)("div",{className:"projects-panel-header",children:[(0,r.jsxs)("h3",{children:["Aktualne poszukiwania w regionie ",null===e||void 0===e?void 0:e.name]}),(0,r.jsx)("button",{className:"close-panel-btn",onClick:()=>v(!1),children:(0,r.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),(0,r.jsx)("div",{className:"acquisition-processes-container",children:0===t.length?(0,r.jsx)("div",{className:"no-processes-message",children:"Brak aktualnych proces\xf3w poszukiwania grunt\xf3w w tym regionie."}):(0,r.jsx)("div",{className:"acquisition-processes-grid",children:t.map((e=>(0,r.jsxs)("div",{className:"acquisition-process-card "+(T.includes(e.id)?"expanded":""),onClick:()=>(e=>{var t;const n=l.find((e=>e.id===u)),i=null===n||void 0===n||null===(t=n.landAcquisitionProcesses)||void 0===t?void 0:t.find((t=>t.id===e));i&&"ready_for_negotiation"===i.status?G(e):C((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))})(e.id),children:[(0,r.jsxs)("div",{className:"process-card-header",children:[(0,r.jsx)("div",{className:"process-icon",children:(0,r.jsx)(Py,{size:18})}),(0,r.jsxs)("div",{className:"process-info",children:[(0,r.jsxs)("h4",{className:"process-title",children:["Dzia\u0142ka ",e.size,"ha"]}),(0,r.jsx)("div",{className:`process-status-badge ${a[e.status]}`,children:i[e.status]})]}),(0,r.jsx)("div",{className:"process-progress-indicator",children:(0,r.jsxs)("svg",{viewBox:"0 0 36 36",className:"circular-chart",children:[(0,r.jsx)("path",{className:"circle-bg",d:"M18 2.0845\r a 15.9155 15.9155 0 0 1 0 31.831\r a 15.9155 15.9155 0 0 1 0 -31.831"}),(0,r.jsx)("path",{className:"circle",strokeDasharray:`${e.progress}, 100`,d:"M18 2.0845\r a 15.9155 15.9155 0 0 1 0 31.831\r a 15.9155 15.9155 0 0 1 0 -31.831"}),(0,r.jsxs)("text",{x:"18",y:"20.35",className:"percentage",children:[e.progress,"%"]})]})})]}),T.includes(e.id)&&(0,r.jsxs)("div",{className:"process-card-details",children:[(0,r.jsxs)("div",{className:"details-grid",children:[(0,r.jsxs)("div",{className:"detail-item",children:[(0,r.jsx)("span",{className:"detail-label",children:"Skaut:"}),(0,r.jsx)("span",{className:"detail-value",children:e.scoutName})]}),(0,r.jsxs)("div",{className:"detail-item",children:[(0,r.jsx)("span",{className:"detail-label",children:"Rozpocz\u0119cie:"}),(0,r.jsx)("span",{className:"detail-value",children:n(e.startDate)})]}),(0,r.jsxs)("div",{className:"detail-item",children:[(0,r.jsx)("span",{className:"detail-label",children:"Zako\u0144czenie:"}),(0,r.jsx)("span",{className:"detail-value",children:n(e.completionDate)})]}),e.negotiatedPrice&&(0,r.jsxs)("div",{className:"detail-item",children:[(0,r.jsx)("span",{className:"detail-label",children:"Wycena:"}),(0,r.jsxs)("span",{className:"detail-value",children:[e.negotiatedPrice.toLocaleString()," PLN"]})]}),(0,r.jsxs)("div",{className:"detail-item",children:[(0,r.jsx)("span",{className:"detail-label",children:"Jako\u015b\u0107:"}),(0,r.jsx)("span",{className:"detail-value",children:"high"===e.quality?"Wysoka":"medium"===e.quality?"\u015arednia":"Niska"})]})]}),(0,r.jsxs)("div",{className:"process-actions",children:["ready_for_negotiation"===e.status&&(0,r.jsx)("button",{className:"action-button negotiate",onClick:t=>{t.stopPropagation(),G(e.id)},children:"Negocjuj umow\u0119"}),"in_progress"===e.status&&(0,r.jsx)("button",{className:"action-button cancel",onClick:t=>{t.stopPropagation(),K(e.id)},children:"Anuluj poszukiwanie"})]})]})]},e.id)))})})]})})()]})]}),w&&u&&(0,r.jsxs)("div",{className:"land-acquisition-modal",children:[(0,r.jsx)("div",{className:"land-acquisition-backdrop",onClick:()=>{window.confirm("Czy na pewno chcesz anulowa\u0107 proces pozyskiwania gruntu?")&&(x(!1),y(!0))}}),(0,r.jsx)("div",{className:"land-acquisition-content",children:(0,r.jsx)(rv,{region:null===(t=l.find((e=>e.id===u)))||void 0===t?void 0:t.name,regionId:u,negotiationData:b,onComplete:e=>{x(!1),y(!0),a({type:"REFRESH_PROJECTS"})},onCancel:()=>{x(!1),y(!0)}})})]})]})},lv=e=>{let{employees:t,onSelectEmployee:n,selectedEmployeeId:a}=e;const[s,o]=(0,i.useState)("all"),[l,c]=(0,i.useState)("all"),[d,u]=(0,i.useState)("name"),h=(0,i.useMemo)((()=>{let e=[...t];return"all"!==s&&(e=e.filter((e=>e.typeShort===s))),"all"!==l&&(e=e.filter((e=>e.level===l))),e.sort(((e,t)=>{switch(d){case"name":return e.name.localeCompare(t.name);case"type":return e.typeShort.localeCompare(t.typeShort);case"level":return e.level.localeCompare(t.level);case"skill":return t.skill-e.skill;case"experience":return t.experience-e.experience;default:return 0}})),e}),[t,s,l,d]),p=e=>e.experience<3e3?"Pocz\u0105tkuj\u0105cy":e.experience<8e3?"Do\u015bwiadczony":"Ekspert";return(0,r.jsxs)("div",{className:"hr-employees-list",children:[(0,r.jsxs)("div",{className:"hr-employees-list-header",children:["Pracownicy (",h.length,")"]}),(0,r.jsxs)("div",{className:"hr-employees-list-filters",children:[(0,r.jsxs)("select",{value:s,onChange:e=>o(e.target.value),children:[(0,r.jsx)("option",{value:"all",children:"Wszyscy"}),(0,r.jsx)("option",{value:"lessor",children:"Dzier\u017cawcy"}),(0,r.jsx)("option",{value:"developer",children:"Developerzy"}),(0,r.jsx)("option",{value:"lawyer",children:"Prawnicy"}),(0,r.jsx)("option",{value:"envSpecialist",children:"Spec. \u015brodowiskowi"}),(0,r.jsx)("option",{value:"lobbyist",children:"Lobby\u015bci"})]}),(0,r.jsxs)("select",{value:l,onChange:e=>c(e.target.value),children:[(0,r.jsx)("option",{value:"all",children:"Wszystkie poziomy"}),(0,r.jsx)("option",{value:"junior",children:"Pocz\u0105tkuj\u0105cy"}),(0,r.jsx)("option",{value:"mid",children:"Do\u015bwiadczeni"}),(0,r.jsx)("option",{value:"senior",children:"Eksperci"})]}),(0,r.jsxs)("select",{value:d,onChange:e=>u(e.target.value),children:[(0,r.jsx)("option",{value:"name",children:"Sortuj: Nazwa"}),(0,r.jsx)("option",{value:"type",children:"Sortuj: Typ"}),(0,r.jsx)("option",{value:"level",children:"Sortuj: Poziom"}),(0,r.jsx)("option",{value:"skill",children:"Sortuj: Umiej\u0119tno\u015bci"}),(0,r.jsx)("option",{value:"experience",children:"Sortuj: Do\u015bwiadczenie"})]})]}),(0,r.jsx)("div",{className:"hr-employees-items",children:0===h.length?(0,r.jsx)("div",{className:"hr-no-employees",children:"Brak pracownik\xf3w spe\u0142niaj\u0105cych kryteria"}):h.map((e=>(0,r.jsxs)("div",{className:"hr-employee-item "+(a===e.id?"selected":""),onClick:()=>n(e),children:[(0,r.jsx)("div",{className:"hr-employee-name",children:e.name}),(0,r.jsxs)("div",{className:"hr-employee-info",children:[(0,r.jsx)("span",{children:My(e.typeShort)}),(0,r.jsx)("span",{children:Dy(e.level)})]}),(0,r.jsxs)("div",{className:"hr-employee-info",children:[(0,r.jsxs)("span",{children:["Umiej\u0119tno\u015b\u0107: ",e.skill,"/10"]}),(0,r.jsxs)("span",{children:["Do\u015bwiadczenie: ",p(e)]})]}),e.specialization&&(0,r.jsx)("div",{className:"hr-employee-specialization",children:e.specialization})]},e.id)))})]})},cv=e=>{let{employee:t,staffType:n,staffManagement:a,gameState:s}=e;const[o,l]=(0,i.useState)(!1);if(!t)return null;return(0,r.jsxs)("div",{className:"hr-employee-details",children:[(0,r.jsxs)("div",{className:"hr-employee-header",children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,r.jsx)("div",{className:"hr-employee-avatar",children:t.name.charAt(0)}),(0,r.jsxs)("div",{className:"hr-employee-title",children:[(0,r.jsx)("h3",{children:t.name}),(0,r.jsxs)("div",{className:"hr-employee-job",children:[Dy(t.level)," ",My(t.typeShort)]}),(0,r.jsx)("div",{children:t.specialization&&(0,r.jsxs)("span",{className:"hr-specialization",children:["Specjalizacja: ",t.specialization]})})]})]}),(0,r.jsxs)("div",{className:"hr-employee-actions",children:[(0,r.jsx)("button",{className:"train-btn",onClick:()=>{},children:"Szkolenie"}),(0,r.jsx)("button",{className:"fire-btn",onClick:()=>{o?(a.fireStaff(t.typeShort,t.id),l(!1)):l(!0)},children:o?"Potwierd\u017a zwolnienie":"Zwolnij"})]})]}),(0,r.jsxs)("div",{className:"hr-employee-grid",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"hr-employee-section",children:[(0,r.jsx)("h4",{children:"Statystyki"}),(0,r.jsxs)("div",{className:"hr-stat-row",children:[(0,r.jsx)("div",{className:"hr-stat-label",children:"Sta\u017c pracy"}),(0,r.jsxs)("div",{className:"hr-stat-value",children:[s.turn-t.hiredOn," tur"]})]}),(0,r.jsxs)("div",{className:"hr-stat-row",children:[(0,r.jsx)("div",{className:"hr-stat-label",children:"Umiej\u0119tno\u015bci"}),(0,r.jsxs)("div",{className:"hr-stat-value",children:[t.skill,"/10"]}),(0,r.jsx)("div",{className:"hr-progress-bar",children:(0,r.jsx)("div",{className:"hr-progress-value "+(t.skill>7?"high":t.skill>4?"medium":"low"),style:{width:10*t.skill+"%"}})})]}),(0,r.jsxs)("div",{className:"hr-stat-row",children:[(0,r.jsx)("div",{className:"hr-stat-label",children:"Do\u015bwiadczenie"}),(0,r.jsxs)("div",{className:"hr-stat-value",children:[t.experience," p.d."]}),(0,r.jsx)("div",{className:"hr-progress-bar",children:(0,r.jsx)("div",{className:"hr-progress-value",style:{width:`${Math.min(100,t.experience/100)}%`}})})]}),(0,r.jsxs)("div",{className:"hr-stat-row",children:[(0,r.jsx)("div",{className:"hr-stat-label",children:"Energia"}),(0,r.jsxs)("div",{className:"hr-stat-value",children:[t.energy,"/100"]}),(0,r.jsx)("div",{className:"hr-progress-bar",children:(0,r.jsx)("div",{className:"hr-progress-value "+(t.energy>70?"high":t.energy>40?"medium":"low"),style:{width:`${t.energy}%`}})})]}),(0,r.jsxs)("div",{className:"hr-stat-row",children:[(0,r.jsx)("div",{className:"hr-stat-label",children:"Morale"}),(0,r.jsxs)("div",{className:"hr-stat-value",children:[t.morale,"/100"]}),(0,r.jsx)("div",{className:"hr-progress-bar",children:(0,r.jsx)("div",{className:"hr-progress-value "+(t.morale>70?"high":t.morale>40?"medium":"low"),style:{width:`${t.morale}%`}})})]}),(0,r.jsxs)("div",{className:"hr-stat-row",children:[(0,r.jsx)("div",{className:"hr-stat-label",children:"Wynagrodzenie"}),(0,r.jsxs)("div",{className:"hr-stat-value",children:[t.salary.toLocaleString()," PLN / miesi\u0105c"]})]})]}),"developer"!==t.typeShort?null:t.technologyExperience&&0!==Object.keys(t.technologyExperience).length?(0,r.jsxs)("div",{className:"hr-employee-section",children:[(0,r.jsx)("h4",{children:"Do\u015bwiadczenie w technologiach"}),Object.entries(t.technologyExperience).map((e=>{let[t,n]=e;return(0,r.jsxs)("div",{className:"hr-stat-row",children:[(0,r.jsx)("div",{className:"hr-stat-label",children:t}),(0,r.jsxs)("div",{className:"hr-stat-value",children:[n," p.d."]}),(0,r.jsx)("div",{className:"hr-progress-bar",children:(0,r.jsx)("div",{className:"hr-progress-value",style:{width:`${Math.min(100,n/50)}%`}})})]},t)}))]}):(0,r.jsxs)("div",{className:"hr-employee-section",children:[(0,r.jsx)("h4",{children:"Do\u015bwiadczenie w technologiach"}),(0,r.jsx)("div",{className:"hr-no-data",children:"Brak do\u015bwiadczenia w konkretnych technologiach"})]}),"scout"!==t.typeShort?null:t.acquiredLands&&0!==t.acquiredLands?(0,r.jsxs)("div",{className:"hr-employee-section",children:[(0,r.jsx)("h4",{children:"Do\u015bwiadczenie dzier\u017cawcy"}),(0,r.jsxs)("div",{className:"hr-stat-row",children:[(0,r.jsx)("div",{className:"hr-stat-label",children:"Pozyskane grunty"}),(0,r.jsx)("div",{className:"hr-stat-value",children:t.acquiredLands})]}),(0,r.jsxs)("div",{className:"hr-stat-row",children:[(0,r.jsx)("div",{className:"hr-stat-label",children:"\u0141\u0105czna powierzchnia"}),(0,r.jsxs)("div",{className:"hr-stat-value",children:[t.acquiredArea||0," ha"]})]})]}):(0,r.jsxs)("div",{className:"hr-employee-section",children:[(0,r.jsx)("h4",{children:"Do\u015bwiadczenie dzier\u017cawcy"}),(0,r.jsx)("div",{className:"hr-no-data",children:"Jeszcze nie pozyska\u0142 \u017cadnych grunt\xf3w"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"hr-employee-section",children:[(0,r.jsx)("h4",{children:"Cechy charakteru"}),t.traits&&t.traits.length>0?t.traits.map((e=>{const t=(e=>[...xg,...bg,...jg].find((t=>t.id===e))||{label:e,description:""})(e);return(0,r.jsxs)("div",{className:"hr-trait-item",children:[(0,r.jsx)("div",{className:"hr-trait-name",children:t.label}),(0,r.jsx)("div",{className:"hr-trait-description",children:t.description})]},e)})):(0,r.jsx)("div",{className:"hr-no-data",children:"Brak zdefiniowanych cech charakteru"})]}),(0,r.jsxs)("div",{className:"hr-employee-section",children:[(0,r.jsx)("h4",{children:"Potrzeby"}),t.potrzeby?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"hr-stat-row",children:[(0,r.jsx)("div",{className:"hr-stat-label",children:"Uznanie"}),(0,r.jsxs)("div",{className:"hr-stat-value",children:[t.potrzeby.uznanie,"/100"]}),(0,r.jsx)("div",{className:"hr-progress-bar",children:(0,r.jsx)("div",{className:"hr-progress-value",style:{width:`${t.potrzeby.uznanie}%`}})})]}),(0,r.jsxs)("div",{className:"hr-stat-row",children:[(0,r.jsx)("div",{className:"hr-stat-label",children:"Rozw\xf3j"}),(0,r.jsxs)("div",{className:"hr-stat-value",children:[t.potrzeby.rozwoj,"/100"]}),(0,r.jsx)("div",{className:"hr-progress-bar",children:(0,r.jsx)("div",{className:"hr-progress-value",style:{width:`${t.potrzeby.rozwoj}%`}})})]}),(0,r.jsxs)("div",{className:"hr-stat-row",children:[(0,r.jsx)("div",{className:"hr-stat-label",children:"Stabilizacja"}),(0,r.jsxs)("div",{className:"hr-stat-value",children:[t.potrzeby.stabilizacja,"/100"]}),(0,r.jsx)("div",{className:"hr-progress-bar",children:(0,r.jsx)("div",{className:"hr-progress-value",style:{width:`${t.potrzeby.stabilizacja}%`}})})]}),(0,r.jsxs)("div",{className:"hr-stat-row",children:[(0,r.jsx)("div",{className:"hr-stat-label",children:"Autonomia"}),(0,r.jsxs)("div",{className:"hr-stat-value",children:[t.potrzeby.autonomia,"/100"]}),(0,r.jsx)("div",{className:"hr-progress-bar",children:(0,r.jsx)("div",{className:"hr-progress-value",style:{width:`${t.potrzeby.autonomia}%`}})})]}),(0,r.jsxs)("div",{className:"hr-stat-row",children:[(0,r.jsx)("div",{className:"hr-stat-label",children:"Relacje spo\u0142eczne"}),(0,r.jsxs)("div",{className:"hr-stat-value",children:[t.potrzeby.relacjeSpoleczne,"/100"]}),(0,r.jsx)("div",{className:"hr-progress-bar",children:(0,r.jsx)("div",{className:"hr-progress-value",style:{width:`${t.potrzeby.relacjeSpoleczne}%`}})})]})]}):(0,r.jsx)("div",{className:"hr-no-data",children:"Brak zdefiniowanych potrzeb"})]}),(0,r.jsxs)("div",{className:"hr-employee-section",children:[(0,r.jsx)("h4",{children:"Historia"}),t.historia&&0!==t.historia.length?(0,r.jsx)("div",{className:"hr-history-list",children:t.historia.map(((e,t)=>(0,r.jsxs)("div",{className:"hr-history-item",children:[(0,r.jsxs)("div",{className:"hr-history-date",children:[new Date(e.data).toLocaleDateString("pl-PL")," (tura ",s.turn,")"]}),(0,r.jsx)("div",{className:"hr-history-description",children:e.opis})]},t)))}):(0,r.jsx)("div",{className:"hr-no-data",children:"Brak historii wydarze\u0144"})]})]})]})]})};var dv={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},uv=i.createContext&&i.createContext(dv),hv=["attr","size","title"];function pv(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function mv(){return mv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},mv.apply(this,arguments)}function fv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function yv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fv(Object(n),!0).forEach((function(t){gv(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vv(e){return e&&e.map(((e,t)=>i.createElement(e.tag,yv({key:t},e.attr),vv(e.child))))}function wv(e){return t=>i.createElement(xv,mv({attr:yv({},e.attr)},t),vv(e.child))}function xv(e){var t=t=>{var n,{attr:a,size:r,title:s}=e,o=pv(e,hv),l=r||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),i.createElement("svg",mv({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,a,o,{className:n,style:yv(yv({color:e.color||t.color},t.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),s&&i.createElement("title",null,s),e.children)};return void 0!==uv?i.createElement(uv.Consumer,null,(e=>t(e))):t(dv)}function bv(e){return wv({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(e)}function jv(e){return wv({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},child:[]}]})(e)}const kv=e=>{var t,n,a,s,o,l,c,u,h,p,m,f;let{playerState:y,gameState:g}=e;const{dispatch:v}=d(),[w,x]=(0,i.useState)("all"),b=[{id:"fancy_cars",name:"Luksusowe samochody s\u0142u\u017cbowe",category:"lessor",description:"\u0141adniejsze samochody do prezentowania przed rolnikami zwi\u0119kszaj\u0105 skuteczno\u015b\u0107 dzier\u017cawc\xf3w.",levels:[{level:1,cost:25e4,benefit:"+5% do skuteczno\u015bci pozyskiwania grunt\xf3w"},{level:2,cost:5e5,benefit:"+10% do skuteczno\u015bci pozyskiwania grunt\xf3w"},{level:3,cost:1e6,benefit:"+15% do skuteczno\u015bci pozyskiwania grunt\xf3w"}],currentLevel:(null===(t=y.companyUpgrades)||void 0===t?void 0:t.fancy_cars)||0},{id:"digital_mapping",name:"Cyfrowe mapy i analizy",category:"lessor",description:"Zaawansowane narz\u0119dzia do analizy grunt\xf3w pozwalaj\u0105 lepiej wybiera\u0107 lokalizacje.",levels:[{level:1,cost:5e5,benefit:"+10% do dok\u0142adno\u015bci analiz lokalizacyjnych"},{level:2,cost:1e6,benefit:"+20% do dok\u0142adno\u015bci analiz lokalizacyjnych"},{level:3,cost:2e6,benefit:"+35% do dok\u0142adno\u015bci analiz lokalizacyjnych"}],currentLevel:(null===(n=y.companyUpgrades)||void 0===n?void 0:n.digital_mapping)||0},{id:"drone_surveys",name:"Drony do inspekcji terenowych",category:"lessor",description:"Drony pozwalaj\u0105 szybko oceni\u0107 du\u017ce obszary i zidentyfikowa\u0107 najlepsze lokalizacje.",levels:[{level:1,cost:35e4,benefit:"+15% do szybko\u015bci analizy terenu"},{level:2,cost:7e5,benefit:"+25% do szybko\u015bci analizy terenu"},{level:3,cost:14e5,benefit:"+40% do szybko\u015bci analizy terenu"}],currentLevel:(null===(a=y.companyUpgrades)||void 0===a?void 0:a.drone_surveys)||0},{id:"dev_workstations",name:"Zaawansowane stacje robocze",category:"developer",description:"Wysokiej klasy komputery i oprogramowanie CAD dla developer\xf3w.",levels:[{level:1,cost:35e4,benefit:"+8% do szybko\u015bci rozwoju projekt\xf3w"},{level:2,cost:7e5,benefit:"+16% do szybko\u015bci rozwoju projekt\xf3w"},{level:3,cost:14e5,benefit:"+25% do szybko\u015bci rozwoju projekt\xf3w"}],currentLevel:(null===(s=y.companyUpgrades)||void 0===s?void 0:s.dev_workstations)||0},{id:"dev_software",name:"Specjalistyczne oprogramowanie",category:"developer",description:"Licencje na profesjonalne oprogramowanie dla developer\xf3w.",levels:[{level:1,cost:4e5,benefit:"+10% do jako\u015bci dokumentacji technicznej"},{level:2,cost:8e5,benefit:"+20% do jako\u015bci dokumentacji technicznej"},{level:3,cost:16e5,benefit:"+30% do jako\u015bci dokumentacji technicznej"}],currentLevel:(null===(o=y.companyUpgrades)||void 0===o?void 0:o.dev_software)||0},{id:"gis_tools",name:"Zaawansowane narz\u0119dzia GIS",category:"gis",description:"Profesjonalne oprogramowanie i sprz\u0119t do analizy przestrzennej.",levels:[{level:1,cost:5e5,benefit:"+10% do dok\u0142adno\u015bci analiz lokalizacyjnych"},{level:2,cost:1e6,benefit:"+20% do dok\u0142adno\u015bci analiz lokalizacyjnych"},{level:3,cost:2e6,benefit:"+35% do dok\u0142adno\u015bci analiz lokalizacyjnych"}],currentLevel:(null===(l=y.companyUpgrades)||void 0===l?void 0:l.gis_tools)||0},{id:"drone_fleet",name:"Flota dron\xf3w badawczych",category:"gis",description:"Drony z kamerami termowizyjnymi i multispektralnymi do badania terenu.",levels:[{level:1,cost:6e5,benefit:"+12% do szybko\u015bci analizy terenu"},{level:2,cost:12e5,benefit:"+25% do szybko\u015bci analizy terenu"},{level:3,cost:24e5,benefit:"+40% do szybko\u015bci analizy terenu"}],currentLevel:(null===(c=y.companyUpgrades)||void 0===c?void 0:c.drone_fleet)||0},{id:"law_database",name:"Baza danych prawniczych",category:"lawyer",description:"Dost\u0119p do profesjonalnych baz danych prawniczych i precedens\xf3w.",levels:[{level:1,cost:45e4,benefit:"+10% do skuteczno\u015bci w post\u0119powaniach administracyjnych"},{level:2,cost:9e5,benefit:"+20% do skuteczno\u015bci w post\u0119powaniach administracyjnych"},{level:3,cost:18e5,benefit:"+35% do skuteczno\u015bci w post\u0119powaniach administracyjnych"}],currentLevel:(null===(u=y.companyUpgrades)||void 0===u?void 0:u.law_database)||0},{id:"pr_campaigns",name:"Kampanie PR dla projekt\xf3w",category:"lobbyist",description:"Profesjonalne kampanie PR zwi\u0119kszaj\u0105ce akceptacj\u0119 spo\u0142eczn\u0105.",levels:[{level:1,cost:4e5,benefit:"+15% do akceptacji spo\u0142ecznej projekt\xf3w"},{level:2,cost:8e5,benefit:"+30% do akceptacji spo\u0142ecznej projekt\xf3w"},{level:3,cost:16e5,benefit:"+50% do akceptacji spo\u0142ecznej projekt\xf3w"}],currentLevel:(null===(h=y.companyUpgrades)||void 0===h?void 0:h.pr_campaigns)||0},{id:"company_offices",name:"Nowoczesna siedziba firmy",category:"company",description:"Presti\u017cowe biura zwi\u0119kszaj\u0105ce morale wszystkich pracownik\xf3w.",levels:[{level:1,cost:1e6,benefit:"+10% do morale wszystkich pracownik\xf3w"},{level:2,cost:25e5,benefit:"+20% do morale wszystkich pracownik\xf3w"},{level:3,cost:5e6,benefit:"+35% do morale wszystkich pracownik\xf3w"}],currentLevel:(null===(p=y.companyUpgrades)||void 0===p?void 0:p.company_offices)||0},{id:"employee_benefits",name:"Program benefit\xf3w pracowniczych",category:"company",description:"Kompleksowy pakiet benefit\xf3w poprawiaj\u0105cy zadowolenie i wydajno\u015b\u0107.",levels:[{level:1,cost:8e5,benefit:"+8% do wydajno\u015bci i -10% do rotacji pracownik\xf3w"},{level:2,cost:16e5,benefit:"+15% do wydajno\u015bci i -25% do rotacji pracownik\xf3w"},{level:3,cost:32e5,benefit:"+25% do wydajno\u015bci i -50% do rotacji pracownik\xf3w"}],currentLevel:(null===(m=y.companyUpgrades)||void 0===m?void 0:m.employee_benefits)||0},{id:"training_program",name:"Program szkole\u0144 wewn\u0119trznych",category:"company",description:"Systematyczne szkolenia zwi\u0119kszaj\u0105ce kompetencje ca\u0142ego zespo\u0142u.",levels:[{level:1,cost:6e5,benefit:"+10% szybszy wzrost do\u015bwiadczenia"},{level:2,cost:12e5,benefit:"+20% szybszy wzrost do\u015bwiadczenia"},{level:3,cost:24e5,benefit:"+35% szybszy wzrost do\u015bwiadczenia"}],currentLevel:(null===(f=y.companyUpgrades)||void 0===f?void 0:f.training_program)||0}],j="all"===w?b:b.filter((e=>e.category===w));return(0,r.jsxs)("div",{className:"company-upgrades",children:[(0,r.jsx)("h3",{children:"Ulepszenia firmowe"}),(0,r.jsx)("p",{className:"upgrades-description",children:"Inwestuj w rozw\xf3j swojej firmy, aby zwi\u0119kszy\u0107 wydajno\u015b\u0107 i skuteczno\u015b\u0107 twoich pracownik\xf3w. Ka\u017cde ulepszenie mo\u017cna rozwija\u0107 do trzeciego poziomu, zwi\u0119kszaj\u0105c efekty."}),(0,r.jsxs)("div",{className:"upgrades-filters",children:[(0,r.jsx)("button",{className:"filter-btn "+("all"===w?"active":""),onClick:()=>x("all"),children:"Wszystkie"}),(0,r.jsx)("button",{className:"filter-btn "+("lessor"===w?"active":""),onClick:()=>x("lessor"),children:"Dzier\u017cawcy"}),(0,r.jsx)("button",{className:"filter-btn "+("developer"===w?"active":""),onClick:()=>x("developer"),children:"Developerzy"}),(0,r.jsx)("button",{className:"filter-btn "+("gis"===w?"active":""),onClick:()=>x("gis"),children:"GIS"}),(0,r.jsx)("button",{className:"filter-btn "+("lawyer"===w?"active":""),onClick:()=>x("lawyer"),children:"Prawnicy"}),(0,r.jsx)("button",{className:"filter-btn "+("lobbyist"===w?"active":""),onClick:()=>x("lobbyist"),children:"Lobby\u015bci"}),(0,r.jsx)("button",{className:"filter-btn "+("company"===w?"active":""),onClick:()=>x("company"),children:"Firma"})]}),(0,r.jsx)("div",{className:"upgrades-grid",children:j.map((e=>{const t=e.currentLevel+1,n=t>e.levels.length,i=n?null:e.levels[t-1];return(0,r.jsxs)("div",{className:"upgrade-card",children:[(0,r.jsxs)("div",{className:"upgrade-header",children:[(0,r.jsx)("div",{className:"upgrade-title",children:e.name}),(0,r.jsxs)("div",{className:"upgrade-level",children:["Poziom ",e.currentLevel,"/",e.levels.length]})]}),(0,r.jsx)("div",{className:"upgrade-description",children:e.description}),(0,r.jsxs)("div",{className:"upgrade-current-benefits",children:[(0,r.jsx)("div",{className:"upgrade-benefit-title",children:"Obecne korzy\u015bci:"}),0===e.currentLevel?(0,r.jsx)("div",{className:"upgrade-no-benefits",children:"Brak (ulepszenie nie zakupione)"}):(0,r.jsxs)("div",{className:"upgrade-benefit",children:[(0,r.jsx)(bv,{className:"upgrade-benefit-icon"}),(0,r.jsx)("span",{children:e.levels[e.currentLevel-1].benefit})]})]}),!n&&(0,r.jsxs)("div",{className:"upgrade-next-level",children:[(0,r.jsx)("div",{className:"upgrade-benefit-title",children:"Nast\u0119pny poziom:"}),(0,r.jsxs)("div",{className:"upgrade-benefit",children:[(0,r.jsx)(jv,{className:"upgrade-benefit-icon"}),(0,r.jsx)("span",{children:i.benefit})]})]}),(0,r.jsx)("div",{className:"upgrade-cost",children:n?(0,r.jsx)("div",{className:"upgrade-max-level",children:"Osi\u0105gni\u0119to maksymalny poziom"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"upgrade-price",children:["Koszt: ",i.cost.toLocaleString()," PLN"]}),(0,r.jsx)("button",{className:"upgrade-button",onClick:()=>(e=>{const t=b.find((t=>t.id===e));if(!t)return;const n=t.currentLevel+1;if(n>t.levels.length)return;const i=t.levels[n-1].cost;y.cash<i?alert("Niewystarczaj\u0105ce \u015brodki!"):v({type:"PURCHASE_COMPANY_UPGRADE",payload:{upgradeId:e,level:n,cost:i}})})(e.id),disabled:y.cash<i.cost,children:y.cash>=i.cost?"Ulepsz":"Za ma\u0142o \u015brodk\xf3w"})]})})]},e.id)}))})]})},Nv=e=>{let{employees:t,staffManagement:n,gameState:a}=e;const[s,o]=(0,i.useState)(null),[l,c]=(0,i.useState)("skill"),[d,u]=(0,i.useState)("all"),h=(0,i.useMemo)((()=>"all"===d?t:t.filter((e=>e.typeShort===d))),[t,d]),p=(0,i.useMemo)((()=>t.find((e=>e.id===s))||null),[t,s]),m=(0,i.useMemo)((()=>(e=>{if(!e)return[];const t=[{id:"skill",name:"Rozw\xf3j umiej\u0119tno\u015bci",description:"Zwi\u0119ksza og\xf3lny poziom umiej\u0119tno\u015bci pracownika.",cost:e.skill/2*5e3},{id:"morale",name:"Budowanie morale",description:"Zwi\u0119ksza morale i zaanga\u017cowanie pracownika.",cost:3e3}];if("developer"===e.typeShort){const e=[{id:"tech_pv",name:"Technologia PV",description:"Pog\u0142\u0119biona wiedza o technologii fotowoltaicznej.",cost:8e3},{id:"tech_wind",name:"Technologia wiatrowa",description:"Specjalistyczna wiedza o turbinach wiatrowych.",cost:1e4},{id:"tech_bess",name:"Magazyny energii",description:"Specjalistyczna wiedza o magazynach energii.",cost:12e3},{id:"tech_hybrid",name:"Systemy hybrydowe",description:"Wiedza o \u0142\u0105czeniu r\xf3\u017cnych technologii OZE.",cost:15e3}];return[...t,...e]}if("lessor"===e.typeShort){const e=[{id:"negotiation_skills",name:"Techniki negocjacji",description:"Zwi\u0119ksza umiej\u0119tno\u015bci negocjacyjne dzier\u017cawcy, co przek\u0142ada si\u0119 na lepsze warunki um\xf3w dzier\u017cawy.",duration:5,cost:5e3,effects:{negotiation:15,landAcquisitionSpeed:10}},{id:"land_valuation",name:"Wycena grunt\xf3w",description:"Pozwala lepiej ocenia\u0107 warto\u015b\u0107 grunt\xf3w, co zmniejsza koszty dzier\u017cawy.",duration:4,cost:4e3,effects:{landCostReduction:8,landQualityAssessment:15}},{id:"local_relations",name:"Relacje lokalne",description:"Uczy budowania relacji z lokalnymi spo\u0142eczno\u015bciami, co u\u0142atwia pozyskiwanie grunt\xf3w.",duration:6,cost:6e3,effects:{localRelations:20,landAcquisitionSpeed:15}}];return[...t,...e]}if("lawyer"===e.typeShort){const e=[{id:"energy_law",name:"Prawo energetyczne",description:"Pog\u0142\u0119biona wiedza o prawie energetycznym.",cost:9e3},{id:"env_regulations",name:"Regulacje \u015brodowiskowe",description:"Pog\u0142\u0119biona wiedza o przepisach ochrony \u015brodowiska.",cost:8e3}];return[...t,...e]}if("envSpecialist"===e.typeShort){const e=[{id:"env_assessment",name:"Oceny oddzia\u0142ywania",description:"Zaawansowane techniki oceny wp\u0142ywu na \u015brodowisko.",cost:8e3},{id:"nature_protection",name:"Ochrona przyrody",description:"Specjalistyczna wiedza o obszarach chronionych.",cost:7e3}];return[...t,...e]}if("lobbyist"===e.typeShort){const e=[{id:"public_relations",name:"Relacje publiczne",description:"Techniki budowania pozytywnych relacji.",cost:6e3},{id:"community_management",name:"Zarz\u0105dzanie spo\u0142eczno\u015bci\u0105",description:"Sposoby anga\u017cowania lokalnych spo\u0142eczno\u015bci.",cost:7e3}];return[...t,...e]}return t})(p)),[p]),f=(0,i.useMemo)((()=>m.find((e=>e.id===l))||null),[m,l]);return(0,r.jsxs)("div",{className:"training-center",children:[(0,r.jsx)("h3",{children:"Centrum szkole\u0144"}),(0,r.jsx)("p",{className:"training-description",children:"Rozwijaj umiej\u0119tno\u015bci swoich pracownik\xf3w poprzez specjalistyczne szkolenia. Ka\u017cde szkolenie zwi\u0119ksza poziom umiej\u0119tno\u015bci i do\u015bwiadczenie pracownika."}),(0,r.jsx)("div",{className:"training-filters",children:(0,r.jsxs)("select",{value:d,onChange:e=>u(e.target.value),children:[(0,r.jsx)("option",{value:"all",children:"Wszyscy pracownicy"}),(0,r.jsx)("option",{value:"lessor",children:"Dzier\u017cawcy"}),(0,r.jsx)("option",{value:"developer",children:"Developerzy"}),(0,r.jsx)("option",{value:"lawyer",children:"Prawnicy"}),(0,r.jsx)("option",{value:"envSpecialist",children:"Spec. \u015brodowiskowi"}),(0,r.jsx)("option",{value:"lobbyist",children:"Lobby\u015bci"})]})}),(0,r.jsxs)("div",{className:"training-grid",children:[(0,r.jsxs)("div",{className:"employees-for-training",children:[(0,r.jsx)("h4",{children:"Wybierz pracownika do szkolenia"}),0===h.length?(0,r.jsx)("div",{className:"no-employees-message",children:"Brak pracownik\xf3w spe\u0142niaj\u0105cych kryteria"}):(0,r.jsx)("div",{className:"training-employees-list",children:h.map((e=>(0,r.jsxs)("div",{className:"training-employee-item "+(s===e.id?"selected":""),onClick:()=>o(e.id),children:[(0,r.jsx)("div",{className:"training-employee-name",children:e.name}),(0,r.jsxs)("div",{className:"training-employee-info",children:[(0,r.jsx)("span",{children:My(e.typeShort)}),(0,r.jsxs)("span",{children:["Poziom: ",e.skill,"/10"]})]}),(0,r.jsxs)("div",{className:"training-employee-exp",children:["Do\u015bwiadczenie: ",e.experience," p.d."]})]},e.id)))})]}),(0,r.jsx)("div",{className:"training-options",children:p?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h4",{children:"Dost\u0119pne szkolenia"}),(0,r.jsx)("div",{className:"training-types-list",children:m.map((e=>(0,r.jsxs)("div",{className:"training-type-item "+(l===e.id?"selected":""),onClick:()=>c(e.id),children:[(0,r.jsx)("div",{className:"training-type-name",children:e.name}),(0,r.jsxs)("div",{className:"training-type-cost",children:[e.cost.toLocaleString()," PLN"]})]},e.id)))}),f&&(0,r.jsxs)("div",{className:"training-details",children:[(0,r.jsx)("h5",{children:f.name}),(0,r.jsx)("p",{children:f.description}),(0,r.jsxs)("div",{className:"training-cost",children:["Koszt: ",f.cost.toLocaleString()," PLN"]}),(0,r.jsxs)("div",{className:"training-benefits",children:[(0,r.jsx)("div",{className:"training-benefit-title",children:"Korzy\u015bci:"}),"skill"===l&&(0,r.jsx)("div",{className:"training-benefit-item",children:"\u2022 Wzrost umiej\u0119tno\u015bci o 1 punkt"}),"morale"===l&&(0,r.jsx)("div",{className:"training-benefit-item",children:"\u2022 Wzrost morale o 20 punkt\xf3w"}),l.startsWith("tech_")&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"training-benefit-item",children:"\u2022 Dodatkowe do\u015bwiadczenie w technologii"}),(0,r.jsx)("div",{className:"training-benefit-item",children:"\u2022 Szybszy rozw\xf3j projekt\xf3w tej technologii"})]}),"negotiation"===l&&(0,r.jsx)("div",{className:"training-benefit-item",children:"\u2022 Wy\u017csze szanse na pozyskanie grunt\xf3w"}),"land_valuation"===l&&(0,r.jsx)("div",{className:"training-benefit-item",children:"\u2022 Lepsza ocena potencja\u0142u grunt\xf3w"}),(0,r.jsx)("div",{className:"training-benefit-item",children:"\u2022 Wzrost do\u015bwiadczenia zawodowego"})]}),(0,r.jsx)("button",{className:"start-training-button",onClick:()=>{p&&f&&n.trainStaff(p.typeShort,p.id,l)},children:"Rozpocznij szkolenie"})]})]}):(0,r.jsx)("div",{className:"select-employee-prompt",children:"Wybierz pracownika z listy, aby zobaczy\u0107 dost\u0119pne szkolenia"})})]})]})},zv=()=>{const{state:e,dispatch:t}=d(),{state:n,showNotification:a}=mf(),s=Ly(),[o,l]=(0,i.useState)("employees"),[c,u]=(0,i.useState)(null),[h,p]=(0,i.useState)(null),m=()=>{const t=[];return["lessors","developers","lawyers","envSpecialists","lobbyists"].forEach((n=>{e.staff[n]&&e.staff[n].forEach((e=>{t.push({...e,typePlural:n,typeShort:n.endsWith("s")?n.slice(0,-1):n})}))})),t};return(0,r.jsxs)("div",{className:"hr-system-container",children:[(0,r.jsxs)("div",{className:"hr-system-header",children:[(0,r.jsx)("h2",{children:"System zarz\u0105dzania zasobami ludzkimi"}),(0,r.jsxs)("div",{className:"hr-system-tabs",children:[(0,r.jsx)("button",{className:"employees"===o?"active":"",onClick:()=>l("employees"),children:"Pracownicy"}),(0,r.jsx)("button",{className:"training"===o?"active":"",onClick:()=>l("training"),children:"Szkolenia"}),(0,r.jsx)("button",{className:"upgrades"===o?"active":"",onClick:()=>l("upgrades"),children:"Ulepszenia firmy"}),(0,r.jsx)("button",{className:"employment"===o?"active":"",onClick:()=>l("employment"),children:"Zatrudnienie"})]})]}),(0,r.jsxs)("div",{className:"hr-system-content",children:["employees"===o&&(0,r.jsxs)("div",{className:"hr-employees-view",children:[(0,r.jsx)(lv,{employees:m(),onSelectEmployee:e=>{u(e),p(e.typeShort)},selectedEmployeeId:null===c||void 0===c?void 0:c.id}),c&&(0,r.jsx)(cv,{employee:c,staffType:h,staffManagement:s,gameState:n})]}),"training"===o&&(0,r.jsx)(Nv,{employees:m(),staffManagement:s,gameState:n}),"upgrades"===o&&(0,r.jsx)(kv,{playerState:e,gameState:n}),"employment"===o&&(0,r.jsx)(vg,{staffManagement:s,gameState:n,playerState:e})]})]})},_v=e=>{let{onLoginComplete:t}=e;const[n,a]=(0,i.useState)(""),[s,o]=(0,i.useState)(!1),[l,c]=(0,i.useState)(null),[d,u]=(0,i.useState)(null);(0,i.useEffect)((()=>{const e=lf((e=>{u(e),e&&e.displayName&&t(e)}));return()=>e()}),[t]);return(0,r.jsxs)("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-b from-gray-900 to-gray-800 overflow-hidden relative",children:[(0,r.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,r.jsx)("div",{className:"absolute w-96 h-96 rounded-full bg-green-500 opacity-10 -top-20 -left-20 animate-pulse"}),(0,r.jsx)("div",{className:"absolute w-128 h-128 rounded-full bg-blue-500 opacity-10 -bottom-40 -right-40 animate-pulse",style:{animationDuration:"8s"}}),(0,r.jsx)("div",{className:"absolute top-1/4 left-1/4 w-12 h-12 bg-yellow-400 opacity-20 rounded-full animate-float",style:{animationDuration:"5s"}}),(0,r.jsx)("div",{className:"absolute bottom-1/3 right-1/3 w-16 h-16 bg-purple-500 opacity-20 rounded-full animate-float",style:{animationDuration:"7s"}}),(0,r.jsx)("div",{className:"absolute top-2/3 left-1/5 w-8 h-8 bg-red-400 opacity-15 rounded-full animate-float",style:{animationDuration:"6s"}}),(0,r.jsx)("div",{className:"absolute top-1/5 right-1/4 w-10 h-10 bg-indigo-400 opacity-15 rounded-full animate-float",style:{animationDuration:"9s"}}),(0,r.jsxs)("div",{className:"absolute inset-0 opacity-10",children:[(0,r.jsx)("div",{className:"absolute top-1/4 left-0 right-0 h-px bg-gradient-to-r from-transparent via-blue-500 to-transparent"}),(0,r.jsx)("div",{className:"absolute top-2/4 left-0 right-0 h-px bg-gradient-to-r from-transparent via-green-500 to-transparent"}),(0,r.jsx)("div",{className:"absolute top-3/4 left-0 right-0 h-px bg-gradient-to-r from-transparent via-purple-500 to-transparent"})]})]}),(0,r.jsxs)("div",{className:"w-full max-w-md p-8 space-y-8 bg-gray-800 rounded-xl shadow-[0_20px_50px_rgba(0,0,0,0.5)] relative z-10 border border-gray-700 transform transition-all duration-300 hover:scale-[1.01] hover:shadow-[0_25px_60px_rgba(0,0,0,0.5)]",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-blue-500",children:"OZE Developer Manager"}),(0,r.jsx)("p",{className:"mt-3 text-xl text-gray-300 font-light",children:"Witaj w symulatorze dewelopera OZE!"}),(0,r.jsx)("div",{className:"h-1 w-32 bg-gradient-to-r from-green-400 to-blue-500 mx-auto my-4 rounded-full"})]}),d?(0,r.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),n.trim()){o(!0),c(null);try{await(async e=>{try{return await Wi(ef.currentUser,{displayName:e}),ef.currentUser}catch(l){throw console.error("B\u0142\u0105d aktualizacji nazwy u\u017cytkownika:",l),l}})(n),t(d)}catch(l){c("B\u0142\u0105d ustawiania nazwy u\u017cytkownika. Spr\xf3buj ponownie."),console.error(l)}finally{o(!1)}}else c("Prosz\u0119 poda\u0107 nazw\u0119 u\u017cytkownika")},className:"mt-8 space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"nickname",className:"block text-sm font-medium text-gray-300",children:"Tw\xf3j nickname do tablicy wynik\xf3w"}),(0,r.jsx)("input",{id:"nickname",name:"nickname",type:"text",required:!0,value:n,onChange:e=>a(e.target.value),placeholder:"Podaj sw\xf3j nickname",className:"w-full px-3 py-2 mt-1 text-gray-200 placeholder-gray-500 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 shadow-inner transition-all duration-200"})]}),(0,r.jsx)("div",{children:(0,r.jsx)("button",{type:"submit",disabled:s,className:"w-full px-4 py-3 font-bold text-white transition-all duration-300 bg-gradient-to-r from-green-600 to-blue-600 rounded-lg hover:from-green-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transform hover:scale-105 hover:shadow-[0_5px_15px_rgba(0,0,0,0.3)] shadow-lg",children:s?(0,r.jsxs)("span",{className:"flex items-center justify-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Zapisywanie..."]}):"Zapisz i graj"})})]}):(0,r.jsx)("div",{className:"mt-8",children:(0,r.jsx)("button",{onClick:async()=>{o(!0),c(null);try{await nf()}catch(l){c("B\u0142\u0105d logowania. Spr\xf3buj ponownie."),console.error(l)}finally{o(!1)}},disabled:s,className:"w-full px-4 py-3 font-bold text-white transition-all duration-300 bg-gradient-to-r from-green-600 to-blue-600 rounded-lg hover:from-green-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transform hover:scale-105 hover:shadow-[0_5px_15px_rgba(0,0,0,0.3)] shadow-lg",children:s?(0,r.jsxs)("span",{className:"flex items-center justify-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Logowanie..."]}):"Rozpocznij gr\u0119"})}),l&&(0,r.jsx)("div",{className:"p-4 mt-4 text-red-800 bg-red-100 rounded-md animate-pulse",children:(0,r.jsx)("p",{children:l})}),(0,r.jsxs)("div",{className:"text-center text-gray-500 text-sm mt-6",children:[(0,r.jsx)("p",{children:"\xa9 2023 OZE Developer Manager"}),(0,r.jsx)("style",{jsx:!0,children:"\n            @keyframes float {\n              0%, 100% { transform: translateY(0); }\n              50% { transform: translateY(-10px); }\n            }\n            .animate-float {\n              animation: float 5s ease-in-out infinite;\n            }\n          "})]})]})]})},Ev=e=>{let{onBack:t}=e;const[n,a]=(0,i.useState)([]),[s,o]=(0,i.useState)(!0),[l,c]=(0,i.useState)(null),[d,u]=(0,i.useState)("25GW");(0,i.useEffect)((()=>{h()}),[d]);const h=async()=>{o(!0),c(null);try{const e=await of(d);Array.isArray(e)?a(e):(a([]),c("Nie otrzymano poprawnych danych z serwera. Spr\xf3buj ponownie p\xf3\u017aniej."))}catch(l){console.error("B\u0142\u0105d \u0142adowania tablicy wynik\xf3w:",l),a([]),c("Nie uda\u0142o si\u0119 za\u0142adowa\u0107 tablicy wynik\xf3w. Spr\xf3buj ponownie p\xf3\u017aniej.")}finally{o(!1)}},p=e=>{if(!e)return"N/A";return(e.toDate?e.toDate():new Date(e)).toLocaleDateString("pl-PL")};return(0,r.jsx)("div",{className:"flex flex-col min-h-screen bg-gray-800 text-white p-6",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto w-full",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-green-500",children:"Tablica Wynik\xf3w"}),(0,r.jsx)("button",{onClick:t,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",children:"Powr\xf3t do gry"})]}),(0,r.jsxs)("div",{className:"flex mb-6 border-b border-gray-700",children:[(0,r.jsx)("button",{className:"px-4 py-2 "+("25GW"===d?"text-green-500 border-b-2 border-green-500":"text-gray-400"),onClick:()=>u("25GW"),children:"Cel: 25 GW mocy"}),(0,r.jsx)("button",{className:"px-4 py-2 "+("10BLN"===d?"text-green-500 border-b-2 border-green-500":"text-gray-400"),onClick:()=>u("10BLN"),children:"Cel: 10 mld PLN"})]}),s?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("p",{className:"text-xl text-gray-400",children:"\u0141adowanie wynik\xf3w..."})}):l?(0,r.jsx)("div",{className:"bg-red-900/20 border border-red-800 p-4 rounded-lg",children:(0,r.jsx)("p",{children:l})}):0===n.length?(0,r.jsxs)("div",{className:"bg-gray-700 p-8 rounded-lg text-center",children:[(0,r.jsx)("p",{className:"text-xl mb-2",children:"Nikomu jeszcze si\u0119 nie uda\u0142o, czy b\u0119dziesz pierwszy?"}),(0,r.jsx)("p",{className:"text-gray-400",children:"B\u0105d\u017a pierwszym, kt\xf3ry uko\u0144czy gr\u0119 z tym celem!"})]}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full bg-gray-700 rounded-lg overflow-hidden",children:[(0,r.jsx)("thead",{className:"bg-gray-800",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left",children:"Miejsce"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left",children:"Gracz"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left",children:"Liczba tur"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left",children:"Liczba dni"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left",children:"Data uko\u0144czenia"})]})}),(0,r.jsx)("tbody",{children:n.map(((e,t)=>(0,r.jsxs)("tr",{className:t%2===0?"bg-gray-700":"bg-gray-650",children:[(0,r.jsx)("td",{className:"px-6 py-4",children:0===t?(0,r.jsx)("span",{className:"text-yellow-400 font-bold",children:"\ud83c\udfc6 1"}):1===t?(0,r.jsx)("span",{className:"text-gray-300 font-bold",children:"\ud83e\udd48 2"}):2===t?(0,r.jsx)("span",{className:"text-amber-600 font-bold",children:"\ud83e\udd49 3"}):`${t+1}`}),(0,r.jsx)("td",{className:"px-6 py-4 font-medium",children:e.nickname}),(0,r.jsx)("td",{className:"px-6 py-4",children:e.turns}),(0,r.jsx)("td",{className:"px-6 py-4",children:e.days}),(0,r.jsx)("td",{className:"px-6 py-4",children:p(e.timestamp)})]},e.id)))})]})})]})})},Sv=()=>{const[e,t]=(0,i.useState)(null),[n,a]=(0,i.useState)(!1),{state:s,dispatch:o}=mf(),{state:l,dispatch:c}=d();(0,i.useEffect)((()=>{"leaderboard"===s.appView&&(a(!0),o({type:"SET_APP_VIEW",payload:null}))}),[s.appView,o]);const u=(0,i.useCallback)((()=>{n&&a(!1)}),[n]);(0,i.useEffect)((()=>(window.addEventListener("next-game-day",u),()=>{window.removeEventListener("next-game-day",u)})),[u]);const h=(0,i.useCallback)((e=>{e&&e.preventDefault&&e.preventDefault();try{window.history.pushState(null,document.title,window.location.href)}catch(t){console.error("B\u0142\u0105d przy manipulacji historii:",t)}n&&a(!1)}),[n]);(0,i.useEffect)((()=>{try{window.history.pushState(null,document.title,window.location.href),window.addEventListener("popstate",h)}catch(e){console.error("B\u0142\u0105d przy dodawaniu obs\u0142ugi historii:",e)}return()=>{try{window.removeEventListener("popstate",h)}catch(e){console.error("B\u0142\u0105d przy usuwaniu obs\u0142ugi historii:",e)}}}),[h]);const p=(0,i.useCallback)((async()=>{if(e)try{await af(s,l),console.log("Stan gry zapisany")}catch(t){console.error("B\u0142\u0105d zapisywania stanu gry:",t)}}),[e,s,l]);(0,i.useEffect)((()=>{if(!e)return;const t=setInterval(p,6e4);return()=>clearInterval(t)}),[e,p]);const m=(0,i.useCallback)((async t=>{if(e)try{await sf(t,s.day),console.log(`Osi\u0105gni\u0119to cel: ${t}`)}catch(n){console.error("B\u0142\u0105d zapisywania wyniku:",n)}}),[e,s.day]);(0,i.useEffect)((()=>{e&&l&&(l.installedCapacity+l.rtbCapacity>=25e3&&m("25GW"),l.cash>=1e10&&m("10BLN"))}),[e,l,m]),(0,i.useEffect)((()=>{if(e)return window.saveGameFunction=p,()=>{window.saveGameFunction=void 0}}),[e,p]);const f=async e=>{t(e);try{const e=await rf();e&&e.gameState&&(o({type:"LOAD_GAME",payload:e.gameState}),c({type:"LOAD_PLAYER",payload:e.playerState}),console.log("Wczytano zapisany stan gry"),o({type:"SET_NOTIFICATION",payload:{text:"Wczytano zapisany stan gry!",type:"success"}}))}catch(n){console.error("B\u0142\u0105d wczytywania stanu gry:",n)}},y=()=>{p()};if(!e)return(0,r.jsx)(_v,{onLoginComplete:f});if(n)return(0,r.jsx)(Ev,{onBack:()=>a(!1)});const g=()=>{switch(s.currentScreen){case"home":default:return(0,r.jsx)(Iy,{onShowLeaderboard:()=>a(!0),onSaveGame:y});case"regions":return(0,r.jsx)(ov,{});case"company":return(0,r.jsx)(Ig,{});case"events":return(0,r.jsx)(Kg,{});case"competitors":return(0,r.jsx)(Xg,{});case"market":return(0,r.jsx)(nv,{});case"hr":return(0,r.jsx)(zv,{})}};return(0,r.jsx)(Sy,{children:(0,r.jsx)(g,{})})};const Tv=function(){return(0,r.jsx)(Rf,{children:(0,r.jsx)(Sv,{})})};a.createRoot(document.getElementById("root")).render((0,r.jsx)(i.StrictMode,{children:(0,r.jsx)(Tv,{})}))})();