/*! For license information please see main.32e945e6.js.LICENSE.txt */
(()=>{"use strict";var e={49:(e,t)=>{var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,y={};function g(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||m}function v(){}function w(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||m}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=g.prototype;var x=w.prototype=new v;x.constructor=w,f(x,g.prototype),x.isPureReactComponent=!0;var b=Array.isArray,j=Object.prototype.hasOwnProperty,k={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function z(e,t,i){var r,a={},s=null,o=null;if(null!=t)for(r in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)j.call(t,r)&&!N.hasOwnProperty(r)&&(a[r]=t[r]);var l=arguments.length-2;if(1===l)a.children=i;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===a[r]&&(a[r]=l[r]);return{$$typeof:n,type:e,key:s,ref:o,props:a,_owner:k.current}}function _(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var S=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function C(e,t,r,a,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return s=s(l=e),e=""===a?"."+E(l,0):a,b(s)?(r="",null!=e&&(r=e.replace(S,"$&/")+"/"),C(s,t,r,"",(function(e){return e}))):null!=s&&(_(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(S,"$&/")+"/")+e)),t.push(s)),1;if(l=0,a=""===a?".":a+":",b(e))for(var c=0;c<e.length;c++){var d=a+E(o=e[c],c);l+=C(o,t,r,d,s)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(o=e.next()).done;)l+=C(o=o.value,t,r,d=a+E(o,c++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function T(e,t,n){if(null==e)return e;var i=[],r=0;return C(e,i,"","",(function(e){return t.call(n,e,r++)})),i}function P(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},A={transition:null},M={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:A,ReactCurrentOwner:k};function D(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:T,forEach:function(e,t,n){T(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return T(e,(function(){t++})),t},toArray:function(e){return T(e,(function(e){return e}))||[]},only:function(e){if(!_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=r,t.Profiler=s,t.PureComponent=w,t.StrictMode=a,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,t.act=D,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=f({},e.props),a=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=k.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)j.call(t,c)&&!N.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=i;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:n,type:e.type,key:a,ref:s,props:r,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=z,t.createFactory=function(e){var t=z.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=_,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=A.transition;A.transition={};try{e()}finally{A.transition=t}},t.unstable_act=D,t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,n){return I.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,n){return I.current.useReducer(e,t,n)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return I.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return I.current.useTransition()},t.version="18.3.1"},119:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(345)},340:(e,t,n)=>{e.exports=n(761)},345:(e,t,n)=>{var i=n(950),r=n(340);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function f(e,t,n,i,r,a,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){y[e]=new f(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];y[t]=new f(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){y[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){y[e]=new f(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){y[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){y[e]=new f(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){y[e]=new f(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){y[e]=new f(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){y[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function w(e,t,n,i){var r=y.hasOwnProperty(t)?y[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||"undefined"===typeof t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!u.call(m,e)||!u.call(p,e)&&(h.test(e)?m[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,v);y[t]=new f(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,v);y[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,v);y[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){y[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)})),y.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){y[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),j=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),S=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var A=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=M&&e[M]||e["@@iterator"])?e:null}var R,O=Object.assign;function L(e){if(void 0===R)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);R=t&&t[1]||""}return"\n"+R+e}var F=!1;function U(e,t){if(!e||F)return"";F=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),a=i.stack.split("\n"),s=r.length-1,o=a.length-1;1<=s&&0<=o&&r[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(r[s]!==a[o]){if(1!==s||1!==o)do{if(s--,0>--o||r[s]!==a[o]){var l="\n"+r[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=o);break}}}finally{F=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?L(e):""}function V(e){switch(e.tag){case 5:return L(e.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case k:return"Fragment";case j:return"Portal";case z:return"Profiler";case N:return"StrictMode";case C:return"Suspense";case T:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case S:return(e.displayName||"Context")+".Consumer";case _:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function $(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=q(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function G(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(Na){return e.body}}function Q(e,t){var n=t.checked;return O({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Z(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&w(e,"checked",t,!1)}function J(e,t){Y(e,t);var n=W(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function X(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&G(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return O({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function ae(e,t){var n=W(t.value),i=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction((function(){return de(e,t)}))}:de);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ye(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=fe(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(pe).forEach((function(e){me.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ge=O({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function we(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var je=null,ke=null,Ne=null;function ze(e){if(e=wr(e)){if("function"!==typeof je)throw Error(a(280));var t=e.stateNode;t&&(t=br(t),je(e.stateNode,e.type,t))}}function _e(e){ke?Ne?Ne.push(e):Ne=[e]:ke=e}function Se(){if(ke){var e=ke,t=Ne;if(Ne=ke=null,ze(e),t)for(e=0;e<t.length;e++)ze(t[e])}}function Ee(e,t){return e(t)}function Ce(){}var Te=!1;function Pe(e,t,n){if(Te)return e(t,n);Te=!0;try{return Ee(e,t,n)}finally{Te=!1,(null!==ke||null!==Ne)&&(Ce(),Se())}}function Ie(e,t){var n=e.stateNode;if(null===n)return null;var i=br(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Ae=!1;if(d)try{var Me={};Object.defineProperty(Me,"passive",{get:function(){Ae=!0}}),window.addEventListener("test",Me,Me),window.removeEventListener("test",Me,Me)}catch(de){Ae=!1}function De(e,t,n,i,r,a,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var Re=!1,Oe=null,Le=!1,Fe=null,Ue={onError:function(e){Re=!0,Oe=e}};function Ve(e,t,n,i,r,a,s,o,l){Re=!1,Oe=null,De.apply(Ue,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function $e(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Be(e)!==e)throw Error(a(188))}function qe(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(i=r.return)){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return We(r),e;if(s===i)return We(r),t;s=s.sibling}throw Error(a(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,l=r.child;l;){if(l===n){o=!0,n=r,i=s;break}if(l===i){o=!0,i=r,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,i=r;break}if(l===i){o=!0,i=s,n=r;break}l=l.sibling}if(!o)throw Error(a(189))}}if(n.alternate!==i)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e),null!==e?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Ke=r.unstable_scheduleCallback,Ge=r.unstable_cancelCallback,Qe=r.unstable_shouldYield,Ze=r.unstable_requestPaint,Ye=r.unstable_now,Je=r.unstable_getCurrentPriorityLevel,Xe=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,it=r.unstable_IdlePriority,rt=null,at=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,a=e.pingedLanes,s=268435455&n;if(0!==s){var o=s&~r;0!==o?i=ut(o):0!==(a&=s)&&(i=ut(a))}else 0!==(s=n&~r)?i=ut(s):0!==a&&(i=ut(a));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(a=t&-t)||16===r&&0!==(4194240&a)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-st(t)),i|=e[n],t&=~r;return i}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function yt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-st(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var wt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var bt,jt,kt,Nt,zt,_t=!1,St=[],Et=null,Ct=null,Tt=null,Pt=new Map,It=new Map,At=[],Mt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":Tt=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":It.delete(t.pointerId)}}function Rt(e,t,n,i,r,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:a,targetContainers:[r]},null!==t&&(null!==(t=wr(t))&&jt(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Ot(e){var t=vr(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=$e(n)))return e.blockedOn=t,void zt(e.priority,(function(){kt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Lt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=wr(n))&&jt(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);xe=i,n.target.dispatchEvent(i),xe=null,t.shift()}return!0}function Ft(e,t,n){Lt(e)&&n.delete(t)}function Ut(){_t=!1,null!==Et&&Lt(Et)&&(Et=null),null!==Ct&&Lt(Ct)&&(Ct=null),null!==Tt&&Lt(Tt)&&(Tt=null),Pt.forEach(Ft),It.forEach(Ft)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,_t||(_t=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ut)))}function Bt(e){function t(t){return Vt(t,e)}if(0<St.length){Vt(St[0],e);for(var n=1;n<St.length;n++){var i=St[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==Et&&Vt(Et,e),null!==Ct&&Vt(Ct,e),null!==Tt&&Vt(Tt,e),Pt.forEach(t),It.forEach(t),n=0;n<At.length;n++)(i=At[n]).blockedOn===e&&(i.blockedOn=null);for(;0<At.length&&null===(n=At[0]).blockedOn;)Ot(n),null===n.blockedOn&&At.shift()}var $t=x.ReactCurrentBatchConfig,Wt=!0;function qt(e,t,n,i){var r=wt,a=$t.transition;$t.transition=null;try{wt=1,Kt(e,t,n,i)}finally{wt=r,$t.transition=a}}function Ht(e,t,n,i){var r=wt,a=$t.transition;$t.transition=null;try{wt=4,Kt(e,t,n,i)}finally{wt=r,$t.transition=a}}function Kt(e,t,n,i){if(Wt){var r=Qt(e,t,n,i);if(null===r)Wi(e,t,i,Gt,n),Dt(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return Et=Rt(Et,e,t,n,i,r),!0;case"dragenter":return Ct=Rt(Ct,e,t,n,i,r),!0;case"mouseover":return Tt=Rt(Tt,e,t,n,i,r),!0;case"pointerover":var a=r.pointerId;return Pt.set(a,Rt(Pt.get(a)||null,e,t,n,i,r)),!0;case"gotpointercapture":return a=r.pointerId,It.set(a,Rt(It.get(a)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Dt(e,i),4&t&&-1<Mt.indexOf(e)){for(;null!==r;){var a=wr(r);if(null!==a&&bt(a),null===(a=Qt(e,t,n,i))&&Wi(e,t,i,Gt,n),a===r)break;r=a}null!==r&&i.stopPropagation()}else Wi(e,t,i,null,n)}}var Gt=null;function Qt(e,t,n,i){if(Gt=null,null!==(e=vr(e=be(i))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=$e(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function Zt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Xe:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var Yt=null,Jt=null,Xt=null;function en(){if(Xt)return Xt;var e,t,n=Jt,i=n.length,r="value"in Yt?Yt.value:Yt.textContent,a=r.length;for(e=0;e<i&&n[e]===r[e];e++);var s=i-e;for(t=1;t<=s&&n[i-t]===r[a-t];t++);return Xt=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,i,r,a){for(var s in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(r):r[s]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return O(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=an(cn),un=O({},cn,{view:0,detail:0}),hn=an(un),pn=O({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(sn=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=sn=0,ln=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),mn=an(pn),fn=an(O({},pn,{dataTransfer:0})),yn=an(O({},un,{relatedTarget:0})),gn=an(O({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=O({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),wn=an(vn),xn=an(O({},cn,{data:0})),bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=kn[e])&&!!t[e]}function zn(){return Nn}var _n=O({},un,{key:function(e){if(e.key){var t=bn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?jn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Sn=an(_n),En=an(O({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Cn=an(O({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zn})),Tn=an(O({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pn=O({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),In=an(Pn),An=[9,13,27,32],Mn=d&&"CompositionEvent"in window,Dn=null;d&&"documentMode"in document&&(Dn=document.documentMode);var Rn=d&&"TextEvent"in window&&!Dn,On=d&&(!Mn||Dn&&8<Dn&&11>=Dn),Ln=String.fromCharCode(32),Fn=!1;function Un(e,t){switch(e){case"keyup":return-1!==An.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var $n={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!$n[e.type]:"textarea"===t}function qn(e,t,n,i){_e(i),0<(t=Hi(t,"onChange")).length&&(n=new dn("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Hn=null,Kn=null;function Gn(e){Li(e,0)}function Qn(e){if(K(xr(e)))return e}function Zn(e,t){if("change"===e)return t}var Yn=!1;if(d){var Jn;if(d){var Xn="oninput"in document;if(!Xn){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),Xn="function"===typeof ei.oninput}Jn=Xn}else Jn=!1;Yn=Jn&&(!document.documentMode||9<document.documentMode)}function ti(){Hn&&(Hn.detachEvent("onpropertychange",ni),Kn=Hn=null)}function ni(e){if("value"===e.propertyName&&Qn(Kn)){var t=[];qn(t,Kn,e,be(e)),Pe(Gn,t)}}function ii(e,t,n){"focusin"===e?(ti(),Kn=n,(Hn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function ri(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Kn)}function ai(e,t){if("click"===e)return Qn(t)}function si(e,t){if("input"===e||"change"===e)return Qn(t)}var oi="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function li(e,t){if(oi(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!u.call(t,r)||!oi(e[r],t[r]))return!1}return!0}function ci(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function di(e,t){var n,i=ci(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ci(i)}}function ui(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ui(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hi(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=G((e=t.contentWindow).document)}return t}function pi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mi(e){var t=hi(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ui(n.ownerDocument.documentElement,n)){if(null!==i&&pi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,a=Math.min(i.start,r);i=void 0===i.end?a:Math.min(i.end,r),!e.extend&&a>i&&(r=i,i=a,a=r),r=di(n,a);var s=di(n,i);r&&s&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),a>i?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fi=d&&"documentMode"in document&&11>=document.documentMode,yi=null,gi=null,vi=null,wi=!1;function xi(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;wi||null==yi||yi!==G(i)||("selectionStart"in(i=yi)&&pi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},vi&&li(vi,i)||(vi=i,0<(i=Hi(gi,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=yi)))}function bi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ji={animationend:bi("Animation","AnimationEnd"),animationiteration:bi("Animation","AnimationIteration"),animationstart:bi("Animation","AnimationStart"),transitionend:bi("Transition","TransitionEnd")},ki={},Ni={};function zi(e){if(ki[e])return ki[e];if(!ji[e])return e;var t,n=ji[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ni)return ki[e]=n[t];return e}d&&(Ni=document.createElement("div").style,"AnimationEvent"in window||(delete ji.animationend.animation,delete ji.animationiteration.animation,delete ji.animationstart.animation),"TransitionEvent"in window||delete ji.transitionend.transition);var _i=zi("animationend"),Si=zi("animationiteration"),Ei=zi("animationstart"),Ci=zi("transitionend"),Ti=new Map,Pi="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ii(e,t){Ti.set(e,t),l(t,[e])}for(var Ai=0;Ai<Pi.length;Ai++){var Mi=Pi[Ai];Ii(Mi.toLowerCase(),"on"+(Mi[0].toUpperCase()+Mi.slice(1)))}Ii(_i,"onAnimationEnd"),Ii(Si,"onAnimationIteration"),Ii(Ei,"onAnimationStart"),Ii("dblclick","onDoubleClick"),Ii("focusin","onFocus"),Ii("focusout","onBlur"),Ii(Ci,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Di="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ri=new Set("cancel close invalid load scroll toggle".split(" ").concat(Di));function Oi(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,r,s,o,l,c){if(Ve.apply(this,arguments),Re){if(!Re)throw Error(a(198));var d=Oe;Re=!1,Oe=null,Le||(Le=!0,Fe=d)}}(i,t,void 0,e),e.currentTarget=null}function Li(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var a=void 0;if(t)for(var s=i.length-1;0<=s;s--){var o=i[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&r.isPropagationStopped())break e;Oi(r,o,c),a=l}else for(s=0;s<i.length;s++){if(l=(o=i[s]).instance,c=o.currentTarget,o=o.listener,l!==a&&r.isPropagationStopped())break e;Oi(r,o,c),a=l}}}if(Le)throw e=Fe,Le=!1,Fe=null,e}function Fi(e,t){var n=t[fr];void 0===n&&(n=t[fr]=new Set);var i=e+"__bubble";n.has(i)||($i(t,e,2,!1),n.add(i))}function Ui(e,t,n){var i=0;t&&(i|=4),$i(n,e,i,t)}var Vi="_reactListening"+Math.random().toString(36).slice(2);function Bi(e){if(!e[Vi]){e[Vi]=!0,s.forEach((function(t){"selectionchange"!==t&&(Ri.has(t)||Ui(t,!1,e),Ui(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vi]||(t[Vi]=!0,Ui("selectionchange",!1,t))}}function $i(e,t,n,i){switch(Zt(t)){case 1:var r=qt;break;case 4:r=Ht;break;default:r=Kt}n=r.bind(null,t,n,e),r=void 0,!Ae||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Wi(e,t,n,i,r){var a=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var s=i.tag;if(3===s||4===s){var o=i.stateNode.containerInfo;if(o===r||8===o.nodeType&&o.parentNode===r)break;if(4===s)for(s=i.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;s=s.return}for(;null!==o;){if(null===(s=vr(o)))return;if(5===(l=s.tag)||6===l){i=a=s;continue e}o=o.parentNode}}i=i.return}Pe((function(){var i=a,r=be(n),s=[];e:{var o=Ti.get(e);if(void 0!==o){var l=dn,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Sn;break;case"focusin":c="focus",l=yn;break;case"focusout":c="blur",l=yn;break;case"beforeblur":case"afterblur":l=yn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Cn;break;case _i:case Si:case Ei:l=gn;break;case Ci:l=Tn;break;case"scroll":l=hn;break;case"wheel":l=In;break;case"copy":case"cut":case"paste":l=wn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=En}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==o?o+"Capture":null:o;d=[];for(var p,m=i;null!==m;){var f=(p=m).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==h&&(null!=(f=Ie(m,h))&&d.push(qi(m,f,p)))),u)break;m=m.return}0<d.length&&(o=new l(o,c,null,n,r),s.push({event:o,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!vr(c)&&!c[mr])&&(l||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?vr(c):null)&&(c!==(u=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(d=mn,f="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=En,f="onPointerLeave",h="onPointerEnter",m="pointer"),u=null==l?o:xr(l),p=null==c?o:xr(c),(o=new d(f,m+"leave",l,n,r)).target=u,o.relatedTarget=p,f=null,vr(r)===i&&((d=new d(h,m+"enter",c,n,r)).target=p,d.relatedTarget=u,f=d),u=f,l&&c)e:{for(h=c,m=0,p=d=l;p;p=Ki(p))m++;for(p=0,f=h;f;f=Ki(f))p++;for(;0<m-p;)d=Ki(d),m--;for(;0<p-m;)h=Ki(h),p--;for(;m--;){if(d===h||null!==h&&d===h.alternate)break e;d=Ki(d),h=Ki(h)}d=null}else d=null;null!==l&&Gi(s,o,l,d,!1),null!==c&&null!==u&&Gi(s,u,c,d,!0)}if("select"===(l=(o=i?xr(i):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var y=Zn;else if(Wn(o))if(Yn)y=si;else{y=ri;var g=ii}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(y=ai);switch(y&&(y=y(e,i))?qn(s,y,n,r):(g&&g(e,o,i),"focusout"===e&&(g=o._wrapperState)&&g.controlled&&"number"===o.type&&ee(o,"number",o.value)),g=i?xr(i):window,e){case"focusin":(Wn(g)||"true"===g.contentEditable)&&(yi=g,gi=i,vi=null);break;case"focusout":vi=gi=yi=null;break;case"mousedown":wi=!0;break;case"contextmenu":case"mouseup":case"dragend":wi=!1,xi(s,n,r);break;case"selectionchange":if(fi)break;case"keydown":case"keyup":xi(s,n,r)}var v;if(Mn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Bn?Un(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(On&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==w?"onCompositionEnd"===w&&Bn&&(v=en()):(Jt="value"in(Yt=r)?Yt.value:Yt.textContent,Bn=!0)),0<(g=Hi(i,w)).length&&(w=new xn(w,e,null,n,r),s.push({event:w,listeners:g}),v?w.data=v:null!==(v=Vn(n))&&(w.data=v))),(v=Rn?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(Fn=!0,Ln);case"textInput":return(e=t.data)===Ln&&Fn?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!Mn&&Un(e,t)?(e=en(),Xt=Jt=Yt=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return On&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=Hi(i,"onBeforeInput")).length&&(r=new xn("onBeforeInput","beforeinput",null,n,r),s.push({event:r,listeners:i}),r.data=v))}Li(s,t)}))}function qi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hi(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,a=r.stateNode;5===r.tag&&null!==a&&(r=a,null!=(a=Ie(e,n))&&i.unshift(qi(e,a,r)),null!=(a=Ie(e,t))&&i.push(qi(e,a,r))),e=e.return}return i}function Ki(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gi(e,t,n,i,r){for(var a=t._reactName,s=[];null!==n&&n!==i;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===i)break;5===o.tag&&null!==c&&(o=c,r?null!=(l=Ie(n,a))&&s.unshift(qi(n,l,o)):r||null!=(l=Ie(n,a))&&s.push(qi(n,l,o))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Qi=/\r\n?/g,Zi=/\u0000|\uFFFD/g;function Yi(e){return("string"===typeof e?e:""+e).replace(Qi,"\n").replace(Zi,"")}function Ji(e,t,n){if(t=Yi(t),Yi(e)!==t&&n)throw Error(a(425))}function Xi(){}var er=null,tr=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,ar="function"===typeof Promise?Promise:void 0,sr="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ar?function(e){return ar.resolve(null).then(e).catch(or)}:ir;function or(e){setTimeout((function(){throw e}))}function lr(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void Bt(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);Bt(t)}function cr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function dr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ur=Math.random().toString(36).slice(2),hr="__reactFiber$"+ur,pr="__reactProps$"+ur,mr="__reactContainer$"+ur,fr="__reactEvents$"+ur,yr="__reactListeners$"+ur,gr="__reactHandles$"+ur;function vr(e){var t=e[hr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[mr]||n[hr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=dr(e);null!==e;){if(n=e[hr])return n;e=dr(e)}return t}n=(e=n).parentNode}return null}function wr(e){return!(e=e[hr]||e[mr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function br(e){return e[pr]||null}var jr=[],kr=-1;function Nr(e){return{current:e}}function zr(e){0>kr||(e.current=jr[kr],jr[kr]=null,kr--)}function _r(e,t){kr++,jr[kr]=e.current,e.current=t}var Sr={},Er=Nr(Sr),Cr=Nr(!1),Tr=Sr;function Pr(e,t){var n=e.type.contextTypes;if(!n)return Sr;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,a={};for(r in n)a[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ir(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ar(){zr(Cr),zr(Er)}function Mr(e,t,n){if(Er.current!==Sr)throw Error(a(168));_r(Er,t),_r(Cr,n)}function Dr(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(a(108,$(e)||"Unknown",r));return O({},n,i)}function Rr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Sr,Tr=Er.current,_r(Er,e),_r(Cr,Cr.current),!0}function Or(e,t,n){var i=e.stateNode;if(!i)throw Error(a(169));n?(e=Dr(e,t,Tr),i.__reactInternalMemoizedMergedChildContext=e,zr(Cr),zr(Er),_r(Er,e)):zr(Cr),_r(Cr,n)}var Lr=null,Fr=!1,Ur=!1;function Vr(e){null===Lr?Lr=[e]:Lr.push(e)}function Br(){if(!Ur&&null!==Lr){Ur=!0;var e=0,t=wt;try{var n=Lr;for(wt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Lr=null,Fr=!1}catch(r){throw null!==Lr&&(Lr=Lr.slice(e+1)),Ke(Xe,Br),r}finally{wt=t,Ur=!1}}return null}var $r=[],Wr=0,qr=null,Hr=0,Kr=[],Gr=0,Qr=null,Zr=1,Yr="";function Jr(e,t){$r[Wr++]=Hr,$r[Wr++]=qr,qr=e,Hr=t}function Xr(e,t,n){Kr[Gr++]=Zr,Kr[Gr++]=Yr,Kr[Gr++]=Qr,Qr=e;var i=Zr;e=Yr;var r=32-st(i)-1;i&=~(1<<r),n+=1;var a=32-st(t)+r;if(30<a){var s=r-r%5;a=(i&(1<<s)-1).toString(32),i>>=s,r-=s,Zr=1<<32-st(t)+r|n<<r|i,Yr=a+e}else Zr=1<<a|n<<r|i,Yr=e}function ea(e){null!==e.return&&(Jr(e,1),Xr(e,1,0))}function ta(e){for(;e===qr;)qr=$r[--Wr],$r[Wr]=null,Hr=$r[--Wr],$r[Wr]=null;for(;e===Qr;)Qr=Kr[--Gr],Kr[Gr]=null,Yr=Kr[--Gr],Kr[Gr]=null,Zr=Kr[--Gr],Kr[Gr]=null}var na=null,ia=null,ra=!1,aa=null;function sa(e,t){var n=Ic(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,ia=cr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,ia=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qr?{id:Zr,overflow:Yr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ic(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,ia=null,!0);default:return!1}}function la(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ca(e){if(ra){var t=ia;if(t){var n=t;if(!oa(e,t)){if(la(e))throw Error(a(418));t=cr(n.nextSibling);var i=na;t&&oa(e,t)?sa(i,n):(e.flags=-4097&e.flags|2,ra=!1,na=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,ra=!1,na=e}}}function da(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function ua(e){if(e!==na)return!1;if(!ra)return da(e),ra=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=ia)){if(la(e))throw ha(),Error(a(418));for(;t;)sa(e,t),t=cr(t.nextSibling)}if(da(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ia=cr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ia=null}}else ia=na?cr(e.stateNode.nextSibling):null;return!0}function ha(){for(var e=ia;e;)e=cr(e.nextSibling)}function pa(){ia=na=null,ra=!1}function ma(e){null===aa?aa=[e]:aa.push(e)}var fa=x.ReactCurrentBatchConfig;function ya(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var i=n.stateNode}if(!i)throw Error(a(147,e));var r=i,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=r.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function ga(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function va(e){return(0,e._init)(e._payload)}function wa(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Mc(e,t)).index=0,e.sibling=null,e}function s(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=Lc(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,i){var a=n.type;return a===k?u(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===I&&va(a)===t.type)?((i=r(t,n.props)).ref=ya(e,t,n),i.return=e,i):((i=Dc(n.type,n.key,n.props,null,e.mode,i)).ref=ya(e,t,n),i.return=e,i)}function d(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function u(e,t,n,i,a){return null===t||7!==t.tag?((t=Rc(n,e.mode,i,a)).return=e,t):((t=r(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case b:return(n=Dc(t.type,t.key,t.props,null,e.mode,n)).ref=ya(e,null,t),n.return=e,n;case j:return(t=Fc(t,e.mode,n)).return=e,t;case I:return h(e,(0,t._init)(t._payload),n)}if(te(t)||D(t))return(t=Rc(t,e.mode,n,null)).return=e,t;ga(e,t)}return null}function p(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===r?c(e,t,n,i):null;case j:return n.key===r?d(e,t,n,i):null;case I:return p(e,t,(r=n._init)(n._payload),i)}if(te(n)||D(n))return null!==r?null:u(e,t,n,i,null);ga(e,n)}return null}function m(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case b:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case j:return d(t,e=e.get(null===i.key?n:i.key)||null,i,r);case I:return m(e,t,n,(0,i._init)(i._payload),r)}if(te(i)||D(i))return u(t,e=e.get(n)||null,i,r,null);ga(t,i)}return null}function f(r,a,o,l){for(var c=null,d=null,u=a,f=a=0,y=null;null!==u&&f<o.length;f++){u.index>f?(y=u,u=null):y=u.sibling;var g=p(r,u,o[f],l);if(null===g){null===u&&(u=y);break}e&&u&&null===g.alternate&&t(r,u),a=s(g,a,f),null===d?c=g:d.sibling=g,d=g,u=y}if(f===o.length)return n(r,u),ra&&Jr(r,f),c;if(null===u){for(;f<o.length;f++)null!==(u=h(r,o[f],l))&&(a=s(u,a,f),null===d?c=u:d.sibling=u,d=u);return ra&&Jr(r,f),c}for(u=i(r,u);f<o.length;f++)null!==(y=m(u,r,f,o[f],l))&&(e&&null!==y.alternate&&u.delete(null===y.key?f:y.key),a=s(y,a,f),null===d?c=y:d.sibling=y,d=y);return e&&u.forEach((function(e){return t(r,e)})),ra&&Jr(r,f),c}function y(r,o,l,c){var d=D(l);if("function"!==typeof d)throw Error(a(150));if(null==(l=d.call(l)))throw Error(a(151));for(var u=d=null,f=o,y=o=0,g=null,v=l.next();null!==f&&!v.done;y++,v=l.next()){f.index>y?(g=f,f=null):g=f.sibling;var w=p(r,f,v.value,c);if(null===w){null===f&&(f=g);break}e&&f&&null===w.alternate&&t(r,f),o=s(w,o,y),null===u?d=w:u.sibling=w,u=w,f=g}if(v.done)return n(r,f),ra&&Jr(r,y),d;if(null===f){for(;!v.done;y++,v=l.next())null!==(v=h(r,v.value,c))&&(o=s(v,o,y),null===u?d=v:u.sibling=v,u=v);return ra&&Jr(r,y),d}for(f=i(r,f);!v.done;y++,v=l.next())null!==(v=m(f,r,y,v.value,c))&&(e&&null!==v.alternate&&f.delete(null===v.key?y:v.key),o=s(v,o,y),null===u?d=v:u.sibling=v,u=v);return e&&f.forEach((function(e){return t(r,e)})),ra&&Jr(r,y),d}return function e(i,a,s,l){if("object"===typeof s&&null!==s&&s.type===k&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case b:e:{for(var c=s.key,d=a;null!==d;){if(d.key===c){if((c=s.type)===k){if(7===d.tag){n(i,d.sibling),(a=r(d,s.props.children)).return=i,i=a;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===I&&va(c)===d.type){n(i,d.sibling),(a=r(d,s.props)).ref=ya(i,d,s),a.return=i,i=a;break e}n(i,d);break}t(i,d),d=d.sibling}s.type===k?((a=Rc(s.props.children,i.mode,l,s.key)).return=i,i=a):((l=Dc(s.type,s.key,s.props,null,i.mode,l)).ref=ya(i,a,s),l.return=i,i=l)}return o(i);case j:e:{for(d=s.key;null!==a;){if(a.key===d){if(4===a.tag&&a.stateNode.containerInfo===s.containerInfo&&a.stateNode.implementation===s.implementation){n(i,a.sibling),(a=r(a,s.children||[])).return=i,i=a;break e}n(i,a);break}t(i,a),a=a.sibling}(a=Fc(s,i.mode,l)).return=i,i=a}return o(i);case I:return e(i,a,(d=s._init)(s._payload),l)}if(te(s))return f(i,a,s,l);if(D(s))return y(i,a,s,l);ga(i,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==a&&6===a.tag?(n(i,a.sibling),(a=r(a,s)).return=i,i=a):(n(i,a),(a=Lc(s,i.mode,l)).return=i,i=a),o(i)):n(i,a)}}var xa=wa(!0),ba=wa(!1),ja=Nr(null),ka=null,za=null,_a=null;function Sa(){_a=za=ka=null}function Ea(e){var t=ja.current;zr(ja),e._currentValue=t}function Ca(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Ta(e,t){ka=e,_a=za=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xo=!0),e.firstContext=null)}function Pa(e){var t=e._currentValue;if(_a!==e)if(e={context:e,memoizedValue:t,next:null},null===za){if(null===ka)throw Error(a(308));za=e,ka.dependencies={lanes:0,firstContext:e}}else za=za.next=e;return t}var Ia=null;function Aa(e){null===Ia?Ia=[e]:Ia.push(e)}function Ma(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,Aa(t)):(n.next=r.next,r.next=n),t.interleaved=n,Da(e,i)}function Da(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ra=!1;function Oa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function La(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ua(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Cl)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Da(e,n)}return null===(r=i.interleaved)?(t.next=t,Aa(i)):(t.next=r.next,r.next=t),i.interleaved=t,Da(e,n)}function Va(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Ba(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?r=a=s:a=a.next=s,n=n.next}while(null!==n);null===a?r=a=t:a=a.next=t}else r=a=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:a,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function $a(e,t,n,i){var r=e.updateQueue;Ra=!1;var a=r.firstBaseUpdate,s=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?a=c:s.next=c,s=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==s&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==a){var u=r.baseState;for(s=0,d=c=l=null,o=a;;){var h=o.lane,p=o.eventTime;if((i&h)===h){null!==d&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,f=o;switch(h=t,p=n,f.tag){case 1:if("function"===typeof(m=f.payload)){u=m.call(p,u,h);break e}u=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(h="function"===typeof(m=f.payload)?m.call(p,u,h):m)||void 0===h)break e;u=O({},u,h);break e;case 2:Ra=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=r.effects)?r.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=p,l=u):d=d.next=p,s|=h;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(h=o).next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}if(null===d&&(l=u),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=d,null!==(t=r.shared.interleaved)){r=t;do{s|=r.lane,r=r.next}while(r!==t)}else null===a&&(r.shared.lanes=0);Ol|=s,e.lanes=s,e.memoizedState=u}}function Wa(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(a(191,r));r.call(i)}}}var qa={},Ha=Nr(qa),Ka=Nr(qa),Ga=Nr(qa);function Qa(e){if(e===qa)throw Error(a(174));return e}function Za(e,t){switch(_r(Ga,t),_r(Ka,e),_r(Ha,qa),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}zr(Ha),_r(Ha,t)}function Ya(){zr(Ha),zr(Ka),zr(Ga)}function Ja(e){Qa(Ga.current);var t=Qa(Ha.current),n=le(t,e.type);t!==n&&(_r(Ka,e),_r(Ha,n))}function Xa(e){Ka.current===e&&(zr(Ha),zr(Ka))}var es=Nr(0);function ts(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ns=[];function is(){for(var e=0;e<ns.length;e++)ns[e]._workInProgressVersionPrimary=null;ns.length=0}var rs=x.ReactCurrentDispatcher,as=x.ReactCurrentBatchConfig,ss=0,os=null,ls=null,cs=null,ds=!1,us=!1,hs=0,ps=0;function ms(){throw Error(a(321))}function fs(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!oi(e[n],t[n]))return!1;return!0}function ys(e,t,n,i,r,s){if(ss=s,os=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,rs.current=null===e||null===e.memoizedState?Xs:eo,e=n(i,r),us){s=0;do{if(us=!1,hs=0,25<=s)throw Error(a(301));s+=1,cs=ls=null,t.updateQueue=null,rs.current=to,e=n(i,r)}while(us)}if(rs.current=Js,t=null!==ls&&null!==ls.next,ss=0,cs=ls=os=null,ds=!1,t)throw Error(a(300));return e}function gs(){var e=0!==hs;return hs=0,e}function vs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===cs?os.memoizedState=cs=e:cs=cs.next=e,cs}function ws(){if(null===ls){var e=os.alternate;e=null!==e?e.memoizedState:null}else e=ls.next;var t=null===cs?os.memoizedState:cs.next;if(null!==t)cs=t,ls=e;else{if(null===e)throw Error(a(310));e={memoizedState:(ls=e).memoizedState,baseState:ls.baseState,baseQueue:ls.baseQueue,queue:ls.queue,next:null},null===cs?os.memoizedState=cs=e:cs=cs.next=e}return cs}function xs(e,t){return"function"===typeof t?t(e):t}function bs(e){var t=ws(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var i=ls,r=i.baseQueue,s=n.pending;if(null!==s){if(null!==r){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,n.pending=null}if(null!==r){s=r.next,i=i.baseState;var l=o=null,c=null,d=s;do{var u=d.lane;if((ss&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),i=d.hasEagerState?d.eagerState:e(i,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,o=i):c=c.next=h,os.lanes|=u,Ol|=u}d=d.next}while(null!==d&&d!==s);null===c?o=i:c.next=l,oi(i,t.memoizedState)||(xo=!0),t.memoizedState=i,t.baseState=o,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{s=r.lane,os.lanes|=s,Ol|=s,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function js(e){var t=ws(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,s=t.memoizedState;if(null!==r){n.pending=null;var o=r=r.next;do{s=e(s,o.action),o=o.next}while(o!==r);oi(s,t.memoizedState)||(xo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,i]}function ks(){}function Ns(e,t){var n=os,i=ws(),r=t(),s=!oi(i.memoizedState,r);if(s&&(i.memoizedState=r,xo=!0),i=i.queue,Rs(Ss.bind(null,n,i,e),[e]),i.getSnapshot!==t||s||null!==cs&&1&cs.memoizedState.tag){if(n.flags|=2048,Ps(9,_s.bind(null,n,i,r,t),void 0,null),null===Tl)throw Error(a(349));0!==(30&ss)||zs(n,t,r)}return r}function zs(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=os.updateQueue)?(t={lastEffect:null,stores:null},os.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function _s(e,t,n,i){t.value=n,t.getSnapshot=i,Es(t)&&Cs(e)}function Ss(e,t,n){return n((function(){Es(t)&&Cs(e)}))}function Es(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!oi(e,n)}catch(i){return!0}}function Cs(e){var t=Da(e,1);null!==t&&ic(t,e,1,-1)}function Ts(e){var t=vs();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:e},t.queue=e,e=e.dispatch=Gs.bind(null,os,e),[t.memoizedState,e]}function Ps(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=os.updateQueue)?(t={lastEffect:null,stores:null},os.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Is(){return ws().memoizedState}function As(e,t,n,i){var r=vs();os.flags|=e,r.memoizedState=Ps(1|t,n,void 0,void 0===i?null:i)}function Ms(e,t,n,i){var r=ws();i=void 0===i?null:i;var a=void 0;if(null!==ls){var s=ls.memoizedState;if(a=s.destroy,null!==i&&fs(i,s.deps))return void(r.memoizedState=Ps(t,n,a,i))}os.flags|=e,r.memoizedState=Ps(1|t,n,a,i)}function Ds(e,t){return As(8390656,8,e,t)}function Rs(e,t){return Ms(2048,8,e,t)}function Os(e,t){return Ms(4,2,e,t)}function Ls(e,t){return Ms(4,4,e,t)}function Fs(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Us(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ms(4,4,Fs.bind(null,t,e),n)}function Vs(){}function Bs(e,t){var n=ws();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&fs(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function $s(e,t){var n=ws();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&fs(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Ws(e,t,n){return 0===(21&ss)?(e.baseState&&(e.baseState=!1,xo=!0),e.memoizedState=n):(oi(n,t)||(n=ft(),os.lanes|=n,Ol|=n,e.baseState=!0),t)}function qs(e,t){var n=wt;wt=0!==n&&4>n?n:4,e(!0);var i=as.transition;as.transition={};try{e(!1),t()}finally{wt=n,as.transition=i}}function Hs(){return ws().memoizedState}function Ks(e,t,n){var i=nc(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Qs(e))Zs(t,n);else if(null!==(n=Ma(e,t,n,i))){ic(n,e,i,tc()),Ys(n,t,i)}}function Gs(e,t,n){var i=nc(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qs(e))Zs(t,r);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=a(s,n);if(r.hasEagerState=!0,r.eagerState=o,oi(o,s)){var l=t.interleaved;return null===l?(r.next=r,Aa(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(c){}null!==(n=Ma(e,t,r,i))&&(ic(n,e,i,r=tc()),Ys(n,t,i))}}function Qs(e){var t=e.alternate;return e===os||null!==t&&t===os}function Zs(e,t){us=ds=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ys(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Js={readContext:Pa,useCallback:ms,useContext:ms,useEffect:ms,useImperativeHandle:ms,useInsertionEffect:ms,useLayoutEffect:ms,useMemo:ms,useReducer:ms,useRef:ms,useState:ms,useDebugValue:ms,useDeferredValue:ms,useTransition:ms,useMutableSource:ms,useSyncExternalStore:ms,useId:ms,unstable_isNewReconciler:!1},Xs={readContext:Pa,useCallback:function(e,t){return vs().memoizedState=[e,void 0===t?null:t],e},useContext:Pa,useEffect:Ds,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,As(4194308,4,Fs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return As(4194308,4,e,t)},useInsertionEffect:function(e,t){return As(4,2,e,t)},useMemo:function(e,t){var n=vs();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=vs();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=Ks.bind(null,os,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},vs().memoizedState=e},useState:Ts,useDebugValue:Vs,useDeferredValue:function(e){return vs().memoizedState=e},useTransition:function(){var e=Ts(!1),t=e[0];return e=qs.bind(null,e[1]),vs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=os,r=vs();if(ra){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Tl)throw Error(a(349));0!==(30&ss)||zs(i,t,n)}r.memoizedState=n;var s={value:n,getSnapshot:t};return r.queue=s,Ds(Ss.bind(null,i,s,e),[e]),i.flags|=2048,Ps(9,_s.bind(null,i,s,n,t),void 0,null),n},useId:function(){var e=vs(),t=Tl.identifierPrefix;if(ra){var n=Yr;t=":"+t+"R"+(n=(Zr&~(1<<32-st(Zr)-1)).toString(32)+n),0<(n=hs++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ps++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},eo={readContext:Pa,useCallback:Bs,useContext:Pa,useEffect:Rs,useImperativeHandle:Us,useInsertionEffect:Os,useLayoutEffect:Ls,useMemo:$s,useReducer:bs,useRef:Is,useState:function(){return bs(xs)},useDebugValue:Vs,useDeferredValue:function(e){return Ws(ws(),ls.memoizedState,e)},useTransition:function(){return[bs(xs)[0],ws().memoizedState]},useMutableSource:ks,useSyncExternalStore:Ns,useId:Hs,unstable_isNewReconciler:!1},to={readContext:Pa,useCallback:Bs,useContext:Pa,useEffect:Rs,useImperativeHandle:Us,useInsertionEffect:Os,useLayoutEffect:Ls,useMemo:$s,useReducer:js,useRef:Is,useState:function(){return js(xs)},useDebugValue:Vs,useDeferredValue:function(e){var t=ws();return null===ls?t.memoizedState=e:Ws(t,ls.memoizedState,e)},useTransition:function(){return[js(xs)[0],ws().memoizedState]},useMutableSource:ks,useSyncExternalStore:Ns,useId:Hs,unstable_isNewReconciler:!1};function no(e,t){if(e&&e.defaultProps){for(var n in t=O({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function io(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:O({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ro={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=tc(),r=nc(e),a=Fa(i,r);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Ua(e,a,r))&&(ic(t,e,r,i),Va(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=tc(),r=nc(e),a=Fa(i,r);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Ua(e,a,r))&&(ic(t,e,r,i),Va(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),i=nc(e),r=Fa(n,i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Ua(e,r,i))&&(ic(t,e,i,n),Va(t,e,i))}};function ao(e,t,n,i,r,a,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,a,s):!t.prototype||!t.prototype.isPureReactComponent||(!li(n,i)||!li(r,a))}function so(e,t,n){var i=!1,r=Sr,a=t.contextType;return"object"===typeof a&&null!==a?a=Pa(a):(r=Ir(t)?Tr:Er.current,a=(i=null!==(i=t.contextTypes)&&void 0!==i)?Pr(e,r):Sr),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ro,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=a),t}function oo(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&ro.enqueueReplaceState(t,t.state,null)}function lo(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},Oa(e);var a=t.contextType;"object"===typeof a&&null!==a?r.context=Pa(a):(a=Ir(t)?Tr:Er.current,r.context=Pr(e,a)),r.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(io(e,t,a,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&ro.enqueueReplaceState(r,r.state,null),$a(e,n,r,i),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function co(e,t){try{var n="",i=t;do{n+=V(i),i=i.return}while(i);var r=n}catch(a){r="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:r,digest:null}}function uo(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ho(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var po="function"===typeof WeakMap?WeakMap:Map;function mo(e,t,n){(n=Fa(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){ql||(ql=!0,Hl=i),ho(0,t)},n}function fo(e,t,n){(n=Fa(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){ho(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){ho(0,t),"function"!==typeof i&&(null===Kl?Kl=new Set([this]):Kl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function yo(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new po;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=_c.bind(null,e,t,n),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vo(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fa(-1,1)).tag=2,Ua(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var wo=x.ReactCurrentOwner,xo=!1;function bo(e,t,n,i){t.child=null===e?ba(t,null,n,i):xa(t,e.child,n,i)}function jo(e,t,n,i,r){n=n.render;var a=t.ref;return Ta(t,r),i=ys(e,t,n,i,a,r),n=gs(),null===e||xo?(ra&&n&&ea(t),t.flags|=1,bo(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,qo(e,t,r))}function ko(e,t,n,i,r){if(null===e){var a=n.type;return"function"!==typeof a||Ac(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Dc(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,No(e,t,a,i,r))}if(a=e.child,0===(e.lanes&r)){var s=a.memoizedProps;if((n=null!==(n=n.compare)?n:li)(s,i)&&e.ref===t.ref)return qo(e,t,r)}return t.flags|=1,(e=Mc(a,i)).ref=t.ref,e.return=t,t.child=e}function No(e,t,n,i,r){if(null!==e){var a=e.memoizedProps;if(li(a,i)&&e.ref===t.ref){if(xo=!1,t.pendingProps=i=a,0===(e.lanes&r))return t.lanes=e.lanes,qo(e,t,r);0!==(131072&e.flags)&&(xo=!0)}}return So(e,t,n,i,r)}function zo(e,t,n){var i=t.pendingProps,r=i.children,a=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},_r(Ml,Al),Al|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,_r(Ml,Al),Al|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==a?a.baseLanes:n,_r(Ml,Al),Al|=i}else null!==a?(i=a.baseLanes|n,t.memoizedState=null):i=n,_r(Ml,Al),Al|=i;return bo(e,t,r,n),t.child}function _o(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function So(e,t,n,i,r){var a=Ir(n)?Tr:Er.current;return a=Pr(t,a),Ta(t,r),n=ys(e,t,n,i,a,r),i=gs(),null===e||xo?(ra&&i&&ea(t),t.flags|=1,bo(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,qo(e,t,r))}function Eo(e,t,n,i,r){if(Ir(n)){var a=!0;Rr(t)}else a=!1;if(Ta(t,r),null===t.stateNode)Wo(e,t),so(t,n,i),lo(t,n,i,r),i=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=n.contextType;"object"===typeof c&&null!==c?c=Pa(c):c=Pr(t,c=Ir(n)?Tr:Er.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof s.getSnapshotBeforeUpdate;u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==i||l!==c)&&oo(t,s,i,c),Ra=!1;var h=t.memoizedState;s.state=h,$a(t,i,s,r),l=t.memoizedState,o!==i||h!==l||Cr.current||Ra?("function"===typeof d&&(io(t,n,d,i),l=t.memoizedState),(o=Ra||ao(t,n,o,i,h,l,c))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),s.props=i,s.state=l,s.context=c,i=o):("function"===typeof s.componentDidMount&&(t.flags|=4194308),i=!1)}else{s=t.stateNode,La(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:no(t.type,o),s.props=c,u=t.pendingProps,h=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=Pa(l):l=Pr(t,l=Ir(n)?Tr:Er.current);var p=n.getDerivedStateFromProps;(d="function"===typeof p||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==u||h!==l)&&oo(t,s,i,l),Ra=!1,h=t.memoizedState,s.state=h,$a(t,i,s,r);var m=t.memoizedState;o!==u||h!==m||Cr.current||Ra?("function"===typeof p&&(io(t,n,p,i),m=t.memoizedState),(c=Ra||ao(t,n,c,i,h,m,l)||!1)?(d||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(i,m,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(i,m,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=m),s.props=i,s.state=m,s.context=l,i=c):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return Co(e,t,n,i,a,r)}function Co(e,t,n,i,r,a){_o(e,t);var s=0!==(128&t.flags);if(!i&&!s)return r&&Or(t,n,!1),qo(e,t,a);i=t.stateNode,wo.current=t;var o=s&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&s?(t.child=xa(t,e.child,null,a),t.child=xa(t,null,o,a)):bo(e,t,o,a),t.memoizedState=i.state,r&&Or(t,n,!0),t.child}function To(e){var t=e.stateNode;t.pendingContext?Mr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Mr(0,t.context,!1),Za(e,t.containerInfo)}function Po(e,t,n,i,r){return pa(),ma(r),t.flags|=256,bo(e,t,n,i),t.child}var Io,Ao,Mo,Do,Ro={dehydrated:null,treeContext:null,retryLane:0};function Oo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Lo(e,t,n){var i,r=t.pendingProps,s=es.current,o=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&s)),i?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),_r(es,1&s),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,o?(r=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Oc(l,r,0,null),e=Rc(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Oo(n),t.memoizedState=Ro,e):Fo(t,l));if(null!==(s=e.memoizedState)&&null!==(i=s.dehydrated))return function(e,t,n,i,r,s,o){if(n)return 256&t.flags?(t.flags&=-257,Uo(e,t,o,i=uo(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=i.fallback,r=t.mode,i=Oc({mode:"visible",children:i.children},r,0,null),(s=Rc(s,r,o,null)).flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,0!==(1&t.mode)&&xa(t,e.child,null,o),t.child.memoizedState=Oo(o),t.memoizedState=Ro,s);if(0===(1&t.mode))return Uo(e,t,o,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,Uo(e,t,o,i=uo(s=Error(a(419)),i,void 0))}if(l=0!==(o&e.childLanes),xo||l){if(null!==(i=Tl)){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|o))?0:r)&&r!==s.retryLane&&(s.retryLane=r,Da(e,r),ic(i,e,r,-1))}return yc(),Uo(e,t,o,i=uo(Error(a(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Ec.bind(null,e),r._reactRetry=t,null):(e=s.treeContext,ia=cr(r.nextSibling),na=t,ra=!0,aa=null,null!==e&&(Kr[Gr++]=Zr,Kr[Gr++]=Yr,Kr[Gr++]=Qr,Zr=e.id,Yr=e.overflow,Qr=t),t=Fo(t,i.children),t.flags|=4096,t)}(e,t,l,r,i,s,n);if(o){o=r.fallback,l=t.mode,i=(s=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==s?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Mc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==i?o=Mc(i,o):(o=Rc(o,l,n,null)).flags|=2,o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,l=null===(l=e.child.memoizedState)?Oo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Ro,r}return e=(o=e.child).sibling,r=Mc(o,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Fo(e,t){return(t=Oc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Uo(e,t,n,i){return null!==i&&ma(i),xa(t,e.child,null,n),(e=Fo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Vo(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Ca(e.return,t,n)}function Bo(e,t,n,i,r){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=n,a.tailMode=r)}function $o(e,t,n){var i=t.pendingProps,r=i.revealOrder,a=i.tail;if(bo(e,t,i.children,n),0!==(2&(i=es.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Vo(e,n,t);else if(19===e.tag)Vo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(_r(es,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===ts(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Bo(t,!1,r,n,a);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===ts(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Bo(t,!0,n,null,a);break;case"together":Bo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ol|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Mc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Mc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ho(e,t){if(!ra)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Ko(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Go(e,t,n){var i=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ko(t),null;case 1:case 17:return Ir(t.type)&&Ar(),Ko(t),null;case 3:return i=t.stateNode,Ya(),zr(Cr),zr(Er),is(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(ua(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(oc(aa),aa=null))),Ao(e,t),Ko(t),null;case 5:Xa(t);var r=Qa(Ga.current);if(n=t.type,null!==e&&null!=t.stateNode)Mo(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(a(166));return Ko(t),null}if(e=Qa(Ha.current),ua(t)){i=t.stateNode,n=t.type;var s=t.memoizedProps;switch(i[hr]=t,i[pr]=s,e=0!==(1&t.mode),n){case"dialog":Fi("cancel",i),Fi("close",i);break;case"iframe":case"object":case"embed":Fi("load",i);break;case"video":case"audio":for(r=0;r<Di.length;r++)Fi(Di[r],i);break;case"source":Fi("error",i);break;case"img":case"image":case"link":Fi("error",i),Fi("load",i);break;case"details":Fi("toggle",i);break;case"input":Z(i,s),Fi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Fi("invalid",i);break;case"textarea":re(i,s),Fi("invalid",i)}for(var l in ve(n,s),r=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==s.suppressHydrationWarning&&Ji(i.textContent,c,e),r=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&Ji(i.textContent,c,e),r=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Fi("scroll",i)}switch(n){case"input":H(i),X(i,s,!0);break;case"textarea":H(i),se(i);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(i.onclick=Xi)}i=r,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[hr]=t,e[pr]=i,Io(e,t,!1,!1),t.stateNode=e;e:{switch(l=we(n,i),n){case"dialog":Fi("cancel",e),Fi("close",e),r=i;break;case"iframe":case"object":case"embed":Fi("load",e),r=i;break;case"video":case"audio":for(r=0;r<Di.length;r++)Fi(Di[r],e);r=i;break;case"source":Fi("error",e),r=i;break;case"img":case"image":case"link":Fi("error",e),Fi("load",e),r=i;break;case"details":Fi("toggle",e),r=i;break;case"input":Z(e,i),r=Q(e,i),Fi("invalid",e);break;case"option":default:r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=O({},i,{value:void 0}),Fi("invalid",e);break;case"textarea":re(e,i),r=ie(e,i),Fi("invalid",e)}for(s in ve(n,r),c=r)if(c.hasOwnProperty(s)){var d=c[s];"style"===s?ye(e,d):"dangerouslySetInnerHTML"===s?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===s?"string"===typeof d?("textarea"!==n||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=d&&"onScroll"===s&&Fi("scroll",e):null!=d&&w(e,s,d,l))}switch(n){case"input":H(e),X(e,i,!1);break;case"textarea":H(e),se(e);break;case"option":null!=i.value&&e.setAttribute("value",""+W(i.value));break;case"select":e.multiple=!!i.multiple,null!=(s=i.value)?ne(e,!!i.multiple,s,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Xi)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ko(t),null;case 6:if(e&&null!=t.stateNode)Do(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(a(166));if(n=Qa(Ga.current),Qa(Ha.current),ua(t)){if(i=t.stateNode,n=t.memoizedProps,i[hr]=t,(s=i.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:Ji(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Ji(i.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[hr]=t,t.stateNode=i}return Ko(t),null;case 13:if(zr(es),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ra&&null!==ia&&0!==(1&t.mode)&&0===(128&t.flags))ha(),pa(),t.flags|=98560,s=!1;else if(s=ua(t),null!==i&&null!==i.dehydrated){if(null===e){if(!s)throw Error(a(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(a(317));s[hr]=t}else pa(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ko(t),s=!1}else null!==aa&&(oc(aa),aa=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&es.current)?0===Dl&&(Dl=3):yc())),null!==t.updateQueue&&(t.flags|=4),Ko(t),null);case 4:return Ya(),Ao(e,t),null===e&&Bi(t.stateNode.containerInfo),Ko(t),null;case 10:return Ea(t.type._context),Ko(t),null;case 19:if(zr(es),null===(s=t.memoizedState))return Ko(t),null;if(i=0!==(128&t.flags),null===(l=s.rendering))if(i)Ho(s,!1);else{if(0!==Dl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ts(e))){for(t.flags|=128,Ho(s,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return _r(es,1&es.current|2),t.child}e=e.sibling}null!==s.tail&&Ye()>$l&&(t.flags|=128,i=!0,Ho(s,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=ts(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ho(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ra)return Ko(t),null}else 2*Ye()-s.renderingStartTime>$l&&1073741824!==n&&(t.flags|=128,i=!0,Ho(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=s.last)?n.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ye(),t.sibling=null,n=es.current,_r(es,i?1&n|2:1&n),t):(Ko(t),null);case 22:case 23:return hc(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Al)&&(Ko(t),6&t.subtreeFlags&&(t.flags|=8192)):Ko(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Qo(e,t){switch(ta(t),t.tag){case 1:return Ir(t.type)&&Ar(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ya(),zr(Cr),zr(Er),is(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xa(t),null;case 13:if(zr(es),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));pa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return zr(es),null;case 4:return Ya(),null;case 10:return Ea(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Io=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ao=function(){},Mo=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,Qa(Ha.current);var a,s=null;switch(n){case"input":r=Q(e,r),i=Q(e,i),s=[];break;case"select":r=O({},r,{value:void 0}),i=O({},i,{value:void 0}),s=[];break;case"textarea":r=ie(e,r),i=ie(e,i),s=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(e.onclick=Xi)}for(d in ve(n,i),n=null,r)if(!i.hasOwnProperty(d)&&r.hasOwnProperty(d)&&null!=r[d])if("style"===d){var l=r[d];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(o.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in i){var c=i[d];if(l=null!=r?r[d]:void 0,i.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(s||(s=[]),s.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(o.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Fi("scroll",e),s||l===c||(s=[])):(s=s||[]).push(d,c))}n&&(s=s||[]).push("style",n);var d=s;(t.updateQueue=d)&&(t.flags|=4)}},Do=function(e,t,n,i){n!==i&&(t.flags|=4)};var Zo=!1,Yo=!1,Jo="function"===typeof WeakSet?WeakSet:Set,Xo=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){zc(e,t,i)}else n.current=null}function tl(e,t,n){try{n()}catch(i){zc(e,t,i)}}var nl=!1;function il(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var a=r.destroy;r.destroy=void 0,void 0!==a&&tl(t,n,a)}r=r.next}while(r!==i)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hr],delete t[pr],delete t[fr],delete t[yr],delete t[gr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Xi));else if(4!==i&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function dl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(dl(e,t,n),e=e.sibling;null!==e;)dl(e,t,n),e=e.sibling}var ul=null,hl=!1;function pl(e,t,n){for(n=n.child;null!==n;)ml(e,t,n),n=n.sibling}function ml(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(rt,n)}catch(o){}switch(n.tag){case 5:Yo||el(n,t);case 6:var i=ul,r=hl;ul=null,pl(e,t,n),hl=r,null!==(ul=i)&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?lr(e.parentNode,n):1===e.nodeType&&lr(e,n),Bt(e)):lr(ul,n.stateNode));break;case 4:i=ul,r=hl,ul=n.stateNode.containerInfo,hl=!0,pl(e,t,n),ul=i,hl=r;break;case 0:case 11:case 14:case 15:if(!Yo&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var a=r,s=a.destroy;a=a.tag,void 0!==s&&(0!==(2&a)||0!==(4&a))&&tl(n,t,s),r=r.next}while(r!==i)}pl(e,t,n);break;case 1:if(!Yo&&(el(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(o){zc(n,t,o)}pl(e,t,n);break;case 21:pl(e,t,n);break;case 22:1&n.mode?(Yo=(i=Yo)||null!==n.memoizedState,pl(e,t,n),Yo=i):pl(e,t,n);break;default:pl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Jo),t.forEach((function(t){var i=Cc.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function yl(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(a(160));ml(s,o,r),ul=null,hl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(d){zc(r,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(yl(t,e),vl(e),4&i){try{il(3,e,e.return),rl(3,e)}catch(y){zc(e,e.return,y)}try{il(5,e,e.return)}catch(y){zc(e,e.return,y)}}break;case 1:yl(t,e),vl(e),512&i&&null!==n&&el(n,n.return);break;case 5:if(yl(t,e),vl(e),512&i&&null!==n&&el(n,n.return),32&e.flags){var r=e.stateNode;try{he(r,"")}catch(y){zc(e,e.return,y)}}if(4&i&&null!=(r=e.stateNode)){var s=e.memoizedProps,o=null!==n?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&Y(r,s),we(l,o);var d=we(l,s);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];"style"===u?ye(r,h):"dangerouslySetInnerHTML"===u?ue(r,h):"children"===u?he(r,h):w(r,u,h,d)}switch(l){case"input":J(r,s);break;case"textarea":ae(r,s);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var m=s.value;null!=m?ne(r,!!s.multiple,m,!1):p!==!!s.multiple&&(null!=s.defaultValue?ne(r,!!s.multiple,s.defaultValue,!0):ne(r,!!s.multiple,s.multiple?[]:"",!1))}r[pr]=s}catch(y){zc(e,e.return,y)}}break;case 6:if(yl(t,e),vl(e),4&i){if(null===e.stateNode)throw Error(a(162));r=e.stateNode,s=e.memoizedProps;try{r.nodeValue=s}catch(y){zc(e,e.return,y)}}break;case 3:if(yl(t,e),vl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(y){zc(e,e.return,y)}break;case 4:default:yl(t,e),vl(e);break;case 13:yl(t,e),vl(e),8192&(r=e.child).flags&&(s=null!==r.memoizedState,r.stateNode.isHidden=s,!s||null!==r.alternate&&null!==r.alternate.memoizedState||(Bl=Ye())),4&i&&fl(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?(Yo=(d=Yo)||u,yl(t,e),Yo=d):yl(t,e),vl(e),8192&i){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Xo=e,u=e.child;null!==u;){for(h=Xo=u;null!==Xo;){switch(m=(p=Xo).child,p.tag){case 0:case 11:case 14:case 15:il(4,p,p.return);break;case 1:el(p,p.return);var f=p.stateNode;if("function"===typeof f.componentWillUnmount){i=p,n=p.return;try{t=i,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(y){zc(i,n,y)}}break;case 5:el(p,p.return);break;case 22:if(null!==p.memoizedState){jl(h);continue}}null!==m?(m.return=p,Xo=m):jl(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{r=h.stateNode,d?"function"===typeof(s=r.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=fe("display",o))}catch(y){zc(e,e.return,y)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(y){zc(e,e.return,y)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:yl(t,e),vl(e),4&i&&fl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var i=n;break e}n=n.return}throw Error(a(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(he(r,""),i.flags&=-33),dl(e,ll(e),r);break;case 3:case 4:var s=i.stateNode.containerInfo;cl(e,ll(e),s);break;default:throw Error(a(161))}}catch(o){zc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function wl(e,t,n){Xo=e,xl(e,t,n)}function xl(e,t,n){for(var i=0!==(1&e.mode);null!==Xo;){var r=Xo,a=r.child;if(22===r.tag&&i){var s=null!==r.memoizedState||Zo;if(!s){var o=r.alternate,l=null!==o&&null!==o.memoizedState||Yo;o=Zo;var c=Yo;if(Zo=s,(Yo=l)&&!c)for(Xo=r;null!==Xo;)l=(s=Xo).child,22===s.tag&&null!==s.memoizedState?kl(r):null!==l?(l.return=s,Xo=l):kl(r);for(;null!==a;)Xo=a,xl(a,t,n),a=a.sibling;Xo=r,Zo=o,Yo=c}bl(e)}else 0!==(8772&r.subtreeFlags)&&null!==a?(a.return=r,Xo=a):bl(e)}}function bl(e){for(;null!==Xo;){var t=Xo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Yo||rl(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Yo)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:no(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Wa(t,s,i);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Wa(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Bt(h)}}}break;default:throw Error(a(163))}Yo||512&t.flags&&al(t)}catch(p){zc(t,t.return,p)}}if(t===e){Xo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xo=n;break}Xo=t.return}}function jl(e){for(;null!==Xo;){var t=Xo;if(t===e){Xo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xo=n;break}Xo=t.return}}function kl(e){for(;null!==Xo;){var t=Xo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){zc(t,n,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(l){zc(t,r,l)}}var a=t.return;try{al(t)}catch(l){zc(t,a,l)}break;case 5:var s=t.return;try{al(t)}catch(l){zc(t,s,l)}}}catch(l){zc(t,t.return,l)}if(t===e){Xo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Xo=o;break}Xo=t.return}}var Nl,zl=Math.ceil,_l=x.ReactCurrentDispatcher,Sl=x.ReactCurrentOwner,El=x.ReactCurrentBatchConfig,Cl=0,Tl=null,Pl=null,Il=0,Al=0,Ml=Nr(0),Dl=0,Rl=null,Ol=0,Ll=0,Fl=0,Ul=null,Vl=null,Bl=0,$l=1/0,Wl=null,ql=!1,Hl=null,Kl=null,Gl=!1,Ql=null,Zl=0,Yl=0,Jl=null,Xl=-1,ec=0;function tc(){return 0!==(6&Cl)?Ye():-1!==Xl?Xl:Xl=Ye()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Cl)&&0!==Il?Il&-Il:null!==fa.transition?(0===ec&&(ec=ft()),ec):0!==(e=wt)?e:e=void 0===(e=window.event)?16:Zt(e.type)}function ic(e,t,n,i){if(50<Yl)throw Yl=0,Jl=null,Error(a(185));gt(e,n,i),0!==(2&Cl)&&e===Tl||(e===Tl&&(0===(2&Cl)&&(Ll|=n),4===Dl&&lc(e,Il)),rc(e,i),1===n&&0===Cl&&0===(1&t.mode)&&($l=Ye()+500,Fr&&Br()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-st(a),o=1<<s,l=r[s];-1===l?0!==(o&n)&&0===(o&i)||(r[s]=pt(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}(e,t);var i=ht(e,e===Tl?Il:0);if(0===i)null!==n&&Ge(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Ge(n),1===t)0===e.tag?function(e){Fr=!0,Vr(e)}(cc.bind(null,e)):Vr(cc.bind(null,e)),sr((function(){0===(6&Cl)&&Br()})),n=null;else{switch(xt(i)){case 1:n=Xe;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=Tc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Xl=-1,ec=0,0!==(6&Cl))throw Error(a(327));var n=e.callbackNode;if(kc()&&e.callbackNode!==n)return null;var i=ht(e,e===Tl?Il:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=gc(e,i);else{t=i;var r=Cl;Cl|=2;var s=fc();for(Tl===e&&Il===t||(Wl=null,$l=Ye()+500,pc(e,t));;)try{wc();break}catch(l){mc(e,l)}Sa(),_l.current=s,Cl=r,null!==Pl?t=0:(Tl=null,Il=0,t=Dl)}if(0!==t){if(2===t&&(0!==(r=mt(e))&&(i=r,t=sc(e,r))),1===t)throw n=Rl,pc(e,0),lc(e,i),rc(e,Ye()),n;if(6===t)lc(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],a=r.getSnapshot;r=r.value;try{if(!oi(a(),r))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=gc(e,i))&&(0!==(s=mt(e))&&(i=s,t=sc(e,s))),1===t))throw n=Rl,pc(e,0),lc(e,i),rc(e,Ye()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(a(345));case 2:case 5:jc(e,Vl,Wl);break;case 3:if(lc(e,i),(130023424&i)===i&&10<(t=Bl+500-Ye())){if(0!==ht(e,0))break;if(((r=e.suspendedLanes)&i)!==i){tc(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=ir(jc.bind(null,e,Vl,Wl),t);break}jc(e,Vl,Wl);break;case 4:if(lc(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var o=31-st(i);s=1<<o,(o=t[o])>r&&(r=o),i&=~s}if(i=r,10<(i=(120>(i=Ye()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*zl(i/1960))-i)){e.timeoutHandle=ir(jc.bind(null,e,Vl,Wl),i);break}jc(e,Vl,Wl);break;default:throw Error(a(329))}}}return rc(e,Ye()),e.callbackNode===n?ac.bind(null,e):null}function sc(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Vl,Vl=n,null!==t&&oc(t)),e}function oc(e){null===Vl?Vl=e:Vl.push.apply(Vl,e)}function lc(e,t){for(t&=~Fl,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),i=1<<n;e[n]=-1,t&=~i}}function cc(e){if(0!==(6&Cl))throw Error(a(327));kc();var t=ht(e,0);if(0===(1&t))return rc(e,Ye()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var i=mt(e);0!==i&&(t=i,n=sc(e,i))}if(1===n)throw n=Rl,pc(e,0),lc(e,t),rc(e,Ye()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,jc(e,Vl,Wl),rc(e,Ye()),null}function dc(e,t){var n=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=n)&&($l=Ye()+500,Fr&&Br())}}function uc(e){null!==Ql&&0===Ql.tag&&0===(6&Cl)&&kc();var t=Cl;Cl|=1;var n=El.transition,i=wt;try{if(El.transition=null,wt=1,e)return e()}finally{wt=i,El.transition=n,0===(6&(Cl=t))&&Br()}}function hc(){Al=Ml.current,zr(Ml)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rr(n)),null!==Pl)for(n=Pl.return;null!==n;){var i=n;switch(ta(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Ar();break;case 3:Ya(),zr(Cr),zr(Er),is();break;case 5:Xa(i);break;case 4:Ya();break;case 13:case 19:zr(es);break;case 10:Ea(i.type._context);break;case 22:case 23:hc()}n=n.return}if(Tl=e,Pl=e=Mc(e.current,null),Il=Al=t,Dl=0,Rl=null,Fl=Ll=Ol=0,Vl=Ul=null,null!==Ia){for(t=0;t<Ia.length;t++)if(null!==(i=(n=Ia[t]).interleaved)){n.interleaved=null;var r=i.next,a=n.pending;if(null!==a){var s=a.next;a.next=r,i.next=s}n.pending=i}Ia=null}return e}function mc(e,t){for(;;){var n=Pl;try{if(Sa(),rs.current=Js,ds){for(var i=os.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}ds=!1}if(ss=0,cs=ls=os=null,us=!1,hs=0,Sl.current=null,null===n||null===n.return){Dl=1,Rl=t,Pl=null;break}e:{var s=e,o=n.return,l=n,c=t;if(t=Il,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=go(o);if(null!==m){m.flags&=-257,vo(m,o,l,0,t),1&m.mode&&yo(s,d,t),c=d;var f=(t=m).updateQueue;if(null===f){var y=new Set;y.add(c),t.updateQueue=y}else f.add(c);break e}if(0===(1&t)){yo(s,d,t),yc();break e}c=Error(a(426))}else if(ra&&1&l.mode){var g=go(o);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),vo(g,o,l,0,t),ma(co(c,l));break e}}s=c=co(c,l),4!==Dl&&(Dl=2),null===Ul?Ul=[s]:Ul.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Ba(s,mo(0,c,t));break e;case 1:l=c;var v=s.type,w=s.stateNode;if(0===(128&s.flags)&&("function"===typeof v.getDerivedStateFromError||null!==w&&"function"===typeof w.componentDidCatch&&(null===Kl||!Kl.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t,Ba(s,fo(s,l,t));break e}}s=s.return}while(null!==s)}bc(n)}catch(x){t=x,Pl===n&&null!==n&&(Pl=n=n.return);continue}break}}function fc(){var e=_l.current;return _l.current=Js,null===e?Js:e}function yc(){0!==Dl&&3!==Dl&&2!==Dl||(Dl=4),null===Tl||0===(268435455&Ol)&&0===(268435455&Ll)||lc(Tl,Il)}function gc(e,t){var n=Cl;Cl|=2;var i=fc();for(Tl===e&&Il===t||(Wl=null,pc(e,t));;)try{vc();break}catch(r){mc(e,r)}if(Sa(),Cl=n,_l.current=i,null!==Pl)throw Error(a(261));return Tl=null,Il=0,Dl}function vc(){for(;null!==Pl;)xc(Pl)}function wc(){for(;null!==Pl&&!Qe();)xc(Pl)}function xc(e){var t=Nl(e.alternate,e,Al);e.memoizedProps=e.pendingProps,null===t?bc(e):Pl=t,Sl.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Go(n,t,Al)))return void(Pl=n)}else{if(null!==(n=Qo(n,t)))return n.flags&=32767,void(Pl=n);if(null===e)return Dl=6,void(Pl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Pl=t);Pl=t=e}while(null!==t);0===Dl&&(Dl=5)}function jc(e,t,n){var i=wt,r=El.transition;try{El.transition=null,wt=1,function(e,t,n,i){do{kc()}while(null!==Ql);if(0!==(6&Cl))throw Error(a(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-st(n),a=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~a}}(e,s),e===Tl&&(Pl=Tl=null,Il=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Gl||(Gl=!0,Tc(tt,(function(){return kc(),null}))),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=El.transition,El.transition=null;var o=wt;wt=1;var l=Cl;Cl|=4,Sl.current=null,function(e,t){if(er=Wt,pi(e=hi())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch(b){n=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=e,p=null;t:for(;;){for(var m;h!==n||0!==r&&3!==h.nodeType||(l=o+r),h!==s||0!==i&&3!==h.nodeType||(c=o+i),3===h.nodeType&&(o+=h.nodeValue.length),null!==(m=h.firstChild);)p=h,h=m;for(;;){if(h===e)break t;if(p===n&&++d===r&&(l=o),p===s&&++u===i&&(c=o),null!==(m=h.nextSibling))break;p=(h=p).parentNode}h=m}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(tr={focusedElem:e,selectionRange:n},Wt=!1,Xo=t;null!==Xo;)if(e=(t=Xo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xo=e;else for(;null!==Xo;){t=Xo;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var y=f.memoizedProps,g=f.memoizedState,v=t.stateNode,w=v.getSnapshotBeforeUpdate(t.elementType===t.type?y:no(t.type,y),g);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(a(163))}}catch(b){zc(t,t.return,b)}if(null!==(e=t.sibling)){e.return=t.return,Xo=e;break}Xo=t.return}f=nl,nl=!1}(e,n),gl(n,e),mi(tr),Wt=!!er,tr=er=null,e.current=n,wl(n,e,r),Ze(),Cl=l,wt=o,El.transition=s}else e.current=n;if(Gl&&(Gl=!1,Ql=e,Zl=r),s=e.pendingLanes,0===s&&(Kl=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Ye()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(ql)throw ql=!1,e=Hl,Hl=null,e;0!==(1&Zl)&&0!==e.tag&&kc(),s=e.pendingLanes,0!==(1&s)?e===Jl?Yl++:(Yl=0,Jl=e):Yl=0,Br()}(e,t,n,i)}finally{El.transition=r,wt=i}return null}function kc(){if(null!==Ql){var e=xt(Zl),t=El.transition,n=wt;try{if(El.transition=null,wt=16>e?16:e,null===Ql)var i=!1;else{if(e=Ql,Ql=null,Zl=0,0!==(6&Cl))throw Error(a(331));var r=Cl;for(Cl|=4,Xo=e.current;null!==Xo;){var s=Xo,o=s.child;if(0!==(16&Xo.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Xo=d;null!==Xo;){var u=Xo;switch(u.tag){case 0:case 11:case 15:il(8,u,s)}var h=u.child;if(null!==h)h.return=u,Xo=h;else for(;null!==Xo;){var p=(u=Xo).sibling,m=u.return;if(sl(u),u===d){Xo=null;break}if(null!==p){p.return=m,Xo=p;break}Xo=m}}}var f=s.alternate;if(null!==f){var y=f.child;if(null!==y){f.child=null;do{var g=y.sibling;y.sibling=null,y=g}while(null!==y)}}Xo=s}}if(0!==(2064&s.subtreeFlags)&&null!==o)o.return=s,Xo=o;else e:for(;null!==Xo;){if(0!==(2048&(s=Xo).flags))switch(s.tag){case 0:case 11:case 15:il(9,s,s.return)}var v=s.sibling;if(null!==v){v.return=s.return,Xo=v;break e}Xo=s.return}}var w=e.current;for(Xo=w;null!==Xo;){var x=(o=Xo).child;if(0!==(2064&o.subtreeFlags)&&null!==x)x.return=o,Xo=x;else e:for(o=w;null!==Xo;){if(0!==(2048&(l=Xo).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(j){zc(l,l.return,j)}if(l===o){Xo=null;break e}var b=l.sibling;if(null!==b){b.return=l.return,Xo=b;break e}Xo=l.return}}if(Cl=r,Br(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(rt,e)}catch(j){}i=!0}return i}finally{wt=n,El.transition=t}}return!1}function Nc(e,t,n){e=Ua(e,t=mo(0,t=co(n,t),1),1),t=tc(),null!==e&&(gt(e,1,t),rc(e,t))}function zc(e,t,n){if(3===e.tag)Nc(e,e,n);else for(;null!==t;){if(3===t.tag){Nc(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Kl||!Kl.has(i))){t=Ua(t,e=fo(t,e=co(n,e),1),1),e=tc(),null!==t&&(gt(t,1,e),rc(t,e));break}}t=t.return}}function _c(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Tl===e&&(Il&n)===n&&(4===Dl||3===Dl&&(130023424&Il)===Il&&500>Ye()-Bl?pc(e,0):Fl|=n),rc(e,t)}function Sc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var n=tc();null!==(e=Da(e,t))&&(gt(e,t,n),rc(e,n))}function Ec(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Sc(e,n)}function Cc(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(a(314))}null!==i&&i.delete(t),Sc(e,n)}function Tc(e,t){return Ke(e,t)}function Pc(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ic(e,t,n,i){return new Pc(e,t,n,i)}function Ac(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Mc(e,t){var n=e.alternate;return null===n?((n=Ic(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Dc(e,t,n,i,r,s){var o=2;if(i=e,"function"===typeof e)Ac(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case k:return Rc(n.children,r,s,t);case N:o=8,r|=8;break;case z:return(e=Ic(12,n,t,2|r)).elementType=z,e.lanes=s,e;case C:return(e=Ic(13,n,t,r)).elementType=C,e.lanes=s,e;case T:return(e=Ic(19,n,t,r)).elementType=T,e.lanes=s,e;case A:return Oc(n,r,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case _:o=10;break e;case S:o=9;break e;case E:o=11;break e;case P:o=14;break e;case I:o=16,i=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Ic(o,n,t,r)).elementType=e,t.type=i,t.lanes=s,t}function Rc(e,t,n,i){return(e=Ic(7,e,i,t)).lanes=n,e}function Oc(e,t,n,i){return(e=Ic(22,e,i,t)).elementType=A,e.lanes=n,e.stateNode={isHidden:!1},e}function Lc(e,t,n){return(e=Ic(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Ic(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yt(0),this.expirationTimes=yt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yt(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Vc(e,t,n,i,r,a,s,o,l){return e=new Uc(e,t,n,o,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Ic(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oa(a),e}function Bc(e){if(!e)return Sr;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ir(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Ir(n))return Dr(e,n,t)}return t}function $c(e,t,n,i,r,a,s,o,l){return(e=Vc(n,i,!0,e,0,a,0,o,l)).context=Bc(null),n=e.current,(a=Fa(i=tc(),r=nc(n))).callback=void 0!==t&&null!==t?t:null,Ua(n,a,r),e.current.lanes=r,gt(e,r,i),rc(e,i),e}function Wc(e,t,n,i){var r=t.current,a=tc(),s=nc(r);return n=Bc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fa(a,s)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Ua(r,t,s))&&(ic(e,r,s,a),Va(e,r,s)),s}function qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kc(e,t){Hc(e,t),(e=e.alternate)&&Hc(e,t)}Nl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Cr.current)xo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xo=!1,function(e,t,n){switch(t.tag){case 3:To(t),pa();break;case 5:Ja(t);break;case 1:Ir(t.type)&&Rr(t);break;case 4:Za(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;_r(ja,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(_r(es,1&es.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Lo(e,t,n):(_r(es,1&es.current),null!==(e=qo(e,t,n))?e.sibling:null);_r(es,1&es.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return $o(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),_r(es,es.current),i)break;return null;case 22:case 23:return t.lanes=0,zo(e,t,n)}return qo(e,t,n)}(e,t,n);xo=0!==(131072&e.flags)}else xo=!1,ra&&0!==(1048576&t.flags)&&Xr(t,Hr,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Wo(e,t),e=t.pendingProps;var r=Pr(t,Er.current);Ta(t,n),r=ys(null,t,i,e,r,n);var s=gs();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ir(i)?(s=!0,Rr(t)):s=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Oa(t),r.updater=ro,t.stateNode=r,r._reactInternals=t,lo(t,i,e,n),t=Co(null,t,i,!0,s,n)):(t.tag=0,ra&&s&&ea(t),bo(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Wo(e,t),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"===typeof e)return Ac(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===P)return 14}return 2}(i),e=no(i,e),r){case 0:t=So(null,t,i,e,n);break e;case 1:t=Eo(null,t,i,e,n);break e;case 11:t=jo(null,t,i,e,n);break e;case 14:t=ko(null,t,i,no(i.type,e),n);break e}throw Error(a(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,So(e,t,i,r=t.elementType===i?r:no(i,r),n);case 1:return i=t.type,r=t.pendingProps,Eo(e,t,i,r=t.elementType===i?r:no(i,r),n);case 3:e:{if(To(t),null===e)throw Error(a(387));i=t.pendingProps,r=(s=t.memoizedState).element,La(e,t),$a(t,i,null,n);var o=t.memoizedState;if(i=o.element,s.isDehydrated){if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Po(e,t,i,n,r=co(Error(a(423)),t));break e}if(i!==r){t=Po(e,t,i,n,r=co(Error(a(424)),t));break e}for(ia=cr(t.stateNode.containerInfo.firstChild),na=t,ra=!0,aa=null,n=ba(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pa(),i===r){t=qo(e,t,n);break e}bo(e,t,i,n)}t=t.child}return t;case 5:return Ja(t),null===e&&ca(t),i=t.type,r=t.pendingProps,s=null!==e?e.memoizedProps:null,o=r.children,nr(i,r)?o=null:null!==s&&nr(i,s)&&(t.flags|=32),_o(e,t),bo(e,t,o,n),t.child;case 6:return null===e&&ca(t),null;case 13:return Lo(e,t,n);case 4:return Za(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=xa(t,null,i,n):bo(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,jo(e,t,i,r=t.elementType===i?r:no(i,r),n);case 7:return bo(e,t,t.pendingProps,n),t.child;case 8:case 12:return bo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,s=t.memoizedProps,o=r.value,_r(ja,i._currentValue),i._currentValue=o,null!==s)if(oi(s.value,o)){if(s.children===r.children&&!Cr.current){t=qo(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){o=s.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===s.tag){(c=Fa(-1,n&-n)).tag=2;var d=s.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),Ca(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(a(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ca(o,n,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}bo(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Ta(t,n),i=i(r=Pa(r)),t.flags|=1,bo(e,t,i,n),t.child;case 14:return r=no(i=t.type,t.pendingProps),ko(e,t,i,r=no(i.type,r),n);case 15:return No(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:no(i,r),Wo(e,t),t.tag=1,Ir(i)?(e=!0,Rr(t)):e=!1,Ta(t,n),so(t,i,r),lo(t,i,r,n),Co(null,t,i,!0,e,n);case 19:return $o(e,t,n);case 22:return zo(e,t,n)}throw Error(a(156,t.tag))};var Gc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Zc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function ed(e,t,n,i,r){var a=n._reactRootContainer;if(a){var s=a;if("function"===typeof r){var o=r;r=function(){var e=qc(s);o.call(e)}}Wc(t,s,e,r)}else s=function(e,t,n,i,r){if(r){if("function"===typeof i){var a=i;i=function(){var e=qc(s);a.call(e)}}var s=$c(t,i,e,0,null,!1,0,"",Xc);return e._reactRootContainer=s,e[mr]=s.current,Bi(8===e.nodeType?e.parentNode:e),uc(),s}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof i){var o=i;i=function(){var e=qc(l);o.call(e)}}var l=Vc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=l,e[mr]=l.current,Bi(8===e.nodeType?e.parentNode:e),uc((function(){Wc(t,l,n,i)})),l}(n,t,e,r,i);return qc(s)}Zc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Wc(e,t,null,null)},Zc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){Wc(null,e,null,null)})),t[mr]=null}},Zc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Nt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<At.length&&0!==t&&t<At[n].priority;n++);At.splice(n,0,e),0===n&&Ot(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(vt(t,1|n),rc(t,Ye()),0===(6&Cl)&&($l=Ye()+500,Br()))}break;case 13:uc((function(){var t=Da(e,1);if(null!==t){var n=tc();ic(t,e,1,n)}})),Kc(e,1)}},jt=function(e){if(13===e.tag){var t=Da(e,134217728);if(null!==t)ic(t,e,134217728,tc());Kc(e,134217728)}},kt=function(e){if(13===e.tag){var t=nc(e),n=Da(e,t);if(null!==n)ic(n,e,t,tc());Kc(e,t)}},Nt=function(){return wt},zt=function(e,t){var n=wt;try{return wt=e,t()}finally{wt=n}},je=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=br(i);if(!r)throw Error(a(90));K(i),J(i,r)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=dc,Ce=uc;var td={usingClientEntryPoint:!1,Events:[wr,xr,br,_e,Se,dc]},nd={findFiberByHostInstance:vr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},id={bundleType:nd.bundleType,version:nd.version,rendererPackageName:nd.rendererPackageName,rendererConfig:nd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:nd.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rd.isDisabled&&rd.supportsFiber)try{rt=rd.inject(id),at=rd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=td,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(a(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:j,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yc(e))throw Error(a(299));var n=!1,i="",r=Gc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Vc(e,1,!1,null,0,n,0,i,r),e[mr]=t.current,Bi(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(a(200));return ed(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yc(e))throw Error(a(405));var i=null!=n&&n.hydratedSources||null,r=!1,s="",o=Gc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=$c(t,null,e,1,null!=n?n:null,r,0,s,o),e[mr]=t.current,Bi(e),i)for(e=0;e<i.length;e++)r=(r=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Zc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(a(200));return ed(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(a(40));return!!e._reactRootContainer&&(uc((function(){ed(null,null,e,!1,(function(){e._reactRootContainer=null,e[mr]=null}))})),!0)},t.unstable_batchedUpdates=dc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Jc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return ed(e,t,n,!1,i)},t.version="18.3.1-next-f1338f8080-20240426"},352:(e,t,n)=>{var i=n(119);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},414:(e,t,n)=>{e.exports=n(654)},654:(e,t,n)=>{var i=n(950),r=Symbol.for("react.element"),a=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,a={},c=null,d=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)s.call(t,i)&&!l.hasOwnProperty(i)&&(a[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===a[i]&&(a[i]=t[i]);return{$$typeof:r,type:e,key:c,ref:d,props:a,_owner:o.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},761:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<a(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,s=r>>>1;i<s;){var o=2*(i+1)-1,l=e[o],c=o+1,d=e[c];if(0>a(l,n))c<r&&0>a(d,l)?(e[i]=d,e[c]=n,i=c):(e[i]=l,e[o]=n,i=o);else{if(!(c<r&&0>a(d,n)))break e;e[i]=d,e[c]=n,i=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,p=3,m=!1,f=!1,y=!1,g="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=i(d);null!==t;){if(null===t.callback)r(d);else{if(!(t.startTime<=e))break;r(d),t.sortIndex=t.expirationTime,n(c,t)}t=i(d)}}function b(e){if(y=!1,x(e),!f)if(null!==i(c))f=!0,A(j);else{var t=i(d);null!==t&&M(b,t.startTime-e)}}function j(e,n){f=!1,y&&(y=!1,v(_),_=-1),m=!0;var a=p;try{for(x(n),h=i(c);null!==h&&(!(h.expirationTime>n)||e&&!C());){var s=h.callback;if("function"===typeof s){h.callback=null,p=h.priorityLevel;var o=s(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===i(c)&&r(c),x(n)}else r(c);h=i(c)}if(null!==h)var l=!0;else{var u=i(d);null!==u&&M(b,u.startTime-n),l=!1}return l}finally{h=null,p=a,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,N=!1,z=null,_=-1,S=5,E=-1;function C(){return!(t.unstable_now()-E<S)}function T(){if(null!==z){var e=t.unstable_now();E=e;var n=!0;try{n=z(!0,e)}finally{n?k():(N=!1,z=null)}}else N=!1}if("function"===typeof w)k=function(){w(T)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,I=P.port2;P.port1.onmessage=T,k=function(){I.postMessage(null)}}else k=function(){g(T,0)};function A(e){z=e,N||(N=!0,k())}function M(e,n){_=g((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||m||(f=!0,A(j))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,a){var s=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?s+a:s:a=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:r,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>s?(e.sortIndex=a,n(d,e),null===i(c)&&e===i(d)&&(y?(v(_),_=-1):y=!0,M(b,a-s))):(e.sortIndex=o,n(c,e),f||m||(f=!0,A(j))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},950:(e,t,n)=>{e.exports=n(49)}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,n),a.exports}n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}();var i=n(950),r=n(352),a=n(414);const s={name:"Tw\xf3j Developer",cash:1e8,reputation:100,reputationHistory:[],reputationFactors:{legalCompliance:1,environmentalImpact:1,communityRelations:1,projectQuality:1,transparency:1,grayAreaActivity:1},activeReputationInitiatives:[],projects:[],rtbPower:0,totalPower:0,installedCapacity:0,rtbCapacity:0,staff:{lessors:[],developers:[],lawyers:[],envSpecialists:[],lobbyists:[]},illegals:{hasIllegalDatabase:!1,corruptionNetwork:0,intimidationPower:0,forgeryExpertise:0,auditRisk:20,lastAuditTurn:0,totalBribes:0,illegalActionHistory:[]},economicMetrics:{totalInvestment:0,totalRevenue:0,totalExpenses:0,avgROI:0,projectsCost:0,projectsValue:0},audits:{totalAudits:0,passedAudits:0,totalFines:0,lastAuditResult:null},loans:[],companyUpgrades:{}},o=e=>{try{return e&&e instanceof Date&&!isNaN(e.getTime())?e.toISOString():(new Date).toISOString()}catch(t){return console.error("B\u0142\u0105d podczas tworzenia daty ISO:",t),(new Date).toISOString()}};function l(e,t){var n,i,r,a;switch(t.type){case"UPDATE_CASH":return{...e,cash:e.cash+t.payload};case"ADD_PROJECT":return{...e,projects:[...e.projects,t.payload],totalPower:e.totalPower+t.payload.power};case"UPDATE_PROJECT":return{...e,projects:e.projects.map((e=>e.id===t.payload.id?{...e,...t.payload.changes}:e))};case"SELL_PROJECT":return{...e,cash:e.cash+t.payload.price,projects:e.projects.filter((e=>e.id!==t.payload.projectId)),totalPower:e.totalPower-((null===(n=e.projects.find((e=>e.id===t.payload.projectId)))||void 0===n?void 0:n.power)||0),rtbPower:e.rtbPower-("ready_to_build"===(null===(i=e.projects.find((e=>e.id===t.payload.projectId)))||void 0===i?void 0:i.status)&&(null===(r=e.projects.find((e=>e.id===t.payload.projectId)))||void 0===r?void 0:r.power)||0),economicMetrics:{...e.economicMetrics,totalRevenue:e.economicMetrics.totalRevenue+t.payload.price,projectsValue:e.economicMetrics.projectsValue-((null===(a=e.projects.find((e=>e.id===t.payload.projectId)))||void 0===a?void 0:a.marketValue)||0)}};case"UPDATE_RTB_POWER":return{...e,rtbPower:e.rtbPower+t.payload};case"HIRE_STAFF":const s=t.payload.staffType.endsWith("s")?t.payload.staffType:`${t.payload.staffType}s`,l=e.staff[s]||[];return{...e,cash:e.cash-t.payload.cost,staff:{...e.staff,[s]:[...l,t.payload.staff]},economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+t.payload.cost}};case"FIRE_STAFF":const c=t.payload.staffType.endsWith("s")?t.payload.staffType:`${t.payload.staffType}s`;return{...e,cash:e.cash-t.payload.cost,staff:{...e.staff,[c]:(e.staff[c]||[]).filter((e=>e.id!==t.payload.staffId))},economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+t.payload.cost}};case"TRAIN_STAFF":const d=t.payload.staffType.endsWith("s")?t.payload.staffType:`${t.payload.staffType}s`;return{...e,cash:e.cash-t.payload.cost,staff:{...e.staff,[d]:(e.staff[d]||[]).map((e=>e.id===t.payload.staffId?{...e,skill:Math.min(10,e.skill+t.payload.skillGain),experience:e.experience+t.payload.experienceGain,training:[...e.training||[],{date:(new Date).toISOString(),type:t.payload.trainingType,cost:t.payload.cost,skillGain:t.payload.skillGain}]}:e))},economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+t.payload.cost}};case"UPDATE_STAFF":const u=t.payload.staffType.endsWith("s")?t.payload.staffType:`${t.payload.staffType}s`;return{...e,staff:{...e.staff,[u]:(e.staff[u]||[]).map((e=>e.id===t.payload.staffId?{...e,...t.payload.changes}:e))}};case"ASSIGN_STAFF_TO_PROJECT":return{...e,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,assignedStaff:{...e.assignedStaff||{},[t.payload.staffType]:t.payload.staffId}}:e)),staff:{...e.staff,[t.payload.staffType+"s"]:(e.staff[t.payload.staffType+"s"]||[]).map((e=>e.id===t.payload.staffId?{...e,assignedProject:t.payload.projectId,assignedSince:(new Date).toISOString()}:e))}};case"ADD_PROJECT_EVENT":return{...e,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,events:[...e.events,t.payload.event]}:e))};case"UPDATE_REPUTATION":return{...e,reputation:Math.max(0,Math.min(200,e.reputation+t.payload.change)),reputationHistory:[...e.reputationHistory,{date:(new Date).toISOString(),change:t.payload.change,reason:t.payload.reason,turn:t.payload.turn}]};case"USE_ILLEGAL_ACTION":return{...e,illegals:{...e.illegals,corruptionNetwork:t.payload.updateCorruption?Math.min(100,e.illegals.corruptionNetwork+t.payload.corruptionChange):e.illegals.corruptionNetwork,auditRisk:Math.min(100,e.illegals.auditRisk+t.payload.riskIncrease),totalBribes:e.illegals.totalBribes+(t.payload.bribeCost||0),illegalActionHistory:[...e.illegals.illegalActionHistory,{date:(new Date).toISOString(),type:t.payload.actionType,target:t.payload.target,cost:t.payload.bribeCost||0,turn:t.payload.turn}]},cash:e.cash-(t.payload.bribeCost||0),economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+(t.payload.bribeCost||0)}};case"TRIGGER_AUDIT":return{...e,illegals:{...e.illegals,auditRisk:Math.max(10,e.illegals.auditRisk-t.payload.riskReduction),lastAuditTurn:t.payload.turn},audits:{...e.audits,totalAudits:e.audits.totalAudits+1,passedAudits:t.payload.passed?e.audits.passedAudits+1:e.audits.passedAudits,totalFines:e.audits.totalFines+(t.payload.fine||0),lastAuditResult:{date:(new Date).toISOString(),turn:t.payload.turn,passed:t.payload.passed,fine:t.payload.fine||0,reputationLoss:t.payload.reputationLoss||0}},cash:e.cash-(t.payload.fine||0),economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+(t.payload.fine||0)}};case"UPDATE_PROJECT_MARKET_VALUE":return{...e,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,marketValue:t.payload.value}:e)),economicMetrics:{...e.economicMetrics,projectsValue:e.projects.reduce(((e,n)=>e+(n.id===t.payload.projectId?t.payload.value:n.marketValue||0)),0)}};case"UPDATE_PROJECT_TOTAL_COST":return{...e,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,totalCost:e.totalCost+t.payload.cost}:e)),economicMetrics:{...e.economicMetrics,totalInvestment:e.economicMetrics.totalInvestment+t.payload.cost,projectsCost:e.economicMetrics.projectsCost+t.payload.cost}};case"INITIALIZE_PROJECT_FORMAL_PARAMS":return{...e,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,formalParams:t.payload.params}:e))};case"UPDATE_ILLEGAL_DATABASE":return{...e,illegals:{...e.illegals,hasIllegalDatabase:t.payload.hasIllegalDatabase}};case"UPDATE_ILLEGALS_STATUS":return{...e,illegals:{...e.illegals,...t.payload}};case"ADD_ILLEGAL_HISTORY":return{...e,illegals:{...e.illegals,illegalActionHistory:[...e.illegals.illegalActionHistory,t.payload]}};case"ADD_ILLEGAL_ACTION":return{...e,cash:e.cash-t.payload.cost,illegals:{...e.illegals,auditRisk:Math.min(100,e.illegals.auditRisk+5),totalBribes:e.illegals.totalBribes+t.payload.cost,illegalActionHistory:[...e.illegals.illegalActionHistory,{date:(new Date).toISOString(),type:t.payload.type,target:t.payload.target,cost:t.payload.cost,turn:t.payload.turn,exposed:t.payload.exposed}]},economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+t.payload.cost}};case"ADD_LOAN":return{...e,loans:[...e.loans||[],t.payload],cash:e.cash+t.payload.amount};case"UPDATE_LOAN":return{...e,loans:(e.loans||[]).map((e=>e.id===t.payload.id?{...e,...t.payload.changes}:e))};case"REMOVE_LOAN":return{...e,loans:(e.loans||[]).filter((e=>e.id!==t.payload.id))};case"SEND_PROJECT_TO_MARKET":return e.projects.find((e=>e.id===t.payload.projectId))?{...e,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,isOnMarket:!0,marketPrice:t.payload.price,marketListingDate:o(new Date),events:[...e.events,{date:o(new Date),text:`Projekt zosta\u0142 wystawiony na rynek za ${t.payload.price.toLocaleString()} PLN`}]}:e))}:e;case"ACCELERATE_PROJECT":return e.projects.find((e=>e.id===t.payload.projectId))?{...e,cash:e.cash-t.payload.cost,projects:e.projects.map((e=>e.id===t.payload.projectId?{...e,progress:Math.min(100,(e.progress||0)+t.payload.progressGain),events:[...e.events,{date:(new Date).toISOString(),text:`Przyspieszono projekt o ${t.payload.progressGain}% za ${t.payload.cost.toLocaleString()} PLN`}]}:e)),economicMetrics:{...e.economicMetrics,totalExpenses:e.economicMetrics.totalExpenses+t.payload.cost,totalInvestment:e.economicMetrics.totalInvestment+t.payload.cost,projectsCost:e.economicMetrics.projectsCost+t.payload.cost}}:e;case"UPDATE_ECONOMIC_METRICS":return{...e,economicMetrics:{...e.economicMetrics,...t.payload}};case"PURCHASE_COMPANY_UPGRADE":return{...e,cash:e.cash-t.payload.cost,companyUpgrades:{...e.companyUpgrades||{},[t.payload.upgradeId]:t.payload.level}};case"UPDATE_PLAYER":case"LOAD_PLAYER":return{...e,...t.payload};case"UPDATE_STAFF_STRUCTURE":return{...e,staff:{...e.staff,...t.payload}};case"UPDATE_REPUTATION_FACTOR":return{...e,reputationFactors:{...e.reputationFactors,[t.payload.factor]:Math.max(.1,Math.min(2,e.reputationFactors[t.payload.factor]+t.payload.change))},reputationHistory:[...e.reputationHistory,{date:(new Date).toISOString(),type:"factor_change",factor:t.payload.factor,change:t.payload.change,reason:t.payload.reason,turn:t.payload.turn}]};case"START_REPUTATION_INITIATIVE":const h=e.activeReputationInitiatives.findIndex((e=>e.type===t.payload.initiative.type));if(-1!==h){const n=[...e.activeReputationInitiatives],i=n[h];return n[h]={...i,intensity:i.intensity+.5*t.payload.initiative.intensity,duration:Math.max(i.duration,t.payload.initiative.duration),cost:i.cost+t.payload.initiative.cost},{...e,activeReputationInitiatives:n,cash:e.cash-t.payload.initiative.cost}}return{...e,activeReputationInitiatives:[...e.activeReputationInitiatives,{...t.payload.initiative,startDate:(new Date).toISOString(),remainingDuration:t.payload.initiative.duration}],cash:e.cash-t.payload.initiative.cost};case"UPDATE_REPUTATION_INITIATIVES":const p=t.payload.daysPassed||1;let m=0,f={};const y=e.activeReputationInitiatives.map((e=>{const t=e.remainingDuration-p;if(e.continuousEffects)for(const n of e.continuousEffects)n.reputationPerDay&&(m+=n.reputationPerDay*p),n.factorChange&&n.factorPerDay&&(f[n.factorChange]=(f[n.factorChange]||0)+n.factorPerDay*p);if(t<=0){if(e.finalEffects)for(const t of e.finalEffects)t.reputationChange&&(m+=t.reputationChange),t.factorChange&&t.factorAmount&&(f[t.factorChange]=(f[t.factorChange]||0)+t.factorAmount);return null}return{...e,remainingDuration:t}})).filter(Boolean),g={...e.reputationFactors};for(const[e,t]of Object.entries(f))g[e]=Math.max(.1,Math.min(2,g[e]+t));return{...e,reputation:Math.max(0,Math.min(200,e.reputation+m)),reputationFactors:g,activeReputationInitiatives:y,reputationHistory:[...e.reputationHistory,...0!==m?[{date:(new Date).toISOString(),change:m,reason:"Efekt inicjatyw reputacyjnych",turn:t.payload.turn}]:[],...Object.entries(f).map((e=>{let[n,i]=e;return{date:(new Date).toISOString(),type:"factor_change",factor:n,change:i,reason:"Efekt inicjatyw reputacyjnych",turn:t.payload.turn}}))]};default:return e}}const c=(0,i.createContext)(),d=e=>{let{children:t}=e;const[n,r]=(0,i.useReducer)(l,s);return(0,a.jsx)(c.Provider,{value:{state:n,dispatch:r},children:t})},u=()=>{const e=(0,i.useContext)(c);if(!e)throw new Error("usePlayerContext musi by\u0107 u\u017cywany wewn\u0105trz PlayerProvider");return e},h=[{id:"competitor1",name:"GreenPower Polska",power:8e3,rtbPower:2e3,growth:1.1,strongRegions:["mazowieckie","wielkopolskie","slaskie"],strategy:"aggressive",reputation:70,description:"Najwi\u0119kszy deweloper OZE w Polsce, agresywnie rozwijaj\u0105cy sw\xf3j portfel projekt\xf3w. Koncentruje si\u0119 na du\u017cych farmach fotowoltaicznych i wiatrowych w centralnej i zachodniej Polsce.",focusTechnologies:["PV","WF"],foundedYear:2010},{id:"competitor2",name:"SolarTech",power:5e3,rtbPower:1500,growth:1.2,strongRegions:["malopolskie","podkarpackie","lubelskie"],strategy:"balanced",reputation:65,description:"Firma specjalizuj\u0105ca si\u0119 w projektach fotowoltaicznych, z rosn\u0105cym zainteresowaniem magazynami energii. Dzia\u0142a g\u0142\xf3wnie w po\u0142udniowo-wschodniej Polsce.",focusTechnologies:["PV","BESS"],foundedYear:2015},{id:"competitor3",name:"WindForce",power:6e3,rtbPower:1800,growth:1.15,strongRegions:["pomorskie","zachodniopomorskie","warminsko-mazurskie"],strategy:"conservative",reputation:80,description:"Do\u015bwiadczony deweloper farm wiatrowych z siln\u0105 pozycj\u0105 w p\xf3\u0142nocnej Polsce. Znany z wysokiej jako\u015bci projekt\xf3w i dobrych relacji z lokalnymi spo\u0142eczno\u015bciami.",focusTechnologies:["WF"],foundedYear:2008},{id:"competitor4",name:"EnergyStorage Systems",power:3e3,rtbPower:900,growth:1.25,strongRegions:["lodzkie","mazowieckie","slaskie"],strategy:"aggressive",reputation:60,description:"Nowy, szybko rozwijaj\u0105cy si\u0119 gracz specjalizuj\u0105cy si\u0119 w magazynach energii. Agresywnie pozyskuje lokalizacje w pobli\u017cu du\u017cych o\u015brodk\xf3w przemys\u0142owych i w\u0119z\u0142\xf3w energetycznych.",focusTechnologies:["BESS","PV"],foundedYear:2018},{id:"competitor5",name:"EcoEnergy",power:4500,rtbPower:1200,growth:1.05,strongRegions:["wielkopolskie","lubuskie","dolnoslaskie"],strategy:"conservative",reputation:75,description:"Stabilna firma z d\u0142ug\u0105 histori\u0105 na rynku OZE, dzia\u0142aj\u0105ca g\u0142\xf3wnie w zachodniej Polsce. Ostro\u017cnie podchodzi do nowych projekt\xf3w, ale ma solidny portfel aktyw\xf3w.",focusTechnologies:["PV","WF"],foundedYear:2005}],p=(e,t)=>{if(!t||!Array.isArray(t)||0===t.length)return null;const n=["land_acquisition","project_development","market_expansion","technology_shift","acquisition"],i=n[Math.floor(Math.random()*n.length)];let r={id:Date.now(),competitorId:e.id,competitorName:e.name,type:i,title:"",description:"",effects:[],regions:[]};switch(i){case"land_acquisition":const n=e.strongRegions[Math.floor(Math.random()*e.strongRegions.length)],i=t.find((e=>e.id===n));if(!i)return p(e,t);const a=Math.floor(30+50*Math.random());r.title=`${e.name} pozyskuje grunty w regionie ${i.name}`,r.description=`Konkurent zabezpieczy\u0142 ${a} ha grunt\xf3w pod nowy projekt OZE.`,r.effects.push({type:"regional_land_availability",value:.95,regionId:n}),r.regions.push(n);break;case"project_development":const s=Math.floor(20+60*Math.random()),o=e.focusTechnologies[Math.floor(Math.random()*e.focusTechnologies.length)];r.title=`${e.name} rozwija nowy projekt ${o}`,r.description=`Konkurent og\u0142osi\u0142 rozw\xf3j nowego projektu ${o} o mocy ${s} MW.`,r.effects.push({type:"competitor_power",value:s,competitorId:e.id});break;case"market_expansion":const l=t.filter((t=>!e.strongRegions.includes(t.id)));if(!(l.length>0))return p(e,t);{const t=l[Math.floor(Math.random()*l.length)];r.title=`${e.name} wchodzi na rynek w regionie ${t.name}`,r.description="Konkurent rozpoczyna dzia\u0142alno\u015b\u0107 w nowym regionie, zwi\u0119kszaj\u0105c konkurencj\u0119.",r.effects.push({type:"regional_competition",value:1.1,regionId:t.id}),r.regions.push(t.id)}break;case"technology_shift":const c=["PV","WF","BESS"].filter((t=>!e.focusTechnologies.includes(t)));if(!(c.length>0))return p(e,t);{const t=c[Math.floor(Math.random()*c.length)];r.title=`${e.name} wchodzi w now\u0105 technologi\u0119: ${t}`,r.description=`Konkurent og\u0142osi\u0142 strategiczn\u0105 decyzj\u0119 o rozwoju projekt\xf3w w technologii ${t}.`,r.effects.push({type:"competitor_technology",value:t,competitorId:e.id})}break;case"acquisition":r.title=`${e.name} przejmuje mniejszego dewelopera`,r.description="Konkurent og\u0142osi\u0142 przej\u0119cie mniejszej firmy deweloperskiej, zwi\u0119kszaj\u0105c sw\xf3j portfel projekt\xf3w.";const d=Math.floor(500+1e3*Math.random());r.effects.push({type:"competitor_power_boost",value:d,competitorId:e.id});break;default:return null}return r},m={marketModifier:{min:.7,max:1.5},permitTimeModifier:{min:.5,max:2},buildCostModifier:{min:.6,max:1.8},loanInterestRate:{min:.7,max:1.5},staffCostModifier:{min:.8,max:1.3},reputationChange:{min:-30,max:30},riskLevel:{min:-10,max:10},grayAreaImpact:{min:-25,max:25},projectEfficiency:{min:-20,max:30},staffProductivity:{min:-25,max:40}},f=(e,t)=>{if(!m[e])return t;const{min:n,max:i}=m[e];return Math.max(n,Math.min(i,t))},y=e=>{if(!e)return{};const t={};for(const[n,i]of Object.entries(e))t[n]="object"!==typeof i?f(n,i):i;if(e.regionalEffect){t.regionalEffect={...e.regionalEffect};for(const[n,i]of Object.entries(e.regionalEffect))"region"!==n&&(t.regionalEffect[n]=f(n,i))}if(e.technologyEffect){t.technologyEffect={...e.technologyEffect};for(const[n,i]of Object.entries(e.technologyEffect))"technology"!==n&&(t.technologyEffect[n]=f(n,i))}return t},g=e=>{const t={marketModifier:{min:.6,max:2},permitTimeModifier:{min:.4,max:2.5},buildCostModifier:{min:.5,max:2},loanInterestRate:{min:.5,max:2},staffCostModifier:{min:.7,max:1.5}},n={...e};for(const[i,r]of Object.entries(e))if(t[i]){const{min:e,max:a}=t[i];n[i]=Math.max(e,Math.min(a,r))}return n};class v{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.id=e||Date.now()+Math.random(),this.name=t,this.description=n,this.duration=i,this.image=r,this.startDate=null,this.expiryDate=null}activate(e){this.startDate=new Date(e);const t=new Date(e);return t.setDate(t.getDate()+this.duration),this.expiryDate=t,this}isExpired(e){return!!this.expiryDate&&e>this.expiryDate}getEffect(){return{}}}class w extends v{constructor(e,t,n,i,r){super(e,t,n,i,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="economic",this.effects=r}getEffect(){return this.effects}}class x extends v{constructor(e,t,n,i,r){super(e,t,n,i,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="political",this.effects=r}getEffect(){return this.effects}}class b extends v{constructor(e,t,n,i,r){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;super(e,t,n,i,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null),this.type="social",this.effects=r,this.region=a}getEffect(){const e={...this.effects};return this.region&&(e.regionalEffect={region:this.region,...e.regionalEffect}),e}}class j extends v{constructor(e,t,n,i,r){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;super(e,t,n,i,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null),this.type="environmental",this.effects=r,this.region=a}getEffect(){const e={...this.effects};return this.region&&(e.regionalEffect={region:this.region,...e.regionalEffect}),e}}class k extends v{constructor(e,t,n,i,r){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;super(e,t,n,i,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null),this.type="technological",this.effects=r,this.technology=a}getEffect(){const e={...this.effects};return this.technology&&(e.technologyEffect={technology:this.technology,...e.technologyEffect}),e}}class N extends v{constructor(e,t,n,i,r){super(e,t,n,i,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="media",this.effects=r}getEffect(){return this.effects}}class z extends v{constructor(e,t,n,i,r){super(e,t,n,i,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="regulatory",this.effects=r}getEffect(){return this.effects}}new k("quantum_battery","Prze\u0142om: Bateria kwantowa","Naukowcy z polskiego instytutu dokonali prze\u0142omu w technologii baterii kwantowych. Ta rewolucyjna technologia mo\u017ce zmieni\u0107 oblicze energetyki.",365,{investmentOpportunity:{cost:5e6,successChance:.4,potentialReturn:12,technologyAdvantage:3},energyStorageRevolution:!0,marketDisruption:.3}).rarity={weight:1,color:"#f59e0b"};const _=[new w("econ_1","Wzrost cen pr\u0105du na rynku","Ceny energii elektrycznej na rynku wzros\u0142y o 15%, zwi\u0119kszaj\u0105c atrakcyjno\u015b\u0107 projekt\xf3w OZE.",30,{marketModifier:1.15,permitTimeModifier:1}),new w("econ_2","Spadek cen pr\u0105du na rynku","Ceny energii elektrycznej na rynku spad\u0142y o 10%, zmniejszaj\u0105c op\u0142acalno\u015b\u0107 projekt\xf3w OZE.",21,{marketModifier:.9,permitTimeModifier:1}),new w("econ_3","Wzrost st\xf3p procentowych","NBP podni\xf3s\u0142 stopy procentowe, co utrudnia finansowanie projekt\xf3w i zwi\u0119ksza koszty kredyt\xf3w.",60,{buildCostModifier:1.1,marketModifier:.95}),new w("econ_4","Kryzys na rynku surowc\xf3w","Globalny kryzys na rynku surowc\xf3w zwi\u0119ksza koszty budowy farm PV i wiatrowych.",45,{buildCostModifier:1.2,marketModifier:1.05}),new w("econ_5","Nowe fundusze UE dla OZE","Unia Europejska uruchomi\u0142a nowe fundusze na rozw\xf3j OZE, co zwi\u0119ksza warto\u015b\u0107 projekt\xf3w.",90,{marketModifier:1.2,buildCostModifier:.95,reputationChange:5}),new w("eco_6","Dotacje dla hybryd PV+BESS","Rz\u0105d wprowadzi\u0142 program dotacji pokrywaj\u0105cy 30% koszt\xf3w magazyn\xf3w energii w projektach hybrydowych.",120,{marketModifier:1.2,permitTimeModifier:.9,technologyEffect:{technology:"BESS",marketModifier:1.3}}),new w("eco_7","Ulgi podatkowe dla inwestor\xf3w OZE","Wprowadzono 50% odliczenia VAT dla firm inwestuj\u0105cych w projekty energetyki odnawialnej.",180,{marketModifier:1.15,permitTimeModifier:.85}),new w("eco_8","Aukcje CPPA","Wprowadzono system d\u0142ugoterminowych kontrakt\xf3w dla przemys\u0142u, umo\u017cliwiaj\u0105cych stabilne finansowanie projekt\xf3w OZE.",150,{marketModifier:1.25}),new w("eco_9",'Program "Prosument 3.0"',"Nowy program rz\u0105dowy oferuje dotacje do 60% dla mikroinstalacji fotowoltaicznych.",90,{technologyEffect:{technology:"PV",marketModifier:1.2}}),new w("eco_10","C\u0142a na komponenty","Wprowadzono 20% c\u0142o na panele fotowoltaiczne z Chin, podnosz\u0105c koszty inwestycji.",120,{technologyEffect:{technology:"PV",marketModifier:.85,buildCostModifier:1.2},severity:"negative"})],S=[new x("pol_1","Nowelizacja ustawy o OZE","Sejm przyj\u0105\u0142 nowelizacj\u0119 ustawy o OZE, kt\xf3ra upraszcza procedury administracyjne.",120,{permitTimeModifier:.8,reputationChange:3}),new x("pol_2","Zaostrzenie wymaga\u0144 \u015brodowiskowych","Nowe przepisy zaostrzaj\u0105 wymagania dotycz\u0105ce ocen oddzia\u0142ywania na \u015brodowisko.",90,{permitTimeModifier:1.3,reputationChange:-2}),new x("pol_3","Reforma systemu aukcyjnego","Rz\u0105d zreformowa\u0142 system aukcyjny OZE, wprowadzaj\u0105c korzystniejsze zasady dla inwestor\xf3w.",180,{marketModifier:1.1,permitTimeModifier:.9,reputationChange:5}),new x("pol_4","Ograniczenie dotacji dla OZE","Rz\u0105d ograniczy\u0142 dotacje dla nowych projekt\xf3w OZE, co zmniejsza ich op\u0142acalno\u015b\u0107.",150,{marketModifier:.85,reputationChange:-3}),new x("pol_5","Nowe cele klimatyczne","Polska przyj\u0119\u0142a ambitniejsze cele klimatyczne, zwi\u0119kszaj\u0105c zapotrzebowanie na OZE.",210,{marketModifier:1.15,reputationChange:7}),new x("pol_6",'Ustawa "Fast-track"',"Sejm przyj\u0105\u0142 ustaw\u0119 znacz\u0105co skracaj\u0105c\u0105 proces pozwole\u0144 dla projekt\xf3w OZE z 5 do 2 lat.",365,{permitTimeModifier:.6,reputationChange:5}),new x("pol_7","Krajowy Plan Modernizacji Sieci","Rz\u0105d przeznaczy\u0142 10 mld z\u0142 na rozbudow\u0119 infrastruktury przesy\u0142owej, zwi\u0119kszaj\u0105c mo\u017cliwo\u015bci przy\u0142\u0105czeniowe.",240,{permitTimeModifier:.75,buildCostModifier:.9}),new x("pol_8","Strategia wodorowa","Przyj\u0119to strategi\u0119 rozwoju wodoru z OZE z celem 2 GW mocy do 2030 roku.",180,{marketModifier:1.15}),new x("pol_9","Zmiana ustawy odleg\u0142o\u015bciowej","Wprowadzono zakaz budowy wiatrak\xf3w w promieniu 1 km od zabudowa\u0144, co utrudnia rozw\xf3j energetyki wiatrowej.",300,{technologyEffect:{technology:"WF",marketModifier:.7,permitTimeModifier:1.5},severity:"negative"}),new x("pol_10","Op\xf3\u017anienie offshore","Brak ustawy o morskiej energetyce wstrzymuje projekty o \u0142\u0105cznej mocy 10 GW.",150,{technologyEffect:{technology:"WF",marketModifier:.8},severity:"negative"})],E=[new b("soc_1","Protesty przeciwko farmom wiatrowym","W wielu regionach kraju nasili\u0142y si\u0119 protesty lokalnych spo\u0142eczno\u015bci przeciwko farmom wiatrowym.",60,{permitTimeModifier:1.2,reputationChange:-3}),new b("soc_2","Wzrost poparcia dla OZE","Badania pokazuj\u0105 rekordowy wzrost poparcia spo\u0142ecznego dla energetyki odnawialnej.",90,{permitTimeModifier:.9,reputationChange:4}),new b("soc_3","Lokalna kampania przeciwko PV","W wojew\xf3dztwie ma\u0142opolskim rozwin\u0119\u0142a si\u0119 kampania przeciwko wielkoobszarowym farmom PV.",45,{regionalEffect:{permitTimeModifier:1.3}},"ma\u0142opolskie"),new b("soc_4","Program edukacyjny o OZE","Ministerstwo Klimatu uruchomi\u0142o og\xf3lnopolski program edukacyjny na temat korzy\u015bci z OZE.",120,{permitTimeModifier:.95,reputationChange:2}),new b("soc_5","Konflikt o turbiny przy wybrze\u017cu","Nasili\u0142 si\u0119 konflikt mi\u0119dzy rybakami a inwestorami farm wiatrowych na Ba\u0142tyku.",75,{regionalEffect:{permitTimeModifier:1.4}},"pomorskie"),new b("soc_6","Subsydia dla mieszka\u0144c\xf3w",'Program "Energia dla Spo\u0142eczno\u015bci" oferuje darmowe instalacje PV w zamian za zgod\u0119 na farmy wiatrowe.',120,{permitTimeModifier:.8,reputationChange:5}),new b("soc_7","Nowe miejsca pracy","Budowa farmy wiatrowej 50 MW stworzy\u0142a 100 sta\u0142ych miejsc pracy w regionie.",90,{reputationChange:3,technologyEffect:{technology:"WF",marketModifier:1.1}},"zachodniopomorskie"),new b("soc_8","Programy edukacyjne OZE",'Warsztaty "Zielona Gmina" w szko\u0142ach, finansowane przez deweloper\xf3w, zwi\u0119kszaj\u0105 spo\u0142eczn\u0105 akceptacj\u0119 projekt\xf3w.',150,{permitTimeModifier:.9,reputationChange:2}),new b("soc_9","Protesty NIMBY","Blokada budowy farmy wiatrowej przez mieszka\u0144c\xf3w gminy wzbudzi\u0142a obawy inwestor\xf3w.",60,{permitTimeModifier:1.3,reputationChange:-4,technologyEffect:{technology:"WF",marketModifier:.9}},"ma\u0142opolskie"),new b("soc_10","Bunt spo\u0142eczno\u015bci","Mieszka\u0144cy blokuj\u0105 wjazd ci\u0119\u017car\xf3wek na plac budowy farmy fotowoltaicznej.",45,{buildCostModifier:1.2,permitTimeModifier:1.4,reputationChange:-3},"podkarpackie")],C=[new j("env_1","Rekordowo s\u0142oneczne lato","Tegoroczne lato przynios\u0142o rekordow\u0105 liczb\u0119 dni s\u0142onecznych, co zwi\u0119ksza wydajno\u015b\u0107 PV.",90,{technologyEffect:{technology:"PV",marketModifier:1.1}}),new j("env_2","Silne wiatry na p\xf3\u0142nocy","Na p\xf3\u0142nocy Polski utrzymuj\u0105 si\u0119 wyj\u0105tkowo silne wiatry, zwi\u0119kszaj\u0105c potencja\u0142 farm wiatrowych.",60,{regionalEffect:{marketModifier:1.15},technologyEffect:{technology:"WF",marketModifier:1.1}},"pomorskie"),new j("env_3","Susze w centralnej Polsce","D\u0142ugotrwa\u0142e susze w centralnej Polsce powoduj\u0105 konflikty o wykorzystanie grunt\xf3w.",75,{regionalEffect:{permitTimeModifier:1.2}},"mazowieckie"),new j("env_4","Odkrycie cennego gatunku ptak\xf3w","W wojew\xf3dztwie podlaskim odkryto rzadki gatunek ptak\xf3w, co komplikuje projekty OZE.",120,{regionalEffect:{permitTimeModifier:1.5}},"podlaskie"),new j("env_5","Wysoki poziom zanieczyszczenia powietrza","Zim\u0105 odnotowano rekordowo wysokie poziomy zanieczyszczenia powietrza, co zwi\u0119ksza poparcie dla OZE.",60,{permitTimeModifier:.9,reputationChange:3}),new j("env_6","Korytarze bior\xf3\u017cnorodno\u015bci","Wsp\xf3\u0142projekty z ekologami, w tym tworzenie pasiek przy farmach PV, zwi\u0119kszaj\u0105 akceptacj\u0119 \u015brodowiskow\u0105.",120,{permitTimeModifier:.85,reputationChange:3,technologyEffect:{technology:"PV",buildCostModifier:1.05}}),new j("env_7","Ekstremalne warunki pogodowe","Gradobicie uszkodzi\u0142o znaczn\u0105 cz\u0119\u015b\u0107 paneli fotowoltaicznych w centralnej Polsce.",45,{buildCostModifier:1.2,technologyEffect:{technology:"PV",marketModifier:.9}},"\u0142\xf3dzkie"),new j("env_8","\u015amiertelno\u015b\u0107 ptak\xf3w","Aktywi\u015bci zaskar\u017cyli dewelopera za zabijanie chronionych gatunk\xf3w ptak\xf3w przez turbiny wiatrowe.",90,{permitTimeModifier:1.3,reputationChange:-3,technologyEffect:{technology:"WF",marketModifier:.85}},"warmi\u0144sko-mazurskie"),new j("env_9","Odkrycie cennego gatunku","W wojew\xf3dztwie lubelskim odkryto rzadki gatunek ro\u015blin, co komplikuje projekty OZE w regionie.",150,{regionalEffect:{permitTimeModifier:1.4}},"lubelskie"),new j("env_10","Degradacja \u015brodowiska","Wycinka 50 ha lasu pod farm\u0119 PV wywo\u0142a\u0142a skandal ekologiczny.",75,{permitTimeModifier:1.5,reputationChange:-5,technologyEffect:{technology:"PV",marketModifier:.8}})],T=[new k("tech_1","Prze\u0142om w wydajno\u015bci paneli PV","Naukowcy opracowali now\u0105 technologi\u0119 zwi\u0119kszaj\u0105c\u0105 wydajno\u015b\u0107 paneli fotowoltaicznych o 25%.",150,{technologyEffect:{technology:"PV",buildCostModifier:.9,marketModifier:1.15}},"PV"),new k("tech_2","Nowa generacja turbin wiatrowych","Na rynek wesz\u0142a nowa generacja turbin wiatrowych o lepszej wydajno\u015bci i ni\u017cszej emisji ha\u0142asu.",180,{technologyEffect:{technology:"WF",buildCostModifier:.85,marketModifier:1.2}},"WF"),new k("tech_3","Innowacje w magazynach energii","Prze\u0142omowe innowacje w technologii magazyn\xf3w energii zwi\u0119kszaj\u0105 ich op\u0142acalno\u015b\u0107.",120,{technologyEffect:{technology:"BESS",buildCostModifier:.8,marketModifier:1.3}},"BESS"),new k("tech_4","Problemy jako\u015bciowe z chi\u0144skimi panelami","Wykryto problemy jako\u015bciowe w panelach fotowoltaicznych importowanych z Chin.",90,{technologyEffect:{technology:"PV",buildCostModifier:1.15,marketModifier:.9}},"PV"),new k("tech_5","Nowy system prognozowania wiatru","Opracowano nowy system prognozowania wiatru, zwi\u0119kszaj\u0105cy efektywno\u015b\u0107 farm wiatrowych.",100,{technologyEffect:{technology:"WF",marketModifier:1.1}},"WF"),new k("tech_6","Innowacyjne trackery PV","Nowe systemy \u015bledzenia s\u0142o\u0144ca zwi\u0119kszaj\u0105 wydajno\u015b\u0107 paneli fotowoltaicznych o 25%.",180,{technologyEffect:{technology:"PV",buildCostModifier:.85,marketModifier:1.2}}),new k("tech_7","Hybrydyzacja OZE","Po\u0142\u0105czenie PV z wiatrem redukuje LCOE o 18%, zwi\u0119kszaj\u0105c op\u0142acalno\u015b\u0107 projekt\xf3w.",150,{buildCostModifier:.9,marketModifier:1.15}),new k("tech_8","Optymalizacja BESS","Nowe algorytmy zarz\u0105dzania zmniejszaj\u0105 straty energii w magazynach o 12%.",120,{technologyEffect:{technology:"BESS",marketModifier:1.25}}),new k("tech_9","Partnerstwo z Google","Wdro\u017cenie AI do prognozowania produkcji energii zwi\u0119ksza efektywno\u015b\u0107 zarz\u0105dzania farmami.",90,{marketModifier:1.1}),new k("tech_10","Awaria technologii","Magazyn BESS eksplodowa\u0142 z powodu b\u0142\u0119d\xf3w projektowych, wywo\u0142uj\u0105c obawy inwestor\xf3w.",60,{technologyEffect:{technology:"BESS",marketModifier:.75,buildCostModifier:1.3},severity:"negative"})];class P extends v{constructor(e,t,n,i,r,a){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;super(e,t,n,i,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null),this.type="local",this.effects=r,this.region=a,this.county=s}getEffect(){const e={...this.effects};return this.region&&(e.regionalEffect={region:this.region,...e.regionalEffect}),this.county&&(e.countyEffect={region:this.region,county:this.county,...e.countyEffect}),e}}const I=[new P("local_1","Modernizacja infrastruktury","Deweloperzy finansuj\u0105 remont dr\xf3g dojazdowych w gminie, zwi\u0119kszaj\u0105c przychylno\u015b\u0107 mieszka\u0144c\xf3w.",90,{permitTimeModifier:.8,reputationChange:3},"ma\u0142opolskie","krakowski"),new P("local_2","Wzrost przychod\xf3w gminy","Dodatkowe 500 000 z\u0142/rok z podatk\xf3w od farmy 20 MW zwi\u0119kszy\u0142o poparcie lokalnych w\u0142adz.",120,{permitTimeModifier:.7,reputationChange:4},"mazowieckie","p\u0142ocki"),new P("local_3","Projekty spo\u0142eczne","Budowa \u015bwietlicy i si\u0142owni plenerowej w zamian za zgod\u0119 na inwestycj\u0119 OZE.",180,{permitTimeModifier:.75,reputationChange:5},"podlaskie","bia\u0142ostocki"),new P("local_4","Klastry energii","Gminy \u0142\u0105cz\u0105 si\u0119 w lokalny system energetyczny, zwi\u0119kszaj\u0105c mo\u017cliwo\u015bci przy\u0142\u0105czeniowe.",150,{permitTimeModifier:.85,buildCostModifier:.9},"\u015bl\u0105skie","cz\u0119stochowski"),new P("local_5","Konflikty o grunty","W\u0142a\u015bciciele ziemi \u017c\u0105daj\u0105 podwy\u017cek czynszu o 300%, co utrudnia pozyskiwanie grunt\xf3w.",60,{buildCostModifier:1.3,permitTimeModifier:1.2},"wielkopolskie","pozna\u0144ski"),new P("local_6","Brak przy\u0142\u0105czy","Operator odmawia pod\u0142\u0105czenia farmy z powodu przeci\u0105\u017cenia sieci w regionie.",90,{permitTimeModifier:1.5},"\u0142\xf3dzkie","\u0142\xf3dzki wschodni"),new P("local_7","Spadek warto\u015bci nieruchomo\u015bci","Domy w pobli\u017cu farmy wiatrowej straci\u0142y 20% warto\u015bci, wywo\u0142uj\u0105c protesty mieszka\u0144c\xf3w.",75,{permitTimeModifier:1.3,reputationChange:-4},"pomorskie","s\u0142upski")];class A extends v{constructor(e,t,n,i,r){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;super(e,t,n,i,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null),this.type="project",this.effects=r,this.technology=a}getEffect(){const e={...this.effects};return this.technology&&(e.technologyEffect={technology:this.technology,...e.technologyEffect}),e}}const M=[new A("proj_1","Finansowanie z UE","Uzyskano grant 15 mln z\u0142 z Funduszu Sp\xf3jno\u015bci na budow\u0119 magazynu energii.",90,{buildCostModifier:.7,technologyEffect:{marketModifier:1.2}},"BESS"),new A("proj_2","Digital Twin","Cyfrowy model farmy zmniejsza ryzyko awarii o 40%, zwi\u0119kszaj\u0105c warto\u015b\u0107 projektu.",120,{marketModifier:1.15},"PV"),new A("proj_3","Certyfikat ESG","Uzyskanie ratingu AA+ przyci\u0105ga inwestor\xf3w i zwi\u0119ksza warto\u015b\u0107 projektu.",150,{marketModifier:1.2,reputationChange:3}),new A("proj_4","Recykling na miejscu","Mobilne zak\u0142ady przetwarzania zu\u017cytych paneli zwi\u0119kszaj\u0105 ekologiczno\u015b\u0107 projektu.",180,{marketModifier:1.1,reputationChange:4},"PV"),new A("proj_5","Op\xf3\u017anienie pozwole\u0144","Decyzja \u015brodowiskowa przeci\u0105ga si\u0119 o 18 miesi\u0119cy z powodu protest\xf3w ekolog\xf3w.",90,{permitTimeModifier:1.6}),new A("proj_6","Bank wycofuje finansowanie","Podwy\u017cka st\xf3p procentowych spowodowa\u0142a wycofanie si\u0119 banku z finansowania projektu.",60,{marketModifier:.8,buildCostModifier:1.2}),new A("proj_7","Wzrost sk\u0142adek ubezpieczeniowych","Po huraganie koszt polisy dla farm PV wzr\xf3s\u0142 o 200%.",120,{buildCostModifier:1.15},"PV")],D=[new w("land_war","Wojna surowcowa","Rolnicy masowo wstrzymuj\u0105 sprzeda\u017c ziemi z powodu rosn\u0105cych cen \u017cywno\u015bci. Zd\u0105\u017cysz pozyska\u0107 grunty przed kolejn\u0105 podwy\u017ck\u0105?",90,{leaseRate:1.3,projectType:"all",description:"Koszt dzier\u017cawy wzr\xf3s\u0142 o 30% w tym regionie"})],R=[..._,...S,...E,...C,...T,...I,...M,...D],O=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=[...R];if(e&&(t=t.filter((t=>t.type===e))),0===t.length)return null;return t[Math.floor(Math.random()*t.length)]},L=e=>{if(!e.effects)return"info";let t=0;return e.effects.marketModifier&&(t+=10*(e.effects.marketModifier-1)),e.effects.reputationChange&&(t+=e.effects.reputationChange/5),e.effects.permitTimeModifier&&(t-=10*(e.effects.permitTimeModifier-1)),e.effects.buildCostModifier&&(t-=10*(e.effects.buildCostModifier-1)),e.effects.riskLevel&&(t-=e.effects.riskLevel),e.effects.grayAreaImpact&&(t-=e.effects.grayAreaImpact/5),t>2?"positive":t<-2?"negative":t<-.5||t>.5?"warning":"info"},F=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=[],a=i?i.turn:null,s=(i?i.date:new Date,i&&i.day,{});return Object.entries({economic:.3,political:.25,social:.28,environmental:.27,technological:.24,local:.35,project:.3}).forEach((e=>{let[t,i]=e;s[t]=1-Math.pow(1-i,1/n)})),e&&Object.entries(e).forEach((e=>{let[t,n]=e;void 0!==s[t]&&(s[t]*=n)})),Object.entries(s).forEach((e=>{let[i,s]=e;for(let o=0;o<n;o++)if(Math.random()<s){const e=O(i);if(e){const n=new Date;if(e.effects&&(e.effects=y(e.effects)),r.push(e.activate(n)),t){const n={id:e.id||Date.now()+Math.random(),type:e.type,title:e.name,description:e.description,severity:L(e),turn:a||(new Date).getTime(),expires:a?a+Math.ceil(e.duration/2):Math.ceil(e.duration/2)};e.effects&&(n.effects={...e.effects}),e.region?(n.region=e.region,n.scope="regional"):n.scope="national",e.technology&&(n.technology=e.technology),e.projectType&&(n.projectType=e.projectType);Math.random()<.2&&(n.requiresDecision=!0,n.severity="special",n.decisions=[{id:"option1",label:"Opcja 1",effects:{reputationImpact:5}},{id:"option2",label:"Opcja 2",effects:{cashImpact:1e4}}]),t({type:"ADD_EVENT",payload:n})}}}})),r};U=new b("corruption_discovery","Korupcja w urz\u0119dzie","Tw\xf3j pracownik odkry\u0142 dowody na korupcj\u0119 w lokalnym urz\u0119dzie przy wydawaniu pozwole\u0144 dla OZE. Co zrobisz?",30,{decisions:[{id:"report",label:"Zg\u0142o\u015b spraw\u0119",reputation:10,permitTimeModifier:1.3},{id:"bribe",label:"Wykorzystaj sytuacj\u0119",reputation:-20,permitTimeModifier:.6,riskLevel:.7},{id:"ignore",label:"Zignoruj spraw\u0119",reputation:-5}]}),V={report:[new N("media_exposure","Sprawa w mediach","Twoje zg\u0142oszenie doprowadzi\u0142o do medialnego rozg\u0142osu wok\xf3\u0142 korupcji. Jeste\u015b postrzegany jako etyczna firma w bran\u017cy.",120,{reputationChange:15,marketAdvantage:.05,competitorRelations:-.1}),new x("investigation_started","Dochodzenie antykorupcyjne","CBA wszcz\u0119\u0142o dochodzenie w sprawie korupcji w urz\u0119dzie. Wszystkie pozwolenia s\u0105 teraz dok\u0142adniej sprawdzane.",180,{permitTimeModifier:1.2,permitSuccess:1.1})],bribe:[new P("expedited_permits","Przyspieszone pozwolenia","Twoje projekty otrzymuj\u0105 szybk\u0105 \u015bcie\u017ck\u0119, ale dzia\u0142asz na granicy prawa.",90,{permitTimeModifier:.5,riskEventChance:.3}),new class extends v{constructor(e,t,n,i,r){super(e,t,n,i,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="risk",this.effects=r}getEffect(){return this.effects}}("corruption_investigation","Dochodzenie antykorupcyjne","Twoje nieetyczne dzia\u0142ania wysz\u0142y na jaw. Firma stoi w obliczu powa\u017cnych konsekwencji prawnych.",null,{reputationChange:-50,legalFees:1e6,permitBlock:!0,projectFreeze:!0},.4)],ignore:[new class extends v{constructor(e,t,n,i,r){super(e,t,n,i,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="industry",this.effects=r}getEffect(){return this.effects}}("industry_perception","Z\u0142a reputacja bran\u017cy","Korupcja w bran\u017cy OZE nasila si\u0119. Spo\u0142ecze\u0144stwo coraz bardziej sceptycznie podchodzi do nowych projekt\xf3w.",365,{socialAcceptance:-.1,permitDifficulty:1.1})]};var U,V;new class extends v{constructor(e,t,n,i,r){super(e,t,n,null),this.type="dilemma",this.options=i,this.consequences=r,this.decisionMade=!1}makeDecision(e,t){if(this.decisionMade)return null;this.decisionMade=!0;this.options.find((t=>t.id===e));return t.playerDecisions.push({dilemmaId:this.id,decision:e,turn:t.turn}),this.consequences[e]}}("wetlands_project","Projekt na terenach podmok\u0142ych","Znalaz\u0142e\u015b idealn\u0105 lokalizacj\u0119 na farm\u0119 wiatrow\u0105, ale jest to cenny ekosystem podmok\u0142y, dom dla wielu rzadkich gatunk\xf3w. Eksperci \u015brodowiskowi apeluj\u0105 o ochron\u0119 tego terenu.",[{id:"protect",label:"Zrezygnuj z projektu i chro\u0144 ekosystem",description:"Zyskasz uznanie ekolog\xf3w, ale stracisz doskona\u0142\u0105 lokalizacj\u0119 biznesow\u0105."},{id:"relocate",label:"Zmodyfikuj projekt, by zminimalizowa\u0107 wp\u0142yw",description:"Kompromisowe rozwi\u0105zanie z mniejszym zyskiem, ale zachowaniem cz\u0119\u015bci ekosystemu."},{id:"develop",label:"Kontynuuj projekt zgodnie z planem",description:"Maksymalizuj zyski, ignoruj\u0105c sprzeciw ekolog\xf3w."}],{protect:{reputationChange:25,environmentalScore:30,investmentLoss:2e5,permitsEase:1.2,followUpEvents:["eco_partnership_offer"]},relocate:{reputationChange:10,environmentalScore:15,projectEfficiency:.85,investmentIncrease:15e4,permitsEase:1.05},develop:{reputationChange:-20,environmentalScore:-25,projectEfficiency:1,permitRisk:.4,followUpEvents:["eco_protest_campaign","media_backlash"]}});new class{constructor(e,t,n,i,r){this.id=e,this.name=t,this.description=n,this.trigger=i,this.stages=r,this.currentStage=0,this.isActive=!1,this.isCompleted=!1}checkTrigger(e,t){if(this.isActive||this.isCompleted)return!1;return!!this.trigger(e,t)&&(this.isActive=!0,this.stages[0])}progressToNextStage(e){return!this.isActive||this.isCompleted?null:(this.currentStage++,this.currentStage>=this.stages.length?(this.isCompleted=!0,this.isActive=!1,null):this.stages[this.currentStage])}}("green_revolution","Zielona Rewolucja Energetyczna","Seria wydarze\u0144 zwi\u0105zanych z prze\u0142omem w polityce energetycznej kraju.",((e,t)=>t.operationalProjects>=5&&e.turn>50),[new x("energy_policy_shift","Zmiana polityki energetycznej","Rz\u0105d og\u0142asza ambitny plan transformacji energetycznej z naciskiem na OZE. To mo\u017ce by\u0107 szansa dla Twojej firmy.",180,{marketGrowth:.2,subsidiesIncrease:.15,publicOpinion:20}),new N("public_debate","Debata publiczna o OZE","W ca\u0142ym kraju toczy si\u0119 intensywna debata o przysz\u0142o\u015bci energetyki. Tw\xf3j g\u0142os mo\u017ce by\u0107 znacz\u0105cy.",90,{decision:[{id:"advocate",label:"Aktywnie wspieraj zmiany",effect:{publicVisibility:.3,politicalInfluence:.2,cost:5e5}},{id:"neutral",label:"Zachowaj neutralno\u015b\u0107",effect:{}}]}),new w("investment_boom","Boom inwestycyjny w OZE","Banki i fundusze inwestycyjne masowo kieruj\u0105 kapita\u0142 w stron\u0119 zielonej energii.",365,{financingCost:.8,investorInterest:.4,competitionIntensity:1.3}),new z("new_regulations","Nowe regulacje OZE","Parlament przyj\u0105\u0142 pakiet ustaw znacz\u0105co upraszczaj\u0105cych procedury dla projekt\xf3w odnawialnych.",730,{permitTime:.6,gridConnectionEase:1.4,complianceRequirements:["Konieczno\u015b\u0107 certyfikacji zr\xf3wnowa\u017conego rozwoju","Obowi\u0105zkowy udzia\u0142 spo\u0142eczno\u015bci lokalnej w zyskach","Roczne audyty \u015brodowiskowe"]}),new class extends v{constructor(e,t,n,i,r){super(e,t,n,i,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null),this.type="market",this.effects=r}getEffect(){return this.effects}}("market_maturity","Dojrza\u0142o\u015b\u0107 rynku OZE","Polski rynek OZE osi\u0105gn\u0105\u0142 dojrza\u0142o\u015b\u0107. Konkurencja jest intensywna, ale stabilne zasady gry tworz\u0105 przewidywalne \u015brodowisko biznesowe.",null,{marketStability:.4,profitMargins:.85,innovationPremium:.25})]);const B=(0,i.createContext)(),$={events:[{id:"initial-event-1",type:"economic_event",title:"Pocz\u0105tek dzia\u0142alno\u015bci",description:"Rozpoczynasz swoj\u0105 przygod\u0119 w sektorze OZE. Powodzenia!",severity:"positive",turn:1,expires:10},{id:"initial-event-2",type:"staff_event",title:"Zatrudnienie pierwszych pracownik\xf3w",description:"Czas zbudowa\u0107 zesp\xf3\u0142, kt\xf3ry b\u0119dzie realizowa\u0142 Twoje projekty.",severity:"info",turn:1,expires:8},{id:"initial-event-3",type:"project_event",title:"Rynek OZE w Polsce",description:"Rynek OZE w Polsce dynamicznie si\u0119 rozwija. To dobry moment na inwestycje.",severity:"info",turn:1,expires:12}],filters:{type:"all",severity:"all",staffId:null,projectId:null}};function W(e,t){switch(t.type){case"ADD_EVENT":{let n=[...e.events];if(n.length>=20&&(n.sort(((e,t)=>"info"===e.severity&&"info"!==t.severity?-1:"info"!==e.severity&&"info"===t.severity?1:e.turn-t.turn)),n.shift()),"info"===t.payload.severity){if(n.filter((e=>"info"===e.severity)).length>=5){const e=n.findIndex((e=>"info"===e.severity));-1!==e&&n.splice(e,1)}}if("staff_event"===(t.payload.type||"other")){if(n.filter((e=>"staff_event"===e.type)).length>=3){const e=n.findIndex((e=>"staff_event"===e.type));-1!==e&&n.splice(e,1)}}return{...e,events:[...n,t.payload]}}case"REMOVE_EVENT":return{...e,events:e.events.filter((e=>e.id!==t.payload))};case"CLEAR_EXPIRED_EVENTS":return{...e,events:e.events.filter((e=>!e.expires||e.expires>t.payload.currentTurn))};case"SET_FILTER":return{...e,filters:{...e.filters,[t.payload.filterType]:t.payload.value}};case"CLEAR_FILTERS":return{...e,filters:{type:"all",severity:"all",staffId:null,projectId:null}};case"LIMIT_EVENTS":{let t=[...e.events];t.length>20&&(t.sort(((e,t)=>"project_event"===e.type&&"project_event"!==t.type?1:"project_event"!==e.type&&"project_event"===t.type||"staff_event"===e.type&&"staff_event"!==t.type?-1:"staff_event"!==e.type&&"staff_event"===t.type?1:"info"===e.severity&&"info"!==t.severity?-1:"info"!==e.severity&&"info"===t.severity?1:e.turn-t.turn)),t=t.slice(t.length-20));const n=t.filter((e=>"info"===e.severity));if(n.length>5){n.sort(((e,t)=>e.turn-t.turn));const e=n.slice(0,n.length-5).map((e=>e.id));t=t.filter((t=>!("info"===t.severity&&e.includes(t.id))))}const i=t.filter((e=>"staff_event"===e.type));if(i.length>3){i.sort(((e,t)=>e.turn-t.turn));const e=new Set(i.slice(0,i.length-3).map((e=>e.id)));t=t.filter((t=>"staff_event"!==t.type||!e.has(t.id)))}return{...e,events:t}}default:return e}}function q(e){let{children:t}=e;const[n,r]=(0,i.useReducer)(W,$);return(0,a.jsx)(B.Provider,{value:{state:n,dispatch:r},children:t})}function H(){const e=(0,i.useContext)(B);if(!e)throw new Error("useEventsContext must be used within an EventsProvider");return e}const K=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296===(64512&r)&&i+1<e.length&&56320===(64512&e.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++i)),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t},G={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<e.length;r+=3){const t=e[r],a=r+1<e.length,s=a?e[r+1]:0,o=r+2<e.length,l=o?e[r+2]:0,c=t>>2,d=(3&t)<<4|s>>4;let u=(15&s)<<2|l>>6,h=63&l;o||(h=64,a||(u=64)),i.push(n[c],n[d],n[u],n[h])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(K(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const a=e[n++];t[i++]=String.fromCharCode((31&r)<<6|63&a)}else if(r>239&&r<365){const a=((7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[i++]=String.fromCharCode(55296+(a>>10)),t[i++]=String.fromCharCode(56320+(1023&a))}else{const a=e[n++],s=e[n++];t[i++]=String.fromCharCode((15&r)<<12|(63&a)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<e.length;){const t=n[e.charAt(r++)],a=r<e.length?n[e.charAt(r)]:0;++r;const s=r<e.length?n[e.charAt(r)]:64;++r;const o=r<e.length?n[e.charAt(r)]:64;if(++r,null==t||null==a||null==s||null==o)throw new Q;const l=t<<2|a>>4;if(i.push(l),64!==s){const e=a<<4&240|s>>2;if(i.push(e),64!==o){const e=s<<6&192|o;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Q extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Z=function(e){return function(e){const t=K(e);return G.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Y=function(e){try{return G.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};const J=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,X=()=>{try{return J()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/oze-developer-manager",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_NODE_ENV:"development"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&Y(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},ee=e=>{var t,n;return null===(n=null===(t=X())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},te=()=>{var e;return null===(e=X())||void 0===e?void 0:e.config},ne=e=>{var t;return null===(t=X())||void 0===t?void 0:t[`_${e}`]};class ie{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function re(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function ae(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function se(){return!function(){var e;const t=null===(e=X())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(i){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function oe(){try{return"object"===typeof indexedDB}catch(e){return!1}}function le(){return new Promise(((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var e;t((null===(e=r.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}))}class ce extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,ce.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,de.prototype.create)}}class de{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,i=this.errors[e],r=i?function(e,t){return e.replace(ue,((e,n)=>{const i=t[n];return null!=i?String(i):`<${n}?>`}))}(i,t):"Error",a=`${this.serviceName}: ${r} (${n}).`;return new ce(n,a,t)}}const ue=/\{\$([^}]+)}/g;function he(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const n=e[r],a=t[r];if(pe(n)&&pe(a)){if(!he(n,a))return!1}else if(n!==a)return!1}for(const r of i)if(!n.includes(r))return!1;return!0}function pe(e){return null!==e&&"object"===typeof e}function me(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function fe(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,i]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(i)}})),t}function ye(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class ge{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=ve),void 0===i.error&&(i.error=ve),void 0===i.complete&&(i.complete=ve);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(e){}})),this.observers.push(i),r}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function ve(){}function we(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3)*Math.pow(t,e),i=Math.round(.5*n*(Math.random()-.5)*2);return Math.min(144e5,n+i)}function xe(e){return e&&e._delegate?e._delegate:e}class be{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const je="[DEFAULT]";class ke{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new ie;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),i=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(i)return null;throw r}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:je})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:i});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[r,a]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(r)&&a.resolve(i)}return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(e),this.onInitCallbacks.set(i,r);const a=this.instances.get(i);return a&&e(a,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(i){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(r=t,r===je?void 0:r),options:n}),this.instances.set(t,i),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch(a){}var r;return i||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je;return this.component?this.component.multipleInstances?e:je:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Ne{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new ke(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const ze=[];var _e;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(_e||(_e={}));const Se={debug:_e.DEBUG,verbose:_e.VERBOSE,info:_e.INFO,warn:_e.WARN,error:_e.ERROR,silent:_e.SILENT},Ee=_e.INFO,Ce={[_e.DEBUG]:"log",[_e.VERBOSE]:"log",[_e.INFO]:"info",[_e.WARN]:"warn",[_e.ERROR]:"error"},Te=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),i=Ce[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var r=arguments.length,a=new Array(r>2?r-2:0),s=2;s<r;s++)a[s-2]=arguments[s];console[i](`[${n}]  ${e.name}:`,...a)};class Pe{constructor(e){this.name=e,this._logLevel=Ee,this._logHandler=Te,this._userLogHandler=null,ze.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in _e))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?Se[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,_e.DEBUG,...t),this._logHandler(this,_e.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,_e.VERBOSE,...t),this._logHandler(this,_e.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,_e.INFO,...t),this._logHandler(this,_e.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,_e.WARN,...t),this._logHandler(this,_e.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,_e.ERROR,...t),this._logHandler(this,_e.ERROR,...t)}}let Ie,Ae;const Me=new WeakMap,De=new WeakMap,Re=new WeakMap,Oe=new WeakMap,Le=new WeakMap;let Fe={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return De.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Re.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Be(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Ue(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Ae||(Ae=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.apply($e(this),n),Be(Me.get(this))}:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return Be(e.apply($e(this),n))}:function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];const a=e.call($e(this),t,...i);return Re.set(a,t.sort?t.sort():[t]),Be(a)}}function Ve(e){return"function"===typeof e?Ue(e):(e instanceof IDBTransaction&&function(e){if(De.has(e))return;const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",a),e.removeEventListener("abort",a)},r=()=>{t(),i()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",r),e.addEventListener("error",a),e.addEventListener("abort",a)}));De.set(e,t)}(e),t=e,(Ie||(Ie=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,Fe):e);var t}function Be(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("success",r),e.removeEventListener("error",a)},r=()=>{t(Be(e.result)),i()},a=()=>{n(e.error),i()};e.addEventListener("success",r),e.addEventListener("error",a)}));return t.then((t=>{t instanceof IDBCursor&&Me.set(t,e)})).catch((()=>{})),Le.set(t,e),t}(e);if(Oe.has(e))return Oe.get(e);const t=Ve(e);return t!==e&&(Oe.set(e,t),Le.set(t,e)),t}const $e=e=>Le.get(e);function We(e,t){let{blocked:n,upgrade:i,blocking:r,terminated:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=indexedDB.open(e,t),o=Be(s);return i&&s.addEventListener("upgradeneeded",(e=>{i(Be(s.result),e.oldVersion,e.newVersion,Be(s.transaction),e)})),n&&s.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),o.then((e=>{a&&e.addEventListener("close",(()=>a())),r&&e.addEventListener("versionchange",(e=>r(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}const qe=["get","getKey","getAll","getAllKeys","count"],He=["put","add","delete","clear"],Ke=new Map;function Ge(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(Ke.get(t))return Ke.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=He.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!qe.includes(n))return;const a=async function(e){const t=this.transaction(e,r?"readwrite":"readonly");let a=t.store;for(var s=arguments.length,o=new Array(s>1?s-1:0),l=1;l<s;l++)o[l-1]=arguments[l];return i&&(a=a.index(o.shift())),(await Promise.all([a[n](...o),r&&t.done]))[0]};return Ke.set(t,a),a}Fe=(e=>({...e,get:(t,n,i)=>Ge(t,n)||e.get(t,n,i),has:(t,n)=>!!Ge(t,n)||e.has(t,n)}))(Fe);class Qe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const Ze="@firebase/app",Ye="0.10.13",Je=new Pe("@firebase/app"),Xe="@firebase/app-compat",et="@firebase/analytics-compat",tt="@firebase/analytics",nt="@firebase/app-check-compat",it="@firebase/app-check",rt="@firebase/auth",at="@firebase/auth-compat",st="@firebase/database",ot="@firebase/data-connect",lt="@firebase/database-compat",ct="@firebase/functions",dt="@firebase/functions-compat",ut="@firebase/installations",ht="@firebase/installations-compat",pt="@firebase/messaging",mt="@firebase/messaging-compat",ft="@firebase/performance",yt="@firebase/performance-compat",gt="@firebase/remote-config",vt="@firebase/remote-config-compat",wt="@firebase/storage",xt="@firebase/storage-compat",bt="@firebase/firestore",jt="@firebase/vertexai-preview",kt="@firebase/firestore-compat",Nt="firebase",zt="[DEFAULT]",_t={[Ze]:"fire-core",[Xe]:"fire-core-compat",[tt]:"fire-analytics",[et]:"fire-analytics-compat",[it]:"fire-app-check",[nt]:"fire-app-check-compat",[rt]:"fire-auth",[at]:"fire-auth-compat",[st]:"fire-rtdb",[ot]:"fire-data-connect",[lt]:"fire-rtdb-compat",[ct]:"fire-fn",[dt]:"fire-fn-compat",[ut]:"fire-iid",[ht]:"fire-iid-compat",[pt]:"fire-fcm",[mt]:"fire-fcm-compat",[ft]:"fire-perf",[yt]:"fire-perf-compat",[gt]:"fire-rc",[vt]:"fire-rc-compat",[wt]:"fire-gcs",[xt]:"fire-gcs-compat",[bt]:"fire-fst",[kt]:"fire-fst-compat",[jt]:"fire-vertex","fire-js":"fire-js",[Nt]:"fire-js-all"},St=new Map,Et=new Map,Ct=new Map;function Tt(e,t){try{e.container.addComponent(t)}catch(n){Je.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Pt(e){const t=e.name;if(Ct.has(t))return Je.debug(`There were multiple attempts to register component ${t}.`),!1;Ct.set(t,e);for(const n of St.values())Tt(n,e);for(const n of Et.values())Tt(n,e);return!0}function It(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function At(e){return void 0!==e.settings}const Mt=new de("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Dt{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new be("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Mt.create("app-deleted",{appName:this._name})}}const Rt="10.14.1";function Ot(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const i=Object.assign({name:zt,automaticDataCollectionEnabled:!1},t),r=i.name;if("string"!==typeof r||!r)throw Mt.create("bad-app-name",{appName:String(r)});if(n||(n=te()),!n)throw Mt.create("no-options");const a=St.get(r);if(a){if(he(n,a.options)&&he(i,a.config))return a;throw Mt.create("duplicate-app",{appName:r})}const s=new Ne(r);for(const l of Ct.values())s.addComponent(l);const o=new Dt(n,i,s);return St.set(r,o),o}function Lt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zt;const t=St.get(e);if(!t&&e===zt&&te())return Ot();if(!t)throw Mt.create("no-app",{appName:e});return t}function Ft(e,t,n){var i;let r=null!==(i=_t[e])&&void 0!==i?i:e;n&&(r+=`-${n}`);const a=r.match(/\s|\//),s=t.match(/\s|\//);if(a||s){const e=[`Unable to register library "${r}" with version "${t}":`];return a&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),a&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Je.warn(e.join(" "))}Pt(new be(`${r}-version`,(()=>({library:r,version:t})),"VERSION"))}const Ut="firebase-heartbeat-store";let Vt=null;function Bt(){return Vt||(Vt=We("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Ut)}catch(n){console.warn(n)}}}).catch((e=>{throw Mt.create("idb-open",{originalErrorMessage:e.message})}))),Vt}async function $t(e,t){try{const n=(await Bt()).transaction(Ut,"readwrite"),i=n.objectStore(Ut);await i.put(t,Wt(e)),await n.done}catch(n){if(n instanceof ce)Je.warn(n.message);else{const e=Mt.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});Je.warn(e.message)}}}function Wt(e){return`${e.name}!${e.options.appId}`}class qt{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Kt(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Ht();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some((e=>e.date===i)))return;return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}catch(n){Je.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=Ht(),{heartbeatsToSend:n,unsentEntries:i}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let i=e.slice();for(const r of e){const e=n.find((e=>e.agent===r.agent));if(e){if(e.dates.push(r.date),Gt(n)>t){e.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Gt(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),r=Z(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return Je.warn(t),""}}}function Ht(){return(new Date).toISOString().substring(0,10)}class Kt{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!oe()&&le().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await Bt()).transaction(Ut),n=await t.objectStore(Ut).get(Wt(e));return await t.done,n}catch(t){if(t instanceof ce)Je.warn(t.message);else{const e=Mt.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});Je.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return $t(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return $t(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Gt(e){return Z(JSON.stringify({version:2,heartbeats:e})).length}var Qt;Qt="",Pt(new be("platform-logger",(e=>new Qe(e)),"PRIVATE")),Pt(new be("heartbeat",(e=>new qt(e)),"PRIVATE")),Ft(Ze,Ye,Qt),Ft(Ze,Ye,"esm2017"),Ft("fire-js","");Ft("firebase","10.14.1","app");function Zt(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function Yt(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Jt=Yt,Xt=new de("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),en=new Pe("@firebase/auth");function tn(e){if(en.logLevel<=_e.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];en.error(`Auth (${Rt}): ${e}`,...n)}}function nn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];throw on(e,...n)}function rn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return on(e,...n)}function an(e,t,n){const i=Object.assign(Object.assign({},Jt()),{[t]:n});return new de("auth","Firebase",i).create(t,{appName:e.name})}function sn(e){return an(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function on(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if("string"!==typeof e){const t=n[0],i=[...n.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(t,...i)}return Xt.create(e,...n)}function ln(e,t){if(!e){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];throw on(t,...i)}}function cn(e){const t="INTERNAL ASSERTION FAILED: "+e;throw tn(t),new Error(t)}function dn(e,t){e||cn(t)}function un(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function hn(){return"http:"===pn()||"https:"===pn()}function pn(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class mn{constructor(e,t){this.shortDelay=e,this.longDelay=t,dn(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(re())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(hn()||ae()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function fn(e,t){dn(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class yn{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void cn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void cn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void cn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const gn={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},vn=new mn(3e4,6e4);function wn(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function xn(e,t,n,i){return bn(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let r={},a={};i&&("GET"===t?a=i:r={body:JSON.stringify(i)});const s=me(Object.assign({key:e.config.apiKey},a)).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:o},r);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),yn.fetch()(kn(e,e.config.apiHost,n,s),l)}))}async function bn(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},gn),t);try{const t=new zn(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const a=await r.json();if("needConfirmation"in a)throw _n(e,"account-exists-with-different-credential",a);if(r.ok&&!("errorMessage"in a))return a;{const t=r.ok?a.errorMessage:a.error.message,[n,s]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw _n(e,"credential-already-in-use",a);if("EMAIL_EXISTS"===n)throw _n(e,"email-already-in-use",a);if("USER_DISABLED"===n)throw _n(e,"user-disabled",a);const o=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw an(e,o,s);nn(e,o)}}catch(r){if(r instanceof ce)throw r;nn(e,"network-request-failed",{message:String(r)})}}async function jn(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const a=await xn(e,t,n,i,r);return"mfaPendingCredential"in a&&nn(e,"multi-factor-auth-required",{_serverResponse:a}),a}function kn(e,t,n,i){const r=`${t}${n}?${i}`;return e.config.emulator?fn(e.config,r):`${e.config.apiScheme}://${r}`}function Nn(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class zn{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(rn(this.auth,"network-request-failed"))),vn.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function _n(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=rn(e,t,i);return r.customData._tokenResponse=n,r}function Sn(e){return void 0!==e&&void 0!==e.enterprise}class En{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Nn(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function Cn(e,t){return xn(e,"GET","/v2/recaptchaConfig",wn(e,t))}async function Tn(e,t){return xn(e,"POST","/v1/accounts:lookup",t)}function Pn(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function In(e){return 1e3*Number(e)}function An(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return tn("JWT malformed, contained fewer than 3 sections"),null;try{const e=Y(n);return e?JSON.parse(e):(tn("Failed to decode base64 JWT payload"),null)}catch(r){return tn("Caught error parsing JWT payload as JSON",null===r||void 0===r?void 0:r.toString()),null}}function Mn(e){const t=An(e);return ln(t,"internal-error"),ln("undefined"!==typeof t.exp,"internal-error"),ln("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Dn(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof ce&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class Rn{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null===e||void 0===e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class On{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Pn(this.lastLoginAt),this.creationTime=Pn(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Ln(e){var t;const n=e.auth,i=await e.getIdToken(),r=await Dn(e,Tn(n,{idToken:i}));ln(null===r||void 0===r?void 0:r.users.length,n,"internal-error");const a=r.users[0];e._notifyReloadListener(a);const s=(null===(t=a.providerUserInfo)||void 0===t?void 0:t.length)?Fn(a.providerUserInfo):[],o=(l=e.providerData,c=s,[...l.filter((e=>!c.some((t=>t.providerId===e.providerId)))),...c]);var l,c;const d=e.isAnonymous,u=!(e.email&&a.passwordHash)&&!(null===o||void 0===o?void 0:o.length),h=!!d&&u,p={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new On(a.createdAt,a.lastLoginAt),isAnonymous:h};Object.assign(e,p)}function Fn(e){return e.map((e=>{var{providerId:t}=e,n=Zt(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class Un{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ln(e.idToken,"internal-error"),ln("undefined"!==typeof e.idToken,"internal-error"),ln("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):Mn(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ln(0!==e.length,"internal-error");const t=Mn(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(ln(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(e,t){const n=await bn(e,{},(async()=>{const n=me({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:r}=e.config,a=kn(e,i,"/v1/token",`key=${r}`),s=await e._getAdditionalHeaders();return s["Content-Type"]="application/x-www-form-urlencoded",yn.fetch()(a,{method:"POST",headers:s,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,a=new Un;return n&&(ln("string"===typeof n,"internal-error",{appName:e}),a.refreshToken=n),i&&(ln("string"===typeof i,"internal-error",{appName:e}),a.accessToken=i),r&&(ln("number"===typeof r,"internal-error",{appName:e}),a.expirationTime=r),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Un,this.toJSON())}_performRefresh(){return cn("not implemented")}}function Vn(e,t){ln("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class Bn{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,r=Zt(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Rn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new On(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Dn(this,this.stsTokenManager.getToken(this.auth,e));return ln(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=xe(e),i=await n.getIdToken(t),r=An(i);ln(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const a="object"===typeof r.firebase?r.firebase:void 0,s=null===a||void 0===a?void 0:a.sign_in_provider;return{claims:r,token:i,authTime:Pn(In(r.auth_time)),issuedAtTime:Pn(In(r.iat)),expirationTime:Pn(In(r.exp)),signInProvider:s||null,signInSecondFactor:(null===a||void 0===a?void 0:a.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=xe(e);await Ln(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(ln(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Bn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ln(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Ln(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(At(this.auth.app))return Promise.reject(sn(this.auth));const e=await this.getIdToken();return await Dn(this,async function(e,t){return xn(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,a,s,o,l,c;const d=null!==(n=t.displayName)&&void 0!==n?n:void 0,u=null!==(i=t.email)&&void 0!==i?i:void 0,h=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,p=null!==(a=t.photoURL)&&void 0!==a?a:void 0,m=null!==(s=t.tenantId)&&void 0!==s?s:void 0,f=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,y=null!==(l=t.createdAt)&&void 0!==l?l:void 0,g=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:w,isAnonymous:x,providerData:b,stsTokenManager:j}=t;ln(v&&j,e,"internal-error");const k=Un.fromJSON(this.name,j);ln("string"===typeof v,e,"internal-error"),Vn(d,e.name),Vn(u,e.name),ln("boolean"===typeof w,e,"internal-error"),ln("boolean"===typeof x,e,"internal-error"),Vn(h,e.name),Vn(p,e.name),Vn(m,e.name),Vn(f,e.name),Vn(y,e.name),Vn(g,e.name);const N=new Bn({uid:v,auth:e,email:u,emailVerified:w,displayName:d,isAnonymous:x,photoURL:p,phoneNumber:h,tenantId:m,stsTokenManager:k,createdAt:y,lastLoginAt:g});return b&&Array.isArray(b)&&(N.providerData=b.map((e=>Object.assign({},e)))),f&&(N._redirectEventId=f),N}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=new Un;i.updateFromServerResponse(t);const r=new Bn({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Ln(r),r}static async _fromGetAccountInfoResponse(e,t,n){const i=t.users[0];ln(void 0!==i.localId,"internal-error");const r=void 0!==i.providerUserInfo?Fn(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(null===r||void 0===r?void 0:r.length),s=new Un;s.updateFromIdToken(n);const o=new Bn({uid:i.localId,auth:e,stsTokenManager:s,isAnonymous:a}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new On(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(null===r||void 0===r?void 0:r.length)};return Object.assign(o,l),o}}const $n=new Map;function Wn(e){dn(e instanceof Function,"Expected a class definition");let t=$n.get(e);return t?(dn(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,$n.set(e,t),t)}class qn{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}qn.type="NONE";const Hn=qn;function Kn(e,t,n){return`firebase:${e}:${t}:${n}`}class Gn{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=Kn(this.userKey,i.apiKey,r),this.fullPersistenceKey=Kn("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Bn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new Gn(Wn(Hn),e,n);const i=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let r=i[0]||Wn(Hn);const a=Kn(n,e.config.apiKey,e.name);let s=null;for(const c of t)try{const t=await c._get(a);if(t){const n=Bn._fromJSON(e,t);c!==r&&(s=n),r=c;break}}catch(l){}const o=i.filter((e=>e._shouldAllowMigration));return r._shouldAllowMigration&&o.length?(r=o[0],s&&await r._set(a,s.toJSON()),await Promise.all(t.map((async e=>{if(e!==r)try{await e._remove(a)}catch(l){}}))),new Gn(r,e,n)):new Gn(r,e,n)}}function Qn(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Xn(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Zn(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ti(t))return"Blackberry";if(ni(t))return"Webos";if(Yn(t))return"Safari";if((t.includes("chrome/")||Jn(t))&&!t.includes("edge/"))return"Chrome";if(ei(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function Zn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re();return/firefox\//i.test(e)}function Yn(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:re()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Jn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re();return/crios\//i.test(e)}function Xn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re();return/iemobile/i.test(e)}function ei(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re();return/android/i.test(e)}function ti(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re();return/blackberry/i.test(e)}function ni(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re();return/webos/i.test(e)}function ii(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function ri(){return function(){const e=re();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function ai(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re();return ii(e)||ei(e)||ni(e)||ti(e)||/windows phone/i.test(e)||Xn(e)}function si(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Qn(re());break;case"Worker":t=`${Qn(re())}-${e}`;break;default:t=e}const i=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${Rt}/${i}`}class oi{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,i)=>{try{n(e(t))}catch(r){i(r)}}));n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(i){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class li{constructor(e){var t,n,i,r;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=a.minPasswordLength)&&void 0!==t?t:6,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),void 0!==a.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),void 0!==a.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),void 0!==a.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),void 0!==a.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(r=e.forceUpgradeOnSignin)&&void 0!==r&&r,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,i,r,a,s;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(i=o.containsLowercaseLetter)||void 0===i||i),o.isValid&&(o.isValid=null===(r=o.containsUppercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(a=o.containsNumericCharacter)||void 0===a||a),o.isValid&&(o.isValid=null===(s=o.containsNonAlphanumericCharacter)||void 0===s||s),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}class ci{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ui(this),this.idTokenSubscription=new ui(this),this.beforeStateQueue=new oi(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Xt,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Wn(t)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Gn.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(r){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Tn(this,{idToken:e}),n=await Bn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(At(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,a=null===i||void 0===i?void 0:i._redirectEventId,s=await this.tryRedirectSignIn(e);n&&n!==a||!(null===s||void 0===s?void 0:s.user)||(i=s.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(a)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ln(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ln(e)}catch(t){if("auth/network-request-failed"!==(null===t||void 0===t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(At(this.app))return Promise.reject(sn(this));const t=e?xe(e):null;return t&&ln(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&ln(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return At(this.app)?Promise.reject(sn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return At(this.app)?Promise.reject(sn(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(Wn(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return xn(e,"GET","/v2/passwordPolicy",wn(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new li(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new de("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return xn(e,"POST","/v2/accounts:revokeToken",wn(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Wn(e)||this._popupRedirectResolver;ln(t,this,"argument-error"),this.redirectPersistenceManager=await Gn.create(this,[Wn(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"===typeof t?t:t.next.bind(t);let a=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(ln(s,this,"internal-error"),s.then((()=>{a||r(this.currentUser)})),"function"===typeof t){const r=e.addObserver(t,n,i);return()=>{a=!0,r()}}{const n=e.addObserver(t);return()=>{a=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ln(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=si(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(en.logLevel<=_e.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];en.warn(`Auth (${Rt}): ${e}`,...n)}}(`Error while retrieving App Check token: ${t.error}`),null===t||void 0===t?void 0:t.token}}function di(e){return xe(e)}class ui{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new ge(e,t);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return ln(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let hi={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function pi(e){return hi.loadJS(e)}function mi(e){return`__${e}${Math.floor(1e6*Math.random())}`}class fi{constructor(e){this.type="recaptcha-enterprise",this.auth=di(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,i){const r=window.grecaptcha;Sn(r)?r.enterprise.ready((()=>{r.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,i)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{Cn(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new En(i);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((r=>{if(!t&&Sn(window.grecaptcha))n(r,e,i);else{if("undefined"===typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));let t=hi.recaptchaEnterpriseScript;0!==t.length&&(t+=r),pi(t).then((()=>{n(r,e,i)})).catch((e=>{i(e)}))}})).catch((e=>{i(e)}))}))}}async function yi(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=new fi(e);let a;try{a=await r.verify(n)}catch(o){a=await r.verify(n,!0)}const s=Object.assign({},t);return i?Object.assign(s,{captchaResp:a}):Object.assign(s,{captchaResponse:a}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}async function gi(e,t,n,i){var r;if(null===(r=e._getRecaptchaConfig())||void 0===r?void 0:r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const r=await yi(e,t,n,"getOobCode"===n);return i(e,r)}return i(e,t).catch((async r=>{if("auth/missing-recaptcha-token"===r.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const r=await yi(e,t,n,"getOobCode"===n);return i(e,r)}return Promise.reject(r)}))}function vi(e,t,n){const i=di(e);ln(i._canInitEmulator,i,"emulator-config-failed"),ln(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!!(null===n||void 0===n?void 0:n.disableWarnings),a=wi(t),{host:s,port:o}=function(e){const t=wi(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const e=r[1];return{host:e,port:xi(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:xi(t)}}}(t),l=null===o?"":`:${o}`;i.config.emulator={url:`${a}//${s}${l}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:s,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function wi(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function xi(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class bi{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return cn("not implemented")}_getIdTokenResponse(e){return cn("not implemented")}_linkToIdToken(e,t){return cn("not implemented")}_getReauthenticationResolver(e){return cn("not implemented")}}async function ji(e,t){return xn(e,"POST","/v1/accounts:signUp",t)}async function ki(e,t){return jn(e,"POST","/v1/accounts:signInWithPassword",wn(e,t))}class Ni extends bi{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Ni(e,t,"password")}static _fromEmailAndCode(e,t){return new Ni(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return gi(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",ki);case"emailLink":return async function(e,t){return jn(e,"POST","/v1/accounts:signInWithEmailLink",wn(e,t))}(e,{email:this._email,oobCode:this._password});default:nn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return gi(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ji);case"emailLink":return async function(e,t){return jn(e,"POST","/v1/accounts:signInWithEmailLink",wn(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:nn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function zi(e,t){return jn(e,"POST","/v1/accounts:signInWithIdp",wn(e,t))}class _i extends bi{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new _i(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):nn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,r=Zt(t,["providerId","signInMethod"]);if(!n||!i)return null;const a=new _i(n,i);return a.idToken=r.idToken||void 0,a.accessToken=r.accessToken||void 0,a.secret=r.secret,a.nonce=r.nonce,a.pendingToken=r.pendingToken||null,a}_getIdTokenResponse(e){return zi(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,zi(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,zi(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=me(t)}return e}}const Si={USER_NOT_FOUND:"user-not-found"};class Ei extends bi{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Ei({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Ei({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return jn(e,"POST","/v1/accounts:signInWithPhoneNumber",wn(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await jn(e,"POST","/v1/accounts:signInWithPhoneNumber",wn(e,t));if(n.temporaryProof)throw _n(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return jn(e,"POST","/v1/accounts:signInWithPhoneNumber",wn(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Si)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}=e;return n||t||i||r?new Ei({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class Ci{constructor(e){var t,n,i,r,a,s;const o=fe(ye(e)),l=null!==(t=o.apiKey)&&void 0!==t?t:null,c=null!==(n=o.oobCode)&&void 0!==n?n:null,d=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=o.mode)&&void 0!==i?i:null);ln(l&&c&&d,"argument-error"),this.apiKey=l,this.operation=d,this.code=c,this.continueUrl=null!==(r=o.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(a=o.languageCode)&&void 0!==a?a:null,this.tenantId=null!==(s=o.tenantId)&&void 0!==s?s:null}static parseLink(e){const t=function(e){const t=fe(ye(e)).link,n=t?fe(ye(t)).deep_link_id:null,i=fe(ye(e)).deep_link_id;return(i?fe(ye(i)).link:null)||i||n||t||e}(e);try{return new Ci(t)}catch(n){return null}}}class Ti{constructor(){this.providerId=Ti.PROVIDER_ID}static credential(e,t){return Ni._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Ci.parseLink(t);return ln(n,"argument-error"),Ni._fromEmailAndCode(e,n.code,n.tenantId)}}Ti.PROVIDER_ID="password",Ti.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Ti.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Pi{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ii extends Pi{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ai extends Ii{constructor(){super("facebook.com")}static credential(e){return _i._fromParams({providerId:Ai.PROVIDER_ID,signInMethod:Ai.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ai.credentialFromTaggedObject(e)}static credentialFromError(e){return Ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Ai.credential(t.oauthAccessToken)}catch(n){return null}}}Ai.FACEBOOK_SIGN_IN_METHOD="facebook.com",Ai.PROVIDER_ID="facebook.com";class Mi extends Ii{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return _i._fromParams({providerId:Mi.PROVIDER_ID,signInMethod:Mi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Mi.credentialFromTaggedObject(e)}static credentialFromError(e){return Mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:i}=t;if(!n&&!i)return null;try{return Mi.credential(n,i)}catch(r){return null}}}Mi.GOOGLE_SIGN_IN_METHOD="google.com",Mi.PROVIDER_ID="google.com";class Di extends Ii{constructor(){super("github.com")}static credential(e){return _i._fromParams({providerId:Di.PROVIDER_ID,signInMethod:Di.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Di.credentialFromTaggedObject(e)}static credentialFromError(e){return Di.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Di.credential(t.oauthAccessToken)}catch(n){return null}}}Di.GITHUB_SIGN_IN_METHOD="github.com",Di.PROVIDER_ID="github.com";class Ri extends Ii{constructor(){super("twitter.com")}static credential(e,t){return _i._fromParams({providerId:Ri.PROVIDER_ID,signInMethod:Ri.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ri.credentialFromTaggedObject(e)}static credentialFromError(e){return Ri.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=t;if(!n||!i)return null;try{return Ri.credential(n,i)}catch(r){return null}}}async function Oi(e,t){return jn(e,"POST","/v1/accounts:signUp",wn(e,t))}Ri.TWITTER_SIGN_IN_METHOD="twitter.com",Ri.PROVIDER_ID="twitter.com";class Li{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=await Bn._fromIdTokenResponse(e,n,i),a=Fi(n);return new Li({user:r,providerId:a,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=Fi(n);return new Li({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function Fi(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Ui extends ce{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Ui.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new Ui(e,t,n,i)}}function Vi(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Ui._fromErrorAndOperation(e,n,t,i);throw n}))}async function Bi(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=await Dn(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Li._forOperation(e,"link",i)}async function $i(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:i}=e;if(At(i.app))return Promise.reject(sn(i));const r="reauthenticate";try{const a=await Dn(e,Vi(i,r,t,e),n);ln(a.idToken,i,"internal-error");const s=An(a.idToken);ln(s,i,"internal-error");const{sub:o}=s;return ln(e.uid===o,i,"user-mismatch"),Li._forOperation(e,r,a)}catch(a){throw"auth/user-not-found"===(null===a||void 0===a?void 0:a.code)&&nn(i,"user-mismatch"),a}}async function Wi(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(At(e.app))return Promise.reject(sn(e));const i="signIn",r=await Vi(e,i,t),a=await Li._fromIdTokenResponse(e,i,r);return n||await e._updateCurrentUser(a.user),a}async function qi(e,t){let{displayName:n,photoURL:i}=t;if(void 0===n&&void 0===i)return;const r=xe(e),a={idToken:await r.getIdToken(),displayName:n,photoUrl:i,returnSecureToken:!0},s=await Dn(r,async function(e,t){return xn(e,"POST","/v1/accounts:update",t)}(r.auth,a));r.displayName=s.displayName||null,r.photoURL=s.photoUrl||null;const o=r.providerData.find((e=>{let{providerId:t}=e;return"password"===t}));o&&(o.displayName=r.displayName,o.photoURL=r.photoURL),await r._updateTokensIfNecessary(s)}new WeakMap;const Hi="__sak";class Ki{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Hi,"1"),this.storage.removeItem(Hi),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Gi extends Ki{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ai(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);ri()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Gi.type="LOCAL";const Qi=Gi;class Zi extends Ki{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Zi.type="SESSION";const Yi=Zi;class Ji{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Ji(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:r}=t.data,a=this.handlersMap[i];if(!(null===a||void 0===a?void 0:a.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const s=Array.from(a).map((async e=>e(t.origin,r))),o=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(s);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Xi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let i=0;i<t;i++)n+=Math.floor(10*Math.random());return e+n}Ji.receivers=[];class er{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const i="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,a;return new Promise(((s,o)=>{const l=Xi("",20);i.port1.start();const c=setTimeout((()=>{o(new Error("unsupported_event"))}),n);a={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),r=setTimeout((()=>{o(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),s(t.data.response);break;default:clearTimeout(c),clearTimeout(r),o(new Error("invalid_response"))}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])})).finally((()=>{a&&this.removeMessageHandler(a)}))}}function tr(){return window}function nr(){return"undefined"!==typeof tr().WorkerGlobalScope&&"function"===typeof tr().importScripts}const ir="firebaseLocalStorageDb",rr="firebaseLocalStorage",ar="fbase_key";class sr{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function or(e,t){return e.transaction([rr],t?"readwrite":"readonly").objectStore(rr)}function lr(){const e=indexedDB.open(ir,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(rr,{keyPath:ar})}catch(i){n(i)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(rr)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(ir);return new sr(e).toPromise()}(),t(await lr()))}))}))}async function cr(e,t,n){const i=or(e,!0).put({[ar]:t,value:n});return new sr(i).toPromise()}function dr(e,t){const n=or(e,!0).delete(t);return new sr(n).toPromise()}class ur{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await lr()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return nr()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ji._getInstance(nr()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new er(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await lr();return await cr(e,Hi,"1"),await dr(e,Hi),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>cr(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=or(e,!1).get(t),i=await new sr(n).toPromise();return void 0===i?null:i.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>dr(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=or(e,!1).getAll();return new sr(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}ur.type="LOCAL";const hr=ur;mi("rcb"),new mn(3e4,6e4);const pr="recaptcha";async function mr(e,t,n){var i;const r=await n.verify();try{let a;if(ln("string"===typeof r,e,"argument-error"),ln(n.type===pr,e,"argument-error"),a="string"===typeof t?{phoneNumber:t}:t,"session"in a){const t=a.session;if("phoneNumber"in a){ln("enroll"===t.type,e,"internal-error");const n=await function(e,t){return xn(e,"POST","/v2/accounts/mfaEnrollment:start",wn(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:a.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{ln("signin"===t.type,e,"internal-error");const n=(null===(i=a.multiFactorHint)||void 0===i?void 0:i.uid)||a.multiFactorUid;ln(n,e,"missing-multi-factor-info");const s=await function(e,t){return xn(e,"POST","/v2/accounts/mfaSignIn:start",wn(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return s.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return xn(e,"POST","/v1/accounts:sendVerificationCode",wn(e,t))}(e,{phoneNumber:a.phoneNumber,recaptchaToken:r});return t}}finally{n._reset()}}class fr{constructor(e){this.providerId=fr.PROVIDER_ID,this.auth=di(e)}verifyPhoneNumber(e,t){return mr(this.auth,e,xe(t))}static credential(e,t){return Ei._fromVerification(e,t)}static credentialFromResult(e){const t=e;return fr.credentialFromTaggedObject(t)}static credentialFromError(e){return fr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:i}=t;return n&&i?Ei._fromTokenResponse(n,i):null}}function yr(e,t){return t?Wn(t):(ln(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}fr.PROVIDER_ID="phone",fr.PHONE_SIGN_IN_METHOD="phone";class gr extends bi{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return zi(e,this._buildIdpRequest())}_linkToIdToken(e,t){return zi(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return zi(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function vr(e){return Wi(e.auth,new gr(e),e.bypassAuthState)}function wr(e){const{auth:t,user:n}=e;return ln(n,t,"internal-error"),$i(n,new gr(e),e.bypassAuthState)}async function xr(e){const{auth:t,user:n}=e;return ln(n,t,"internal-error"),Bi(n,new gr(e),e.bypassAuthState)}class br{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:a,type:s}=e;if(a)return void this.reject(a);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return vr;case"linkViaPopup":case"linkViaRedirect":return xr;case"reauthViaPopup":case"reauthViaRedirect":return wr;default:nn(this.auth,"internal-error")}}resolve(e){dn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){dn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const jr=new mn(2e3,1e4);class kr extends br{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,kr.currentPopupAction&&kr.currentPopupAction.cancel(),kr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ln(e,this.auth,"internal-error"),e}async onExecution(){dn(1===this.filter.length,"Popup operations only handle one event");const e=Xi();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(rn(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(rn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,kr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(rn(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,jr.get())};e()}}kr.currentPopupAction=null;const Nr=new Map;class zr extends br{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=Nr.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Er(t),i=Sr(e);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Nr.set(this.auth._key(),e)}return this.bypassAuthState||Nr.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function _r(e,t){Nr.set(e._key(),t)}function Sr(e){return Wn(e._redirectPersistence)}function Er(e){return Kn("pendingRedirect",e.config.apiKey,e.name)}async function Cr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(At(e.app))return Promise.reject(sn(e));const i=di(e),r=yr(i,t),a=new zr(i,r,n),s=await a.execute();return s&&!n&&(delete s.user._redirectEventId,await i._persistUserIfCurrent(s.user),await i._setRedirectUser(null,t)),s}class Tr{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ir(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Ir(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(rn(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Pr(e))}saveEventToCache(e){this.cachedEventUids.add(Pr(e)),this.lastProcessedEventTime=Date.now()}}function Pr(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Ir(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===(null===n||void 0===n?void 0:n.code)}const Ar=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Mr=/^https?/;async function Dr(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return xn(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const i of t)try{if(Rr(i))return}catch(n){}nn(e,"unauthorized-domain")}function Rr(e){const t=un(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!Mr.test(n))return!1;if(Ar.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const Or=new mn(3e4,6e4);function Lr(){const e=tr().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function Fr(e){return new Promise(((t,n)=>{var i,r,a;function s(){Lr(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Lr(),n(rn(e,"network-request-failed"))},timeout:Or.get()})}if(null===(r=null===(i=tr().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=tr().gapi)||void 0===a?void 0:a.load)){const t=mi("iframefcb");return tr()[t]=()=>{gapi.load?s():n(rn(e,"network-request-failed"))},pi(`${hi.gapiScript}?onload=${t}`).catch((e=>n(e)))}s()}})).catch((e=>{throw Ur=null,e}))}let Ur=null;const Vr=new mn(5e3,15e3),Br={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},$r=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Wr(e){const t=e.config;ln(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?fn(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,i={apiKey:t.apiKey,appName:e.name,v:Rt},r=$r.get(e.config.apiHost);r&&(i.eid=r);const a=e._getFrameworks();return a.length&&(i.fw=a.join(",")),`${n}?${me(i).slice(1)}`}async function qr(e){const t=await function(e){return Ur=Ur||Fr(e),Ur}(e),n=tr().gapi;return ln(n,e,"internal-error"),t.open({where:document.body,url:Wr(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Br,dontclear:!0},(t=>new Promise((async(n,i)=>{await t.restyle({setHideOnLeave:!1});const r=rn(e,"network-request-failed"),a=tr().setTimeout((()=>{i(r)}),Vr.get());function s(){tr().clearTimeout(a),n(t)}t.ping(s).then(s,(()=>{i(r)}))}))))}const Hr={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Kr{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Gr(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const a=Math.max((window.screen.availHeight-r)/2,0).toString(),s=Math.max((window.screen.availWidth-i)/2,0).toString();let o="";const l=Object.assign(Object.assign({},Hr),{width:i.toString(),height:r.toString(),top:a,left:s}),c=re().toLowerCase();n&&(o=Jn(c)?"_blank":n),Zn(c)&&(t=t||"http://localhost",l.scrollbars="yes");const d=Object.entries(l).reduce(((e,t)=>{let[n,i]=t;return`${e}${n}=${i},`}),"");if(function(){var e;return ii(arguments.length>0&&void 0!==arguments[0]?arguments[0]:re())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(t||"",o),new Kr(null);const u=window.open(t||"",o,d);ln(u,e,"popup-blocked");try{u.focus()}catch(h){}return new Kr(u)}const Qr="__/auth/handler",Zr="emulator/auth/handler",Yr=encodeURIComponent("fac");async function Jr(e,t,n,i,r,a){ln(e.config.authDomain,e,"auth-domain-config-required"),ln(e.config.apiKey,e,"invalid-api-key");const s={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:Rt,eventId:r};if(t instanceof Pi){t.setDefaultLanguage(e.languageCode),s.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(s.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))s[e]=t}if(t instanceof Ii){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(s.scopes=e.join(","))}e.tenantId&&(s.tid=e.tenantId);const o=s;for(const d of Object.keys(o))void 0===o[d]&&delete o[d];const l=await e._getAppCheckToken(),c=l?`#${Yr}=${encodeURIComponent(l)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${Qr}`;return fn(t,Zr)}(e)}?${me(o).slice(1)}${c}`}const Xr="webStorageSupport";const ea=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Yi,this._completeRedirectFn=Cr,this._overrideRedirectResult=_r}async _openPopup(e,t,n,i){var r;dn(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()");return Gr(e,await Jr(e,t,n,un(),i),Xi())}async _openRedirect(e,t,n,i){await this._originValidation(e);return function(e){tr().location.href=e}(await Jr(e,t,n,un(),i)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(dn(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await qr(e),n=new Tr(e);return t.register("authEvent",(t=>{ln(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Xr,{type:Xr},(n=>{var i;const r=null===(i=null===n||void 0===n?void 0:n[0])||void 0===i?void 0:i[Xr];void 0!==r&&t(!!r),nn(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Dr(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ai()||Yn()||ii()}};var ta="@firebase/auth",na="1.7.9";class ia{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ln(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const ra=ne("authIdTokenMaxAge")||300;let aa=null;var sa;hi={loadJS:e=>new Promise(((t,n)=>{const i=document.createElement("script");i.setAttribute("src",e),i.onload=t,i.onerror=e=>{const t=rn("internal-error");t.customData=e,n(t)},i.type="text/javascript",i.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(i)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},sa="Browser",Pt(new be("auth",((e,t)=>{let{options:n}=t;const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=i.options;ln(s&&!s.includes(":"),"invalid-api-key",{appName:i.name});const l={apiKey:s,authDomain:o,clientPlatform:sa,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:si(sa)},c=new ci(i,r,a,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Wn);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),Pt(new be("auth-internal",(e=>(e=>new ia(e))(di(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Ft(ta,na,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(sa)),Ft(ta,na,"esm2017");var oa,la,ca="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},da={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var i=Array(16);if("string"===typeof t)for(var r=0;16>r;++r)i[r]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],r=e.g[2];var a=e.g[3],s=t+(a^n&(r^a))+i[0]+3614090360&4294967295;s=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=n+(s<<7&4294967295|s>>>25))+((s=a+(r^t&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^a&(t^n))+i[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^r&(a^t))+i[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=t+(a^n&(r^a))+i[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=a+(r^t&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^a&(t^n))+i[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^r&(a^t))+i[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=t+(a^n&(r^a))+i[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=a+(r^t&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^a&(t^n))+i[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^r&(a^t))+i[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=t+(a^n&(r^a))+i[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=a+(r^t&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^a&(t^n))+i[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^r&(a^t))+i[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=t+(r^a&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^r&(t^n))+i[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=r+(t^n&(a^t))+i[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^t&(r^a))+i[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=t+(r^a&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^r&(t^n))+i[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=r+(t^n&(a^t))+i[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^t&(r^a))+i[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=t+(r^a&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^r&(t^n))+i[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=r+(t^n&(a^t))+i[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^t&(r^a))+i[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=t+(r^a&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^r&(t^n))+i[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=r+(t^n&(a^t))+i[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^t&(r^a))+i[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=t+(n^r^a)+i[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=a+(t^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=r+(a^t^n)+i[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^a^t)+i[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^r^a)+i[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=a+(t^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=r+(a^t^n)+i[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^a^t)+i[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^r^a)+i[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=a+(t^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=r+(a^t^n)+i[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^a^t)+i[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^r^a)+i[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=a+(t^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=r+(a^t^n)+i[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^a^t)+i[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=t+(r^(n|~a))+i[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(t|~r))+i[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=r+(t^(a|~n))+i[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=n+(a^(r|~t))+i[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=t+(r^(n|~a))+i[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(t|~r))+i[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=r+(t^(a|~n))+i[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=n+(a^(r|~t))+i[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=t+(r^(n|~a))+i[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(t|~r))+i[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=r+(t^(a|~n))+i[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=n+(a^(r|~t))+i[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((a=(t=n+((s=t+(r^(n|~a))+i[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(t|~r))+i[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((r=a+((s=r+(t^(a|~n))+i[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~t))+i[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(r+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+r&4294967295,e.g[3]=e.g[3]+a&4294967295}function i(e,t){this.h=t;for(var n=[],i=!0,r=e.length-1;0<=r;r--){var a=0|e[r];i&&a==t||(n[r]=a,i=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,i){for(var r=Array(arguments.length-2),a=2;a<arguments.length;a++)r[a-2]=arguments[a];return t.prototype[n].apply(e,r)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var i=t-this.blockSize,r=this.B,a=this.h,s=0;s<t;){if(0==a)for(;s<=i;)n(this,e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(r[a++]=e.charCodeAt(s++),a==this.blockSize){n(this,r),a=0;break}}else for(;s<t;)if(r[a++]=e[s++],a==this.blockSize){n(this,r),a=0;break}}this.h=a,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var i=0;32>i;i+=8)e[n++]=this.g[t]>>>i&255;return e};var r={};function a(e){return-128<=e&&128>e?function(e,t){var n=r;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new i([0|e],0>e?-1:0)})):new i([0|e],0>e?-1:0)}function s(e){if(isNaN(e)||!isFinite(e))return o;if(0>e)return h(s(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new i(t,0)}var o=a(0),l=a(1),c=a(16777216);function d(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function u(e){return-1==e.h}function h(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new i(n,~e.h).add(l)}function p(e,t){return e.add(h(t))}function m(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function f(e,t){this.g=e,this.h=t}function y(e,t){if(d(t))throw Error("division by zero");if(d(e))return new f(o,o);if(u(e))return t=y(h(e),t),new f(h(t.g),h(t.h));if(u(t))return t=y(e,h(t)),new f(h(t.g),t.h);if(30<e.g.length){if(u(e)||u(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,i=t;0>=i.l(e);)n=g(n),i=g(i);var r=v(n,1),a=v(i,1);for(i=v(i,2),n=v(n,2);!d(i);){var c=a.add(i);0>=c.l(e)&&(r=r.add(n),a=c),i=v(i,1),n=v(n,1)}return t=p(e,r.j(t)),new f(r,t)}for(r=o;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),c=(a=s(n)).j(t);u(c)||0<c.l(e);)c=(a=s(n-=i)).j(t);d(a)&&(a=l),r=r.add(a),e=p(e,c)}return new f(r,e)}function g(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new i(n,e.h)}function v(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,a=[],s=0;s<r;s++)a[s]=0<t?e.i(s+n)>>>t|e.i(s+n+1)<<32-t:e.i(s+n);return new i(a,e.h)}(e=i.prototype).m=function(){if(u(this))return-h(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var i=this.i(n);e+=(0<=i?i:4294967296+i)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(d(this))return"0";if(u(this))return"-"+h(this).toString(e);for(var t=s(Math.pow(e,6)),n=this,i="";;){var r=y(n,t).g,a=((0<(n=p(n,r.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(d(n=r))return a+i;for(;6>a.length;)a="0"+a;i=a+i}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return u(e=p(this,e))?-1:d(e)?0:1},e.abs=function(){return u(this)?h(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,a=0;a<=t;a++){var s=r+(65535&this.i(a))+(65535&e.i(a)),o=(s>>>16)+(this.i(a)>>>16)+(e.i(a)>>>16);r=o>>>16,s&=65535,o&=65535,n[a]=o<<16|s}return new i(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(d(this)||d(e))return o;if(u(this))return u(e)?h(this).j(h(e)):h(h(this).j(e));if(u(e))return h(this.j(h(e)));if(0>this.l(c)&&0>e.l(c))return s(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var a=0;a<e.g.length;a++){var l=this.i(r)>>>16,p=65535&this.i(r),f=e.i(a)>>>16,y=65535&e.i(a);n[2*r+2*a]+=p*y,m(n,2*r+2*a),n[2*r+2*a+1]+=l*y,m(n,2*r+2*a+1),n[2*r+2*a+1]+=p*f,m(n,2*r+2*a+1),n[2*r+2*a+2]+=l*f,m(n,2*r+2*a+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new i(n,0)},e.A=function(e){return y(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new i(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new i(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new i(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,la=da.Md5=t,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=s,i.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return h(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=s(Math.pow(n,8)),r=o,a=0;a<t.length;a+=8){var l=Math.min(8,t.length-a),c=parseInt(t.substring(a,a+l),n);8>l?(l=s(Math.pow(n,l)),r=r.j(l).add(s(c))):r=(r=r.j(i)).add(s(c))}return r},oa=da.Integer=i}).apply("undefined"!==typeof ca?ca:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var ua,ha,pa,ma,fa,ya,ga,va,wa="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},xa={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof wa&&wa];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,i){if(i)e:{var r=n;e=e.split(".");for(var a=0;a<e.length-1;a++){var s=e[a];if(!(s in r))break e;r=r[s]}(i=i(a=r[e=e[e.length-1]]))!=a&&null!=i&&t(r,e,{configurable:!0,writable:!0,value:i})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,i=!1,r={next:function(){if(!i&&n<e.length){var r=n++;return{value:t(r,e[r]),done:!1}}return i=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r}(this,(function(e,t){return t}))}}));var i=i||{},r=this||self;function a(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function s(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function d(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function u(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,i){for(var r=Array(arguments.length-2),a=2;a<arguments.length;a++)r[a-2]=arguments[a];return t.prototype[n].apply(e,r)}}function h(e){const t=e.length;if(0<t){const n=Array(t);for(let i=0;i<t;i++)n[i]=e[i];return n}return[]}function p(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(a(t)){const n=e.length||0,i=t.length||0;e.length=n+i;for(let r=0;r<i;r++)e[n+r]=t[r]}else e.push(t)}}function m(e){return/^[\s\xa0]*$/.test(e)}function f(){var e=r.navigator;return e&&(e=e.userAgent)?e:""}function y(e){return y[" "](e),e}y[" "]=function(){};var g=-1!=f().indexOf("Gecko")&&!(-1!=f().toLowerCase().indexOf("webkit")&&-1==f().indexOf("Edge"))&&!(-1!=f().indexOf("Trident")||-1!=f().indexOf("MSIE"))&&-1==f().indexOf("Edge");function v(e,t,n){for(const i in e)t.call(n,e[i],i,e)}function w(e){const t={};for(const n in e)t[n]=e[n];return t}const x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(e,t){let n,i;for(let r=1;r<arguments.length;r++){for(n in i=arguments[r],i)e[n]=i[n];for(let t=0;t<x.length;t++)n=x[t],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}function j(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function k(e){r.setTimeout((()=>{throw e}),0)}function N(){var e=C;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var z=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new _),(e=>e.reset()));class _{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let S,E=!1,C=new class{constructor(){this.h=this.g=null}add(e,t){const n=z.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},T=()=>{const e=r.Promise.resolve(void 0);S=()=>{e.then(P)}};var P=()=>{for(var e;e=N();){try{e.h.call(e.g)}catch(n){k(n)}var t=z;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}E=!1};function I(){this.s=this.s,this.C=this.C}function A(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}I.prototype.s=!1,I.prototype.ma=function(){this.s||(this.s=!0,this.N())},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},A.prototype.h=function(){this.defaultPrevented=!0};var M=function(){if(!r.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};r.addEventListener("test",e,t),r.removeEventListener("test",e,t)}catch(n){}return e}();function D(e,t){if(A.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(g){e:{try{y(t.nodeName);var r=!0;break e}catch(a){}r=!1}r||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:R[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&D.aa.h.call(this)}}u(D,A);var R={2:"touch",3:"pen",4:"mouse"};D.prototype.h=function(){D.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var O="closure_listenable_"+(1e6*Math.random()|0),L=0;function F(e,t,n,i,r){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!i,this.ha=r,this.key=++L,this.da=this.fa=!1}function U(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function V(e){this.src=e,this.g={},this.h=0}function B(e,t){var n=t.type;if(n in e.g){var i,r=e.g[n],a=Array.prototype.indexOf.call(r,t,void 0);(i=0<=a)&&Array.prototype.splice.call(r,a,1),i&&(U(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function $(e,t,n,i){for(var r=0;r<e.length;++r){var a=e[r];if(!a.da&&a.listener==t&&a.capture==!!n&&a.ha==i)return r}return-1}V.prototype.add=function(e,t,n,i,r){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var s=$(e,t,i,r);return-1<s?(t=e[s],n||(t.fa=!1)):((t=new F(t,this.src,a,!!i,r)).fa=n,e.push(t)),t};var W="closure_lm_"+(1e6*Math.random()|0),q={};function H(e,t,n,i,r){if(i&&i.once)return G(e,t,n,i,r);if(Array.isArray(t)){for(var a=0;a<t.length;a++)H(e,t[a],n,i,r);return null}return n=te(n),e&&e[O]?e.K(t,n,s(i)?!!i.capture:!!i,r):K(e,t,n,!1,i,r)}function K(e,t,n,i,r,a){if(!t)throw Error("Invalid event type");var o=s(r)?!!r.capture:!!r,l=X(e);if(l||(e[W]=l=new V(e)),(n=l.add(t,n,i,o,a)).proxy)return n;if(i=function(){function e(n){return t.call(e.src,e.listener,n)}const t=J;return e}(),n.proxy=i,i.src=e,i.listener=n,e.addEventListener)M||(r=o),void 0===r&&(r=!1),e.addEventListener(t.toString(),i,r);else if(e.attachEvent)e.attachEvent(Y(t.toString()),i);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(i)}return n}function G(e,t,n,i,r){if(Array.isArray(t)){for(var a=0;a<t.length;a++)G(e,t[a],n,i,r);return null}return n=te(n),e&&e[O]?e.L(t,n,s(i)?!!i.capture:!!i,r):K(e,t,n,!0,i,r)}function Q(e,t,n,i,r){if(Array.isArray(t))for(var a=0;a<t.length;a++)Q(e,t[a],n,i,r);else i=s(i)?!!i.capture:!!i,n=te(n),e&&e[O]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=$(a=e.g[t],n,i,r))&&(U(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--)))):e&&(e=X(e))&&(t=e.g[t.toString()],e=-1,t&&(e=$(t,n,i,r)),(n=-1<e?t[e]:null)&&Z(n))}function Z(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[O])B(t.i,e);else{var n=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(n,i,e.capture):t.detachEvent?t.detachEvent(Y(n),i):t.addListener&&t.removeListener&&t.removeListener(i),(n=X(t))?(B(n,e),0==n.h&&(n.src=null,t[W]=null)):U(e)}}}function Y(e){return e in q?q[e]:q[e]="on"+e}function J(e,t){if(e.da)e=!0;else{t=new D(t,this);var n=e.listener,i=e.ha||e.src;e.fa&&Z(e),e=n.call(i,t)}return e}function X(e){return(e=e[W])instanceof V?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){I.call(this),this.i=new V(this),this.M=this,this.F=null}function ie(e,t){var n,i=e.F;if(i)for(n=[];i;i=i.F)n.push(i);if(e=e.M,i=t.type||t,"string"===typeof t)t=new A(t,e);else if(t instanceof A)t.target=t.target||e;else{var r=t;b(t=new A(i,e),r)}if(r=!0,n)for(var a=n.length-1;0<=a;a--){var s=t.g=n[a];r=re(s,i,!0,t)&&r}if(r=re(s=t.g=e,i,!0,t)&&r,r=re(s,i,!1,t)&&r,n)for(a=0;a<n.length;a++)r=re(s=t.g=n[a],i,!1,t)&&r}function re(e,t,n,i){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var r=!0,a=0;a<t.length;++a){var s=t[a];if(s&&!s.da&&s.capture==n){var o=s.listener,l=s.ha||s.src;s.fa&&B(e.i,s),r=!1!==o.call(l,i)&&r}}return r&&!i.defaultPrevented}function ae(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:r.setTimeout(e,t||0)}function se(e){e.g=ae((()=>{e.g=null,e.i&&(e.i=!1,se(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}u(ne,I),ne.prototype[O]=!0,ne.prototype.removeEventListener=function(e,t,n,i){Q(this,e,t,n,i)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],i=0;i<n.length;i++)U(n[i]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,i){return this.i.add(String(e),t,!1,n,i)},ne.prototype.L=function(e,t,n,i){return this.i.add(String(e),t,!0,n,i)};class oe extends I{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:se(this)}N(){super.N(),this.g&&(r.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){I.call(this),this.h=e,this.g={}}u(le,I);var ce=[];function de(e){v(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Z(e)}),e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),de(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ue=r.JSON.stringify,he=r.JSON.parse,pe=class{stringify(e){return r.JSON.stringify(e,void 0)}parse(e){return r.JSON.parse(e,void 0)}};function me(){}function fe(e){return e.h||(e.h=e.i())}function ye(){}me.prototype.h=null;var ge={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ve(){A.call(this,"d")}function we(){A.call(this,"c")}u(ve,A),u(we,A);var xe={},be=null;function je(){return be=be||new ne}function ke(e){A.call(this,xe.La,e)}function Ne(e){const t=je();ie(t,new ke(t))}function ze(e,t){A.call(this,xe.STAT_EVENT,e),this.stat=t}function _e(e){const t=je();ie(t,new ze(t,e))}function Se(e,t){A.call(this,xe.Ma,e),this.size=t}function Ee(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return r.setTimeout((function(){e()}),t)}function Ce(){this.g=!0}function Te(e,t,n,i){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var i=n[e];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var a=r[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var s=1;s<r.length;s++)r[s]=""}}}return ue(n)}catch(o){return t}}(e,n)+(i?" "+i:"")}))}xe.La="serverreachability",u(ke,A),xe.STAT_EVENT="statevent",u(ze,A),xe.Ma="timingevent",u(Se,A),Ce.prototype.xa=function(){this.g=!1},Ce.prototype.info=function(){};var Pe,Ie={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ae={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Me(){}function De(e,t,n,i){this.j=e,this.i=t,this.l=n,this.R=i||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Re}function Re(){this.i=null,this.g="",this.h=!1}u(Me,me),Me.prototype.g=function(){return new XMLHttpRequest},Me.prototype.i=function(){return{}},Pe=new Me;var Oe={},Le={};function Fe(e,t,n){e.L=1,e.v=ut(st(t)),e.m=n,e.P=!0,Ue(e,null)}function Ue(e,t){e.F=Date.now(),$e(e),e.A=st(e.v);var n=e.A,i=e.R;Array.isArray(i)||(i=[String(i)]),zt(n.i,"t",i),e.C=0,n=e.j.J,e.h=new Re,e.g=pn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new oe(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,i=e.ca;var r="readystatechange";Array.isArray(r)||(r&&(ce[0]=r.toString()),r=ce);for(var a=0;a<r.length;a++){var s=H(n,r[a],i||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}t=e.H?w(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ne(),function(e,t,n,i,r,a){e.info((function(){if(e.g)if(a)for(var s="",o=a.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var d=c[0];c=c[1];var u=d.split("_");s=2<=u.length&&"type"==u[1]?s+(d+"=")+c+"&":s+(d+"=redacted&")}}else s=null;else s=a;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+t+"\n"+n+"\n"+s}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function Ve(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Be(e,t){var n=e.C,i=t.indexOf("\n",n);return-1==i?Le:(n=Number(t.substring(n,i)),isNaN(n)?Oe:(i+=1)+n>t.length?Le:(t=t.slice(i,i+n),e.C=i+n,t))}function $e(e){e.S=Date.now()+e.I,We(e,e.I)}function We(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ee(c(e.ba,e),t)}function qe(e){e.B&&(r.clearTimeout(e.B),e.B=null)}function He(e){0==e.j.G||e.J||ln(e.j,e)}function Ke(e){qe(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,de(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Ge(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Xe(n.h,e)))if(!e.K&&Xe(n.h,e)&&3==n.G){try{var i=n.Da.g.parse(t)}catch(d){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;on(n),Zt(n)}rn(n),_e(18)}}else n.za=r[1],0<n.za-n.T&&37500>r[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ee(c(n.Za,n),6e3));if(1>=Je(n.h)&&n.ca){try{n.ca()}catch(d){}n.ca=void 0}}else dn(n,11)}else if((e.K||n.g==e)&&on(n),!m(t))for(r=n.Da.g.parse(t),t=0;t<r.length;t++){let c=r[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const r=c[4];null!=r&&(n.Aa=r,n.j.info("SVER="+n.Aa));const d=c[5];null!=d&&"number"===typeof d&&0<d&&(i=1.5*d,n.L=i,n.j.info("backChannelRequestTimeoutMs_="+i)),i=n;const u=e.g;if(u){const e=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var a=i.h;a.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(et(a,a.h),a.h=null))}if(i.D){const e=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(i.ya=e,dt(i.I,i.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var s=e;if((i=n).qa=hn(i,i.J?i.ia:null,i.W),s.K){tt(i.h,s);var o=s,l=i.L;l&&(o.I=l),o.B&&(qe(o),$e(o)),i.g=s}else nn(i);0<n.i.length&&Jt(n)}else"stop"!=c[0]&&"close"!=c[0]||dn(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?dn(n,7):Qt(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Ne()}catch(d){}}De.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==qt(e)?t.j():this.Y(e)},De.prototype.Y=function(e){try{if(e==this.g)e:{const h=qt(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||Ht(this.g)))){this.J||4!=h||7==t||Ne(),qe(this);var n=this.g.Z();this.X=n;t:if(Ve(this)){var i=Ht(this.g);e="";var a=i.length,s=4==qt(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ke(this),He(this);var o="";break t}this.h.i=new r.TextDecoder}for(t=0;t<a;t++)this.h.h=!0,e+=this.h.i.decode(i[t],{stream:!(s&&t==a-1)});i.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(e,t,n,i,r,a,s){e.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+t+"\n"+n+"\n"+a+" "+s}))}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!m(l)){var d=l;break t}}d=null}if(!(n=d)){this.o=!1,this.s=3,_e(12),Ke(this),He(this);break e}Te(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ge(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<o.length;){if(e=Be(this,o),e==Le){4==h&&(this.s=4,_e(14),n=!1),Te(this.i,this.l,null,"[Incomplete Response]");break}if(e==Oe){this.s=4,_e(15),Te(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}Te(this.i,this.l,e,null),Ge(this,e)}if(Ve(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=o.length||this.h.h||(this.s=1,_e(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var u=this.j;u.g==this&&u.ba&&!u.M&&(u.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),an(u),u.M=!0,_e(11))}}else Te(this.i,this.l,o,"[Invalid Chunked Response]"),Ke(this),He(this)}else Te(this.i,this.l,o,null),Ge(this,o);4==h&&Ke(this),this.o&&!this.J&&(4==h?ln(this.j,this):(this.o=!1,$e(this)))}else(function(e){const t={};e=(e.g&&2<=qt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<e.length;i++){if(m(e[i]))continue;var n=j(e[i]);const r=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const a=t[r]||[];t[r]=a,a.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,_e(12)):(this.s=0,_e(13)),Ke(this),He(this)}}}catch(ba){}},De.prototype.cancel=function(){this.J=!0,Ke(this)},De.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(Ne(),_e(17)),Ke(this),this.s=2,He(this)):We(this,this.S-e)};var Qe=class{constructor(e,t){this.g=e,this.map=t}};function Ze(e){this.l=e||10,r.PerformanceNavigationTiming?e=0<(e=r.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(r.chrome&&r.chrome.loadTimes&&r.chrome.loadTimes()&&r.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ye(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Je(e){return e.h?1:e.g?e.g.size:0}function Xe(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return h(e.i)}function it(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(a(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(a(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const i in e)t[n++]=i;return t}}}(e),i=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(a(e)){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}for(i in t=[],n=0,e)t[n++]=e[i];return t}(e),r=i.length,s=0;s<r;s++)t.call(void 0,i[s],n&&n[s],e)}Ze.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var rt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function at(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof at){this.h=e.h,ot(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new bt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ct(this,n),this.m=e.m}else e&&(t=String(e).match(rt))?(this.h=!1,ot(this,t[1]||"",!0),this.o=ht(t[2]||""),this.g=ht(t[3]||"",!0),lt(this,t[4]),this.l=ht(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=ht(t[7]||"")):(this.h=!1,this.i=new bt(null,this.h))}function st(e){return new at(e)}function ot(e,t,n){e.j=n?ht(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,n){t instanceof bt?(e.i=t,function(e,t){t&&!e.j&&(jt(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(kt(this,t),zt(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=pt(t,wt)),e.i=new bt(t,e.h))}function dt(e,t,n){e.i.set(t,n)}function ut(e){return dt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ht(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function pt(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,mt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function mt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}at.prototype.toString=function(){var e=[],t=this.j;t&&e.push(pt(t,yt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(pt(t,yt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(pt(n,"/"==n.charAt(0)?vt:gt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",pt(n,xt)),e.join("")};var ft,yt=/[#\/\?@]/g,gt=/[#\?:]/g,vt=/[#\?]/g,wt=/[#\?@]/g,xt=/#/g;function bt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function jt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),r=null;if(0<=i){var a=e[n].substring(0,i);r=e[n].substring(i+1)}else a=e[n];t(a,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function kt(e,t){jt(e),t=_t(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Nt(e,t){return jt(e),t=_t(e,t),e.g.has(t)}function zt(e,t,n){kt(e,t),0<n.length&&(e.i=null,e.g.set(_t(e,t),h(n)),e.h+=n.length)}function _t(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function St(e,t,n,i,r){try{r&&(r.onload=null,r.onerror=null,r.onabort=null,r.ontimeout=null),i(n)}catch(a){}}function Et(){this.g=new pe}function Ct(e,t,n){const i=n||"";try{it(e,(function(e,n){let r=e;s(e)&&(r=ue(e)),t.push(i+n+"="+encodeURIComponent(r))}))}catch(r){throw t.push(i+"type="+encodeURIComponent("_badmap")),r}}function Tt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Pt(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function It(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function At(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Mt(e)}function Mt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Dt(e){let t="";return v(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Rt(e,t,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=Dt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):dt(e,t,n))}function Ot(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=bt.prototype).add=function(e,t){jt(this),this.i=null,e=_t(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){jt(this),this.g.forEach((function(n,i){n.forEach((function(n){e.call(t,n,i,this)}),this)}),this)},e.na=function(){jt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let i=0;i<t.length;i++){const r=e[i];for(let e=0;e<r.length;e++)n.push(t[i])}return n},e.V=function(e){jt(this);let t=[];if("string"===typeof e)Nt(this,e)&&(t=t.concat(this.g.get(_t(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return jt(this),this.i=null,Nt(this,e=_t(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var i=t[n];const a=encodeURIComponent(String(i)),s=this.V(i);for(i=0;i<s.length;i++){var r=a;""!==s[i]&&(r+="="+encodeURIComponent(String(s[i]))),e.push(r)}}return this.i=e.join("&")},u(Tt,me),Tt.prototype.g=function(){return new Pt(this.l,this.j)},Tt.prototype.i=(ft={},function(){return ft}),u(Pt,ne),(e=Pt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Mt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||r).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,At(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Mt(this)),this.g&&(this.readyState=3,Mt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof r.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;It(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?At(this):Mt(this),3==this.readyState&&It(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,At(this))},e.Qa=function(e){this.g&&(this.response=e,At(this))},e.ga=function(){this.g&&At(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Pt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),u(Ot,ne);var Lt=/^https?$/i,Ft=["POST","PUT"];function Ut(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Vt(e),$t(e)}function Vt(e){e.A||(e.A=!0,ie(e,"complete"),ie(e,"error"))}function Bt(e){if(e.h&&"undefined"!=typeof i&&(!e.v[1]||4!=qt(e)||2!=e.Z()))if(e.u&&4==qt(e))ae(e.Ea,0,e);else if(ie(e,"readystatechange"),4==qt(e)){e.h=!1;try{const i=e.Z();e:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var a;if(a=0===i){var s=String(e.D).match(rt)[1]||null;!s&&r.self&&r.self.location&&(s=r.self.location.protocol.slice(0,-1)),a=!Lt.test(s?s.toLowerCase():"")}n=a}if(n)ie(e,"complete"),ie(e,"success");else{e.m=6;try{var o=2<qt(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",Vt(e)}}finally{$t(e)}}}function $t(e,t){if(e.g){Wt(e);const i=e.g,r=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||ie(e,"ready");try{i.onreadystatechange=r}catch(n){}}}function Wt(e){e.I&&(r.clearTimeout(e.I),e.I=null)}function qt(e){return e.g?e.g.readyState:0}function Ht(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(Na){return null}}function Kt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Gt(e){this.Aa=0,this.i=[],this.j=new Ce,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Kt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Kt("baseRetryDelayMs",5e3,e),this.cb=Kt("retryDelaySeedMs",1e4,e),this.Wa=Kt("forwardChannelMaxRetries",2,e),this.wa=Kt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Ze(e&&e.concurrentRequestLimit),this.Da=new Et,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Qt(e){if(Yt(e),3==e.G){var t=e.U++,n=st(e.I);if(dt(n,"SID",e.K),dt(n,"RID",t),dt(n,"TYPE","terminate"),en(e,n),(t=new De(e,e.j,t)).L=2,t.v=ut(st(n)),n=!1,r.navigator&&r.navigator.sendBeacon)try{n=r.navigator.sendBeacon(t.v.toString(),"")}catch(i){}!n&&r.Image&&((new Image).src=t.v,n=!0),n||(t.g=pn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),$e(t)}un(e)}function Zt(e){e.g&&(an(e),e.g.cancel(),e.g=null)}function Yt(e){Zt(e),e.u&&(r.clearTimeout(e.u),e.u=null),on(e),e.h.cancel(),e.s&&("number"===typeof e.s&&r.clearTimeout(e.s),e.s=null)}function Jt(e){if(!Ye(e.h)&&!e.s){e.s=!0;var t=e.Ga;S||T(),E||(S(),E=!0),C.add(t,e),e.B=0}}function Xt(e,t){var n;n=t?t.l:e.U++;const i=st(e.I);dt(i,"SID",e.K),dt(i,"RID",n),dt(i,"AID",e.T),en(e,i),e.m&&e.o&&Rt(i,e.m,e.o),n=new De(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),Fe(n,i,t)}function en(e,t){e.H&&v(e.H,(function(e,n){dt(t,n,e)})),e.l&&it({},(function(e,n){dt(t,n,e)}))}function tn(e,t,n){n=Math.min(e.i.length,n);var i=e.l?c(e.l.Na,e.l,e):null;e:{var r=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=r[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let a=!0;for(let s=0;s<n;s++){let n=r[s].g;const o=r[s].map;if(n-=t,0>n)t=Math.max(0,r[s].g-100),a=!1;else try{Ct(o,e,"req"+n+"_")}catch(ba){i&&i(o)}}if(a){i=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,i}function nn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;S||T(),E||(S(),E=!0),C.add(t,e),e.v=0}}function rn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ee(c(e.Fa,e),cn(e,e.v)),e.v++,!0)}function an(e){null!=e.A&&(r.clearTimeout(e.A),e.A=null)}function sn(e){e.g=new De(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=st(e.qa);dt(t,"RID","rpc"),dt(t,"SID",e.K),dt(t,"AID",e.T),dt(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&dt(t,"TO",e.ja),dt(t,"TYPE","xmlhttp"),en(e,t),e.m&&e.o&&Rt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=ut(st(t)),n.m=null,n.P=!0,Ue(n,e)}function on(e){null!=e.C&&(r.clearTimeout(e.C),e.C=null)}function ln(e,t){var n=null;if(e.g==t){on(e),an(e),e.g=null;var i=2}else{if(!Xe(e.h,t))return;n=t.D,tt(e.h,t),i=1}if(0!=e.G)if(t.o)if(1==i){n=t.m?t.m.length:0,t=Date.now()-t.F;var r=e.B;ie(i=je(),new Se(i,n)),Jt(e)}else nn(e);else if(3==(r=t.s)||0==r&&0<t.X||!(1==i&&function(e,t){return!(Je(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Ee(c(e.Ga,e,t),cn(e,e.B)),e.B++,!0))}(e,t)||2==i&&rn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),r){case 1:dn(e,5);break;case 4:dn(e,10);break;case 3:dn(e,6);break;default:dn(e,2)}}function cn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function dn(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),i=e.Xa;const t=!i;i=new at(i||"//www.google.com/images/cleardot.gif"),r.location&&"http"==r.location.protocol||ot(i,"https"),ut(i),t?function(e,t){const n=new Ce;if(r.Image){const i=new Image;i.onload=d(St,n,"TestLoadImage: loaded",!0,t,i),i.onerror=d(St,n,"TestLoadImage: error",!1,t,i),i.onabort=d(St,n,"TestLoadImage: abort",!1,t,i),i.ontimeout=d(St,n,"TestLoadImage: timeout",!1,t,i),r.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=e}else t(!1)}(i.toString(),n):function(e,t){new Ce;const n=new AbortController,i=setTimeout((()=>{n.abort(),St(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(i),e.ok?St(0,0,!0,t):St(0,0,!1,t)})).catch((()=>{clearTimeout(i),St(0,0,!1,t)}))}(i.toString(),n)}else _e(2);e.G=0,e.l&&e.l.sa(t),un(e),Yt(e)}function un(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(p(e.ka,t),p(e.ka,e.i),e.h.i.length=0,h(e.i),e.i.length=0),e.l.ra()}}function hn(e,t,n){var i=n instanceof at?st(n):new at(n);if(""!=i.g)t&&(i.g=t+"."+i.g),lt(i,i.s);else{var a=r.location;i=a.protocol,t=t?t+"."+a.hostname:a.hostname,a=+a.port;var s=new at(null);i&&ot(s,i),t&&(s.g=t),a&&lt(s,a),n&&(s.l=n),i=s}return n=e.D,t=e.ya,n&&t&&dt(i,n,t),dt(i,"VER",e.la),en(e,i),i}function pn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Ot(new Tt({eb:n})):new Ot(e.pa)).Ha(e.J),t}function mn(){}function fn(){}function yn(e,t){ne.call(this),this.g=new Gt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!m(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!m(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new wn(this)}function gn(e){ve.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function vn(){we.call(this),this.status=1}function wn(e){this.g=e}(e=Ot.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Pe.g(),this.v=this.o?fe(this.o):fe(Pe),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(s){return void Ut(this,s)}if(e=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var a in i)n.set(a,i[a]);else{if("function"!==typeof i.keys||"function"!==typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const e of i.keys())n.set(e,i.get(e))}i=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),a=r.FormData&&e instanceof r.FormData,!(0<=Array.prototype.indexOf.call(Ft,t,void 0))||i||a||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[r,o]of n)this.g.setRequestHeader(r,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Wt(this),this.u=!0,this.g.send(e),this.u=!1}catch(s){Ut(this,s)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,ie(this,"complete"),ie(this,"abort"),$t(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$t(this,!0)),Ot.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Bt(this):this.bb())},e.bb=function(){Bt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<qt(this)?this.g.status:-1}catch(ft){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(ft){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),he(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Gt.prototype).la=8,e.G=1,e.connect=function(e,t,n,i){_e(0),this.W=e,this.H=t||{},n&&void 0!==i&&(this.H.OSID=n,this.H.OAID=i),this.F=this.X,this.I=hn(this,null,this.W),Jt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const r=new De(this,this.j,e);let a=this.o;if(this.S&&(a?(a=w(a),b(a,this.S)):a=this.S),null!==this.m||this.O||(r.H=a,a=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var i=this.i[n];if(void 0===(i="__data__"in i.map&&"string"===typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(t+=i)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=tn(this,r,t),dt(n=st(this.I),"RID",e),dt(n,"CVER",22),this.D&&dt(n,"X-HTTP-Session-Id",this.D),en(this,n),a&&(this.O?t="headers="+encodeURIComponent(String(Dt(a)))+"&"+t:this.m&&Rt(n,this.m,a)),et(this.h,r),this.Ua&&dt(n,"TYPE","init"),this.P?(dt(n,"$req",t),dt(n,"SID","null"),r.T=!0,Fe(r,n,null)):Fe(r,n,t),this.G=2}}else 3==this.G&&(e?Xt(this,e):0==this.i.length||Ye(this.h)||Xt(this))},e.Fa=function(){if(this.u=null,sn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ee(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_e(10),Zt(this),sn(this))},e.Za=function(){null!=this.C&&(this.C=null,Zt(this),rn(this),_e(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),_e(2)):(this.j.info("Failed to ping google.com"),_e(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=mn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},fn.prototype.g=function(e,t){return new yn(e,t)},u(yn,ne),yn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){Qt(this.g)},yn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=ue(e),e=n);t.i.push(new Qe(t.Ya++,e)),3==t.G&&Jt(t)},yn.prototype.N=function(){this.g.l=null,delete this.j,Qt(this.g),delete this.g,yn.aa.N.call(this)},u(gn,ve),u(vn,we),u(wn,mn),wn.prototype.ua=function(){ie(this.g,"a")},wn.prototype.ta=function(e){ie(this.g,new gn(e))},wn.prototype.sa=function(e){ie(this.g,new vn)},wn.prototype.ra=function(){ie(this.g,"b")},fn.prototype.createWebChannel=fn.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,va=xa.createWebChannelTransport=function(){return new fn},ga=xa.getStatEventTarget=function(){return je()},ya=xa.Event=xe,fa=xa.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,ma=xa.ErrorCode=Ie,Ae.COMPLETE="complete",pa=xa.EventType=Ae,ye.EventType=ge,ge.OPEN="a",ge.CLOSE="b",ge.ERROR="c",ge.MESSAGE="d",ne.prototype.listen=ne.prototype.K,ha=xa.WebChannel=ye,xa.FetchXmlHttpFactory=Tt,Ot.prototype.listenOnce=Ot.prototype.L,Ot.prototype.getLastError=Ot.prototype.Ka,Ot.prototype.getLastErrorCode=Ot.prototype.Ba,Ot.prototype.getStatus=Ot.prototype.Z,Ot.prototype.getResponseJson=Ot.prototype.Oa,Ot.prototype.getResponseText=Ot.prototype.oa,Ot.prototype.send=Ot.prototype.ea,Ot.prototype.setWithCredentials=Ot.prototype.Ha,ua=xa.XhrIo=Ot}).apply("undefined"!==typeof wa?wa:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const ba="@firebase/firestore";class ja{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ja.UNAUTHENTICATED=new ja(null),ja.GOOGLE_CREDENTIALS=new ja("google-credentials-uid"),ja.FIRST_PARTY=new ja("first-party-uid"),ja.MOCK_USER=new ja("mock-user");let ka="10.14.0";const Na=new Pe("@firebase/firestore");function za(){return Na.logLevel}function _a(e){if(Na.logLevel<=_e.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=n.map(Ca);Na.debug(`Firestore (${ka}): ${e}`,...r)}}function Sa(e){if(Na.logLevel<=_e.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=n.map(Ca);Na.error(`Firestore (${ka}): ${e}`,...r)}}function Ea(e){if(Na.logLevel<=_e.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=n.map(Ca);Na.warn(`Firestore (${ka}): ${e}`,...r)}}function Ca(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function Ta(){const e=`FIRESTORE (${ka}) INTERNAL ASSERTION FAILED: `+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state");throw Sa(e),new Error(e)}function Pa(e,t){e||Ta()}function Ia(e,t){return e}const Aa={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ma extends ce{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Da{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Ra{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Oa{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ja.UNAUTHENTICATED)))}shutdown(){}}class La{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Fa{constructor(e){this.t=e,this.currentUser=ja.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Pa(void 0===this.o);let n=this.i;const i=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let r=new Da;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Da,e.enqueueRetryable((()=>i(this.currentUser)))};const a=()=>{const t=r;e.enqueueRetryable((async()=>{await t.promise,await i(this.currentUser)}))},s=e=>{_a("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((e=>s(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?s(e):(_a("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Da)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(_a("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Pa("string"==typeof t.accessToken),new Ra(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Pa(null===e||"string"==typeof e),new ja(e)}}class Ua{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=ja.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Va{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Ua(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(ja.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Ba{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $a{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Pa(void 0===this.o);const n=e=>{null!=e.error&&_a("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,_a("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const i=e=>{_a("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>i(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?i(e):_a("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Pa("string"==typeof e.token),this.R=e.token,new Ba(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Wa(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let i=0;i<e;i++)n[i]=Math.floor(256*Math.random());return n}class qa{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const i=Wa(40);for(let r=0;r<i.length;++r)n.length<20&&i[r]<t&&(n+=e.charAt(i[r]%62))}return n}}function Ha(e,t){return e<t?-1:e>t?1:0}function Ka(e,t,n){return e.length===t.length&&e.every(((e,i)=>n(e,t[i])))}class Ga{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ma(Aa.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ma(Aa.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Ma(Aa.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ma(Aa.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ga.fromMillis(Date.now())}static fromDate(e){return Ga.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Ga(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ha(this.nanoseconds,e.nanoseconds):Ha(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Qa{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Qa(e)}static min(){return new Qa(new Ga(0,0))}static max(){return new Qa(new Ga(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Za{constructor(e,t,n){void 0===t?t=0:t>e.length&&Ta(),void 0===n?n=e.length-t:n>e.length-t&&Ta(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Za.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Za?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const n=e.get(i),r=t.get(i);if(n<r)return-1;if(n>r)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Ya extends Za{construct(e,t,n){return new Ya(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(const r of n){if(r.indexOf("//")>=0)throw new Ma(Aa.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);e.push(...r.split("/").filter((e=>e.length>0)))}return new Ya(e)}static emptyPath(){return new Ya([])}}const Ja=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Xa extends Za{construct(e,t,n){return new Xa(e,t,n)}static isValidIdentifier(e){return Ja.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Xa.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Xa(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const r=()=>{if(0===n.length)throw new Ma(Aa.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let a=!1;for(;i<e.length;){const t=e[i];if("\\"===t){if(i+1===e.length)throw new Ma(Aa.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[i+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Ma(Aa.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,i+=2}else"`"===t?(a=!a,i++):"."!==t||a?(n+=t,i++):(r(),i++)}if(r(),a)throw new Ma(Aa.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Xa(t)}static emptyPath(){return new Xa([])}}class es{constructor(e){this.path=e}static fromPath(e){return new es(Ya.fromString(e))}static fromName(e){return new es(Ya.fromString(e).popFirst(5))}static empty(){return new es(Ya.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Ya.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Ya.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new es(new Ya(e.slice()))}}class ts{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}}ts.UNKNOWN_ID=-1;function ns(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,r=Qa.fromTimestamp(1e9===i?new Ga(n+1,0):new Ga(n,i));return new rs(r,es.empty(),t)}function is(e){return new rs(e.readTime,e.key,-1)}class rs{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new rs(Qa.min(),es.empty(),-1)}static max(){return new rs(Qa.max(),es.empty(),-1)}}function as(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=es.comparator(e.documentKey,t.documentKey),0!==n?n:Ha(e.largestBatchId,t.largestBatchId))}const ss="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class os{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ls(e){if(e.code!==Aa.FAILED_PRECONDITION||e.message!==ss)throw e;_a("LocalStore","Unexpectedly lost primary lease")}class cs{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ta(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new cs(((n,i)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,i)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof cs?t:cs.resolve(t)}catch(e){return cs.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):cs.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):cs.reject(t)}static resolve(e){return new cs(((t,n)=>{t(e)}))}static reject(e){return new cs(((t,n)=>{n(e)}))}static waitFor(e){return new cs(((t,n)=>{let i=0,r=0,a=!1;e.forEach((e=>{++i,e.next((()=>{++r,a&&r===i&&t()}),(e=>n(e)))})),a=!0,r===i&&t()}))}static or(e){let t=cs.resolve(!1);for(const n of e)t=t.next((e=>e?cs.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,i)=>{n.push(t.call(this,e,i))})),this.waitFor(n)}static mapArray(e,t){return new cs(((n,i)=>{const r=e.length,a=new Array(r);let s=0;for(let o=0;o<r;o++){const l=o;t(e[l]).next((e=>{a[l]=e,++s,s===r&&n(a)}),(e=>i(e)))}}))}static doWhile(e,t){return new cs(((n,i)=>{const r=()=>{!0===e()?t().next((()=>{r()}),i):n()};r()}))}}function ds(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function us(e){return"IndexedDbTransactionError"===e.name}class hs{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function ps(e){return null==e}function ms(e){return 0===e&&1/e==-1/0}function fs(e){return"number"==typeof e&&Number.isInteger(e)&&!ms(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}hs.oe=-1;const ys=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],gs=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],vs=gs,ws=[...vs,"indexConfiguration","indexState","indexEntries"];function xs(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function bs(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function js(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class ks{constructor(e,t){this.comparator=e,this.root=t||zs.EMPTY}insert(e,t){return new ks(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,zs.BLACK,null,null))}remove(e){return new ks(this.comparator,this.root.remove(e,this.comparator).copy(null,null,zs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ns(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ns(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ns(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ns(this.root,e,this.comparator,!0)}}class Ns{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?n(e.key,t):1,t&&i&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(0===r){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class zs{constructor(e,t,n,i,r){this.key=e,this.value=t,this.color=null!=n?n:zs.RED,this.left=null!=i?i:zs.EMPTY,this.right=null!=r?r:zs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,r){return new zs(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const r=n(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return zs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return zs.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,zs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,zs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ta();if(this.right.isRed())throw Ta();const e=this.left.check();if(e!==this.right.check())throw Ta();return e+(this.isRed()?0:1)}}zs.EMPTY=null,zs.RED=!0,zs.BLACK=!1,zs.EMPTY=new class{constructor(){this.size=0}get key(){throw Ta()}get value(){throw Ta()}get color(){throw Ta()}get left(){throw Ta()}get right(){throw Ta()}copy(e,t,n,i,r){return this}insert(e,t,n){return new zs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class _s{constructor(e){this.comparator=e,this.data=new ks(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ss(this.data.getIterator())}getIteratorFrom(e){return new Ss(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof _s))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new _s(this.comparator);return t.data=e,t}}class Ss{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Es{constructor(e){this.fields=e,e.sort(Xa.comparator)}static empty(){return new Es([])}unionWith(e){let t=new _s(Xa.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Es(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ka(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Cs extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ts{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Cs("Invalid base64 string: "+e):e}}(e);return new Ts(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Ts(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ha(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ts.EMPTY_BYTE_STRING=new Ts("");const Ps=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Is(e){if(Pa(!!e),"string"==typeof e){let t=0;const n=Ps.exec(e);if(Pa(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:As(e.seconds),nanos:As(e.nanos)}}function As(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Ms(e){return"string"==typeof e?Ts.fromBase64String(e):Ts.fromUint8Array(e)}function Ds(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Rs(e){const t=e.mapValue.fields.__previous_value__;return Ds(t)?Rs(t):t}function Os(e){const t=Is(e.mapValue.fields.__local_write_time__.timestampValue);return new Ga(t.seconds,t.nanos)}class Ls{constructor(e,t,n,i,r,a,s,o,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=a,this.autoDetectLongPolling=s,this.longPollingOptions=o,this.useFetchStreams=l}}class Fs{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Fs("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Fs&&e.projectId===this.projectId&&e.database===this.database}}const Us={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Vs(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ds(e)?4:io(e)?9007199254740991:to(e)?10:11:Ta()}function Bs(e,t){if(e===t)return!0;const n=Vs(e);if(n!==Vs(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Os(e).isEqual(Os(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Is(e.timestampValue),i=Is(t.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Ms(e.bytesValue).isEqual(Ms(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return As(e.geoPointValue.latitude)===As(t.geoPointValue.latitude)&&As(e.geoPointValue.longitude)===As(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return As(e.integerValue)===As(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=As(e.doubleValue),i=As(t.doubleValue);return n===i?ms(n)===ms(i):isNaN(n)&&isNaN(i)}return!1}(e,t);case 9:return Ka(e.arrayValue.values||[],t.arrayValue.values||[],Bs);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},i=t.mapValue.fields||{};if(xs(n)!==xs(i))return!1;for(const r in n)if(n.hasOwnProperty(r)&&(void 0===i[r]||!Bs(n[r],i[r])))return!1;return!0}(e,t);default:return Ta()}}function $s(e,t){return void 0!==(e.values||[]).find((e=>Bs(e,t)))}function Ws(e,t){if(e===t)return 0;const n=Vs(e),i=Vs(t);if(n!==i)return Ha(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ha(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=As(e.integerValue||e.doubleValue),i=As(t.integerValue||t.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(e,t);case 3:return qs(e.timestampValue,t.timestampValue);case 4:return qs(Os(e),Os(t));case 5:return Ha(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Ms(e),i=Ms(t);return n.compareTo(i)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),i=t.split("/");for(let r=0;r<n.length&&r<i.length;r++){const e=Ha(n[r],i[r]);if(0!==e)return e}return Ha(n.length,i.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Ha(As(e.latitude),As(t.latitude));return 0!==n?n:Ha(As(e.longitude),As(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Hs(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,i,r,a;const s=e.fields||{},o=t.fields||{},l=null===(n=s.value)||void 0===n?void 0:n.arrayValue,c=null===(i=o.value)||void 0===i?void 0:i.arrayValue,d=Ha((null===(r=null==l?void 0:l.values)||void 0===r?void 0:r.length)||0,(null===(a=null==c?void 0:c.values)||void 0===a?void 0:a.length)||0);return 0!==d?d:Hs(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Us.mapValue&&t===Us.mapValue)return 0;if(e===Us.mapValue)return 1;if(t===Us.mapValue)return-1;const n=e.fields||{},i=Object.keys(n),r=t.fields||{},a=Object.keys(r);i.sort(),a.sort();for(let s=0;s<i.length&&s<a.length;++s){const e=Ha(i[s],a[s]);if(0!==e)return e;const t=Ws(n[i[s]],r[a[s]]);if(0!==t)return t}return Ha(i.length,a.length)}(e.mapValue,t.mapValue);default:throw Ta()}}function qs(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Ha(e,t);const n=Is(e),i=Is(t),r=Ha(n.seconds,i.seconds);return 0!==r?r:Ha(n.nanos,i.nanos)}function Hs(e,t){const n=e.values||[],i=t.values||[];for(let r=0;r<n.length&&r<i.length;++r){const e=Ws(n[r],i[r]);if(e)return e}return Ha(n.length,i.length)}function Ks(e){return Gs(e)}function Gs(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Is(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Ms(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return es.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const i of e.values||[])n?n=!1:t+=",",t+=Gs(i);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",i=!0;for(const r of t)i?i=!1:n+=",",n+=`${r}:${Gs(e.fields[r])}`;return n+"}"}(e.mapValue):Ta()}function Qs(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Zs(e){return!!e&&"integerValue"in e}function Ys(e){return!!e&&"arrayValue"in e}function Js(e){return!!e&&"nullValue"in e}function Xs(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function eo(e){return!!e&&"mapValue"in e}function to(e){var t,n;return"__vector__"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function no(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return bs(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=no(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=no(e.arrayValue.values[n]);return t}return Object.assign({},e)}function io(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class ro{constructor(e){this.value=e}static empty(){return new ro({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!eo(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=no(t)}setAll(e){let t=Xa.emptyPath(),n={},i=[];e.forEach(((e,r)=>{if(!t.isImmediateParentOf(r)){const e=this.getFieldsMap(t);this.applyChanges(e,n,i),n={},i=[],t=r.popLast()}e?n[r.lastSegment()]=no(e):i.push(r.lastSegment())}));const r=this.getFieldsMap(t);this.applyChanges(r,n,i)}delete(e){const t=this.field(e.popLast());eo(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Bs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];eo(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){bs(t,((t,n)=>e[t]=n));for(const i of n)delete e[i]}clone(){return new ro(no(this.value))}}function ao(e){const t=[];return bs(e.fields,((e,n)=>{const i=new Xa([e]);if(eo(n)){const e=ao(n.mapValue).fields;if(0===e.length)t.push(i);else for(const n of e)t.push(i.child(n))}else t.push(i)})),new Es(t)}class so{constructor(e,t,n,i,r,a,s){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=r,this.data=a,this.documentState=s}static newInvalidDocument(e){return new so(e,0,Qa.min(),Qa.min(),Qa.min(),ro.empty(),0)}static newFoundDocument(e,t,n,i){return new so(e,1,t,Qa.min(),n,i,0)}static newNoDocument(e,t){return new so(e,2,t,Qa.min(),Qa.min(),ro.empty(),0)}static newUnknownDocument(e,t){return new so(e,3,t,Qa.min(),Qa.min(),ro.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Qa.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ro.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ro.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Qa.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof so&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new so(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class oo{constructor(e,t){this.position=e,this.inclusive=t}}function lo(e,t,n){let i=0;for(let r=0;r<e.position.length;r++){const a=t[r],s=e.position[r];if(i=a.field.isKeyField()?es.comparator(es.fromName(s.referenceValue),n.key):Ws(s,n.data.field(a.field)),"desc"===a.dir&&(i*=-1),0!==i)break}return i}function co(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Bs(e.position[n],t.position[n]))return!1;return!0}class uo{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function ho(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class po{}class mo extends po{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new jo(e,t,n):"array-contains"===t?new _o(e,n):"in"===t?new So(e,n):"not-in"===t?new Eo(e,n):"array-contains-any"===t?new Co(e,n):new mo(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new ko(e,n):new No(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Ws(t,this.value)):null!==t&&Vs(this.value)===Vs(t)&&this.matchesComparison(Ws(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Ta()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class fo extends po{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new fo(e,t)}matches(e){return yo(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function yo(e){return"and"===e.op}function go(e){return vo(e)&&yo(e)}function vo(e){for(const t of e.filters)if(t instanceof fo)return!1;return!0}function wo(e){if(e instanceof mo)return e.field.canonicalString()+e.op.toString()+Ks(e.value);if(go(e))return e.filters.map((e=>wo(e))).join(",");{const t=e.filters.map((e=>wo(e))).join(",");return`${e.op}(${t})`}}function xo(e,t){return e instanceof mo?function(e,t){return t instanceof mo&&e.op===t.op&&e.field.isEqual(t.field)&&Bs(e.value,t.value)}(e,t):e instanceof fo?function(e,t){return t instanceof fo&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,i)=>e&&xo(n,t.filters[i])),!0)}(e,t):void Ta()}function bo(e){return e instanceof mo?function(e){return`${e.field.canonicalString()} ${e.op} ${Ks(e.value)}`}(e):e instanceof fo?function(e){return e.op.toString()+" {"+e.getFilters().map(bo).join(" ,")+"}"}(e):"Filter"}class jo extends mo{constructor(e,t,n){super(e,t,n),this.key=es.fromName(n.referenceValue)}matches(e){const t=es.comparator(e.key,this.key);return this.matchesComparison(t)}}class ko extends mo{constructor(e,t){super(e,"in",t),this.keys=zo("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class No extends mo{constructor(e,t){super(e,"not-in",t),this.keys=zo("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function zo(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>es.fromName(e.referenceValue)))}class _o extends mo{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ys(t)&&$s(t.arrayValue,this.value)}}class So extends mo{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&$s(this.value.arrayValue,t)}}class Eo extends mo{constructor(e,t){super(e,"not-in",t)}matches(e){if($s(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!$s(this.value.arrayValue,t)}}class Co extends mo{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ys(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>$s(this.value.arrayValue,e)))}}class To{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=a,this.endAt=s,this.ue=null}}function Po(e){return new To(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Io(e){const t=Ia(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>wo(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),ps(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Ks(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Ks(e))).join(",")),t.ue=e}return t.ue}function Ao(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!ho(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!xo(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!co(e.startAt,t.startAt)&&co(e.endAt,t.endAt)}function Mo(e){return es.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Do{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=a,this.startAt=s,this.endAt=o,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Ro(e,t,n,i,r,a,s,o){return new Do(e,t,n,i,r,a,s,o)}function Oo(e){return new Do(e)}function Lo(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Fo(e){return null!==e.collectionGroup}function Uo(e){const t=Ia(e);if(null===t.ce){t.ce=[];const e=new Set;for(const r of t.explicitOrderBy)t.ce.push(r),e.add(r.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",i=function(e){let t=new _s(Xa.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);i.forEach((i=>{e.has(i.canonicalString())||i.isKeyField()||t.ce.push(new uo(i,n))})),e.has(Xa.keyField().canonicalString())||t.ce.push(new uo(Xa.keyField(),n))}return t.ce}function Vo(e){const t=Ia(e);return t.le||(t.le=Bo(t,Uo(e))),t.le}function Bo(e,t){if("F"===e.limitType)return Po(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new uo(e.field,t)}));const n=e.endAt?new oo(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new oo(e.startAt.position,e.startAt.inclusive):null;return Po(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}}function $o(e,t){const n=e.filters.concat([t]);return new Do(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Wo(e,t,n){return new Do(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function qo(e,t){return Ao(Vo(e),Vo(t))&&e.limitType===t.limitType}function Ho(e){return`${Io(Vo(e))}|lt:${e.limitType}`}function Ko(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>bo(e))).join(", ")}]`),ps(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Ks(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Ks(e))).join(",")),`Target(${t})`}(Vo(e))}; limitType=${e.limitType})`}function Go(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):es.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Uo(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const i=lo(e,t,n);return e.inclusive?i<=0:i<0}(e.startAt,Uo(e),t))&&!(e.endAt&&!function(e,t,n){const i=lo(e,t,n);return e.inclusive?i>=0:i>0}(e.endAt,Uo(e),t))}(e,t)}function Qo(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Zo(e){return(t,n)=>{let i=!1;for(const r of Uo(e)){const e=Yo(r,t,n);if(0!==e)return e;i=i||r.field.isKeyField()}return 0}}function Yo(e,t,n){const i=e.field.isKeyField()?es.comparator(t.key,n.key):function(e,t,n){const i=t.data.field(e),r=n.data.field(e);return null!==i&&null!==r?Ws(i,r):Ta()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return Ta()}}class Jo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[i,r]of n)if(this.equalsFn(i,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return void(i[r]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){bs(this.inner,((t,n)=>{for(const[i,r]of n)e(i,r)}))}isEmpty(){return js(this.inner)}size(){return this.innerSize}}const Xo=new ks(es.comparator);function el(){return Xo}const tl=new ks(es.comparator);function nl(){let e=tl;for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(const r of n)e=e.insert(r.key,r);return e}function il(e){let t=tl;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function rl(){return sl()}function al(){return sl()}function sl(){return new Jo((e=>e.toString()),((e,t)=>e.isEqual(t)))}const ol=new ks(es.comparator),ll=new _s(es.comparator);function cl(){let e=ll;for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(const r of n)e=e.add(r);return e}const dl=new _s(Ha);function ul(){return dl}function hl(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ms(t)?"-0":t}}function pl(e){return{integerValue:""+e}}function ml(e,t){return fs(t)?pl(t):hl(e,t)}class fl{constructor(){this._=void 0}}function yl(e,t,n){return e instanceof wl?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Ds(t)&&(t=Rs(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof xl?bl(e,t):e instanceof jl?kl(e,t):function(e,t){const n=vl(e,t),i=zl(n)+zl(e.Pe);return Zs(n)&&Zs(e.Pe)?pl(i):hl(e.serializer,i)}(e,t)}function gl(e,t,n){return e instanceof xl?bl(e,t):e instanceof jl?kl(e,t):n}function vl(e,t){return e instanceof Nl?function(e){return Zs(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class wl extends fl{}class xl extends fl{constructor(e){super(),this.elements=e}}function bl(e,t){const n=_l(t);for(const i of e.elements)n.some((e=>Bs(e,i)))||n.push(i);return{arrayValue:{values:n}}}class jl extends fl{constructor(e){super(),this.elements=e}}function kl(e,t){let n=_l(t);for(const i of e.elements)n=n.filter((e=>!Bs(e,i)));return{arrayValue:{values:n}}}class Nl extends fl{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function zl(e){return As(e.integerValue||e.doubleValue)}function _l(e){return Ys(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Sl{constructor(e,t){this.version=e,this.transformResults=t}}class El{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new El}static exists(e){return new El(void 0,e)}static updateTime(e){return new El(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Cl(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Tl{}function Pl(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Vl(e.key,El.none()):new Rl(e.key,e.data,El.none());{const n=e.data,i=ro.empty();let r=new _s(Xa.comparator);for(let e of t.fields)if(!r.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?i.delete(e):i.set(e,t),r=r.add(e)}return new Ol(e.key,i,new Es(r.toArray()),El.none())}}function Il(e,t,n){e instanceof Rl?function(e,t,n){const i=e.value.clone(),r=Fl(e.fieldTransforms,t,n.transformResults);i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):e instanceof Ol?function(e,t,n){if(!Cl(e.precondition,t))return void t.convertToUnknownDocument(n.version);const i=Fl(e.fieldTransforms,t,n.transformResults),r=t.data;r.setAll(Ll(e)),r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Al(e,t,n,i){return e instanceof Rl?function(e,t,n,i){if(!Cl(e.precondition,t))return n;const r=e.value.clone(),a=Ul(e.fieldTransforms,i,t);return r.setAll(a),t.convertToFoundDocument(t.version,r).setHasLocalMutations(),null}(e,t,n,i):e instanceof Ol?function(e,t,n,i){if(!Cl(e.precondition,t))return n;const r=Ul(e.fieldTransforms,i,t),a=t.data;return a.setAll(Ll(e)),a.setAll(r),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,i):function(e,t,n){return Cl(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Ml(e,t){let n=null;for(const i of e.fieldTransforms){const e=t.data.field(i.field),r=vl(i.transform,e||null);null!=r&&(null===n&&(n=ro.empty()),n.set(i.field,r))}return n||null}function Dl(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Ka(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof xl&&t instanceof xl||e instanceof jl&&t instanceof jl?Ka(e.elements,t.elements,Bs):e instanceof Nl&&t instanceof Nl?Bs(e.Pe,t.Pe):e instanceof wl&&t instanceof wl}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Rl extends Tl{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ol extends Tl{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function Ll(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}})),t}function Fl(e,t,n){const i=new Map;Pa(e.length===n.length);for(let r=0;r<n.length;r++){const a=e[r],s=a.transform,o=t.data.field(a.field);i.set(a.field,gl(s,o,n[r]))}return i}function Ul(e,t,n){const i=new Map;for(const r of e){const e=r.transform,a=n.data.field(r.field);i.set(r.field,yl(e,a,t))}return i}class Vl extends Tl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Bl extends Tl{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class $l{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const t=this.mutations[i];t.key.isEqual(e.key)&&Il(t,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Al(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Al(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=al();return this.mutations.forEach((i=>{const r=e.get(i.key),a=r.overlayedDocument;let s=this.applyToLocalView(a,r.mutatedFields);s=t.has(i.key)?null:s;const o=Pl(a,s);null!==o&&n.set(i.key,o),a.isValidDocument()||a.convertToNoDocument(Qa.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),cl())}isEqual(e){return this.batchId===e.batchId&&Ka(this.mutations,e.mutations,((e,t)=>Dl(e,t)))&&Ka(this.baseMutations,e.baseMutations,((e,t)=>Dl(e,t)))}}class Wl{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){Pa(e.mutations.length===n.length);let i=ol;const r=e.mutations;for(let a=0;a<r.length;a++)i=i.insert(r[a].key,n[a].version);return new Wl(e,t,n,i)}}class ql{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Hl{constructor(e,t){this.count=e,this.unchangedNames=t}}var Kl,Gl;function Ql(e){switch(e){default:return Ta();case Aa.CANCELLED:case Aa.UNKNOWN:case Aa.DEADLINE_EXCEEDED:case Aa.RESOURCE_EXHAUSTED:case Aa.INTERNAL:case Aa.UNAVAILABLE:case Aa.UNAUTHENTICATED:return!1;case Aa.INVALID_ARGUMENT:case Aa.NOT_FOUND:case Aa.ALREADY_EXISTS:case Aa.PERMISSION_DENIED:case Aa.FAILED_PRECONDITION:case Aa.ABORTED:case Aa.OUT_OF_RANGE:case Aa.UNIMPLEMENTED:case Aa.DATA_LOSS:return!0}}function Zl(e){if(void 0===e)return Sa("GRPC error has no .code"),Aa.UNKNOWN;switch(e){case Kl.OK:return Aa.OK;case Kl.CANCELLED:return Aa.CANCELLED;case Kl.UNKNOWN:return Aa.UNKNOWN;case Kl.DEADLINE_EXCEEDED:return Aa.DEADLINE_EXCEEDED;case Kl.RESOURCE_EXHAUSTED:return Aa.RESOURCE_EXHAUSTED;case Kl.INTERNAL:return Aa.INTERNAL;case Kl.UNAVAILABLE:return Aa.UNAVAILABLE;case Kl.UNAUTHENTICATED:return Aa.UNAUTHENTICATED;case Kl.INVALID_ARGUMENT:return Aa.INVALID_ARGUMENT;case Kl.NOT_FOUND:return Aa.NOT_FOUND;case Kl.ALREADY_EXISTS:return Aa.ALREADY_EXISTS;case Kl.PERMISSION_DENIED:return Aa.PERMISSION_DENIED;case Kl.FAILED_PRECONDITION:return Aa.FAILED_PRECONDITION;case Kl.ABORTED:return Aa.ABORTED;case Kl.OUT_OF_RANGE:return Aa.OUT_OF_RANGE;case Kl.UNIMPLEMENTED:return Aa.UNIMPLEMENTED;case Kl.DATA_LOSS:return Aa.DATA_LOSS;default:return Ta()}}(Gl=Kl||(Kl={}))[Gl.OK=0]="OK",Gl[Gl.CANCELLED=1]="CANCELLED",Gl[Gl.UNKNOWN=2]="UNKNOWN",Gl[Gl.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Gl[Gl.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Gl[Gl.NOT_FOUND=5]="NOT_FOUND",Gl[Gl.ALREADY_EXISTS=6]="ALREADY_EXISTS",Gl[Gl.PERMISSION_DENIED=7]="PERMISSION_DENIED",Gl[Gl.UNAUTHENTICATED=16]="UNAUTHENTICATED",Gl[Gl.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Gl[Gl.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Gl[Gl.ABORTED=10]="ABORTED",Gl[Gl.OUT_OF_RANGE=11]="OUT_OF_RANGE",Gl[Gl.UNIMPLEMENTED=12]="UNIMPLEMENTED",Gl[Gl.INTERNAL=13]="INTERNAL",Gl[Gl.UNAVAILABLE=14]="UNAVAILABLE",Gl[Gl.DATA_LOSS=15]="DATA_LOSS";let Yl=null;function Jl(){return new TextEncoder}const Xl=new oa([4294967295,4294967295],0);function ec(e){const t=Jl().encode(e),n=new la;return n.update(t),new Uint8Array(n.digest())}function tc(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),r=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new oa([n,i],0),new oa([r,a],0)]}class nc{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new ic(`Invalid padding: ${t}`);if(n<0)throw new ic(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new ic(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new ic(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=oa.fromNumber(this.Ie)}Ee(e,t,n){let i=e.add(t.multiply(oa.fromNumber(n)));return 1===i.compare(Xl)&&(i=new oa([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=ec(e),[n,i]=tc(t);for(let r=0;r<this.hashCount;r++){const e=this.Ee(n,i,r);if(!this.de(e))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),a=new nc(r,i,t);return n.forEach((e=>a.insert(e))),a}insert(e){if(0===this.Ie)return;const t=ec(e),[n,i]=tc(t);for(let r=0;r<this.hashCount;r++){const e=this.Ee(n,i,r);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class ic extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class rc{constructor(e,t,n,i,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,ac.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new rc(Qa.min(),i,new ks(Ha),el(),cl())}}class ac{constructor(e,t,n,i,r){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new ac(n,t,cl(),cl(),cl())}}class sc{constructor(e,t,n,i){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=i}}class oc{constructor(e,t){this.targetId=e,this.me=t}}class lc{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ts.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class cc{constructor(){this.fe=0,this.ge=hc(),this.pe=Ts.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=cl(),t=cl(),n=cl();return this.ge.forEach(((i,r)=>{switch(r){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:Ta()}})),new ac(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=hc()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Pa(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class dc{constructor(e){this.Le=e,this.Be=new Map,this.ke=el(),this.qe=uc(),this.Qe=new ks(Ha)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,(t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:Ta()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((e,n)=>{this.ze(n)&&t(n)}))}He(e){const t=e.targetId,n=e.me.count,i=this.Je(t);if(i){const r=i.target;if(Mo(r))if(0===n){const e=new es(r.path);this.Ue(t,e,so.newNoDocument(e,Qa.min()))}else Pa(1===n);else{const i=this.Ye(t);if(i!==n){const n=this.Ze(e),r=n?this.Xe(n,e,i):1;if(0!==r){this.je(t);const e=2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}null==Yl||Yl.et(function(e,t,n,i,r){var a,s,o,l,c,d;const u={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(u.bloomFilter={applied:0===r,hashCount:null!==(a=null==h?void 0:h.hashCount)&&void 0!==a?a:0,bitmapLength:null!==(l=null===(o=null===(s=null==h?void 0:h.bits)||void 0===s?void 0:s.bitmap)||void 0===o?void 0:o.length)&&void 0!==l?l:0,padding:null!==(d=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==d?d:0,mightContain:e=>{var t;return null!==(t=null==i?void 0:i.mightContain(e))&&void 0!==t&&t}}),u}(i,e.me,this.Le.tt(),n,r))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:r=0}=t;let a,s;try{a=Ms(n).toUint8Array()}catch(e){if(e instanceof Cs)return Ea("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{s=new nc(a,i,r)}catch(e){return Ea(e instanceof ic?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===s.Ie?null:s}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let i=0;return n.forEach((n=>{const r=this.Le.tt(),a=`projects/${r.projectId}/databases/${r.database}/documents/${n.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,n,null),i++)})),i}rt(e){const t=new Map;this.Be.forEach(((n,i)=>{const r=this.Je(i);if(r){if(n.current&&Mo(r.target)){const t=new es(r.target.path);null!==this.ke.get(t)||this.it(i,t)||this.Ue(i,t,so.newNoDocument(t,e))}n.be&&(t.set(i,n.ve()),n.Ce())}}));let n=cl();this.qe.forEach(((e,t)=>{let i=!0;t.forEachWhile((e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(i=!1,!1)})),i&&(n=n.add(e))})),this.ke.forEach(((t,n)=>n.setReadTime(e)));const i=new rc(e,t,this.Qe,this.ke,n);return this.ke=el(),this.qe=uc(),this.Qe=new ks(Ha),i}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new cc,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new _s(Ha),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||_a("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new cc),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.Ue(e,t,null)}))}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function uc(){return new ks(es.comparator)}function hc(){return new ks(es.comparator)}const pc={asc:"ASCENDING",desc:"DESCENDING"},mc={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},fc={and:"AND",or:"OR"};class yc{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function gc(e,t){return e.useProto3Json||ps(t)?t:{value:t}}function vc(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function wc(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function xc(e,t){return vc(e,t.toTimestamp())}function bc(e){return Pa(!!e),Qa.fromTimestamp(function(e){const t=Is(e);return new Ga(t.seconds,t.nanos)}(e))}function jc(e,t){return kc(e,t).canonicalString()}function kc(e,t){const n=function(e){return new Ya(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Nc(e){const t=Ya.fromString(e);return Pa(Wc(t)),t}function zc(e,t){return jc(e.databaseId,t.path)}function _c(e,t){const n=Nc(t);if(n.get(1)!==e.databaseId.projectId)throw new Ma(Aa.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Ma(Aa.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new es(Tc(n))}function Sc(e,t){return jc(e.databaseId,t)}function Ec(e){const t=Nc(e);return 4===t.length?Ya.emptyPath():Tc(t)}function Cc(e){return new Ya(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Tc(e){return Pa(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Pc(e,t,n){return{name:zc(e,t),fields:n.value.mapValue.fields}}function Ic(e,t){let n;if(t instanceof Rl)n={update:Pc(e,t.key,t.value)};else if(t instanceof Vl)n={delete:zc(e,t.key)};else if(t instanceof Ol)n={update:Pc(e,t.key,t.data),updateMask:$c(t.fieldMask)};else{if(!(t instanceof Bl))return Ta();n={verify:zc(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof wl)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof xl)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof jl)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Nl)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw Ta()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:xc(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Ta()}(e,t.precondition)),n}function Ac(e,t){return{documents:[Sc(e,t.path)]}}function Mc(e,t){const n={structuredQuery:{}},i=t.path;let r;null!==t.collectionGroup?(r=i,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=Sc(e,r);const a=function(e){if(0!==e.length)return Bc(fo.create(e,"and"))}(t.filters);a&&(n.structuredQuery.where=a);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Uc(e.field),direction:Oc(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=gc(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:r}}function Dc(e){let t=Ec(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){Pa(1===i);const e=n.from[0];e.allDescendants?r=e.collectionId:t=t.child(e.collectionId)}let a=[];n.where&&(a=function(e){const t=Rc(e);return t instanceof fo&&go(t)?t.getFilters():[t]}(n.where));let s=[];n.orderBy&&(s=function(e){return e.map((e=>function(e){return new uo(Vc(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,ps(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new oo(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new oo(n,t)}(n.endAt)),Ro(t,r,s,a,o,"F",l,c)}function Rc(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Vc(e.unaryFilter.field);return mo.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Vc(e.unaryFilter.field);return mo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Vc(e.unaryFilter.field);return mo.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Vc(e.unaryFilter.field);return mo.create(r,"!=",{nullValue:"NULL_VALUE"});default:return Ta()}}(e):void 0!==e.fieldFilter?function(e){return mo.create(Vc(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ta()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return fo.create(e.compositeFilter.filters.map((e=>Rc(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Ta()}}(e.compositeFilter.op))}(e):Ta()}function Oc(e){return pc[e]}function Lc(e){return mc[e]}function Fc(e){return fc[e]}function Uc(e){return{fieldPath:e.canonicalString()}}function Vc(e){return Xa.fromServerFormat(e.fieldPath)}function Bc(e){return e instanceof mo?function(e){if("=="===e.op){if(Xs(e.value))return{unaryFilter:{field:Uc(e.field),op:"IS_NAN"}};if(Js(e.value))return{unaryFilter:{field:Uc(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Xs(e.value))return{unaryFilter:{field:Uc(e.field),op:"IS_NOT_NAN"}};if(Js(e.value))return{unaryFilter:{field:Uc(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Uc(e.field),op:Lc(e.op),value:e.value}}}(e):e instanceof fo?function(e){const t=e.getFilters().map((e=>Bc(e)));return 1===t.length?t[0]:{compositeFilter:{op:Fc(e.op),filters:t}}}(e):Ta()}function $c(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Wc(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class qc{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Qa.min(),a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Qa.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Ts.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=s,this.expectedCount=o}withSequenceNumber(e){return new qc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new qc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new qc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new qc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Hc{constructor(e){this.ct=e}}function Kc(e){const t=Dc({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Wo(t,t.limit,"L"):t}class Gc{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(As(e.integerValue));else if("doubleValue"in e){const n=As(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),ms(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),"string"==typeof n&&(n=Is(n)),t.Rt(`${n.seconds||""}`),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Ms(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?io(e)?this.dt(t,Number.MAX_SAFE_INTEGER):to(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Ta()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const n=e.fields||{};this.dt(t,55);for(const i of Object.keys(n))this.Vt(i,t),this.Tt(n[i],t)}wt(e,t){var n,i;const r=e.fields||{};this.dt(t,53);const a="value",s=(null===(i=null===(n=r[a].arrayValue)||void 0===n?void 0:n.values)||void 0===i?void 0:i.length)||0;this.dt(t,15),t.At(As(s)),this.Vt(a,t),this.Tt(r[a],t)}bt(e,t){const n=e.values||[];this.dt(t,50);for(const i of n)this.Tt(i,t)}yt(e,t){this.dt(t,37),es.fromName(e).path.forEach((e=>{this.dt(t,60),this.Dt(e,t)}))}dt(e,t){e.At(t)}ft(e){e.At(2)}}Gc.vt=new Gc;class Qc{constructor(){this.un=new Zc}addToCollectionParentIndex(e,t){return this.un.add(t),cs.resolve()}getCollectionParents(e,t){return cs.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return cs.resolve()}deleteFieldIndex(e,t){return cs.resolve()}deleteAllFieldIndexes(e){return cs.resolve()}createTargetIndexes(e,t){return cs.resolve()}getDocumentsMatchingTarget(e,t){return cs.resolve(null)}getIndexType(e,t){return cs.resolve(0)}getFieldIndexes(e,t){return cs.resolve([])}getNextCollectionGroupToUpdate(e){return cs.resolve(null)}getMinOffset(e,t){return cs.resolve(rs.min())}getMinOffsetFromCollectionGroup(e,t){return cs.resolve(rs.min())}updateCollectionGroup(e,t,n){return cs.resolve()}updateIndexEntries(e,t){return cs.resolve()}}class Zc{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new _s(Ya.comparator),r=!i.has(n);return this.index[t]=i.add(n),r}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new _s(Ya.comparator)).toArray()}}new Uint8Array(0);class Yc{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Yc(e,Yc.DEFAULT_COLLECTION_PERCENTILE,Yc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Yc.DEFAULT_COLLECTION_PERCENTILE=10,Yc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Yc.DEFAULT=new Yc(41943040,Yc.DEFAULT_COLLECTION_PERCENTILE,Yc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Yc.DISABLED=new Yc(-1,0,0);class Jc{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Jc(0)}static kn(){return new Jc(-1)}}class Xc{constructor(){this.changes=new Jo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,so.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?cs.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class ed{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class td{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(n=i,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&Al(n.mutation,e,Es.empty(),Ga.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,cl()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:cl();const i=rl();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,n).next((e=>{let t=nl();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=rl();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,cl())))}populateOverlays(e,t,n){const i=[];return n.forEach((e=>{t.has(e)||i.push(e)})),this.documentOverlayCache.getOverlays(e,i).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,i){let r=el();const a=sl(),s=sl();return t.forEach(((e,t)=>{const s=n.get(t.key);i.has(t.key)&&(void 0===s||s.mutation instanceof Ol)?r=r.insert(t.key,t):void 0!==s?(a.set(t.key,s.mutation.getFieldMask()),Al(s.mutation,t,s.mutation.getFieldMask(),Ga.now())):a.set(t.key,Es.empty())})),this.recalculateAndSaveOverlays(e,r).next((e=>(e.forEach(((e,t)=>a.set(e,t))),t.forEach(((e,t)=>{var n;return s.set(e,new ed(t,null!==(n=a.get(e))&&void 0!==n?n:null))})),s)))}recalculateAndSaveOverlays(e,t){const n=sl();let i=new ks(((e,t)=>e-t)),r=cl();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const r of e)r.keys().forEach((e=>{const a=t.get(e);if(null===a)return;let s=n.get(e)||Es.empty();s=r.applyToLocalView(a,s),n.set(e,s);const o=(i.get(r.batchId)||cl()).add(e);i=i.insert(r.batchId,o)}))})).next((()=>{const a=[],s=i.getReverseIterator();for(;s.hasNext();){const i=s.getNext(),o=i.key,l=i.value,c=al();l.forEach((e=>{if(!r.has(e)){const i=Pl(t.get(e),n.get(e));null!==i&&c.set(e,i),r=r.add(e)}})),a.push(this.documentOverlayCache.saveOverlays(e,o,c))}return cs.waitFor(a)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,i){return function(e){return es.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Fo(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next((r=>{const a=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-r.size):cs.resolve(rl());let s=-1,o=r;return a.next((t=>cs.forEach(t,((t,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),r.get(t)?cs.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{o=o.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,r))).next((()=>this.computeViews(e,o,t,cl()))).next((e=>({batchId:s,changes:il(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new es(t)).next((e=>{let t=nl();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const r=t.collectionGroup;let a=nl();return this.indexManager.getCollectionParents(e,r).next((s=>cs.forEach(s,(s=>{const o=function(e,t){return new Do(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(r));return this.getDocumentsMatchingCollectionQuery(e,o,n,i).next((e=>{e.forEach(((e,t)=>{a=a.insert(e,t)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,n,i){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((a=>(r=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r,i)))).next((e=>{r.forEach(((t,n)=>{const i=n.getKey();null===e.get(i)&&(e=e.insert(i,so.newInvalidDocument(i)))}));let n=nl();return e.forEach(((e,i)=>{const a=r.get(e);void 0!==a&&Al(a.mutation,i,Es.empty(),Ga.now()),Go(t,i)&&(n=n.insert(e,i))})),n}))}}class nd{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return cs.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:bc(e.createTime)}}(t)),cs.resolve()}getNamedQuery(e,t){return cs.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(e){return{name:e.name,query:Kc(e.bundledQuery),readTime:bc(e.readTime)}}(t)),cs.resolve()}}class id{constructor(){this.overlays=new ks(es.comparator),this.Ir=new Map}getOverlay(e,t){return cs.resolve(this.overlays.get(t))}getOverlays(e,t){const n=rl();return cs.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,i)=>{this.ht(e,t,i)})),cs.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Ir.get(n);return void 0!==i&&(i.forEach((e=>this.overlays=this.overlays.remove(e))),this.Ir.delete(n)),cs.resolve()}getOverlaysForCollection(e,t,n){const i=rl(),r=t.length+1,a=new es(t.child("")),s=this.overlays.getIteratorFrom(a);for(;s.hasNext();){const e=s.getNext().value,a=e.getKey();if(!t.isPrefixOf(a.path))break;a.path.length===r&&e.largestBatchId>n&&i.set(e.getKey(),e)}return cs.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let r=new ks(((e,t)=>e-t));const a=this.overlays.getIterator();for(;a.hasNext();){const e=a.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=r.get(e.largestBatchId);null===t&&(t=rl(),r=r.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const s=rl(),o=r.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach(((e,t)=>s.set(e,t))),!(s.size()>=i)););return cs.resolve(s)}ht(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const e=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new ql(t,n));let r=this.Ir.get(t);void 0===r&&(r=cl(),this.Ir.set(t,r)),this.Ir.set(t,r.add(n.key))}}class rd{constructor(){this.sessionToken=Ts.EMPTY_BYTE_STRING}getSessionToken(e){return cs.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,cs.resolve()}}class ad{constructor(){this.Tr=new _s(sd.Er),this.dr=new _s(sd.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new sd(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Vr(new sd(e,t))}mr(e,t){e.forEach((e=>this.removeReference(e,t)))}gr(e){const t=new es(new Ya([])),n=new sd(t,e),i=new sd(t,e+1),r=[];return this.dr.forEachInRange([n,i],(e=>{this.Vr(e),r.push(e.key)})),r}pr(){this.Tr.forEach((e=>this.Vr(e)))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new es(new Ya([])),n=new sd(t,e),i=new sd(t,e+1);let r=cl();return this.dr.forEachInRange([n,i],(e=>{r=r.add(e.key)})),r}containsKey(e){const t=new sd(e,0),n=this.Tr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class sd{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return es.comparator(e.key,t.key)||Ha(e.wr,t.wr)}static Ar(e,t){return Ha(e.wr,t.wr)||es.comparator(e.key,t.key)}}class od{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new _s(sd.Er)}checkEmpty(e){return cs.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const r=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new $l(r,t,n,i);this.mutationQueue.push(a);for(const s of i)this.br=this.br.add(new sd(s.key,r)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast());return cs.resolve(a)}lookupMutationBatch(e,t){return cs.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.vr(n),r=i<0?0:i;return cs.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return cs.resolve(0===this.mutationQueue.length?-1:this.Sr-1)}getAllMutationBatches(e){return cs.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new sd(t,0),i=new sd(t,Number.POSITIVE_INFINITY),r=[];return this.br.forEachInRange([n,i],(e=>{const t=this.Dr(e.wr);r.push(t)})),cs.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new _s(Ha);return t.forEach((e=>{const t=new sd(e,0),i=new sd(e,Number.POSITIVE_INFINITY);this.br.forEachInRange([t,i],(e=>{n=n.add(e.wr)}))})),cs.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let r=n;es.isDocumentKey(r)||(r=r.child(""));const a=new sd(new es(r),0);let s=new _s(Ha);return this.br.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===i&&(s=s.add(e.wr)),!0)}),a),cs.resolve(this.Cr(s))}Cr(e){const t=[];return e.forEach((e=>{const n=this.Dr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Pa(0===this.Fr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.br;return cs.forEach(t.mutations,(i=>{const r=new sd(i.key,t.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.br=n}))}On(e){}containsKey(e,t){const n=new sd(t,0),i=this.br.firstAfterOrEqual(n);return cs.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,cs.resolve()}Fr(e,t){return this.vr(e)}vr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class ld{constructor(e){this.Mr=e,this.docs=new ks(es.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),r=i?i.size:0,a=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-r,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return cs.resolve(n?n.document.mutableCopy():so.newInvalidDocument(t))}getEntries(e,t){let n=el();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():so.newInvalidDocument(e))})),cs.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let r=el();const a=t.path,s=new es(a.child("")),o=this.docs.getIteratorFrom(s);for(;o.hasNext();){const{key:e,value:{document:s}}=o.getNext();if(!a.isPrefixOf(e.path))break;e.path.length>a.length+1||as(is(s),n)<=0||(i.has(s.key)||Go(t,s))&&(r=r.insert(s.key,s.mutableCopy()))}return cs.resolve(r)}getAllFromCollectionGroup(e,t,n,i){Ta()}Or(e,t){return cs.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new cd(this)}getSize(e){return cs.resolve(this.size)}}class cd extends Xc{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)})),cs.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}class dd{constructor(e){this.persistence=e,this.Nr=new Jo((e=>Io(e)),Ao),this.lastRemoteSnapshotVersion=Qa.min(),this.highestTargetId=0,this.Lr=0,this.Br=new ad,this.targetCount=0,this.kr=Jc.Bn()}forEachTarget(e,t){return this.Nr.forEach(((e,n)=>t(n))),cs.resolve()}getLastRemoteSnapshotVersion(e){return cs.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return cs.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),cs.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),cs.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Jc(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,cs.resolve()}updateTargetData(e,t){return this.Kn(t),cs.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,cs.resolve()}removeTargets(e,t,n){let i=0;const r=[];return this.Nr.forEach(((a,s)=>{s.sequenceNumber<=t&&null===n.get(s.targetId)&&(this.Nr.delete(a),r.push(this.removeMatchingKeysForTargetId(e,s.targetId)),i++)})),cs.waitFor(r).next((()=>i))}getTargetCount(e){return cs.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return cs.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),cs.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const i=this.persistence.referenceDelegate,r=[];return i&&t.forEach((t=>{r.push(i.markPotentiallyOrphaned(e,t))})),cs.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),cs.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return cs.resolve(n)}containsKey(e,t){return cs.resolve(this.Br.containsKey(t))}}class ud{constructor(e,t){this.qr={},this.overlays={},this.Qr=new hs(0),this.Kr=!1,this.Kr=!0,this.$r=new rd,this.referenceDelegate=e(this),this.Ur=new dd(this),this.indexManager=new Qc,this.remoteDocumentCache=function(e){return new ld(e)}((e=>this.referenceDelegate.Wr(e))),this.serializer=new Hc(t),this.Gr=new nd(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new id,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new od(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){_a("MemoryPersistence","Starting transaction:",e);const i=new hd(this.Qr.next());return this.referenceDelegate.zr(),n(i).next((e=>this.referenceDelegate.jr(i).next((()=>e)))).toPromise().then((e=>(i.raiseOnCommittedEvent(),e)))}Hr(e,t){return cs.or(Object.values(this.qr).map((n=>()=>n.containsKey(e,t))))}}class hd extends os{constructor(e){super(),this.currentSequenceNumber=e}}class pd{constructor(e){this.persistence=e,this.Jr=new ad,this.Yr=null}static Zr(e){return new pd(e)}get Xr(){if(this.Yr)return this.Yr;throw Ta()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),cs.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),cs.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),cs.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach((e=>this.Xr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Xr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return cs.forEach(this.Xr,(n=>{const i=es.fromPath(n);return this.ei(e,i).next((e=>{e||t.removeEntry(i,Qa.min())}))})).next((()=>(this.Yr=null,t.apply(e))))}updateLimboDocument(e,t){return this.ei(e,t).next((e=>{e?this.Xr.delete(t.toString()):this.Xr.add(t.toString())}))}Wr(e){return 0}ei(e,t){return cs.or([()=>cs.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class md{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=i}static Wi(e,t){let n=cl(),i=cl();for(const r of t.docChanges)switch(r.type){case 0:n=n.add(r.doc.key);break;case 1:i=i.add(r.doc.key)}return new md(e,t.fromCache,n,i)}}class fd{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class yd{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=se()?8:ds(re())>0?6:4}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,i){const r={result:null};return this.Yi(e,t).next((e=>{r.result=e})).next((()=>{if(!r.result)return this.Zi(e,t,i,n).next((e=>{r.result=e}))})).next((()=>{if(r.result)return;const n=new fd;return this.Xi(e,t,n).next((i=>{if(r.result=i,this.zi)return this.es(e,t,n,i.size)}))})).next((()=>r.result))}es(e,t,n,i){return n.documentReadCount<this.ji?(za()<=_e.DEBUG&&_a("QueryEngine","SDK will not create cache indexes for query:",Ko(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),cs.resolve()):(za()<=_e.DEBUG&&_a("QueryEngine","Query:",Ko(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(za()<=_e.DEBUG&&_a("QueryEngine","The SDK decides to create cache indexes for query:",Ko(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Vo(t))):cs.resolve())}Yi(e,t){if(Lo(t))return cs.resolve(null);let n=Vo(t);return this.indexManager.getIndexType(e,n).next((i=>0===i?null:(null!==t.limit&&1===i&&(t=Wo(t,null,"F"),n=Vo(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const r=cl(...i);return this.Ji.getDocuments(e,r).next((i=>this.indexManager.getMinOffset(e,n).next((n=>{const a=this.ts(t,i);return this.ns(t,a,r,n.readTime)?this.Yi(e,Wo(t,null,"F")):this.rs(e,a,t,n)}))))})))))}Zi(e,t,n,i){return Lo(t)||i.isEqual(Qa.min())?cs.resolve(null):this.Ji.getDocuments(e,n).next((r=>{const a=this.ts(t,r);return this.ns(t,a,n,i)?cs.resolve(null):(za()<=_e.DEBUG&&_a("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ko(t)),this.rs(e,a,t,ns(i,-1)).next((e=>e)))}))}ts(e,t){let n=new _s(Zo(e));return t.forEach(((t,i)=>{Go(e,i)&&(n=n.add(i))})),n}ns(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const r="F"===e.limitType?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Xi(e,t,n){return za()<=_e.DEBUG&&_a("QueryEngine","Using full collection scan to execute query:",Ko(t)),this.Ji.getDocumentsMatchingQuery(e,t,rs.min(),n)}rs(e,t,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class gd{constructor(e,t,n,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new ks(Ha),this._s=new Jo((e=>Io(e)),Ao),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new td(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.os)))}}function vd(e,t,n,i){return new gd(e,t,n,i)}async function wd(e,t){const n=Ia(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let i;return n.mutationQueue.getAllMutationBatches(e).next((r=>(i=r,n.ls(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const r=[],a=[];let s=cl();for(const e of i){r.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}for(const e of t){a.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}return n.localDocuments.getDocuments(e,s).next((e=>({hs:e,removedBatchIds:r,addedBatchIds:a})))}))}))}function xd(e){const t=Ia(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Ur.getLastRemoteSnapshotVersion(e)))}function bd(e,t,n){let i=cl(),r=cl();return n.forEach((e=>i=i.add(e))),t.getEntries(e,i).next((e=>{let i=el();return n.forEach(((n,a)=>{const s=e.get(n);a.isFoundDocument()!==s.isFoundDocument()&&(r=r.add(n)),a.isNoDocument()&&a.version.isEqual(Qa.min())?(t.removeEntry(n,a.readTime),i=i.insert(n,a)):!s.isValidDocument()||a.version.compareTo(s.version)>0||0===a.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(a),i=i.insert(n,a)):_a("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",a.version)})),{Ps:i,Is:r}}))}function jd(e,t){const n=Ia(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function kd(e,t){const n=Ia(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let i;return n.Ur.getTargetData(e,t).next((r=>r?(i=r,cs.resolve(i)):n.Ur.allocateTargetId(e).next((r=>(i=new qc(t,r,"TargetPurposeListen",e.currentSequenceNumber),n.Ur.addTargetData(e,i).next((()=>i)))))))})).then((e=>{const i=n.os.get(e.targetId);return(null===i||e.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(e.targetId,e),n._s.set(t,e.targetId)),e}))}async function Nd(e,t,n){const i=Ia(e),r=i.os.get(t),a=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",a,(e=>i.persistence.referenceDelegate.removeTarget(e,r)))}catch(e){if(!us(e))throw e;_a("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}i.os=i.os.remove(t),i._s.delete(r.target)}function zd(e,t,n){const i=Ia(e);let r=Qa.min(),a=cl();return i.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const i=Ia(e),r=i._s.get(n);return void 0!==r?cs.resolve(i.os.get(r)):i.Ur.getTargetData(t,n)}(i,e,Vo(t)).next((t=>{if(t)return r=t.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(e,t.targetId).next((e=>{a=e}))})).next((()=>i.ss.getDocumentsMatchingQuery(e,t,n?r:Qa.min(),n?a:cl()))).next((e=>(_d(i,Qo(t),e),{documents:e,Ts:a})))))}function _d(e,t,n){let i=e.us.get(t)||Qa.min();n.forEach(((e,t)=>{t.readTime.compareTo(i)>0&&(i=t.readTime)})),e.us.set(t,i)}class Sd{constructor(){this.activeTargetIds=ul()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ed{constructor(){this.so=new Sd,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Sd,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Cd{_o(e){}shutdown(){}}class Td{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){_a("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){_a("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Pd=null;function Id(){return null===Pd?Pd=268435456+Math.round(2147483648*Math.random()):Pd++,"0x"+Pd.toString(16)}const Ad={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Md{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}const Dd="WebChannelConnection";class Rd extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=t+"://"+e.host,this.vo=`projects/${n}/databases/${i}`,this.Co="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${i}`}get Fo(){return!1}Mo(e,t,n,i,r){const a=Id(),s=this.xo(e,t.toUriEncodedString());_a("RestConnection",`Sending RPC '${e}' ${a}:`,s,n);const o={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(o,i,r),this.No(e,s,o,n).then((t=>(_a("RestConnection",`Received RPC '${e}' ${a}: `,t),t)),(t=>{throw Ea("RestConnection",`RPC '${e}' ${a} failed with error: `,t,"url: ",s,"request:",n),t}))}Lo(e,t,n,i,r,a){return this.Mo(e,t,n,i,r)}Oo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+ka,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}xo(e,t){const n=Ad[e];return`${this.Do}/v1/${t}:${n}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,i){const r=Id();return new Promise(((a,s)=>{const o=new ua;o.setWithCredentials(!0),o.listenOnce(pa.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case ma.NO_ERROR:const t=o.getResponseJson();_a(Dd,`XHR for RPC '${e}' ${r} received:`,JSON.stringify(t)),a(t);break;case ma.TIMEOUT:_a(Dd,`RPC '${e}' ${r} timed out`),s(new Ma(Aa.DEADLINE_EXCEEDED,"Request time out"));break;case ma.HTTP_ERROR:const n=o.getStatus();if(_a(Dd,`RPC '${e}' ${r} failed with status:`,n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Aa).indexOf(t)>=0?t:Aa.UNKNOWN}(t.status);s(new Ma(e,t.message))}else s(new Ma(Aa.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Ma(Aa.UNAVAILABLE,"Connection failed."));break;default:Ta()}}finally{_a(Dd,`RPC '${e}' ${r} completed.`)}}));const l=JSON.stringify(i);_a(Dd,`RPC '${e}' ${r} sending request:`,i),o.send(t,"POST",l,n,15)}))}Bo(e,t,n){const i=Id(),r=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=va(),s=ga(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Oo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=r.join("");_a(Dd,`Creating RPC '${e}' stream ${i}: ${c}`,o);const d=a.createWebChannel(c,o);let u=!1,h=!1;const p=new Md({Io:t=>{h?_a(Dd,`Not sending because RPC '${e}' stream ${i} is closed:`,t):(u||(_a(Dd,`Opening RPC '${e}' stream ${i} transport.`),d.open(),u=!0),_a(Dd,`RPC '${e}' stream ${i} sending:`,t),d.send(t))},To:()=>d.close()}),m=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return m(d,ha.EventType.OPEN,(()=>{h||(_a(Dd,`RPC '${e}' stream ${i} transport opened.`),p.yo())})),m(d,ha.EventType.CLOSE,(()=>{h||(h=!0,_a(Dd,`RPC '${e}' stream ${i} transport closed`),p.So())})),m(d,ha.EventType.ERROR,(t=>{h||(h=!0,Ea(Dd,`RPC '${e}' stream ${i} transport errored:`,t),p.So(new Ma(Aa.UNAVAILABLE,"The operation could not be completed")))})),m(d,ha.EventType.MESSAGE,(t=>{var n;if(!h){const r=t.data[0];Pa(!!r);const a=r,s=a.error||(null===(n=a[0])||void 0===n?void 0:n.error);if(s){_a(Dd,`RPC '${e}' stream ${i} received error:`,s);const t=s.status;let n=function(e){const t=Kl[e];if(void 0!==t)return Zl(t)}(t),r=s.message;void 0===n&&(n=Aa.INTERNAL,r="Unknown error status: "+t+" with message "+s.message),h=!0,p.So(new Ma(n,r)),d.close()}else _a(Dd,`RPC '${e}' stream ${i} received:`,r),p.bo(r)}})),m(s,ya.STAT_EVENT,(t=>{t.stat===fa.PROXY?_a(Dd,`RPC '${e}' stream ${i} detected buffering proxy`):t.stat===fa.NOPROXY&&_a(Dd,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{p.wo()}),0),p}}function Od(){return"undefined"!=typeof document?document:null}function Ld(e){return new yc(e,!0)}class Fd{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ui=e,this.timerId=t,this.ko=n,this.qo=i,this.Qo=r,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-n);i>0&&_a("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,(()=>(this.Uo=Date.now(),e()))),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){null!==this.$o&&(this.$o.skipDelay(),this.$o=null)}cancel(){null!==this.$o&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}class Ud{constructor(e,t,n,i,r,a,s,o){this.ui=e,this.Ho=n,this.Jo=i,this.connection=r,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=s,this.listener=o,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Fd(e,t)}n_(){return 1===this.state||5===this.state||this.r_()}r_(){return 2===this.state||3===this.state}start(){this.e_=0,4!==this.state?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&null===this.Zo&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,(()=>this.__())))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,4!==e?this.t_.reset():t&&t.code===Aa.RESOURCE_EXHAUSTED?(Sa(t.toString()),Sa("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===Aa.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,i]=e;this.Yo===t&&this.P_(n,i)}),(t=>{e((()=>{const e=new Ma(Aa.UNKNOWN,"Fetching auth token failed: "+t.message);return this.I_(e)}))}))}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo((()=>{n((()=>this.listener.Eo()))})),this.stream.Ro((()=>{n((()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,(()=>(this.r_()&&(this.state=3),Promise.resolve()))),this.listener.Ro())))})),this.stream.mo((e=>{n((()=>this.I_(e)))})),this.stream.onMessage((e=>{n((()=>1==++this.e_?this.E_(e):this.onNext(e)))}))}i_(){this.state=5,this.t_.Go((async()=>{this.state=0,this.start()}))}I_(e){return _a("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget((()=>this.Yo===e?t():(_a("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Vd extends Ud{constructor(e,t,n,i,r,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,a),this.serializer=r}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Ta()}(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],a=function(e,t){return e.useProto3Json?(Pa(void 0===t||"string"==typeof t),Ts.fromBase64String(t||"")):(Pa(void 0===t||t instanceof Buffer||t instanceof Uint8Array),Ts.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,o=s&&function(e){const t=void 0===e.code?Aa.UNKNOWN:Zl(e.code);return new Ma(t,e.message||"")}(s);n=new lc(i,r,a,o||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const r=_c(e,i.document.name),a=bc(i.document.updateTime),s=i.document.createTime?bc(i.document.createTime):Qa.min(),o=new ro({mapValue:{fields:i.document.fields}}),l=so.newFoundDocument(r,a,s,o),c=i.targetIds||[],d=i.removedTargetIds||[];n=new sc(c,d,l.key,l)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const r=_c(e,i.document),a=i.readTime?bc(i.readTime):Qa.min(),s=so.newNoDocument(r,a),o=i.removedTargetIds||[];n=new sc([],o,s.key,s)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const r=_c(e,i.document),a=i.removedTargetIds||[];n=new sc([],a,r,null)}else{if(!("filter"in t))return Ta();{t.filter;const e=t.filter;e.targetId;const{count:i=0,unchangedNames:r}=e,a=new Hl(i,r),s=e.targetId;n=new oc(s,a)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Qa.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Qa.min():t.readTime?bc(t.readTime):Qa.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=Cc(this.serializer),t.addTarget=function(e,t){let n;const i=t.target;if(n=Mo(i)?{documents:Ac(e,i)}:{query:Mc(e,i)._t},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=wc(e,t.resumeToken);const i=gc(e,t.expectedCount);null!==i&&(n.expectedCount=i)}else if(t.snapshotVersion.compareTo(Qa.min())>0){n.readTime=vc(e,t.snapshotVersion.toTimestamp());const i=gc(e,t.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ta()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=Cc(this.serializer),t.removeTarget=e,this.a_(t)}}class Bd extends Ud{constructor(e,t,n,i,r,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,a),this.serializer=r}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Pa(!!e.streamToken),this.lastStreamToken=e.streamToken,Pa(!e.writeResults||0===e.writeResults.length),this.listener.f_()}onNext(e){Pa(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=function(e,t){return e&&e.length>0?(Pa(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?bc(e.updateTime):bc(t);return n.isEqual(Qa.min())&&(n=bc(t)),new Sl(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=bc(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=Cc(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Ic(this.serializer,e)))};this.a_(t)}}class $d extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new Ma(Aa.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((r=>{let[a,s]=r;return this.connection.Mo(e,kc(t,n),i,a,s)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Aa.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Ma(Aa.UNKNOWN,e.toString())}))}Lo(e,t,n,i,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((a=>{let[s,o]=a;return this.connection.Lo(e,kc(t,n),i,s,o,r)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Aa.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Ma(Aa.UNKNOWN,e.toString())}))}terminate(){this.y_=!0,this.connection.terminate()}}class Wd{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){0===this.S_&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve()))))}M_(e){"Online"===this.state?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,"Online"===e&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Sa(t),this.D_=!1):_a("OnlineStateTracker",t)}x_(){null!==this.b_&&(this.b_.cancel(),this.b_=null)}}class qd{constructor(e,t,n,i,r){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=r,this.k_._o((e=>{n.enqueueAndForget((async()=>{eu(this)&&(_a("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Ia(e);t.L_.add(4),await Kd(t),t.q_.set("Unknown"),t.L_.delete(4),await Hd(t)}(this))}))})),this.q_=new Wd(n,i)}}async function Hd(e){if(eu(e))for(const t of e.B_)await t(!0)}async function Kd(e){for(const t of e.B_)await t(!1)}function Gd(e,t){const n=Ia(e);n.N_.has(t.targetId)||(n.N_.set(t.targetId,t),Xd(n)?Jd(n):wu(n).r_()&&Zd(n,t))}function Qd(e,t){const n=Ia(e),i=wu(n);n.N_.delete(t),i.r_()&&Yd(n,t),0===n.N_.size&&(i.r_()?i.o_():eu(n)&&n.q_.set("Unknown"))}function Zd(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Qa.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}wu(e).A_(t)}function Yd(e,t){e.Q_.xe(t),wu(e).R_(t)}function Jd(e){e.Q_=new dc({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),wu(e).start(),e.q_.v_()}function Xd(e){return eu(e)&&!wu(e).n_()&&e.N_.size>0}function eu(e){return 0===Ia(e).L_.size}function tu(e){e.Q_=void 0}async function nu(e){e.q_.set("Online")}async function iu(e){e.N_.forEach(((t,n)=>{Zd(e,t)}))}async function ru(e,t){tu(e),Xd(e)?(e.q_.M_(t),Jd(e)):e.q_.set("Unknown")}async function au(e,t,n){if(e.q_.set("Online"),t instanceof lc&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const i of t.targetIds)e.N_.has(i)&&(await e.remoteSyncer.rejectListen(i,n),e.N_.delete(i),e.Q_.removeTarget(i))}(e,t)}catch(n){_a("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await su(e,n)}else if(t instanceof sc?e.Q_.Ke(t):t instanceof oc?e.Q_.He(t):e.Q_.We(t),!n.isEqual(Qa.min()))try{const t=await xd(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Q_.rt(t);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=e.N_.get(i);r&&e.N_.set(i,r.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const i=e.N_.get(t);if(!i)return;e.N_.set(t,i.withResumeToken(Ts.EMPTY_BYTE_STRING,i.snapshotVersion)),Yd(e,t);const r=new qc(i.target,t,n,i.sequenceNumber);Zd(e,r)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){_a("RemoteStore","Failed to raise snapshot:",t),await su(e,t)}}async function su(e,t,n){if(!us(t))throw t;e.L_.add(1),await Kd(e),e.q_.set("Offline"),n||(n=()=>xd(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{_a("RemoteStore","Retrying IndexedDB access"),await n(),e.L_.delete(1),await Hd(e)}))}function ou(e,t){return t().catch((n=>su(e,n,t)))}async function lu(e){const t=Ia(e),n=xu(t);let i=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;cu(t);)try{const e=await jd(t.localStore,i);if(null===e){0===t.O_.length&&n.o_();break}i=e.batchId,du(t,e)}catch(e){await su(t,e)}uu(t)&&hu(t)}function cu(e){return eu(e)&&e.O_.length<10}function du(e,t){e.O_.push(t);const n=xu(e);n.r_()&&n.V_&&n.m_(t.mutations)}function uu(e){return eu(e)&&!xu(e).n_()&&e.O_.length>0}function hu(e){xu(e).start()}async function pu(e){xu(e).p_()}async function mu(e){const t=xu(e);for(const n of e.O_)t.m_(n.mutations)}async function fu(e,t,n){const i=e.O_.shift(),r=Wl.from(i,t,n);await ou(e,(()=>e.remoteSyncer.applySuccessfulWrite(r))),await lu(e)}async function yu(e,t){t&&xu(e).V_&&await async function(e,t){if(function(e){return Ql(e)&&e!==Aa.ABORTED}(t.code)){const n=e.O_.shift();xu(e).s_(),await ou(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await lu(e)}}(e,t),uu(e)&&hu(e)}async function gu(e,t){const n=Ia(e);n.asyncQueue.verifyOperationInProgress(),_a("RemoteStore","RemoteStore received new credentials");const i=eu(n);n.L_.add(3),await Kd(n),i&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.L_.delete(3),await Hd(n)}async function vu(e,t){const n=Ia(e);t?(n.L_.delete(2),await Hd(n)):t||(n.L_.add(2),await Kd(n),n.q_.set("Unknown"))}function wu(e){return e.K_||(e.K_=function(e,t,n){const i=Ia(e);return i.w_(),new Vd(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{Eo:nu.bind(null,e),Ro:iu.bind(null,e),mo:ru.bind(null,e),d_:au.bind(null,e)}),e.B_.push((async t=>{t?(e.K_.s_(),Xd(e)?Jd(e):e.q_.set("Unknown")):(await e.K_.stop(),tu(e))}))),e.K_}function xu(e){return e.U_||(e.U_=function(e,t,n){const i=Ia(e);return i.w_(),new Bd(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:pu.bind(null,e),mo:yu.bind(null,e),f_:mu.bind(null,e),g_:fu.bind(null,e)}),e.B_.push((async t=>{t?(e.U_.s_(),await lu(e)):(await e.U_.stop(),e.O_.length>0&&(_a("RemoteStore",`Stopping write stream with ${e.O_.length} pending writes`),e.O_=[]))}))),e.U_}class bu{constructor(e,t,n,i,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new Da,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,r){const a=Date.now()+n,s=new bu(e,t,a,i,r);return s.start(n),s}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ma(Aa.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ju(e,t){if(Sa("AsyncQueue",`${t}: ${e}`),us(e))return new Ma(Aa.UNAVAILABLE,`${t}: ${e}`);throw e}class ku{constructor(e){this.comparator=e?(t,n)=>e(t,n)||es.comparator(t.key,n.key):(e,t)=>es.comparator(e.key,t.key),this.keyedMap=nl(),this.sortedSet=new ks(this.comparator)}static emptySet(e){return new ku(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ku))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(!e.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new ku;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Nu{constructor(){this.W_=new ks(es.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?0!==e.type&&3===n.type?this.W_=this.W_.insert(t,e):3===e.type&&1!==n.type?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.W_=this.W_.remove(t):1===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Ta():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class zu{constructor(e,t,n,i,r,a,s,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=a,this.syncStateChanged=s,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,i,r){const a=[];return t.forEach((e=>{a.push({type:0,doc:e})})),new zu(e,t,ku.emptySet(t),a,n,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&qo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}class _u{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some((e=>e.J_()))}}class Su{constructor(){this.queries=Eu(),this.onlineState="Unknown",this.Y_=new Set}terminate(){!function(e,t){const n=Ia(e),i=n.queries;n.queries=Eu(),i.forEach(((e,n)=>{for(const i of n.j_)i.onError(t)}))}(this,new Ma(Aa.ABORTED,"Firestore shutting down"))}}function Eu(){return new Jo((e=>Ho(e)),qo)}async function Cu(e,t){const n=Ia(e);let i=3;const r=t.query;let a=n.queries.get(r);a?!a.H_()&&t.J_()&&(i=2):(a=new _u,i=t.J_()?0:1);try{switch(i){case 0:a.z_=await n.onListen(r,!0);break;case 1:a.z_=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(e){const n=ju(e,`Initialization of query '${Ko(t.query)}' failed`);return void t.onError(n)}n.queries.set(r,a),a.j_.push(t),t.Z_(n.onlineState),a.z_&&t.X_(a.z_)&&Au(n)}async function Tu(e,t){const n=Ia(e),i=t.query;let r=3;const a=n.queries.get(i);if(a){const e=a.j_.indexOf(t);e>=0&&(a.j_.splice(e,1),0===a.j_.length?r=t.J_()?0:1:!a.H_()&&t.J_()&&(r=2))}switch(r){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function Pu(e,t){const n=Ia(e);let i=!1;for(const r of t){const e=r.query,t=n.queries.get(e);if(t){for(const e of t.j_)e.X_(r)&&(i=!0);t.z_=r}}i&&Au(n)}function Iu(e,t,n){const i=Ia(e),r=i.queries.get(t);if(r)for(const a of r.j_)a.onError(n);i.queries.delete(t)}function Au(e){e.Y_.forEach((e=>{e.next()}))}var Mu,Du;(Du=Mu||(Mu={})).ea="default",Du.Cache="cache";class Ru{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new zu(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache)return!0;if(!this.J_())return!0;const n="Offline"!==t;return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}oa(e){e=zu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Mu.Cache}}class Ou{constructor(e){this.key=e}}class Lu{constructor(e){this.key=e}}class Fu{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=cl(),this.mutatedKeys=cl(),this.Aa=Zo(e),this.Ra=new ku(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new Nu,i=t?t.Ra:this.Ra;let r=t?t.mutatedKeys:this.mutatedKeys,a=i,s=!1;const o="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((e,t)=>{const c=i.get(e),d=Go(this.query,t)?t:null,u=!!c&&this.mutatedKeys.has(c.key),h=!!d&&(d.hasLocalMutations||this.mutatedKeys.has(d.key)&&d.hasCommittedMutations);let p=!1;c&&d?c.data.isEqual(d.data)?u!==h&&(n.track({type:3,doc:d}),p=!0):this.ga(c,d)||(n.track({type:2,doc:d}),p=!0,(o&&this.Aa(d,o)>0||l&&this.Aa(d,l)<0)&&(s=!0)):!c&&d?(n.track({type:0,doc:d}),p=!0):c&&!d&&(n.track({type:1,doc:c}),p=!0,(o||l)&&(s=!0)),p&&(d?(a=a.add(d),r=h?r.add(e):r.delete(e)):(a=a.delete(e),r=r.delete(e)))})),null!==this.query.limit)for(;a.size>this.query.limit;){const e="F"===this.query.limitType?a.last():a.first();a=a.delete(e.key),r=r.delete(e.key),n.track({type:1,doc:e})}return{Ra:a,fa:n,ns:s,mutatedKeys:r}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const r=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ta()}};return n(e)-n(t)}(e.type,t.type)||this.Aa(e.doc,t.doc))),this.pa(n),i=null!=i&&i;const s=t&&!i?this.ya():[],o=0===this.da.size&&this.current&&!i?1:0,l=o!==this.Ea;return this.Ea=o,0!==a.length||l?{snapshot:new zu(this.query,e.Ra,r,a,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:s}:{wa:s}}Z_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Nu,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach((e=>this.Ta=this.Ta.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Ta=this.Ta.delete(e))),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=cl(),this.Ra.forEach((e=>{this.Sa(e.key)&&(this.da=this.da.add(e.key))}));const t=[];return e.forEach((e=>{this.da.has(e)||t.push(new Lu(e))})),this.da.forEach((n=>{e.has(n)||t.push(new Ou(n))})),t}ba(e){this.Ta=e.Ts,this.da=cl();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return zu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,0===this.Ea,this.hasCachedResults)}}class Uu{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Vu{constructor(e){this.key=e,this.va=!1}}class Bu{constructor(e,t,n,i,r,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Jo((e=>Ho(e)),qo),this.Ma=new Map,this.xa=new Set,this.Oa=new ks(es.comparator),this.Na=new Map,this.La=new ad,this.Ba={},this.ka=new Map,this.qa=Jc.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return!0===this.Qa}}async function $u(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=dh(e);let r;const a=i.Fa.get(t);return a?(i.sharedClientState.addLocalQueryTarget(a.targetId),r=a.view.Da()):r=await qu(i,t,n,!0),r}async function Wu(e,t){const n=dh(e);await qu(n,t,!0,!1)}async function qu(e,t,n,i){const r=await kd(e.localStore,Vo(t)),a=r.targetId,s=e.sharedClientState.addLocalQueryTarget(a,n);let o;return i&&(o=await Hu(e,t,a,"current"===s,r.resumeToken)),e.isPrimaryClient&&n&&Gd(e.remoteStore,r),o}async function Hu(e,t,n,i,r){e.Ka=(t,n,i)=>async function(e,t,n,i){let r=t.view.ma(n);r.ns&&(r=await zd(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.ma(n,r)})));const a=i&&i.targetChanges.get(t.targetId),s=i&&null!=i.targetMismatches.get(t.targetId),o=t.view.applyChanges(r,e.isPrimaryClient,a,s);return rh(e,t.targetId,o.wa),o.snapshot}(e,t,n,i);const a=await zd(e.localStore,t,!0),s=new Fu(t,a.Ts),o=s.ma(a.documents),l=ac.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==e.onlineState,r),c=s.applyChanges(o,e.isPrimaryClient,l);rh(e,n,c.wa);const d=new Uu(t,n,s);return e.Fa.set(t,d),e.Ma.has(n)?e.Ma.get(n).push(t):e.Ma.set(n,[t]),c.snapshot}async function Ku(e,t,n){const i=Ia(e),r=i.Fa.get(t),a=i.Ma.get(r.targetId);if(a.length>1)return i.Ma.set(r.targetId,a.filter((e=>!qo(e,t)))),void i.Fa.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await Nd(i.localStore,r.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(r.targetId),n&&Qd(i.remoteStore,r.targetId),nh(i,r.targetId)})).catch(ls)):(nh(i,r.targetId),await Nd(i.localStore,r.targetId,!0))}async function Gu(e,t){const n=Ia(e),i=n.Fa.get(t),r=n.Ma.get(i.targetId);n.isPrimaryClient&&1===r.length&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),Qd(n.remoteStore,i.targetId))}async function Qu(e,t){const n=Ia(e);try{const e=await function(e,t){const n=Ia(e),i=t.snapshotVersion;let r=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});r=n.os;const s=[];t.targetChanges.forEach(((a,o)=>{const l=r.get(o);if(!l)return;s.push(n.Ur.removeMatchingKeys(e,a.removedDocuments,o).next((()=>n.Ur.addMatchingKeys(e,a.addedDocuments,o))));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(Ts.EMPTY_BYTE_STRING,Qa.min()).withLastLimboFreeSnapshotVersion(Qa.min()):a.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(a.resumeToken,i)),r=r.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,c,a)&&s.push(n.Ur.updateTargetData(e,c))}));let o=el(),l=cl();if(t.documentUpdates.forEach((i=>{t.resolvedLimboDocuments.has(i)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(e,i))})),s.push(bd(e,a,t.documentUpdates).next((e=>{o=e.Ps,l=e.Is}))),!i.isEqual(Qa.min())){const t=n.Ur.getLastRemoteSnapshotVersion(e).next((t=>n.Ur.setTargetsMetadata(e,e.currentSequenceNumber,i)));s.push(t)}return cs.waitFor(s).next((()=>a.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,o,l))).next((()=>o))})).then((e=>(n.os=r,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const i=n.Na.get(t);i&&(Pa(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?i.va=!0:e.modifiedDocuments.size>0?Pa(i.va):e.removedDocuments.size>0&&(Pa(i.va),i.va=!1))})),await oh(n,e,t)}catch(e){await ls(e)}}function Zu(e,t,n){const i=Ia(e);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const e=[];i.Fa.forEach(((n,i)=>{const r=i.view.Z_(t);r.snapshot&&e.push(r.snapshot)})),function(e,t){const n=Ia(e);n.onlineState=t;let i=!1;n.queries.forEach(((e,n)=>{for(const r of n.j_)r.Z_(t)&&(i=!0)})),i&&Au(n)}(i.eventManager,t),e.length&&i.Ca.d_(e),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function Yu(e,t,n){const i=Ia(e);i.sharedClientState.updateQueryState(t,"rejected",n);const r=i.Na.get(t),a=r&&r.key;if(a){let e=new ks(es.comparator);e=e.insert(a,so.newNoDocument(a,Qa.min()));const n=cl().add(a),r=new rc(Qa.min(),new Map,new ks(Ha),e,n);await Qu(i,r),i.Oa=i.Oa.remove(a),i.Na.delete(t),sh(i)}else await Nd(i.localStore,t,!1).then((()=>nh(i,t,n))).catch(ls)}async function Ju(e,t){const n=Ia(e),i=t.batch.batchId;try{const e=await function(e,t){const n=Ia(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const i=t.batch.keys(),r=n.cs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,i){const r=n.batch,a=r.keys();let s=cs.resolve();return a.forEach((e=>{s=s.next((()=>i.getEntry(t,e))).next((t=>{const a=n.docVersions.get(e);Pa(null!==a),t.version.compareTo(a)<0&&(r.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),i.addEntry(t)))}))})),s.next((()=>e.mutationQueue.removeMutationBatch(t,r)))}(n,e,t,r).next((()=>r.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=cl();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,i)))}))}(n.localStore,t);th(n,i,null),eh(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await oh(n,e)}catch(e){await ls(e)}}async function Xu(e,t,n){const i=Ia(e);try{const e=await function(e,t){const n=Ia(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let i;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(Pa(null!==t),i=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,i))).next((()=>n.localDocuments.getDocuments(e,i)))}))}(i.localStore,t);th(i,t,n),eh(i,t),i.sharedClientState.updateMutationState(t,"rejected",n),await oh(i,e)}catch(n){await ls(n)}}function eh(e,t){(e.ka.get(t)||[]).forEach((e=>{e.resolve()})),e.ka.delete(t)}function th(e,t,n){const i=Ia(e);let r=i.Ba[i.currentUser.toKey()];if(r){const e=r.get(t);e&&(n?e.reject(n):e.resolve(),r=r.remove(t)),i.Ba[i.currentUser.toKey()]=r}}function nh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.Ma.get(t))e.Fa.delete(i),n&&e.Ca.$a(i,n);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach((t=>{e.La.containsKey(t)||ih(e,t)}))}function ih(e,t){e.xa.delete(t.path.canonicalString());const n=e.Oa.get(t);null!==n&&(Qd(e.remoteStore,n),e.Oa=e.Oa.remove(t),e.Na.delete(n),sh(e))}function rh(e,t,n){for(const i of n)i instanceof Ou?(e.La.addReference(i.key,t),ah(e,i)):i instanceof Lu?(_a("SyncEngine","Document no longer in limbo: "+i.key),e.La.removeReference(i.key,t),e.La.containsKey(i.key)||ih(e,i.key)):Ta()}function ah(e,t){const n=t.key,i=n.path.canonicalString();e.Oa.get(n)||e.xa.has(i)||(_a("SyncEngine","New document in limbo: "+n),e.xa.add(i),sh(e))}function sh(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const n=new es(Ya.fromString(t)),i=e.qa.next();e.Na.set(i,new Vu(n)),e.Oa=e.Oa.insert(n,i),Gd(e.remoteStore,new qc(Vo(Oo(n.path)),i,"TargetPurposeLimboResolution",hs.oe))}}async function oh(e,t,n){const i=Ia(e),r=[],a=[],s=[];i.Fa.isEmpty()||(i.Fa.forEach(((e,o)=>{s.push(i.Ka(o,t,n).then((e=>{var t;if((e||n)&&i.isPrimaryClient){const r=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;i.sharedClientState.updateQueryState(o.targetId,r?"current":"not-current")}if(e){r.push(e);const t=md.Wi(o.targetId,e);a.push(t)}})))})),await Promise.all(s),i.Ca.d_(r),await async function(e,t){const n=Ia(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>cs.forEach(t,(t=>cs.forEach(t.$i,(i=>n.persistence.referenceDelegate.addReference(e,t.targetId,i))).next((()=>cs.forEach(t.Ui,(i=>n.persistence.referenceDelegate.removeReference(e,t.targetId,i)))))))))}catch(e){if(!us(e))throw e;_a("LocalStore","Failed to update sequence numbers: "+e)}for(const i of t){const e=i.targetId;if(!i.fromCache){const t=n.os.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.os=n.os.insert(e,r)}}}(i.localStore,a))}async function lh(e,t){const n=Ia(e);if(!n.currentUser.isEqual(t)){_a("SyncEngine","User change. New user:",t.toKey());const e=await wd(n.localStore,t);n.currentUser=t,function(e,t){e.ka.forEach((e=>{e.forEach((e=>{e.reject(new Ma(Aa.CANCELLED,t))}))})),e.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await oh(n,e.hs)}}function ch(e,t){const n=Ia(e),i=n.Na.get(t);if(i&&i.va)return cl().add(i.key);{let e=cl();const i=n.Ma.get(t);if(!i)return e;for(const t of i){const i=n.Fa.get(t);e=e.unionWith(i.view.Va)}return e}}function dh(e){const t=Ia(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Qu.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=ch.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Yu.bind(null,t),t.Ca.d_=Pu.bind(null,t.eventManager),t.Ca.$a=Iu.bind(null,t.eventManager),t}function uh(e){const t=Ia(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Ju.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Xu.bind(null,t),t}class hh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ld(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return vd(this.persistence,new yd,e.initialUser,this.serializer)}Ga(e){return new ud(pd.Zr,this.serializer)}Wa(e){return new Ed}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}hh.provider={build:()=>new hh};class ph{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Zu(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=lh.bind(null,this.syncEngine),await vu(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Su}createDatastore(e){const t=Ld(e.databaseInfo.databaseId),n=function(e){return new Rd(e)}(e.databaseInfo);return function(e,t,n,i){return new $d(e,t,n,i)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,i,r){return new qd(e,t,n,i,r)}(this.localStore,this.datastore,e.asyncQueue,(e=>Zu(this.syncEngine,e,0)),Td.D()?new Td:new Cd)}createSyncEngine(e,t){return function(e,t,n,i,r,a,s){const o=new Bu(e,t,n,i,r,a);return s&&(o.Qa=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=Ia(e);_a("RemoteStore","RemoteStore shutting down."),t.L_.add(5),await Kd(t),t.k_.shutdown(),t.q_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}ph.provider={build:()=>new ph};class mh{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Sa("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class fh{constructor(e,t,n,i,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=ja.UNAUTHENTICATED,this.clientId=qa.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(n,(async e=>{_a("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(_a("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Da;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=ju(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function yh(e,t){e.asyncQueue.verifyOperationInProgress(),_a("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener((async e=>{i.isEqual(e)||(await wd(t.localStore,e),i=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function gh(e,t){e.asyncQueue.verifyOperationInProgress();const n=await vh(e);_a("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>gu(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>gu(t.remoteStore,n))),e._onlineComponents=t}async function vh(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){_a("FirestoreClient","Using user provided OfflineComponentProvider");try{await yh(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===Aa.FAILED_PRECONDITION||e.code===Aa.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;Ea("Error using user provided cache. Falling back to memory cache: "+n),await yh(e,new hh)}}else _a("FirestoreClient","Using default OfflineComponentProvider"),await yh(e,new hh);return e._offlineComponents}async function wh(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(_a("FirestoreClient","Using user provided OnlineComponentProvider"),await gh(e,e._uninitializedComponentsProvider._online)):(_a("FirestoreClient","Using default OnlineComponentProvider"),await gh(e,new ph))),e._onlineComponents}function xh(e){return wh(e).then((e=>e.syncEngine))}async function bh(e){const t=await wh(e),n=t.eventManager;return n.onListen=$u.bind(null,t.syncEngine),n.onUnlisten=Ku.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Wu.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Gu.bind(null,t.syncEngine),n}function jh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=new Da;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,i,r){const a=new mh({next:o=>{a.Za(),t.enqueueAndForget((()=>Tu(e,s)));const l=o.docs.has(n);!l&&o.fromCache?r.reject(new Ma(Aa.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&i&&"server"===i.source?r.reject(new Ma(Aa.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(o)},error:e=>r.reject(e)}),s=new Ru(Oo(n.path),a,{includeMetadataChanges:!0,_a:!0});return Cu(e,s)}(await bh(e),e.asyncQueue,t,n,i))),i.promise}function kh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=new Da;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,i,r){const a=new mh({next:n=>{a.Za(),t.enqueueAndForget((()=>Tu(e,s))),n.fromCache&&"server"===i.source?r.reject(new Ma(Aa.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(n)},error:e=>r.reject(e)}),s=new Ru(n,a,{includeMetadataChanges:!0,_a:!0});return Cu(e,s)}(await bh(e),e.asyncQueue,t,n,i))),i.promise}function Nh(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const zh=new Map;function _h(e,t,n){if(!n)throw new Ma(Aa.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Sh(e){if(!es.isDocumentKey(e))throw new Ma(Aa.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Eh(e){if(es.isDocumentKey(e))throw new Ma(Aa.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Ch(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Ta()}function Th(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Ma(Aa.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ch(e);throw new Ma(Aa.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}class Ph{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Ma(Aa.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Ma(Aa.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,i){if(!0===t&&!0===i)throw new Ma(Aa.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Nh(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Ma(Aa.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Ma(Aa.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Ma(Aa.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ih{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ph({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ma(Aa.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Ma(Aa.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ph(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Oa;switch(e.type){case"firstParty":return new Va(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Ma(Aa.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=zh.get(e);t&&(_a("ComponentProvider","Removing Datastore"),zh.delete(e),t.terminate())}(this),Promise.resolve()}}function Ah(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var r;const a=(e=Th(e,Ih))._getSettings(),s=`${t}:${n}`;if("firestore.googleapis.com"!==a.host&&a.host!==s&&Ea("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},a),{host:s,ssl:!1})),i.mockUserToken){let t,n;if("string"==typeof i.mockUserToken)t=i.mockUserToken,n=ja.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,r=e.sub||e.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Z(JSON.stringify({alg:"none",type:"JWT"})),Z(JSON.stringify(a)),""].join(".")}(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);const a=i.mockUserToken.sub||i.mockUserToken.user_id;if(!a)throw new Ma(Aa.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new ja(a)}e._authCredentials=new La(new Ra(t,n))}}class Mh{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Mh(this.firestore,e,this._query)}}class Dh{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rh(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Dh(this.firestore,e,this._key)}}class Rh extends Mh{constructor(e,t,n){super(e,t,Oo(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Dh(this.firestore,null,new es(e))}withConverter(e){return new Rh(this.firestore,e,this._path)}}function Oh(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];if(e=xe(e),_h("collection","path",t),e instanceof Ih){const n=Ya.fromString(t,...i);return Eh(n),new Rh(e,null,n)}{if(!(e instanceof Dh||e instanceof Rh))throw new Ma(Aa.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ya.fromString(t,...i));return Eh(n),new Rh(e.firestore,null,n)}}function Lh(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];if(e=xe(e),1===arguments.length&&(t=qa.newId()),_h("doc","path",t),e instanceof Ih){const n=Ya.fromString(t,...i);return Sh(n),new Dh(e,null,new es(n))}{if(!(e instanceof Dh||e instanceof Rh))throw new Ma(Aa.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ya.fromString(t,...i));return Sh(n),new Dh(e.firestore,e instanceof Rh?e.converter:null,new es(n))}}class Fh{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Fd(this,"async_queue_retry"),this.Vu=()=>{const e=Od();e&&_a("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()},this.mu=e;const t=Od();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Od();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise((()=>{}));const t=new Da;return this.gu((()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Pu.push(e),this.pu())))}async pu(){if(0!==this.Pu.length){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!us(e))throw e;_a("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go((()=>this.pu()))}}gu(e){const t=this.mu.then((()=>(this.du=!0,e().catch((e=>{this.Eu=e,this.du=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Sa("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.du=!1,e))))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=bu.createAndSchedule(this,e,t,n,(e=>this.yu(e)));return this.Tu.push(i),i}fu(){this.Eu&&Ta()}verifyOperationInProgress(){}async wu(){let e;do{e=this.mu,await e}while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then((()=>{this.Tu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.Tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.wu()}))}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}class Uh extends Ih{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new Fh,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Fh(e),this._firestoreClient=void 0,await e}}}function Vh(e){if(e._terminated)throw new Ma(Aa.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Bh(e),e._firestoreClient}function Bh(e){var t,n,i;const r=e._freezeSettings(),a=function(e,t,n,i){return new Ls(e,t,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,Nh(i.experimentalLongPollingOptions),i.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,r);e._componentsProvider||(null===(n=r.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(e._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),e._firestoreClient=new fh(e._authCredentials,e._appCheckCredentials,e._queue,a,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class $h{constructor(e){this._byteString=e}static fromBase64String(e){try{return new $h(Ts.fromBase64String(e))}catch(e){throw new Ma(Aa.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new $h(Ts.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Wh{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let i=0;i<t.length;++i)if(0===t[i].length)throw new Ma(Aa.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xa(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class qh{constructor(e){this._methodName=e}}class Hh{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ma(Aa.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ma(Aa.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ha(this._lat,e._lat)||Ha(this._long,e._long)}}class Kh{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const Gh=/^__.*__$/;class Qh{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Ol(e,this.data,this.fieldMask,t,this.fieldTransforms):new Rl(e,this.data,t,this.fieldTransforms)}}function Zh(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ta()}}class Yh{constructor(e,t,n,i,r,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.vu(),this.fieldTransforms=r||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Yh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return cp(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(0===e.length)throw this.Bu("Document fields must not be empty");if(Zh(this.Cu)&&Gh.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Jh{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Ld(e)}Qu(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Yh({Cu:e,methodName:t,qu:n,path:Xa.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xh(e){const t=e._freezeSettings(),n=Ld(e._databaseId);return new Jh(e._databaseId,!!t.ignoreUndefinedProperties,n)}function ep(e,t,n,i,r){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const s=e.Qu(a.merge||a.mergeFields?2:0,t,n,r);ap("Data must be an object, but it was:",s,i);const o=ip(i,s);let l,c;if(a.merge)l=new Es(s.fieldMask),c=s.fieldTransforms;else if(a.mergeFields){const e=[];for(const i of a.mergeFields){const r=sp(t,i,n);if(!s.contains(r))throw new Ma(Aa.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);dp(e,r)||e.push(r)}l=new Es(e),c=s.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,c=s.fieldTransforms;return new Qh(new ro(o),l,c)}function tp(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return np(n,e.Qu(i?4:3,t))}function np(e,t){if(rp(e=xe(e)))return ap("Unsupported field value:",t,e),ip(e,t);if(e instanceof qh)return function(e,t){if(!Zh(t.Cu))throw t.Bu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Bu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&4!==t.Cu)throw t.Bu("Nested arrays are not supported");return function(e,t){const n=[];let i=0;for(const r of e){let e=np(r,t.Lu(i));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),i++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=xe(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return ml(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Ga.fromDate(e);return{timestampValue:vc(t.serializer,n)}}if(e instanceof Ga){const n=new Ga(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:vc(t.serializer,n)}}if(e instanceof Hh)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof $h)return{bytesValue:wc(t.serializer,e._byteString)};if(e instanceof Dh){const n=t.databaseId,i=e.firestore._databaseId;if(!i.isEqual(n))throw t.Bu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:jc(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Kh)return function(e,t){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw t.Bu("VectorValues must only contain numeric values.");return hl(t.serializer,e)}))}}}}}}(e,t);throw t.Bu(`Unsupported field value: ${Ch(e)}`)}(e,t)}function ip(e,t){const n={};return js(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):bs(e,((e,i)=>{const r=np(i,t.Mu(e));null!=r&&(n[e]=r)})),{mapValue:{fields:n}}}function rp(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Ga||e instanceof Hh||e instanceof $h||e instanceof Dh||e instanceof qh||e instanceof Kh)}function ap(e,t,n){if(!rp(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const i=Ch(n);throw"an object"===i?t.Bu(e+" a custom object"):t.Bu(e+" "+i)}}function sp(e,t,n){if((t=xe(t))instanceof Wh)return t._internalPath;if("string"==typeof t)return lp(e,t);throw cp("Field path arguments must be of type string or ",e,!1,void 0,n)}const op=new RegExp("[~\\*/\\[\\]]");function lp(e,t,n){if(t.search(op)>=0)throw cp(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Wh(...t.split("."))._internalPath}catch(i){throw cp(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function cp(e,t,n,i,r){const a=i&&!i.isEmpty(),s=void 0!==r;let o=`Function ${t}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(a||s)&&(l+=" (found",a&&(l+=` in field ${i}`),s&&(l+=` in document ${r}`),l+=")"),new Ma(Aa.INVALID_ARGUMENT,o+e+l)}function dp(e,t){return e.some((e=>e.isEqual(t)))}class up{constructor(e,t,n,i,r){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Dh(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new hp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(pp("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class hp extends up{data(){return super.data()}}function pp(e,t){return"string"==typeof t?lp(e,t):t instanceof Wh?t._internalPath:t._delegate._internalPath}function mp(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Ma(Aa.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class fp{}class yp extends fp{}class gp extends yp{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new gp(e,t,n)}_apply(e){const t=this._parse(e);return jp(e._query,t),new Mh(e.firestore,e.converter,$o(e._query,t))}_parse(e){const t=Xh(e.firestore),n=function(e,t,n,i,r,a,s){let o;if(r.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new Ma(Aa.INVALID_ARGUMENT,`Invalid Query. You can't perform '${a}' queries on documentId().`);if("in"===a||"not-in"===a){bp(s,a);const t=[];for(const n of s)t.push(xp(i,e,n));o={arrayValue:{values:t}}}else o=xp(i,e,s)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||bp(s,a),o=tp(n,t,s,"in"===a||"not-in"===a);return mo.create(r,a,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class vp extends fp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new vp(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:fo.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const i=t.getFlattenedFilters();for(const r of i)jp(n,r),n=$o(n,r)}(e._query,t),new Mh(e.firestore,e.converter,$o(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class wp extends yp{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new wp(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Ma(Aa.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Ma(Aa.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new uo(t,n)}(e._query,this._field,this._direction);return new Mh(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Do(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function xp(e,t,n){if("string"==typeof(n=xe(n))){if(""===n)throw new Ma(Aa.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Fo(t)&&-1!==n.indexOf("/"))throw new Ma(Aa.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=t.path.child(Ya.fromString(n));if(!es.isDocumentKey(i))throw new Ma(Aa.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Qs(e,new es(i))}if(n instanceof Dh)return Qs(e,n._key);throw new Ma(Aa.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ch(n)}.`)}function bp(e,t){if(!Array.isArray(e)||0===e.length)throw new Ma(Aa.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function jp(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Ma(Aa.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Ma(Aa.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class kp{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Vs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return As(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ms(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ta()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return bs(e,((e,i)=>{n[e]=this.convertValue(i,t)})),n}convertVectorValue(e){var t,n,i;const r=null===(i=null===(n=null===(t=e.fields)||void 0===t?void 0:t.value.arrayValue)||void 0===n?void 0:n.values)||void 0===i?void 0:i.map((e=>As(e.doubleValue)));return new Kh(r)}convertGeoPoint(e){return new Hh(As(e.latitude),As(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Rs(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Os(e));default:return null}}convertTimestamp(e){const t=Is(e);return new Ga(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Ya.fromString(e);Pa(Wc(n));const i=new Fs(n.get(1),n.get(3)),r=new es(n.popFirst(5));return i.isEqual(t)||Sa(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),r}}function Np(e,t,n){let i;return i=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,i}class zp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class _p extends up{constructor(e,t,n,i,r,a){super(e,t,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Sp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(pp("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Sp extends _p{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Ep{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new zp(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Sp(this._firestore,this._userDataWriter,n.key,n,new zp(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Ma(Aa.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const i=new Sp(e._firestore,e._userDataWriter,n.doc.key,n.doc,new zp(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const i=new Sp(e._firestore,e._userDataWriter,t.doc.key,t.doc,new zp(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let r=-1,a=-1;return 0!==t.type&&(r=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),a=n.indexOf(t.doc.key)),{type:Cp(t.type),doc:i,oldIndex:r,newIndex:a}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Cp(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ta()}}class Tp extends kp{constructor(e){super(),this.firestore=e}convertBytes(e){return new $h(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Dh(this.firestore,null,t)}}function Pp(e,t){return function(e,t){const n=new Da;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const i=uh(e);try{const e=await function(e,t){const n=Ia(e),i=Ga.now(),r=t.reduce(((e,t)=>e.add(t.key)),cl());let a,s;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let o=el(),l=cl();return n.cs.getEntries(e,r).next((e=>{o=e,o.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,o))).next((r=>{a=r;const s=[];for(const e of t){const t=Ml(e,a.get(e.key).overlayedDocument);null!=t&&s.push(new Ol(e.key,t,ao(t.value.mapValue),El.exists(!0)))}return n.mutationQueue.addMutationBatch(e,i,s,t)})).next((t=>{s=t;const i=t.applyToLocalDocumentSet(a,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,i)}))})).then((()=>({batchId:s.batchId,changes:il(a)})))}(i.localStore,t);i.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let i=e.Ba[e.currentUser.toKey()];i||(i=new ks(Ha)),i=i.insert(t,n),e.Ba[e.currentUser.toKey()]=i}(i,e.batchId,n),await oh(i,e.changes),await lu(i.remoteStore)}catch(e){const t=ju(e,"Failed to persist write");n.reject(t)}}(await xh(e),t,n))),n.promise}(Vh(e),t)}function Ip(e,t,n){const i=n.docs.get(t._key),r=new Tp(e);return new _p(e,r,t._key,i,new zp(n.hasPendingWrites,n.fromCache),t.converter)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){ka=e}(Rt),Pt(new be("firestore",((e,n)=>{let{instanceIdentifier:i,options:r}=n;const a=e.getProvider("app").getImmediate(),s=new Uh(new Fa(e.getProvider("auth-internal")),new $a(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Ma(Aa.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fs(e.options.projectId,t)}(a,i),a);return r=Object.assign({useFetchStreams:t},r),s._setSettings(r),s}),"PUBLIC").setMultipleInstances(!0)),Ft(ba,"4.7.3",e),Ft(ba,"4.7.3","esm2017")}();const Ap="@firebase/installations",Mp="0.6.9",Dp=1e4,Rp=`w:${Mp}`,Op="FIS_v2",Lp=36e5,Fp=new de("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Up(e){return e instanceof ce&&e.code.includes("request-failed")}function Vp(e){let{projectId:t}=e;return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function Bp(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function $p(e,t){const n=(await t.json()).error;return Fp.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Wp(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function qp(e,t){let{refreshToken:n}=t;const i=Wp(e);return i.append("Authorization",function(e){return`${Op} ${e}`}(n)),i}async function Hp(e){const t=await e();return t.status>=500&&t.status<600?e():t}function Kp(e){return new Promise((t=>{setTimeout(t,e)}))}const Gp=/^[cdef][\w-]{21}$/;function Qp(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}(e);return Gp.test(t)?t:""}catch(e){return""}}function Zp(e){return`${e.appName}!${e.appId}`}const Yp=new Map;function Jp(e,t){const n=Zp(e);Xp(n,t),function(e,t){const n=tm();n&&n.postMessage({key:e,fid:t});nm()}(n,t)}function Xp(e,t){const n=Yp.get(e);if(n)for(const i of n)i(t)}let em=null;function tm(){return!em&&"BroadcastChannel"in self&&(em=new BroadcastChannel("[Firebase] FID Change"),em.onmessage=e=>{Xp(e.data.key,e.data.fid)}),em}function nm(){0===Yp.size&&em&&(em.close(),em=null)}const im="firebase-installations-store";let rm=null;function am(){return rm||(rm=We("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(im)}})),rm}async function sm(e,t){const n=Zp(e),i=(await am()).transaction(im,"readwrite"),r=i.objectStore(im),a=await r.get(n);return await r.put(t,n),await i.done,a&&a.fid===t.fid||Jp(e,t.fid),t}async function om(e){const t=Zp(e),n=(await am()).transaction(im,"readwrite");await n.objectStore(im).delete(t),await n.done}async function lm(e,t){const n=Zp(e),i=(await am()).transaction(im,"readwrite"),r=i.objectStore(im),a=await r.get(n),s=t(a);return void 0===s?await r.delete(n):await r.put(s,n),await i.done,!s||a&&a.fid===s.fid||Jp(e,s.fid),s}async function cm(e){let t;const n=await lm(e.appConfig,(n=>{const i=function(e){const t=e||{fid:Qp(),registrationStatus:0};return hm(t)}(n),r=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(Fp.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(e,t){try{const n=await async function(e,t){let{appConfig:n,heartbeatServiceProvider:i}=e,{fid:r}=t;const a=Vp(n),s=Wp(n),o=i.getImmediate({optional:!0});if(o){const e=await o.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const l={fid:r,authVersion:Op,appId:n.appId,sdkVersion:Rp},c={method:"POST",headers:s,body:JSON.stringify(l)},d=await Hp((()=>fetch(a,c)));if(d.ok){const e=await d.json();return{fid:e.fid||r,registrationStatus:2,refreshToken:e.refreshToken,authToken:Bp(e.authToken)}}throw await $p("Create Installation",d)}(e,t);return sm(e.appConfig,n)}catch(n){throw Up(n)&&409===n.customData.serverCode?await om(e.appConfig):await sm(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:i}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:dm(e)}:{installationEntry:t}}(e,i);return t=r.registrationPromise,r.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function dm(e){let t=await um(e.appConfig);for(;1===t.registrationStatus;)await Kp(100),t=await um(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await cm(e);return n||t}return t}function um(e){return lm(e,(e=>{if(!e)throw Fp.create("installation-not-found");return hm(e)}))}function hm(e){return 1===(t=e).registrationStatus&&t.registrationTime+Dp<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function pm(e,t){let{appConfig:n,heartbeatServiceProvider:i}=e;const r=function(e,t){let{fid:n}=t;return`${Vp(e)}/${n}/authTokens:generate`}(n,t),a=qp(n,t),s=i.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&a.append("x-firebase-client",e)}const o={installation:{sdkVersion:Rp,appId:n.appId}},l={method:"POST",headers:a,body:JSON.stringify(o)},c=await Hp((()=>fetch(r,l)));if(c.ok){return Bp(await c.json())}throw await $p("Generate Auth Token",c)}async function mm(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=await lm(e.appConfig,(i=>{if(!ym(i))throw Fp.create("not-registered");const r=i.authToken;if(!n&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+Lp}(e)}(r))return i;if(1===r.requestStatus)return t=async function(e,t){let n=await fm(e.appConfig);for(;1===n.authToken.requestStatus;)await Kp(100),n=await fm(e.appConfig);const i=n.authToken;return 0===i.requestStatus?mm(e,t):i}(e,n),i;{if(!navigator.onLine)throw Fp.create("app-offline");const n=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(i);return t=async function(e,t){try{const n=await pm(e,t),i=Object.assign(Object.assign({},t),{authToken:n});return await sm(e.appConfig,i),n}catch(n){if(!Up(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await sm(e.appConfig,n)}else await om(e.appConfig);throw n}}(e,n),n}}));return t?await t:i.authToken}function fm(e){return lm(e,(e=>{if(!ym(e))throw Fp.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+Dp<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n}))}function ym(e){return void 0!==e&&2===e.registrationStatus}async function gm(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;await async function(e){const{registrationPromise:t}=await cm(e);t&&await t}(n);return(await mm(n,t)).token}function vm(e){return Fp.create("missing-app-config-values",{valueName:e})}const wm="installations",xm=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw vm("App Configuration");if(!e.name)throw vm("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw vm(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:It(t,"heartbeat"),_delete:()=>Promise.resolve()}},bm=e=>{const t=It(e.getProvider("app").getImmediate(),wm).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:i}=await cm(t);return i?i.catch(console.error):mm(t).catch(console.error),n.fid}(t),getToken:e=>gm(t,e)}};Pt(new be(wm,xm,"PUBLIC")),Pt(new be("installations-internal",bm,"PRIVATE")),Ft(Ap,Mp),Ft(Ap,Mp,"esm2017");const jm="analytics",km="https://www.googletagmanager.com/gtag/js",Nm=new Pe("@firebase/analytics"),zm=new de("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function _m(e){if(!e.startsWith(km)){const t=zm.create("invalid-gtag-resource",{gtagURL:e});return Nm.warn(t.message),""}return e}function Sm(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}function Em(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}("firebase-js-sdk-policy",{createScriptURL:_m}),i=document.createElement("script"),r=`${km}?l=${e}&id=${t}`;i.src=n?null===n||void 0===n?void 0:n.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}function Cm(e,t,n,i){return async function(r){try{for(var a=arguments.length,s=new Array(a>1?a-1:0),o=1;o<a;o++)s[o-1]=arguments[o];if("event"===r){const[i,r]=s;await async function(e,t,n,i,r){try{let a=[];if(r&&r.send_to){let e=r.send_to;Array.isArray(e)||(e=[e]);const i=await Sm(n);for(const n of e){const e=i.find((e=>e.measurementId===n)),r=e&&t[e.appId];if(!r){a=[];break}a.push(r)}}0===a.length&&(a=Object.values(t)),await Promise.all(a),e("event",i,r||{})}catch(a){Nm.error(a)}}(e,t,n,i,r)}else if("config"===r){const[r,a]=s;await async function(e,t,n,i,r,a){const s=i[r];try{if(s)await t[s];else{const e=(await Sm(n)).find((e=>e.measurementId===r));e&&await t[e.appId]}}catch(o){Nm.error(o)}e("config",r,a)}(e,t,n,i,r,a)}else if("consent"===r){const[t,n]=s;e("consent",t,n)}else if("get"===r){const[t,n,i]=s;e("get",t,n,i)}else if("set"===r){const[t]=s;e("set",t)}else e(r,...s)}catch(l){Nm.error(l)}}}const Tm=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function Pm(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function Im(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tm,n=arguments.length>2?arguments[2]:void 0;const{appId:i,apiKey:r,measurementId:a}=e.options;if(!i)throw zm.create("no-app-id");if(!r){if(a)return{measurementId:a,appId:i};throw zm.create("no-api-key")}const s=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new Mm;return setTimeout((async()=>{o.abort()}),void 0!==n?n:6e4),Am({appId:i,apiKey:r,measurementId:a},s,o,t)}async function Am(e,t,n){let{throttleEndTimeMillis:i,backoffCount:r}=t,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Tm;var s;const{appId:o,measurementId:l}=e;try{await function(e,t){return new Promise(((n,i)=>{const r=Math.max(t-Date.now(),0),a=setTimeout(n,r);e.addEventListener((()=>{clearTimeout(a),i(zm.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(n,i)}catch(c){if(l)return Nm.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null===c||void 0===c?void 0:c.message}]`),{appId:o,measurementId:l};throw c}try{const t=await async function(e){var t;const{appId:n,apiKey:i}=e,r={method:"GET",headers:Pm(i)},a="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),s=await fetch(a,r);if(200!==s.status&&304!==s.status){let e="";try{const n=await s.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(o){}throw zm.create("config-fetch-failed",{httpStatus:s.status,responseMessage:e})}return s.json()}(e);return a.deleteThrottleMetadata(o),t}catch(c){const t=c;if(!function(e){if(!(e instanceof ce)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t)){if(a.deleteThrottleMetadata(o),l)return Nm.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null===t||void 0===t?void 0:t.message}]`),{appId:o,measurementId:l};throw c}const i=503===Number(null===(s=null===t||void 0===t?void 0:t.customData)||void 0===s?void 0:s.httpStatus)?we(r,a.intervalMillis,30):we(r,a.intervalMillis),d={throttleEndTimeMillis:Date.now()+i,backoffCount:r+1};return a.setThrottleMetadata(o,d),Nm.debug(`Calling attemptFetch again in ${i} millis`),Am(e,d,n,a)}}class Mm{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let Dm,Rm;function Om(e){Rm=e}function Lm(e){Dm=e}async function Fm(e,t,n,i,r,a,s){var o;const l=Im(e);l.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&Nm.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>Nm.error(e))),t.push(l);const c=async function(){if(!oe())return Nm.warn(zm.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await le()}catch(e){return Nm.warn(zm.create("indexeddb-unavailable",{errorInfo:null===e||void 0===e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?i.getId():void 0)),[d,u]=await Promise.all([l,c]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(km)&&n.src.includes(e))return n;return null})(a)||Em(a,d.measurementId),Rm&&(r("consent","default",Rm),Om(void 0)),r("js",new Date);const h=null!==(o=null===s||void 0===s?void 0:s.config)&&void 0!==o?o:{};return h.origin="firebase",h.update=!0,null!=u&&(h.firebase_id=u),r("config",d.measurementId,h),Dm&&(r("set",Dm),Lm(void 0)),d.measurementId}class Um{constructor(e){this.app=e}_delete(){return delete Vm[this.app.options.appId],Promise.resolve()}}let Vm={},Bm=[];const $m={};let Wm,qm,Hm="dataLayer",Km="gtag",Gm=!1;function Qm(){const e=[];if(ae()&&e.push("This is a browser extension environment."),"undefined"!==typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=zm.create("invalid-analytics-context",{errorInfo:t});Nm.warn(n.message)}}function Zm(e,t,n){Qm();const i=e.options.appId;if(!i)throw zm.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw zm.create("no-api-key");Nm.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Vm[i])throw zm.create("already-exists",{id:i});if(!Gm){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(Hm);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,i,r){let a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[i].push(arguments)};return window[r]&&"function"===typeof window[r]&&(a=window[r]),window[r]=Cm(a,e,t,n),{gtagCore:a,wrappedGtag:window[r]}}(Vm,Bm,$m,Hm,Km);qm=e,Wm=t,Gm=!0}Vm[i]=Fm(e,Bm,$m,t,Wm,Hm,n);return new Um(e)}function Ym(e,t,n,i){e=xe(e),async function(e,t,n,i,r){if(r&&r.global)e("event",n,i);else{const r=await t;e("event",n,Object.assign(Object.assign({},i),{send_to:r}))}}(qm,Vm[e.app.options.appId],t,n,i).catch((e=>Nm.error(e)))}const Jm="@firebase/analytics",Xm="0.10.8";Pt(new be(jm,((e,t)=>{let{options:n}=t;return Zm(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)}),"PUBLIC")),Pt(new be("analytics-internal",(function(e){try{const t=e.getProvider(jm).getImmediate();return{logEvent:(e,n,i)=>Ym(t,e,n,i)}}catch(t){throw zm.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),Ft(Jm,Xm),Ft(Jm,Xm,"esm2017");const ef=Ot({apiKey:"AIzaSyDB6GPLf6XY8zdm3X_v5IpGy1RsKvzmxCs",authDomain:"oze-developer.firebaseapp.com",projectId:"oze-developer",storageBucket:"oze-developer.firebasestorage.app",messagingSenderId:"846053756987",appId:"1:846053756987:web:6a6e5954c24f3932fccc1e",measurementId:"G-3FJW0FC6S7"}),tf=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt();const t=It(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=It(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(he(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;nn(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:ea,persistence:[hr,Qi,Yi]}),i=ne("authTokenSyncURL");if(i&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(i,location.origin);if(location.origin===e.origin){const t=(r=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>ra)return;const i=null===t||void 0===t?void 0:t.token;aa!==i&&(aa=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});!function(e,t,n){xe(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e,t,n,i){xe(e).onIdTokenChanged(t,n,i)}(n,(e=>t(e)))}}var r;const a=ee("auth");return a&&vi(n,`http://${a}`),n}(ef),nf=function(e,t){const n="string"==typeof e?e:t||"(default)",i=It("object"==typeof e?e:Lt(),"firestore").getImmediate({identifier:n});if(!i._initialized){const e=(e=>{const t=ee(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),i]:[t.substring(0,n),i]})("firestore");e&&Ah(i,...e)}return i}(ef),rf=(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt();e=xe(e);const t=It(e,jm);t.isInitialized()?t.getImmediate():function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=It(e,jm);if(n.isInitialized()){const e=n.getImmediate();if(he(t,n.getOptions()))return e;throw zm.create("already-initialized")}const i=n.initialize({options:t})}(e)}(ef),async()=>{try{const e=await async function(e){var t;if(At(e.app))return Promise.reject(sn(e));const n=di(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new Li({user:n.currentUser,providerId:null,operationType:"signIn"});const i=await Oi(n,{returnSecureToken:!0}),r=await Li._fromIdTokenResponse(n,"signIn",i,!0);return await n._updateCurrentUser(r.user),r}(tf);return e.user}catch(e){throw console.error("B\u0142\u0105d logowania anonimowego:",e),e}}),af=async(e,t)=>{if(!tf.currentUser)return null;try{const n=tf.currentUser.uid,i={userId:n,nickname:tf.currentUser.displayName||"Anonimowy gracz",gameState:{day:e.day,turn:e.turn,gameDate:e.gameDate,currentScreen:e.currentScreen,gameSpeed:e.gameSpeed,competitors:e.competitors,marketProjects:e.marketProjects,marketHistory:e.marketHistory},playerState:{cash:t.cash,reputation:t.reputation,installedCapacity:t.installedCapacity,rtbCapacity:t.rtbCapacity,rtbPower:t.rtbPower,economicMetrics:t.economicMetrics,staff:t.staff,projects:t.projects,gameGoals:t.gameGoals,knownRegions:t.knownRegions,capabilities:t.capabilities,modifiers:t.modifiers},timestamp:new Date};return await function(e,t,n){e=Th(e,Dh);const i=Th(e.firestore,Uh),r=Np(e.converter,t,n);return Pp(i,[ep(Xh(i),"setDoc",e._key,r,null!==e.converter,n).toMutation(e._key,El.none())])}(Lh(nf,"saves",n),i),i}catch(n){throw console.error("B\u0142\u0105d zapisywania stanu gry:",n),n}},sf=async()=>{if(!tf.currentUser)return null;try{const e=tf.currentUser.uid,t=await function(e){e=Th(e,Dh);const t=Th(e.firestore,Uh);return jh(Vh(t),e._key).then((n=>Ip(t,e,n)))}(Lh(nf,"saves",e));return t.exists()?t.data():null}catch(e){throw console.error("B\u0142\u0105d wczytywania stanu gry:",e),e}},of=async(e,t)=>{if(!tf.currentUser)return null;try{const n={userId:tf.currentUser.uid,nickname:tf.currentUser.displayName||"Anonimowy gracz",goal:e,days:t,timestamp:new Date};return await function(e,t){const n=Th(e.firestore,Uh),i=Lh(e),r=Np(e.converter,t);return Pp(n,[ep(Xh(e.firestore),"addDoc",i._key,r,null!==e.converter,{}).toMutation(i._key,El.exists(!1))]).then((()=>i))}(Oh(nf,"leaderboard"),n),n}catch(n){throw console.error("B\u0142\u0105d zapisywania wyniku do tablicy wynik\xf3w:",n),n}},lf=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{e||(e="25GW"),"number"!==typeof t&&(t=10);const i=function(e,t){let n=[];for(var i=arguments.length,r=new Array(i>2?i-2:0),a=2;a<i;a++)r[a-2]=arguments[a];t instanceof fp&&n.push(t),n=n.concat(r),function(e){const t=e.filter((e=>e instanceof vp)).length,n=e.filter((e=>e instanceof gp)).length;if(t>1||t>0&&n>0)throw new Ma(Aa.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)e=s._apply(e);return e}(Oh(nf,"leaderboard"),function(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=pp("orderBy",e);return wp._create(n,t)}("turns","asc"),t(t));try{const e=await function(e){e=Th(e,Mh);const t=Th(e.firestore,Uh),n=Vh(t),i=new Tp(t);return mp(e._query),kh(n,e._query).then((n=>new Ep(t,i,e,n)))}(i),t=[];return e.forEach((e=>{t.push({id:e.id,...e.data()})})),t}catch(n){return console.error("B\u0142\u0105d podczas wykonywania zapytania:",n),[]}}catch(i){return console.error("B\u0142\u0105d pobierania tablicy wynik\xf3w:",i),[]}},cf=e=>function(e,t,n,i){return xe(e).onAuthStateChanged(t,n,i)}(tf,e),df=e=>e.toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"}),uf={day:1,turn:1,gameDate:new Date("2024-01-01"),gameSpeed:1,currentScreen:"home",appView:null,notification:null,selectedRegion:null,selectedCounty:null,selectedProject:null,globalEvents:{currentEvents:[],eventProbabilities:{economic:.2,political:.1,social:.15,environmental:.1,technological:.15},historicalEvents:[]},competitors:h,marketProjects:[],marketHistory:[],marketPriceModifiers:{PV:1,WF:1,BESS:1},reputationModifiers:{projectCost:1,constructionSpeed:1,projectQuality:1,permitSpeed:1,leasingSuccess:1,gridConnectionCost:1},economyModifiers:{inflationRate:.05,interestRate:.06,gridConnectionCost:1,permitCost:1,energyPrice:1,constructionCost:1},parallelProcessing:{enabled:!0,maxParallelTasks:3},goals:{installedCapacity:{target:25e3,achieved:!1,achievedOn:null},money:{target:1e10,achieved:!1,achievedOn:null}}};function hf(e,t){switch(t.type){case"SET_SCREEN":return{...e,currentScreen:t.payload};case"SELECT_REGION":return{...e,selectedRegion:t.payload,selectedCounty:null};case"SELECT_COUNTY":return{...e,selectedCounty:t.payload};case"SELECT_PROJECT":return{...e,selectedProject:t.payload};case"SET_NOTIFICATION":return{...e,notification:t.payload};case"ADVANCE_DAY":const n=e.gameSpeed,i=((e,t)=>{const n=new Date(e);return n.setDate(n.getDate()+t),n})(e.gameDate,n);return{...e,day:e.day+n,gameDate:i,lastDateUpdate:new Date};case"SET_GAME_SPEED":return{...e,gameSpeed:t.payload};case"UPDATE_MARKET_PROJECTS":return{...e,marketProjects:t.payload};case"ADD_MARKET_PROJECT":return{...e,marketProjects:[...e.marketProjects,t.payload]};case"REMOVE_MARKET_PROJECT":return{...e,marketProjects:e.marketProjects.filter((e=>e.id!==t.payload))};case"ADD_MARKET_HISTORY":return{...e,marketHistory:[...e.marketHistory,t.payload]};case"UPDATE_MARKET_PRICE_MODIFIERS":return{...e,marketPriceModifiers:{...e.marketPriceModifiers,...t.payload}};case"UPDATE_REPUTATION_MODIFIERS":return{...e,reputationModifiers:{...e.reputationModifiers,...t.payload}};case"UPDATE_ECONOMY_STATE":return{...e,economyModifiers:{...e.economyModifiers,...t.payload}};case"SET_PARALLEL_PROCESSING":return{...e,parallelProcessing:{...e.parallelProcessing,...t.payload}};case"UPDATE_GAME_GOALS":return{...e,goals:{...e.goals,...t.payload}};case"SET_WIN_CONDITION":return{...e,goals:{...e.goals,isWon:!0,winReason:t.payload}};case"ADD_GLOBAL_EVENT":return{...e,globalEvents:{...e.globalEvents,currentEvents:[...e.globalEvents.currentEvents,t.payload]}};case"ADD_GLOBAL_EVENTS":return{...e,globalEvents:{...e.globalEvents,currentEvents:[...e.globalEvents.currentEvents,...t.payload]}};case"REMOVE_GLOBAL_EVENT":return{...e,globalEvents:{...e.globalEvents,currentEvents:e.globalEvents.currentEvents.filter((e=>e.id!==t.payload))}};case"UPDATE_EVENT_PROBABILITIES":return{...e,globalEvents:{...e.globalEvents,eventProbabilities:{...e.globalEvents.eventProbabilities,...t.payload}}};case"LOAD_GAME":return{...e,...t.payload,notification:e.notification,appView:e.appView};case"SET_APP_VIEW":return{...e,appView:t.payload};default:return e}}const pf=(0,i.createContext)();function mf(e){let{children:t}=e;const[n,r]=(0,i.useReducer)(hf,uf),{dispatch:s}=H();(0,i.useEffect)((()=>{c()}),[]);const o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";if(e)try{window.notificationQueue||(window.notificationQueue=[]),"undefined"===typeof window.activeNotifications&&(window.activeNotifications=0),window.notificationQueue.push({text:e,type:t});const n=()=>{try{if(!window.notificationQueue||0===window.notificationQueue.length||window.activeNotifications>=3)return;const e=window.notificationQueue.shift();window.activeNotifications=(window.activeNotifications||0)+1,r({type:"SET_NOTIFICATION",payload:e});const t="error"===e.type?8e3:"success"===e.type?5e3:3e3;setTimeout((()=>{try{r({type:"SET_NOTIFICATION",payload:null}),window.activeNotifications=Math.max(0,(window.activeNotifications||0)-1),setTimeout((()=>{try{n()}catch(e){console.error("B\u0142\u0105d podczas wywo\u0142ywania showNextNotification w setTimeout:",e)}}),300)}catch(e){console.error("B\u0142\u0105d podczas obs\u0142ugi pierwszego setTimeout w showNotification:",e),window.activeNotifications=Math.max(0,(window.activeNotifications||0)-1)}}),t)}catch(e){console.error("B\u0142\u0105d w funkcji showNextNotification:",e),window.activeNotifications=Math.max(0,(window.activeNotifications||0)-1)}};n()}catch(n){console.error("B\u0142\u0105d podczas wy\u015bwietlania powiadomienia:",n),r({type:"SET_NOTIFICATION",payload:{text:e,type:t}}),setTimeout((()=>{try{r({type:"SET_NOTIFICATION",payload:null})}catch(e){console.error("B\u0142\u0105d podczas czyszczenia powiadomienia w setTimeout:",e)}}),5e3)}},l=()=>{const e={},t=.02*Math.random()-.01;e.inflationRate=Math.max(0,Math.min(.15,n.economyModifiers.inflationRate+t));const i=.01*Math.random()-.005;e.economicGrowth=Math.max(-.05,Math.min(.08,n.economyModifiers.economicGrowth+i)),n.economyModifiers.inflationRate>n.economyModifiers.interestRate+.02?e.interestRate=n.economyModifiers.interestRate+.01:n.economyModifiers.inflationRate<n.economyModifiers.interestRate-.02&&(e.interestRate=n.economyModifiers.interestRate-.01),r({type:"UPDATE_ECONOMY_STATE",payload:e})},c=()=>{const e=(e=>{if(!e||0===e.length)return{marketModifier:1,permitTimeModifier:1,buildCostModifier:1,riskLevel:0,grayAreaImpact:0,reputationChange:0};const t={marketModifier:1,permitTimeModifier:1,buildCostModifier:1,riskLevel:0,grayAreaImpact:0,reputationChange:0};return e.forEach((e=>{if(!e.effects)return;const n=y(e.effects);n.marketModifier&&(t.marketModifier*=n.marketModifier),n.permitTimeModifier&&(t.permitTimeModifier*=n.permitTimeModifier),n.buildCostModifier&&(t.buildCostModifier*=n.buildCostModifier),n.riskLevel&&(t.riskLevel+=n.riskLevel),n.grayAreaImpact&&(t.grayAreaImpact+=n.grayAreaImpact),n.reputationChange&&(t.reputationChange+=n.reputationChange)})),g(t)})(n.globalEvents.currentEvents.filter((e=>!e.expiryDate||new Date(e.expiryDate)>n.gameDate)));r({type:"UPDATE_MODIFIERS",payload:{marketPriceModifiers:{PV:e.marketModifier,WF:e.marketModifier,BESS:e.marketModifier}}})},d=(e,t)=>{if(e&&!n.goals.isWon)return e.rtbPower>=n.goals.rtbPowerTarget?(r({type:"SET_WIN_CONDITION",payload:"rtb_power"}),o(`Gratulacje! Osi\u0105gn\u0105\u0142e\u015b cel mocy RTB - ${n.goals.rtbPowerTarget.toLocaleString()} MW!`,"success"),void(e.installedCapacity+e.rtbCapacity>=25e3&&!e.goals.includes("25GW")&&(t({type:"PLAYER_ADD_GOAL_ACHIEVED",payload:"25GW"}),r({type:"SET_NOTIFICATION",payload:{text:"GRATULACJE! Osi\u0105gni\u0119to cel 25GW mocy zainstalowanej i gotowej do budowy!",type:"success"}}),of("25GW",n.day).catch((e=>console.error("B\u0142\u0105d zapisywania wyniku 25GW:",e)))))):e.cash>=n.goals.cashTarget?(r({type:"SET_WIN_CONDITION",payload:"cash"}),o(`Gratulacje! Osi\u0105gn\u0105\u0142e\u015b cel finansowy - ${n.goals.cashTarget.toLocaleString()} PLN!`,"success"),void(e.cash>=1e10&&!e.goals.includes("10BLN")&&(t({type:"PLAYER_ADD_GOAL_ACHIEVED",payload:"10BLN"}),r({type:"SET_NOTIFICATION",payload:{text:"GRATULACJE! Osi\u0105gni\u0119to cel 10 miliard\xf3w PLN!",type:"success"}}),of("10BLN",n.day).catch((e=>console.error("B\u0142\u0105d zapisywania wyniku 10BLN:",e)))))):void 0};return(0,a.jsx)(pf.Provider,{value:{state:n,dispatch:r,showNotification:o,nextDay:(e,t)=>{if(e&&t)try{const u={...e};u.projects||(u.projects={underConstruction:[],completed:[],readyToBuild:[]}),Array.isArray(u.projects.underConstruction)&&u.projects.underConstruction.length>0&&(u.projects.underConstruction=u.projects.underConstruction.map((e=>e?(e.constructionDaysLeft>0&&(e.constructionDaysLeft-=n.gameSpeed,e.constructionDaysLeft<=0&&(e.constructionDaysLeft=0,e.status="completed",e.completionDate=new Date(n.gameDate),o(`Projekt ${e.name||"bez nazwy"} zosta\u0142 zbudowany i jest gotowy do produkcji!`,"success"),Array.isArray(u.projects.completed)||(u.projects.completed=[]),u.projects.completed.push(e),u.projects.underConstruction=u.projects.underConstruction.filter((t=>t&&t.id!==e.id)))),e):e)));try{c()}catch(a){console.error("B\u0142\u0105d podczas aktualizacji modyfikator\xf3w gry:",a)}r({type:"ADVANCE_DAY"});try{l()}catch(a){console.error("B\u0142\u0105d podczas aktualizacji ekonomii:",a)}if(s)try{s({type:"LIMIT_EVENTS"}),s({type:"CLEAR_EXPIRED_EVENTS",payload:{currentTurn:n.turn}})}catch(a){console.error("B\u0142\u0105d podczas obs\u0142ugi wydarze\u0144:",a)}try{const e=.1,t=.3,r=Math.min(e*(n.gameSpeed||1),t),a=n.globalEvents.currentEvents.length;if(!(a>16)&&Math.random()<r&&s){var i;const e={turn:n.turn||1,date:new Date(n.gameDate||new Date),day:n.day||1};F((null===(i=n.globalEvents)||void 0===i?void 0:i.eventProbabilities)||{},s,Math.min(n.gameSpeed||1,2),e)}}catch(a){console.error("B\u0142\u0105d podczas generowania wydarze\u0144:",a)}try{d(u,t)}catch(a){console.error("B\u0142\u0105d podczas sprawdzania cel\xf3w gry:",a)}t({type:"UPDATE_PLAYER",payload:u});try{setTimeout((()=>{try{window.dispatchEvent(new Event("next-game-day"))}catch(e){console.error("B\u0142\u0105d podczas wysy\u0142ania zdarzenia next-game-day w setTimeout:",e)}}),0)}catch(a){console.error("B\u0142\u0105d podczas ustawiania setTimeout dla zdarzenia next-game-day:",a)}}catch(a){console.error("Krytyczny b\u0142\u0105d w funkcji nextDay:",a),o("Wyst\u0105pi\u0142 b\u0142\u0105d podczas przechodzenia do nast\u0119pnego dnia. Spr\xf3buj ponownie.","error")}else console.error("nextDay wywo\u0142ane z nieprawid\u0142owymi parametrami",{playerState:e,playerDispatch:t})},calculateEventsEffect:e=>{if(!n.globalEvents||!n.globalEvents.currentEvents)return 1;const t=n.globalEvents.currentEvents.filter((t=>t.effects&&t.effects[e]));let i=1;return t.forEach((t=>{t.effects&&t.effects[e]&&(i*=t.effects[e])})),i},formatDate:df,updateReputationModifiers:e=>{r({type:"UPDATE_REPUTATION_MODIFIERS",payload:e})}},children:t})}const ff=()=>{const e=(0,i.useContext)(pf);if(!e)throw new Error("useGameContext musi by\u0107 u\u017cywany wewn\u0105trz GameProvider");return e},yf=[{id:"dolnoslaskie",name:"Dolno\u015bl\u0105skie",gridCapacity:500,solarConditions:70,windConditions:60,socialAcceptance:60,environmentalComplexity:1.2,adminEfficiency:.9,availableLand:12e3,landPriceMultiplier:1.1,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"kujawsko-pomorskie",name:"Kujawsko-Pomorskie",gridCapacity:400,solarConditions:65,windConditions:75,socialAcceptance:50,environmentalComplexity:1,adminEfficiency:1,availableLand:15e3,landPriceMultiplier:.9,projects:[],protests:[],dominantPlayer:null,isOPRO:!0},{id:"lubelskie",name:"Lubelskie",gridCapacity:380,solarConditions:75,windConditions:55,socialAcceptance:65,environmentalComplexity:.9,adminEfficiency:1.1,availableLand:18e3,landPriceMultiplier:.8,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"lubuskie",name:"Lubuskie",gridCapacity:320,solarConditions:65,windConditions:70,socialAcceptance:55,environmentalComplexity:.8,adminEfficiency:1,availableLand:13e3,landPriceMultiplier:.9,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"lodzkie",name:"\u0141\xf3dzkie",gridCapacity:450,solarConditions:70,windConditions:65,socialAcceptance:60,environmentalComplexity:1,adminEfficiency:1,availableLand:14e3,landPriceMultiplier:1,projects:[],protests:[],dominantPlayer:null,isOPRO:!0},{id:"malopolskie",name:"Ma\u0142opolskie",gridCapacity:420,solarConditions:65,windConditions:50,socialAcceptance:55,environmentalComplexity:1.3,adminEfficiency:.9,availableLand:9e3,landPriceMultiplier:1.3,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"mazowieckie",name:"Mazowieckie",gridCapacity:550,solarConditions:70,windConditions:65,socialAcceptance:65,environmentalComplexity:1,adminEfficiency:.8,availableLand:2e4,landPriceMultiplier:1.2,projects:[],protests:[],dominantPlayer:null,isOPRO:!0},{id:"opolskie",name:"Opolskie",gridCapacity:300,solarConditions:65,windConditions:60,socialAcceptance:60,environmentalComplexity:1,adminEfficiency:1.1,availableLand:8e3,landPriceMultiplier:.9,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"podkarpackie",name:"Podkarpackie",gridCapacity:340,solarConditions:70,windConditions:50,socialAcceptance:60,environmentalComplexity:1.2,adminEfficiency:1,availableLand:12e3,landPriceMultiplier:.8,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"podlaskie",name:"Podlaskie",gridCapacity:320,solarConditions:65,windConditions:60,socialAcceptance:55,environmentalComplexity:1.1,adminEfficiency:1,availableLand:16e3,landPriceMultiplier:.7,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"pomorskie",name:"Pomorskie",gridCapacity:430,solarConditions:60,windConditions:85,socialAcceptance:70,environmentalComplexity:1.1,adminEfficiency:.9,availableLand:13e3,landPriceMultiplier:1.1,projects:[],protests:[],dominantPlayer:null,isOPRO:!0},{id:"slaskie",name:"\u015al\u0105skie",gridCapacity:520,solarConditions:65,windConditions:55,socialAcceptance:50,environmentalComplexity:1.4,adminEfficiency:.8,availableLand:7e3,landPriceMultiplier:1.2,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"swietokrzyskie",name:"\u015awi\u0119tokrzyskie",gridCapacity:310,solarConditions:70,windConditions:55,socialAcceptance:60,environmentalComplexity:1,adminEfficiency:1.1,availableLand:1e4,landPriceMultiplier:.8,projects:[],protests:[],dominantPlayer:null,isOPRO:!1},{id:"warminsko-mazurskie",name:"Warmi\u0144sko-Mazurskie",gridCapacity:350,solarConditions:60,windConditions:75,socialAcceptance:65,environmentalComplexity:1.2,adminEfficiency:1,availableLand:17e3,landPriceMultiplier:.8,projects:[],protests:[],dominantPlayer:null,isOPRO:!0},{id:"wielkopolskie",name:"Wielkopolskie",gridCapacity:480,solarConditions:65,windConditions:70,socialAcceptance:60,environmentalComplexity:1,adminEfficiency:.9,availableLand:19e3,landPriceMultiplier:1,projects:[],protests:[],dominantPlayer:null,isOPRO:!0},{id:"zachodniopomorskie",name:"Zachodniopomorskie",gridCapacity:400,solarConditions:60,windConditions:90,socialAcceptance:70,environmentalComplexity:1,adminEfficiency:1,availableLand:15e3,landPriceMultiplier:.9,projects:[],protests:[],dominantPlayer:null,isOPRO:!0}],gf=(0,i.createContext)();function vf(e,t){switch(t.type){case"UPDATE_REGION":return e.map((e=>e.id===t.payload.id?{...e,...t.payload.changes}:e));case"ADD_PROJECT_TO_REGION":return e.map((e=>e.id===t.payload.regionId?{...e,projects:[...e.projects,t.payload.project],availableLand:Math.max(0,e.availableLand-t.payload.project.size)}:e));case"UPDATE_REGIONAL_CONDITIONS":return e.map((e=>{const t=Math.floor(5*Math.random())-2,n=Math.floor(5*Math.random())-2,i=Math.floor(3*Math.random())-1;return{...e,solarConditions:Math.min(100,Math.max(0,e.solarConditions+t)),windConditions:Math.min(100,Math.max(0,e.windConditions+n)),socialAcceptance:Math.min(100,Math.max(0,e.socialAcceptance+i))}}));case"ADD_LAND_ACQUISITION_PROCESS":return e.map((e=>e.id===t.payload.regionId?{...e,landAcquisitionProcesses:[...e.landAcquisitionProcesses||[],t.payload.process]}:e));case"UPDATE_LAND_ACQUISITION_PROCESS":return e.map((e=>e.id===t.payload.regionId?{...e,landAcquisitionProcesses:(e.landAcquisitionProcesses||[]).map((e=>e.id===t.payload.processId?{...e,...t.payload.changes}:e))}:e));case"REMOVE_LAND_ACQUISITION_PROCESS":return e.map((e=>e.id===t.payload.regionId?{...e,landAcquisitionProcesses:(e.landAcquisitionProcesses||[]).filter((e=>e.id!==t.payload.processId))}:e));case"UPDATE_LAND_ACQUISITION_PROCESSES_PROGRESS":return e.map((e=>{const n=(e.landAcquisitionProcesses||[]).map((n=>{if("in_progress"===n.status){const i=new Date(t.payload.currentDate),r=new Date(n.startDate),a=new Date(n.completionDate);if(console.log("Aktualizacja procesu pozyskiwania gruntu:",{processId:n.id,regionId:e.id,currentDate:i.toISOString(),startDate:r.toISOString(),completionDate:a.toISOString()}),i>=a)return console.log(`Proces ${n.id} zako\u0144czony, post\u0119p 100%`),{...n,status:"ready_for_negotiation",progress:100};if(i>r){const e=a.getTime()-r.getTime(),t=i.getTime()-r.getTime(),s=Math.min(99,Math.floor(t/e*100));return console.log(`Proces ${n.id} w trakcie, post\u0119p ${s}%`),{...n,progress:s}}}return n}));return{...e,landAcquisitionProcesses:n}}));default:return e}}const wf=e=>{let{children:t}=e;const[n,r]=(0,i.useReducer)(vf,yf),{state:s,showNotification:o}=ff();return(0,i.useEffect)((()=>{const e=e=>{console.log("Wywo\u0142anie wydarzenia update-land-acquisition",e.detail),r({type:"UPDATE_LAND_ACQUISITION_PROCESSES_PROGRESS",payload:{currentDate:e.detail.currentDate||new Date(s.gameDate)}})},t=()=>{console.log("Wywo\u0142anie wydarzenia next-game-day, aktualizacja proces\xf3w gruntowych");const e=new Date(s.gameDate);r({type:"UPDATE_LAND_ACQUISITION_PROCESSES_PROGRESS",payload:{currentDate:e}}),n.forEach((e=>{e.landAcquisitionProcesses&&e.landAcquisitionProcesses.forEach((t=>{"ready_for_negotiation"===t.status&&100===t.progress&&o(`Proces poszukiwania dzia\u0142ki ${t.size}ha w regionie ${e.name} zako\u0144czony. Skaut ${t.scoutName} czeka na rozpocz\u0119cie negocjacji.`,"success")}))}))};return window.addEventListener("update-land-acquisition",e),window.addEventListener("next-game-day",t),()=>{window.removeEventListener("update-land-acquisition",e),window.removeEventListener("next-game-day",t)}}),[r,n,s.gameDate,o]),(0,a.jsx)(gf.Provider,{value:{state:n,dispatch:r},children:t})},xf=()=>{const e=(0,i.useContext)(gf);if(!e)throw new Error("useRegionsContext must be used within a RegionsProvider");return e},bf={dolnoslaskie:[{id:"wroclawski",name:"Wroc\u0142awski",capital:"Wroc\u0142aw",population:64e4,area:2930,solarPotential:75,windPotential:60,availableLand:1800,gridCapacity:120,environmentalRestrictions:45,administrativeEfficiency:70,localOpposition:35,propertyPrices:1.8,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}},{id:"jeleniogorski",name:"Jeleniog\xf3rski",capital:"Jelenia G\xf3ra",population:12e4,area:1880,solarPotential:65,windPotential:85,availableLand:1200,gridCapacity:80,environmentalRestrictions:75,administrativeEfficiency:65,localOpposition:45,propertyPrices:1.2,projects:[],events:[],isNatura2000:!0,isProtectedLandscape:!0,powerLines:{hv:!0,mv:!0}},{id:"walbrzyski",name:"Wa\u0142brzyski",capital:"Wa\u0142brzych",population:17e4,area:1650,solarPotential:60,windPotential:70,availableLand:900,gridCapacity:70,environmentalRestrictions:65,administrativeEfficiency:60,localOpposition:50,propertyPrices:.9,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!0,powerLines:{hv:!0,mv:!0}}],mazowieckie:[{id:"warszawski",name:"Warszawski",capital:"Warszawa",population:18e5,area:3200,solarPotential:70,windPotential:55,availableLand:1300,gridCapacity:250,environmentalRestrictions:50,administrativeEfficiency:80,localOpposition:40,propertyPrices:3.2,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}},{id:"radomski",name:"Radomski",capital:"Radom",population:25e4,area:2500,solarPotential:75,windPotential:60,availableLand:2100,gridCapacity:90,environmentalRestrictions:35,administrativeEfficiency:65,localOpposition:30,propertyPrices:.8,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}},{id:"plocki",name:"P\u0142ocki",capital:"P\u0142ock",population:17e4,area:1800,solarPotential:65,windPotential:70,availableLand:1900,gridCapacity:110,environmentalRestrictions:40,administrativeEfficiency:60,localOpposition:25,propertyPrices:.9,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}}],wielkopolskie:[{id:"poznanski",name:"Pozna\u0144ski",capital:"Pozna\u0144",population:54e4,area:2800,solarPotential:65,windPotential:80,availableLand:2200,gridCapacity:150,environmentalRestrictions:40,administrativeEfficiency:75,localOpposition:30,propertyPrices:2.1,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}},{id:"kaliski",name:"Kaliski",capital:"Kalisz",population:16e4,area:2100,solarPotential:70,windPotential:65,availableLand:1800,gridCapacity:85,environmentalRestrictions:35,administrativeEfficiency:70,localOpposition:25,propertyPrices:1.1,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}}],malopolskie:[{id:"krakowski",name:"Krakowski",capital:"Krak\xf3w",population:76e4,area:2300,solarPotential:65,windPotential:40,availableLand:1100,gridCapacity:130,environmentalRestrictions:70,administrativeEfficiency:75,localOpposition:55,propertyPrices:2.5,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!0,powerLines:{hv:!0,mv:!0}},{id:"tarnowski",name:"Tarnowski",capital:"Tarn\xf3w",population:15e4,area:1900,solarPotential:70,windPotential:45,availableLand:1500,gridCapacity:70,environmentalRestrictions:55,administrativeEfficiency:65,localOpposition:40,propertyPrices:1,projects:[],events:[],isNatura2000:!1,isProtectedLandscape:!1,powerLines:{hv:!0,mv:!0}}],pomorskie:[{id:"gdanski",name:"Gda\u0144ski",capital:"Gda\u0144sk",population:47e4,area:2200,solarPotential:60,windPotential:95,availableLand:1400,gridCapacity:160,environmentalRestrictions:60,administrativeEfficiency:75,localOpposition:35,propertyPrices:2.3,projects:[],events:[],isNatura2000:!0,isProtectedLandscape:!0,powerLines:{hv:!0,mv:!0}},{id:"slupski",name:"S\u0142upski",capital:"S\u0142upsk",population:12e4,area:2500,solarPotential:55,windPotential:100,availableLand:2e3,gridCapacity:120,environmentalRestrictions:55,administrativeEfficiency:60,localOpposition:30,propertyPrices:.9,projects:[],events:[],isNatura2000:!0,isProtectedLandscape:!0,powerLines:{hv:!0,mv:!0}}]},jf=(0,i.createContext)(),kf=(()=>{const e=[];return Object.keys(bf).forEach((t=>{bf[t].forEach((n=>{e.push({...n,voivodeship:t})}))})),e})();function Nf(e,t){switch(t.type){case"UPDATE_COUNTY":return e.map((e=>e.id===t.payload.id&&e.voivodeship===t.payload.voivodeship?{...e,...t.payload.changes}:e));case"ADD_PROJECT_TO_COUNTY":return e.map((e=>e.id===t.payload.countyId&&e.voivodeship===t.payload.voivodeship?{...e,projects:[...e.projects,t.payload.project],availableLand:Math.max(0,e.availableLand-t.payload.project.size)}:e));case"REMOVE_PROJECT_FROM_COUNTY":return e.map((e=>e.id===t.payload.countyId&&e.voivodeship===t.payload.voivodeship?{...e,projects:e.projects.filter((e=>e.id!==t.payload.projectId)),availableLand:e.availableLand+t.payload.projectSize}:e));case"ADD_EVENT_TO_COUNTY":return e.map((e=>e.id===t.payload.countyId&&e.voivodeship===t.payload.voivodeship?{...e,events:[...e.events,t.payload.event]}:e));case"REMOVE_EVENT_FROM_COUNTY":return e.map((e=>e.id===t.payload.countyId&&e.voivodeship===t.payload.voivodeship?{...e,events:e.events.filter((e=>e.id!==t.payload.eventId))}:e));case"UPDATE_COUNTY_PARAMETERS":return e.map((e=>e.id===t.payload.countyId&&e.voivodeship===t.payload.voivodeship?{...e,...t.payload.parameters}:e));case"UPDATE_ALL_COUNTIES":return e.map((e=>{const t=5*Math.random()-2.5,n=5*Math.random()-2.5,i=3*Math.random()-1.5,r=(.1*Math.random()-.05)*e.propertyPrices;return{...e,solarPotential:Math.max(0,Math.min(100,e.solarPotential+t)),windPotential:Math.max(0,Math.min(100,e.windPotential+n)),localOpposition:Math.max(0,Math.min(100,e.localOpposition+i)),propertyPrices:Math.max(.5,e.propertyPrices+r)}}));default:return e}}const zf=e=>{let{children:t}=e;const[n,r]=(0,i.useReducer)(Nf,kf);return(0,a.jsx)(jf.Provider,{value:{state:n,dispatch:r},children:t})},_f={competitors:h,competitorEvents:[],lastUpdateTurn:0},Sf="UPDATE_COMPETITORS",Ef="ADD_COMPETITOR_EVENT",Cf="INCREASE_COMPETITOR_POWER",Tf="ADD_COMPETITOR_REGION",Pf="ADD_COMPETITOR_TECHNOLOGY",If=(e,t)=>{switch(t.type){case Sf:return{...e,competitors:t.payload,lastUpdateTurn:t.turn};case Ef:return{...e,competitorEvents:[...e.competitorEvents,t.payload]};case Cf:return{...e,competitors:e.competitors.map((e=>e.id===t.payload.competitorId?{...e,power:e.power+t.payload.value,rtbPower:e.rtbPower+Math.floor(.3*t.payload.value)}:e))};case Tf:return{...e,competitors:e.competitors.map((e=>e.id===t.payload.competitorId?{...e,strongRegions:[...e.strongRegions,t.payload.regionId]}:e))};case Pf:return{...e,competitors:e.competitors.map((e=>e.id===t.payload.competitorId?{...e,focusTechnologies:[...e.focusTechnologies,t.payload.technology]}:e))};default:return e}},Af=(0,i.createContext)(),Mf=e=>{let{children:t}=e;const[n,r]=(0,i.useReducer)(If,_f),{state:s}=ff(),{state:o}=xf();(0,i.useEffect)((()=>{s.turn>n.lastUpdateTurn&&(l(),c())}),[s.turn]);const l=()=>{const e=n.competitors.map((e=>{const t=Math.floor(e.power*(e.growth-1)),n=Math.floor(.3*t);return{...e,power:e.power+t,rtbPower:e.rtbPower+n}}));r({type:Sf,payload:e,turn:s.turn})},c=()=>{if(!o||!o.regions||0===o.regions.length)return;const e=n.competitors[Math.floor(Math.random()*n.competitors.length)],t=p(e,o.regions);t&&(r({type:Ef,payload:{...t,turn:s.turn}}),t.effects.forEach((e=>{switch(e.type){case"competitor_power":case"competitor_power_boost":r({type:Cf,payload:{competitorId:e.competitorId,value:e.value}});break;case"competitor_technology":r({type:Pf,payload:{competitorId:e.competitorId,technology:e.value}})}})))};return(0,a.jsx)(Af.Provider,{value:{state:n,dispatch:r},children:t})},Df=()=>{const{state:e,dispatch:t}=u(),{state:n,dispatch:r}=ff(),a=(0,i.useCallback)((()=>{try{console.log("Odebrano zdarzenie next-game-day, gameSpeed:",(null===n||void 0===n?void 0:n.gameSpeed)||1),n&&n.appView&&r({type:"SET_APP_VIEW",payload:null});try{window.dispatchEvent(new CustomEvent("process-time-acceleration",{detail:{gameSpeed:(null===n||void 0===n?void 0:n.gameSpeed)||1,day:(null===n||void 0===n?void 0:n.day)||1,turn:(null===n||void 0===n?void 0:n.turn)||1}}))}catch(e){console.error("B\u0142\u0105d przy wysy\u0142aniu zdarzenia process-time-acceleration:",e)}}catch(e){console.error("B\u0142\u0105d w obs\u0142udze zdarzenia next-game-day:",e)}}),[n,r]);return(0,i.useEffect)((()=>(window.addEventListener("next-game-day",a),()=>{window.removeEventListener("next-game-day",a)})),[a]),null};class Rf extends i.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("B\u0142\u0105d w komponencie Store:",e,t),this.setState({errorInfo:t})}render(){var e;return this.state.hasError?(0,a.jsxs)("div",{className:"store-error-boundary",children:[(0,a.jsx)("h2",{children:"Wyst\u0105pi\u0142 b\u0142\u0105d w aplikacji"}),(0,a.jsx)("p",{children:(null===(e=this.state.error)||void 0===e?void 0:e.message)||"Nieznany b\u0142\u0105d"}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-500 text-white rounded",children:"Od\u015bwie\u017c stron\u0119"})]}):this.props.children}}const Of=e=>{let{children:t}=e;return(0,a.jsx)(Rf,{children:(0,a.jsx)(q,{children:(0,a.jsx)(d,{children:(0,a.jsx)(mf,{children:(0,a.jsx)(wf,{children:(0,a.jsx)(zf,{children:(0,a.jsxs)(Mf,{children:[(0,a.jsx)(Df,{}),t]})})})})})})})};var Lf={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Ff=(e,t)=>{const n=(0,i.forwardRef)(((n,r)=>{let{color:a="currentColor",size:s=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:d,...u}=n;return(0,i.createElement)("svg",{ref:r,...Lf,width:s,height:s,stroke:a,strokeWidth:l?24*Number(o)/Number(s):o,className:["lucide",`lucide-${h=e,h.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()}`,c].join(" "),...u},[...t.map((e=>{let[t,n]=e;return(0,i.createElement)(t,n)})),...Array.isArray(d)?d:[d]]);var h}));return n.displayName=`${e}`,n},Uf=Ff("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Vf=Ff("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Bf=Ff("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]),$f=Ff("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),Wf=Ff("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),qf=Ff("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]),Hf=Ff("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Kf=Ff("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Gf=Ff("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Qf=Ff("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Zf=Ff("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),Yf=Ff("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Jf=Ff("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),Xf=Ff("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),ey=e=>{let{text:t,type:n="info",onClose:r,autoClose:s=!0,duration:o=5e3}=e;(0,i.useEffect)((()=>{if(s){const e=setTimeout((()=>{r()}),o);return()=>clearTimeout(e)}}),[s,o,r]);return(0,a.jsxs)("div",{className:(()=>{const e="notification flex items-center";switch(n){case"win":case"success":return`${e} bg-green-500 text-white`;case"error":return`${e} bg-red-500 text-white`;case"warning":return`${e} bg-yellow-500 text-black`;default:return`${e} bg-blue-500 text-white`}})(),children:[(0,a.jsx)("div",{className:"mr-4",children:t}),(0,a.jsx)("button",{className:"ml-4 px-2 py-1 rounded bg-opacity-20 bg-black hover:bg-opacity-30 transition-all",onClick:r,children:"\u2715"})]})},ty=Ff("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),ny=Ff("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),iy=Ff("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),ry=Ff("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);class ay{constructor(e,t,n){this.playerState=e,this.playerDispatch=t,this.gameState=n}getReputationStatus(){const{reputation:e,reputationFactors:t,reputationHistory:n}=this.playerState;return{current:e,category:this.getReputationCategory(e),factors:t,trend:this.calculateReputationTrend(n)}}calculateReputationTrend(e){if(!e||e.length<5)return"stable";const t=e.filter((e=>void 0!==e.change)).slice(-5).map((e=>e.change));if(0===t.length)return"stable";const n=t.reduce(((e,t)=>e+t),0);return n>5?"rising":n<-5?"falling":"stable"}getReputationCategory(e){return e>=150?"excellent":e>=100?"good":e>=50?"average":e>=25?"poor":"terrible"}getReputationModifiers(){const{reputation:e,reputationFactors:t}=this.playerState,n={projectCost:1,constructionSpeed:1,projectQuality:1,staffRecruitmentCost:1,loanInterestRate:1,projectSalePrice:1,auditFrequency:1,stakeholderTrust:1};e>=150?(n.projectCost*=.85,n.constructionSpeed*=1.2,n.staffRecruitmentCost*=.9,n.loanInterestRate*=.8,n.projectSalePrice*=1.25,n.auditFrequency*=.5,n.stakeholderTrust*=1.5):e>=100?(n.projectCost*=.95,n.constructionSpeed*=1.1,n.loanInterestRate*=.9,n.projectSalePrice*=1.1,n.auditFrequency*=.8,n.stakeholderTrust*=1.2):e>=50||(e>=25?(n.projectCost*=1.1,n.constructionSpeed*=.9,n.staffRecruitmentCost*=1.1,n.loanInterestRate*=1.2,n.projectSalePrice*=.9,n.auditFrequency*=1.5,n.stakeholderTrust*=.8):(n.projectCost*=1.25,n.constructionSpeed*=.8,n.staffRecruitmentCost*=1.25,n.loanInterestRate*=1.5,n.projectSalePrice*=.75,n.auditFrequency*=2.5,n.stakeholderTrust*=.5));const{legalCompliance:i,environmentalImpact:r,communityRelations:a,projectQuality:s,transparency:o,grayAreaActivity:l}=t;return n.auditFrequency*=1-i+1,n.loanInterestRate*=1+.3*(1-i),n.projectSalePrice*=1+.2*(r-1),n.stakeholderTrust*=1+.2*(r-1),n.constructionSpeed*=1+.1*(a-1),n.stakeholderTrust*=1+.3*(a-1),n.projectSalePrice*=1+.3*(s-1),n.projectCost*=1-.1*(s-1),n.loanInterestRate*=1-.2*(o-1),n.auditFrequency*=1-.1*(o-1),n.auditFrequency*=1+.5*(l-1),n.stakeholderTrust*=1-.3*(l-1),n}calculateReputationBonus(e){const{reputation:t,reputationFactors:n}=this.playerState;let i=0;i=t>=150?.2:t>=100?.1:t>=50?0:t>=25?-.1:-.2;const r={negotiate_land:["communityRelations","transparency"],apply_for_permit:["legalCompliance","transparency"],environmental_study:["environmentalImpact","projectQuality"],lobby_officials:["transparency","legalCompliance"],project_design:["projectQuality","environmentalImpact"],build_project:["projectQuality","communityRelations"],get_grid_connection:["legalCompliance","transparency"],get_loan:["legalCompliance","transparency"]}[e]||[];let a=0;if(r.length>0){const e=r.reduce(((e,t)=>e+(n[t]||1)),0);a=.2*(e/r.length-1)}const s=i+a;return Math.max(-.3,Math.min(.3,s))}updateReputationForEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={project_success:{reputationChange:5,factorChanges:{projectQuality:.05}},project_delay:{reputationChange:-3,factorChanges:{projectQuality:-.03,transparency:-.02}},local_protest:{reputationChange:-8,factorChanges:{communityRelations:-.1,transparency:-.05}},environmental_award:{reputationChange:10,factorChanges:{environmentalImpact:.1,projectQuality:.05}},project_overbudget:{reputationChange:-5,factorChanges:{projectQuality:-.05,transparency:-.03}},positive_media_coverage:{reputationChange:7,factorChanges:{transparency:.05}},negative_media_coverage:{reputationChange:-7,factorChanges:{transparency:-.05}},successful_audit:{reputationChange:8,factorChanges:{legalCompliance:.08,transparency:.05}},innovation_breakthrough:{reputationChange:12,factorChanges:{projectQuality:.1,environmentalImpact:.08}},staff_incident:{reputationChange:-6,factorChanges:{transparency:-.04,projectQuality:-.03}}}[e];if(n&&(this.playerDispatch({type:"UPDATE_REPUTATION",payload:{change:n.reputationChange,reason:t.reason||`Zdarzenie: ${e}`,turn:this.gameState.turn}}),n.factorChanges))for(const[i,r]of Object.entries(n.factorChanges))this.playerDispatch({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:i,change:r,reason:t.reason||`Zdarzenie: ${e}`,turn:this.gameState.turn}})}triggerRandomEvent(){const{reputation:e,reputationFactors:t}=this.playerState,n=[{type:"positive_media_coverage",weight:10+(e-100)/5,condition:()=>e>70&&t.transparency>.8},{type:"negative_media_coverage",weight:10+(100-e)/5,condition:()=>e<130&&t.transparency<1.2},{type:"local_protest",weight:8+20*(1-t.communityRelations),condition:()=>t.communityRelations<1.3},{type:"environmental_award",weight:5+20*(t.environmentalImpact-1),condition:()=>t.environmentalImpact>1.2&&e>80},{type:"innovation_breakthrough",weight:3+10*(t.projectQuality-1),condition:()=>t.projectQuality>1.1},{type:"staff_incident",weight:7-10*(t.projectQuality-1),condition:()=>t.projectQuality<1.3}].filter((e=>e.condition()));if(0===n.length)return null;const i=n.reduce(((e,t)=>e+Math.max(1,t.weight)),0);let r=Math.random()*i,a=null;for(const s of n){const e=Math.max(1,s.weight);if(r<=e){a=s;break}r-=e}return a||(a=n[0]),this.updateReputationForEvent(a.type),{type:a.type,description:this.getEventDescription(a.type),turn:this.gameState.turn}}getEventDescription(e){return{project_success:"Tw\xf3j projekt zosta\u0142 uko\u0144czony przed terminem, co spotka\u0142o si\u0119 z uznaniem bran\u017cy.",project_delay:"Op\xf3\u017anienia w realizacji projektu wywo\u0142a\u0142y niezadowolenie inwestor\xf3w.",local_protest:"Mieszka\u0144cy protestuj\u0105 przeciwko Twojej inwestycji, obawiaj\u0105c si\u0119 jej wp\u0142ywu na lokaln\u0105 spo\u0142eczno\u015b\u0107.",environmental_award:"Twoja firma otrzyma\u0142a nagrod\u0119 za wk\u0142ad w ochron\u0119 \u015brodowiska i zr\xf3wnowa\u017cony rozw\xf3j.",project_overbudget:"Jeden z Twoich projekt\xf3w znacznie przekroczy\u0142 bud\u017cet, wzbudzaj\u0105c obawy o zarz\u0105dzanie finansami.",positive_media_coverage:"Media pozytywnie opisa\u0142y dzia\u0142alno\u015b\u0107 Twojej firmy, podkre\u015blaj\u0105c jej etyczne praktyki.",negative_media_coverage:"Krytyczny artyku\u0142 w mediach rzuci\u0142 cie\u0144 na reputacj\u0119 Twojej firmy.",successful_audit:"Twoja firma przesz\u0142a audyt z wyr\xf3\u017cnieniem, potwierdzaj\u0105c zgodno\u015b\u0107 z przepisami.",innovation_breakthrough:"Tw\xf3j zesp\xf3\u0142 opracowa\u0142 innowacyjne rozwi\u0105zanie, kt\xf3re zosta\u0142o docenione przez bran\u017c\u0119.",staff_incident:"Incydent z udzia\u0142em pracownika Twojej firmy wywo\u0142a\u0142 negatywne komentarze."}[e]||"Nieznane zdarzenie wp\u0142yn\u0119\u0142o na reputacj\u0119 Twojej firmy."}generateReputationReport(){const{reputation:e,reputationFactors:t,reputationHistory:n}=this.playerState,i=n.filter((e=>e.turn>=this.gameState.turn-10)).map((e=>({turn:e.turn,reason:e.reason,change:e.change,type:e.type,factor:e.factor}))),r=Object.entries(t);r.sort(((e,t)=>t[1]-e[1]));const a=r.slice(0,2).map((e=>{let[t,n]=e;return{factor:t,value:n}}));r.sort(((e,t)=>e[1]-t[1]));const s=r.slice(0,2).map((e=>{let[t,n]=e;return{factor:t,value:n}})),o=this.calculateReputationTrend(n),l=this.generateRecommendations(e,t,s.map((e=>e.factor)));return{currentReputation:e,category:this.getReputationCategory(e),trend:o,factors:t,strongestFactors:a,weakestFactors:s,recentChanges:i,recommendations:l,modifiers:this.getReputationModifiers()}}generateRecommendations(e,t,n){const i=[];return e<50&&i.push({text:"Rozwa\u017c przeprowadzenie kompleksowej kampanii naprawczej reputacji.",priority:"high"}),e<80&&e>=50&&i.push({text:"Zwi\u0119ksz przejrzysto\u015b\u0107 komunikacji z interesariuszami.",priority:"medium"}),n.forEach((e=>{const n=t[e];if(n<.7){const t={legalCompliance:"Zainwestuj w program zgodno\u015bci prawnej i szkolenia dla pracownik\xf3w.",environmentalImpact:"Zainwestuj w inicjatywy \u015brodowiskowe i ulepsz standardy projektowe.",communityRelations:"Nawi\u0105\u017c dialog ze spo\u0142eczno\u015bciami lokalnymi i wspieraj lokalne inicjatywy.",projectQuality:"Wprowad\u017a rygorystyczne kontrole jako\u015bci i zainwestuj w szkolenia zespo\u0142u.",transparency:"Zwi\u0119ksz przejrzysto\u015b\u0107 dzia\u0142a\u0144 firmy i komunikacj\u0119 z interesariuszami.",grayAreaActivity:"Przeprowad\u017a wewn\u0119trzny audyt i wyeliminuj praktyki z szarej strefy."};t.push({text:t[e]||`Popraw czynnik: ${e}`,priority:"high",factor:e})}else if(n<1){const t={legalCompliance:"Regularnie przegl\u0105daj zgodno\u015b\u0107 z przepisami i wytycznymi bran\u017cowymi.",environmentalImpact:"Monitoruj wp\u0142yw projekt\xf3w na \u015brodowisko i wprowadzaj ulepszenia.",communityRelations:"Organizuj regularne konsultacje spo\u0142eczne i wydarzenia dla spo\u0142eczno\u015bci.",projectQuality:"Zbieraj i analizuj feedback dotycz\u0105cy jako\u015bci projekt\xf3w.",transparency:"Publikuj regularne raporty z dzia\u0142alno\u015bci firmy.",grayAreaActivity:"Wprowad\u017a program etyczny i mechanizmy zg\u0142aszania nieprawid\u0142owo\u015bci."};t.push({text:t[e]||`Popraw czynnik: ${e}`,priority:"medium",factor:e})}})),t.grayAreaActivity>=1.3&&i.push({text:"Uwaga! Wysoki poziom aktywno\u015bci w szarej strefie zwi\u0119ksza ryzyko audytu!",priority:"critical",factor:"grayAreaActivity"}),i}}class sy{constructor(e,t,n){this.playerState=e,this.playerDispatch=t,this.gameState=n}calculateAuditRisk(){const{illegals:e,reputationFactors:t}=this.playerState,n=e.auditRisk,i=.2*e.corruptionNetwork,r=40*(t.grayAreaActivity-1),a=3*e.illegalActionHistory.filter((e=>e.turn>this.gameState.turn-10)).length;return Math.min(95,Math.max(5,n-i+r+a))}executeIllegalAction(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{cost:n=0,target:i=null,riskIncrease:r=5}=t;if(this.playerState.cash<n)return{success:!1,reason:"Niewystarczaj\u0105ca ilo\u015b\u0107 got\xf3wki"};this.playerDispatch({type:"ADD_ILLEGAL_ACTION",payload:{type:e,target:i,cost:n,turn:this.gameState.turn,exposed:!1}}),this.playerDispatch({type:"UPDATE_ILLEGALS_STATUS",payload:{auditRisk:Math.min(100,this.playerState.illegals.auditRisk+r)}}),this.updateReputationForIllegalAction(e,t);const a=this.calculateDetectionRisk(e);return 100*Math.random()<a?(this.handleDetection(e,t),{success:!0,detected:!0,consequences:"Dzia\u0142anie zosta\u0142o wykryte, co mia\u0142o negatywny wp\u0142yw na reputacj\u0119 firmy."}):{success:!0,detected:!1}}updateReputationForIllegalAction(e,t){const n={bribe_official:{transparency:-.05,legalCompliance:-.1,grayAreaActivity:.08},falsify_documents:{transparency:-.08,legalCompliance:-.15,grayAreaActivity:.1},intimidate_opposition:{communityRelations:-.12,transparency:-.07,grayAreaActivity:.12},create_illegal_database:{transparency:-.1,legalCompliance:-.15,grayAreaActivity:.2},build_corruption_network:{transparency:-.15,legalCompliance:-.2,grayAreaActivity:.25},buy_land_illegally:{legalCompliance:-.12,grayAreaActivity:.15}}[e]||{};for(const[i,r]of Object.entries(n))this.playerDispatch({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:i,change:r,reason:`Nielegalne dzia\u0142anie: ${this.getActionName(e)}`,turn:this.gameState.turn}});this.playerDispatch({type:"UPDATE_REPUTATION",payload:{change:-5,reason:`Nielegalne dzia\u0142anie: ${this.getActionName(e)}`,turn:this.gameState.turn}})}calculateDetectionRisk(e){const{illegals:t,reputationFactors:n}=this.playerState,i={bribe_official:15,falsify_documents:20,intimidate_opposition:25,create_illegal_database:10,build_corruption_network:15,buy_land_illegally:30}[e]||20,r=.15*t.corruptionNetwork,a=10*n.transparency;return Math.min(90,Math.max(5,i-r+a))}handleDetection(e,t){this.playerDispatch({type:"UPDATE_REPUTATION",payload:{change:-15,reason:`Wykryto nielegalne dzia\u0142anie: ${this.getActionName(e)}`,turn:this.gameState.turn}}),this.playerDispatch({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:"transparency",change:-.2,reason:`Wykryto nielegalne dzia\u0142anie: ${this.getActionName(e)}`,turn:this.gameState.turn}}),this.playerDispatch({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:"legalCompliance",change:-.25,reason:`Wykryto nielegalne dzia\u0142anie: ${this.getActionName(e)}`,turn:this.gameState.turn}});const n=this.playerState.illegals.illegalActionHistory.length-1;if(n>=0){const e=[...this.playerState.illegals.illegalActionHistory];e[n]={...e[n],exposed:!0},this.playerDispatch({type:"UPDATE_ILLEGALS_STATUS",payload:{illegalActionHistory:e,auditRisk:Math.min(100,this.playerState.illegals.auditRisk+20)}})}}conductAudit(){const{illegals:e,reputationFactors:t}=this.playerState;let n=30;n-=.3*e.corruptionNetwork,n+=20*t.grayAreaActivity;const i=e.illegalActionHistory.filter((e=>e.turn>this.gameState.turn-20)).length;n+=5*i;const r=100*Math.random()<n;let a=0,s=0;return r&&(a=5e5,a+=25e4*i,a*=1-e.corruptionNetwork/200,s=15+2*i,this.playerDispatch({type:"UPDATE_REPUTATION",payload:{change:-s,reason:"Nieprawid\u0142owo\u015bci wykryte podczas audytu",turn:this.gameState.turn}}),this.playerDispatch({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:"legalCompliance",change:-.15,reason:"Nieprawid\u0142owo\u015bci wykryte podczas audytu",turn:this.gameState.turn}}),this.playerDispatch({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:"transparency",change:-.1,reason:"Nieprawid\u0142owo\u015bci wykryte podczas audytu",turn:this.gameState.turn}})),this.playerDispatch({type:"TRIGGER_AUDIT",payload:{passed:!r,fine:a,reputationLoss:s,turn:this.gameState.turn,riskReduction:20}}),{passed:!r,fine:a,reputationLoss:s}}getActionName(e){return{bribe_official:"Przekupienie urz\u0119dnika",falsify_documents:"Fa\u0142szowanie dokument\xf3w",intimidate_opposition:"Zastraszanie opozycji",create_illegal_database:"Stworzenie nielegalnej bazy danych",build_corruption_network:"Budowa sieci korupcyjnej",buy_land_illegally:"Nielegalne nabycie grunt\xf3w"}[e]||e}getGrayAreaStatus(){const{illegals:e,reputationFactors:t}=this.playerState;return{auditRisk:this.calculateAuditRisk(),corruptionNetwork:e.corruptionNetwork,grayAreaActivity:t.grayAreaActivity,recentIllegalActions:e.illegalActionHistory.filter((e=>e.turn>this.gameState.turn-10)).length,lastAuditTurn:e.lastAuditTurn,turnsSinceLastAudit:this.gameState.turn-e.lastAuditTurn,hasIllegalDatabase:e.hasIllegalDatabase}}}class oy{constructor(e,t,n,i){this.playerState=e,this.playerDispatch=t,this.gameState=n,this.reputationManager=i}calculateMaxCreditLimit(){const{cash:e,economicMetrics:t,reputation:n,projects:i}=this.playerState;let r=1;r=n>=150?1.5:n>=100?1.2:n>=50?1:n>=25?.7:.5;const a=(2*e+.75*i.reduce(((e,t)=>e+(t.marketValue||0)),0))*r,s=Math.min(5e7+this.gameState.turn/30*5e7,5e8);return Math.min(a,s)}calculateInterestRate(e,t){var n;const i=this.reputationManager.getReputationModifiers().loanInterestRate,r=(null===(n=this.gameState.economyState)||void 0===n?void 0:n.baseInterestRate)||3;let a=0;t<=12?a=-.5:t>=36&&(a=1);let s=0;e<=1e6?s=.5:e>=1e7&&(s=-.5);const o=this.getTotalOutstandingLoans(),l=(r+a+s+Math.min(2,o/1e7))*i;return Math.max(1.5,Math.min(12,l))}getTotalOutstandingLoans(){const{loans:e}=this.playerState;return e&&0!==e.length?e.reduce(((e,t)=>t.remainingAmount?e+t.remainingAmount:e),0):0}calculateMonthlyPayment(e,t,n){const i=t/100/12;return e*i*Math.pow(1+i,n)/(Math.pow(1+i,n)-1)}applyForLoan(e,t,n){const i=this.calculateMaxCreditLimit();if(e>i)return{success:!1,reason:`Przekroczono limit kredytowy ${i.toLocaleString()} PLN`};const r=this.calculateInterestRate(e,t),a=this.calculateMonthlyPayment(e,r,t),s=this.generateLoanSchedule(e,r,t),o=`loan_${Date.now()}`;return this.playerDispatch({type:"ADD_LOAN",payload:{id:o,amount:e,interestRate:r,durationMonths:t,monthlyPayment:a,remainingAmount:e,remainingPayments:t,startDate:(new Date).toISOString(),purpose:n,schedule:s,status:"active"}}),{success:!0,loanId:o,amount:e,interestRate:r,monthlyPayment:a,durationMonths:t}}generateLoanSchedule(e,t,n){const i=t/100/12,r=this.calculateMonthlyPayment(e,t,n);let a=e;const s=[];for(let o=1;o<=n;o++){const e=a*i,t=r-e;a-=t,s.push({paymentNumber:o,date:this.addMonths(new Date,o),payment:r,principal:t,interest:e,remainingPrincipal:Math.max(0,a),paid:!1})}return s}processMonthlyPayments(){const{loans:e,cash:t}=this.playerState;if(!e||0===e.length)return{success:!0,message:"Brak aktywnych kredyt\xf3w"};let n=0;const i=[],r=[];for(const a of e)"active"===a.status&&(n+=a.monthlyPayment);if(t<n)return{success:!1,message:`Niewystarczaj\u0105ce \u015brodki na sp\u0142at\u0119 rat kredyt\xf3w (${n.toLocaleString()} PLN)`,shortfall:n-t};this.playerDispatch({type:"UPDATE_CASH",payload:-n});for(const a of e){if("active"!==a.status)continue;const e=a.remainingPayments-1,t=a.schedule[a.durationMonths-a.remainingPayments];if(t){const n=[...a.schedule];n[a.durationMonths-a.remainingPayments]={...t,paid:!0,paidDate:(new Date).toISOString()};const s={...a,remainingPayments:e,remainingAmount:a.remainingAmount-t.principal,schedule:n,status:0===e?"completed":"active"};this.playerDispatch({type:"UPDATE_LOAN",payload:{id:a.id,changes:s}}),0===e?r.push(a.id):i.push(a.id)}}return{success:!0,message:`Dokonano sp\u0142aty rat na \u0142\u0105czn\u0105 kwot\u0119 ${n.toLocaleString()} PLN`,updatedLoans:i,completedLoans:r}}makeLoanPrepayment(e,t){const{loans:n,cash:i}=this.playerState,r=n.find((t=>t.id===e));if(!r)return{success:!1,message:"Nie znaleziono kredytu"};if("active"!==r.status)return{success:!1,message:`Kredyt ma status ${r.status} i nie mo\u017ce by\u0107 sp\u0142acony`};if(i<t)return{success:!1,message:`Niewystarczaj\u0105ce \u015brodki (${t.toLocaleString()} PLN)`};t>r.remainingAmount&&(t=r.remainingAmount),this.playerDispatch({type:"UPDATE_CASH",payload:-t});const a=r.remainingAmount-t;if(a<=0)return this.playerDispatch({type:"UPDATE_LOAN",payload:{id:e,changes:{remainingAmount:0,remainingPayments:0,status:"completed"}}}),{success:!0,message:"Kredyt zosta\u0142 ca\u0142kowicie sp\u0142acony",fullyPaid:!0};{const n=this.recalculateLoanSchedule(a,r.interestRate,r.remainingPayments),i=n.length>0?n[0].payment:0;return this.playerDispatch({type:"UPDATE_LOAN",payload:{id:e,changes:{remainingAmount:a,monthlyPayment:i,schedule:this.mergeSchedule(r.schedule,n,r.durationMonths-r.remainingPayments)}}}),{success:!0,message:`Dokonano przedp\u0142aty w kwocie ${t.toLocaleString()} PLN`,newRemainingAmount:a,newMonthlyPayment:i}}}recalculateLoanSchedule(e,t,n){const i=t/100/12,r=this.calculateMonthlyPayment(e,t,n);let a=e;const s=[];for(let o=1;o<=n;o++){const e=a*i,t=r-e;a-=t,s.push({paymentNumber:o,date:this.addMonths(new Date,o),payment:r,principal:t,interest:e,remainingPrincipal:Math.max(0,a),paid:!1})}return s}mergeSchedule(e,t,n){const i=[...e];for(let r=0;r<n;r++)i[r]&&(i[r].paid=!0);for(let r=0;r<t.length;r++){const e=r+n;e<i.length&&(i[e]={...i[e],payment:t[r].payment,principal:t[r].principal,interest:t[r].interest,remainingPrincipal:t[r].remainingPrincipal})}return i}getLoanOffers(){const e=this.calculateMaxCreditLimit(),{reputation:t}=this.playerState,n=[{name:"Kredyt kr\xf3tkoterminowy",description:"Kredyt na pokrycie bie\u017c\u0105cych potrzeb firmy",durationMonths:12,maxAmount:Math.min(e,1e7),interestRate:this.calculateInterestRate(5e6,12),type:"standard"},{name:"Kredyt \u015brednioterminowy",description:"Kredyt na rozw\xf3j i inwestycje \u015bredniej wielko\u015bci",durationMonths:24,maxAmount:Math.min(e,2e7),interestRate:this.calculateInterestRate(1e7,24),type:"standard"},{name:"Kredyt d\u0142ugoterminowy",description:"Kredyt na du\u017ce projekty inwestycyjne",durationMonths:36,maxAmount:Math.min(e,5e7),interestRate:this.calculateInterestRate(25e6,36),type:"standard"}];let i=[];t>=120&&i.push({name:"Kredyt preferencyjny",description:"Specjalna oferta dla firm o wyj\u0105tkowej reputacji",durationMonths:60,maxAmount:Math.min(e,1e8),interestRate:.9*this.calculateInterestRate(5e7,60),type:"special"}),t>=150&&i.push({name:"Finansowanie strategiczne",description:"Ekskluzywna oferta dla lider\xf3w rynku",durationMonths:120,maxAmount:Math.min(e,2e8),interestRate:.85*this.calculateInterestRate(1e8,120),type:"premium"});let r=[];return this.playerState.reputationFactors.environmentalImpact>=1.3&&r.push({name:"Zielone finansowanie",description:"Preferencyjny kredyt na projekty z pozytywnym wp\u0142ywem \u015brodowiskowym",durationMonths:48,maxAmount:Math.min(e,8e7),interestRate:.8*this.calculateInterestRate(4e7,48),type:"green",requirements:"Tylko na projekty ekologiczne z certyfikatem"}),[...n,...i,...r]}addMonths(e,t){const n=new Date(e);return n.setMonth(n.getMonth()+t),n.toISOString()}}const ly=()=>{const{state:e,dispatch:t}=u(),{state:n}=ff(),r=(0,i.useMemo)((()=>new ay(e,t,n)),[e,t,n]),a=(0,i.useMemo)((()=>new sy(e,t,n)),[e,t,n]),s=(0,i.useMemo)((()=>new oy(e,t,n,r)),[e,t,n,r]);return{reputationManager:r,grayAreaManager:a,bankingSystem:s}},cy=Ff("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]),dy=Ff("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),uy=Ff("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),hy=Ff("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),py=Ff("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),my=Ff("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),fy=e=>{let{children:t,variant:n="primary",size:i="medium",onClick:r,className:s="",disabled:o=!1,...l}=e;return(0,a.jsx)("button",{className:`${{primary:"bg-blue-700 hover:bg-blue-800 text-white",success:"bg-green-500 hover:bg-green-600 text-white",danger:"bg-red-500 hover:bg-red-600 text-white",warning:"bg-yellow-500 hover:bg-yellow-600 text-black",info:"bg-blue-500 hover:bg-blue-600 text-white",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-800"}[n]} ${{small:"px-2 py-1 text-xs",medium:"px-3 py-1",large:"px-4 py-2 text-lg"}[i]} rounded font-medium transition-colors ${o?"opacity-50 cursor-not-allowed":""} ${s}`,onClick:r,disabled:o,...l,children:t})},yy=e=>{let{onClose:t}=e;const{state:n}=u(),{state:r}=ff(),{reputationManager:s}=ly(),[o,l]=(0,i.useState)(null),[c,d]=(0,i.useState)("overview");(0,i.useEffect)((()=>{s&&l(s.generateReputationReport())}),[n.reputation,n.reputationFactors,s]);const h=e=>"rising"===e?(0,a.jsx)(iy,{className:"w-5 h-5 text-green-500"}):"falling"===e?(0,a.jsx)(ry,{className:"w-5 h-5 text-red-500"}):(0,a.jsx)(ny,{className:"w-5 h-5 text-gray-500"}),p=e=>({legalCompliance:(0,a.jsx)(ty,{className:"w-5 h-5 text-blue-500"}),environmentalImpact:(0,a.jsx)(cy,{className:"w-5 h-5 text-green-500"}),communityRelations:(0,a.jsx)(Gf,{className:"w-5 h-5 text-purple-500"}),projectQuality:(0,a.jsx)(dy,{className:"w-5 h-5 text-yellow-500"}),transparency:(0,a.jsx)(uy,{className:"w-5 h-5 text-cyan-500"}),grayAreaActivity:(0,a.jsx)(hy,{className:"w-5 h-5 text-gray-500"})}[e]||(0,a.jsx)(Kf,{className:"w-5 h-5 text-gray-500"})),m=e=>({legalCompliance:"Zgodno\u015b\u0107 z prawem",environmentalImpact:"Wp\u0142yw na \u015brodowisko",communityRelations:"Relacje ze spo\u0142eczno\u015bci\u0105",projectQuality:"Jako\u015b\u0107 projekt\xf3w",transparency:"Przejrzysto\u015b\u0107",grayAreaActivity:"Aktywno\u015b\u0107 w szarej strefie"}[e]||e),f=(e,t)=>"grayAreaActivity"===e?t<=.7?"text-green-600 font-medium":t<=1?"text-blue-600":t<=1.3?"text-yellow-600":"text-red-600":t>=1.5?"text-green-600 font-medium":t>=1?"text-blue-600":t>=.7?"text-yellow-600":"text-red-600",y=(e,t)=>"grayAreaActivity"===e?t<=.7?"bg-green-500":t<=1?"bg-blue-500":t<=1.3?"bg-yellow-500":"bg-red-500":t>=1.5?"bg-green-500":t>=1?"bg-blue-500":t>=.7?"bg-yellow-500":"bg-red-500",g=e=>({projectCost:"Koszt projekt\xf3w",constructionSpeed:"Szybko\u015b\u0107 budowy",projectQuality:"Jako\u015b\u0107 projekt\xf3w",staffRecruitmentCost:"Koszt rekrutacji",loanInterestRate:"Oprocentowanie kredyt\xf3w",projectSalePrice:"Cena sprzeda\u017cy projekt\xf3w",auditFrequency:"Cz\u0119stotliwo\u015b\u0107 audyt\xf3w",stakeholderTrust:"Zaufanie interesariuszy"}[e]||e),v=(e,t)=>{const n=["projectCost","loanInterestRate","staffRecruitmentCost","auditFrequency"].includes(e),i=t-1,r=Math.abs(100*i).toFixed(0);return 0===i?(0,a.jsx)("span",{className:"text-gray-600",children:"Neutralny"}):n?i<0?(0,a.jsxs)("span",{className:"text-green-600",children:["-",r,"%"]}):(0,a.jsxs)("span",{className:"text-red-600",children:["+",r,"%"]}):i>0?(0,a.jsxs)("span",{className:"text-green-600",children:["+",r,"%"]}):(0,a.jsxs)("span",{className:"text-red-600",children:["-",r,"%"]})};return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Reputacja Firmy"}),(0,a.jsx)(fy,{onClick:t,variant:"secondary",size:"sm",children:"Zamknij"})]}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("div",{className:"flex border-b",children:[(0,a.jsx)("button",{className:"px-4 py-2 font-medium "+("overview"===c?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),onClick:()=>d("overview"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(Qf,{className:"w-4 h-4 mr-1"}),(0,a.jsx)("span",{children:"Przegl\u0105d"})]})}),(0,a.jsx)("button",{className:"px-4 py-2 font-medium "+("modifiers"===c?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),onClick:()=>d("modifiers"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(py,{className:"w-4 h-4 mr-1"}),(0,a.jsx)("span",{children:"Modyfikatory"})]})}),(0,a.jsx)("button",{className:"px-4 py-2 font-medium "+("history"===c?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),onClick:()=>d("history"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(my,{className:"w-4 h-4 mr-1"}),(0,a.jsx)("span",{children:"Historia"})]})})]})}),(0,a.jsxs)("div",{children:["overview"===c&&(()=>{if(!o)return(0,a.jsx)("div",{children:"\u0141adowanie danych..."});const{currentReputation:e,category:t,trend:n,factors:i}=o,r=(s=e)>=150?{label:"Doskona\u0142a",color:"text-green-600"}:s>=100?{label:"Dobra",color:"text-blue-600"}:s>=50?{label:"Przeci\u0119tna",color:"text-yellow-600"}:s>=25?{label:"S\u0142aba",color:"text-orange-600"}:{label:"Bardzo s\u0142aba",color:"text-red-600"};var s;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-medium mb-2 text-blue-700",children:"Reputacja Firmy"}),(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("div",{className:"w-full h-4 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full "+(e>=150?"bg-green-500":e>=100?"bg-blue-500":e>=50?"bg-yellow-500":e>=25?"bg-orange-500":"bg-red-500"),style:{width:`${Math.min(100,e/2)}%`}})}),(0,a.jsx)("span",{className:"ml-3 font-medium",children:e})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:`${r.color} font-medium`,children:r.label}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-sm mr-1",children:"Trend:"}),h(n)]})]})]}),(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Czynniki Reputacji"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:Object.entries(i).map((e=>{let[t,n]=e;return(0,a.jsxs)("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center mb-1",children:[p(t),(0,a.jsx)("span",{className:"ml-2 font-medium",children:m(t)})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Warto\u015b\u0107:"}),(0,a.jsxs)("span",{className:f(t,n),children:[(100*n).toFixed(0),"%"]})]}),(0,a.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:y(t,n),style:{width:`${Math.min(100,50*n)}%`}})})]},t)}))}),(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Rekomendacje"}),(0,a.jsx)("div",{className:"space-y-2 mb-6",children:o.recommendations.length>0?o.recommendations.map(((e,t)=>{return(0,a.jsx)("div",{className:"bg-white p-3 rounded-lg shadow-sm border-l-4 border-yellow-500",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(n=e.priority,"critical"===n?(0,a.jsx)(Kf,{className:"w-5 h-5 text-red-500"}):"high"===n?(0,a.jsx)(Kf,{className:"w-5 h-5 text-orange-500"}):"medium"===n?(0,a.jsx)(Kf,{className:"w-5 h-5 text-yellow-500"}):(0,a.jsx)(Kf,{className:"w-5 h-5 text-blue-500"})),(0,a.jsxs)("div",{className:"ml-2",children:[(0,a.jsx)("p",{className:"text-sm",children:e.text}),e.factor&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Dotyczy: ",m(e.factor)]})]})]})},t);var n})):(0,a.jsxs)("div",{className:"text-center py-4 text-gray-500",children:[(0,a.jsx)(py,{className:"h-12 w-12 mx-auto mb-2 text-green-300"}),(0,a.jsx)("p",{children:"Brak rekomendacji - Twoja reputacja jest w doskona\u0142ym stanie!"})]})})]})})(),"modifiers"===c&&(()=>{if(!o)return(0,a.jsx)("div",{children:"\u0141adowanie danych..."});const{modifiers:e}=o;return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:(0,a.jsx)("p",{className:"text-sm text-blue-800",children:"Modyfikatory pokazuj\u0105, jak Twoja reputacja wp\u0142ywa na r\xf3\u017cne aspekty gry. Warto\u015b\u0107 100% oznacza brak wp\u0142ywu, warto\u015bci ni\u017csze lub wy\u017csze oznaczaj\u0105 odpowiednio negatywny lub pozytywny wp\u0142yw."})}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(e).map((e=>{let[t,n]=e;return(0,a.jsxs)("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("span",{className:"font-medium",children:g(t)}),v(t,n)]}),(0,a.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:n<1?"bg-green-500":n>1?"bg-red-500":"bg-blue-500",style:{width:`${Math.min(100,50*n)}%`}})}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:n<1?`${Math.abs(100*(n-1)).toFixed(0)}% ni\u017csze koszty/czasy`:n>1?`${(100*(n-1)).toFixed(0)}% wy\u017csze koszty/czasy`:"Neutralny wp\u0142yw"})]},t)}))})]})})(),"history"===c&&(()=>{if(!n.reputationHistory||0===n.reputationHistory.length)return(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(my,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Brak historii zmian reputacji"})]});const e=[...n.reputationHistory].reverse().slice(0,20);return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:(0,a.jsx)("p",{className:"text-sm text-blue-800",children:"Historia ostatnich 20 zmian reputacji Twojej firmy."})}),(0,a.jsx)("div",{className:"space-y-2",children:e.map(((e,t)=>(0,a.jsxs)("div",{className:"bg-white p-3 rounded-lg shadow-sm border-l-4 border-blue-500",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,a.jsx)("span",{className:"font-medium",children:"factor_change"===e.type?`Zmiana czynnika: ${m(e.factor)}`:"Zmiana reputacji"}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["Tura ",e.turn]})]}),(0,a.jsx)("p",{className:"text-sm",children:e.reason}),(0,a.jsxs)("div",{className:"flex items-center mt-1",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 mr-2",children:"Zmiana:"}),(0,a.jsxs)("span",{className:e.change>0?"text-green-600":e.change<0?"text-red-600":"text-gray-600",children:[e.change>0?"+":"","factor_change"===e.type?`${(100*e.change).toFixed(0)}%`:e.change]})]})]},t)))})]})})()]})]})},gy=Ff("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),vy=Ff("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),wy=Ff("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),xy=Ff("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),by=Ff("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),jy=Ff("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),ky={INDUSTRY_CONFERENCE:{type:"conference",name:"Udzia\u0142 w konferencji bran\u017cowej",description:"Aktywny udzia\u0142 w konferencji bran\u017cowej buduje wizerunek eksperta i lidera sektora OZE.",cost:5e4,duration:30,intensity:1,icon:(0,a.jsx)(py,{className:"w-5 h-5 text-blue-500"}),immediateEffects:[{reputationChange:2,factor:"transparency"}],continuousEffects:[{reputationPerDay:.05,factor:"transparency"}],finalEffects:[{factorChange:"transparency",factorAmount:.05}]},SPEAKING_ENGAGEMENT:{type:"conference",name:"Wyst\u0105pienie na konferencji jako ekspert",description:"Prezentacja Twojej ekspertyzy na presti\u017cowej konferencji znacz\u0105co podnosi reputacj\u0119 firmy.",cost:1e5,duration:60,intensity:2,icon:(0,a.jsx)(gy,{className:"w-5 h-5 text-indigo-500"}),immediateEffects:[{reputationChange:5,factor:"transparency"}],continuousEffects:[{reputationPerDay:.1,factor:"transparency"}],finalEffects:[{factorChange:"transparency",factorAmount:.1}]},ENVIRONMENTAL_NGO_PARTNERSHIP:{type:"ngo_partnership",name:"Partnerstwo z organizacj\u0105 ekologiczn\u0105",description:"D\u0142ugoterminowe partnerstwo z uznan\u0105 organizacj\u0105 ekologiczn\u0105 uwiarygadnia Twoje zaanga\u017cowanie w ochron\u0119 \u015brodowiska.",cost:2e5,duration:365,intensity:2,icon:(0,a.jsx)(cy,{className:"w-5 h-5 text-green-500"}),immediateEffects:[{reputationChange:3,factor:"environmentalImpact"}],continuousEffects:[{reputationPerDay:.03,factor:"environmentalImpact"},{factorChange:"environmentalImpact",factorPerDay:2e-4}],finalEffects:[{reputationChange:5,factor:"environmentalImpact"}]},COMMUNITY_FUND:{type:"ngo_partnership",name:"Fundusz wspierania spo\u0142eczno\u015bci lokalnych",description:"Utworzenie funduszu wspieraj\u0105cego inicjatywy spo\u0142eczno\u015bci lokalnych w regionach Twoich inwestycji OZE.",cost:5e5,duration:365,intensity:3,icon:(0,a.jsx)(Gf,{className:"w-5 h-5 text-purple-500"}),immediateEffects:[{reputationChange:7,factor:"communityRelations"}],continuousEffects:[{reputationPerDay:.04,factor:"communityRelations"},{factorChange:"communityRelations",factorPerDay:3e-4}],finalEffects:[{factorChange:"communityRelations",factorAmount:.15}]},PR_CAMPAIGN:{type:"media_campaign",name:"Kampania PR",description:"Profesjonalna kampania PR buduj\u0105ca pozytywny wizerunek Twojej firmy w mediach i opinii publicznej.",cost:3e5,duration:90,intensity:2,icon:(0,a.jsx)(vy,{className:"w-5 h-5 text-cyan-500"}),immediateEffects:[{reputationChange:4}],continuousEffects:[{reputationPerDay:.07}],finalEffects:[]},TRANSPARENCY_REPORT:{type:"media_campaign",name:"Raport transparentno\u015bci",description:"Publikacja szczeg\xf3\u0142owego raportu o dzia\u0142alno\u015bci Twojej firmy, wp\u0142ywie na \u015brodowisko i spo\u0142ecze\u0144stwo.",cost:15e4,duration:120,intensity:1,icon:(0,a.jsx)(uy,{className:"w-5 h-5 text-sky-500"}),immediateEffects:[{reputationChange:3,factor:"transparency"},{factorChange:"transparency",factorAmount:.1}],continuousEffects:[{reputationPerDay:.02,factor:"transparency"}],finalEffects:[{reputationChange:2,factor:"transparency"}]},LEGAL_COMPLIANCE_PROGRAM:{type:"legal_repair",name:"Program zgodno\u015bci prawnej",description:"Kompleksowy program naprawczy zapewniaj\u0105cy pe\u0142n\u0105 zgodno\u015b\u0107 z przepisami i najlepszymi praktykami bran\u017cowymi.",cost:4e5,duration:270,intensity:3,icon:(0,a.jsx)(ty,{className:"w-5 h-5 text-red-500"}),immediateEffects:[{factorChange:"grayAreaActivity",factorAmount:-.2}],continuousEffects:[{factorChange:"grayAreaActivity",factorPerDay:-.001},{factorChange:"legalCompliance",factorPerDay:5e-4}],finalEffects:[{reputationChange:8,factor:"legalCompliance"},{factorChange:"legalCompliance",factorAmount:.2}]},WHISTLEBLOWER_PROTECTION:{type:"legal_repair",name:"Program ochrony sygnalist\xf3w",description:"Wdro\u017cenie mechanizm\xf3w zg\u0142aszania nieprawid\u0142owo\u015bci i ochrony sygnalist\xf3w w Twojej firmie.",cost:15e4,duration:120,intensity:2,icon:(0,a.jsx)(hy,{className:"w-5 h-5 text-amber-500"}),immediateEffects:[{reputationChange:2,factor:"transparency"}],continuousEffects:[{factorChange:"grayAreaActivity",factorPerDay:-8e-4}],finalEffects:[{reputationChange:5,factor:"transparency"},{factorChange:"transparency",factorAmount:.1}]}},Ny=e=>{var t;let{onClose:n}=e;const{state:r,dispatch:s}=u(),{state:o,showNotification:l}=ff(),[c,d]=(0,i.useState)(null),h=(0,i.useRef)(null),p=e=>{h.current&&!h.current.contains(e.target)&&n()};(0,i.useEffect)((()=>(document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p)})),[]);const m=Object.values(ky).reduce(((e,t)=>(e[t.type]||(e[t.type]=[]),e[t.type].push(t),e)),{}),f=e=>{const t=[];return e.immediateEffects&&e.immediateEffects.forEach((e=>{t.push({...e,type:"immediate"})})),e.continuousEffects&&e.continuousEffects.forEach((e=>{t.push({...e,type:"continuous"})})),e.finalEffects&&e.finalEffects.forEach((e=>{t.push({...e,type:"final"})})),(0,a.jsx)("div",{className:"grid gap-2",children:t.map(((e,t)=>(0,a.jsxs)("div",{className:"flex items-center border-b pb-2",children:[x(e),(0,a.jsxs)("div",{className:"ml-2",children:[(0,a.jsx)("div",{className:"text-sm font-medium",children:v(e)}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:w(e.type)})]})]},t)))})},y=e=>({conference:"Konferencje i wydarzenia",ngo_partnership:"Wsp\xf3\u0142praca z NGO",media_campaign:"Kampanie medialne",certification:"Certyfikacje i standardy",legal_repair:"Naprawy wizerunkowe"}[e]||e),g=e=>{switch(e){case 1:return"Niska";case 2:return"\u015arednia";case 3:return"Wysoka";default:return"Nieznana"}},v=e=>{if(e.reputationChange){return`Zmiana reputacji: ${e.reputationChange>0?"+":""}${e.reputationChange}`}if(e.reputationPerDay){return`Reputacja dziennie: ${e.reputationPerDay>0?"+":""}${e.reputationPerDay}`}if(e.factorChange){const t={legalCompliance:"Zgodno\u015b\u0107 z prawem",environmentalImpact:"Wp\u0142yw na \u015brodowisko",communityRelations:"Relacje ze spo\u0142eczno\u015bci\u0105",projectQuality:"Jako\u015b\u0107 projekt\xf3w",transparency:"Przejrzysto\u015b\u0107",grayAreaActivity:"Aktywno\u015b\u0107 w szarej strefie"}[e.factorChange]||e.factorChange;let n="";if(e.factorAmount){n=`${e.factorAmount>0?"+":""}${(100*e.factorAmount).toFixed(0)}%`}else if(e.factorPerDay){n=`${e.factorPerDay>0?"+":""}${(100*e.factorPerDay).toFixed(2)}% dziennie`}return`${t}: ${n}`}return"Nieznany efekt"},w=e=>{switch(e){case"immediate":return"Efekt natychmiastowy";case"continuous":return"Efekt ci\u0105g\u0142y";case"final":return"Efekt ko\u0144cowy";default:return""}},x=e=>{if(e.reputationChange||e.reputationPerDay){return e.reputationChange&&e.reputationChange>0||e.reputationPerDay&&e.reputationPerDay>0?(0,a.jsx)(xy,{className:"w-4 h-4 text-green-500"}):(0,a.jsx)(by,{className:"w-4 h-4 text-red-500"})}if(e.factorChange){return{legalCompliance:(0,a.jsx)(ty,{className:"w-4 h-4 text-blue-500"}),environmentalImpact:(0,a.jsx)(cy,{className:"w-4 h-4 text-green-500"}),communityRelations:(0,a.jsx)(Gf,{className:"w-4 h-4 text-purple-500"}),projectQuality:(0,a.jsx)(dy,{className:"w-4 h-4 text-yellow-500"}),transparency:(0,a.jsx)(uy,{className:"w-4 h-4 text-cyan-500"}),grayAreaActivity:(0,a.jsx)(hy,{className:"w-4 h-4 text-gray-500"})}[e.factorChange]||(0,a.jsx)(jy,{className:"w-4 h-4 text-gray-500"})}return(0,a.jsx)(jy,{className:"w-4 h-4 text-gray-500"})},b=e=>({legalCompliance:"Zgodno\u015b\u0107 z prawem",environmentalImpact:"Wp\u0142yw na \u015brodowisko",communityRelations:"Relacje ze spo\u0142eczno\u015bci\u0105",projectQuality:"Jako\u015b\u0107 projekt\xf3w",transparency:"Przejrzysto\u015b\u0107",grayAreaActivity:"Aktywno\u015b\u0107 w szarej strefie"}[e]||e),j=e=>e>=1.5?"text-green-600 font-medium":e>=1?"text-blue-600":e>=.7?"text-yellow-600":"text-red-600",k=(e,t)=>"grayAreaActivity"===e?t<=.7?"bg-green-500":t<=1?"bg-blue-500":t<=1.3?"bg-yellow-500":"bg-red-500":t>=1.5?"bg-green-500":t>=1?"bg-blue-500":t>=.7?"bg-yellow-500":"bg-red-500",N=e=>{const t=Object.values(ky).find((t=>t.type===e.type&&t.name===e.name));return(null===t||void 0===t?void 0:t.icon)||(0,a.jsx)(jy,{className:"w-5 h-5 text-gray-500"})};return(0,a.jsxs)("div",{ref:h,className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Inicjatywy Reputacyjne"}),(0,a.jsx)("button",{onClick:n,className:"p-2 rounded-full hover:bg-gray-100",children:(0,a.jsx)(wy,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-medium mb-2 text-blue-700",children:"Reputacja Firmy"}),(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("div",{className:"w-full h-4 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full "+(z=r.reputation,z>=150?"bg-green-500":z>=100?"bg-blue-500":z>=50?"bg-yellow-500":"bg-red-500"),style:{width:`${Math.min(100,r.reputation/2)}%`}})}),(0,a.jsx)("span",{className:"ml-3 font-medium",children:r.reputation})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:(e=>e>=150?"Doskona\u0142a reputacja - jeste\u015b liderem etycznym w bran\u017cy":e>=100?"Dobra reputacja - jeste\u015b szanowanym graczem na rynku":e>=50?"Przeci\u0119tna reputacja - masz neutralny wizerunek":e>=25?"S\u0142aba reputacja - budzisz pewne kontrowersje":"Bardzo s\u0142aba reputacja - jeste\u015b powszechnie krytykowany")(r.reputation)})]}),(0,a.jsx)("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(r.reputationFactors||{}).map((e=>{let[t,n]=e;return(0,a.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:b(t)}),(0,a.jsxs)("span",{className:j(n),children:[(100*n).toFixed(0),"%"]})]}),(0,a.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:k(t,n),style:{width:`${Math.min(100,50*n)}%`}})})]},t)}))}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Aktywne Inicjatywy"}),(null===(t=r.activeReputationInitiatives)||void 0===t?void 0:t.length)>0?(0,a.jsx)("div",{className:"grid gap-3",children:r.activeReputationInitiatives.map(((e,t)=>(0,a.jsx)("div",{className:"border rounded-lg p-3",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center overflow-hidden",children:[N(e),(0,a.jsxs)("div",{className:"ml-2 overflow-hidden",children:[(0,a.jsx)("div",{className:"font-medium text-ellipsis overflow-hidden",children:e.name}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 whitespace-nowrap",children:["Pozosta\u0142o: ",e.remainingDuration," dni"]})]})]}),(0,a.jsx)("div",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full whitespace-nowrap",children:g(e.intensity)})]})},t)))}):(0,a.jsxs)("div",{className:"text-center py-4 text-gray-500",children:[(0,a.jsx)(jy,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),(0,a.jsx)("p",{children:"Brak aktywnych inicjatyw"})]})]}),(0,a.jsx)("h3",{className:"font-medium mb-3",children:"Dost\u0119pne Inicjatywy"}),Object.entries(m).map((e=>{let[t,n]=e;return((e,t)=>(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:y(e)}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((e=>(0,a.jsx)("div",{className:"border rounded-lg p-4 hover:border-blue-300 cursor-pointer",onClick:()=>d(e),children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"mr-3",children:e.icon}),(0,a.jsxs)("div",{className:"flex-grow overflow-hidden",children:[(0,a.jsx)("h4",{className:"font-medium text-ellipsis overflow-hidden",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 break-words",children:[e.description.substring(0,80),"..."]}),(0,a.jsxs)("div",{className:"mt-2 text-sm text-blue-600 whitespace-nowrap",children:["Koszt: ",e.cost.toLocaleString()," z\u0142"]})]})]})},e.name)))})]}))(t,n)})),c&&(c?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[c.icon,(0,a.jsx)("h2",{className:"text-xl font-semibold ml-3 break-words",children:c.name})]}),(0,a.jsx)("button",{className:"text-gray-400 hover:text-gray-600",onClick:()=>d(null),children:(0,a.jsx)(wy,{className:"w-6 h-6"})})]}),(0,a.jsx)("p",{className:"text-gray-700 mb-4 break-words",children:c.description}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Szczeg\xf3\u0142y:"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600 mr-2 whitespace-nowrap",children:"Koszt:"}),(0,a.jsxs)("span",{className:"font-medium whitespace-nowrap",children:[c.cost.toLocaleString()," z\u0142"]})]}),(0,a.jsxs)("div",{className:"flex items-center overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600 mr-2 whitespace-nowrap",children:"Czas trwania:"}),(0,a.jsxs)("span",{className:"font-medium whitespace-nowrap",children:[c.duration," dni"]})]}),(0,a.jsxs)("div",{className:"flex items-center overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600 mr-2 whitespace-nowrap",children:"Intensywno\u015b\u0107:"}),(0,a.jsx)("span",{className:"font-medium whitespace-nowrap",children:g(c.intensity)})]})]})]}),(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Efekty:"}),(0,a.jsx)("div",{className:"mb-4",children:f(c)}),(0,a.jsxs)("div",{className:"flex justify-end mt-6",children:[(0,a.jsx)("button",{className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md mr-3",onClick:()=>d(null),children:"Anuluj"}),(0,a.jsxs)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md "+(r.cash<c.cost?"opacity-50 cursor-not-allowed":""),onClick:()=>(e=>{if(r.cash<e.cost)l(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w (potrzeba ${e.cost.toLocaleString()} PLN)`,"error");else{if(s({type:"START_REPUTATION_INITIATIVE",payload:{initiative:e}}),e.immediateEffects)for(const t of e.immediateEffects)t.reputationChange&&s({type:"UPDATE_REPUTATION",payload:{change:t.reputationChange,reason:`Inicjatywa: ${e.name} (natychmiastowy efekt)`,turn:o.turn}}),t.factorChange&&t.factorAmount&&s({type:"UPDATE_REPUTATION_FACTOR",payload:{factor:t.factorChange,change:t.factorAmount,reason:`Inicjatywa: ${e.name} (natychmiastowy efekt)`,turn:o.turn}});l(`Rozpocz\u0119to inicjatyw\u0119: ${e.name}`,"success"),d(null)}})(c),disabled:r.cash<c.cost,children:["Rozpocznij (",c.cost.toLocaleString()," z\u0142)"]})]})]})}):null)]});var z},zy=()=>{const{state:e}=u(),[t,n]=(0,i.useState)(!1),[r,s]=(0,i.useState)(!1),o=e.activeReputationInitiatives&&e.activeReputationInitiatives.length>0,l=e.reputation<50||e.reputationFactors&&Object.values(e.reputationFactors).some((e=>e<.7));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center px-3 py-1.5 rounded-md cursor-pointer "+(c=e.reputation,c>=150?"bg-green-100":c>=100?"bg-blue-100":c>=50?"bg-yellow-100":c>=25?"bg-orange-100":"bg-red-100"),onClick:()=>n(!0),children:[(0,a.jsx)("div",{className:"mr-2",children:(e=>e>=100?(0,a.jsx)(ty,{className:"w-4 h-4"}):e>=50?(0,a.jsx)(ny,{className:"w-4 h-4"}):(0,a.jsx)(Kf,{className:"w-4 h-4"}))(e.reputation)}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:`font-medium ${(e=>e>=150?"text-green-600":e>=100?"text-blue-600":e>=50?"text-yellow-600":e>=25?"text-orange-600":"text-red-600")(e.reputation)}`,children:e.reputation}),(()=>{if(!e.reputationHistory||e.reputationHistory.length<5)return null;const t=e.reputationHistory.filter((e=>void 0!==e.change)).slice(-5).map((e=>e.change));if(0===t.length)return null;const n=t.reduce(((e,t)=>e+t),0);return n>5?(0,a.jsx)(iy,{className:"w-4 h-4 text-green-500"}):n<-5?(0,a.jsx)(ry,{className:"w-4 h-4 text-red-500"}):null})()]}),(0,a.jsx)("div",{className:"text-xs text-gray-600",children:(e=>e>=150?"Doskona\u0142a":e>=100?"Dobra":e>=50?"Przeci\u0119tna":e>=25?"S\u0142aba":"Bardzo s\u0142aba")(e.reputation)})]}),o&&(0,a.jsx)("div",{className:"ml-2 bg-blue-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center cursor-pointer",onClick:e=>{e.stopPropagation(),s(!0)},title:"Aktywne inicjatywy reputacyjne",children:e.activeReputationInitiatives.length}),l&&(0,a.jsx)("div",{className:"ml-2 text-red-500",title:"Problemy z reputacj\u0105",children:(0,a.jsx)(Kf,{className:"w-4 h-4"})})]}),t&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsx)(yy,{onClose:()=>n(!1)})})}),r&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsx)(Ny,{onClose:()=>s(!1)})})})]});var c},_y=(0,i.memo)((e=>{let{icon:t,screenName:n,label:i,currentScreen:r,onClick:s}=e;const o=r===n;return(0,a.jsxs)("button",{onClick:s,className:"nav-button flex items-center px-3 py-1 rounded text-white "+(o?"active":""),children:[(0,a.jsx)("span",{className:"mr-1",children:t})," ",i]})})),Sy=(0,i.memo)((e=>{let{currentDay:t,gameSpeed:n}=e;return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center mr-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(Uf,{size:18,className:"mr-1"}),(0,a.jsxs)("span",{className:"font-medium",children:["Dzie\u0144 ",t]})]}),n>1&&(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsx)(Vf,{size:16,className:"mr-1"}),(0,a.jsxs)("span",{className:`\n            ${3===n?"text-yellow-300":""}\n            ${5===n?"text-orange-300":""}\n            ${10===n?"text-red-300":""}\n            font-semibold\n          `,children:["Pr\u0119dko\u015b\u0107 x",n]})]})]})})),Ey=(0,i.memo)((e=>{let{cash:t,installedCapacity:n,reputation:i}=e;return(0,a.jsxs)("div",{className:"stats-container flex space-x-6",children:[(0,a.jsxs)("div",{className:"stat flex items-center",children:[(0,a.jsx)(Bf,{size:18,className:"mr-1 text-green-400"}),(0,a.jsxs)("span",{children:[(s=t,void 0===s||null===s||isNaN(s)?"0.00":s>=1e9?`${(s/1e9).toFixed(2)} mld`:s>=1e6?`${(s/1e6).toFixed(2)} mln`:s>=1e3?`${(s/1e3).toFixed(2)} tys.`:`${s.toFixed(2)}`)," PLN"]})]}),(0,a.jsxs)("div",{className:"stat flex items-center",children:[(0,a.jsx)($f,{size:18,className:"mr-1 text-yellow-400"}),(0,a.jsxs)("span",{children:[(r=n,void 0===r||null===r||isNaN(r)?"0.00":(r/1e3).toFixed(2))," GW"]})]}),(0,a.jsx)("div",{className:"stat flex items-center",children:(0,a.jsx)(zy,{value:i,showValue:!0})})]});var r,s})),Cy=e=>{let{children:t}=e;const{state:n,dispatch:r,nextDay:s}=ff(),{state:o,dispatch:l}=u(),{state:c}=H(),d=(0,i.useCallback)((e=>(e.preventDefault(),e.returnValue="Czy na pewno chcesz opu\u015bci\u0107 gr\u0119? Niezapisane zmiany mog\u0105 zosta\u0107 utracone.",e.returnValue)),[]),h=(0,i.useCallback)((e=>{e.preventDefault(),history.pushState(null,document.title,window.location.href),n.selectedProject?r({type:"SELECT_PROJECT",payload:null}):n.selectedRegion?r({type:"SELECT_REGION",payload:null}):n.selectedCounty&&r({type:"SELECT_COUNTY",payload:null})}),[n.selectedProject,n.selectedRegion,n.selectedCounty,r]);(0,i.useEffect)((()=>(window.addEventListener("popstate",h),window.addEventListener("beforeunload",d),history.pushState(null,document.title,window.location.href),()=>{window.removeEventListener("popstate",h),window.removeEventListener("beforeunload",d)})),[h,d]);const p=(0,i.useCallback)((()=>{var e;const t=null===c||void 0===c||null===(e=c.events)||void 0===e?void 0:e.filter((e=>e&&!0===e.requiresDecision&&!0!==e.decided));t&&t.length>0?r({type:"SET_NOTIFICATION",payload:{text:"Musisz rozwi\u0105za\u0107 wszystkie oczekuj\u0105ce decyzje przed przej\u015bciem do nast\u0119pnego dnia!",type:"warning"}}):(s(o,l),window.dispatchEvent(new CustomEvent("next-game-day")),n.selectedProject&&r({type:"SELECT_PROJECT",payload:null}),n.selectedRegion&&r({type:"SELECT_REGION",payload:null}),n.selectedCounty&&r({type:"SELECT_COUNTY",payload:null}))}),[n,r,s,o,l,c]),m=(0,i.useCallback)((e=>{r({type:"SET_GAME_SPEED",payload:e});r({type:"SET_NOTIFICATION",payload:{text:`Ustawiono ${{1:"normaln\u0105",3:"przyspieszon\u0105 (x3)",5:"szybk\u0105 (x5)",10:"bardzo szybk\u0105 (x10)"}[e]} pr\u0119dko\u015b\u0107 up\u0142ywu czasu.`,type:"info"}})}),[r]),f=(0,i.useCallback)((()=>{r({type:"SET_APP_VIEW",payload:"leaderboard"})}),[r]),y=(0,i.useCallback)((()=>{"function"===typeof window.saveGameFunction&&(window.saveGameFunction(),r({type:"SET_NOTIFICATION",payload:{text:"Gra zosta\u0142a zapisana!",type:"success"}}))}),[r]),g=(0,i.useCallback)((e=>{r({type:"SET_SCREEN",payload:e}),n.selectedProject&&r({type:"SELECT_PROJECT",payload:null}),n.selectedRegion&&r({type:"SELECT_REGION",payload:null}),n.selectedCounty&&r({type:"SELECT_COUNTY",payload:null})}),[r,n.selectedProject,n.selectedRegion,n.selectedCounty]),v=(0,i.useCallback)((()=>{"function"===typeof window.saveGameFunction&&window.saveGameFunction(),tf.signOut().then((()=>{console.log("U\u017cytkownik wylogowany")})).catch((e=>{console.error("B\u0142\u0105d wylogowania:",e)}))}),[]),w=(0,i.useCallback)((()=>{const e=[{screen:"home",icon:(0,a.jsx)(Wf,{size:18}),label:"G\u0142\xf3wna"},{screen:"regions",icon:(0,a.jsx)(qf,{size:18}),label:"Mapa"},{screen:"company",icon:(0,a.jsx)(Hf,{size:18}),label:"Firma"},{screen:"events",icon:(0,a.jsx)(Kf,{size:18}),label:"Wydarzenia"},{screen:"competitors",icon:(0,a.jsx)(Gf,{size:18}),label:"Konkurencja"},{screen:"market",icon:(0,a.jsx)(Qf,{size:18}),label:"Rynek"}];return(0,a.jsx)("div",{className:"flex space-x-2",children:e.map((e=>(0,a.jsx)(_y,{icon:e.icon,screenName:e.screen,label:e.label,currentScreen:n.currentScreen,onClick:()=>g(e.screen)},e.screen)))})}),[n.currentScreen,g]);return(0,a.jsxs)("div",{className:"game-container min-h-screen flex flex-col",children:[(0,a.jsxs)("div",{className:"top-bar bg-gray-800 text-white py-2 px-4 flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"left-section flex items-center",children:[(0,a.jsx)(Sy,{currentDay:n.day,gameSpeed:n.gameSpeed}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("button",{onClick:p,className:"next-day-btn flex items-center bg-blue-700 hover:bg-blue-800 px-3 py-1 rounded mr-2",children:[(0,a.jsx)(Zf,{size:18})," ",(0,a.jsx)("span",{className:"ml-1",children:"Nowy dzie\u0144"})]}),(0,a.jsxs)("div",{className:"game-speed-controls flex space-x-1",children:[(0,a.jsx)("button",{onClick:()=>m(1),className:"px-2 py-1 rounded text-xs font-bold "+(1===n.gameSpeed?"bg-green-600":"bg-gray-600 hover:bg-gray-500"),title:"Normalna pr\u0119dko\u015b\u0107",children:"x1"}),(0,a.jsx)("button",{onClick:()=>m(3),className:"px-2 py-1 rounded text-xs font-bold "+(3===n.gameSpeed?"bg-yellow-600":"bg-gray-600 hover:bg-gray-500"),title:"Przyspieszona pr\u0119dko\u015b\u0107",children:"x3"}),(0,a.jsx)("button",{onClick:()=>m(5),className:"px-2 py-1 rounded text-xs font-bold "+(5===n.gameSpeed?"bg-orange-600":"bg-gray-600 hover:bg-gray-500"),title:"Szybka pr\u0119dko\u015b\u0107",children:"x5"}),(0,a.jsx)("button",{onClick:()=>m(10),className:"px-2 py-1 rounded text-xs font-bold "+(10===n.gameSpeed?"bg-red-600":"bg-gray-600 hover:bg-gray-500"),title:"Bardzo szybka pr\u0119dko\u015b\u0107",children:"x10"})]})]})]}),(0,a.jsx)(Ey,{cash:o.cash,installedCapacity:o.installedCapacity,reputation:o.reputation}),(0,a.jsxs)("div",{className:"right-section flex items-center space-x-2",children:[(0,a.jsxs)("button",{onClick:y,className:"save-btn flex items-center bg-green-700 hover:bg-green-800 px-3 py-1 rounded",children:[(0,a.jsx)(Yf,{size:18})," ",(0,a.jsx)("span",{className:"ml-1",children:"Zapisz"})]}),(0,a.jsxs)("button",{onClick:f,className:"leaderboard-btn flex items-center bg-yellow-700 hover:bg-yellow-800 px-3 py-1 rounded",children:[(0,a.jsx)(Jf,{size:18})," ",(0,a.jsx)("span",{className:"ml-1",children:"Wyniki"})]}),(0,a.jsxs)("button",{onClick:v,className:"logout-btn flex items-center bg-red-700 hover:bg-red-800 px-3 py-1 rounded",children:[(0,a.jsx)(Xf,{size:18})," ",(0,a.jsx)("span",{className:"ml-1",children:"Wyloguj"})]})]})]}),(0,a.jsx)("div",{className:"nav-bar bg-gray-700 py-2 px-4",children:w()}),(0,a.jsx)("div",{className:"main-content flex-grow p-4 relative",children:t}),(0,a.jsx)(ey,{})]})},Ty=Ff("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Py=Ff("Wind",[["path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2",key:"1k4u03"}],["path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2",key:"b7d0fd"}],["path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2",key:"1p5cb3"}]]),Iy=Ff("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Ay=e=>{var t,n;let{onSaveGame:i,onShowLeaderboard:r}=e;const{state:s,dispatch:o}=ff(),{state:l}=u(),{state:c}=xf(),d=e=>{o({type:"SET_SCREEN",payload:e})},h=(()=>{const e=[];return c.forEach((t=>{t.landAcquisitionProcesses&&t.landAcquisitionProcesses.length>0&&t.landAcquisitionProcesses.forEach((n=>{if("in_progress"===n.status){const i=l.staff.scouts.find((e=>e.id===n.scoutId))||{name:"Nieznany skaut"};e.push({...n,regionName:t.name,regionId:t.id,scout:i})}}))})),e})();return(0,a.jsxs)("div",{className:"home-view-container",children:[(0,a.jsxs)("div",{className:"welcome-banner",children:[(0,a.jsx)("h1",{children:"Symulator Rozwoju OZE"}),(0,a.jsxs)("div",{className:"game-date",children:[(0,a.jsxs)("div",{className:"date-item",children:[(0,a.jsx)(Uf,{className:"date-icon"}),(0,a.jsx)("span",{children:new Date(2023,0,s.day).toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"})})]}),(0,a.jsxs)("div",{className:"date-item",children:[(0,a.jsx)(Vf,{className:"date-icon"}),(0,a.jsxs)("span",{children:["Tura ",s.turn]})]})]})]}),(0,a.jsxs)("div",{className:"company-summary",children:[(0,a.jsxs)("h2",{children:["Twoja Firma: ",l.companyName||"OZE Developer"]}),(0,a.jsxs)("div",{className:"stats-grid",children:[(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Stan konta"}),(0,a.jsxs)("p",{className:"stat-value",children:[(null===(t=l.cash)||void 0===t?void 0:t.toLocaleString())||0," PLN"]})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Liczba projekt\xf3w"}),(0,a.jsx)("p",{className:"stat-value",children:(null===(n=l.projects)||void 0===n?void 0:n.length)||0})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Pracownicy"}),(0,a.jsx)("p",{className:"stat-value",children:l&&l.staff?Object.values(l.staff).filter(Boolean).flat().length:0})]}),(0,a.jsxs)("div",{className:"stat-card",children:[(0,a.jsx)("h3",{children:"Reputacja"}),(0,a.jsxs)("p",{className:"stat-value",children:[l.reputation||50,"/100"]})]})]})]}),(0,a.jsxs)("div",{className:"quick-actions-section",children:[(0,a.jsx)("h2",{children:"Szybkie Akcje"}),(0,a.jsxs)("div",{className:"quick-actions-grid",children:[(0,a.jsxs)("button",{className:"action-card",onClick:()=>d("company"),children:[(0,a.jsx)(Hf,{className:"action-icon"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{children:"Zarz\u0105dzanie Sp\xf3\u0142k\u0105"}),(0,a.jsx)("p",{children:"Przegl\u0105daj finanse, projekty i pracownik\xf3w"})]}),(0,a.jsx)(Ty,{className:"arrow-icon"})]}),(0,a.jsxs)("button",{className:"action-card",onClick:()=>d("company"),children:[(0,a.jsx)(Gf,{className:"action-icon"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{children:"Zatrudnij pracownik\xf3w"}),(0,a.jsx)("p",{children:"Skauci, developerzy i inni specjali\u015bci"})]}),(0,a.jsx)(Ty,{className:"arrow-icon"})]}),(0,a.jsxs)("button",{className:"action-card",onClick:()=>d("regions"),children:[(0,a.jsx)(qf,{className:"action-icon"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{children:"Wyb\xf3r Region\xf3w"}),(0,a.jsx)("p",{children:"Wybierz wojew\xf3dztwo do dzia\u0142a\u0144"})]}),(0,a.jsx)(Ty,{className:"arrow-icon"})]}),(0,a.jsxs)("button",{className:"action-card",onClick:()=>d("market"),children:[(0,a.jsx)($f,{className:"action-icon"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{children:"Gie\u0142da Projekt\xf3w"}),(0,a.jsx)("p",{children:"Kupuj i sprzedawaj projekty OZE"})]}),(0,a.jsx)(Ty,{className:"arrow-icon"})]})]})]}),(0,a.jsxs)("div",{className:"guides-section",children:[(0,a.jsx)("h2",{children:"Przewodnik"}),(0,a.jsxs)("div",{className:"guides-grid",children:[(0,a.jsxs)("div",{className:"guide-card",children:[(0,a.jsx)(jy,{className:"guide-icon"}),(0,a.jsx)("h3",{children:"Jak zacz\u0105\u0107?"}),(0,a.jsx)("p",{children:"Aby rozpocz\u0105\u0107 rozw\xf3j projekt\xf3w OZE, najpierw zatrudnij skaut\xf3w, kt\xf3rzy b\u0119d\u0105 szuka\u0107 odpowiednich lokalizacji pod projekty."}),(0,a.jsx)("button",{className:"guide-action-btn",onClick:()=>d("company"),children:"Zatrudnij skauta"})]}),(0,a.jsxs)("div",{className:"guide-card",children:[(0,a.jsx)(Py,{className:"guide-icon"}),(0,a.jsx)("h3",{children:"Rozw\xf3j Projektu"}),(0,a.jsx)("p",{children:"Projekty OZE przechodz\u0105 przez kilka etap\xf3w rozwoju, od pozyskania dzia\u0142ki do gotowej inwestycji. Ka\u017cdy etap wymaga odpowiednich specjalist\xf3w."}),(0,a.jsx)("button",{className:"guide-action-btn",onClick:()=>d("regions"),children:"Wybierz region"})]})]})]}),(0,a.jsx)("div",{className:"next-turn-section",children:(0,a.jsx)("button",{className:"next-turn-btn",onClick:()=>o({type:"NEXT_DAY"}),children:"Nast\u0119pny dzie\u0144"})}),(0,a.jsx)("div",{className:"dashboard-container",children:(0,a.jsxs)("div",{className:"dashboard-panel land-acquisition-panel",children:[(0,a.jsxs)("h3",{className:"panel-header",children:[(0,a.jsx)(Iy,{className:"panel-icon"}),"Aktualne poszukiwania w regionie"]}),0===h.length?(0,a.jsx)("div",{className:"no-processes",children:(0,a.jsx)("p",{children:"Brak aktywnych proces\xf3w pozyskiwania grunt\xf3w"})}):(0,a.jsx)("div",{className:"active-processes",children:h.map((e=>(0,a.jsxs)("div",{className:"process-card",children:[(0,a.jsxs)("div",{className:"process-header",children:[(0,a.jsxs)("div",{className:"process-title",children:["Poszukiwanie dzia\u0142ki ",e.size,"ha"]}),(0,a.jsx)("div",{className:"process-region",children:e.regionName})]}),(0,a.jsxs)("div",{className:"process-details",children:[(0,a.jsxs)("div",{className:"scout-info",children:[(0,a.jsx)("span",{className:"label",children:"Skaut:"}),(0,a.jsx)("span",{className:"value",children:e.scout.name})]}),(0,a.jsxs)("div",{className:"date-info",children:[(0,a.jsxs)("div",{className:"date-item",children:[(0,a.jsx)("span",{className:"label",children:"Rozpocz\u0119cie:"}),(0,a.jsx)("span",{className:"value",children:new Date(e.startDate).toLocaleDateString("pl-PL")})]}),(0,a.jsxs)("div",{className:"date-item",children:[(0,a.jsx)("span",{className:"label",children:"Zako\u0144czenie:"}),(0,a.jsx)("span",{className:"value",children:new Date(e.completionDate).toLocaleDateString("pl-PL")})]})]})]}),(0,a.jsxs)("div",{className:"progress-container",children:[(0,a.jsxs)("div",{className:"progress-label",children:[(0,a.jsx)("span",{children:"Post\u0119p poszukiwania:"}),(0,a.jsxs)("span",{children:[Math.floor(e.progress),"%"]})]}),(0,a.jsx)("div",{className:"progress-bar",children:(0,a.jsx)("div",{className:"progress-fill",style:{width:`${e.progress}%`}})})]})]},e.id)))})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,a.jsxs)("button",{onClick:i,className:"flex items-center justify-center gap-2 p-3 text-white transition-colors rounded-lg bg-emerald-700 hover:bg-emerald-800",children:[(0,a.jsx)(Yf,{size:20}),(0,a.jsx)("span",{children:"Zapisz gr\u0119"})]}),(0,a.jsxs)("button",{onClick:r,className:"flex items-center justify-center gap-2 p-3 text-white transition-colors bg-amber-600 rounded-lg hover:bg-amber-700",children:[(0,a.jsx)(Jf,{size:20}),(0,a.jsx)("span",{children:"Tablica wynik\xf3w"})]})]})]})},My=e=>{switch(e){case"land_acquisition":return"Pozyskiwanie grunt\xf3w (Greenfield)";case"environmental_decision":return"Decyzja \u015brodowiskowa (EIA/D\u015aU)";case"zoning_conditions":return"Warunki zabudowy (MPZP/WZ)";case"grid_connection":return"Warunki przy\u0142\u0105czenia (WP)";case"ready_to_build":return"Gotowy do budowy (RTB)";case"construction":return"Budowa (COD-1)";case"operating":return"Operacyjny (COD)";default:return e}},Dy=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return"";e.endsWith("s");const n=e.endsWith("s")?e.slice(0,-1):e;if("lessor"===n||"scout"===n)return t?"Skauta":"Skaut";return{developer:t?"Developera":"Developer",lawyer:t?"Prawnika":"Prawnik",envSpecialist:t?"Specjalist\u0119 ds. \u015brodowiska":"Specjalista ds. \u015brodowiska",lobbyist:t?"Lobbyst\u0119":"Lobbysta"}[n]||n},Ry=e=>{switch(e){case"junior":return"pocz\u0105tkuj\u0105cego";case"mid":return"do\u015bwiadczonego";case"senior":return"eksperta";default:return e}},Oy=e=>{switch(e){case"aggressive":return"Agresywna";case"balanced":return"Zr\xf3wnowa\u017cona";case"conservative":return"Konserwatywna";default:return e}},Ly=(e,t)=>e.rtbPower>1.5*t?`Silny lider, posiada ${e.rtbPower.toLocaleString()} MW mocy RTB. Unikaj bezpo\u015bredniej konkurencji.`:e.rtbPower>t?`Nieznacznie wyprzedza Ci\u0119 z moc\u0105 ${e.rtbPower.toLocaleString()} MW. Mo\u017cliwe do nadrobienia.`:e.rtbPower>.7*t?`Blisko za Tob\u0105 z moc\u0105 ${e.rtbPower.toLocaleString()} MW. Pilnuj przewagi.`:`S\u0142abszy konkurent z moc\u0105 ${e.rtbPower.toLocaleString()} MW. Koncentruje si\u0119 na regionach ${e.strongRegions.slice(0,2).join(", ")}.`,Fy=()=>{const{state:e,dispatch:t}=u(),{state:n,showNotification:r}=ff(),{dispatch:a}=H(),[s,o]=(0,i.useState)([]),l={junior:{minSkill:1,maxSkill:3,salaryMultiplier:1},mid:{minSkill:4,maxSkill:7,salaryMultiplier:1.5},senior:{minSkill:8,maxSkill:10,salaryMultiplier:2.2}},c={scout:2500,developer:3e3,lawyer:0,envSpecialist:0,lobbyist:5e3},d={lawyer:3e4,envSpecialist:25e3},h=(0,i.useCallback)((()=>{n.turn>1&&f()}),[n.turn]);(0,i.useEffect)((()=>{h()}),[h]);const p=(e,t)=>{switch(e){case"scout":case"scouts":return"land_acquisition"===t;case"developer":case"developers":case"lobbyist":case"lobbyists":return!0;default:return!1}},m=(n,i)=>{const a=n.endsWith("s")?n:`${n}s`,s=e.staff[a];if(!s)return!1;const o=s.find((e=>e.id===i));if(!o||!o.assignedProject)return!1;const l=o.assignedProject,c=e.projects.find((e=>e.id===l));t({type:"UPDATE_STAFF",payload:{staffType:a,staffId:i,changes:{assignedProject:null,assignedSince:null}}});const d=n.endsWith("s")?n.slice(0,-1):n;return c&&(t({type:"UPDATE_PROJECT",payload:{id:l,changes:{assignedStaff:{...c.assignedStaff||{},[d]:null}}}}),r(`Od\u0142\u0105czono ${Dy(n)} ${o.name} od projektu ${c.name}`,"info")),!0},f=()=>{const t=[];Object.keys(e.staff).forEach((n=>{const i=e.staff[n];i&&0!==i.length&&i.forEach((e=>{if(Math.random()<.05){const n=y(e);n&&(t.push(n),g(e.type,e.id,n))}v(e.type,e.id)}))})),t.length>0&&o((e=>[...e,...t]))},y=e=>{let t=[.15,.1,.05,.1,.1,.2,.3];e.morale<50&&(t[2]*=3,t[4]*=2),e.energy<50&&(t[1]*=2,t[6]*=1.5),e.skill>7&&(t[5]*=2,t[3]*=1.5);const i=t.reduce(((e,t)=>e+t),0);t=t.map((e=>e/i));const r=Math.random();let a=0,s=-1;for(let n=0;n<t.length;n++)if(a+=t[n],r<=a){s=n;break}if(-1===s)return null;const o=["vacation","illness","burnout","promotion","conflict","innovation","mistake"][s];let l={id:Date.now(),staffId:e.id,staffName:e.name,staffType:e.type,type:o,turn:n.turn,title:"",description:"",effects:[]};switch(o){case"vacation":l.title=`${e.name} bierze urlop`,l.description=`Pracownik bierze ${Math.floor(1+3*Math.random())} dni urlopu.`,l.effects.push({type:"energy",value:30}),l.effects.push({type:"morale",value:20}),l.effects.push({type:"productivity",value:-1});break;case"illness":l.title=`${e.name} zachorowa\u0142`,l.description=`Pracownik jest chory i nie mo\u017ce pracowa\u0107 przez ${Math.floor(1+5*Math.random())} dni.`,l.effects.push({type:"energy",value:-20}),l.effects.push({type:"productivity",value:-1});break;case"burnout":l.title=`${e.name} cierpi na wypalenie zawodowe`,l.description="Pracownik jest przem\u0119czony i jego wydajno\u015b\u0107 spada o 50%.",l.effects.push({type:"energy",value:-40}),l.effects.push({type:"morale",value:-30}),l.effects.push({type:"productivity",value:-.5});break;case"promotion":l.title=`${e.name} zas\u0142uguje na awans`,l.description="Pracownik wykazuje si\u0119 du\u017cym zaanga\u017cowaniem i zas\u0142uguje na awans.",l.effects.push({type:"morale",value:40}),l.effects.push({type:"skill",value:1}),l.effects.push({type:"salary",value:.1});break;case"conflict":l.title=`${e.name} ma konflikt w zespole`,l.description="Pracownik ma konflikt z innymi cz\u0142onkami zespo\u0142u, co wp\u0142ywa na jego morale.",l.effects.push({type:"morale",value:-25}),l.effects.push({type:"productivity",value:-.2});break;case"innovation":l.title=`${e.name} ma innowacyjny pomys\u0142`,l.description="Pracownik wpad\u0142 na innowacyjny pomys\u0142, kt\xf3ry mo\u017ce przyspieszy\u0107 rozw\xf3j projekt\xf3w.",l.effects.push({type:"morale",value:15}),l.effects.push({type:"productivity",value:.2}),l.effects.push({type:"experience",value:10});break;case"mistake":l.title=`${e.name} pope\u0142ni\u0142 b\u0142\u0105d`,l.description="Pracownik pope\u0142ni\u0142 b\u0142\u0105d, kt\xf3ry mo\u017ce op\xf3\u017ani\u0107 rozw\xf3j projektu.",l.effects.push({type:"morale",value:-10}),l.effects.push({type:"productivity",value:-.15});break;default:return null}return l},g=(e,n,i)=>{const a={id:n};i.effects.forEach((e=>{switch(e.type){case"energy":a.energy=e.value;break;case"morale":a.morale=e.value;break;case"productivity":a.productivityModifier=e.value;break;case"skill":a.skillIncrease=e.value;break;case"experience":a.experienceIncrease=e.value;break;case"salary":a.salaryModifier=e.value}})),t({type:"UPDATE_STAFF",payload:{staffType:e,staffUpdate:a}}),r(i.title,"info")},v=function(n,i){var r;let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10;const l=n.endsWith("s")?n:`${n}s`,c=e.staff[l];if(!c)return;const d=c.findIndex((e=>e.id===i));if(-1===d)return;const u=c[d];let h=o;if(h*=[1,1.1,1.2,1.35][(null===(r=e.companyUpgrades)||void 0===r?void 0:r.training_program)||0],"developer"===n||"developers"===n)if(a&&a.technology){const e=u.technologyExperience||{},r=e[a.technology]||0,s=Math.floor(1.5*h);e[a.technology]=r+s;const o={data:(new Date).toISOString(),typ:"do\u015bwiadczenie",opis:`Zdoby\u0142 ${s} p.d. w technologii ${a.technology}`};t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:i,changes:{experience:u.experience+h,technologyExperience:e,historia:[...u.historia||[],o]}}})}else t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:i,changes:{experience:u.experience+h,historia:[...u.historia||[],{data:(new Date).toISOString(),typ:"do\u015bwiadczenie",opis:`Zdoby\u0142 ${h} p.d.`}]}}});else if("lessor"===n||"lessors"===n)if("land_acquisition"===s&&a){const e=(u.acquiredLands||0)+1,r=(u.acquiredArea||0)+(a.area||0),s=Math.floor(2*h),o={data:(new Date).toISOString(),typ:"pozyskanie_gruntu",opis:`Pozyska\u0142 grunt o powierzchni ${a.area} ha w lokalizacji ${a.location||"nieznana"}`};t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:i,changes:{experience:u.experience+s,acquiredLands:e,acquiredArea:r,historia:[...u.historia||[],o]}}})}else t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:i,changes:{experience:u.experience+h,historia:[...u.historia||[],{data:(new Date).toISOString(),typ:"do\u015bwiadczenie",opis:`Zdoby\u0142 ${h} p.d.`}]}}});else t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:i,changes:{experience:u.experience+h,historia:[...u.historia||[],{data:(new Date).toISOString(),typ:"do\u015bwiadczenie",opis:`Zdoby\u0142 ${h} p.d.`}]}}});k(n,i)},w=(e,t)=>{const n="junior"===e.level?1:"mid"===e.level?1.5:2,i="skill"===t?1:1.5;return Math.floor(5e3*n*i)},x=()=>{const e=["Adam","Anna","Piotr","Katarzyna","Micha\u0142","Magdalena","Jan","Aleksandra","Tomasz","Ma\u0142gorzata","Marek","Barbara","Andrzej","Ewa","Krzysztof","Zofia","Pawe\u0142","Monika","Rafa\u0142","Joanna"],t=["Nowak","Kowalski","Wi\u015bniewski","W\xf3jcik","Kowalczyk","Kami\u0144ski","Lewandowski","Zieli\u0144ski","Wo\u017aniak","Szyma\u0144ski","D\u0105browski","Koz\u0142owski","Jankowski","Mazur","Kwiatkowski","Krawczyk","Piotrowski","Grabowski","Nowakowski","Paw\u0142owski"];return`${e[Math.floor(Math.random()*e.length)]} ${t[Math.floor(Math.random()*t.length)]}`},b=e=>{const t={scout:["PV","WF","BESS","Negocjacje","Analiza grunt\xf3w"],developer:["PV","WF","BESS","Zarz\u0105dzanie projektami","Analiza techniczna"],lawyer:["Prawo energetyczne","Prawo \u015brodowiskowe","Prawo budowlane","Negocjacje"],envSpecialist:["Oceny oddzia\u0142ywania","Ochrona gatunkowa","Rekultywacja","Monitoring"],lobbyist:["W\u0142adze lokalne","Media","NGO","Spo\u0142eczno\u015bci lokalne"]}[e]||["Og\xf3lna"];return t[Math.floor(Math.random()*t.length)]},j=()=>{const e=["Pracowity","Leniwy","Kreatywny","Analityczny","Komunikatywny","Introwertyczny","Dok\u0142adny","Chaotyczny","Ambitny","Ostro\u017cny","Optymista","Pesymista","Zespo\u0142owy","Indywidualista","Elastyczny","Sztywny","Odporny na stres","Wra\u017cliwy","Punktualny","Sp\xf3\u017anialski"],t=1+Math.floor(3*Math.random()),n=[];for(let i=0;i<t;i++){const t=e.filter((e=>!n.includes(e)));if(0===t.length)break;const i=t[Math.floor(Math.random()*t.length)];n.push(i)}return n},k=(n,i)=>{const a=n.endsWith("s")?n:`${n}s`,s=e.staff[a];if(!s)return;const o=s.findIndex((e=>e.id===i));if(-1===o)return;const l=s[o],c={junior:{min:0,max:3e3,next:"mid"},mid:{min:3001,max:8e3,next:"senior"},senior:{min:8001,max:1/0,next:null}},d=l.level;if(l.experience>c[d].max&&c[d].next){const e=c[d].next;if(t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:i,changes:{level:e,historia:[...l.historia||[],{data:(new Date).toISOString(),typ:"awans",opis:`Awansowa\u0142 na pozycj\u0119 ${Ry(e)}`}]}}}),"mid"===e){const a=Math.max(1,Math.floor(3*Math.random())+1);t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:i,changes:{skill:Math.min(10,l.skill+a)}}}),r(`${l.name} zdoby\u0142 awans na poziom ${Ry(e)}! Umiej\u0119tno\u015bci +${a}`,"success")}else if("senior"===e){const a=Math.max(2,Math.floor(3*Math.random())+2);t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:i,changes:{skill:Math.min(10,l.skill+a)}}}),r(`${l.name} zdoby\u0142 awans na poziom ${Ry(e)}! Umiej\u0119tno\u015bci +${a}`,"success")}}const u=[1e3,2e3,4e3,6e3,8e3,1e4,12e3,14e3,16e3].filter((e=>l.experience>=e));if(u.length>l.skill-1&&l.skill<10){const e=Math.min(10,u.length+1);e>l.skill&&(t({type:"UPDATE_STAFF",payload:{staffType:n,staffId:i,changes:{skill:e,historia:[...l.historia||[],{data:(new Date).toISOString(),typ:"rozw\xf3j",opis:`Zwi\u0119kszy\u0142 umiej\u0119tno\u015bci do poziomu ${e}/10`}]}}}),r(`${l.name} zwi\u0119kszy\u0142 swoje umiej\u0119tno\u015bci do poziomu ${e}/10!`,"success"))}},N=()=>e.projects.filter((e=>"waiting_for_developer"===e.status||"new"===e.status&&(!e.assignedStaff||!e.assignedStaff.developer))),z=e=>{const n=N();if(0===n.length)return!1;const i=n[0];return t({type:"ASSIGN_STAFF_TO_PROJECT",payload:{staffType:"developer",staffId:e,projectId:i.id}}),t({type:"UPDATE_PROJECT",payload:{projectId:i.id,changes:{status:"in_development",progress:0}}}),!0};return{hireStaff:function(i){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"junior";try{try{localStorage.setItem("staffHiringState",JSON.stringify({inProgress:!0,staffType:i,level:a,timestamp:Date.now()}))}catch(s){console.warn("Nie mo\u017cna zapisa\u0107 stanu zatrudniania:",s)}if(!e){console.error("Brak stanu gracza"),r("Wyst\u0105pi\u0142 problem z zatrudnieniem pracownika. Od\u015bwie\u017c stron\u0119.","error");try{localStorage.removeItem("staffHiringState")}catch(s){console.warn("Nie mo\u017cna usun\u0105\u0107 stanu zatrudniania:",s)}return!1}if(e.staff||(t({type:"UPDATE_PLAYER",payload:{staff:{scouts:[],developers:[],lawyers:[],envSpecialists:[],lobbyists:[],lessors:[]}}}),console.warn("Zainicjalizowano struktur\u0119 personelu, kt\xf3ra nie istnia\u0142a")),!["scout","developer","lawyer","envSpecialist","lobbyist"].includes(i)){console.error(`Nieprawid\u0142owy typ pracownika: ${i}`),r(`Nieprawid\u0142owy typ pracownika: ${i}`,"error");try{localStorage.removeItem("staffHiringState")}catch(s){console.warn("Nie mo\u017cna usun\u0105\u0107 stanu zatrudniania:",s)}return!1}if(!["junior","mid","senior"].includes(a)){console.error(`Nieprawid\u0142owy poziom pracownika: ${a}`),r(`Nieprawid\u0142owy poziom pracownika: ${a}`,"error");try{localStorage.removeItem("staffHiringState")}catch(s){console.warn("Nie mo\u017cna usun\u0105\u0107 stanu zatrudniania:",s)}return!1}const h=`${i}s`;if(!e.staff[h]){console.error(`Kategoria pracownik\xf3w ${h} nie istnieje`),r("Wyst\u0105pi\u0142 problem z zatrudnieniem pracownika. Od\u015bwie\u017c stron\u0119.","error");try{localStorage.removeItem("staffHiringState")}catch(s){console.warn("Nie mo\u017cna usun\u0105\u0107 stanu zatrudniania:",s)}return!1}const p=l[a]||l.junior,m=c[i]||3e3,f=Math.floor(m*p.salaryMultiplier),y="lawyer"===i||"envSpecialist"===i?d[i]:2*f;if(e.cash<y){r(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w! Potrzebujesz ${y.toLocaleString()} PLN.`,"error");try{localStorage.removeItem("staffHiringState")}catch(s){console.warn("Nie mo\u017cna usun\u0105\u0107 stanu zatrudniania:",s)}return!1}const g=`${i}-${Date.now()}-${Math.floor(1e3*Math.random())}`,v=Math.floor(p.minSkill+Math.random()*(p.maxSkill-p.minSkill+1)),w={id:g,type:i,name:x(),skill:v,experience:0,level:a,salary:f,hiredOn:(null===n||void 0===n?void 0:n.turn)||0,morale:100,energy:100,specialization:b(i),traits:j(),busy:!1,assignedRegion:null,assignedProject:null};t({type:"HIRE_STAFF",payload:{staffType:i,staff:w,cost:y}});let k="nowy",_=i;try{k=Ry(a),_=Dy(i,!0)}catch(o){console.error("B\u0142\u0105d podczas t\u0142umaczenia nazw:",o)}if(r(`Zatrudniono ${k} ${_}: ${w.name}`,"success"),"developer"===i)try{const e=N();if(e.length>0){const t=e[0].name;z(g)&&r(`Developer ${w.name} zosta\u0142 automatycznie przydzielony do projektu ${t}`,"success")}}catch(u){console.error("B\u0142\u0105d podczas przydzielania developera do projektu:",u)}try{localStorage.removeItem("staffHiringState")}catch(s){console.warn("Nie mo\u017cna usun\u0105\u0107 stanu zatrudniania:",s)}return!0}catch(u){console.error("Wyst\u0105pi\u0142 b\u0142\u0105d podczas zatrudniania pracownika:",u),r("Wyst\u0105pi\u0142 b\u0142\u0105d podczas zatrudniania pracownika. Spr\xf3buj ponownie.","error");try{localStorage.removeItem("staffHiringState")}catch(s){console.warn("Nie mo\u017cna usun\u0105\u0107 stanu zatrudniania:",s)}return!1}},fireStaff:(n,i)=>{const a=e.staff[`${n}s`];if(!a)return!1;const s=a.findIndex((e=>e.id===i));if(-1===s)return!1;const o=a[s],l=o.salary;return e.cash<l?(r(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w na odpraw\u0119! Potrzebujesz ${l.toLocaleString()} PLN.`,"error"),!1):(t({type:"FIRE_STAFF",payload:{staffType:n,staffId:i,cost:l}}),r(`Zwolniono pracownika: ${o.name}`,"warning"),!0)},trainStaff:(n,i,a)=>{const s=e.staff[`${n}s`];if(!s)return!1;const o=s.findIndex((e=>e.id===i));if(-1===o)return!1;const l=s[o],c=w(l,a);return e.cash<c?(r(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w na szkolenie! Potrzebujesz ${c.toLocaleString()} PLN.`,"error"),!1):(t({type:"TRAIN_STAFF",payload:{staffType:n,staffId:i,trainingType:a,cost:c}}),r(`Wys\u0142ano pracownika ${l.name} na szkolenie`,"success"),!0)},assignStaffToProject:(i,s,o)=>{const l=i.endsWith("s")?i:`${i}s`,c=e.staff[l];if(!c)return!1;const d=c.find((e=>e.id===s));if(!d)return!1;const u=e.projects.find((e=>e.id===o));if(!u)return!1;if(!p(i,u.status))return r(`${Dy(i)} nie mo\u017ce by\u0107 przypisany do projektu na etapie ${My(u.status)}`,"error"),!1;if(("developer"===i||"developers"===i)&&!d.assignedProject){const t=e.projects.filter((e=>e.assignedStaff&&e.assignedStaff.developer===s)).length;if(t>=5)return r(`Developer ${d.name} osi\u0105gn\u0105\u0142 limit 5 projekt\xf3w. Od\u0142\u0105cz go od istniej\u0105cego projektu, aby przypisa\u0107 do nowego.`,"error"),!1}return d.assignedProject&&m(i,s),t({type:"ASSIGN_STAFF_TO_PROJECT",payload:{staffType:i.endsWith("s")?i.slice(0,-1):i,staffId:s,projectId:o}}),a({type:"ADD_EVENT",payload:{id:Date.now()+Math.random(),type:"staff_event",title:"Przypisanie pracownika",description:`${d.name} (${Dy(i)}) zosta\u0142 przypisany do projektu ${u.name}`,severity:"info",turn:n.turn,expires:n.turn+5,staffId:d.id,staffName:d.name}}),r(`Przypisano ${Dy(i)} ${d.name} do projektu ${u.name}`,"success"),!0},unassignStaffFromProject:m,generateStaffEvents:f,applyStaffEventEffect:g,updateStaffExperience:v,calculateTrainingCost:w,isStaffValidForProjectStage:p,checkForLevelUp:k,calculateStaffProjectBonus:t=>{var n,i;const r=e.projects.find((e=>e.id===t));if(!r||!r.assignedStaff)return 1;let a=1;if(r.assignedStaff.developer){const t=e.staff.developers.find((e=>e.id===r.assignedStaff.developer));if(t){a+=.02*t.skill+({junior:.05,mid:.1,senior:.15}[t.level]||.05)}}if(r.assignedStaff.lobbyist){const t=e.staff.lobbyists.find((e=>e.id===r.assignedStaff.lobbyist));if(t){a+=.01*t.skill+({junior:.03,mid:.06,senior:.1}[t.level]||.03)}}const s=(null===(n=e.staff.lawyers)||void 0===n?void 0:n.length)||0,o=(null===(i=e.staff.envSpecialists)||void 0===i?void 0:i.length)||0;if(s>0&&["environmental_decision","zoning_conditions","grid_connection"].includes(r.status)){const t=e.staff.lawyers.reduce(((e,t)=>e+t.skill),0)/s;a+=Math.min(.03*s,.15)+.005*t}if(o>0&&"environmental_decision"===r.status){const t=e.staff.envSpecialists.reduce(((e,t)=>e+t.skill),0)/o;a+=Math.min(.04*o,.2)+.005*t}return Math.min(a,1.5)},findProjectsWaitingForDeveloper:N,assignDeveloperToWaitingProject:z}},Uy={PV:{name:"Fotowoltaika",shortName:"PV",icon:"Sun",color:"yellow",stages:{land_acquisition:{time:{min:1,max:3},costPerMW:{min:1e4,max:1e4},description:"Pozyskiwanie grunt\xf3w pod instalacje fotowoltaiczne"},environmental_decision:{time:{min:4,max:8},costPerMW:{min:15e3,max:25e3},description:"Uzyskanie decyzji \u015brodowiskowej dla instalacji PV"},zoning_conditions:{time:{min:2,max:4},costPerMW:{min:3e4,max:4e4},description:"Uzyskanie warunk\xf3w zabudowy dla instalacji PV"},grid_connection:{time:{min:3,max:6},costPerMW:{min:12e4,max:15e4},description:"Przy\u0142\u0105czenie do sieci instalacji fotowoltaicznej"},construction:{time:{min:6,max:10},costPerMW:{min:25e5,max:35e5},description:"Budowa instalacji fotowoltaicznej"}},marketPrices:{greenfield:{min:15e3,max:25e3,currency:"PLN"},development:{min:5e4,max:8e4,currency:"EUR"},rtb:{min:61e4,max:61e4,currency:"PLN"},cod:{min:8e5,max:12e5,currency:"EUR"}},specificRisks:[{name:"Problemy z sieci\u0105",probability:.25,impact:"grid_connection_delay",description:"Ograniczenia w przy\u0142\u0105czeniu do sieci"},{name:"Zmiany w systemie wsparcia",probability:.15,impact:"financial_impact",description:"Zmiany w aukcjach OZE"}]},WF:{name:"Farmy Wiatrowe",shortName:"WF",icon:"Wind",color:"blue",stages:{land_acquisition:{time:{min:7,max:12},costPerMW:{min:1e4,max:1e4},description:"Pozyskiwanie grunt\xf3w pod farmy wiatrowe"},environmental_decision:{time:{min:12,max:20},costPerMW:{min:15e3,max:25e3},description:"Uzyskanie decyzji \u015brodowiskowej dla farm wiatrowych"},zoning_conditions:{time:{min:10,max:16},costPerMW:{min:3e4,max:4e4},description:"Uzyskanie warunk\xf3w zabudowy dla farm wiatrowych"},grid_connection:{time:{min:12,max:24},costPerMW:{min:12e4,max:15e4},description:"Przy\u0142\u0105czenie do sieci farm wiatrowych"},construction:{time:{min:18,max:30},costPerMW:{min:4e6,max:6e6},description:"Budowa farm wiatrowych"}},marketPrices:{greenfield:{min:2e5,max:7e5,currency:"PLN"},development:{min:25e4,max:35e4,currency:"PLN"},rtb:{min:4e5,max:4e5,currency:"PLN"},cod:{min:15e5,max:2e6,currency:"EUR"}},specificRisks:[{name:"Protesty ekologiczne",probability:.35,impact:"environmental_decision_delay",description:"Protesty organizacji ekologicznych"},{name:"Zasada 10H",probability:.2,impact:"land_limitation",description:"Ograniczenia lokalizacji turbin"}]},BESS:{name:"Magazyny Energii",shortName:"BESS",icon:"Battery",color:"green",stages:{land_acquisition:{time:{min:4,max:8},costPerMW:{min:1e4,max:1e4},description:"Pozyskiwanie grunt\xf3w pod magazyny energii"},environmental_decision:{time:{min:6,max:12},costPerMW:{min:15e3,max:25e3},description:"Uzyskanie decyzji \u015brodowiskowej dla magazyn\xf3w energii"},zoning_conditions:{time:{min:4,max:10},costPerMW:{min:3e4,max:4e4},description:"Uzyskanie warunk\xf3w zabudowy dla magazyn\xf3w energii"},grid_connection:{time:{min:10,max:18},costPerMW:{min:12e4,max:15e4},description:"Przy\u0142\u0105czenie do sieci magazyn\xf3w energii"},construction:{time:{min:12,max:18},costPerMW:{min:28e5,max:36e5},description:"Budowa magazyn\xf3w energii"}},marketPrices:{greenfield:{min:5e4,max:1e5,currency:"PLN"},development:{min:15e4,max:25e4,currency:"PLN"},rtb:{min:18e5,max:18e5,currency:"PLN"},cod:{min:3e6,max:45e5,currency:"PLN"}},specificRisks:[{name:"Regulacje bezpiecze\u0144stwa",probability:.3,impact:"additional_costs",description:"Dodatkowe wymagania bezpiecze\u0144stwa"},{name:"Problemy z \u0142a\u0144cuchem dostaw",probability:.25,impact:"construction_delay",description:"Op\xf3\u017anienia w dostawie komponent\xf3w"}]}},Vy={"PV+BESS":{name:"Fotowoltaika z Magazynem",shortName:"PV+BESS",icon:"SunBattery",color:"teal",components:["PV","BESS"],componentWeights:{PV:.7,BESS:.3}},"WF+BESS":{name:"Wiatrowa z Magazynem",shortName:"WF+BESS",icon:"WindBattery",color:"indigo",components:["WF","BESS"],componentWeights:{WF:.7,BESS:.3}},"PV+WF":{name:"Fotowoltaika i Wiatrowa",shortName:"PV+WF",icon:"SunWind",color:"green",components:["PV","WF"],componentWeights:{PV:.5,WF:.5}},"PV+WF+BESS":{name:"Kompleksowy System OZE",shortName:"PV+WF+BESS",icon:"SunWindBattery",color:"purple",components:["PV","WF","BESS"],componentWeights:{PV:.4,WF:.4,BESS:.2}}};function By(e,t,n){const i={PV:15e4,WF:2e5,BESS:25e4,"PV+BESS":18e4,"WF+BESS":23e4,"PV+WF":19e4,"PV+WF+BESS":22e4}[e]||a50000,r={land_acquisition:.15,environmental_decision:.35,zoning_conditions:.55,grid_connection:.85,ready_to_build:1}[n]||.1;return Math.round(t*i*r)}const $y=()=>{const{state:e,dispatch:t}=u(),{state:n,showNotification:r}=ff(),{state:a,dispatch:s}=xf(),{state:o,dispatch:l}=(()=>{const e=(0,i.useContext)(jf);if(!e)throw new Error("useCountyContext musi by\u0107 u\u017cywany wewn\u0105trz CountyProvider");return e})(),{dispatch:c}=H(),d=(null===a||void 0===a?void 0:a.regions)||[],h=(null===o||void 0===o?void 0:o.counties)||[],p=e||{projects:[],staff:{}},m=n||{},f=(0,i.useCallback)((e=>{let t=0;return h.forEach((n=>{n.leasePools&&Object.values(n.leasePools).forEach((n=>{n.lessors&&n.lessors.includes(e)&&t++}))})),t}),[h]),y=(0,i.useCallback)((()=>{const e=p.staff.lessors;if(0===e.length)return null;const t=e.map((e=>({lessor:e,countyCount:f(e.id)})));return t.sort(((e,t)=>e.countyCount-t.countyCount)),t[0].lessor}),[p.staff.lessors,f]),g=(0,i.useCallback)(((e,t)=>{if(!e||!e.specialization)return!1;const n=e.specialization.toLowerCase();if("PV"===t&&n.includes("fotowoltaika"))return!0;if("WF"===t&&n.includes("wiatrowe"))return!0;if("BESS"===t&&n.includes("magazyn"))return!0;if(t.includes("+")&&n.includes("hybrydowe")){t.split("+");if("PV+BESS"===t&&n.includes("pv+bess"))return!0;if("WF+BESS"===t&&n.includes("fw+bess"))return!0;if("PV+WF"===t&&n.includes("pv+wf"))return!0;if("PV+WF+BESS"===t&&n.includes("pv+wf+bess"))return!0}return!1}),[]),v=(0,i.useCallback)(((e,t,n)=>{const i=h.find((n=>n.voivodeship===e&&n.id===t));if(!i)return!1;if(!i.leasePools)return l({type:"UPDATE_COUNTY",payload:{id:t,voivodeship:e,changes:{leasePools:{PV:{lessors:[],projects:[]},WF:{lessors:[],projects:[]},BESS:{lessors:[],projects:[]},"PV+BESS":{lessors:[],projects:[]},"WF+BESS":{lessors:[],projects:[]},"PV+WF":{lessors:[],projects:[]},"PV+WF+BESS":{lessors:[],projects:[]}}}}}),!0;if(!i.leasePools[n]){const r={...i.leasePools};r[n]={lessors:[],projects:[]},l({type:"UPDATE_COUNTY",payload:{id:t,voivodeship:e,changes:{leasePools:r}}})}return!0}),[h,l]),w=e=>{try{return e?(e instanceof Date||(e=new Date(e)),isNaN(e.getTime())?(console.warn("Nieprawid\u0142owa warto\u015b\u0107 daty. U\u017cywam bie\u017c\u0105cej daty.",e),(new Date).toISOString()):e.getFullYear()<0||e.getFullYear()>275759?(console.warn("Data poza dozwolonym zakresem. U\u017cywam bie\u017c\u0105cej daty.",e),(new Date).toISOString()):e.toISOString()):(new Date).toISOString()}catch(t){return console.error("B\u0142\u0105d tworzenia ISO String:",t),(new Date).toISOString()}},x=(0,i.useCallback)(((e,t,n,i)=>{const r=h.find((e=>e.voivodeship===t&&e.id===n));if(!r||!r.leasePools||!r.leasePools[i])return!1;if(r.leasePools[i].lessors.includes(e))return!0;const a={...r.leasePools};return a[i]={...a[i],lessors:[...a[i].lessors,e]},l({type:"UPDATE_COUNTY",payload:{id:n,voivodeship:t,changes:{leasePools:a}}}),!0}),[h,l]),b=(0,i.useCallback)(((e,t,n)=>{const i=h.find((n=>n.voivodeship===e&&n.id===t));return!!(i&&i.leasePools&&i.leasePools[n])&&i.leasePools[n].lessors.length>0}),[h]),j=(0,i.useCallback)(((e,t,n)=>{const i=h.find((n=>n.voivodeship===e&&n.id===t));if(!i||!i.leasePools||!i.leasePools[n])return null;if(0===i.leasePools[n].lessors.length)return null;const r=i.leasePools[n].lessors[0];return p.staff.lessors.find((e=>e.id===r))}),[h,p.staff.lessors]),k=(0,i.useCallback)((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"PV",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a=d.find((t=>t.id===e));if(!a)return null;if(0===p.staff.lessors.length)return r("Potrzebujesz zatrudni\u0107 przynajmniej jednego dzier\u017cawc\u0119, aby rozpocz\u0105\u0107 projekt!","error"),null;if(!i)return r("Wybierz powiat, w kt\xf3rym chcesz rozpocz\u0105\u0107 projekt!","error"),null;if(!v(e,i,n))return r("Nie uda\u0142o si\u0119 zainicjowa\u0107 puli dzier\u017cawy dla powiatu!","error"),null;if(!b(e,i,n)){const t=y();if(!t)return r("Wszyscy twoi dzier\u017cawcy obs\u0142uguj\u0105 ju\u017c maksymaln\u0105 liczb\u0119 powiat\xf3w (5). Zatrudnij wi\u0119cej dzier\u017cawc\xf3w!","error"),null;if(!x(t.id,e,i,n))return r("Nie uda\u0142o si\u0119 przypisa\u0107 dzier\u017cawcy do puli dzier\u017cawy!","error"),null;g(t,n)||r(`Dzier\u017cawca ${t.name} nie ma specjalizacji pasuj\u0105cej do technologii ${n}. Efektywno\u015b\u0107 dzier\u017cawy b\u0119dzie ni\u017csza.`,"warning")}j(e,i,n);const o=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=e.includes("+");let r,a,s=[];if(i){if(a=Vy[e],!a)return null;if(s=a.components.map((e=>Uy[e])),s.some((e=>!e)))return null}else if(r=Uy[e],!r)return null;const o=n.size||Math.floor(30+50*Math.random());let l;if(i)l="PV+BESS"===e?Math.floor(o*(1.2+.6*Math.random())):"WF+BESS"===e?Math.floor(o*(.6+.3*Math.random())):"PV+WF"===e?Math.floor(o*(.8+.4*Math.random())):Math.floor(o*(1+.5*Math.random()));else switch(e){case"PV":l=Math.floor(o*(1+.5*Math.random()));break;case"WF":l=Math.floor(o*(.5+.3*Math.random()));break;case"BESS":l=Math.floor(o*(2+1*Math.random()));break;default:l=Math.floor(o*(1.2+.8*Math.random()))}const c=Date.now()+Math.floor(1e3*Math.random()),d=i?`${a.shortName} ${t.slice(0,3).toUpperCase()}${Math.floor(100*Math.random())}`:`${r.shortName} ${t.slice(0,3).toUpperCase()}${Math.floor(100*Math.random())}`;let u={},h={};if(i){u=a.components.reduce(((e,t)=>{const n=Uy[t],i=a.componentWeights[t];return Object.entries(n.stages).forEach((t=>{let[n,r]=t;e[n]||(e[n]={time:{min:0,max:0},costPerMW:{min:0,max:0},description:`${a.name}: ${r.description}`}),e[n].time.min+=r.time.min*i,e[n].time.max+=r.time.max*i,e[n].costPerMW.min+=r.costPerMW.min*i,e[n].costPerMW.max+=r.costPerMW.max*i})),e}),{});const e=a.components.reduce(((e,t)=>{const n=Uy[t],i=a.componentWeights[t];return Object.entries(n.marketPrices).forEach((t=>{let[n,r]=t;e[n]||(e[n]={min:0,max:0,currency:r.currency}),e[n].min+=r.min*i,e[n].max+=r.max*i})),e}),{}),t=1.1+.1*Math.random();Object.keys(e).forEach((n=>{h[n]={min:Math.round(e[n].min*t),max:Math.round(e[n].max*t),currency:e[n].currency}}))}else u=r.stages,h=r.marketPrices;const p={};return Object.entries(u).forEach((e=>{let[t,n]=e;const i=n.costPerMW.min,r=n.costPerMW.max,a=i+Math.random()*(r-i);p[t]=Math.round(a*l)})),{id:c,name:d,technology:e,isHybrid:i,hybridComponents:i?a.components:[e],region:t,size:o,power:l,status:"land_acquisition",statusIndex:0,progress:0,turn:n.turn||1,etapCosts:p,marketValue:By(e,l,"land_acquisition"),totalCost:0,events:[],assignedStaff:{},specialRisks:i?a.components.flatMap((e=>Uy[e].specificRisks||[])):r.specificRisks||[]}}(n,e,{turn:m.turn,countyId:i}),c=h.find((t=>t.voivodeship===e&&t.id===i));if(!c)return r("Nie znaleziono powiatu!","error"),null;if(c.availableLand<o.size)return r(`W tym powiecie nie ma wystarczaj\u0105cej ilo\u015bci grunt\xf3w na projekt o mocy ${o.power} MW!`,"error"),null;if(c.gridCapacity<o.power)return r(`W tym powiecie nie ma wystarczaj\u0105cej mocy przy\u0142\u0105czeniowej dla projektu o mocy ${o.power} MW!`,"error"),null;o.county={id:c.id,name:c.name,voivodeship:c.voivodeship},o.technology=n,n.includes("+")?(o.isHybrid=!0,o.hybridComponents=n.split("+")):(o.isHybrid=!1,o.hybridComponents=[n]),n.includes("PV")?o.productionFactor=c.solarPotential/100:n.includes("WF")?o.productionFactor=c.windPotential/100:"BESS"===n&&(o.productionFactor=1);const u=1+c.environmentalRestrictions/100*.5;o.environmentalDelayFactor=u;const f=1+c.localOpposition/100*.3;o.oppositionDelayFactor=f;const k=2-c.administrativeEfficiency/100;o.administrationEfficiencyFactor=k,o.totalDelayFactor=(u+f+k)/3;const N=Math.floor(10*Math.random())+1,z=Math.min(N*(500+500*Math.random()),7e3),_=Math.max(1e4-z,3e3)*c.propertyPrices,S=Math.round(_*o.size);o.etapCosts.land_acquisition=S,o.leaseDetails={baseRate:1e4,adjustedRate:_,distanceToTransformer:N,hasIndexationClause:Math.random()<.7,securityDeposit:Math.floor((3e4+2e4*Math.random())*o.power)},o.assignedStaff={},o.etapPaid={land_acquisition:!1,environmental_decision:!1,zoning_conditions:!1,grid_connection:!1,construction:!1};const E=new Date(m.gameDate||Date.now());w(E),o.name,a.name;o.history=[{date:w(E),event:"project_start",description:`Rozpocz\u0119to projekt ${o.name} w regionie ${a.name}`}],t({type:"ADD_PROJECT",payload:o}),s({type:"ADD_PROJECT_TO_REGION",payload:{regionId:e,project:{id:o.id,name:o.name,power:o.power,status:o.status,technology:o.technology}}}),l({type:"ADD_PROJECT_TO_COUNTY",payload:{countyId:i,voivodeship:e,project:{id:o.id,name:o.name,size:o.size,power:o.power,technology:o.technology}}});const C=h.find((t=>t.voivodeship===e&&t.id===i));if(C&&C.leasePools&&C.leasePools[n]){const t={...C.leasePools};t[n]={...t[n],projects:[...t[n].projects,o.id]},l({type:"UPDATE_COUNTY",payload:{id:i,voivodeship:e,changes:{leasePools:t}}})}return r(`Rozpocz\u0119to nowy projekt ${o.name} w powiecie ${c.name}`,"success"),o}),[p,d,h,m,t,s,l,r,y,g,v,b,x,j]),N=(0,i.useCallback)((e=>{try{const i=p.projects.find((t=>t.id===e));if(!i)return console.error(`Nie znaleziono projektu o ID: ${e}`),!1;if(!i.assignedDeveloper){var n;const a=(null===(n=p.staff.developers)||void 0===n?void 0:n.filter((e=>!e.busy&&!e.assignedProject)))||[];if(!(a.length>0))return!1;{const n=a.sort(((e,t)=>(t.skill||0)-(e.skill||0)))[0];t({type:"UPDATE_STAFF",payload:{staffType:"developers",staffId:n.id,changes:{busy:!0,assignedProject:e}}}),t({type:"UPDATE_PROJECT",payload:{projectId:e,changes:{assignedDeveloper:n.id,status:"in_development"}}}),r(`Developer ${n.name} zosta\u0142 przydzielony do projektu w ${i.regionId}`,"success")}}i.status;const a=["land_acquisition_completed","environmental_studies","environmental_decision","zoning_conditions","building_permit","grid_connection","rtb"],s=a.indexOf(i.currentStage||"land_acquisition_completed");if(-1===s)return console.error(`Nieprawid\u0142owy etap projektu: ${i.currentStage}`),!1;if(s===a.length-1)return!0;const o=a[s+1],l=z(i,o);if(!l.canTransition)return t({type:"UPDATE_PROJECT",payload:{projectId:e,changes:{transitionBlockReason:l.reason}}}),!1;const c=_(i,o);if(Math.random()>c){const n=new Date(m.gameDate||Date.now()),l={...i.stages};l[i.currentStage]&&(l[i.currentStage].completed=!0,l[i.currentStage].completionDate=n.toISOString()),l[o]?l[o].startDate=n.toISOString():l[o]={completed:!1,startDate:n.toISOString(),completionDate:null},t({type:"UPDATE_PROJECT",payload:{projectId:e,changes:{currentStage:o,stages:l,lastUpdated:n.toISOString(),progress:(s+1)/(a.length-1)*100}}});i.stageHistory,w(new Date(m.gameDate||Date.now())),i.history,w(new Date(m.gameDate||Date.now())),My(o);return r(`Projekt w ${i.regionId} przeszed\u0142 do etapu ${My(o)}`,"success"),"rtb"===o&&(t({type:"UPDATE_PROJECT",payload:{projectId:e,changes:{status:"ready_to_build",rtbDate:n.toISOString()}}}),i.assignedDeveloper&&t({type:"UPDATE_STAFF",payload:{staffType:"developers",staffId:i.assignedDeveloper,changes:{busy:!1,assignedProject:null}}}),t({type:"UPDATE_PLAYER",payload:{rtbCapacity:(p.rtbCapacity||0)+(i.capacity||0)}}),t({type:"UPDATE_PLAYER",payload:{reputation:Math.min(200,(p.reputation||0)+5)}}),r(`Projekt w ${i.regionId} osi\u0105gn\u0105\u0142 status Ready-to-Build!`,"success")),!0}return t({type:"UPDATE_PROJECT",payload:{projectId:e,changes:{transitionFailures:(i.transitionFailures||0)+1,issues:[...i.issues||[],S(o)]}}}),r(`Wyst\u0105pi\u0142 problem podczas przej\u015bcia projektu w ${i.regionId} do etapu ${My(o)}`,"warning"),!1}catch(i){return console.error("B\u0142\u0105d podczas zarz\u0105dzania rozwojem projektu:",i),!1}}),[p,t,m,_,z,S,r]),z=(e,t)=>{var n,i;const r={canTransition:!0,reason:""};if(e.issues&&e.issues.some((e=>!e.resolved)))return r.canTransition=!1,r.reason="Projekt ma nierozwi\u0105zane problemy",r;switch(t){case"environmental_decision":e.hasEnvironmentalAssessment||(r.canTransition=!1,r.reason="Brak oceny oddzia\u0142ywania na \u015brodowisko");break;case"zoning_conditions":null!==(n=e.stageHistory)&&void 0!==n&&null!==(i=n.environmental_decision)&&void 0!==i&&i.completed||(r.canTransition=!1,r.reason="Brak decyzji \u015brodowiskowej");break;case"grid_connection":e.hasGridConnectionDesign||(r.canTransition=!1,r.reason="Brak projektu przy\u0142\u0105cza do sieci");break;case"ready_to_build":e.hasConstructionPermit||(r.canTransition=!1,r.reason="Brak pozwolenia na budow\u0119")}return r},_=(e,t)=>{let n=0;switch(t){case"environmental_decision":n=.2;break;case"zoning_conditions":n=.15;break;case"grid_connection":n=.25;break;case"ready_to_build":n=.1;break;default:n=.05}n+=.1*(e.complexity||0);const i=p.reputation||50;i>=80?n*=.7:i<30&&(n*=1.3);const r=p.staff.developers.find((t=>{var n;return t.id===(null===(n=e.assignedStaff)||void 0===n?void 0:n.developer)}));if(r){n*=1-(r.skill||50)/100*.5-(r.specialization===e.technology?.2:0)}return n+=.1*(e.transitionFailures||0),Math.max(.05,Math.min(.95,n))},S=e=>{const t={land_acquisition:[{name:"Problemy prawne z w\u0142asno\u015bci\u0105 gruntu",cost:5e3,time:10,complexity:.2},{name:"Sp\xf3r graniczny",cost:3e3,time:7,complexity:.15},{name:"Nieoczekiwane ograniczenia dzier\u017cawy",cost:4e3,time:5,complexity:.1}],environmental_decision:[{name:"Wymagana dodatkowa ocena wp\u0142ywu na gatunki chronione",cost:8e3,time:15,complexity:.3},{name:"Sprzeciw lokalnych ekolog\xf3w",cost:1e4,time:20,complexity:.25},{name:"Niekompletna dokumentacja \u015brodowiskowa",cost:6e3,time:10,complexity:.2}],zoning_conditions:[{name:"Negatywna opinia s\u0105siad\xf3w",cost:5e3,time:12,complexity:.2},{name:"Konflikt z miejscowym planem zagospodarowania",cost:12e3,time:25,complexity:.4},{name:"Wymagane dodatkowe konsultacje spo\u0142eczne",cost:7e3,time:15,complexity:.3}],grid_connection:[{name:"Niewystarczaj\u0105ca przepustowo\u015b\u0107 sieci",cost:15e3,time:20,complexity:.35},{name:"Konieczno\u015b\u0107 budowy dodatkowej infrastruktury",cost:25e3,time:30,complexity:.5},{name:"Wysoki koszt przy\u0142\u0105czenia",cost:2e4,time:15,complexity:.25}],ready_to_build:[{name:"Konieczno\u015b\u0107 aktualizacji projektu budowlanego",cost:1e4,time:15,complexity:.3},{name:"Dodatkowe wymogi bezpiecze\u0144stwa",cost:8e3,time:10,complexity:.2},{name:"Problemy z finansowaniem",cost:3e4,time:20,complexity:.4}]}[e]||[];if(0===t.length)return{id:`issue-${Date.now()}-${Math.floor(1e3*Math.random())}`,name:"Nieoczekiwany problem administracyjny",description:"Pojawi\u0142 si\u0119 nieoczekiwany problem administracyjny.",cost:5e3,time:10,complexity:.2,resolved:!1,createdAt:(new Date).toISOString()};const n=t[Math.floor(Math.random()*t.length)];return{id:`issue-${Date.now()}-${Math.floor(1e3*Math.random())}`,name:n.name,description:`${n.name}. Wymaga dodatkowych dzia\u0142a\u0144.`,cost:n.cost,time:n.time,complexity:n.complexity,resolved:!1,createdAt:(new Date).toISOString()}},E=((0,i.useCallback)(((e,n)=>{const i=p.projects.find((t=>t.id===e));if(!i||!i.issues)return r("Nie znaleziono projektu lub problem\xf3w","error"),!1;const a=i.issues.find((e=>e.id===n));if(!a)return r("Nie znaleziono problemu","error"),!1;if(p.cash<a.cost)return r(`Niewystarczaj\u0105ce \u015brodki. Potrzeba: ${a.cost.toLocaleString()} PLN`,"error"),!1;t({type:"UPDATE_CASH",payload:{amount:-a.cost,reason:`Rozwi\u0105zanie problemu: ${a.name} w projekcie ${i.name}`}});const s=i.issues.map((e=>e.id===n?{...e,resolved:!0,resolvedAt:(new Date).toISOString()}:e));return t({type:"UPDATE_PROJECT",payload:{projectId:e,changes:{issues:s}}}),t({type:"ADD_PROJECT_EVENT",payload:{projectId:e,event:{date:(new Date).toISOString(),text:`Rozwi\u0105zano problem: ${a.name}`,type:"issue_resolved"}}}),r(`Problem "${a.name}" zosta\u0142 rozwi\u0105zany`,"success"),!0}),[p.projects,p.cash,t,r]),(0,i.useCallback)((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const i=p.projects.find((t=>t.id===e));if(!i)return r("Nie znaleziono projektu","error"),!1;if("ready_to_build"===i.status)return r("Projekt jest ju\u017c gotowy do budowy","warning"),!1;let a=0,s=0;switch(i.status){case"land_acquisition":a=n||Math.round(5e3*i.size),s=Math.min(50,Math.round(a/(5e3*i.size)*50));break;case"environmental_decision":a=n||Math.max(5e4,1e4*i.power),s=Math.min(40,Math.round(a/(1e4*i.power)*40));break;case"zoning_conditions":a=n||Math.max(3e4,7e3*i.power),s=Math.min(35,Math.round(a/(7e3*i.power)*35));break;case"grid_connection":a=n||Math.max(8e4,15e3*i.power),s=Math.min(30,Math.round(a/(15e3*i.power)*30))}return p.cash<a?(r(`Niewystarczaj\u0105ca ilo\u015b\u0107 got\xf3wki. Potrzebujesz ${a.toLocaleString()} PLN.`,"error"),!1):(t({type:"UPDATE_PROJECT",payload:{id:e,changes:{progress:Math.min(100,(i.progress||0)+s),events:[...i.events,{turn:m.turn,text:`Przyspieszono projekt o ${s}% za ${a.toLocaleString()} PLN`}]}}}),t({type:"UPDATE_CASH",payload:-a}),t({type:"UPDATE_PROJECT_TOTAL_COST",payload:{projectId:i.id,cost:a}}),r(`Przyspieszono projekt ${i.name} o ${s}%!`,"success"),!0)}),[p,m,t])),C=(0,i.useCallback)((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const i=p.projects.find((t=>t.id===e));if(!i)return r("Nie znaleziono projektu","error"),!1;if("ready_to_build"!==i.status)return r("Tylko projekty gotowe do budowy mog\u0105 by\u0107 wystawione na rynek","warning"),!1;const a=15e4*i.power,s=n||a;return t({type:"SEND_PROJECT_TO_MARKET",payload:{projectId:e,price:s}}),r(`Projekt "${i.name}" zosta\u0142 wystawiony na rynek za ${s.toLocaleString()} PLN`,"success"),!0}),[p,t,r]),T=(0,i.useCallback)((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bribery";const i=p.projects.find((t=>t.id===e));if(!i)return r("Nie znaleziono projektu","error"),!1;if(p.reputation<120)return r("Niewystarczaj\u0105ca reputacja do wykonania nielegalnych dzia\u0142a\u0144","error"),!1;const a={bribery:{cost:Math.round(25e3*i.power),progressGain:25,reputationLoss:10,riskOfExposure:.3},forgery:{cost:Math.round(15e3*i.power),progressGain:15,reputationLoss:15,riskOfExposure:.4},intimidation:{cost:Math.round(1e4*i.power),progressGain:10,reputationLoss:20,riskOfExposure:.5}},s=a[n]||a.bribery;if(p.cash<s.cost)return r("Niewystarczaj\u0105ca ilo\u015b\u0107 got\xf3wki","error"),!1;const o=Math.random()<s.riskOfExposure;return t({type:"UPDATE_PROJECT",payload:{id:e,changes:{progress:Math.min(100,(i.progress||0)+s.progressGain),useIllegalMethods:!0,events:[...i.events,{turn:m.turn,text:`U\u017cyto nielegalnych metod (${n}) do przyspieszenia projektu o ${s.progressGain}%`,isIllegal:!0}]}}}),t({type:"UPDATE_CASH",payload:-s.cost}),o&&t({type:"UPDATE_REPUTATION",payload:{change:-s.reputationLoss,reason:`Wykryto nielegalne dzia\u0142ania w projekcie ${i.name}`}}),t({type:"ADD_ILLEGAL_ACTION",payload:{type:n,target:i.name,cost:s.cost,turn:m.turn,exposed:o}}),o?r(`Twoje nielegalne dzia\u0142ania zosta\u0142y wykryte! Strata reputacji: ${s.reputationLoss}`,"error"):r(`U\u017cyto nielegalnych metod do przyspieszenia projektu o ${s.progressGain}%`,"success"),!0}),[p,m,t,r]);return{projects:p.projects,startNewProject:k,manageProjectDevelopment:N,accelerateProject:E,sendProjectToMarket:C,applyIllegalMethod:T,translateStage:My}},Wy=Ff("Battery",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]),qy=Ff("ShieldOff",[["path",{d:"M19.7 14a6.9 6.9 0 0 0 .3-2V5l-8-3-3.2 1.2",key:"342pvf"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M4.7 4.7 4 5v7c0 6 8 10 8 10a20.3 20.3 0 0 0 5.62-4.38",key:"p0ycf4"}]]),Hy=Ff("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),Ky=Ff("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Gy=e=>{let{value:t=0,status:n="medium",showPercent:i=!1,className:r="",...s}=e;const o=Math.min(100,Math.max(0,t)),l=`progress-${n}`;return(0,a.jsxs)("div",{className:`relative ${r}`,...s,children:[(0,a.jsx)("div",{className:"progress-bar-container",children:(0,a.jsx)("div",{className:`progress-bar-fill ${l}`,style:{width:`${o}%`}})}),i&&(0,a.jsxs)("div",{className:"text-xs font-medium text-gray-700 text-right mt-1",children:[o,"%"]})]})},Qy=e=>{let{status:t="active",text:n,icon:i,className:r="",...s}=e;const o=`status-${t}`;return(0,a.jsxs)("span",{className:`status-indicator ${o} ${r}`,...s,children:[i&&(0,a.jsx)("span",{className:"mr-1",children:i}),n]})},Zy=e=>{var t,n;let{project:r,onAdvance:s,onAssignStaff:o,onDetails:l,onSell:c,onApplyIllegalMethod:d,onAccelerate:h}=e;const{state:p}=u(),{showNotification:m}=ff(),[f,y]=(0,i.useState)(!1);if(!r)return null;const g=e=>e>=1e6?`${(e/1e6).toFixed(2)} mln z\u0142`:e>=1e3?`${(e/1e3).toFixed(1)} tys. z\u0142`:`${e} z\u0142`,v=()=>"ready_to_build"===r.status?100:Math.min(100,Math.round(r.progress)),w={land_acquisition:{index:0,label:"Grunty"},environmental_decision:{index:1,label:"\u015arodowisko"},zoning_conditions:{index:2,label:"Warunki zabudowy"},grid_connection:{index:3,label:"Przy\u0142\u0105czenie"},ready_to_build:{index:4,label:"RTB"}},x=()=>{try{if(!r||!r.power||!r.status)return 0;const e=25e4*r.power,t={land_acquisition:.15,environmental_decision:.35,zoning_conditions:.55,grid_connection:.85,ready_to_build:1}[r.status]||.1,n=("number"===typeof r.progress?r.progress:0)/100*.2;return Math.round(e*(t+n))}catch(e){return console.error("B\u0142\u0105d podczas obliczania szacowanej warto\u015bci projektu:",e),0}},b=()=>{try{if(!r||"number"!==typeof r.totalCost)return 0;return x()-r.totalCost}catch(e){return console.error("B\u0142\u0105d podczas obliczania zysku:",e),0}},j=e=>{if(!d)return void m("Funkcja u\u017cywania nielegalnych metod nie jest dost\u0119pna","error");if(p.reputation<30)return void m("Reputacja jest zbyt niska, aby ryzykowa\u0107 kolejne nielegalne dzia\u0142ania","error");let t=0;switch(e){case"bribe_official":t=25e3+1e3*r.power;break;case"forge_documents":t=15e3+500*r.power;break;case"pressure_officials":t=3e4+2e3*r.power;break;default:t=2e4}p.cash<t?m(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w na t\u0119 akcj\u0119 (${t.toLocaleString()} z\u0142)`,"error"):(d(r.id,e,t),y(!1))};return(0,a.jsxs)("div",{className:"bg-white rounded shadow-md overflow-hidden flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"p-3 border-b bg-gray-50 flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"font-medium",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(e=>{switch(e){case"PV":return(0,a.jsx)($f,{className:"h-4 w-4 text-yellow-500"});case"WF":return(0,a.jsx)(Py,{className:"h-4 w-4 text-blue-500"});case"BESS":return(0,a.jsx)(Wy,{className:"h-4 w-4 text-purple-500"});default:return null}})(r.technology),(0,a.jsx)("span",{className:"ml-1",children:r.name}),r.useIllegalMethods&&(0,a.jsx)("div",{className:"ml-2 text-red-500",title:"Ten projekt wykorzystuje nielegalne metody",children:(0,a.jsx)(qy,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 flex items-center",children:[(0,a.jsx)(Iy,{className:"h-3 w-3 mr-1"}),r.county?`${r.county.name}, ${r.region}`:r.region]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-bold flex items-center justify-end",children:[r.power," MW"]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 flex items-center justify-end",children:[(0,a.jsx)(Uf,{className:"h-3 w-3 mr-1"})," Tura ",r.startedOn]})]})]}),(0,a.jsxs)("div",{className:"px-4 py-3",children:[(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[(0,a.jsxs)("span",{children:["Etap: ",My(r.status)]}),(0,a.jsxs)("span",{children:[v(),"%"]})]}),(0,a.jsx)(Gy,{value:v(),status:r.useIllegalMethods?"warning":v()>=75?"high":v()>=30?"medium":"low"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[(0,a.jsx)("span",{children:"Ca\u0142kowity post\u0119p"}),(0,a.jsxs)("span",{children:[20*(null===(t=w[r.status])||void 0===t?void 0:t.index)+v()/5,"%"]})]}),(0,a.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full "+(r.useIllegalMethods?"bg-amber-500":"bg-blue-500"),style:{width:20*(null===(n=w[r.status])||void 0===n?void 0:n.index)+v()/5+"%"}})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-4 text-xs",children:[(0,a.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,a.jsx)("div",{className:"text-gray-500",children:"Ca\u0142kowity koszt"}),(0,a.jsx)("div",{className:"font-medium",children:g(r.totalCost)})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,a.jsx)("div",{className:"text-gray-500",children:"Szacowana warto\u015b\u0107"}),(0,a.jsx)("div",{className:"font-medium",children:g(x())})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,a.jsx)("div",{className:"text-gray-500",children:"Potencjalny zysk"}),(0,a.jsxs)("div",{className:"font-medium "+(b()>=0?"text-green-600":"text-red-600"),children:[g(b())," (",(()=>{try{if(!r||"number"!==typeof r.totalCost||0===r.totalCost)return 0;const e=b();return Math.round(e/r.totalCost*100)}catch(e){return console.error("B\u0142\u0105d podczas obliczania procentowego zysku:",e),0}})(),"%)"]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,a.jsx)("div",{className:"text-gray-500",children:"Status"}),(0,a.jsx)("div",{className:"font-medium",children:(0,a.jsx)(Qy,{status:(k=r.status,N=r.progress,"ready_to_build"===k?"completed":N<25?"warning":"active"),text:r.progress>=100?"Gotowy do rozwoju":"W trakcie"})})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap justify-between mt-auto pt-2 border-t",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{onClick:()=>l(r.id),className:"text-xs px-2 py-1 text-gray-600 hover:bg-gray-100 rounded",children:"Szczeg\xf3\u0142y"}),(0,a.jsxs)("button",{onClick:()=>o(r.id),className:"text-xs px-2 py-1 text-gray-600 hover:bg-gray-100 rounded ml-1",children:[(0,a.jsx)(Gf,{className:"h-3 w-3 inline mr-1"}),"Personel"]})]}),(0,a.jsxs)("div",{className:"relative",children:[f&&(0,a.jsxs)("div",{className:"absolute bottom-8 right-0 bg-white shadow-md rounded border p-2 w-48 z-10",children:[(0,a.jsxs)("div",{className:"text-xs font-medium mb-2 text-red-600 flex items-center",children:[(0,a.jsx)(qy,{className:"h-3 w-3 mr-1"}),"Dzia\u0142ania niejawne"]}),(0,a.jsx)("button",{onClick:()=>j("bribe_official"),className:"text-xs w-full text-left p-1 hover:bg-red-50 text-gray-700 mb-1 rounded",children:"\u0141ap\xf3wka dla urz\u0119dnika (25k+ z\u0142)"}),(0,a.jsx)("button",{onClick:()=>j("forge_documents"),className:"text-xs w-full text-left p-1 hover:bg-red-50 text-gray-700 mb-1 rounded",children:"Fa\u0142szowanie dokument\xf3w (15k+ z\u0142)"}),(0,a.jsx)("button",{onClick:()=>j("pressure_officials"),className:"text-xs w-full text-left p-1 hover:bg-red-50 text-gray-700 mb-1 rounded",children:"Naciski na urz\u0119dnik\xf3w (30k+ z\u0142)"}),(0,a.jsx)("button",{onClick:()=>y(!1),className:"text-xs w-full text-left p-1 hover:bg-gray-100 text-gray-500 rounded",children:"Anuluj"})]}),r.progress>=100&&"ready_to_build"!==r.status&&(0,a.jsx)("button",{onClick:()=>s(r.id),className:"text-xs px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600",children:"Nast\u0119pny etap"}),"land_acquisition"!==r.status&&(0,a.jsxs)("button",{onClick:()=>c(r.id),className:"text-xs px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 ml-1",children:[(0,a.jsx)(Hy,{className:"h-3 w-3 inline mr-1"}),"Sprzedaj"]}),"ready_to_build"!==r.status&&(0,a.jsx)("button",{onClick:()=>y(!f),className:`text-xs px-2 py-1 ${r.useIllegalMethods?"bg-amber-500":"bg-gray-700"} text-white rounded hover:bg-gray-800 ml-1`,title:r.useIllegalMethods?"Ten projekt ju\u017c u\u017cywa nielegalnych metod":"U\u017cyj nielegalnych metod, aby przyspieszy\u0107 projekt",children:(0,a.jsx)(Ky,{className:"h-3 w-3 inline"})})]})]})]}),(0,a.jsxs)("div",{className:"px-4 py-3 bg-gray-50 flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"Status: "}),(0,a.jsx)("span",{className:"text-sm font-medium "+(r.useIllegalMethods?"text-amber-600":"text-blue-600"),children:My(r.status)})]}),"ready_to_build"!==r.status&&(0,a.jsx)(fy,{variant:"secondary",size:"sm",onClick:()=>{"function"===typeof h&&h(r.id)},children:"Przyspiesz projekt"})]})]});var k,N},Yy=(Ff("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),Ff("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])),Jy=Ff("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),Xy=Ff("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),eg=Ff("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),tg=Ff("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),ng={filterGroup:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},filterBtn:{padding:"0.375rem 0.75rem",borderRadius:"0.375rem",fontSize:"0.875rem",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",border:"1px solid #e5e7eb",cursor:"pointer",position:"relative"},active:{backgroundColor:"#3b82f6",color:"white",border:"1px solid #2563eb"},badge:{position:"absolute",top:"-8px",right:"-8px",minWidth:"20px",height:"20px",borderRadius:"10px",backgroundColor:"#ef4444",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"bold",padding:"0 6px"}},ig=()=>{const{state:e,dispatch:t}=u(),{state:n,showNotification:r}=ff(),{projects:s,accelerateProject:o,sendProjectToMarket:l,applyIllegalMethod:c,advanceProject:d}=$y(),[h,p]=(Fy(),(0,i.useState)(null)),[m,f]=(0,i.useState)("all"),[y,g]=(0,i.useState)("progress"),[v,w]=(0,i.useState)("desc"),x=(0,i.useMemo)((()=>e.projects.filter((e=>"all"===m||("waiting"===m?"development_ready"===e.status:"pv"===m?"PV"===e.technology:"wf"===m?"WF"===e.technology:"development"===m?"in_development"===e.status:"rtb"!==m||"ready_to_build"===e.status)))),[e.projects,m]),b=(0,i.useMemo)((()=>[...x].sort(((e,t)=>{if("progress"===y){const n=e.progress||0,i=t.progress||0;return"asc"===v?n-i:i-n}if("power"===y)return"asc"===v?e.power-t.power:t.power-e.power;if("stage"===y){const n=["land_acquisition","environmental_decision","zoning_conditions","grid_connection","ready_to_build"],i=n.indexOf(e.status),r=n.indexOf(t.status);return"asc"===v?i-r:r-i}if("value"===y){const n=e=>15e4*e.power*({land_acquisition:.15,environmental_decision:.35,zoning_conditions:.55,grid_connection:.85,ready_to_build:1}[e.status]||.1),i=n(e),r=n(t);return"asc"===v?i-r:r-i}return 0}))),[x,y,v]),j=(0,i.useMemo)((()=>{const t={total:e.projects.length,pv:0,wf:0,rtb:0,development:0,totalPower:0,totalEstimatedValue:0};return e.projects.forEach((e=>{"PV"===e.technology&&t.pv++,"WF"===e.technology&&t.wf++,"ready_to_build"===e.status&&t.rtb++,"ready_to_build"!==e.status&&t.development++,t.totalPower+=e.power||0;const n=15e4*e.power;t.totalEstimatedValue+=n*({land_acquisition:.15,environmental_decision:.35,zoning_conditions:.55,grid_connection:.85,ready_to_build:1}[e.status]||.1)})),t}),[e.projects]),k=t=>{const n=e.projects.find((e=>e.id===t));if(!n)return;let i=0;switch(n.status){case"land_acquisition":i=Math.round(5e3*n.size);break;case"environmental_decision":i=Math.max(5e4,1e4*n.power);break;case"zoning_conditions":i=Math.max(3e4,7e3*n.power);break;case"grid_connection":i=Math.max(8e4,15e3*n.power)}const a=window.prompt(`Podaj kwot\u0119 przyspieszenia projektu (sugerowana: ${i.toLocaleString()} PLN):`,i);if(null===a)return;const s=parseInt(a.replace(/\D/g,""),10);if(isNaN(s)||s<=0)return void r("Nieprawid\u0142owa kwota","error");o(t,s)&&r(`Przyspieszono projekt za ${s.toLocaleString()} PLN`,"success")};return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[(0,a.jsx)(Jy,{className:"h-6 w-6 mr-2 text-blue-600"}),"Podsumowanie projekt\xf3w",e.projects.filter((e=>"development_ready"===e.status)).length>0&&(0,a.jsxs)("span",{style:{marginLeft:"0.5rem",padding:"0.25rem 0.5rem",backgroundColor:"#ef4444",color:"white",borderRadius:"0.375rem",fontSize:"0.75rem",fontWeight:"bold"},children:[e.projects.filter((e=>"development_ready"===e.status)).length," projekt(\xf3w) czeka na developera"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-3 mb-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-3 rounded-md",children:[(0,a.jsx)("div",{className:"text-xs text-blue-800",children:"Wszystkie projekty"}),(0,a.jsx)("div",{className:"text-xl font-bold text-blue-900",children:j.total})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 p-3 rounded-md",children:[(0,a.jsx)("div",{className:"text-xs text-yellow-800",children:"Fotowoltaika (PV)"}),(0,a.jsx)("div",{className:"text-xl font-bold text-yellow-900",children:j.pv})]}),(0,a.jsxs)("div",{className:"bg-green-50 p-3 rounded-md",children:[(0,a.jsx)("div",{className:"text-xs text-green-800",children:"Farmy wiatrowe (WF)"}),(0,a.jsx)("div",{className:"text-xl font-bold text-green-900",children:j.wf})]}),(0,a.jsxs)("div",{className:"bg-purple-50 p-3 rounded-md",children:[(0,a.jsx)("div",{className:"text-xs text-purple-800",children:"W developmencie"}),(0,a.jsx)("div",{className:"text-xl font-bold text-purple-900",children:j.development})]}),(0,a.jsxs)("div",{className:"bg-indigo-50 p-3 rounded-md",children:[(0,a.jsx)("div",{className:"text-xs text-indigo-800",children:"Ready-to-Build"}),(0,a.jsx)("div",{className:"text-xl font-bold text-indigo-900",children:j.rtb})]}),(0,a.jsxs)("div",{className:"bg-red-50 p-3 rounded-md",children:[(0,a.jsx)("div",{className:"text-xs text-red-800",children:"Moc ca\u0142kowita"}),(0,a.jsxs)("div",{className:"text-xl font-bold text-red-900",children:[j.totalPower," MW"]})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4 items-center text-sm",children:[(0,a.jsx)("div",{className:"font-medium",children:"Filtruj:"}),(0,a.jsxs)("div",{style:ng.filterGroup,children:[(0,a.jsx)("button",{style:{...ng.filterBtn,..."all"===m?ng.active:{}},onClick:()=>f("all"),children:"Wszystkie"}),(0,a.jsxs)("button",{style:{...ng.filterBtn,..."waiting"===m?ng.active:{}},onClick:()=>f("waiting"),children:["Oczekuj\u0105ce na developera",e.projects.filter((e=>"development_ready"===e.status)).length>0&&(0,a.jsx)("span",{style:ng.badge,children:e.projects.filter((e=>"development_ready"===e.status)).length})]}),(0,a.jsx)("button",{style:{...ng.filterBtn,..."development"===m?ng.active:{}},onClick:()=>f("development"),children:"W rozwoju"}),(0,a.jsx)("button",{style:{...ng.filterBtn,..."rtb"===m?ng.active:{}},onClick:()=>f("rtb"),children:"Gotowe do budowy"})]}),(0,a.jsx)("div",{className:"font-medium ml-4",children:"Sortuj:"}),(0,a.jsxs)("select",{value:y,onChange:e=>g(e.target.value),className:"border rounded px-2 py-1 text-sm",children:[(0,a.jsx)("option",{value:"progress",children:"Post\u0119p"}),(0,a.jsx)("option",{value:"power",children:"Moc (MW)"}),(0,a.jsx)("option",{value:"stage",children:"Etap"}),(0,a.jsx)("option",{value:"value",children:"Warto\u015b\u0107"})]}),(0,a.jsx)("button",{onClick:()=>w("asc"===v?"desc":"asc"),className:"border rounded px-2 py-1 flex items-center",children:"asc"===v?(0,a.jsx)(Xy,{className:"h-4 w-4"}):(0,a.jsx)(eg,{className:"h-4 w-4"})})]}),b.length>0?(0,a.jsx)("div",{className:"space-y-3",children:b.map((e=>(0,a.jsx)(Zy,{project:e,onAdvance:()=>d(e.id),onAccelerate:k,onApplyIllegalMethod:t=>c(e.id,t)},e.id)))}):(0,a.jsxs)("div",{className:"bg-gray-50 p-8 rounded-lg text-center",children:[(0,a.jsx)("div",{className:"text-gray-400 mb-3",children:(0,a.jsx)(tg,{className:"h-10 w-10 mx-auto"})}),(0,a.jsx)("p",{className:"text-gray-600",children:"Brak projekt\xf3w spe\u0142niaj\u0105cych kryteria filtrowania"}),(0,a.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:"Zmie\u0144 filtry lub rozpocznij nowe projekty"})]})]})},rg=e=>{let{title:t,isOpen:n,onClose:r,children:s,variant:o="default"}=e;if(!n)return null;const l=(0,i.useRef)(null),c=e=>{l.current&&!l.current.contains(e.target)&&r()};(0,i.useEffect)((()=>(document.addEventListener("mousedown",c),()=>{document.removeEventListener("mousedown",c)})),[]);return(0,a.jsxs)("div",{ref:l,className:`fixed top-0 right-0 h-full w-96 shadow-lg border-l-4 z-30 transition-all duration-300 ease-in-out ${(()=>{switch(o){case"illegal":return"border-l-red-600 bg-red-50";case"staff":return"border-l-blue-600 bg-blue-50";case"project":return"border-l-green-600 bg-green-50";case"finance":return"border-l-purple-600 bg-purple-50";default:return"border-l-gray-600 bg-gray-50"}})()}`,style:{transform:n?"translateX(0)":"translateX(100%)",overflowY:"auto"},children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,a.jsx)("h2",{className:"text-xl font-bold break-words",children:t}),(0,a.jsx)("button",{onClick:r,className:"p-1 rounded-full hover:bg-gray-200 transition-colors",children:(0,a.jsx)(wy,{size:20})})]}),(0,a.jsx)("div",{className:"p-4 overflow-hidden",children:s})]})},ag=Ff("FileX",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"9.5",x2:"14.5",y1:"12.5",y2:"17.5",key:"izs6du"}],["line",{x1:"14.5",x2:"9.5",y1:"12.5",y2:"17.5",key:"1lehlj"}]]),sg=Ff("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),og=Ff("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]),lg=Ff("ShieldAlert",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]),cg=Ff("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),dg=Ff("ActivitySquare",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M17 12h-2l-2 5-2-10-2 5H7",key:"15hlnc"}]]),ug=e=>{let{onClose:t}=e;const{state:n,dispatch:r}=u(),{state:s,showNotification:o}=ff(),{dispatch:l}=H(),[c,d]=(0,i.useState)(null),[h,p]=(0,i.useState)(null),m=new sy(n,r,s);(0,i.useEffect)((()=>{p(m.getGrayAreaStatus())}),[n.illegals,n.reputationFactors]);const f=[{id:"bribe_officials",name:"Przekupstwo urz\u0119dnik\xf3w",description:"Wykorzystaj \u0142ap\xf3wki, aby przyspieszy\u0107 proces administracyjny i uzyska\u0107 przychylne decyzje.",icon:(0,a.jsx)(Bf,{className:"h-5 w-5 text-yellow-600"}),riskLevel:"high",cost:5e4,reputation:-10,effects:"Przyspiesza proces uzyskiwania decyzji administracyjnych o 40% dla wskazanego projektu.",requirements:"Minimum 100 000 PLN i reputacja > 30",details:"Przekupstwo urz\u0119dnik\xf3w to powszechna praktyka w krajach o wysokim poziomie korupcji. W sektorze OZE mo\u017ce dotyczy\u0107 przyspieszenia wydania decyzji \u015brodowiskowych, warunk\xf3w zabudowy lub przy\u0142\u0105czenia do sieci.",requiredCorruption:10,targetType:"project"},{id:"falsify_documents",name:"Fa\u0142szowanie dokumentacji",description:"Zmodyfikuj dokumentacj\u0119 techniczn\u0105 lub \u015brodowiskow\u0105, aby ukry\u0107 potencjalne problemy.",icon:(0,a.jsx)(ag,{className:"h-5 w-5 text-red-600"}),riskLevel:"extreme",cost:1e5,reputation:-20,effects:"Eliminuje negatywne czynniki techniczne lub \u015brodowiskowe blokuj\u0105ce rozw\xf3j projektu.",requirements:"Konieczne posiadanie nielegalnej bazy danych i reputacja > 50",details:"Fa\u0142szowanie dokumentacji to powa\u017cne przest\u0119pstwo, kt\xf3re mo\u017ce dotyczy\u0107 raport\xf3w oddzia\u0142ywania na \u015brodowisko, bada\u0144 ornitologicznych lub dokumentacji technicznej. Wykrycie mo\u017ce skutkowa\u0107 nie tylko karami finansowymi, ale nawet odpowiedzialno\u015bci\u0105 karn\u0105.",requiredCorruption:30,targetType:"project"},{id:"insider_info",name:"Informacje poufne",description:"Uzyskaj dost\u0119p do poufnych informacji o planach przestrzennych i aukcjach energii.",icon:(0,a.jsx)(uy,{className:"h-5 w-5 text-blue-600"}),riskLevel:"medium",cost:25e3,reputation:-5,effects:"Udost\u0119pnia informacje o najlepszych lokalizacjach i nadchodz\u0105cych aukcjach, zwi\u0119kszaj\u0105c szanse sukcesu.",requirements:"Posiadanie co najmniej jednego lobbysty",details:"Wykorzystanie informacji poufnych to dzia\u0142alno\u015b\u0107 na granicy prawa, kt\xf3ra polega na uzyskiwaniu dost\u0119pu do niepublicznych danych o planach zagospodarowania, przetargach czy zmianach regulacyjnych. Mo\u017ce dawa\u0107 znacz\u0105c\u0105 przewag\u0119 konkurencyjn\u0105.",requiredCorruption:5,targetType:"company"},{id:"intimidate_landowners",name:"Zastraszanie w\u0142a\u015bcicieli grunt\xf3w",description:"Wywieranie presji na w\u0142a\u015bcicieli grunt\xf3w, aby sprzedali ziemi\u0119 po zani\u017conej cenie.",icon:(0,a.jsx)(sg,{className:"h-5 w-5 text-purple-600"}),riskLevel:"high",cost:3e4,reputation:-15,effects:"Obni\u017ca koszty zakupu grunt\xf3w o 30-50%.",requirements:"Reputacja > 40",details:"Zastraszanie w\u0142a\u015bcicieli grunt\xf3w to metoda nieetyczna i nielegalna, stosowana przez nieuczciwych deweloper\xf3w. Polega na wywieraniu presji poprzez gro\u017aby lub wykorzystywanie luk prawnych, aby zmusi\u0107 w\u0142a\u015bcicieli do sprzeda\u017cy po zani\u017conych cenach.",requiredCorruption:20,targetType:"project"},{id:"build_corruption_network",name:"Budowa sieci korupcyjnej",description:"Rozwijaj sie\u0107 kontakt\xf3w w urz\u0119dach i instytucjach kontrolnych, aby u\u0142atwi\u0107 przysz\u0142e dzia\u0142ania.",icon:(0,a.jsx)(og,{className:"h-5 w-5 text-green-600"}),riskLevel:"medium",cost:2e5,reputation:-10,effects:"Zwi\u0119ksza poziom sieci korupcyjnej o 10 punkt\xf3w, obni\u017caj\u0105c koszty przysz\u0142ych nielegalnych dzia\u0142a\u0144.",requirements:"Minimum 200 000 PLN",details:"Budowa sieci korupcyjnej to d\u0142ugofalowa inwestycja w nieformalne kontakty z urz\u0119dnikami, politykami i przedstawicielami instytucji kontrolnych. Im silniejsza sie\u0107, tym \u0142atwiejsze i ta\u0144sze staj\u0105 si\u0119 przysz\u0142e nielegalne dzia\u0142ania.",requiredCorruption:0,targetType:"company"},{id:"sabotage_competitors",name:"Sabota\u017c konkurencji",description:"Zlecenie dzia\u0142a\u0144 sabota\u017cowych przeciwko konkurencyjnym projektom w regionie.",icon:(0,a.jsx)(lg,{className:"h-5 w-5 text-orange-600"}),riskLevel:"extreme",cost:15e4,reputation:-25,effects:"Op\xf3\u017ania projekty konkurencji w regionie o 3-6 miesi\u0119cy.",requirements:"Reputacja > 60 i poziom sieci korupcyjnej > 30",details:"Sabota\u017c konkurencji to bezpo\u015brednie dzia\u0142ania wymierzone w projekty konkurencyjnych firm. Mo\u017ce obejmowa\u0107 manipulowanie konsultacjami spo\u0142ecznymi, sztuczne wywo\u0142ywanie protest\xf3w lub nawet fizyczne uszkodzenia infrastruktury. Niesie wysokie ryzyko wykrycia i powa\u017cnych konsekwencji prawnych.",requiredCorruption:40,targetType:"region"},{id:"create_illegal_database",name:"Stw\xf3rz nielegaln\u0105 baz\u0119 danych",description:"Zlecenie stworzenia bazy danych zawieraj\u0105cej poufne informacje o urz\u0119dnikach, planach i procedurach.",icon:(0,a.jsx)(cg,{className:"h-5 w-5 text-gray-600"}),riskLevel:"low",cost:75e3,reputation:-5,effects:"Odblokowuje dodatkowe nielegalne akcje i zwi\u0119ksza skuteczno\u015b\u0107 istniej\u0105cych o 20%.",requirements:"Minimum 75 000 PLN",details:"Nielegalna baza danych to zbi\xf3r poufnych informacji o urz\u0119dnikach, procedurach i lukach prawnych. Jej posiadanie umo\u017cliwia bardziej precyzyjne planowanie nielegalnych dzia\u0142a\u0144 i zwi\u0119ksza ich skuteczno\u015b\u0107. Pozyskanie takich danych wymaga zaanga\u017cowania os\xf3b z dost\u0119pem do poufnych informacji.",requiredCorruption:0,targetType:"company"}],y=e=>!(e.requirements.includes("minimum")&&n.cash<e.cost)&&(!(e.requirements.includes("reputacja")&&n.reputation<parseInt(e.requirements.match(/reputacja > (\d+)/)[1]))&&(!(e.requiredCorruption>n.illegals.corruptionNetwork)&&(!("falsify_documents"===e.id&&!n.illegals.hasIllegalDatabase)&&(("insider_info"!==e.id||0!==n.staff.lobbyists.length)&&("create_illegal_database"!==e.id||!n.illegals.hasIllegalDatabase))))),g=e=>{switch(e){case"low":return(0,a.jsx)("span",{className:"text-green-600 font-medium",children:"Niskie"});case"medium":return(0,a.jsx)("span",{className:"text-yellow-600 font-medium",children:"\u015arednie"});case"high":return(0,a.jsx)("span",{className:"text-orange-600 font-medium",children:"Wysokie"});case"extreme":return(0,a.jsx)("span",{className:"text-red-600 font-medium",children:"Ekstremalne"});default:return(0,a.jsx)("span",{className:"text-gray-600",children:"Nieznane"})}},v=e=>{const t=y(e);return(0,a.jsxs)("div",{className:"border rounded-lg p-4 mb-4 hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"flex items-start mb-2",children:[(0,a.jsx)("div",{className:"mr-3",children:e.icon}),(0,a.jsxs)("div",{className:"flex-grow",children:[(0,a.jsx)("h3",{className:"font-bold text-gray-800",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]}),(0,a.jsxs)("div",{className:"ml-2 text-right",children:[(0,a.jsxs)("div",{className:"text-sm mb-1",children:["Ryzyko: ",g(e.riskLevel)]}),(0,a.jsxs)("div",{className:"text-sm",children:["Koszt: ",(0,a.jsxs)("span",{className:"font-medium",children:[e.cost.toLocaleString()," PLN"]})]})]})]}),(0,a.jsxs)("div",{className:"mt-2 space-y-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Efekt:"})," ",e.effects]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Wymagania:"})," ",e.requirements]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Wp\u0142yw na reputacj\u0119:"})," ",(0,a.jsx)("span",{className:"text-red-600",children:e.reputation})]})]}),(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)(fy,{onClick:()=>(e=>{if(!y(e))return void o("Nie mo\u017cesz wykona\u0107 tej akcji - nie spe\u0142niasz wymaga\u0144!","error");if(n.cash<e.cost)return void o(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w (potrzeba ${e.cost.toLocaleString()} PLN)`,"error");const t=m.executeIllegalAction(e.id,{cost:e.cost,target:e.targetType,riskIncrease:"extreme"===e.riskLevel?20:"high"===e.riskLevel?15:"medium"===e.riskLevel?10:5});if(t.success){switch(e.id){case"create_illegal_database":r({type:"UPDATE_ILLEGAL_DATABASE",payload:{hasIllegalDatabase:!0}}),l({type:"ADD_EVENT",payload:{id:Date.now(),type:"illegal_activity",title:"Stworzenie nielegalnej bazy danych",description:"Stworzy\u0142e\u015b nielegaln\u0105 baz\u0119 danych, kt\xf3ra umo\u017cliwi Ci bardziej skuteczne planowanie nielegalnych dzia\u0142a\u0144.",severity:"warning",turn:s.turn,expires:s.turn+10}}),o("Stworzy\u0142e\u015b nielegaln\u0105 baz\u0119 danych!","success");break;case"build_corruption_network":l({type:"ADD_EVENT",payload:{id:Date.now(),type:"illegal_activity",title:"Rozbudowa sieci korupcyjnej",description:"Rozwin\u0105\u0142e\u015b swoj\u0105 sie\u0107 kontakt\xf3w korupcyjnych, co u\u0142atwi Ci przysz\u0142e nielegalne dzia\u0142ania.",severity:"warning",turn:s.turn,expires:s.turn+15}}),o("Rozbudowa\u0142e\u015b swoj\u0105 sie\u0107 korupcyjn\u0105!","success");break;default:d(e)}p(m.getGrayAreaStatus()),t.detected&&(o(t.consequences,"warning"),l({type:"ADD_EVENT",payload:{id:Date.now(),type:"scandal",title:`Wykryto nielegalne dzia\u0142anie: ${e.name}`,description:"Twoje nielegalne dzia\u0142anie zosta\u0142o wykryte, co znacz\u0105co wp\u0142yn\u0119\u0142o na reputacj\u0119 firmy.",severity:"danger",turn:s.turn,expires:s.turn+20}}))}else o(t.reason,"error")})(e),disabled:!t,variant:t?"warning":"disabled",className:"w-full",icon:(0,a.jsx)(Kf,{className:"h-4 w-4"}),children:t?"Wykonaj akcj\u0119":"Niedost\u0119pne"})})]})};return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)(Kf,{className:"h-6 w-6 text-red-600 mr-2"}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Szara strefa"})]}),(0,a.jsx)("div",{className:"bg-red-100 border border-red-300 rounded-lg p-3 mb-4",children:(0,a.jsxs)("p",{className:"text-red-800 text-sm",children:[(0,a.jsx)("strong",{children:"UWAGA:"})," Dzia\u0142ania w szarej strefie s\u0105 nielegalne i wi\u0105\u017c\u0105 si\u0119 z ryzykiem. Wykrycie mo\u017ce skutkowa\u0107 karami finansowymi, utrat\u0105 reputacji, a nawet zako\u0144czeniem gry."]})}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"Tw\xf3j status:"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{className:"bg-white rounded p-2 shadow-sm",children:[(0,a.jsx)("div",{className:"text-gray-600 text-sm",children:"Sie\u0107 korupcyjna:"}),(0,a.jsxs)("div",{className:"font-medium",children:[n.illegals.corruptionNetwork,"/100"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded p-2 shadow-sm",children:[(0,a.jsx)("div",{className:"text-gray-600 text-sm",children:"Ryzyko audytu:"}),(0,a.jsxs)("div",{className:"font-medium",children:[(null===h||void 0===h?void 0:h.auditRisk)||n.illegals.auditRisk,"%"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded p-2 shadow-sm",children:[(0,a.jsx)("div",{className:"text-gray-600 text-sm",children:"Baza danych:"}),(0,a.jsx)("div",{className:"font-medium",children:n.illegals.hasIllegalDatabase?"Posiadasz":"Brak"})]}),(0,a.jsxs)("div",{className:"bg-white rounded p-2 shadow-sm",children:[(0,a.jsx)("div",{className:"text-gray-600 text-sm",children:"\u0141ap\xf3wki wydane:"}),(0,a.jsxs)("div",{className:"font-medium",children:[n.illegals.totalBribes.toLocaleString()," PLN"]})]})]})]}),n.reputationFactors&&(0,a.jsxs)("div",{className:"mb-4 bg-gray-50 p-3 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"font-bold",children:"Poziom aktywno\u015bci w szarej strefie:"}),(e=>{let t,n,i;return e<=.7?(t="bg-green-100 text-green-800",n=(0,a.jsx)(ry,{className:"h-4 w-4 text-green-600"}),i="Niski"):e<=1?(t="bg-blue-100 text-blue-800",n=(0,a.jsx)(dg,{className:"h-4 w-4 text-blue-600"}),i="Normalny"):e<=1.3?(t="bg-yellow-100 text-yellow-800",n=(0,a.jsx)(iy,{className:"h-4 w-4 text-yellow-600"}),i="Podwy\u017cszony"):(t="bg-red-100 text-red-800",n=(0,a.jsx)(Kf,{className:"h-4 w-4 text-red-600"}),i="Wysoki"),(0,a.jsxs)("div",{className:`flex items-center ${t} px-2 py-1 rounded`,children:[n,(0,a.jsx)("span",{className:"ml-1 text-sm font-medium",children:i})]})})(n.reputationFactors.grayAreaActivity)]}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full "+(n.reputationFactors.grayAreaActivity<=.7?"bg-green-500":n.reputationFactors.grayAreaActivity<=1?"bg-blue-500":n.reputationFactors.grayAreaActivity<=1.3?"bg-yellow-500":"bg-red-500"),style:{width:`${Math.min(100,50*n.reputationFactors.grayAreaActivity)}%`}})})}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Wysoki poziom aktywno\u015bci w szarej strefie zwi\u0119ksza ryzyko audytu i kontroli."})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"Dost\u0119pne akcje:"}),(0,a.jsx)("div",{className:"space-y-3",children:f.map((e=>v(e)))})]}),n.illegals.illegalActionHistory&&n.illegals.illegalActionHistory.length>0&&(0,a.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"Historia dzia\u0142a\u0144:"}),(0,a.jsx)("div",{className:"space-y-2",children:n.illegals.illegalActionHistory.slice(-5).reverse().map(((e,t)=>(0,a.jsxs)("div",{className:`p-2 rounded ${e.exposed?"bg-red-100":"bg-white"} text-sm border`,children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:m.getActionName(e.type)}),(0,a.jsx)("span",{className:"text-gray-500",children:new Date(e.date).toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"flex justify-between mt-1",children:[(0,a.jsxs)("span",{className:"text-gray-500",children:["Koszt: ",e.cost.toLocaleString()," PLN"]}),e.exposed&&(0,a.jsx)("span",{className:"text-red-600",children:"Wykryte"})]})]},t)))})]})]})},hg=Ff("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),pg=Ff("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),mg=Ff("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),fg=e=>{var t,n,i,r,s;let{staffId:o,staffType:l,onClose:c,onFire:d,onTrain:h,onAssign:p}=e;const{state:m}=u(),{state:f}=ff(),y=l.endsWith("s")?l:`${l}s`,g=null===(t=m.staff[y])||void 0===t?void 0:t.find((e=>e.id===o));if(!g)return(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("div",{className:"bg-red-100 p-4 rounded",children:(0,a.jsx)("p",{className:"text-red-800",children:"Nie znaleziono pracownika."})}),(0,a.jsx)(fy,{onClick:c,className:"mt-4",children:"Zamknij"})]});const v=e=>`${e.toLocaleString()} PLN / mies.`,w=m.projects.find((e=>e.id===g.assignedProject)),x=(null===(n=g.traits)||void 0===n?void 0:n.filter((e=>e.effect>0)))||[],b=(null===(i=g.traits)||void 0===i?void 0:i.filter((e=>e.effect<0)))||[],j=(null===(r=g.traits)||void 0===r?void 0:r.filter((e=>0===e.effect)))||[],k=e=>(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:(e.effect>0?"text-green-600":e.effect<0?"text-red-600":"text-gray-600")+" font-medium mr-2",children:e.name}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:e.description})]},e.name);return(0,a.jsxs)("div",{className:"overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center mr-4",children:(0,a.jsx)(hg,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:g.name}),(0,a.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,a.jsx)(Jy,{className:"h-4 w-4 mr-1"}),(0,a.jsxs)("span",{children:[Dy(l)," (",Ry(g.level),")"]})]})]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("h3",{className:"font-bold text-lg mb-2 flex items-center",children:[(0,a.jsx)(pg,{className:"h-5 w-5 mr-2 text-purple-600"}),"Umiej\u0119tno\u015bci i rozw\xf3j"]}),(0,a.jsxs)("div",{className:"bg-white rounded shadow p-4",children:[(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)("span",{className:"text-gray-700",children:"Poziom umiej\u0119tno\u015bci:"}),(0,a.jsxs)("span",{className:"font-medium",children:[g.skill,"/10"]})]}),(0,a.jsx)(Gy,{value:10*g.skill,max:100,colorClass:"bg-purple-500"})]}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)("span",{className:"text-gray-700",children:"Do\u015bwiadczenie:"}),(0,a.jsxs)("span",{className:"font-medium",children:[g.experience," pkt"]})]}),(0,a.jsx)(Gy,{value:g.experience%100,max:100,colorClass:"bg-blue-500"}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:["Do awansu: ",100-g.experience%100," pkt"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-700 mb-1",children:"Specjalizacja:"}),(0,a.jsx)("div",{className:"font-medium",children:g.specialization||"Brak"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-700 mb-1",children:"Odbyte szkolenia:"}),(0,a.jsx)("div",{className:"font-medium",children:(null===(s=g.training)||void 0===s?void 0:s.length)||0})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,a.jsx)(fy,{onClick:()=>h(o,l),variant:"primary",className:"flex-1",icon:(0,a.jsx)(iy,{className:"h-4 w-4"}),children:"Trenuj"}),(0,a.jsx)(fy,{onClick:()=>p(o,l),variant:"secondary",className:"flex-1",icon:(0,a.jsx)(Jy,{className:"h-4 w-4"}),children:"Przydziel do projektu"})]})]}),g.traits&&g.traits.length>0&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-2",children:"Cechy charakteru"}),(0,a.jsxs)("div",{className:"bg-white rounded shadow p-4",children:[x.length>0&&(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("h4",{className:"font-medium text-green-600 mb-1",children:"Pozytywne:"}),(0,a.jsx)("div",{className:"space-y-1",children:x.map(k)})]}),j.length>0&&(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-600 mb-1",children:"Neutralne:"}),(0,a.jsx)("div",{className:"space-y-1",children:j.map(k)})]}),b.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-red-600 mb-1",children:"Negatywne:"}),(0,a.jsx)("div",{className:"space-y-1",children:b.map(k)})]})]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("h3",{className:"font-bold text-lg mb-2 flex items-center",children:[(0,a.jsx)(Vf,{className:"h-5 w-5 mr-2 text-blue-600"}),"Historia zatrudnienia"]}),(0,a.jsxs)("div",{className:"bg-white rounded shadow p-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-700 mb-1",children:"Data zatrudnienia:"}),(0,a.jsx)("div",{className:"font-medium",children:(_=g.hiredOn,new Date(_).toLocaleDateString("pl-PL"))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-700 mb-1",children:"Czas zatrudnienia:"}),(0,a.jsx)("div",{className:"font-medium",children:(()=>{const e=new Date(g.hiredOn),t=new Date,n=Math.abs(t-e),i=Math.ceil(n/864e5);return`${i} dni (${Math.floor(i/30)} miesi\u0119cy)`})()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-700 mb-1",children:"Wynagrodzenie:"}),(0,a.jsx)("div",{className:"font-medium",children:v(g.salary)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-700 mb-1",children:"Koszt zatrudnienia:"}),(0,a.jsx)("div",{className:"font-medium",children:v(g.hiringCost||0)})]})]}),w&&(0,a.jsxs)("div",{className:"mt-3 p-2 bg-blue-50 rounded",children:[(0,a.jsx)("div",{className:"text-blue-800 font-medium",children:"Przypisany do projektu:"}),(0,a.jsxs)("div",{children:[w.name," (",w.technology,")"]})]})]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("h3",{className:"font-bold text-lg mb-2 flex items-center",children:[(0,a.jsx)(mg,{className:"h-5 w-5 mr-2 text-red-600"}),"Status"]}),(0,a.jsx)("div",{className:"bg-white rounded shadow p-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)("span",{children:"Morale:"}),(0,a.jsxs)("span",{className:(z=g.morale,z>=80?"text-green-600":z>=50?"text-blue-600":z>=30?"text-yellow-600":"text-red-600"),children:[g.morale,"%"]})]}),(0,a.jsx)(Gy,{value:g.morale,max:100,colorClass:g.morale>=50?"bg-green-500":"bg-red-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)("span",{children:"Energia:"}),(0,a.jsxs)("span",{className:(N=g.energy,N>=80?"text-green-600":N>=50?"text-blue-600":N>=30?"text-yellow-600":"text-red-600"),children:[g.energy,"%"]})]}),(0,a.jsx)(Gy,{value:g.energy,max:100,colorClass:g.energy>=50?"bg-blue-500":"bg-orange-500"})]})]})})]}),(0,a.jsxs)("div",{className:"mt-6 flex justify-between",children:[(0,a.jsx)(fy,{onClick:()=>d(o,l),variant:"danger",icon:(0,a.jsx)(sg,{className:"h-4 w-4"}),children:"Zwolnij pracownika"}),(0,a.jsx)(fy,{onClick:c,variant:"secondary",children:"Zamknij"})]})]});var N,z,_},yg=e=>{let{onClose:t}=e;const{state:n,dispatch:r}=u(),{state:s,showNotification:o}=ff(),[l,c]=(0,i.useState)(null),[d,h]=(0,i.useState)(1e6),[p,m]=(0,i.useState)(12),f=(0,i.useRef)(null),y=e=>{f.current&&!f.current.contains(e.target)&&t()};(0,i.useEffect)((()=>(document.addEventListener("mousedown",y),()=>{document.removeEventListener("mousedown",y)})),[]);const g=e=>!(e.requiresProjects>0&&n.projects.length<e.requiresProjects)&&(!(e.requiresReputation>0&&n.reputation<e.requiresReputation)&&(!(e.requiresRTB&&!n.projects.some((e=>"ready_to_build"===e.status)))&&!(e.requiresCorruption&&n.illegals.corruptionNetwork<e.requiresCorruption))),v=e=>{let t=e.baseInterestRate;e.reputationBonus&&n.reputation>80&&(t-=.01);const i=n.projects.filter((e=>"ready_to_build"===e.status)).length;return i>0&&(t-=.005*i),Math.max(.05,t)},w=(e,t,n)=>{const i=t/12;return e*i/(1-Math.pow(1+i,-n))},x=e=>e.toLocaleString()+" PLN",b=e=>(100*e).toFixed(2)+"%";return(0,a.jsxs)("div",{ref:f,children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)(Hy,{className:"h-6 w-6 text-green-600 mr-2"}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Panel finansowy"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,a.jsx)("h3",{className:"font-bold mb-3",children:"Twoje finanse"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-600 text-sm",children:"Got\xf3wka:"}),(0,a.jsx)("div",{className:"font-bold text-lg text-green-700",children:x(n.cash)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-600 text-sm",children:"Warto\u015b\u0107 projekt\xf3w:"}),(0,a.jsx)("div",{className:"font-bold text-lg",children:x(n.economicMetrics.projectsValue||0)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-600 text-sm",children:"Przychody:"}),(0,a.jsx)("div",{className:"font-bold text-green-700",children:x(n.economicMetrics.totalRevenue||0)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-600 text-sm",children:"Wydatki:"}),(0,a.jsx)("div",{className:"font-bold text-red-700",children:x(n.economicMetrics.totalExpenses||0)})]})]})]}),n.loans&&n.loans.length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,a.jsx)("h3",{className:"font-bold mb-3",children:"Aktywne kredyty"}),n.loans.map((e=>(0,a.jsxs)("div",{className:"border-b pb-3 mb-3 last:border-0 last:mb-0 last:pb-0",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,a.jsx)("span",{className:"font-medium",children:e.bankName}),(0,a.jsx)("span",{className:"text-blue-600",children:x(e.remainingAmount)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Rata miesi\u0119czna:"}),(0,a.jsx)("span",{className:"ml-1",children:x(e.monthlyPayment)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Oprocentowanie:"}),(0,a.jsx)("span",{className:"ml-1",children:b(e.interestRate)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Pozosta\u0142o rat:"}),(0,a.jsx)("span",{className:"ml-1",children:e.remainingTerm})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Nast\u0119pna p\u0142atno\u015b\u0107:"}),(0,a.jsxs)("span",{className:"ml-1",children:["Tura ",e.nextPaymentTurn]})]})]}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs mb-1",children:[(0,a.jsx)("span",{children:"Sp\u0142acono"}),(0,a.jsxs)("span",{children:[Math.round(100*(1-e.remainingAmount/e.amount)),"%"]})]}),(0,a.jsx)(Gy,{value:e.amount-e.remainingAmount,max:e.amount,colorClass:"bg-green-500"})]})]},e.id)))]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,a.jsx)("h3",{className:"font-bold mb-3",children:"Zaci\u0105gnij kredyt"}),l?(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)(vy,{className:"h-5 w-5 text-blue-600 mr-2"}),(0,a.jsx)("h4",{className:"font-bold text-blue-800 break-words",children:l.name})]}),(0,a.jsx)("p",{className:"text-sm text-gray-700 break-words",children:l.description})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-1",children:"Kwota kredytu"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"range",min:1e5,max:l.maxLoan,step:1e5,value:d,onChange:e=>h(parseInt(e.target.value)),className:"flex-grow mr-3"}),(0,a.jsx)("span",{className:"font-medium w-32 text-right",children:x(d)})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-1",children:"Okres sp\u0142aty (miesi\u0105ce)"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"range",min:3,max:36,step:3,value:p,onChange:e=>m(parseInt(e.target.value)),className:"flex-grow mr-3"}),(0,a.jsxs)("span",{className:"font-medium w-32 text-right",children:[p," mies."]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-3 rounded mb-4",children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Podsumowanie kredytu"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{className:"text-sm overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Kwota kredytu:"}),(0,a.jsx)("span",{className:"ml-1 font-medium whitespace-nowrap",children:x(d)})]}),(0,a.jsxs)("div",{className:"text-sm overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Okres sp\u0142aty:"}),(0,a.jsxs)("span",{className:"ml-1 font-medium whitespace-nowrap",children:[p," miesi\u0119cy"]})]}),(0,a.jsxs)("div",{className:"text-sm overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Oprocentowanie:"}),(0,a.jsx)("span",{className:"ml-1 font-medium whitespace-nowrap",children:b(v(l))})]}),(0,a.jsxs)("div",{className:"text-sm overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Rata miesi\u0119czna:"}),(0,a.jsx)("span",{className:"ml-1 font-medium whitespace-nowrap",children:x(w(d,v(l),p))})]}),(0,a.jsxs)("div",{className:"text-sm col-span-2 overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Ca\u0142kowity koszt kredytu:"}),(0,a.jsx)("span",{className:"ml-1 font-medium text-red-600 whitespace-nowrap",children:x(w(d,v(l),p)*p-d)})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(fy,{onClick:()=>{if(!l)return void o("Wybierz bank, aby zaci\u0105gn\u0105\u0107 kredyt","error");if(!g(l))return void o("Nie spe\u0142niasz wymaga\u0144 tego banku","error");if(d>l.maxLoan)return void o(`Maksymalna kwota kredytu to ${l.maxLoan.toLocaleString()} PLN`,"error");if(n.loans&&n.loans.length>0)return void o("Mo\u017cesz mie\u0107 tylko jeden aktywny kredyt","error");const e=v(l),t=w(d,e,p),i=t*p,a=i-d;r({type:"ADD_LOAN",payload:{id:Date.now(),bankId:l.id,bankName:l.name,amount:d,remainingAmount:d,interestRate:e,term:p,remainingTerm:p,monthlyPayment:t,totalInterest:a,totalPayment:i,takenOnTurn:s.turn,nextPaymentTurn:s.turn+1}}),r({type:"UPDATE_CASH",payload:d}),r({type:"UPDATE_ECONOMIC_METRICS",payload:{totalLoansTaken:(n.economicMetrics.totalLoansTaken||0)+d}}),l.reputationPenalty&&r({type:"UPDATE_REPUTATION",payload:{change:-l.reputationPenalty,reason:`Zaci\u0105gni\u0119cie kredytu w ${l.name}`,turn:s.turn}}),o(`Zaci\u0105gni\u0119to kredyt na kwot\u0119 ${d.toLocaleString()} PLN`,"success"),c(null)},variant:"success",className:"flex-1",icon:(0,a.jsx)(Ty,{className:"h-4 w-4"}),children:"Zaci\u0105gnij kredyt"}),(0,a.jsx)(fy,{onClick:()=>c(null),variant:"secondary",className:"flex-1",children:"Anuluj"})]})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-700 mb-4",children:"Wybierz bank, aby zaci\u0105gn\u0105\u0107 kredyt:"}),(0,a.jsx)("div",{className:"space-y-3",children:[{id:"eco_bank",name:"EcoBank",description:"Bank specjalizuj\u0105cy si\u0119 w finansowaniu projekt\xf3w OZE",maxLoan:5e6,baseInterestRate:.08,reputationBonus:!0,requirementsDescription:"Wymaga min. 3 projekt\xf3w i reputacji > 70",requiresProjects:3,requiresReputation:70},{id:"investment_bank",name:"InvestBank",description:"Du\u017cy bank komercyjny z programem dla projekt\xf3w energetycznych",maxLoan:1e7,baseInterestRate:.095,reputationBonus:!0,requirementsDescription:"Wymaga min. 5 projekt\xf3w i reputacji > 50, lub projektu RTB",requiresProjects:5,requiresReputation:50,requiresRTB:!0},{id:"small_bank",name:"LocalBank",description:"Mniejszy bank lokalny, mniej wymagaj\u0105cy, ale dro\u017csza oferta",maxLoan:2e6,baseInterestRate:.12,reputationBonus:!1,requirementsDescription:"Brak szczeg\xf3lnych wymaga\u0144",requiresProjects:0,requiresReputation:0},{id:"shadow_bank",name:"ShadowFinance",description:"Nieoficjalne \u017ar\xf3d\u0142o finansowania, wysokie odsetki, brak formalno\u015bci",maxLoan:15e5,baseInterestRate:.25,reputationBonus:!1,reputationPenalty:5,requirementsDescription:"Wymaga poziomu sieci korupcyjnej > 20",requiresCorruption:20}].map((e=>{const t=g(e),n=v(e);return(0,a.jsx)("div",{className:"border rounded-lg p-4 mb-4 hover:shadow-md transition-shadow "+((null===l||void 0===l?void 0:l.id)===e.id?"border-blue-500 bg-blue-50":""),onClick:()=>t&&c(e),children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"mr-3",children:(0,a.jsx)(vy,{className:"h-6 w-6 "+(t?"text-blue-600":"text-gray-400")})}),(0,a.jsxs)("div",{className:"flex-grow overflow-hidden",children:[(0,a.jsx)("h3",{className:`font-bold ${t?"text-gray-800":"text-gray-500"} text-ellipsis overflow-hidden`,children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600 break-words",children:e.description}),(0,a.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[(0,a.jsxs)("div",{className:"overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Max kredyt:"}),(0,a.jsx)("span",{className:"ml-1 font-medium whitespace-nowrap",children:x(e.maxLoan)})]}),(0,a.jsxs)("div",{className:"overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Oprocentowanie:"}),(0,a.jsx)("span",{className:`ml-1 font-medium ${n>.15?"text-red-600":"text-blue-600"} whitespace-nowrap`,children:b(n)})]})]}),(0,a.jsxs)("div",{className:"mt-1 text-sm overflow-hidden",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Wymagania:"}),(0,a.jsx)("span",{className:`ml-1 ${t?"text-green-600":"text-red-600"} break-words`,children:t?"Spe\u0142nione":e.requirementsDescription})]})]})]})},e.id)}))})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,a.jsxs)("h3",{className:"font-bold mb-3 flex items-center",children:[(0,a.jsx)(Qf,{className:"h-5 w-5 mr-2 text-purple-600"}),"Statystyki finansowe"]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between p-2 bg-gray-50 rounded",children:[(0,a.jsx)("span",{className:"text-gray-700",children:"\u0141\u0105czne inwestycje:"}),(0,a.jsx)("span",{className:"font-medium",children:x(n.economicMetrics.totalInvestment||0)})]}),(0,a.jsxs)("div",{className:"flex justify-between p-2 bg-gray-50 rounded",children:[(0,a.jsx)("span",{className:"text-gray-700",children:"\u0141\u0105czne kredyty:"}),(0,a.jsx)("span",{className:"font-medium",children:x(n.economicMetrics.totalLoansTaken||0)})]}),(0,a.jsxs)("div",{className:"flex justify-between p-2 bg-gray-50 rounded",children:[(0,a.jsx)("span",{className:"text-gray-700",children:"\u015aredni ROI:"}),(0,a.jsxs)("span",{className:"font-medium "+((n.economicMetrics.avgROI||0)>0?"text-green-600":"text-red-600"),children:[(100*(n.economicMetrics.avgROI||0)).toFixed(1),"%"]})]}),(0,a.jsxs)("div",{className:"flex justify-between p-2 bg-gray-50 rounded",children:[(0,a.jsx)("span",{className:"text-gray-700",children:"Bilans:"}),(0,a.jsx)("span",{className:"font-medium "+((n.economicMetrics.totalRevenue||0)>(n.economicMetrics.totalExpenses||0)?"text-green-600":"text-red-600"),children:x((n.economicMetrics.totalRevenue||0)-(n.economicMetrics.totalExpenses||0))})]})]})]})]})},gg=Ff("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),vg=Ff("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),wg=e=>{var t;let{staffManagement:n,gameState:r,playerState:s}=e;const[o,l]=(0,i.useState)(null),[c,d]=(0,i.useState)("junior"),[u,h]=(0,i.useState)(""),[p,m]=(0,i.useState)("all"),f=[{id:"scouts",name:"Skauci",icon:(0,a.jsx)(Gf,{className:"h-4 w-4"}),description:"Zajmuj\u0105 si\u0119 pozyskiwaniem grunt\xf3w pod projekty OZE. Niezb\u0119dni do rozpocz\u0119cia nowych projekt\xf3w."},{id:"developers",name:"Developerzy",icon:(0,a.jsx)(Jy,{className:"h-4 w-4"}),description:"Prowadz\u0105 projekty OZE od pozyskanej ziemi do RTB. Ka\u017cdy developer mo\u017ce prowadzi\u0107 maksymalnie 5 projekt\xf3w."},{id:"lawyers",name:"Prawnicy",icon:(0,a.jsx)(py,{className:"h-4 w-4"}),description:"Specjalizuj\u0105 si\u0119 w kwestiach prawnych i pozwoleniach. Przyspieszaj\u0105 rozw\xf3j wszystkich projekt\xf3w."},{id:"envSpecialists",name:"Specjali\u015bci ds. \u015brodowiska",icon:(0,a.jsx)(py,{className:"h-4 w-4"}),description:"Eksperci od ocen oddzia\u0142ywania na \u015brodowisko. Przyspieszaj\u0105 rozw\xf3j wszystkich projekt\xf3w."},{id:"lobbyists",name:"Lobby\u015bci",icon:(0,a.jsx)(py,{className:"h-4 w-4"}),description:"Pomagaj\u0105 uzyska\u0107 przychylno\u015b\u0107 w\u0142adz lokalnych i krajowych. Mog\u0105 by\u0107 r\u0119cznie przypisywani do projekt\xf3w dla dodatkowego przyspieszenia."}],y=[{id:"junior",name:"Junior",cost:1,description:"Pocz\u0105tkuj\u0105cy specjali\u015bci z podstawowymi umiej\u0119tno\u015bciami. Ta\u0144si, ale mniej efektywni."},{id:"mid",name:"Mid",cost:1.5,description:"Specjali\u015bci ze \u015brednim do\u015bwiadczeniem. Dobry balans mi\u0119dzy kosztem a efektywno\u015bci\u0105."},{id:"senior",name:"Senior",cost:2.5,description:"Eksperci z wieloletnim do\u015bwiadczeniem. Drodzy, ale bardzo efektywni."}],g=()=>f.filter((e=>{if("all"!==p&&e.id!==p)return!1;if(u){const t=u.toLowerCase();return e.name.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)}return!0})),v=(e,t)=>{const n={scout:15e3,developer:25e3,lawyer:3e4,envSpecialist:2e4,lobbyist:4e4}[e.endsWith("s")?e.slice(0,-1):e]||2e4,i={junior:1,mid:1.5,senior:2.2}[t]||1;return Math.round(n*i)},w=(e,t)=>s.cash>=v(e,t);return(0,a.jsxs)("div",{className:"employment-center",children:[(0,a.jsxs)("div",{className:"employment-header",children:[(0,a.jsx)("h2",{children:"Centrum Zatrudnienia"}),(0,a.jsx)("p",{children:"Zatrudnij nowych pracownik\xf3w, aby rozwija\u0107 projekty OZE. Ka\u017cdy typ specjalisty ma swoj\u0105 rol\u0119 w procesie rozwoju projekt\xf3w."})]}),(0,a.jsxs)("div",{className:"employment-filters",children:[(0,a.jsxs)("div",{className:"filter-group",children:[(0,a.jsxs)("div",{className:"filter-label",children:[(0,a.jsx)(gg,{className:"h-4 w-4 mr-1"}),(0,a.jsx)("span",{children:"Filtruj:"})]}),(0,a.jsxs)("select",{value:p,onChange:e=>m(e.target.value),className:"filter-select",children:[(0,a.jsx)("option",{value:"all",children:"Wszyscy specjali\u015bci"}),f.map((e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,a.jsxs)("div",{className:"search-group",children:[(0,a.jsx)(vg,{className:"search-icon"}),(0,a.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),placeholder:"Szukaj specjalist\xf3w...",className:"search-input"})]})]}),(0,a.jsxs)("div",{className:"staff-types-grid",children:[g().map((e=>{var t;e.id.endsWith("s")?e.id.slice(0,-1):e.id;const n=o===e.id;return(0,a.jsxs)("div",{className:"staff-type-card "+(n?"selected":""),onClick:()=>l(e.id),children:[(0,a.jsx)("div",{className:"staff-type-icon",children:e.icon}),(0,a.jsxs)("div",{className:"staff-type-content",children:[(0,a.jsx)("h3",{children:e.name}),(0,a.jsx)("p",{children:e.description})]}),(0,a.jsxs)("div",{className:"staff-current-count",children:[(0,a.jsx)(hg,{className:"h-4 w-4 mr-1"}),(0,a.jsxs)("span",{children:[(null===(t=s.staff[e.id])||void 0===t?void 0:t.length)||0," zatrudnionych"]})]})]},e.id)})),0===g().length&&(0,a.jsx)("div",{className:"no-results",children:(0,a.jsx)("p",{children:"Nie znaleziono specjalist\xf3w spe\u0142niaj\u0105cych kryteria wyszukiwania."})})]}),o&&(0,a.jsxs)("div",{className:"hiring-panel",children:[(0,a.jsxs)("h3",{children:["Zatrudnij: ",Dy(o)]}),(0,a.jsxs)("div",{className:"level-selection",children:[(0,a.jsx)("div",{className:"level-options",children:y.map((e=>(0,a.jsx)("button",{className:"level-option "+(c===e.id?"selected":""),onClick:()=>d(e.id),children:e.name},e.id)))}),(0,a.jsx)("div",{className:"level-description",children:(0,a.jsx)("p",{children:null===(t=y.find((e=>e.id===c)))||void 0===t?void 0:t.description})})]}),(0,a.jsxs)("div",{className:"hiring-costs",children:[(0,a.jsxs)("div",{className:"cost-item",children:[(0,a.jsx)("span",{children:"Koszt zatrudnienia:"}),(0,a.jsxs)("span",{className:"cost-value",children:[v(o,c).toLocaleString()," PLN"]})]}),(0,a.jsxs)("div",{className:"cost-item",children:[(0,a.jsx)("span",{children:"Miesi\u0119czne wynagrodzenie:"}),(0,a.jsxs)("span",{className:"cost-value",children:[(x=o,b=c,Math.round(.04*v(x,b))).toLocaleString()," PLN"]})]})]}),(0,a.jsxs)("div",{className:"hiring-actions",children:[(0,a.jsx)("button",{className:"cancel-btn",onClick:()=>l(null),children:"Anuluj"}),(0,a.jsx)("button",{className:"hire-btn",disabled:!w(o,c),onClick:()=>{if(!o||!c)return;const e=o.endsWith("s")?o.slice(0,-1):o;n.hireStaff(e,c),l(null)},children:w(o,c)?"Zatrudnij":"Brak \u015brodk\xf3w"})]})]})]});var x,b},xg=(0,i.createContext)(null),bg={didCatch:!1,error:null};class jg extends i.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=bg}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(null!==e){for(var t,n,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];null===(t=(n=this.props).onReset)||void 0===t||t.call(n,{args:r,reason:"imperative-api"}),this.setState(bg)}}componentDidCatch(e,t){var n,i;null===(n=(i=this.props).onError)||void 0===n||n.call(i,e,t)}componentDidUpdate(e,t){const{didCatch:n}=this.state,{resetKeys:i}=this.props;var r,a;n&&null!==t.error&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.length!==t.length||e.some(((e,n)=>!Object.is(e,t[n])))}(e.resetKeys,i)&&(null===(r=(a=this.props).onReset)||void 0===r||r.call(a,{next:i,prev:e.resetKeys,reason:"keys"}),this.setState(bg))}render(){const{children:e,fallbackRender:t,FallbackComponent:n,fallback:r}=this.props,{didCatch:a,error:s}=this.state;let o=e;if(a){const e={error:s,resetErrorBoundary:this.resetErrorBoundary};if("function"===typeof t)o=t(e);else if(n)o=(0,i.createElement)(n,e);else{if(void 0===r)throw s;o=r}}return(0,i.createElement)(xg.Provider,{value:{didCatch:a,error:s,resetErrorBoundary:this.resetErrorBoundary}},o)}}const kg=e=>{let{staff:t,onFire:n,onTrain:i,onAssign:r,onDetails:s}=e;if(!t)return null;const o=e=>e>=75?"staff-morale-high":e>=40?"staff-morale-medium":"staff-morale-low",l=e=>e>=75?"staff-energy-high":e>=40?"staff-energy-medium":"staff-energy-low",c=e=>{switch(e){case"pracowity":return(0,a.jsx)(Ky,{size:14,className:"text-yellow-500"});case"kreatywny":return(0,a.jsx)(pg,{size:14,className:"text-blue-500"});case"dok\u0142adny":return(0,a.jsx)(py,{size:14,className:"text-purple-500"});case"konfliktowy":return(0,a.jsx)(mg,{size:14,className:"text-red-500"});default:return null}};return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-200 hover:shadow-lg transition-shadow",children:[(0,a.jsxs)("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200 flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center "+("senior"===t.level?"bg-purple-100":"mid"===t.level?"bg-blue-100":"bg-green-100"),children:(0,a.jsx)("span",{className:"text-sm font-bold",children:t.name?t.name[0]:"P"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:t.name||"Pracownik"}),(0,a.jsxs)("p",{className:"text-xs text-gray-600",children:["scout"===t.type?"Pozyskiwacz":"developer"===t.type?"Developer":"lobbyist"===t.type?"Lobbysta":"Specjalista"," \u2022 ","junior"===t.level?"Pocz\u0105tkuj\u0105cy":"mid"===t.level?"Do\u015bwiadczony":"Ekspert"]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Pensja"}),(0,a.jsx)("div",{className:"text-sm font-medium",children:(d=t.salary||0,`${(d/1e3).toFixed(1)}k PLN`)})]})]}),(0,a.jsxs)("div",{className:"px-4 py-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(py,{className:"h-4 w-4 text-blue-500 mr-1"}),(0,a.jsxs)("div",{className:"text-xs text-gray-700",children:["Umiej\u0119tno\u015b\u0107: ",(0,a.jsxs)("span",{className:"font-medium",children:[t.skill||0,"/10"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(Jy,{className:"h-4 w-4 text-gray-500 mr-1"}),(0,a.jsxs)("div",{className:"text-xs text-gray-700",children:["Do\u015bwiadczenie: ",(0,a.jsxs)("span",{className:"font-medium",children:[Math.floor((t.experience||0)/365)," lat"]})]})]})]}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[(0,a.jsx)("span",{children:"Rozw\xf3j kariery"}),(0,a.jsx)("span",{children:"junior"===t.level?"Junior \u2192 Mid":"mid"===t.level?"Mid \u2192 Senior":"Senior"})]}),(0,a.jsx)(Gy,{value:(()=>{const e={junior:0,mid:1,senior:2}[t.level]||0,n=e<2?e+1:2;if(2===e)return 100;const i=[0,3e3,8e3],r=t.experience||0,a=i[e],s=(r-a)/(i[n]-a)*100;return Math.min(100,Math.max(0,s))})(),status:"senior"===t.level?"high":"medium"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(mg,{className:`h-4 w-4 mr-1 ${o(t.morale||0)}`}),(0,a.jsx)("span",{className:"text-xs text-gray-600",children:"Morale"})]}),(0,a.jsxs)("span",{className:`text-xs font-medium ${o(t.morale||0)}`,children:[t.morale||0,"%"]})]}),(0,a.jsx)(Gy,{value:t.morale||0,status:t.morale>=75?"high":t.morale>=40?"medium":"low"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(Wy,{className:`h-4 w-4 mr-1 ${l(t.energy||0)}`}),(0,a.jsx)("span",{className:"text-xs text-gray-600",children:"Energia"})]}),(0,a.jsxs)("span",{className:`text-xs font-medium ${l(t.energy||0)}`,children:[t.energy||0,"%"]})]}),(0,a.jsx)(Gy,{value:t.energy||0,status:t.energy>=75?"high":t.energy>=40?"medium":"low"})]})]}),t.traits&&t.traits.length>0&&(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"Cechy charakteru"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:t.traits.map(((e,t)=>(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-800",children:[c(e),(0,a.jsx)("span",{className:"ml-1 capitalize",children:e})]},t)))})]}),(0,a.jsxs)("div",{className:"flex space-x-2 mt-3",children:[(0,a.jsx)("button",{onClick:()=>s&&s(t),className:"flex-1 text-xs py-1 px-2 bg-blue-50 text-blue-600 rounded border border-blue-200 hover:bg-blue-100 transition-colors",children:"Szczeg\xf3\u0142y"}),(0,a.jsx)("button",{onClick:()=>i&&i(t),className:"flex-1 text-xs py-1 px-2 bg-green-50 text-green-600 rounded border border-green-200 hover:bg-green-100 transition-colors",children:"Szkolenie"}),"developer"===t.type&&!t.assignedProject&&r&&(0,a.jsx)("button",{onClick:()=>r&&r(t),className:"flex-1 text-xs py-1 px-2 bg-purple-50 text-purple-600 rounded border border-purple-200 hover:bg-purple-100 transition-colors",children:"Przypisz"}),(0,a.jsx)("button",{onClick:()=>n&&n(t),className:"flex-1 text-xs py-1 px-2 bg-red-50 text-red-600 rounded border border-red-200 hover:bg-red-100 transition-colors",children:"Zwolnij"})]})]})]});var d},Ng=[{id:"pracowity",label:"Pracowity",description:"+15% wydajno\u015b\u0107, -10% zm\u0119czenie",effects:{efficiency:.15,energyLoss:-.1}},{id:"kreatywny",label:"Kreatywny",description:"+20% szansa na innowacje",effects:{innovationChance:.2}},{id:"charyzmatyczny",label:"Charyzmatyczny",description:"+15% negocjacje, +10% relacje",effects:{negotiation:.15,relations:.1}},{id:"dokladny",label:"Dok\u0142adny",description:"-30% ryzyko b\u0142\u0119d\xf3w, +10% czas",effects:{errorRisk:-.3,timeNeeded:.1}},{id:"ambitny",label:"Ambitny",description:"+25% praca po godzinach, szybszy rozw\xf3j",effects:{workOvertime:.25,careerGrowth:.15}},{id:"analityczny",label:"Analityczny",description:"+20% rozwi\u0105zywanie problem\xf3w",effects:{problemSolving:.2}},{id:"optymista",label:"Optymista",description:"+15% morale, -10% stres",effects:{moraleGain:.15,stressGain:-.1}},{id:"lojalny",label:"Lojalny",description:"-50% szansa odej\u015bcia, +15% morale przy d\u0142ugim sta\u017cu",effects:{leaveChance:-.5,longTermMorale:.15}}],zg=[{id:"perfekcjonista",label:"Perfekcjonista",description:"+30% jako\u015b\u0107, +20% czas",effects:{quality:.3,timeNeeded:.2}},{id:"indywidualista",label:"Indywidualista",description:"+10% solo, -15% zesp\xf3\u0142",effects:{soloWork:.1,teamWork:-.15}},{id:"ryzykant",label:"Ryzykant",description:"+25% szansa przyspieszenia, +15% b\u0142\u0119dy",effects:{speedBoost:.25,errorRisk:.15}},{id:"tradycjonalista",label:"Tradycjonalista",description:"-20% adaptacja do zmian, +15% standardowe procedury",effects:{adaptability:-.2,standardProcedures:.15}}],_g=[{id:"konfliktowy",label:"Konfliktowy",description:"-20% relacje, ryzyko spor\xf3w",effects:{relations:-.2,conflictRisk:.3}},{id:"prokrastynator",label:"Prokrastynator",description:"+25% op\xf3\u017anienia, -15% wydajno\u015b\u0107",effects:{delayRisk:.25,efficiency:-.15}},{id:"wypalony",label:"Wypalony",description:"-25% wydajno\u015b\u0107, -20% morale",effects:{efficiency:-.25,morale:-.2}},{id:"chaotyczny",label:"Chaotyczny",description:"-15% organizacja, +10% kreatywno\u015b\u0107",effects:{organization:-.15,creativity:.1}},{id:"pesymista",label:"Pesymista",description:"-15% morale zespo\u0142u, cz\u0119stsze zg\u0142aszanie problem\xf3w",effects:{teamMorale:-.15,problemReporting:.2}},{id:"niecierpliwy",label:"Niecierpliwy",description:"-20% zadania d\u0142ugoterminowe, +10% kr\xf3tkie zadania",effects:{longTasks:-.2,shortTasks:.1}}],Sg=e=>{let{staff:t,onClose:n,onFire:r,onTrain:s}=e;if(!t)return null;const o=(0,i.useRef)(null),l=e=>{o.current&&!o.current.contains(e.target)&&n()};(0,i.useEffect)((()=>(document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)})),[]);const c=e=>{if(!e)return"-";try{return new Date(e).toLocaleDateString("pl-PL",{day:"2-digit",month:"2-digit",year:"numeric"})}catch(t){return e}},d=e=>e>=80?{text:"Doskona\u0142e",status:"high"}:e>=60?{text:"Dobre",status:"high"}:e>=40?{text:"Neutralne",status:"medium"}:e>=20?{text:"S\u0142abe",status:"low"}:{text:"Krytyczne",status:"low"},u=e=>e>=80?{text:"Pe\u0142na",status:"high"}:e>=60?{text:"Wysoka",status:"high"}:e>=40?{text:"\u015arednia",status:"medium"}:e>=20?{text:"Niska",status:"low"}:{text:"Wyczerpanie",status:"low"},h=e=>Ng.some((t=>t.id===e))?"bg-green-100 text-green-800 border-green-200":_g.some((t=>t.id===e))?"bg-red-100 text-red-800 border-red-200":"bg-blue-100 text-blue-800 border-blue-200";return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{ref:o,className:"bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex items-center overflow-hidden",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4 flex-shrink-0",children:(0,a.jsx)(hg,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsxs)("div",{className:"overflow-hidden",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-ellipsis overflow-hidden",children:t.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 whitespace-nowrap text-ellipsis overflow-hidden",children:["scout"===t.type?"Pozyskiwacz":"developer"===t.type?"Developer":"lobbyist"===t.type?"Lobbysta":"lawyer"===t.type?"Prawnik":"envSpecialist"===t.type?"Specjalista \u015brodowiskowy":"Pracownik"," \u2022 ","junior"===t.level?"Pocz\u0105tkuj\u0105cy":"mid"===t.level?"Do\u015bwiadczony":"Ekspert"]})]})]}),(0,a.jsx)("button",{onClick:n,className:"h-8 w-8 rounded-full flex items-center justify-center hover:bg-gray-200 flex-shrink-0",children:(0,a.jsx)(wy,{className:"h-5 w-5 text-gray-500"})})]}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"md:col-span-2 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,a.jsx)(hg,{className:"h-5 w-5 mr-2 text-blue-500"}),"Informacje podstawowe"]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"overflow-hidden",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Data zatrudnienia"}),(0,a.jsx)("div",{className:"font-medium whitespace-nowrap",children:c(t.hiredOn)})]}),(0,a.jsxs)("div",{className:"overflow-hidden",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Czas zatrudnienia"}),(0,a.jsx)("div",{className:"font-medium whitespace-nowrap",children:(()=>{if(!t.hiredOn)return"-";const e=new Date(t.hiredOn),n=new Date,i=Math.abs(n-e),r=Math.ceil(i/864e5);if(r<30)return`${r} dni`;if(r<365){return`${Math.floor(r/30)} mies.`}{const e=Math.floor(r/365),t=Math.floor(r%365/30);return`${e} lat${t>0?`, ${t} mies.`:""}`}})()})]}),(0,a.jsxs)("div",{className:"overflow-hidden",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Wynagrodzenie"}),(0,a.jsx)("div",{className:"font-medium whitespace-nowrap",children:(p=t.salary||0,`${p.toLocaleString()} PLN`)})]}),(0,a.jsxs)("div",{className:"overflow-hidden",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Specjalizacja"}),(0,a.jsx)("div",{className:"font-medium text-ellipsis overflow-hidden",children:t.specialization||"-"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,a.jsx)(py,{className:"h-5 w-5 mr-2 text-blue-500"}),"Umiej\u0119tno\u015bci i rozw\xf3j"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)("span",{className:"text-sm",children:"Umiej\u0119tno\u015b\u0107 podstawowa"}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:[t.skill||0,"/10"]})]}),(0,a.jsx)(Gy,{value:10*(t.skill||0),status:(t.skill||0)>=7?"high":(t.skill||0)>=4?"medium":"low"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)("span",{className:"text-sm",children:"Do\u015bwiadczenie"}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:[t.experience||0," pkt"]})]}),(0,a.jsx)(Gy,{value:"senior"===t.level?100:"mid"===t.level?(t.experience-3e3)/5e3*100:t.experience/3e3*100,status:"medium"}),(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"junior"===t.level?"Do awansu na poziom Do\u015bwiadczony":"mid"===t.level?"Do awansu na poziom Ekspert":"Najwy\u017cszy poziom do\u015bwiadczenia"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,a.jsx)(pg,{className:"h-5 w-5 mr-2 text-blue-500"}),"Cechy charakteru"]}),t.traits&&t.traits.length>0?(0,a.jsx)("div",{className:"space-y-3",children:t.traits.map((e=>{const t=(e=>[...Ng,...zg,..._g].find((t=>t.id===e))||{label:e,description:""})(e);return(0,a.jsxs)("div",{className:`p-2 rounded border ${h(e)} break-words`,children:[(0,a.jsx)("div",{className:"font-medium",children:t.label||e}),(0,a.jsx)("div",{className:"text-sm",children:t.description})]},e)}))}):(0,a.jsx)("p",{className:"text-gray-500 italic",children:"Brak zdefiniowanych cech"})]}),t.historia&&t.historia.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,a.jsx)(Uf,{className:"h-5 w-5 mr-2 text-blue-500"}),"Historia pracownika"]}),(0,a.jsx)("div",{className:"border rounded divide-y",children:t.historia.map(((e,t)=>(0,a.jsx)("div",{className:"p-3",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("div",{className:"font-medium",children:e.opis}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:c(e.data)})]})},t)))})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[(0,a.jsx)("h3",{className:"text-lg font-bold mb-3",children:"Status"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsxs)("span",{className:"text-sm flex items-center",children:[(0,a.jsx)(mg,{className:"h-4 w-4 mr-1 text-red-500"}),"Morale"]}),(0,a.jsx)("span",{className:"text-sm font-medium "+("high"===d(t.morale||0).status?"text-green-600":"medium"===d(t.morale||0).status?"text-yellow-600":"text-red-600"),children:d(t.morale||0).text})]}),(0,a.jsx)(Gy,{value:t.morale||0,status:d(t.morale||0).status})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsxs)("span",{className:"text-sm flex items-center",children:[(0,a.jsx)(Wy,{className:"h-4 w-4 mr-1 text-green-500"}),"Energia"]}),(0,a.jsx)("span",{className:"text-sm font-medium "+("high"===u(t.energy||0).status?"text-green-600":"medium"===u(t.energy||0).status?"text-yellow-600":"text-red-600"),children:u(t.energy||0).text})]}),(0,a.jsx)(Gy,{value:t.energy||0,status:u(t.energy||0).status})]})]}),t.potrzeby&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h4",{className:"font-medium text-sm mb-2",children:"Potrzeby"}),(0,a.jsx)("div",{className:"space-y-2",children:Object.entries(t.potrzeby).map((e=>{let[t,n]=e,i="";switch(t){case"uznanie":i="Uznanie";break;case"rozwoj":i="Rozw\xf3j";break;case"stabilizacja":i="Stabilizacja";break;case"autonomia":i="Autonomia";break;case"relacjeSpoleczne":i="Relacje";break;default:i=t}return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)("span",{className:"text-xs",children:i}),(0,a.jsxs)("span",{className:"text-xs font-medium",children:[n,"/100"]})]}),(0,a.jsx)("div",{className:"w-full h-1 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full "+(n>=70?"bg-green-500":n>=40?"bg-yellow-500":"bg-red-500"),style:{width:`${n}%`}})})]},t)}))})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[(0,a.jsx)("h3",{className:"text-md font-bold mb-3",children:"Przypisane projekty"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 italic",children:"Brak przypisanych projekt\xf3w"})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[(0,a.jsx)("h3",{className:"text-md font-bold mb-3",children:"Akcje"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("button",{onClick:()=>s&&s(t),className:"w-full flex items-center justify-center py-2 px-4 bg-blue-100 text-blue-700 rounded border border-blue-200 hover:bg-blue-200",children:[(0,a.jsx)(py,{className:"h-4 w-4 mr-2"}),"Wy\u015blij na szkolenie"]}),(0,a.jsxs)("button",{onClick:()=>r&&r(t),className:"w-full flex items-center justify-center py-2 px-4 bg-red-100 text-red-700 rounded border border-red-200 hover:bg-red-200",children:[(0,a.jsx)(wy,{className:"h-4 w-4 mr-2"}),"Zwolnij pracownika"]})]})]})]})]})})]})});var p},Eg=()=>{const{state:e}=u();return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mt-6",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-2",children:"Reputacja firmy"}),(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mr-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${e.reputation||50}%`}})}),(0,a.jsxs)("span",{className:"font-medium "+(t=e.reputation||50,t>=80?"text-green-500":t>=60?"text-blue-500":t>=40?"text-yellow-500":t>=20?"text-orange-500":"text-red-500"),children:[e.reputation||50,"%"]})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-700",children:["Poziom: ",(0,a.jsx)("span",{className:"font-medium",children:(e=>e>=80?"Doskona\u0142a":e>=60?"Dobra":e>=40?"Przeci\u0119tna":e>=20?"S\u0142aba":"Bardzo s\u0142aba")(e.reputation||50)})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Reputacja wp\u0142ywa na negocjacje, sukces projekt\xf3w i relacje z interesariuszami"})]});var t},Cg=()=>{const{state:e,dispatch:t}=u(),{state:n,showNotification:r}=ff(),s=Fy(),[o,l]=(0,i.useState)("all"),[c,d]=(0,i.useState)("all"),[h,p]=(0,i.useState)(""),[m,f]=(0,i.useState)("skill"),[y,g]=(0,i.useState)("desc"),[v,w]=(0,i.useState)(null),[x,b]=(0,i.useState)(!1),[j,k]=(0,i.useState)(!1),[N,z]=(0,i.useState)(!1),[_,S]=(0,i.useState)(null),E=()=>{try{const t=[];return e&&e.staff?(Object.entries(e.staff).forEach((e=>{let[n,i]=e;i&&Array.isArray(i)&&i.length>0&&i.forEach((e=>{e&&e.id&&t.push({...e,staffCategory:n.replace(/s$/,"")})}))})),t):(console.error("Brak danych o kadrach"),[])}catch(t){return console.error("B\u0142\u0105d podczas pobierania listy pracownik\xf3w:",t),[]}},C=()=>{let e=E();if("all"!==o&&(e=e.filter((e=>e.staffCategory===o||e.type===o))),"all"!==c&&(e=e.filter((e=>e.level===c))),h){const t=h.toLowerCase();e=e.filter((e=>e.name.toLowerCase().includes(t)||e.specialization&&e.specialization.toLowerCase().includes(t)))}return e.sort(((e,t)=>{let n=0;switch(m){case"name":n=e.name.localeCompare(t.name);break;case"skill":n=(t.skill||0)-(e.skill||0);break;case"experience":n=(t.experience||0)-(e.experience||0);break;case"salary":n=(t.salary||0)-(e.salary||0);break;case"morale":n=(t.morale||0)-(e.morale||0);break;case"energy":n=(t.energy||0)-(e.energy||0);break;default:n=0}return"asc"===y?-n:n})),e},T=(e,t)=>{try{if(!e||!["scout","developer","lawyer","envSpecialist","lobbyist"].includes(e))return void r("Nieprawid\u0142owy typ pracownika.","error");if(!t||!["junior","mid","senior"].includes(t))return void r("Nieprawid\u0142owy poziom pracownika.","error");if(!s||"function"!==typeof s.hireStaff)return void r("System zarz\u0105dzania personelem jest niedost\u0119pny.","error");s.hireStaff(e,t)||console.log(`Nie uda\u0142o si\u0119 zatrudni\u0107 pracownika typu ${e}, poziom ${t}`)}catch(n){console.error("Wyst\u0105pi\u0142 b\u0142\u0105d podczas zatrudniania pracownika:",n),r("Wyst\u0105pi\u0142 nieoczekiwany b\u0142\u0105d podczas zatrudniania. Spr\xf3buj ponownie.","error")}},P=(e,t,n)=>{try{if(!e||!["scout","developer","lawyer","envSpecialist","lobbyist"].includes(e))return void r("Nieprawid\u0142owy typ pracownika.","error");if(!t||!["junior","mid","senior"].includes(t))return void r("Nieprawid\u0142owy poziom pracownika.","error");if(!n||n<=0||n>10)return void r("Nieprawid\u0142owa liczba pracownik\xf3w do zatrudnienia.","error");if(!s||"function"!==typeof s.hireStaff)return void r("System zarz\u0105dzania personelem jest niedost\u0119pny.","error");let i=0,a=0;for(let r=0;r<n;r++){if(!s.hireStaff(e,t)){a++;break}i++}i>0&&r(`Zatrudniono ${i} nowych pracownik\xf3w typu ${e}`,"success"),a>0&&r(`Nie uda\u0142o si\u0119 zatrudni\u0107 ${a} pracownik\xf3w`,"warning")}catch(i){console.error("Wyst\u0105pi\u0142 b\u0142\u0105d podczas masowego zatrudniania pracownik\xf3w:",i),r("Wyst\u0105pi\u0142 nieoczekiwany b\u0142\u0105d podczas zatrudniania. Spr\xf3buj ponownie.","error")}},I=e=>{event.preventDefault(),event.stopPropagation(),s.fireStaff(e.staffCategory,e.id),r(`Pracownik ${e.name} zosta\u0142 zwolniony`,"success")},A=t=>{event.preventDefault(),event.stopPropagation();const n=s.calculateTrainingCost(t,"standard");if(e.cash<n)return void r(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w na szkolenie (${n.toLocaleString()} PLN)`,"error");s.trainStaff(t.staffCategory,t.id,"standard")&&r(`Pracownik ${t.name} zosta\u0142 wys\u0142any na szkolenie`,"success")},M=e=>{event.preventDefault(),event.stopPropagation(),w(e),b(!0)},D={scouts:C().filter((e=>"scout"===e.staffCategory)),developers:C().filter((e=>"developer"===e.staffCategory)),specialists:C().filter((e=>"scout"!==e.staffCategory&&"developer"!==e.staffCategory))},R=(()=>{const e=E(),t=e.filter((e=>"scout"===e.staffCategory)).length,n=e.filter((e=>"developer"===e.staffCategory)).length,i=e.filter((e=>"scout"!==e.staffCategory&&"developer"!==e.staffCategory)).length,r=e.reduce(((e,t)=>e+(t.salary||0)),0),a=e.length>0?e.reduce(((e,t)=>e+(t.skill||0)),0)/e.length:0,s=e.length>0?e.reduce(((e,t)=>e+(t.morale||0)),0)/e.length:0,o=e.length>0?e.reduce(((e,t)=>e+(t.energy||0)),0)/e.length:0;return{totalCount:e.length,scoutCount:t,developerCount:n,specialistCount:i,totalSalaries:r,avgSkill:a,avgMorale:s,avgEnergy:o}})(),O=e=>{event.preventDefault(),event.stopPropagation();0!==s.findProjectsWaitingForDeveloper().length?(S(e),z(!0)):r("Brak projekt\xf3w oczekuj\u0105cych na przypisanie developera.","warning")};(0,i.useCallback)(((e,t,n)=>{if(!e||!t||!n)return;const i=e.lastReputationUpdate||0,r=t.turn||0;if(i>=r)return;const a=t.daysPerTurn||2,s=r*a;let o=0;for(let l=i*a+1;l<=s;l++)l%2===0&&o++;o>0&&n({type:"UPDATE_REPUTATION_INITIATIVES",payload:{daysPassed:2*o,turn:t.turn}})}),[]);return(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Zarz\u0105dzanie Kadrami"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Zarz\u0105dzaj swoimi pracownikami, zatrudniaj nowych, szkolenia i przydzielaj do projekt\xf3w."}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 border-l-4 border-blue-500",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"\u0141\u0105czna liczba pracownik\xf3w"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:R.totalCount})]}),(0,a.jsx)(Gf,{className:"h-10 w-10 text-blue-500 opacity-40"})]}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["Skauci: ",R.scoutCount," \u2022 Developerzy: ",R.developerCount," \u2022 Specjali\u015bci: ",R.specialistCount]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 border-l-4 border-green-500",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Miesi\u0119czne wynagrodzenia"}),(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[R.totalSalaries.toLocaleString()," PLN"]})]}),(0,a.jsx)(Jy,{className:"h-10 w-10 text-green-500 opacity-40"})]}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["\u015arednio na pracownika: ",R.totalCount>0?(R.totalSalaries/R.totalCount).toLocaleString():0," PLN"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 border-l-4 border-purple-500",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"\u015arednie umiej\u0119tno\u015bci"}),(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[R.avgSkill.toFixed(1),"/10"]})]}),(0,a.jsx)(pg,{className:"h-10 w-10 text-purple-500 opacity-40"})]}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["Skauci: ",D.scouts.length>0?(D.scouts.reduce(((e,t)=>e+(t.skill||0)),0)/D.scouts.length).toFixed(1):"0"," \u2022 Developerzy: ",D.developers.length>0?(D.developers.reduce(((e,t)=>e+(t.skill||0)),0)/D.developers.length).toFixed(1):"0"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 border-l-4 border-red-500",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"\u015arednie morale zespo\u0142u"}),(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[R.avgMorale.toFixed(0),"%"]})]}),(0,a.jsx)(mg,{className:"h-10 w-10 text-red-500 opacity-40"})]}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["Energia zespo\u0142u: ",R.avgEnergy.toFixed(0),"%"]})]})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Typ pracownika"}),(0,a.jsxs)("select",{value:o,onChange:e=>l(e.target.value),className:"border rounded px-3 py-1 text-sm",children:[(0,a.jsx)("option",{value:"all",children:"Wszyscy"}),(0,a.jsx)("option",{value:"scout",children:"Skauci"}),(0,a.jsx)("option",{value:"developer",children:"Developerzy"}),(0,a.jsx)("option",{value:"lobbyist",children:"Lobby\u015bci"}),(0,a.jsx)("option",{value:"lawyer",children:"Prawnicy"}),(0,a.jsx)("option",{value:"envSpecialist",children:"Specjali\u015bci \u015brodowiskowi"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Poziom"}),(0,a.jsxs)("select",{value:c,onChange:e=>d(e.target.value),className:"border rounded px-3 py-1 text-sm",children:[(0,a.jsx)("option",{value:"all",children:"Wszystkie"}),(0,a.jsx)("option",{value:"junior",children:"Junior"}),(0,a.jsx)("option",{value:"mid",children:"Mid"}),(0,a.jsx)("option",{value:"senior",children:"Senior"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Sortuj wg"}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsxs)("select",{value:m,onChange:e=>f(e.target.value),className:"border-l border-t border-b rounded-l px-3 py-1 text-sm",children:[(0,a.jsx)("option",{value:"name",children:"Imi\u0119 i nazwisko"}),(0,a.jsx)("option",{value:"skill",children:"Umiej\u0119tno\u015bci"}),(0,a.jsx)("option",{value:"experience",children:"Do\u015bwiadczenie"}),(0,a.jsx)("option",{value:"salary",children:"Wynagrodzenie"}),(0,a.jsx)("option",{value:"morale",children:"Morale"}),(0,a.jsx)("option",{value:"energy",children:"Energia"})]}),(0,a.jsx)("button",{onClick:()=>g("asc"===y?"desc":"asc"),className:"border rounded-r px-2 bg-gray-100 hover:bg-gray-200",children:"asc"===y?"\u2191":"\u2193"})]})]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-4",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",value:h,onChange:e=>p(e.target.value),placeholder:"Szukaj pracownika...",className:"border rounded pl-9 pr-3 py-1.5 w-64"}),(0,a.jsx)(vg,{className:"h-4 w-4 text-gray-400 absolute top-2 left-3"})]})})]})}),(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,a.jsx)(Gf,{className:"h-5 w-5 mr-2"}),"Skauci - Pozyskiwanie grunt\xf3w",(0,a.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",D.scouts.length,")"]})]}),(0,a.jsx)("p",{className:"text-gray-600 mb-4 text-sm",children:"Skauci szukaj\u0105 i negocjuj\u0105 umowy dzier\u017cawy grunt\xf3w pod projekty OZE. Do\u015bwiadczeni skauci przy\u015bpieszaj\u0105 pozyskiwanie grunt\xf3w i wynegocjuj\u0105 lepsze ceny."}),D.scouts.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:D.scouts.map((e=>(0,a.jsx)(kg,{staff:e,onFire:I,onTrain:A,onDetails:M},e.id)))}):(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 text-center",children:[(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"Nie masz jeszcze \u017cadnych pozyskiwaczy"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"Zatrudnij pocz\u0105tkuj\u0105cych (junior)"}),(0,a.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>T("scout","junior"),className:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"1 osoba"}),(0,a.jsx)("button",{onClick:()=>P("scout","junior",3),className:"px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"3 osoby"})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"Zatrudnij do\u015bwiadczonych (mid)"}),(0,a.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>T("scout","mid"),className:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"1 osoba"}),(0,a.jsx)("button",{onClick:()=>P("scout","mid",3),className:"px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"3 osoby"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"Zatrudnij ekspert\xf3w (senior)"}),(0,a.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>T("scout","senior"),className:"px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"1 osoba"}),(0,a.jsx)("button",{onClick:()=>P("scout","senior",3),className:"px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"3 osoby"})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,a.jsx)(Gf,{className:"h-5 w-5 mr-2"}),"Developerzy - Zarz\u0105dzanie projektami",(0,a.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",D.developers.length,")"]})]}),(0,a.jsx)("p",{className:"text-gray-600 mb-4 text-sm",children:"Developerzy zarz\u0105dzaj\u0105 projektami i przyspieszaj\u0105 proces realizacji. Do\u015bwiadczeni developerzy zwi\u0119kszaj\u0105 szanse na powodzenie projektu i redukuj\u0105 ryzyko."}),D.developers.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:D.developers.map((e=>(0,a.jsx)(kg,{staff:e,onFire:I,onTrain:A,onDetails:M,onAssign:e.assignedProject?null:O},e.id)))}):(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 text-center",children:[(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"Nie masz jeszcze \u017cadnych developer\xf3w"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"Zatrudnij pocz\u0105tkuj\u0105cych (junior)"}),(0,a.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>T("developer","junior"),className:"px-3 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"1 osoba"}),(0,a.jsx)("button",{onClick:()=>P("developer","junior",3),className:"px-3 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"3 osoby"})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"Zatrudnij do\u015bwiadczonych (mid)"}),(0,a.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>T("developer","mid"),className:"px-3 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"1 osoba"}),(0,a.jsx)("button",{onClick:()=>P("developer","mid",3),className:"px-3 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"3 osoby"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"Zatrudnij ekspert\xf3w (senior)"}),(0,a.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>T("developer","senior"),className:"px-3 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"1 osoba"}),(0,a.jsx)("button",{onClick:()=>P("developer","senior",3),className:"px-3 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"3 osoby"})]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-bold mb-3 flex items-center",children:[(0,a.jsx)(Gf,{className:"h-5 w-5 mr-2"}),"Specjali\u015bci wysokiego szczebla",(0,a.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",D.specialists.length,")"]})]}),(0,a.jsx)("p",{className:"text-gray-600 mb-4 text-sm",children:"Specjali\u015bci wysokiego szczebla to kluczowi eksperci, kt\xf3rzy znacz\u0105co przyspieszaj\u0105 uzyskiwanie pozwole\u0144 i rozw\xf3j projekt\xf3w."}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"font-bold text-md mb-2",children:"Prawnik"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Przyspiesza uzyskiwanie warunk\xf3w zabudowy i decyzji lokalizacyjnych o 30%."}),(0,a.jsx)("button",{onClick:()=>T("lawyer","senior"),className:"w-full px-3 py-2 bg-purple-500 text-white rounded hover:bg-purple-600",children:"Zatrudnij (30 mln z\u0142)"})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"font-bold text-md mb-2",children:"Specjalista ds. \u015brodowiska"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Przyspiesza uzyskiwanie decyzji \u015brodowiskowych o 30% i zmniejsza ryzyko blokad."}),(0,a.jsx)("button",{onClick:()=>T("envSpecialist","senior"),className:"w-full px-3 py-2 bg-purple-500 text-white rounded hover:bg-purple-600",children:"Zatrudnij (25 mln z\u0142)"})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"font-bold text-md mb-2",children:"Lobbysta"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Wp\u0142ywa na decyzje lokalne, przyspiesza procesy administracyjne i zwi\u0119ksza akceptacj\u0119 spo\u0142eczn\u0105."}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>T("lobbyist","junior"),className:"flex-1 px-2 py-2 bg-purple-500 text-white rounded hover:bg-purple-600 text-sm",children:"Junior (5k z\u0142/m-c)"}),(0,a.jsx)("button",{onClick:()=>T("lobbyist","senior"),className:"flex-1 px-2 py-2 bg-purple-500 text-white rounded hover:bg-purple-600 text-sm",children:"Expert (11k z\u0142/m-c)"})]})]})]})]})]}),x&&v&&(0,a.jsx)(Sg,{staff:v,onClose:()=>b(!1),onFire:()=>{I(v),b(!1)},onTrain:()=>{A(v)}}),N&&_&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Przypisz developera do projektu"}),(0,a.jsxs)("p",{className:"mb-4",children:["Wybierz projekt, do kt\xf3rego chcesz przypisa\u0107 developera ",(0,a.jsx)("strong",{children:_.name}),":"]}),(0,a.jsx)("div",{className:"space-y-3 mb-6",children:s.findProjectsWaitingForDeveloper().map((e=>(0,a.jsxs)("div",{className:"bg-gray-50 p-3 rounded border border-gray-200 hover:bg-blue-50 cursor-pointer",onClick:()=>(()=>{if(!_)return;s.assignDeveloperToWaitingProject(_.id)?r(`Developer ${_.name} zosta\u0142 przypisany do projektu.`,"success"):r("Nie uda\u0142o si\u0119 przypisa\u0107 developera do projektu.","error"),z(!1),S(null)})(e.id),children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["Region: ",e.region,", Powierzchnia: ",e.size,"ha"]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Typ projektu: ",e.projectType||"Standardowy"]})]},e.id)))}),(0,a.jsx)("div",{className:"flex justify-end space-x-3",children:(0,a.jsx)("button",{onClick:()=>{z(!1),S(null)},className:"px-4 py-2 bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:"Anuluj"})})]})}),(0,a.jsx)(Eg,{})]})},Tg=Ff("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),Pg=()=>{var e;const{state:t,dispatch:n}=u(),{showNotification:r}=ff(),[s,o]=(0,i.useState)("efficiency"),l=[{id:"efficiency",name:"Efektywno\u015b\u0107",icon:(0,a.jsx)(iy,{size:16})},{id:"training",name:"Szkolenia",icon:(0,a.jsx)(pg,{size:16})},{id:"equipment",name:"Sprz\u0119t",icon:(0,a.jsx)(Tg,{size:16})},{id:"reputation",name:"Reputacja",icon:(0,a.jsx)(py,{size:16})}],c=e=>t.companyUpgrades&&t.companyUpgrades[e]||0,d=e=>{const t=c(e.id);return t>=e.levels?1/0:Math.floor(e.baseCost*Math.pow(e.costMultiplier,t))};return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mt-6",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Ulepszenia firmy"}),(0,a.jsx)("div",{className:"flex border-b border-gray-200 mb-4",children:l.map((e=>(0,a.jsxs)("button",{className:"flex items-center px-4 py-2 "+(s===e.id?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),onClick:()=>o(e.id),children:[(0,a.jsx)("span",{className:"mr-2",children:e.icon}),e.name]},e.id)))}),(0,a.jsx)("div",{className:"space-y-4",children:null===(e={efficiency:[{id:"project_management",name:"System zarz\u0105dzania projektami",description:"Zwi\u0119ksza efektywno\u015b\u0107 pracy developer\xf3w o 10% na poziom",levels:3,baseCost:25e3,costMultiplier:2,effects:[{target:"developer_efficiency",value:.1},{target:"project_progress_rate",value:.05}]},{id:"document_templates",name:"Szablony dokument\xf3w",description:"Przyspiesza uzyskiwanie pozwole\u0144 o 5% na poziom",levels:3,baseCost:15e3,costMultiplier:1.5,effects:[{target:"permit_speed",value:.05}]},{id:"automation",name:"Automatyzacja proces\xf3w",description:"Zmniejsza koszty operacyjne o 5% na poziom",levels:3,baseCost:3e4,costMultiplier:1.8,effects:[{target:"operational_costs",value:-.05}]}],training:[{id:"training_program",name:"Program szkole\u0144",description:"Przyspiesza zdobywanie do\u015bwiadczenia pracownik\xf3w o 10% na poziom",levels:3,baseCost:2e4,costMultiplier:1.7,effects:[{target:"experience_gain_rate",value:.1}]},{id:"mentoring",name:"Program mentoringu",description:"Zwi\u0119ksza umiej\u0119tno\u015bci nowych pracownik\xf3w o 1 na poziom",levels:2,baseCost:25e3,costMultiplier:2,effects:[{target:"starting_skill_bonus",value:1}]}],equipment:[{id:"office_equipment",name:"Sprz\u0119t biurowy",description:"Zwi\u0119ksza zadowolenie pracownik\xf3w o 5% na poziom",levels:3,baseCost:1e4,costMultiplier:1.5,effects:[{target:"staff_morale",value:.05}]},{id:"field_equipment",name:"Sprz\u0119t terenowy",description:"Zwi\u0119ksza efektywno\u015b\u0107 skaut\xf3w o 10% na poziom",levels:3,baseCost:15e3,costMultiplier:1.6,effects:[{target:"scout_efficiency",value:.1}]}],reputation:[{id:"marketing",name:"Marketing i PR",description:"Zwi\u0119ksza reputacj\u0119 firmy o 5 punkt\xf3w na poziom",levels:3,baseCost:2e4,costMultiplier:1.8,effects:[{target:"reputation",value:5}]},{id:"social_responsibility",name:"Odpowiedzialno\u015b\u0107 spo\u0142eczna",description:"Zwi\u0119ksza akceptacj\u0119 spo\u0142eczn\u0105 projekt\xf3w o 10% na poziom",levels:2,baseCost:3e4,costMultiplier:2,effects:[{target:"social_acceptance",value:.1}]}]}[s])||void 0===e?void 0:e.map((e=>{const i=c(e.id),s=d(e),o=i>=e.levels;return(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-sm font-medium",children:["Poziom: ",i,"/",e.levels]}),o?(0,a.jsxs)("div",{className:"flex items-center mt-2 text-green-600 text-sm",children:[(0,a.jsx)(py,{size:16,className:"mr-1"}),"Maksymalny poziom"]}):(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("button",{onClick:()=>(e=>{const i=c(e.id);if(i>=e.levels)return void r("Osi\u0105gni\u0119to maksymalny poziom tego ulepszenia","warning");const a=d(e);t.cash<a?r(`Niewystarczaj\u0105ce \u015brodki. Potrzeba ${a.toLocaleString()} PLN`,"error"):(n({type:"PURCHASE_COMPANY_UPGRADE",payload:{upgradeId:e.id,cost:a,newLevel:i+1}}),e.effects.forEach((e=>{"reputation"===e.target&&n({type:"UPDATE_REPUTATION",payload:e.value})})),r(`Zakupiono ulepszenie: ${e.name} (poziom ${i+1}/${e.levels})`,"success"))})(e),disabled:t.cash<s||o,className:"px-3 py-1.5 text-sm rounded "+(t.cash<s||o?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"),children:o?"Maksymalny poziom":`Ulepsz (${s.toLocaleString()} PLN)`})})]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5 mt-3",children:(0,a.jsx)("div",{className:"bg-blue-600 h-1.5 rounded-full",style:{width:i/e.levels*100+"%"}})})]},e.id)}))}),(0,a.jsxs)("div",{className:"flex items-start mt-4 p-3 bg-blue-50 rounded-lg text-sm",children:[(0,a.jsx)(Kf,{size:18,className:"text-blue-500 mr-2 mt-0.5"}),(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-blue-800",children:"Ulepszenia firmy daj\u0105 trwa\u0142e premie, kt\xf3re wp\u0142ywaj\u0105 na wszystkie aspekty dzia\u0142alno\u015bci. Wybieraj je zgodnie ze swoj\u0105 strategi\u0105 rozwoju."})})]})]})},Ig=()=>{var e;const{state:t}=u(),{state:n}=ff(),i=e=>new Intl.NumberFormat("pl-PL",{style:"currency",currency:"PLN",maximumFractionDigits:0}).format(e),r=(()=>{let e=0,n=5e3;t.staff&&Object.values(t.staff).forEach((t=>{Array.isArray(t)&&t.forEach((t=>{t.salary&&(e+=t.salary)}))}));const i=Object.values(t.staff||{}).reduce(((e,t)=>e+(Array.isArray(t)?t.length:0)),0);return n+=1e3*i,{staffCosts:e,officeCosts:n,otherCosts:2e3,total:e+n+2e3}})(),s=t.projects&&0!==t.projects.length?t.projects.reduce(((e,t)=>{let n=0;switch(t.status){case"new":n=0;break;case"land_acquisition":default:n=5e3*t.size;break;case"environmental_decision":n=1e4*t.size;break;case"zoning_conditions":n=15e3*t.size;break;case"grid_connection":n=25e3*t.size;break;case"ready_to_build":n=5e4*t.size}return e+n*("PV"===t.technology?1:"Wind"===t.technology?1.2:1.5)}),0):0;return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mt-6",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Przegl\u0105d firmy"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"rounded-full bg-blue-100 p-2 mr-3",children:(0,a.jsx)(vy,{size:20,className:"text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Aktywa pieni\u0119\u017cne"}),(0,a.jsx)("p",{className:"font-semibold",children:i(t.cash||0)})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"rounded-full bg-green-100 p-2 mr-3",children:(0,a.jsx)(hy,{size:20,className:"text-green-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Warto\u015b\u0107 projekt\xf3w"}),(0,a.jsx)("p",{className:"font-semibold",children:i(s)})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"rounded-full bg-purple-100 p-2 mr-3",children:(0,a.jsx)(Gf,{size:20,className:"text-purple-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Miesi\u0119czne koszty personelu"}),(0,a.jsx)("p",{className:"font-semibold",children:i(r.staffCosts)})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"rounded-full bg-red-100 p-2 mr-3",children:(0,a.jsx)(Ky,{size:20,className:"text-red-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Ca\u0142kowite koszty miesi\u0119czne"}),(0,a.jsx)("p",{className:"font-semibold",children:i(r.total)})]})]})]}),(0,a.jsxs)("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Liczba projekt\xf3w"}),(0,a.jsx)("p",{className:"font-medium",children:(null===(e=t.projects)||void 0===e?void 0:e.length)||0})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Liczba pracownik\xf3w"}),(0,a.jsx)("p",{className:"font-medium",children:Object.values(t.staff||{}).reduce(((e,t)=>e+(Array.isArray(t)?t.length:0)),0)})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Dzie\u0144 operacyjny"}),(0,a.jsx)("p",{className:"font-medium",children:n.turn*(n.daysPerTurn||2)})]})]})]})},Ag=Ff("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),Mg=Ff("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),Dg=()=>{var e,t,n;const{state:r,dispatch:s}=u(),{state:o,showNotification:l}=ff(),[c,d]=(0,i.useState)(null),[h,p]=(0,i.useState)(!1),m=Array.isArray(r.leases)?r.leases:[];(0,i.useEffect)((()=>{const e=()=>{if(c){const e=m.find((e=>e.id===c.id));e?d(e):(d(null),p(!1))}};return window.addEventListener("next-game-day",e),()=>{window.removeEventListener("next-game-day",e)}}),[c,m]);const f=e=>{if(!e)return"Data nieznana";try{return new Date(e).toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"})}catch(t){return console.error("B\u0142\u0105d formatowania daty:",t),"B\u0142\u0105d formatu daty"}},y=e=>{if(e&&window.confirm("Czy na pewno chcesz wypowiedzie\u0107 umow\u0119 dzier\u017cawy? Utracisz prawa do dzia\u0142ki i nie otrzymasz zwrotu kaucji."))try{var t;const n=null===(t=r.projects)||void 0===t?void 0:t.find((t=>t.leaseId===e));if(n)return void l(`Nie mo\u017cna wypowiedzie\u0107 umowy dzier\u017cawy, poniewa\u017c jest przypisana do projektu "${n.name}". Najpierw musisz zako\u0144czy\u0107 projekt.`,"error");s({type:"REMOVE_LEASE",payload:e}),c&&c.id===e&&(d(null),p(!1)),l("Umowa dzier\u017cawy zosta\u0142a wypowiedziana.","success")}catch(n){console.error("B\u0142\u0105d podczas wypowiadania umowy dzier\u017cawy:",n),l("Wyst\u0105pi\u0142 b\u0142\u0105d podczas wypowiadania umowy dzier\u017cawy.","error")}};(0,i.useEffect)((()=>{if(c){const e=m.find((e=>e.id===c.id));e?d(e):(d(null),p(!1))}}),[m,c]);const g=[...m].sort(((e,t)=>{const n=new Date(e.startDate);return new Date(t.startDate)-n}));return(0,a.jsxs)("div",{className:"p-4 bg-white rounded-lg shadow-md",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold mb-4 flex items-center",children:[(0,a.jsx)(hy,{className:"mr-2 h-5 w-5 text-blue-500"}),"Aktywne umowy dzier\u017cawy (",m.length,")"]}),0===m.length?(0,a.jsxs)("div",{className:"text-center py-6 bg-gray-50 rounded-lg",children:[(0,a.jsx)(hy,{className:"mx-auto h-12 w-12 text-gray-300 mb-2"}),(0,a.jsx)("p",{className:"text-gray-500 mb-1",children:"Brak aktywnych um\xf3w dzier\u017cawy"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Zawrzyj umowy dzier\u017cawy, aby rozpocz\u0105\u0107 nowe projekty OZE"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:g.map((e=>{var t;return(0,a.jsxs)("div",{className:"border rounded-lg p-3 transition-all duration-200 "+(c&&c.id===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300"),onClick:()=>{d(e),p(!0)},children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-medium",children:["Dzia\u0142ka ",e.size,"ha (",e.projectType||"Brak typu",")"]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(Iy,{className:"h-3 w-3 mr-1"}),e.regionName||"Nieznany region"]})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),(e=>{var t;const n=null===(t=r.projects)||void 0===t?void 0:t.find((t=>t.leaseId===e));n?l(`Znaleziono powi\u0105zany projekt: ${n.name}`,"info"):l("Nie znaleziono projektu powi\u0105zanego z t\u0105 umow\u0105 dzier\u017cawy.","error")})(e.id)},className:"text-blue-500 hover:text-blue-700 p-1",title:"Zobacz powi\u0105zany projekt",children:(0,a.jsx)(Ag,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),y(e.id)},className:"text-red-500 hover:text-red-700 p-1 ml-1",title:"Wypowiedz umow\u0119",children:(0,a.jsx)(Mg,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"text-sm space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Czynsz miesi\u0119czny:"}),(0,a.jsxs)("span",{className:"font-medium",children:[null===(t=e.monthlyRent)||void 0===t?void 0:t.toLocaleString()," PLN"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Umowa zawarta:"}),(0,a.jsx)("span",{children:f(e.startDate)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Wygasa:"}),(0,a.jsx)("span",{children:f(e.endDate)})]})]})]},e.id)}))}),h&&c&&(0,a.jsxs)("div",{className:"mt-6 bg-gray-50 p-4 rounded-lg border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,a.jsx)("h3",{className:"text-lg font-bold",children:"Szczeg\xf3\u0142y umowy dzier\u017cawy"}),(0,a.jsx)("button",{onClick:()=>p(!1),className:"text-gray-500 hover:text-gray-700",children:"Zamknij"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Informacje podstawowe"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"ID umowy:"}),(0,a.jsx)("span",{className:"font-mono",children:c.id})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Region:"}),(0,a.jsx)("span",{children:c.regionName})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Powierzchnia:"}),(0,a.jsxs)("span",{children:[c.size," ha"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Jako\u015b\u0107 dzia\u0142ki:"}),(0,a.jsx)("span",{children:"high"===c.quality?"Wysoka":"medium"===c.quality?"\u015arednia":"Niska"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Typ projektu:"}),(0,a.jsx)("span",{children:c.projectType||"Nie okre\u015blono"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Warunki finansowe"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Cena ca\u0142kowita:"}),(0,a.jsxs)("span",{className:"font-medium",children:[null===(e=c.totalPrice)||void 0===e?void 0:e.toLocaleString()," PLN"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Czynsz miesi\u0119czny:"}),(0,a.jsxs)("span",{children:[null===(t=c.monthlyRent)||void 0===t?void 0:t.toLocaleString()," PLN"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Kaucja:"}),(0,a.jsxs)("span",{children:[null===(n=c.deposit)||void 0===n?void 0:n.toLocaleString()," PLN"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"D\u0142ugo\u015b\u0107 umowy:"}),(0,a.jsxs)("span",{children:[c.contractLength||29," lat"]})]})]})]})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Terminy"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Data zawarcia:"}),(0,a.jsx)("span",{children:f(c.startDate)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Data wyga\u015bni\u0119cia:"}),(0,a.jsx)("span",{children:f(c.endDate)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Pozosta\u0142y czas:"}),(0,a.jsx)("span",{children:(()=>{try{const e=new Date(c.endDate),t=new Date(o.gameDate),n=Math.abs(e-t);return`${Math.floor(n/31536e6)} lat`}catch(e){return"B\u0142\u0105d obliczenia"}})()})]})]})]}),(0,a.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,a.jsx)("button",{onClick:()=>(c.id,void l("Funkcja renegocjacji umowy dzier\u017cawy jest w trakcie rozwoju.","info")),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Renegocjuj umow\u0119"}),(0,a.jsx)("button",{onClick:()=>y(c.id),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Wypowiedz umow\u0119"})]})]})]})},Rg=()=>{const[e,t]=(0,i.useState)("overview"),{state:n,dispatch:r}=u(),{state:s,showNotification:o,dispatch:l}=ff(),c=Fy(),[d,h]=(0,i.useState)(!1),[p,m]=(0,i.useState)(!1),[f,y]=(0,i.useState)(""),[g,v]=(0,i.useState)(!1),[w,x]=(0,i.useState)(null),[b,j]=(0,i.useState)(null);(0,i.useEffect)((()=>{try{if(!n)throw new Error("Dane gracza s\u0105 niedost\u0119pne");if(n.staff){const i=["scouts","developers","lawyers","envSpecialists","lobbyists"].filter((e=>!n.staff[e]));if(i.length>0){const e={};i.forEach((t=>{e[t]=[]})),r({type:"UPDATE_STAFF_STRUCTURE",payload:e}),o("Zaktualizowano struktur\u0119 danych personelu","info")}n.projects||r({type:"UPDATE_PLAYER",payload:{projects:[]}}),n.reputationHistory||r({type:"UPDATE_PLAYER",payload:{reputationHistory:[]}}),n.illegals&&n.illegals.illegalActionHistory||r({type:"UPDATE_PLAYER",payload:{illegals:{...n.illegals||{},illegalActionHistory:[]}}}),n.economicMetrics||r({type:"UPDATE_PLAYER",payload:{economicMetrics:{totalInvestment:0,totalRevenue:0,totalExpenses:0,avgROI:0}}}),n.reputationFactors||r({type:"UPDATE_PLAYER",payload:{reputationFactors:{legalCompliance:1,environmentalImpact:1,communityRelations:1,projectQuality:1,transparency:1,grayAreaActivity:1}}}),n.activeReputationInitiatives||r({type:"UPDATE_PLAYER",payload:{activeReputationInitiatives:[]}}),h(!0);try{const e=localStorage.getItem("staffHiringState");if(e){const n=JSON.parse(e);Date.now()-n.timestamp<3e5&&n.inProgress?t("staff"):localStorage.removeItem("staffHiringState")}}catch(e){console.warn("B\u0142\u0105d odczytu stanu zatrudniania:",e)}}else r({type:"INITIALIZE_PLAYER",payload:{cash:1e6,reputation:50,installedCapacity:0,rtbCapacity:0,staff:{scouts:[],developers:[],lawyers:[],envSpecialists:[],lobbyists:[]},projects:[],reputationHistory:[],illegals:{illegalActionHistory:[]},economicMetrics:{totalInvestment:0,totalRevenue:0,totalExpenses:0,avgROI:0}}}),o("Inicjalizacja danych gracza...","info")}catch(i){console.error("B\u0142\u0105d podczas inicjalizacji danych:",i),m(!0),y(i.message||"B\u0142\u0105d podczas \u0142adowania zarz\u0105dzania sp\xf3\u0142k\u0105"),o("B\u0142\u0105d podczas \u0142adowania zarz\u0105dzania sp\xf3\u0142k\u0105.","error")}}),[n,r,o]),(0,i.useEffect)((()=>{const e=()=>{try{const e=localStorage.getItem("staffHiringState");if(e){const n=JSON.parse(e);Date.now()-n.timestamp<3e5&&n.inProgress&&t("staff")}}catch(e){console.warn("B\u0142\u0105d odczytu stanu zatrudniania:",e)}},n=setInterval(e,1e3);return e(),()=>clearInterval(n)}),[]);const k=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{x(e),j(t),v(!0)}catch(n){console.error("B\u0142\u0105d podczas otwierania panelu bocznego:",n),o("Wyst\u0105pi\u0142 b\u0142\u0105d podczas otwierania panelu","error")}},N=()=>{try{v(!1),setTimeout((()=>{x(null),j(null)}),300)}catch(e){console.error("B\u0142\u0105d podczas zamykania panelu bocznego:",e)}},z=(n,i)=>(0,a.jsx)("button",{className:`px-4 py-2 ${e===n?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"} rounded-md shadow-sm transition`,onClick:e=>{e.preventDefault(),e.stopPropagation(),t(n)},children:i});(0,i.useEffect)((()=>{const e=e=>{if(e.target.closest(".company-view-container"))return;const t=e.target.closest("a[href], button[data-nav]");if(t){const n=t.getAttribute("href")||t.getAttribute("data-nav");if("company"!==n&&"#company"!==n)return;e.preventDefault(),e.stopPropagation()}};return document.addEventListener("click",e,!0),()=>{document.removeEventListener("click",e,!0)}}),[]);const _=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{if("get"===e)return localStorage.getItem(t);"set"===e?localStorage.setItem(t,n):"remove"===e&&localStorage.removeItem(t)}catch(i){return console.error(`B\u0142\u0105d podczas operacji ${e} na localStorage dla klucza ${t}:`,i),null}};(0,i.useEffect)((()=>{try{_("set","companyViewActiveTab",e)}catch(t){console.error("Nie mo\u017cna zapisa\u0107 stanu zak\u0142adki:",t)}}),[e]),(0,i.useEffect)((()=>{try{const e=_("get","companyViewActiveTab");e&&t(e)}catch(e){console.error("Nie mo\u017cna wczyta\u0107 stanu zak\u0142adki:",e)}}),[]);const S=(n,i)=>(0,a.jsx)(jg,{fallback:(0,a.jsxs)("div",{className:"bg-red-100 p-6 rounded text-center",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-red-700 mb-4",children:["Wyst\u0105pi\u0142 b\u0142\u0105d w panelu ",n]}),(0,a.jsx)("p",{className:"text-red-600 mb-4",children:"Problemy z wy\u015bwietlaniem zawarto\u015bci. Spr\xf3buj od\u015bwie\u017cy\u0107 stron\u0119 lub wybra\u0107 inn\u0105 zak\u0142adk\u0119."}),(0,a.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",onClick:()=>window.location.reload(),children:"Od\u015bwie\u017c stron\u0119"}),(0,a.jsx)("button",{className:"px-4 py-2 bg-gray-600 text-white rounded",onClick:()=>t("overview"),children:"Wr\xf3\u0107 do przegl\u0105du"})]})]}),onError:(e,t)=>{console.error(`B\u0142\u0105d w komponencie ${n}:`,e,t),o(`Wyst\u0105pi\u0142 problem z panelem ${n}. Wybierz inn\u0105 zak\u0142adk\u0119 lub od\u015bwie\u017c stron\u0119.`,"error")},resetKeys:[e],children:(0,a.jsx)(i,{})});return p?(0,a.jsx)("div",{className:"container mx-auto p-4",children:(0,a.jsxs)("div",{className:"bg-red-100 p-8 rounded-lg text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-red-700 mb-4",children:"B\u0142\u0105d podczas \u0142adowania"}),(0,a.jsx)("p",{className:"text-red-700 mb-4",children:f||"Wyst\u0105pi\u0142 problem podczas \u0142adowania danych zarz\u0105dzania sp\xf3\u0142k\u0105."}),(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",onClick:()=>{l({type:"SET_SCREEN",payload:"home"})},children:"Wr\xf3\u0107 do ekranu g\u0142\xf3wnego"})]})}):d?(0,a.jsxs)("div",{className:"container mx-auto p-4 company-view-container",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Zarz\u0105dzanie firm\u0105"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:e=>{e.preventDefault(),e.stopPropagation(),k("reputation_initiatives")},children:"Inicjatywy reputacyjne"}),(0,a.jsx)("button",{className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",onClick:e=>{e.preventDefault(),e.stopPropagation(),k("illegal_actions")},children:"Szara strefa"})]})]}),(0,a.jsxs)("div",{className:"flex mb-6 space-x-2 border-b pb-3",children:[z("overview","Przegl\u0105d firmy"),z("projects","Projekty"),z("staff","Pracownicy"),z("finances","Finanse"),z("reputation","Reputacja"),z("upgrades","Ulepszenia")]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg min-h-[600px]",children:["overview"===e&&S("przegl\u0105d",Ig),"projects"===e&&S("projekty",ig),"staff"===e&&(0,a.jsx)(jg,{fallback:(0,a.jsxs)("div",{className:"bg-red-100 p-6 rounded text-center",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-red-700 mb-4",children:"Wyst\u0105pi\u0142 b\u0142\u0105d w panelu kadry"}),(0,a.jsx)("p",{className:"text-red-600 mb-4",children:"Problemy z wy\u015bwietlaniem panelu kadr. Spr\xf3buj od\u015bwie\u017cy\u0107 stron\u0119."}),(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded",onClick:()=>window.location.reload(),children:"Od\u015bwie\u017c stron\u0119"})]}),onError:(e,t)=>{console.error("B\u0142\u0105d w komponencie kadr:",e,t),o("Wyst\u0105pi\u0142 problem z panelem kadr. Od\u015bwie\u017c stron\u0119, aby kontynuowa\u0107.","error")},resetKeys:[e],children:(0,a.jsx)(Cg,{})}),"finances"===e&&S("finanse",yg),"reputation"===e&&S("reputacja",Eg),"upgrades"===e&&S("ulepszenia",Pg),"staff"!==e&&(0,a.jsx)("div",{className:"mt-8",children:(0,a.jsx)(jg,{fallback:(0,a.jsx)("div",{className:"bg-yellow-50 p-3 rounded border border-yellow-200",children:(0,a.jsx)("p",{className:"text-yellow-700",children:"Nie mo\u017cna za\u0142adowa\u0107 listy um\xf3w dzier\u017cawy."})}),children:(0,a.jsx)(Dg,{})})})]}),(()=>{if(!g)return null;try{switch(w){case"illegal_actions":return(0,a.jsx)(rg,{title:"Szara strefa",isOpen:g,onClose:N,variant:"illegal",children:(0,a.jsx)(ug,{onClose:N})});case"reputation_initiatives":return(0,a.jsx)(rg,{title:"Inicjatywy reputacyjne",isOpen:g,onClose:N,variant:"reputation",children:(0,a.jsx)(Ny,{onClose:N})});case"staff_details":return(0,a.jsx)(rg,{title:"Szczeg\xf3\u0142y pracownika",isOpen:g,onClose:N,variant:"staff",children:(0,a.jsx)(fg,{staffId:null===b||void 0===b?void 0:b.id,staffType:null===b||void 0===b?void 0:b.type,onClose:N,onFire:(e,t)=>{c&&"function"===typeof c.fireStaff?(c.fireStaff(t,e),N()):o("Funkcja zwalniania pracownik\xf3w jest niedost\u0119pna","error")},onTrain:()=>{o("Funkcja szkolenia jest w trakcie rozwoju","info"),N()},onAssign:()=>{o("Funkcja przydzielania jest w trakcie rozwoju","info"),N()}})});case"finance":return(0,a.jsx)(rg,{title:"Panel finansowy",isOpen:g,onClose:N,variant:"finance",children:(0,a.jsx)(yg,{onClose:N})});case"company_upgrades":return(0,a.jsx)(rg,{title:"Ulepszenia firmowe",isOpen:g,onClose:N,variant:"upgrade",children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Ulepszenia firmowe"}),(0,a.jsx)("p",{className:"mb-4",children:"W tym miejscu b\u0119dziesz m\xf3g\u0142 ulepsza\u0107 swoj\u0105 firm\u0119, zwi\u0119kszaj\u0105c jej efektywno\u015b\u0107, reputacj\u0119 i mo\u017cliwo\u015bci."}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:[(0,a.jsxs)("div",{className:"border p-3 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-bold",children:"Biuro"}),(0,a.jsx)("p",{className:"text-sm mb-2",children:"Zwi\u0119ksza morale pracownik\xf3w i szybko\u015b\u0107 pracy"}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"Poziom: 1"}),(0,a.jsx)("button",{className:"px-3 py-1 bg-blue-500 text-white rounded disabled:bg-gray-300",disabled:!0,children:"Ulepsz (250,000 PLN)"})]})]}),(0,a.jsxs)("div",{className:"border p-3 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-bold",children:"Laboratoria"}),(0,a.jsx)("p",{className:"text-sm mb-2",children:"Przyspiesza badania i analizy"}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"Poziom: 0"}),(0,a.jsx)("button",{className:"px-3 py-1 bg-blue-500 text-white rounded",children:"Kup (150,000 PLN)"})]})]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-gray-500 italic mb-2",children:"Wi\u0119cej ulepsze\u0144 b\u0119dzie dost\u0119pnych wkr\xf3tce"}),(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:N,children:"Zamknij"})]})]})});default:return null}}catch(e){return console.error("B\u0142\u0105d podczas renderowania panelu bocznego:",e),(0,a.jsx)(rg,{title:"B\u0142\u0105d",isOpen:g,onClose:N,variant:"error",children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-red-600 mb-4",children:"Wyst\u0105pi\u0142 b\u0142\u0105d"}),(0,a.jsx)("p",{className:"mb-4",children:"Nie uda\u0142o si\u0119 za\u0142adowa\u0107 \u017c\u0105danego panelu."}),(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:N,children:"Zamknij"})]})})}})()]}):(0,a.jsx)("div",{className:"container mx-auto p-4",children:(0,a.jsxs)("div",{className:"bg-blue-50 p-8 rounded-lg text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-blue-700 mb-4",children:"\u0141adowanie danych"}),(0,a.jsx)("p",{className:"text-blue-700 mb-4",children:"Trwa \u0142adowanie danych zarz\u0105dzania sp\xf3\u0142k\u0105..."}),(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto"})]})})},Og=Ff("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Lg=Ff("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),Fg=Ff("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),Ug=Ff("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),Vg={container:{display:"flex",flexDirection:"column",height:"100%",width:"100%",maxHeight:"85vh",position:"relative",overflowY:"hidden"},header:{padding:"1rem",borderBottom:"1px solid #e5e7eb"},tabsContainer:{display:"flex",borderBottom:"1px solid #e5e7eb",overflow:"hidden",position:"relative"},mainContent:{display:"flex",flexGrow:1,overflow:"hidden",position:"relative"},sidebar:{width:"220px",borderRight:"1px solid #e5e7eb",background:"#f9fafb",overflow:"auto",height:"100%",padding:"0.75rem"},content:{flexGrow:1,height:"100%",overflowY:"auto",position:"relative"},eventsList:{padding:"1rem",overflowY:"auto",height:"100%",transition:"width 0.3s ease-in-out"},eventDetails:{padding:"1rem",borderLeft:"1px solid #e5e7eb",background:"#f9fafb",width:"50%",height:"100%",overflowY:"auto"},noEvents:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",padding:"2rem",color:"#6b7280",textAlign:"center"}},Bg=[],$g={},Wg={},qg=e=>{let{children:t,fallback:n}=e;const[r,s]=(0,i.useState)(!1),[o,l]=(0,i.useState)(null),c=e=>{console.error("B\u0142\u0105d w komponencie Events:",e),l(e),s(!0)};return(0,i.useEffect)((()=>(window.addEventListener("error",c),()=>{window.removeEventListener("error",c)})),[]),r?(0,a.jsxs)("div",{className:"error-boundary p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-red-600 font-semibold",children:"Wyst\u0105pi\u0142 b\u0142\u0105d w module wydarze\u0144"}),(0,a.jsx)("p",{className:"text-gray-700",children:"Przepraszamy za niedogodno\u015bci. Spr\xf3buj od\u015bwie\u017cy\u0107 stron\u0119."}),o&&(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:o.toString()})]}):t};function Hg(e){return(0,a.jsx)(qg,{fallback:(0,a.jsxs)("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded",children:[(0,a.jsx)("h2",{className:"font-bold text-amber-800",children:"Wyst\u0105pi\u0142 b\u0142\u0105d w panelu wydarze\u0144"}),(0,a.jsx)("p",{children:"Spr\xf3buj od\u015bwie\u017cy\u0107 stron\u0119. Je\u015bli problem b\u0119dzie si\u0119 powtarza\u0142, skontaktuj si\u0119 z administratorem."})]}),children:(0,a.jsx)(Kg,{...e})})}const Kg=e=>{let{eventsState:t={events:Bg},eventsDispatch:n,gameState:r=$g,gameDispatch:s,playerState:o=Wg,playerDispatch:l,selectedEvent:c=null,setSelectedEvent:d=null}=e;if(!t||!r||!o)return(0,a.jsxs)("div",{className:"p-4 text-center",children:[(0,a.jsx)(Kf,{className:"w-12 h-12 mx-auto text-red-500 mb-2"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-600",children:"Brak danych"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Nie mo\u017cna za\u0142adowa\u0107 panelu wydarze\u0144 z powodu braku wymaganych danych. Od\u015bwie\u017c stron\u0119 lub skontaktuj si\u0119 z administratorem."})]});const[u,h]=(0,i.useState)("all"),[p,m]=(0,i.useState)(null),[f,y]=(0,i.useState)(""),[g,v]=(0,i.useState)(!1),[w,x]=(0,i.useState)("all"),[b,j]=(0,i.useState)("all"),[k,N]=(0,i.useState)("all"),[z,_]=(0,i.useState)("all"),[S,E]=(0,i.useState)(!1),[C,T]=(0,i.useState)(!1),[P,I]=(0,i.useState)(!1),[A,M]=(0,i.useState)(!1),D=(0,i.useRef)(null),R=(0,i.useRef)(null),O=((0,i.useRef)(null),null!==c?c:p),L=e=>{d?d(e):m(e)};(0,i.useEffect)((()=>{const e=e=>{try{R.current&&!R.current.contains(e.target)&&v(!1)}catch(t){console.error("B\u0142\u0105d przy obs\u0142udze klikni\u0119cia poza filtry:",t)}};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),(0,i.useEffect)((()=>{if(O){I(!0);const e=setTimeout((()=>{I(!1)}),300);return()=>clearTimeout(e)}}),[O]),(0,i.useEffect)((()=>{if(O&&n)try{const e=setTimeout((()=>{O.read||n({type:"MARK_EVENT_READ",payload:O.id})}),5e3);return()=>clearTimeout(e)}catch(e){console.error("B\u0142\u0105d przy oznaczaniu wydarzenia jako przeczytane:",e)}}),[O,n]);const F=(0,i.useMemo)((()=>Array.isArray(null===t||void 0===t?void 0:t.events)?t.events:[]),[null===t||void 0===t?void 0:t.events]),U=(0,i.useMemo)((()=>F&&r?F.filter((e=>!e.expires||e.expires>(r.day||0))):[]),[F,null===r||void 0===r?void 0:r.day]),V=(0,i.useMemo)((()=>{if(!U)return{national:[],regional:[],local:[],projects:[],organization:[],special:[],regionalByVoivodeship:{}};const e=U.filter((e=>"national"===e.scope||"global"===e.scope)),t=U.filter((e=>"regional"===e.scope)),n=U.filter((e=>"county"===e.scope)),i=U.filter((e=>"project"===e.scope||"project_event"===e.type)),r=U.filter((e=>"staff_event"===e.type||"audit_event"===e.type||"illegal_event"===e.type||"reputation_event"===e.type||"organization"===e.scope)),a=U.filter((e=>e.requiresDecision||"special_event"===e.type||"special"===e.severity)),s={};return t.forEach((e=>{e.regionId&&(s[e.regionId]||(s[e.regionId]=[]),s[e.regionId].push(e))})),{national:e,regional:t,local:n,projects:i,organization:r,special:a,regionalByVoivodeship:s}}),[U]),B=(0,i.useMemo)((()=>[{id:"dolnoslaskie",name:"Dolno\u015bl\u0105skie"},{id:"kujawsko-pomorskie",name:"Kujawsko-Pomorskie"},{id:"lubelskie",name:"Lubelskie"},{id:"lubuskie",name:"Lubuskie"},{id:"lodzkie",name:"\u0141\xf3dzkie"},{id:"malopolskie",name:"Ma\u0142opolskie"},{id:"mazowieckie",name:"Mazowieckie"},{id:"opolskie",name:"Opolskie"},{id:"podkarpackie",name:"Podkarpackie"},{id:"podlaskie",name:"Podlaskie"},{id:"pomorskie",name:"Pomorskie"},{id:"slaskie",name:"\u015al\u0105skie"},{id:"swietokrzyskie",name:"\u015awi\u0119tokrzyskie"},{id:"warminsko-mazurskie",name:"Warmi\u0144sko-Mazurskie"},{id:"wielkopolskie",name:"Wielkopolskie"},{id:"zachodniopomorskie",name:"Zachodniopomorskie"}]),[]),$=(0,i.useMemo)((()=>{let e=(()=>{if(!V)return[];let e=[];switch(z){case"krajowe":e=V.national||[];break;case"regionalne":e=V.regional||[],"all"!==k&&(e=e.filter((e=>e.region===k)));break;case"lokalne":e=V.local||[];break;case"organizacja":e=V.organization||[];break;case"projekty":e=V.projects||[];break;case"specjalne":e=V.special||[];break;default:e=[...V.national||[],...V.regional||[],...V.local||[],...V.projects||[],...V.organization||[],...V.special||[]]}return e})();if("all"!==w&&(e=e.filter((e=>e.type===w))),"all"!==b&&(e=e.filter((e=>e.priority===b))),f.trim()){const t=f.toLowerCase();e=e.filter((e=>e.title&&e.title.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t)))}return e.sort(((e,t)=>{if(e.read!==t.read)return e.read?1:-1;if(e.priority!==t.priority){const n={high:3,medium:2,low:1};return n[t.priority]-n[e.priority]}return t.date-e.date}))}),[V,w,b,k,f,z]),W=e=>{const t=()=>{const t=e.toString().split("").reduce(((e,t)=>0|(e=(e<<5)-e+t.charCodeAt(0))),0);return.99999*Math.abs(Math.sin(t))},n=["To wydarzenie mo\u017ce wp\u0142yn\u0105\u0107 na ca\u0142y sektor OZE w Polsce.","Warto obserwowa\u0107, jak to wp\u0142ynie na inne projekty w regionie.","Sytuacja rozwija si\u0119 w interesuj\u0105cym kierunku.","Kluczowe b\u0119dzie, jak zareaguj\u0105 inni gracze na rynku.","Mo\u017ce to stworzy\u0107 nowe mo\u017cliwo\u015bci dla inwestor\xf3w.","To mo\u017ce by\u0107 punkt zwrotny dla ca\u0142ej bran\u017cy.","Podobne wydarzenia w przesz\u0142o\u015bci mia\u0142y du\u017cy wp\u0142yw na rynek.","Warto przeanalizowa\u0107, jak to wp\u0142ynie na lokaln\u0105 spo\u0142eczno\u015b\u0107.","Interesuj\u0105ca sytuacja, wymaga dalszej obserwacji.","To mo\u017ce zmieni\u0107 ca\u0142\u0105 dynamik\u0119 rynku OZE."],i=["Analityk rynku","Ekspert OZE","Konsultant bran\u017cowy","Ekonomista","Inwestor","Dziennikarz gospodarczy","Lokalny samorz\u0105dowiec","Przedstawiciel sektora","Ekspert ds. regulacji","Obserwator rynku"],r=Array.isArray(n)?n:[],a=Array.isArray(i)?i:[];if(0===r.length||0===a.length)return{text:"Brak dost\u0119pnych komentarzy.",author:"System"};const s=Math.floor(t()*r.length),o=Math.floor(t()*a.length);return{text:r[s],author:a[o],date:new Date}},q=((0,i.useMemo)((()=>r&&o?(()=>{if(!r||!o)return{date:new Date,text:"\u0141adowanie danych...",author:"System",projectReference:null};const e=["Rozpocz\u0119li\u015bmy proces screeningu grunt\xf3w pod k\u0105tem nas\u0142onecznienia i dost\u0119pu do sieci.","Odbyli\u015bmy pierwsze spotkanie z w\u0142a\u015bcicielem terenu \u2013 wykazuje zainteresowanie d\u0142ugoterminow\u0105 dzier\u017caw\u0105 pod PV.","Podpisali\u015bmy list intencyjny na dzier\u017caw\u0119 45 ha pod farm\u0119 wiatrow\u0105.","GIS wskazuje na korzystny wsp\xf3\u0142czynnik irradiacji solarnej na analizowanym terenie.","Wst\u0119pne modelowanie wskazuje na \u015brednioroczny wind yield na poziomie 2800 h.","Analiza warunk\xf3w glebowych potwierdza mo\u017cliwo\u015b\u0107 posadowienia magazynu BESS.","Zaplanowano badania gruntu pod k\u0105tem no\u015bno\u015bci dla turbin wiatrowych.","Umowa przedwst\u0119pna podpisana z opcj\u0105 przed\u0142u\u017cenia po uzyskaniu warunk\xf3w przy\u0142\u0105czenia.","Rozpocz\u0119li\u015bmy coroczny monitoring ornitologiczny i chiropterologiczny.","Wie\u017ca pomiarowa zainstalowana, zbieramy dane wietrzno\u015bci przez minimum 12 miesi\u0119cy.","Analiza zacieniania wykaza\u0142a konieczno\u015b\u0107 odsuni\u0119cia instalacji od granicy lasu.","Optymalizacja zagospodarowania terenu pozwala na zwi\u0119kszenie mocy instalacji do 40 MW.","Shadow flicker w granicach dopuszczalnych norm odleg\u0142o\u015bciowych.","Model akustyczny wykaza\u0142 konieczno\u015b\u0107 ograniczenia mocy turbin w porze nocnej.","Projekt zgodny z miejscowym planem zagospodarowania przestrzennego.","Z\u0142o\u017cyli\u015bmy wniosek o decyzj\u0119 \u015brodowiskow\u0105 dla farmy PV o mocy 100 MW.","Konsultacje spo\u0142eczne planowane na przysz\u0142y miesi\u0105c w \u015bwietlicy gminnej.","Regionalna Dyrekcja Ochrony \u015arodowiska za\u017c\u0105da\u0142a uzupe\u0142nienia raportu OO\u015a.","Gmina wyda\u0142a pozytywn\u0105 opini\u0119 dla projektu magazynu energii BESS.","Z\u0142o\u017cyli\u015bmy wniosek o wydanie warunk\xf3w przy\u0142\u0105czenia do sieci 110 kV.","OSD za\u017c\u0105da\u0142 wykonania ekspertyzy wp\u0142ywu przy\u0142\u0105czenia na system elektroenergetyczny.","Mikrositing turbin wiatrowych zoptymalizowany pod k\u0105tem wydajno\u015bci parku.","Dob\xf3r falownik\xf3w z funkcj\u0105 Q(U) i P(f) zgodnie z wymogami NC RfG.","Uzyskali\u015bmy pozwolenie na budow\u0119 dla farmy PV o mocy 50 MW."],t="number"===typeof r.day?r.day:0,n="number"===typeof r.turn?r.turn:0,i=Array.isArray(e)?e:[];if(0===i.length)return{date:new Date,text:"Brak wpis\xf3w w pami\u0119tniku.",author:"System",projectReference:null};const a=(t+n)%i.length,s=(null===o||void 0===o?void 0:o.projects)||{},l=Array.isArray(s.inDevelopment)?s.inDevelopment:[],c=Array.isArray(s.underConstruction)?s.underConstruction:[],d=Array.isArray(s.completed)?s.completed:[];let u=null;l.length>0?u=l[0]:c.length>0?u=c[0]:d.length>0&&(u=d[0]);let h={date:new Date(r.gameDate||new Date),text:i[a],author:"Developer OZE",projectReference:u?u.name:null};if(u&&u.type)switch(u.type){case"PV":h.text+=" Projekt fotowoltaiczny wymaga szczeg\xf3lnej analizy nas\u0142onecznienia i k\u0105ta nachylenia paneli.";break;case"WF":h.text+=" Dla farm wiatrowych kluczowe jest zbadanie wietrzno\u015bci terenu przez minimum 12 miesi\u0119cy.";break;case"BESS":h.text+=" Magazyn energii wymaga szczeg\xf3lnego uwzgl\u0119dnienia infrastruktury przy\u0142\u0105czeniowej i bezpiecze\u0144stwa."}return h})():{date:new Date,text:"\u0141adowanie danych...",author:"System",projectReference:null}),[null===r||void 0===r?void 0:r.day,null===r||void 0===r?void 0:r.turn,null===o||void 0===o?void 0:o.projects]),e=>{if(!e||!e.type)return(0,a.jsx)(jy,{size:16,className:"text-gray-500"});switch(e.type){case"staff_event":return(0,a.jsx)(Gf,{size:16,className:"text-indigo-500"});case"project_event":return(0,a.jsx)(Jy,{size:16,className:"text-teal-500"});case"economic_event":return(0,a.jsx)(iy,{size:16,className:"text-emerald-500"});case"audit_event":return(0,a.jsx)(hy,{size:16,className:"text-amber-500"});case"illegal_event":return(0,a.jsx)(Og,{size:16,className:"text-rose-500"});case"law_change":return(0,a.jsx)(vy,{size:16,className:"text-blue-500"});case"market_change":return(0,a.jsx)(Lg,{size:16,className:"text-purple-500"});case"regional_event":return(0,a.jsx)(qf,{size:16,className:"text-orange-500"});case"national_event":return(0,a.jsx)(Fg,{size:16,className:"text-blue-500"});case"special_event":return(0,a.jsx)(Kf,{size:16,className:"text-red-500"});default:return(0,a.jsx)(jy,{size:16,className:"text-gray-500"})}}),H=e=>{if(!e)return"text-blue-600 bg-blue-50 border-blue-200";switch(e){case"positive":return"text-green-600 bg-green-50 border-green-200";case"negative":case"high":return"text-red-600 bg-red-50 border-red-200";case"warning":case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"special":return"text-purple-600 bg-purple-50 border-purple-200";default:return"text-blue-600 bg-blue-50 border-blue-200"}},K=e=>{if(!e)return"Inne";return{global_event:"Globalne",local_event:"Lokalne",project_event:"Projekt",staff_event:"Kadry",market_event:"Rynek",company_event:"Firma",political_event:"Polityczne",environmental_event:"\u015arodowiskowe",social_event:"Spo\u0142eczne",technology_event:"Technologiczne",risk_event:"Ryzyko",milestone:"Kamie\u0144 milowy",notification:"Powiadomienie"}[e]||"Inne"},G=e=>{if(!e)return"Inne";return{global:"Globalne",national:"Krajowe",regional:"Regionalne",local:"Lokalne",project:"Projekt",company:"Firma",market:"Rynek",staff:"Kadry",technology:"Technologia"}[e]||"Inne"},Q=e=>{if(!e)return"Data nieznana";if(e instanceof Date||"number"===typeof e&&e>1e5)try{const t=new Date(e);return isNaN(t.getTime())?(console.warn("Nieprawid\u0142owa data:",e),(new Date).toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"})):t.getFullYear()<1970||t.getFullYear()>2100?(console.warn("Data poza realnym zakresem:",t),(new Date).toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"})):t.toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"})}catch(t){return console.error("B\u0142\u0105d podczas formatowania daty:",t),"Data nieprawid\u0142owa"}if(!r||!r.gameDate)return`Tura ${e}`;try{const n=parseInt(r.turn||0),i=n-parseInt(e);if(isNaN(n)||isNaN(i))return`Tura ${e}`;let a;try{if(a=new Date(r.gameDate),isNaN(a.getTime()))return`Tura ${e}`}catch(t){return console.error("B\u0142\u0105d podczas konwersji daty gry:",t),`Tura ${e}`}const s=new Date(a);return s.setDate(a.getDate()-2*i),isNaN(s.getTime())?`Tura ${e}`:s.toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"})}catch(t){return console.error("B\u0142\u0105d podczas formatowania daty tury:",t),`Tura ${e}`}},Z=e=>{let{effects:t,variant:n="list"}=e;if(!t||"object"!==typeof t)return(0,a.jsx)("div",{className:"text-gray-500 text-sm",children:"Brak danych o efektach"});const i=Object.entries(t).filter((e=>{let[t,n]=e;return void 0!==n}));if(0===i.length)return(0,a.jsx)("div",{className:"text-gray-500 text-sm",children:"Brak efekt\xf3w"});const r=e=>({marketModifier:"Wp\u0142yw na rynek",loanInterestRate:"Stopy procentowe",permitTimeModifier:"Czas uzyskania pozwole\u0144",reputationChange:"Zmiana reputacji",buildCostModifier:"Koszty budowy",projectEfficiency:"Efektywno\u015b\u0107 projektu",staffProductivity:"Produktywno\u015b\u0107 personelu"}[e]||e),s=(e,t)=>{if(e.includes("Modifier")){const e=(100*(t-1)).toFixed(1);return`${e>0?"+":""}${e}%`}return"reputationChange"===e||"projectEfficiency"===e||"staffProductivity"===e?`${t>0?"+":""}${t}`:t.toString()};return"grid"===n?(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:i.map((e=>{let[t,n]=e;return(0,a.jsxs)("div",{className:"flex justify-between p-2 bg-gray-100 rounded",children:[(0,a.jsxs)("span",{className:"font-medium",children:[r(t),":"]}),(0,a.jsx)("span",{className:n>1||n>0?"text-green-600 font-bold":"text-red-600 font-bold",children:s(t,n)})]},t)}))}):(0,a.jsx)("ul",{className:"list-disc pl-5 space-y-1",children:i.map((e=>{let[t,n]=e;return(0,a.jsxs)("li",{children:[(0,a.jsxs)("span",{className:"font-medium",children:[r(t),":"]}),(0,a.jsx)("span",{className:n>1||n>0?"text-green-600 ml-1":"text-red-600 ml-1",children:s(t,n)})]},t)}))})};(0,i.useMemo)((()=>{if(!O)return[];try{const e=O.severity||"medium",t="high"===e||"special"===e?3:"medium"===e?2:1,n=[];for(let i=0;i<t;i++)n.push(W(O.id+i));return n}catch(e){return console.error("B\u0142\u0105d przy generowaniu komentarzy:",e),[]}}),[O]),(0,i.useMemo)((()=>{if(!O)return null;const e={};try{switch(O.type){case"economic_event":e.marketModifier=1.05,e.loanInterestRate=.98;break;case"political_event":e.permitTimeModifier=1.1,e.reputationChange=-2;break;case"project_event":e.buildCostModifier=1.03,e.projectEfficiency=5;break;case"staff_event":e.staffProductivity=-3;break;default:Math.random()>.5&&(e.marketModifier=1.02)}return O.effects||e}catch(t){return console.error("B\u0142\u0105d przy generowaniu wp\u0142ywu globalnego:",t),{}}}),[O]),(0,i.useMemo)((()=>{if(!t||!Array.isArray(t.events))return[];try{return t.events.filter((e=>e&&(e.isMilestone||e.requiresDecision||"high"===e.severity||"special"===e.severity||"high"===e.priority))).sort(((e,t)=>{const n=e.turn||e.date||0;return(t.turn||t.date||0)-n})).slice(0,5)}catch(e){return console.error("B\u0142\u0105d przy generowaniu kamieni milowych:",e),[]}}),[null===t||void 0===t?void 0:t.events]);return(0,a.jsxs)("div",{style:Vg.container,className:"events-view-container",children:[(0,a.jsxs)("div",{style:Vg.header,className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Panel Wydarze\u0144"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"\u015aled\u017a wa\u017cne wydarzenia w bran\u017cy OZE i reaguj na zmieniaj\u0105c\u0105 si\u0119 sytuacj\u0119"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("div",{className:"relative mr-2",children:[(0,a.jsx)("input",{type:"text",value:f,onChange:e=>y(e.target.value),placeholder:"Szukaj wydarze\u0144...",className:"border rounded pl-9 pr-3 py-1.5 w-64"}),(0,a.jsx)(vg,{className:"h-4 w-4 text-gray-400 absolute top-2 left-3"})]}),(0,a.jsxs)("button",{onClick:()=>v(!g),className:"flex items-center rounded border px-3 py-1.5 hover:bg-gray-50",children:[(0,a.jsx)(gg,{className:"h-4 w-4 mr-1"}),"Filtry"]})]})]}),(0,a.jsxs)("div",{style:Vg.tabsContainer,className:"overflow-x-auto whitespace-nowrap",children:[(0,a.jsx)("button",{onClick:()=>_("all"),className:"px-4 py-2 font-medium "+("all"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(Fg,{size:16,className:"mr-1"}),"Wszystkie",(0,a.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(U)?U.length:0})]})}),(0,a.jsx)("button",{onClick:()=>_("krajowe"),className:"px-4 py-2 font-medium "+("krajowe"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(Fg,{size:16,className:"mr-1"}),"Krajowe",(0,a.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(null===V||void 0===V?void 0:V.national)?V.national.length:0})]})}),(0,a.jsx)("button",{onClick:()=>_("regionalne"),className:"px-4 py-2 font-medium "+("regionalne"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(qf,{size:16,className:"mr-1"}),"Regionalne",(0,a.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(null===V||void 0===V?void 0:V.regional)?V.regional.length:0})]})}),(0,a.jsx)("button",{onClick:()=>_("lokalne"),className:"px-4 py-2 font-medium "+("lokalne"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(qf,{size:16,className:"mr-1"}),"Lokalne",(0,a.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(null===V||void 0===V?void 0:V.local)?V.local.length:0})]})}),(0,a.jsx)("button",{onClick:()=>_("organizacja"),className:"px-4 py-2 font-medium "+("organizacja"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(vy,{size:16,className:"mr-1"}),"Organizacja",(0,a.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(null===V||void 0===V?void 0:V.organization)?V.organization.length:0})]})}),(0,a.jsx)("button",{onClick:()=>_("projekty"),className:"px-4 py-2 font-medium "+("projekty"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(Jy,{size:16,className:"mr-1"}),"Projekty",(0,a.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(null===V||void 0===V?void 0:V.projects)?V.projects.length:0})]})}),(0,a.jsx)("button",{onClick:()=>_("specjalne"),className:"px-4 py-2 font-medium "+("specjalne"===z?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"),children:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(Og,{size:16,className:"mr-1"}),"Specjalne",(0,a.jsx)("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded-full text-xs",children:Array.isArray(null===V||void 0===V?void 0:V.special)?V.special.length:0})]})})]}),g&&(0,a.jsx)("div",{className:"p-3 border-b",ref:R,children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Typ wydarzenia"}),(0,a.jsxs)("select",{value:w,onChange:e=>x(e.target.value),className:"w-full border rounded px-2 py-1.5 text-sm",children:[(0,a.jsx)("option",{value:"all",children:"Wszystkie typy"}),(0,a.jsx)("option",{value:"economic_event",children:"Ekonomiczne"}),(0,a.jsx)("option",{value:"political_event",children:"Polityczne"}),(0,a.jsx)("option",{value:"social_event",children:"Spo\u0142eczne"}),(0,a.jsx)("option",{value:"environmental_event",children:"\u015arodowiskowe"}),(0,a.jsx)("option",{value:"technological_event",children:"Technologiczne"}),(0,a.jsx)("option",{value:"project_event",children:"Projektowe"}),(0,a.jsx)("option",{value:"staff_event",children:"Kadrowe"}),(0,a.jsx)("option",{value:"reputation_event",children:"Reputacyjne"}),(0,a.jsx)("option",{value:"special_event",children:"Specjalne"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Priorytet"}),(0,a.jsxs)("select",{value:b,onChange:e=>j(e.target.value),className:"w-full border rounded px-2 py-1.5 text-sm",children:[(0,a.jsx)("option",{value:"all",children:"Wszystkie priorytety"}),(0,a.jsx)("option",{value:"high",children:"Wysoki"}),(0,a.jsx)("option",{value:"medium",children:"\u015aredni"}),(0,a.jsx)("option",{value:"low",children:"Niski"})]})]}),"regionalne"===z&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Wojew\xf3dztwo"}),(0,a.jsxs)("select",{value:k,onChange:e=>N(e.target.value),className:"w-full border rounded px-2 py-1.5 text-sm",children:[(0,a.jsx)("option",{value:"all",children:"Wszystkie wojew\xf3dztwa"}),B.map((e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id)))]})]})]})}),(0,a.jsx)("div",{style:Vg.mainContent,className:"flex-grow overflow-hidden",children:(0,a.jsxs)("div",{className:"flex gap-4 h-full",children:[(0,a.jsx)("div",{style:Vg.eventsList,className:"transition-all duration-300 ease-in-out "+(O?"w-1/2":"w-full"),children:(0,a.jsx)("div",{children:Array.isArray($)&&$.length>0?$.map((e=>(0,a.jsxs)("div",{className:"mb-3 p-3 border rounded-lg cursor-pointer transition-shadow hover:shadow-md "+(null!==e&&void 0!==e&&e.read?"bg-white":"bg-blue-50"),onClick:()=>{e&&(L(e),!e.read&&n&&n({type:"MARK_EVENT_READ",payload:e.id}))},children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:`flex h-6 w-6 rounded-full items-center justify-center ${H((null===e||void 0===e?void 0:e.severity)||"neutral")}`,children:q(e)}),(0,a.jsx)("h3",{className:"font-medium ml-2 flex-1",children:(null===e||void 0===e?void 0:e.title)||"Wydarzenie bez tytu\u0142u"})]}),(0,a.jsx)("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:Q((null===e||void 0===e?void 0:e.turn)||new Date)})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:(null===e||void 0===e?void 0:e.description)||"Brak opisu"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[(null===e||void 0===e?void 0:e.scope)&&(0,a.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 rounded-full text-xs",children:G(e.scope)}),(null===e||void 0===e?void 0:e.type)&&(0,a.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 rounded-full text-xs",children:K(e.type)}),(null===e||void 0===e?void 0:e.requiresDecision)&&(0,a.jsx)("span",{className:"px-2 py-0.5 bg-red-100 text-red-800 rounded-full text-xs",children:"Wymaga decyzji"})]})]},(null===e||void 0===e?void 0:e.id)||Math.random().toString()))):(0,a.jsxs)("div",{style:Vg.noEvents,children:[(0,a.jsx)(Ug,{className:"h-12 w-12 text-gray-300 mb-2"}),(0,a.jsx)("h3",{className:"text-lg font-medium mb-1",children:"Brak wydarze\u0144"}),(0,a.jsx)("p",{className:"text-sm",children:"Nie ma obecnie \u017cadnych wydarze\u0144 do wy\u015bwietlenia w wybranej kategorii."})]})})}),O&&(0,a.jsxs)("div",{style:Vg.eventDetails,className:"animate-slide-in",ref:D,children:[(0,a.jsxs)("div",{className:"mb-4 pb-3 border-b flex justify-between items-start",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:O.title||"Szczeg\xf3\u0142y wydarzenia"}),(0,a.jsx)("button",{onClick:()=>L(null),className:"p-1 hover:bg-gray-100 rounded",children:(0,a.jsx)(wy,{size:18})})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-gray-700 mb-4",children:O.description}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,a.jsx)(Uf,{size:16,className:"mr-1"}),(0,a.jsxs)("span",{children:["Data: ",Q(O.turn||new Date)]})]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,a.jsx)(Vf,{size:16,className:"mr-1"}),(0,a.jsxs)("span",{children:["Wygasa: ",O.expires?Q(O.expires):"Nigdy"]})]}),O.region&&(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,a.jsx)(qf,{size:16,className:"mr-1"}),(0,a.jsxs)("span",{children:["Region: ",O.region]})]}),O.projectId&&(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,a.jsx)(Jy,{size:16,className:"mr-1"}),(0,a.jsxs)("span",{children:["Projekt: ",O.projectName||O.projectId]})]}),(0,a.jsxs)("div",{className:"mt-3 flex flex-wrap gap-1",children:[O.scope&&(0,a.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 rounded-full text-xs",children:G(O.scope)}),O.type&&(0,a.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 rounded-full text-xs",children:K(O.type)}),O.severity&&(0,a.jsx)("span",{className:`px-2 py-0.5 rounded-full text-xs ${H(O.severity)}`,children:(e=>{if(!e)return"Informacja";return{positive:"Pozytywne",negative:"Negatywne",warning:"Ostrze\u017cenie",special:"Specjalne",high:"Wysoki priorytet",medium:"\u015aredni priorytet",low:"Niski priorytet",info:"Informacja"}[e]||"Informacja"})(O.severity)})]})]}),O.effects&&Object.keys(O.effects).length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Efekty wydarzenia:"}),(0,a.jsx)(Z,{effects:O.effects})]}),O.requiresDecision&&O.decisions&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Wymagana decyzja:"}),(0,a.jsx)("div",{className:"space-y-2",children:O.decisions.map((e=>(0,a.jsxs)("button",{className:"w-full p-3 border rounded hover:bg-gray-50 text-left flex justify-between items-center",onClick:()=>(e=>{if(O&&O.options&&n)try{if(!O.options.find((t=>t.id===e)))return;n({type:"EVENT_DECISION",payload:{eventId:O.id,optionId:e}}),L(null)}catch(t){console.error("B\u0142\u0105d przy podejmowaniu decyzji:",t)}})(O.id,e.id),children:[(0,a.jsx)("span",{children:e.label}),(0,a.jsx)("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:e.effects.reputationImpact?`Reputacja: ${e.effects.reputationImpact>0?"+":""}${e.effects.reputationImpact}`:e.effects.cashImpact?`Got\xf3wka: ${e.effects.cashImpact>0?"+":""}${e.effects.cashImpact.toLocaleString()} PLN`:"Efekt specjalny"})]},e.id)))})]})]})]})})]})};class Gg extends i.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("B\u0142\u0105d w EventsView:",e,t)}render(){return this.state.hasError?(0,a.jsxs)("div",{className:"p-8 flex flex-col items-center justify-center",children:[(0,a.jsx)(Og,{className:"w-16 h-16 text-red-500 mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-bold text-red-700 mb-2",children:"B\u0142\u0105d w panelu wydarze\u0144"}),(0,a.jsx)("p",{className:"text-gray-600 text-center mb-4",children:"Panel wydarze\u0144 wymaga odpowiednich kontekst\xf3w aplikacji. Upewnij si\u0119, \u017ce komponent jest u\u017cywany wewn\u0105trz:"}),(0,a.jsxs)("ul",{className:"list-disc pl-5 text-gray-600 mb-4",children:[(0,a.jsx)("li",{children:"EventsProvider"}),(0,a.jsx)("li",{children:"GameProvider"}),(0,a.jsx)("li",{children:"PlayerProvider"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:this.state.error?this.state.error.message:"Nieznany b\u0142\u0105d"})]}):this.props.children}}const Qg=e=>e&&"object"===typeof e,Zg=(e,t)=>{try{const n=e();return n||(console.warn(`${t} nie jest dost\u0119pny`),null)}catch(n){return console.error(`B\u0142\u0105d przy pobieraniu ${t}:`,n),null}},Yg=()=>{const[e,t]=(0,i.useState)(null),[n,r]=(0,i.useState)(!1),[s,o]=(0,i.useState)(null),l=Zg(H,"EventsContext"),c=Zg(ff,"GameContext"),d=Zg(u,"PlayerContext");(0,i.useEffect)((()=>{try{const e=()=>{t(null)};return window.addEventListener("next-game-day",e),l&&c&&d?r(!0):o("Brak wymaganych kontekst\xf3w"),()=>{window.removeEventListener("next-game-day",e)}}catch(s){console.error("B\u0142\u0105d w useEffect EventsView:",s),o(s.message||"Nieznany b\u0142\u0105d")}}),[l,c,d]);const h=e=>{let{message:t}=e;return(0,a.jsxs)("div",{className:"p-8 flex flex-col items-center justify-center",children:[(0,a.jsx)(Og,{className:"w-16 h-16 text-red-500 mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-bold text-red-700 mb-2",children:"B\u0142\u0105d kontekstu"}),(0,a.jsx)("p",{className:"text-gray-600 text-center mb-4",children:"Panel wydarze\u0144 wymaga odpowiednich kontekst\xf3w aplikacji. Upewnij si\u0119, \u017ce komponent jest u\u017cywany wewn\u0105trz:"}),(0,a.jsxs)("ul",{className:"list-disc pl-5 text-gray-600 mb-4",children:[(0,a.jsx)("li",{children:"EventsProvider"}),(0,a.jsx)("li",{children:"GameProvider"}),(0,a.jsx)("li",{children:"PlayerProvider"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:t})]})};return s?(0,a.jsx)(h,{message:s}):n?Qg(null===l||void 0===l?void 0:l.state)&&null!==l&&void 0!==l&&l.dispatch?Qg(null===c||void 0===c?void 0:c.state)&&null!==c&&void 0!==c&&c.dispatch?Qg(null===d||void 0===d?void 0:d.state)&&null!==d&&void 0!==d&&d.dispatch?(Array.isArray(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{if(null===e||void 0===e)return n;if(!t)return e;const i=t.split(".");let r=e;for(let e=0;e<i.length;e++){const t=i[e];if(null===r||void 0===r)return n;r=r[t]}return null===r||void 0===r?n:r}catch(i){return console.error(`B\u0142\u0105d dost\u0119pu do \u015bcie\u017cki: ${t}`,i),n}}(l,"state.events"))||(console.warn("Events w EventsContext nie jest tablic\u0105. Inicjalizacja pust\u0105 tablic\u0105."),l.state&&(l.state.events=[])),(0,a.jsx)(Gg,{children:(0,a.jsx)(Hg,{eventsState:l.state,eventsDispatch:l.dispatch,gameState:c.state,gameDispatch:c.dispatch,playerState:d.state,playerDispatch:d.dispatch,selectedEvent:e,setSelectedEvent:t})})):(0,a.jsx)(h,{message:"PlayerContext jest niekompletny"}):(0,a.jsx)(h,{message:"GameContext jest niekompletny"}):(0,a.jsx)(h,{message:"EventsContext jest niekompletny"}):(0,a.jsxs)("div",{className:"p-8 flex flex-col items-center justify-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500 mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"\u0141adowanie panelu wydarze\u0144..."})]})},Jg=()=>(0,a.jsx)(Gg,{children:(0,a.jsx)(Yg,{})}),Xg=e=>{let{competitor:t,playerPower:n}=e;return(0,a.jsxs)("div",{className:"border rounded p-3",children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:t.name}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:"Strategia:"})," ",Oy(t.strategy)]}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:"Reputacja:"})," ",t.reputation,"/100"]}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:"Tempo wzrostu:"})," ",(100*(t.growth-1)).toFixed(1),"% na tur\u0119"]}),(0,a.jsx)("div",{className:"text-sm",children:(0,a.jsx)("span",{className:"font-medium",children:"Silne regiony:"})}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:t.strongRegions.map((e=>(0,a.jsx)("div",{className:"text-xs bg-gray-200 px-2 py-1 rounded",children:e},e)))}),(0,a.jsx)("div",{className:"text-sm mt-2 text-gray-600 italic",children:Ly(t,n)})]})]})},ev=e=>{let{ranking:t}=e;return(0,a.jsxs)("div",{className:"bg-white p-4 rounded shadow mb-4",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-3",children:"Ranking deweloper\xf3w OZE"}),(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-100",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-center p-2",children:"Miejsce"}),(0,a.jsx)("th",{className:"text-left p-2",children:"Firma"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Moc RTB"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Portfel projekt\xf3w"}),(0,a.jsx)("th",{className:"text-right p-2",children:"Udzia\u0142 w rynku"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:t.map(((e,n)=>{const i="player"===e.id,r=(e.rtbPower/t.reduce(((e,t)=>e+t.rtbPower),0)*100).toFixed(1);return(0,a.jsxs)("tr",{className:""+(i?"bg-blue-50":"hover:bg-gray-50"),children:[(0,a.jsx)("td",{className:"text-center p-2 font-medium",children:n+1}),(0,a.jsx)("td",{className:"p-2",children:i?(0,a.jsx)("div",{className:"font-bold text-blue-600",children:e.name}):e.name}),(0,a.jsxs)("td",{className:"text-center p-2",children:[e.rtbPower.toLocaleString()," MW"]}),(0,a.jsxs)("td",{className:"text-center p-2",children:[e.power.toLocaleString()," MW"]}),(0,a.jsx)("td",{className:"text-right p-2",children:(0,a.jsxs)("div",{className:"flex items-center justify-end",children:[(0,a.jsxs)("div",{children:[r,"%"]}),(0,a.jsx)("div",{className:"ml-2 w-16 bg-gray-200 h-2 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full "+(i?"bg-blue-500":"bg-gray-500"),style:{width:`${r}%`}})})]})})]},e.id)}))})]})]})},tv=e=>{let{playerRank:t,ranking:n,playerPower:i}=e;return(0,a.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Twoja pozycja na rynku"}),1===t?(0,a.jsxs)("div",{className:"p-3 bg-green-100 text-green-800 rounded",children:[(0,a.jsx)("div",{className:"font-bold",children:"Jeste\u015b liderem rynku!"}),(0,a.jsx)("p",{className:"text-sm mt-1",children:"Utrzymuj przewag\u0119 nad konkurencj\u0105 rozwijaj\u0105c projekty w r\xf3\u017cnych regionach."})]}):(0,a.jsxs)("div",{className:"p-3 bg-blue-100 text-blue-800 rounded",children:[(0,a.jsxs)("div",{className:"font-bold",children:["Jeste\u015b na ",t,". miejscu"]}),(0,a.jsxs)("p",{className:"text-sm mt-1",children:["Do lidera brakuje Ci ",(n[0].rtbPower-i).toLocaleString()," MW mocy w projektach RTB."]})]}),(0,a.jsxs)("div",{className:"mt-3 text-sm",children:[(0,a.jsxs)("p",{children:["Tw\xf3j udzia\u0142 w rynku: ",(i/n.reduce(((e,t)=>e+t.rtbPower),0)*100).toFixed(1),"%"]}),(0,a.jsx)("p",{className:"mt-1",children:"Tempo wzrostu twojego portfela zale\u017cy od liczby projekt\xf3w i zatrudnionych specjalist\xf3w."})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("div",{className:"font-medium mb-2",children:"Post\u0119p do celu (100 GW):"}),(0,a.jsx)("div",{className:"w-full bg-gray-200 h-4 rounded-full overflow-hidden mt-1",children:(0,a.jsx)("div",{className:"h-full bg-green-500 relative",style:{width:`${Math.min(100,i/1e5*100)}%`},children:(0,a.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center text-xs text-white font-bold",children:[(i/1e5*100).toFixed(1),"%"]})})})]})]})},nv=e=>{let{competitors:t,playerPower:n}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Analiza konkurent\xf3w"}),(0,a.jsx)("ul",{className:"text-sm space-y-2",children:t.map((e=>(0,a.jsxs)("li",{className:"flex",children:[(0,a.jsx)("div",{className:"text-blue-600 font-bold mr-2",children:"\u2022"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"font-medium",children:[e.name,":"]})," ",Ly(e,n)]})]},e.id)))})]}),(0,a.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Porady strategiczne"}),(0,a.jsxs)("ul",{className:"text-sm space-y-2",children:[(0,a.jsxs)("li",{className:"flex",children:[(0,a.jsx)("div",{className:"text-green-600 font-bold mr-2",children:"\u2022"}),(0,a.jsx)("div",{children:"Skupiaj si\u0119 na regionach z dobrymi warunkami wiatrowymi/s\u0142onecznymi i nisk\u0105 konkurencj\u0105."})]}),(0,a.jsxs)("li",{className:"flex",children:[(0,a.jsx)("div",{className:"text-green-600 font-bold mr-2",children:"\u2022"}),(0,a.jsx)("div",{children:"Zatrudniaj do\u015bwiadczonych specjalist\xf3w, aby przyspieszy\u0107 rozw\xf3j projekt\xf3w."})]}),(0,a.jsxs)("li",{className:"flex",children:[(0,a.jsx)("div",{className:"text-green-600 font-bold mr-2",children:"\u2022"}),(0,a.jsx)("div",{children:"Dywersyfikuj portfolio projekt\xf3w geograficznie, aby minimalizowa\u0107 ryzyko."})]}),(0,a.jsxs)("li",{className:"flex",children:[(0,a.jsx)("div",{className:"text-green-600 font-bold mr-2",children:"\u2022"}),(0,a.jsx)("div",{children:"Monitoruj ruchy konkurencji i unikaj region\xf3w, w kt\xf3rych s\u0105 dominuj\u0105cy gracze."})]}),(0,a.jsxs)("li",{className:"flex",children:[(0,a.jsx)("div",{className:"text-green-600 font-bold mr-2",children:"\u2022"}),(0,a.jsx)("div",{children:"Inwestuj w projekty z wysokim ROI, aby maksymalizowa\u0107 zwrot z inwestycji."})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Cel gry"}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("p",{children:"Twoim celem jest osi\u0105gni\u0119cie 100,000 MW (100 GW) mocy w projektach RTB jako pierwszy deweloper."}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("div",{className:"font-medium",children:"Post\u0119p do celu:"}),(0,a.jsx)("div",{className:"w-full bg-gray-200 h-4 rounded-full overflow-hidden mt-1",children:(0,a.jsx)("div",{className:"h-full bg-green-500 relative",style:{width:`${Math.min(100,n/1e5*100)}%`},children:(0,a.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center text-xs text-white font-bold",children:[(n/1e5*100).toFixed(1),"%"]})})})]})]})]})]})},iv=()=>{const{state:e}=ff(),{state:t}=u(),n=[...e.competitors].sort(((e,t)=>t.rtbPower-e.rtbPower)),i=[...n,{id:"player",name:"Twoja firma",rtbPower:t.rtbPower,power:1.2*t.rtbPower}].sort(((e,t)=>t.rtbPower-e.rtbPower)),r=i.findIndex((e=>"player"===e.id))+1;return(0,a.jsxs)("div",{className:"flex flex-1",children:[(0,a.jsxs)("div",{className:"flex-1 p-4 overflow-y-auto",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Analiza konkurencji"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Twoja pozycja"}),(0,a.jsxs)("div",{className:"text-xl font-bold",children:[r," miejsce"]})]}),(0,a.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Twoja moc RTB"}),(0,a.jsxs)("div",{className:"text-xl font-bold",children:[t.rtbPower.toLocaleString()," MW"]})]}),(0,a.jsxs)("div",{className:"bg-white p-3 rounded shadow",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Lider rynku"}),(0,a.jsx)("div",{className:"text-xl font-bold",children:i[0].name}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[i[0].rtbPower.toLocaleString()," MW"]})]})]}),(0,a.jsx)(ev,{ranking:i}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-3",children:"Strategie konkurent\xf3w"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-4",children:n.map((e=>(0,a.jsx)(Xg,{competitor:e,playerPower:t.rtbPower},e.id)))})]})]}),(0,a.jsxs)("div",{className:"w-1/3 bg-gray-100 p-4 overflow-y-auto",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Analiza rynku i porady"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(tv,{playerRank:r,ranking:i,playerPower:t.rtbPower}),(0,a.jsx)(nv,{competitors:n,playerPower:t.rtbPower})]})]})]})},rv=e=>{let{children:t,title:n,className:i="",headerAction:r=null,footer:s=null,...o}=e;return(0,a.jsxs)("div",{className:`bg-white p-4 rounded shadow ${i}`,...o,children:[n&&(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,a.jsx)("h3",{className:"font-bold text-lg",children:n}),r]}),(0,a.jsx)("div",{className:"card-content",children:t}),s&&(0,a.jsx)("div",{className:"card-footer mt-4 pt-3 border-t border-gray-200",children:s})]})},av=()=>{const{state:e,dispatch:t}=u(),{state:n,dispatch:r,showNotification:s,calculateEventsEffect:o}=ff(),{dispatch:l}=H(),[c,d]=(0,i.useState)("all"),[h,p]=(0,i.useState)("power"),[m,f]=(0,i.useState)("desc"),y=[...e.projects.filter((e=>"all"===c||("pv"===c?"PV"===e.technology:"wf"===c?"WF"===e.technology:"rtb"!==c||"ready_to_build"===e.status)))].sort(((e,t)=>{if("power"===h)return"asc"===m?e.power-t.power:t.power-e.power;if("price"===h)return"asc"===m?e.totalCost-t.totalCost:t.totalCost-e.totalCost;if("stage"===h){const n=["land_acquisition","environmental_decision","zoning_conditions","grid_connection","ready_to_build"],i=n.indexOf(e.status),r=n.indexOf(t.status);return"asc"===m?i-r:r-i}return 0})),g=t=>{var i;const r=15e4*t.power,a=o("marketModifier"),c={PV:1*n.marketPriceModifiers.PV*a,WF:1.2*n.marketPriceModifiers.WF*a,BESS:1.5*n.marketPriceModifiers.BESS*a},d=1;n.globalEvents.currentEvents.length>0&&n.globalEvents.currentEvents.forEach((e=>{const n=e.getEffect();n.technologyEffect&&n.technologyEffect.technology===t.technology&&n.technologyEffect.marketModifier&&(d*=n.technologyEffect.marketModifier)}));const u={land_acquisition:.15,environmental_decision:.35,zoning_conditions:.55,grid_connection:.85,ready_to_build:1}[t.status]||.1,h=c[t.technology]*d||1,p=1+t.power/100*.2;let m=1;n.globalEvents.currentEvents.length>0&&n.globalEvents.currentEvents.forEach((e=>{const n=e.getEffect();n.regionalEffect&&n.regionalEffect.region===t.regionId&&n.regionalEffect.marketModifier&&(m*=n.regionalEffect.marketModifier)}));const f=null===(i=e.staff.developers)||void 0===i?void 0:i.find((e=>e.id===t.assignedDeveloper)),y=f?1+f.skill/20:1;let g=null,v=1;const w=n.globalEvents.currentEvents.length>0?.05:.1;if(Math.random()<w){g=[{name:"Nag\u0142y spadek cen energii",impact:.85,description:"Ceny energii na rynku spad\u0142y o 15%, obni\u017caj\u0105c warto\u015b\u0107 projekt\xf3w OZE."},{name:"Zmiana regulacji",impact:.8,description:"Niekorzystne zmiany w ustawie o OZE obni\u017cy\u0142y warto\u015b\u0107 projekt\xf3w."},{name:"Lokalne protesty",impact:.9,description:"Protesty mieszka\u0144c\xf3w zniech\u0119caj\u0105 potencjalnych inwestor\xf3w."},{name:"Problem geologiczny",impact:.7,description:"Wykryto potencjalne problemy geologiczne na terenie projektu."},{name:"Korzystna zmiana warunk\xf3w aukcji",impact:1.15,description:"Planowane aukcje OZE z korzystnymi warunkami podnios\u0142y warto\u015b\u0107 projektu."},{name:"Wzmo\u017cone zainteresowanie inwestor\xf3w",impact:1.2,description:"Duzi inwestorzy poszukuj\u0105 projekt\xf3w w tym regionie."}][Math.random()<.7?Math.floor(4*Math.random()):Math.floor(2*Math.random())+4],v=g.impact}const x=Math.floor(r*u*h*p*m*y*v);if(g){const e=v<1?"warning":"positive";l({type:"ADD_EVENT",payload:{id:Date.now()+Math.random(),type:"economic_event",title:g.name,description:g.description,severity:e,turn:n.turn,expires:n.turn+10,projectId:t.id,effect:{type:"market_price_modifier",value:v,technology:t.technology}}}),s(`${g.name}: ${g.description} Wp\u0142yw na cen\u0119: ${(100*g.impact).toFixed(0)}%`,e)}return x},v=e=>{switch(e){case"land_acquisition":return(0,a.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:"Pozyskiwanie grunt\xf3w"});case"environmental_decision":return(0,a.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs",children:"Decyzja \u015brodowiskowa"});case"zoning_conditions":return(0,a.jsx)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs",children:"Warunki zabudowy"});case"grid_connection":return(0,a.jsx)("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 rounded-full text-xs",children:"Przy\u0142\u0105czenie"});case"ready_to_build":return(0,a.jsx)("span",{className:"px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs",children:"RTB"});default:return(0,a.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 rounded-full text-xs",children:e})}};return(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Sprzeda\u017c projekt\xf3w na gie\u0142dzie"}),(0,a.jsx)("div",{className:"bg-white p-4 rounded shadow mb-4",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Filtruj"}),(0,a.jsxs)("select",{value:c,onChange:e=>d(e.target.value),className:"border rounded px-2 py-1",children:[(0,a.jsx)("option",{value:"all",children:"Wszystkie projekty"}),(0,a.jsx)("option",{value:"pv",children:"Tylko PV"}),(0,a.jsx)("option",{value:"wf",children:"Tylko wiatrowe"}),(0,a.jsx)("option",{value:"rtb",children:"Tylko RTB"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Sortuj wed\u0142ug"}),(0,a.jsxs)("select",{value:h,onChange:e=>p(e.target.value),className:"border rounded px-2 py-1",children:[(0,a.jsx)("option",{value:"power",children:"Mocy [MW]"}),(0,a.jsx)("option",{value:"price",children:"Ceny"}),(0,a.jsx)("option",{value:"stage",children:"Etapu"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Kolejno\u015b\u0107"}),(0,a.jsxs)("select",{value:m,onChange:e=>f(e.target.value),className:"border rounded px-2 py-1",children:[(0,a.jsx)("option",{value:"asc",children:"Rosn\u0105co"}),(0,a.jsx)("option",{value:"desc",children:"Malej\u0105co"})]})]})]})}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded shadow mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-bold mb-3",children:"Aktualna wycena projekt\xf3w"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Warto\u015b\u0107 projekt\xf3w zale\u017cy od etapu rozwoju, technologii, lokalizacji i jako\u015bci pracy developera. Rynek mo\u017ce ulega\u0107 wahaniom w zale\u017cno\u015bci od zdarze\u0144 ekonomicznych."}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[(0,a.jsxs)("div",{className:"border rounded p-3",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Etap RTB"}),(0,a.jsx)("div",{className:"font-bold",children:"x10 wy\u017csza wycena"})]}),(0,a.jsxs)("div",{className:"border rounded p-3",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Technologia"}),(0,a.jsx)("div",{className:"font-bold",children:"PV: x1.0 | WF: x1.2 | BESS: x1.5"})]}),(0,a.jsxs)("div",{className:"border rounded p-3",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Umiej\u0119tno\u015bci developera"}),(0,a.jsx)("div",{className:"font-bold",children:"do +50% dla eksperta"})]}),(0,a.jsxs)("div",{className:"border rounded p-3",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Wielko\u015b\u0107 projektu"}),(0,a.jsx)("div",{className:"font-bold",children:"+20% dla 100MW"})]})]})]}),(0,a.jsx)("div",{className:"bg-white rounded shadow overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-100",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left p-3",children:"Projekt"}),(0,a.jsx)("th",{className:"text-center p-3",children:"Technologia"}),(0,a.jsx)("th",{className:"text-center p-3",children:"Moc"}),(0,a.jsx)("th",{className:"text-center p-3",children:"Status"}),(0,a.jsx)("th",{className:"text-right p-3",children:"Cena sprzeda\u017cy"}),(0,a.jsx)("th",{className:"text-right p-3",children:"Zysk"}),(0,a.jsx)("th",{className:"text-center p-3",children:"Akcje"})]})}),(0,a.jsx)("tbody",{className:"divide-y",children:y.length>0?y.map((i=>{const o=g(i),c=o-i.totalCost,d=(c/i.totalCost*100).toFixed(1),u=["land_acquisition","environmental_decision","zoning_conditions","grid_connection","ready_to_build"],h=u.indexOf("environmental_decision"),p=u.indexOf(i.status)>=h;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsxs)("td",{className:"p-3",children:[(0,a.jsx)("div",{className:"font-medium",children:i.name}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:i.county?`Powiat ${i.county.name}`:"Brak lokalizacji"})]}),(0,a.jsx)("td",{className:"text-center p-3",children:i.technology}),(0,a.jsxs)("td",{className:"text-center p-3",children:[i.power," MW"]}),(0,a.jsx)("td",{className:"text-center p-3",children:v(i.status)}),(0,a.jsxs)("td",{className:"text-right p-3 font-medium",children:[o.toLocaleString()," PLN"]}),(0,a.jsxs)("td",{className:"text-right p-3",children:[(0,a.jsxs)("div",{className:c>=0?"text-green-600":"text-red-600",children:[c.toLocaleString()," PLN"]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[d,"%"]})]}),(0,a.jsx)("td",{className:"text-center p-3",children:(0,a.jsx)("button",{onClick:()=>(i=>{const a=e.projects.find((e=>e.id===i));if(!a)return;const o=["land_acquisition","environmental_decision","zoning_conditions","grid_connection","ready_to_build"],c=o.indexOf("environmental_decision");if(o.indexOf(a.status)<c)return void s(`Nie mo\u017cna sprzeda\u0107 projektu na etapie "${My(a.status)}". Projekt musi osi\u0105gn\u0105\u0107 co najmniej etap decyzji \u015brodowiskowej.`,"error");const d=g(a);r({type:"ADD_MARKET_TRANSACTION",payload:{id:Date.now(),projectId:a.id,projectName:a.name,technology:a.technology,power:a.power,status:a.status,price:d,turn:n.turn,seller:"player",date:(new Date).toISOString()}}),t({type:"SELL_PROJECT",payload:{projectId:a.id,price:d}}),a.county,l({type:"ADD_EVENT",payload:{id:Date.now()+Math.random(),type:"project_event",title:`Sprzeda\u017c projektu: ${a.name}`,description:`Projekt ${a.name} zosta\u0142 sprzedany za ${d.toLocaleString()} z\u0142.`,severity:"positive",turn:n.turn,expires:n.turn+5,projectId:a.id}}),s(`Sprzedano projekt "${a.name}" za ${d.toLocaleString()} PLN na gie\u0142dzie`,"success")})(i.id),className:`px-3 py-1 ${p?"bg-green-500 hover:bg-green-600":"bg-gray-400 cursor-not-allowed"} text-white rounded text-sm`,disabled:!p,title:p?"":"Projekt musi osi\u0105gn\u0105\u0107 etap decyzji \u015brodowiskowej",children:"Sprzedaj"})})]},i.id)})):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"7",className:"p-4 text-center text-gray-500",children:"Brak projekt\xf3w spe\u0142niaj\u0105cych kryteria filtrowania"})})})]})}),(0,a.jsxs)("div",{className:"bg-white rounded shadow overflow-hidden mt-6",children:[(0,a.jsx)("div",{className:"p-4 border-b",children:(0,a.jsx)("h3",{className:"text-lg font-bold",children:"Historia sprzeda\u017cy"})}),n.marketHistory.length>0?(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-100",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left p-3",children:"Projekt"}),(0,a.jsx)("th",{className:"text-center p-3",children:"Technologia"}),(0,a.jsx)("th",{className:"text-center p-3",children:"Moc"}),(0,a.jsx)("th",{className:"text-center p-3",children:"Status"}),(0,a.jsx)("th",{className:"text-right p-3",children:"Cena"}),(0,a.jsx)("th",{className:"text-center p-3",children:"Tura"})]})}),(0,a.jsx)("tbody",{className:"divide-y",children:n.marketHistory.map((e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"p-3",children:e.projectName}),(0,a.jsx)("td",{className:"text-center p-3",children:e.technology}),(0,a.jsxs)("td",{className:"text-center p-3",children:[e.power," MW"]}),(0,a.jsx)("td",{className:"text-center p-3",children:v(e.status)}),(0,a.jsxs)("td",{className:"text-right p-3 font-medium",children:[e.price.toLocaleString()," PLN"]}),(0,a.jsx)("td",{className:"text-center p-3",children:e.turn})]},e.id)))})]}):(0,a.jsx)("p",{className:"p-4 text-center text-gray-500",children:"Brak historii transakcji"})]})]})},sv=()=>{const[e,t]=(0,i.useState)("available"),[n,r]=(0,i.useState)("all"),[s,o]=(0,i.useState)("all"),{state:l,dispatch:c}=u(),{state:d,showNotification:h}=ff(),p=["land_acquisition","environmental_decision","zoning_conditions","grid_connection","ready_to_build","constructed"],[m,f]=(0,i.useState)([{id:1,name:"PV-MAZ1234",technology:"PV",status:"greenfield",developmentStatus:"land_acquisition",developmentProgress:0,region:"mazowieckie",power:15,price:225e3,seller:"Inny deweloper",listedOn:new Date(2025,2,1)},{id:2,name:"WF-ZAP4321",technology:"WF",status:"development",developmentStatus:"environmental_decision",developmentProgress:35,region:"zachodniopomorskie",power:30,price:1392e3,seller:"Fundusz inwestycyjny",listedOn:new Date(2025,2,5)},{id:3,name:"BESS-MAL5678",technology:"BESS",status:"development",developmentStatus:"zoning_conditions",developmentProgress:65,region:"ma\u0142opolskie",power:10,price:4e6,seller:"Prywatny inwestor",listedOn:new Date(2025,2,8)},{id:4,name:"PV-POM7890",technology:"PV",status:"development",developmentStatus:"grid_connection",developmentProgress:80,region:"pomorskie",power:25,price:315e4,seller:"Fundusz OZE",listedOn:new Date(2025,2,10)},{id:5,name:"WF-LUB2468",technology:"WF",status:"rtb",developmentStatus:"ready_to_build",developmentProgress:100,region:"lubelskie",power:45,price:189e5,seller:"Mi\u0119dzynarodowy Deweloper",listedOn:new Date(2025,2,12)},{id:6,name:"PV-KUJ1357",technology:"PV",status:"development",developmentStatus:"environmental_decision",developmentProgress:40,region:"kujawsko-pomorskie",power:18,price:198e4,seller:"Sp\xf3\u0142ka projektowa",listedOn:new Date(2025,2,15),isResale:!0,originalPrice:22e5},{id:7,name:"BESS-DOL9753",technology:"BESS",status:"cod",developmentStatus:"constructed",developmentProgress:100,region:"dolno\u015bl\u0105skie",power:8,price:12e6,seller:"Fundusz Infrastrukturalny",listedOn:new Date(2025,2,18)}]),y=m.filter((e=>("all"===n||e.technology===n)&&("all"===s||e.status===s))),g=()=>{const e=Object.keys(Uy),t=e[Math.floor(Math.random()*e.length)],n=Uy[t],i=["greenfield","development","development","development","rtb","cod"],r=i[Math.floor(Math.random()*i.length)],a=Math.floor(Math.random()*p.length),s=p[a],o="land_acquisition"===s?10:"environmental_decision"===s?30:"zoning_conditions"===s?55:"grid_connection"===s?75:100,l=["mazowieckie","ma\u0142opolskie","wielkopolskie","zachodniopomorskie","podlaskie","kujawsko-pomorskie","pomorskie","lubelskie","dolno\u015bl\u0105skie","\u015bl\u0105skie","podkarpackie","lubuskie"],c=l[Math.floor(Math.random()*l.length)],d=Math.floor(5+45*Math.random()),u=n.marketPrices[r]||n.marketPrices.development,h=u.min+Math.random()*(u.max-u.min),m=.85+.3*Math.random(),f=Math.floor(h*d*m),y=Math.random()<.15,g=y?Math.floor(f*(.05+.1*Math.random()+1)):f,v=["Inny deweloper","Fundusz inwestycyjny","Prywatny inwestor","Sp\xf3\u0142ka projektowa","Fundusz OZE","Mi\u0119dzynarodowy Deweloper","Fundusz Infrastrukturalny","Sp\xf3\u0142ka energetyczna","Bank inwestycyjny"],w=v[Math.floor(Math.random()*v.length)];return{id:Date.now()+Math.floor(1e3*Math.random()),name:`${n.shortName}-${c.substring(0,3).toUpperCase()}${Math.floor(1e4*Math.random())}`,technology:t,status:r,developmentStatus:s,developmentProgress:o,region:c,power:d,price:f,seller:w,listedOn:new Date,isResale:y,originalPrice:y?g:f}},v=()=>{try{const e=10;let t=[...m];t.length>e&&(t=t.slice(-Math.floor(e/2)));const n=e-t.length,i=Math.min(Math.floor(1+3*Math.random()),n),r=Date.now();if(window.lastMarketRefresh||(window.lastMarketRefresh=0),r-window.lastMarketRefresh<5e3)return void console.log("Zbyt cz\u0119ste od\u015bwie\u017canie gie\u0142dy. Poczekaj chwil\u0119.");window.lastMarketRefresh=r;const a=[];for(let s=0;s<i;s++)a.push(g());f([...t,...a]),a.length>0&&h(`Dodano ${a.length} ${1===a.length?"nowy projekt":"nowe projekty"} na gie\u0142d\u0119`,"info")}catch(e){console.error("B\u0142\u0105d podczas od\u015bwie\u017cania gie\u0142dy:",e),h("Wyst\u0105pi\u0142 b\u0142\u0105d podczas od\u015bwie\u017cania gie\u0142dy projekt\xf3w","error")}};(0,i.useEffect)((()=>{m.length<=7&&v(),d.turn%3===0&&(()=>{try{const e=10;if(m.length>=e)return void console.log("Osi\u0105gni\u0119to maksymaln\u0105 liczb\u0119 projekt\xf3w na gie\u0142dzie");const t=Date.now();if(window.lastMarketGeneration||(window.lastMarketGeneration=0),t-window.lastMarketGeneration<1e4)return void console.log("Zbyt cz\u0119ste generowanie projekt\xf3w. Poczekaj chwil\u0119.");window.lastMarketGeneration=t;const n=e-m.length,i=Math.min(1+Math.floor(2*Math.random()),n),r=[];for(let a=0;a<i;a++)r.push(g());f((t=>t.length>=e?t:(r.length>0&&h(`Na gie\u0142dzie pojawi\u0142o si\u0119 ${r.length} ${1===r.length?"nowy projekt":"nowe projekty"}`,"info"),[...t,...r])))}catch(e){console.error("B\u0142\u0105d przy generowaniu nowych ofert:",e)}})()}),[d.turn]);const w=e=>{switch(e){case"PV":return(0,a.jsx)($f,{className:"h-5 w-5 text-yellow-500"});case"WF":return(0,a.jsx)(Py,{className:"h-5 w-5 text-blue-500"});case"BESS":return(0,a.jsx)(Wy,{className:"h-5 w-5 text-purple-500"});default:return null}},x=e=>{switch(e){case"greenfield":return"Greenfield";case"development":return"W rozwoju";case"rtb":return"Ready-to-Build";case"cod":return"Commercial Operation";default:return e}},b=e=>{switch(e){case"land_acquisition":return"Pozyskiwanie dzia\u0142ki";case"environmental_decision":return"Decyzja \u015brodowiskowa";case"zoning_conditions":return"Warunki zabudowy";case"grid_connection":return"Przy\u0142\u0105cze do sieci";case"ready_to_build":return"Ready-to-Build";case"constructed":return"Wybudowany";default:return"Nieznany etap"}};return(0,a.jsxs)("div",{className:"flex flex-1",children:[(0,a.jsxs)("div",{className:"flex-1 p-4 overflow-y-auto",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Gie\u0142da Projekt\xf3w OZE"}),(0,a.jsxs)("div",{className:"flex border-b border-gray-200 mb-4",children:[(0,a.jsx)("button",{onClick:()=>t("available"),className:"py-2 px-4 font-medium "+("available"===e?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),children:"Dost\u0119pne Projekty"}),(0,a.jsx)("button",{onClick:()=>t("history"),className:"py-2 px-4 font-medium "+("history"===e?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),children:"Historia Transakcji"}),(0,a.jsx)("button",{onClick:()=>t("sell"),className:"py-2 px-4 font-medium "+("sell"===e?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),children:"Sprzeda\u017c"})]}),"available"===e&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex mb-4",children:[(0,a.jsx)("button",{onClick:()=>r("all"),className:"px-3 py-1 rounded "+("all"===n?"bg-gray-700 text-white":"bg-gray-200"),children:"Wszystkie"}),(0,a.jsxs)("button",{onClick:()=>r("PV"),className:"px-3 py-1 rounded ml-2 flex items-center "+("PV"===n?"bg-yellow-500 text-white":"bg-gray-200"),children:[(0,a.jsx)($f,{className:"h-4 w-4 mr-1"})," Fotowoltaika"]}),(0,a.jsxs)("button",{onClick:()=>r("WF"),className:"px-3 py-1 rounded ml-2 flex items-center "+("WF"===n?"bg-blue-500 text-white":"bg-gray-200"),children:[(0,a.jsx)(Py,{className:"h-4 w-4 mr-1"})," Farmy Wiatrowe"]}),(0,a.jsxs)("button",{onClick:()=>r("BESS"),className:"px-3 py-1 rounded ml-2 flex items-center "+("BESS"===n?"bg-purple-500 text-white":"bg-gray-200"),children:[(0,a.jsx)(Wy,{className:"h-4 w-4 mr-1"})," Magazyny Energii"]})]}),(0,a.jsxs)("div",{className:"flex mb-4",children:[(0,a.jsx)("button",{onClick:()=>o("all"),className:"px-3 py-1 rounded "+("all"===s?"bg-gray-700 text-white":"bg-gray-200"),children:"Wszystkie etapy"}),(0,a.jsx)("button",{onClick:()=>o("greenfield"),className:"px-3 py-1 rounded ml-2 "+("greenfield"===s?"bg-green-500 text-white":"bg-gray-200"),children:"Greenfield"}),(0,a.jsx)("button",{onClick:()=>o("development"),className:"px-3 py-1 rounded ml-2 "+("development"===s?"bg-orange-500 text-white":"bg-gray-200"),children:"Development"}),(0,a.jsx)("button",{onClick:()=>o("rtb"),className:"px-3 py-1 rounded ml-2 "+("rtb"===s?"bg-red-500 text-white":"bg-gray-200"),children:"Ready-to-Build"}),(0,a.jsx)("button",{onClick:()=>o("cod"),className:"px-3 py-1 rounded ml-2 "+("cod"===s?"bg-purple-500 text-white":"bg-gray-200"),children:"Commercial Operation"})]}),(0,a.jsx)(rv,{title:"Dost\u0119pne projekty",headerAction:(0,a.jsx)(fy,{onClick:v,variant:"info",size:"small",children:"Od\u015bwie\u017c gie\u0142d\u0119"}),children:y.length>0?(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-100",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left p-2",children:"Projekt"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Technologia"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Etap"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Status developmentu"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Region"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Moc"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Cena"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Sprzedaj\u0105cy"}),(0,a.jsx)("th",{className:"text-center p-2",children:"Akcja"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:y.map((e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50 "+(e.isResale?"bg-green-50":""),children:[(0,a.jsx)("td",{className:"p-2",children:e.name}),(0,a.jsx)("td",{className:"text-center p-2",children:(0,a.jsxs)("div",{className:"flex justify-center items-center",children:[w(e.technology),(0,a.jsx)("span",{className:"ml-1",children:e.technology})]})}),(0,a.jsx)("td",{className:"text-center p-2",children:x(e.status)}),(0,a.jsxs)("td",{className:"text-center p-2",children:["development"===e.status&&(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("span",{children:b(e.developmentStatus)}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-1",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${e.developmentProgress}%`}})})]}),"development"!==e.status&&"-"]}),(0,a.jsx)("td",{className:"text-center p-2",children:e.region}),(0,a.jsxs)("td",{className:"text-center p-2",children:[e.power," MW"]}),(0,a.jsx)("td",{className:"text-center p-2",children:(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsxs)("span",{className:"font-medium",children:[e.price.toLocaleString()," PLN"]}),e.isResale&&(0,a.jsxs)("span",{className:"text-xs text-green-600",children:["Oszcz\u0119dno\u015b\u0107: ",(e.originalPrice-e.price).toLocaleString()," PLN"]})]})}),(0,a.jsx)("td",{className:"text-center p-2",children:e.seller}),(0,a.jsx)("td",{className:"text-center p-2",children:(0,a.jsx)(fy,{variant:"success",size:"small",onClick:()=>(e=>{const t=m.find((t=>t.id===e));if(!t||l.cash<t.price)return;c({type:"ADD_PROJECT",payload:{...t,status:"greenfield"===t.status?"land_acquisition":"rtb"===t.status?"ready_to_build":"cod"===t.status?"constructed":t.developmentStatus||"environmental_decision",etapPaid:(()=>{const e=p.indexOf(t.developmentStatus);return{land_acquisition:e>=0,environmental_decision:e>=1,zoning_conditions:e>=2,grid_connection:e>=3,ready_to_build:e>=4,construction:e>=5}})(),progress:t.developmentProgress||0,totalCost:t.price,assignedScout:null,assignedDeveloper:null,events:[{date:(new Date).toISOString(),text:`Projekt zakupiony na gie\u0142dzie za ${t.price.toLocaleString()} PLN${t.isResale?` (oszcz\u0119dno\u015b\u0107: ${(t.originalPrice-t.price).toLocaleString()} PLN)`:""}`}]}}),c({type:"UPDATE_CASH",payload:-t.price}),c({type:"UPDATE_ECONOMIC_METRICS",payload:{totalInvestment:l.economicMetrics.totalInvestment+t.price}}),h(`Zakupiono projekt ${t.name} za ${t.price.toLocaleString()} PLN`,"success"),f(m.filter((t=>t.id!==e)))})(e.id),disabled:l.cash<e.price,children:"Kup"})})]},e.id)))})]})}):(0,a.jsx)("p",{className:"text-gray-500",children:"Brak dost\u0119pnych projekt\xf3w spe\u0142niaj\u0105cych kryteria"})})]}),"history"===e&&(0,a.jsx)(rv,{title:"Historia transakcji",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Brak historii transakcji."})}),"sell"===e&&(0,a.jsx)(av,{})]}),(0,a.jsxs)("div",{className:"w-1/3 bg-gray-100 p-4 overflow-y-auto",children:[(0,a.jsx)(rv,{title:"Analiza rynku",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Aktualne trendy cenowe"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"PV (Greenfield):"})," 15 000\u201325 000 z\u0142/MWp"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"PV (RTB):"})," 100 000\u2013250 000 EUR/MWp"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Farmy Wiatrowe (RTB):"})," 340 000\u2013464 000 z\u0142/MW"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Magazyny Energii (RTB):"})," ","1.2\u20131.8 mln z\u0142/MW"]})]})]}),(0,a.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Okazje rynkowe"}),(0,a.jsxs)("ul",{className:"space-y-1 text-sm",children:[(0,a.jsx)("li",{children:"\u2022 Projekty z oznaczeniem odsprzeda\u017cy mog\u0105 by\u0107 ta\u0144sze o 5-15% od warto\u015bci rynkowej!"}),(0,a.jsx)("li",{children:"\u2022 Magazyny energii w fazie developmentu staj\u0105 si\u0119 coraz bardziej atrakcyjne"}),(0,a.jsx)("li",{children:"\u2022 Projekty w fazie przy\u0142\u0105cza do sieci maj\u0105 najwy\u017csze ROI przy szybkim uko\u0144czeniu"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Porady inwestycyjne"}),(0,a.jsxs)("ul",{className:"space-y-1 text-sm",children:[(0,a.jsx)("li",{children:"\u2022 Projekty hybrydowe (PV + magazyn) osi\u0105gaj\u0105 premi\u0119 cenow\u0105 30-40%"}),(0,a.jsx)("li",{children:"\u2022 Obecnie najlepsze IRR maj\u0105 projekty w wojew\xf3dztwach mazowieckim i pomorskim"}),(0,a.jsx)("li",{children:"\u2022 Nadchodz\u0105ce zmiany regulacyjne mog\u0105 zwi\u0119kszy\u0107 warto\u015b\u0107 projekt\xf3w BESS"})]})]})]})}),(0,a.jsxs)(rv,{title:"Twoja got\xf3wka",className:"mt-4",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-green-600 mb-2",children:[l.cash?l.cash.toLocaleString():"0"," PLN"]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Pami\u0119taj, \u017ce zakupione projekty wymagaj\u0105 dalszego finansowania w trakcie developmentu."})]})]})]})},ov=Ff("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]),lv=Ff("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),cv="initial",dv="scouting",uv="negotiation",hv="agreement",pv=e=>{let{region:t,regionId:n,negotiationData:r,onComplete:s,onCancel:o}=e;const l=(0,i.useRef)(!0),{state:c,dispatch:d}=u(),{state:h,dispatch:p,showNotification:m}=ff(),{state:f,dispatch:y}=xf(),{state:g}=H(),[v,w]=(0,i.useState)(r?"negotiation":"initial"),[x,b]=(0,i.useState)((()=>(null===r||void 0===r?void 0:r.processId)||`land-acquisition-${Date.now()}`)),[j,k]=(0,i.useState)(null),[N,z]=(0,i.useState)(null),[_,S]=(0,i.useState)(r?100:0),[E,C]=(0,i.useState)({size:r?r.size:100,quality:r?r.quality:"medium",expectedPrice:r?r.negotiatedPrice:0,negotiatedPrice:r?r.negotiatedPrice:0,monthlyRent:0,contractLength:29,depositRequired:0,annualRate:.6,startDate:r?new Date(r.startDate):new Date(h.gameDate),completionDate:r?new Date(r.completionDate):null,durationMonths:Math.floor(3*Math.random())+1,processId:x,projectType:r?r.projectType:"PV",riskFactors:{environmentalRisk:0,socialRisk:0,competitionRisk:0,legalRisk:0},seasonalFactors:{availabilityModifier:1,priceModifier:1}}),[T,P]=(0,i.useState)([]),[I,A]=(0,i.useState)(!1),[M,D]=(0,i.useState)(0),R=f.find((e=>e.id===n)),O=i.useMemo((()=>c&&c.staff&&c.staff.scouts?c.staff.scouts.filter((e=>!e.busy||e.assignedRegion===n)):[]),[c,n]);(0,i.useEffect)((()=>()=>{l.current=!1}),[]),(0,i.useEffect)((()=>{try{const e={processId:x,acquisitionStep:v,selectedScout:j?j.id:null,countyId:N,landParameters:E,progress:_,events:T,isNegotiationComplete:I,negotiationAttempts:M,lastSaved:(new Date).toISOString()};localStorage.setItem(`landAcquisition-${x}`,JSON.stringify(e))}catch(e){console.error("B\u0142\u0105d podczas zapisywania stanu do localStorage:",e)}}),[x,v,j,N,E,_,T,I,M]),(0,i.useEffect)((()=>{if(!r)try{const e=localStorage.getItem(`landAcquisition-${x}`);if(e){const t=JSON.parse(e),n=new Date(t.lastSaved),i=new Date;if(Math.floor((i-n)/864e5)>7)return void localStorage.removeItem(`landAcquisition-${x}`);if(w(t.acquisitionStep),z(t.countyId),C(t.landParameters),S(t.progress),P(t.events),A(t.isNegotiationComplete),D(t.negotiationAttempts),t.selectedScout){const e=c.staff.scouts.find((e=>e.id===t.selectedScout));e&&k(e)}}}catch(e){console.error("B\u0142\u0105d podczas wczytywania stanu z localStorage:",e)}}),[x,r,c.staff.scouts]),(0,i.useEffect)((()=>{if(v!==dv)return;let e;return e=setInterval((()=>{l.current&&S((e=>{if(e>=100)return 100;const t=2+(j?j.skill/10*3:0)+1*Math.random();return Math.random()<.1&&L(),Math.min(100,e+t)}))}),2e3),()=>{clearInterval(e)}}),[v,j]),(0,i.useEffect)((()=>{if(v!==dv)return;const e=()=>{l.current&&S((e=>{if(e>=100)return 100;const t=10+(j?j.skill/10*5:0)+5*Math.random();return L(),Math.min(100,e+t)}))};return window.addEventListener("day-changed",e),()=>{window.removeEventListener("day-changed",e)}}),[v,j]);const L=()=>{const e=[{type:"info",text:"Poszukiwanie dzia\u0142ki w toku..."},{type:"success",text:"Znaleziono obiecuj\u0105c\u0105 lokalizacj\u0119!"},{type:"warning",text:"Napotkano problemy z dost\u0119pno\u015bci\u0105 grunt\xf3w."},{type:"info",text:"Trwaj\u0105 rozmowy z w\u0142a\u015bcicielami grunt\xf3w."},{type:"success",text:"W\u0142a\u015bciciel gruntu jest zainteresowany wsp\xf3\u0142prac\u0105."},{type:"warning",text:"Konkurencyjna firma zainteresowana t\u0105 lokalizacj\u0105."}],t=e[Math.floor(Math.random()*e.length)],n={id:Date.now(),date:(new Date).toISOString(),type:t.type,text:t.text};P((e=>[n,...e].slice(0,10)))},F=()=>{if(!j)return void m("Musisz wybra\u0107 skauta przed rozpocz\u0119ciem poszukiwania","error");d({type:"UPDATE_STAFF",payload:{staffType:"scouts",staffId:j.id,changes:{busy:!0,assignedRegion:n,taskName:`Poszukiwanie dzia\u0142ki w ${t}`,taskStartDate:(new Date).toISOString()}}}),w(dv),S(0);const e={id:Date.now(),date:(new Date).toISOString(),type:"info",text:`Skaut ${j.name} rozpocz\u0105\u0142 poszukiwanie dzia\u0142ki w regionie ${t}.`};P([e]),y({type:"ADD_LAND_ACQUISITION_PROCESS",payload:{regionId:n,process:{id:x,scoutId:j.id,scoutName:j.name,startDate:(new Date).toISOString(),status:"in_progress"}}}),m(`Skaut ${j.name} rozpocz\u0105\u0142 poszukiwanie dzia\u0142ki w regionie ${t}.`,"success")},U=()=>{const e=V();C((t=>({...t,...e,completionDate:(new Date).toISOString()}))),y({type:"UPDATE_LAND_ACQUISITION_PROCESS",payload:{regionId:n,processId:x,changes:{status:"negotiation",completionDate:(new Date).toISOString()}}}),w(uv),m(`Poszukiwanie dzia\u0142ki w regionie ${t} zako\u0144czone. Mo\u017cesz teraz rozpocz\u0105\u0107 negocjacje.`,"success")},V=()=>{const e=Math.floor(50+150*Math.random()),t=["low","medium","high"],n=t[Math.floor(Math.random()*t.length)];let i;switch(n){case"low":i=3e4+2e4*Math.random();break;case"medium":i=5e4+3e4*Math.random();break;case"high":i=8e4+4e4*Math.random();break;default:i=5e4}const r=i*(j?1-j.skill/20:1),a=r*e,s=.006*a/12,o=.1*a,l=.3*Math.random(),c=Math.max(0,Math.min(1,l+(.2*Math.random()-.1))),d=Math.max(0,Math.min(1,l+(.2*Math.random()-.1))),u=Math.max(0,Math.min(1,l+(.2*Math.random()-.1))),h=Math.max(0,Math.min(1,l+(.2*Math.random()-.1)));return{size:e,quality:n,expectedPrice:Math.round(a),pricePerHa:Math.round(r),monthlyRent:Math.round(s),depositRequired:Math.round(o),riskFactors:{environmentalRisk:c,socialRisk:d,competitionRisk:u,legalRisk:h}}},B=e=>{let t,n;switch(e){case 90:t=.9,n="safe";break;case 80:default:t=.6,n="medium";break;case 70:t=.3,n="risky"}if(j){t+=(j.negotiation||.8*j.skill)/10*.2}const i=Math.random()<t;let r;if(i)r=Math.round(E.expectedPrice*(e/100));else{const t=e+(100-e)/2;r=Math.round(E.expectedPrice*(t/100))}C((e=>({...e,negotiatedPrice:r}))),A(!0),D((e=>e+1)),i?m("Oferta zosta\u0142a zaakceptowana! Mo\u017cesz teraz sfinalizowa\u0107 umow\u0119.","success"):m("Oferta zosta\u0142a odrzucona. W\u0142a\u015bciciel gruntu proponuje wy\u017csz\u0105 cen\u0119.","warning"),w(hv)},$=()=>{try{if(!R||!E)return void m("Brak danych regionu lub parametr\xf3w dzier\u017cawy","error");if(c.cash<E.depositRequired)return void m(`Nie masz wystarczaj\u0105cych \u015brodk\xf3w na kaucj\u0119! Potrzebujesz ${E.depositRequired.toLocaleString()} PLN.`,"error");const e=`lease-${Date.now()}`,i={id:e,regionId:n,countyId:N,landSize:E.size,quality:E.quality,monthlyRent:E.monthlyRent,contractLength:E.contractLength,depositPaid:E.depositRequired,signedDate:h.gameDate,expiryDate:q(h.gameDate,E.contractLength),landUse:E.projectType||"PV",totalCost:E.negotiatedPrice,riskFactors:E.riskFactors},r=`project-${Date.now()}`,a={id:r,name:K(n,E.projectType),leaseId:e,regionId:n,countyId:N,size:E.size,capacity:G(E.size,E.projectType),technology:E.projectType,status:"land_acquisition_completed",progress:0,totalInvestment:E.depositRequired,developmentCosts:0,constructionCosts:0,quality:E.quality,risks:E.riskFactors,assignedDeveloper:null,createdAt:h.gameDate,lastUpdated:h.gameDate,currentStage:"environmental_studies",stages:{land_acquisition:{completed:!0,startDate:E.startDate,completionDate:new Date},environmental_studies:{completed:!1,startDate:null,completionDate:null},zoning_conditions:{completed:!1,startDate:null,completionDate:null},building_permit:{completed:!1,startDate:null,completionDate:null},grid_connection:{completed:!1,startDate:null,completionDate:null},rtb:{completed:!1,startDate:null,completionDate:null}}};d({type:"ADD_LEASE_AGREEMENT",payload:i}),d({type:"ADD_PROJECT",payload:a}),d({type:"UPDATE_PLAYER",payload:{cash:c.cash-E.depositRequired}}),j&&d({type:"UPDATE_STAFF",payload:{staffType:"scouts",staffId:j.id,changes:{busy:!1,assignedRegion:null}}}),E.processId&&y({type:"REMOVE_LAND_ACQUISITION_PROCESS",payload:{regionId:n,processId:E.processId}}),localStorage.removeItem(`landAcquisition-${x}`),m(`Umowa dzier\u017cawy zosta\u0142a podpisana! Utworzono nowy projekt w regionie ${t}.`,"success"),s&&s({leaseId:e,projectId:r})}catch(e){console.error("B\u0142\u0105d podczas finalizacji umowy dzier\u017cawy:",e),m("Wyst\u0105pi\u0142 b\u0142\u0105d podczas finalizacji umowy dzier\u017cawy. Spr\xf3buj ponownie.","error")}},W=()=>{if(v!==cv){if(!window.confirm("Czy na pewno chcesz anulowa\u0107 proces pozyskiwania dzia\u0142ki? Ca\u0142y post\u0119p zostanie utracony."))return}j&&d({type:"UPDATE_STAFF",payload:{staffType:"scouts",staffId:j.id,changes:{busy:!1,assignedRegion:null,taskName:null,taskStartDate:null}}}),x&&y({type:"REMOVE_LAND_ACQUISITION_PROCESS",payload:{regionId:n,processId:x}}),localStorage.removeItem(`landAcquisition-${x}`),o&&o()},q=(e,t)=>{const n=new Date(e);return n.setFullYear(n.getFullYear()+t),n.toISOString()},K=(e,t)=>{var n;const i=(null===(n=f.find((t=>t.id===e)))||void 0===n?void 0:n.name)||"Nieznany region";return`${{PV:"Farma PV",WF:"Farma wiatrowa",BESS:"Magazyn energii","PV+BESS":"Farma PV z magazynem","PV+WF":"Farma hybrydowa","WF+BESS":"Farma wiatrowa z magazynem"}[t]||"Projekt OZE"} ${i} ${Math.floor(E.size)}ha`},G=(e,t)=>{let n=0;switch(t){case"PV":default:n=e/2;break;case"WF":n=e/10*3;break;case"BESS":n=50*e;break;case"PV+BESS":n=e/2.5+20*e;break;case"PV+WF":n=e/3+e/15*3;break;case"WF+BESS":n=e/15*3+15*e}return n*=.9+.2*Math.random(),Math.round(10*n)/10},Q=()=>(0,a.jsxs)(rv,{className:"acquisition-card",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-blue-800 mb-4",children:"Wyb\xf3r skauta"}),(0,a.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(hy,{className:"h-6 w-6 text-blue-500 mr-3 mt-1"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"mb-2",children:"Skauci to specjali\u015bci, kt\xf3rzy wyszukuj\u0105 dla Ciebie odpowiednie dzia\u0142ki pod budow\u0119 elektrowni. Ich umiej\u0119tno\u015bci wp\u0142ywaj\u0105 na:"}),(0,a.jsxs)("ul",{className:"list-disc list-inside text-sm text-gray-700 mb-2",children:[(0,a.jsx)("li",{children:"Jako\u015b\u0107 lokalizacji, jakie mog\u0105 znale\u017a\u0107"}),(0,a.jsx)("li",{children:"Czas potrzebny na znalezienie dzia\u0142ki"}),(0,a.jsx)("li",{children:"Poziom ryzyk zwi\u0105zanych z dan\u0105 lokalizacj\u0105"}),(0,a.jsx)("li",{children:"Skuteczno\u015b\u0107 negocjacji z w\u0142a\u015bcicielami"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 italic",children:"Lepsi skauci pobieraj\u0105 wy\u017csze wynagrodzenie, ale te\u017c znajduj\u0105 lepsze lokalizacje i skuteczniej negocjuj\u0105."})]})]})}),(0,a.jsx)("div",{className:"scouts-list my-4",children:0===O.length?(0,a.jsxs)("div",{className:"text-center p-6 bg-gray-50 rounded-lg",children:[(0,a.jsx)(Gf,{className:"mx-auto h-12 w-12 text-gray-400 mb-3"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-800 mb-1",children:"Brak dost\u0119pnych skaut\xf3w"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Nie masz zatrudnionych skaut\xf3w, kt\xf3rzy mogliby szuka\u0107 dzia\u0142ek."}),(0,a.jsx)(fy,{variant:"outline",className:"mt-4",onClick:()=>o&&o(),children:"Wr\xf3\u0107 do panelu zatrudnienia"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:O.map((e=>{var t;return(0,a.jsx)("div",{className:"scout-card p-4 rounded-lg border-2 cursor-pointer transition-all "+((null===j||void 0===j?void 0:j.id)===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300 hover:bg-blue-50/50"),onClick:()=>k(e),children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"avatar mr-3",children:(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:(0,a.jsx)(Gf,{className:"h-6 w-6 text-blue-500"})})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-800",children:e.name}),(0,a.jsxs)("span",{className:"text-sm font-medium px-2 py-1 rounded-full bg-blue-100 text-blue-800",children:[e.skill,"/10"]})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:[(0,a.jsx)("div",{className:"font-medium",children:"Specjalizacje:"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1 mt-1",children:[e.specializations&&e.specializations.map(((e,t)=>(0,a.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 rounded-full text-xs",children:e},t))),(!e.specializations||0===e.specializations.length)&&(0,a.jsx)("span",{className:"text-gray-500 italic",children:"Brak specjalizacji"})]})]}),(0,a.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-x-2 gap-y-1 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(Iy,{className:"h-4 w-4 text-gray-400 mr-1"}),(0,a.jsxs)("span",{children:["Poszukiwanie: ",e.searching||Math.floor(.9*e.skill),"/10"]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(ov,{className:"h-4 w-4 text-gray-400 mr-1"}),(0,a.jsxs)("span",{children:["Negocjacje: ",e.negotiation||Math.floor(.8*e.skill),"/10"]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(Uf,{className:"h-4 w-4 text-gray-400 mr-1"}),(0,a.jsxs)("span",{children:["Szybko\u015b\u0107: ",e.speed||Math.floor(.7*e.skill),"/10"]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(Kf,{className:"h-4 w-4 text-gray-400 mr-1"}),(0,a.jsxs)("span",{children:["Analiza ryzyka: ",e.riskAnalysis||Math.floor(.85*e.skill),"/10"]})]})]}),(0,a.jsxs)("div",{className:"mt-3 flex justify-between items-center border-t pt-2",children:[(0,a.jsx)("div",{className:"text-gray-600",children:"Wynagrodzenie:"}),(0,a.jsxs)("div",{className:"font-semibold text-gray-800",children:[(null===(t=e.salary)||void 0===t?void 0:t.toLocaleString())||"0"," PLN/mies."]})]})]})]})},e.id)}))})}),(0,a.jsxs)("div",{className:"project-preferences bg-gray-50 p-4 rounded-lg mt-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Preferencje projektu"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"form-field",children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-1",children:"Typ projektu"}),(0,a.jsxs)("select",{className:"w-full p-2 border rounded",value:E.projectType,onChange:e=>C((t=>({...t,projectType:e.target.value}))),children:[(0,a.jsx)("option",{value:"PV",children:"Farma fotowoltaiczna"}),(0,a.jsx)("option",{value:"WF",children:"Farma wiatrowa"}),(0,a.jsx)("option",{value:"BESS",children:"Magazyn energii"})]})]}),(0,a.jsxs)("div",{className:"form-field",children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-1",children:"Szacowana powierzchnia (ha)"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"number",className:"w-full p-2 border rounded",min:"5",max:"200",value:E.size,onChange:e=>C((t=>({...t,size:Math.max(5,Math.min(200,Number(e.target.value)))})))}),(0,a.jsx)("span",{className:"ml-2",children:"ha"})]})]}),(0,a.jsxs)("div",{className:"form-field md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-1",children:"Szacowana moc"}),(0,a.jsx)("div",{className:"p-2 bg-white border rounded",children:(0,a.jsxs)("span",{className:"font-medium",children:[G(E.size,E.projectType)," ","BESS"===E.projectType?"MWh":"MW"]})})]})]})]}),(0,a.jsxs)("div",{className:"actions-container mt-6",children:[(0,a.jsx)(fy,{variant:"outline",onClick:W,className:"mr-4",children:"Anuluj proces"}),(0,a.jsx)(fy,{variant:"primary",onClick:F,disabled:!j||0===O.length,children:"Rozpocznij poszukiwanie dzia\u0142ki"}),!j&&O.length>0&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-amber-600",children:[(0,a.jsx)(Kf,{className:"h-4 w-4 inline mr-1"}),"Wybierz skauta, aby rozpocz\u0105\u0107 poszukiwania."]})]})]}),Z=()=>(0,a.jsxs)(rv,{className:"acquisition-card",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-blue-800 mb-4",children:"Negocjacje warunk\xf3w"}),(0,a.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"avatar mr-3",children:(0,a.jsx)(Gf,{className:"h-6 w-6 text-blue-500"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium",children:["Skaut: ",(null===j||void 0===j?void 0:j.name)||"Nieznany skaut"]}),j&&(0,a.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:[(0,a.jsxs)("span",{className:"mr-3",children:["Umiej\u0119tno\u015bci: ",j.skill,"/10"]}),(0,a.jsxs)("span",{children:["Negocjacje: ",j.negotiation||Math.floor(.8*j.skill),"/10"]})]})]})]})}),(0,a.jsxs)("div",{className:"land-details bg-white p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Parametry dzia\u0142ki"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"label",children:"Powierzchnia:"}),(0,a.jsxs)("span",{className:"value",children:[E.size," ha"]})]}),(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"label",children:"Jako\u015b\u0107 lokalizacji:"}),(0,a.jsx)("span",{className:"value",children:"low"===E.quality?"Niska":"medium"===E.quality?"\u015arednia":"Wysoka"})]}),(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"label",children:"Szacowana cena:"}),(0,a.jsxs)("span",{className:"value",children:[E.expectedPrice.toLocaleString()," PLN"]})]}),(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"label",children:"Cena za hektar:"}),(0,a.jsxs)("span",{className:"value",children:[E.pricePerHa.toLocaleString()," PLN/ha"]})]})]})]}),(0,a.jsxs)("div",{className:"risk-factors mt-4",children:[(0,a.jsx)("h4",{className:"text-md font-medium text-gray-700 mb-2",children:"Czynniki ryzyka:"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{className:"risk-item",children:[(0,a.jsx)("span",{className:"risk-label",children:"\u015arodowiskowe:"}),(0,a.jsx)("div",{className:"risk-bar",children:(0,a.jsx)("div",{className:"risk-fill",style:{width:100*(E.riskFactors.environmentalRisk||0)+"%",backgroundColor:Y(E.riskFactors.environmentalRisk||0)}})})]}),(0,a.jsxs)("div",{className:"risk-item",children:[(0,a.jsx)("span",{className:"risk-label",children:"Spo\u0142eczne:"}),(0,a.jsx)("div",{className:"risk-bar",children:(0,a.jsx)("div",{className:"risk-fill",style:{width:100*(E.riskFactors.socialRisk||0)+"%",backgroundColor:Y(E.riskFactors.socialRisk||0)}})})]}),(0,a.jsxs)("div",{className:"risk-item",children:[(0,a.jsx)("span",{className:"risk-label",children:"Konkurencja:"}),(0,a.jsx)("div",{className:"risk-bar",children:(0,a.jsx)("div",{className:"risk-fill",style:{width:100*(E.riskFactors.competitionRisk||0)+"%",backgroundColor:Y(E.riskFactors.competitionRisk||0)}})})]}),(0,a.jsxs)("div",{className:"risk-item",children:[(0,a.jsx)("span",{className:"risk-label",children:"Prawne:"}),(0,a.jsx)("div",{className:"risk-bar",children:(0,a.jsx)("div",{className:"risk-fill",style:{width:100*(E.riskFactors.legalRisk||0)+"%",backgroundColor:Y(E.riskFactors.legalRisk||0)}})})]})]})]}),(0,a.jsxs)("div",{className:"negotiation-options mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Opcje negocjacji:"}),(0,a.jsxs)("div",{className:"options-container",children:[(0,a.jsxs)("button",{className:"negotiation-option",onClick:()=>B(90),disabled:I,children:[(0,a.jsxs)("div",{className:"option-icon safe",children:[(0,a.jsx)(by,{size:16}),(0,a.jsx)("span",{children:"90%"})]}),(0,a.jsxs)("div",{className:"option-content",children:[(0,a.jsx)("div",{className:"option-title",children:"Bezpieczna propozycja"}),(0,a.jsx)("div",{className:"option-description",children:"Zaoferuj 90% ceny wyj\u015bciowej - du\u017ca szansa powodzenia"}),(0,a.jsxs)("div",{className:"option-value",children:[Math.round(.9*E.expectedPrice).toLocaleString()," PLN"]})]})]}),(0,a.jsxs)("button",{className:"negotiation-option",onClick:()=>B(80),disabled:I,children:[(0,a.jsxs)("div",{className:"option-icon medium",children:[(0,a.jsx)(by,{size:16}),(0,a.jsx)("span",{children:"80%"})]}),(0,a.jsxs)("div",{className:"option-content",children:[(0,a.jsx)("div",{className:"option-title",children:"Standardowa propozycja"}),(0,a.jsx)("div",{className:"option-description",children:"Zaoferuj 80% ceny wyj\u015bciowej - \u015brednia szansa powodzenia"}),(0,a.jsxs)("div",{className:"option-value",children:[Math.round(.8*E.expectedPrice).toLocaleString()," PLN"]})]})]}),(0,a.jsxs)("button",{className:"negotiation-option",onClick:()=>B(70),disabled:I,children:[(0,a.jsxs)("div",{className:"option-icon risky",children:[(0,a.jsx)(by,{size:16}),(0,a.jsx)("span",{children:"70%"})]}),(0,a.jsxs)("div",{className:"option-content",children:[(0,a.jsx)("div",{className:"option-title",children:"Ryzykowna propozycja"}),(0,a.jsx)("div",{className:"option-description",children:"Zaoferuj 70% ceny wyj\u015bciowej - ma\u0142a szansa powodzenia"}),(0,a.jsxs)("div",{className:"option-value",children:[Math.round(.7*E.expectedPrice).toLocaleString()," PLN"]})]})]})]})]}),(0,a.jsxs)("div",{className:"lease-details bg-gray-50 p-4 rounded-lg mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Szczeg\xf3\u0142y umowy dzier\u017cawy:"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"label",children:"Miesi\u0119czny czynsz:"}),(0,a.jsxs)("span",{className:"value",children:[E.monthlyRent.toLocaleString()," PLN/mies."]})]}),(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"label",children:"D\u0142ugo\u015b\u0107 umowy:"}),(0,a.jsxs)("span",{className:"value",children:[E.contractLength," lat"]})]}),(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"label",children:"Kaucja zabezpieczaj\u0105ca:"}),(0,a.jsxs)("span",{className:"value",children:[E.depositRequired.toLocaleString()," PLN"]})]}),(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"label",children:"Roczna stopa:"}),(0,a.jsxs)("span",{className:"value",children:[(100*E.annualRate).toFixed(1),"%"]})]})]})]}),I&&(0,a.jsx)("div",{className:"negotiation-result mb-4",children:(0,a.jsxs)("div",{className:"p-4 rounded-lg "+(M>0?"bg-green-50":"bg-red-50"),children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[M>0?(0,a.jsx)(lv,{className:"h-5 w-5 text-green-500 mr-2"}):(0,a.jsx)(Yy,{className:"h-5 w-5 text-red-500 mr-2"}),(0,a.jsx)("h4",{className:"text-lg font-medium "+(M>0?"text-green-700":"text-red-700"),children:M>0?"Negocjacje zako\u0144czone sukcesem":"Oferta odrzucona"})]}),(0,a.jsx)("p",{className:M>0?"text-green-600":"text-red-600",children:M>0?`W\u0142a\u015bciciel dzia\u0142ki zaakceptowa\u0142 Twoj\u0105 ofert\u0119. Wynegocjowana cena: ${E.negotiatedPrice.toLocaleString()} PLN (${Math.round(100*(1-E.negotiatedPrice/E.expectedPrice))}% taniej).`:"W\u0142a\u015bciciel dzia\u0142ki odrzuci\u0142 Twoj\u0105 ofert\u0119. Mo\u017cesz spr\xf3bowa\u0107 ponownie z inn\u0105 propozycj\u0105 lub zrezygnowa\u0107."}),M>0&&(0,a.jsx)(fy,{variant:"primary",className:"mt-3",onClick:()=>w(hv),children:"Przejd\u017a do finalizacji umowy"})]})}),(0,a.jsx)("div",{className:"actions-container",children:(0,a.jsx)(fy,{variant:"outline",onClick:W,disabled:I&&M>0,children:"Anuluj negocjacje"})})]}),Y=e=>e<.3?"#4ade80":e<.6?"#facc15":"#f87171",J=()=>{const e=Math.max(1,Math.ceil((100-_)/10)),t=[...T].sort(((e,t)=>new Date(t.date)-new Date(e.date)));return(0,a.jsxs)(rv,{className:"acquisition-card",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-blue-800 mb-4",children:"Poszukiwanie dzia\u0142ki"}),(0,a.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"avatar mr-3",children:(0,a.jsx)(Gf,{className:"h-6 w-6 text-blue-500"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium",children:["Skaut: ",(null===j||void 0===j?void 0:j.name)||"Nieznany skaut"]}),j&&(0,a.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:[(0,a.jsxs)("span",{className:"mr-3",children:["Umiej\u0119tno\u015bci: ",j.skill,"/10"]}),(0,a.jsxs)("span",{children:["Poszukiwanie: ",j.searching||Math.floor(.9*j.skill),"/10"]})]})]})]})}),(0,a.jsxs)("div",{className:"scouting-status bg-white p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Status poszukiwa\u0144"}),(0,a.jsxs)("div",{className:"progress-container mb-4",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Post\u0119p wyszukiwania:"}),(0,a.jsxs)("span",{className:"font-medium",children:[_,"%"]})]}),(0,a.jsx)("div",{className:"progress-bar h-3 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"progress-fill h-full bg-blue-500",style:{width:`${_}%`}})}),_<100&&(0,a.jsxs)("div",{className:"text-sm text-gray-600 mt-2",children:[(0,a.jsx)(Uf,{className:"h-4 w-4 inline mr-1"}),(0,a.jsxs)("span",{children:["Szacowany czas zako\u0144czenia: ",e," ",1===e?"dzie\u0144":"dni"]})]})]}),t.length>0&&(0,a.jsxs)("div",{className:"event-log mb-4",children:[(0,a.jsx)("h4",{className:"text-md font-medium text-gray-700 mb-2",children:"Dziennik poszukiwa\u0144:"}),(0,a.jsxs)("div",{className:"event-list bg-gray-50 rounded-lg p-2 max-h-48 overflow-y-auto",children:[t.map(((e,t)=>(0,a.jsx)("div",{className:"event-item p-2 border-b last:border-0",children:(0,a.jsxs)("div",{className:"flex items-start",children:["success"===e.type&&(0,a.jsx)(lv,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0"}),"warning"===e.type&&(0,a.jsx)(Kf,{className:"h-5 w-5 text-amber-500 mr-2 flex-shrink-0"}),"info"===e.type&&(0,a.jsx)(hy,{className:"h-5 w-5 text-blue-500 mr-2 flex-shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("span",{className:"text-sm font-medium",children:new Date(e.date).toLocaleDateString("pl-PL",{day:"2-digit",month:"2-digit",year:"numeric"})})}),(0,a.jsx)("p",{className:"text-sm mt-1",children:e.text})]})]})},t))),0===t.length&&(0,a.jsx)("div",{className:"p-4 text-center text-gray-500",children:"Brak zdarze\u0144 do wy\u015bwietlenia"})]})]}),100===_&&(0,a.jsxs)("div",{className:"scouting-complete bg-green-50 p-3 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)(lv,{className:"h-5 w-5 text-green-500 mr-2"}),(0,a.jsx)("h4",{className:"text-lg font-medium text-green-700",children:"Poszukiwanie zako\u0144czone"})]}),(0,a.jsx)("p",{className:"text-green-600 mb-2",children:"Tw\xf3j skaut znalaz\u0142 odpowiedni\u0105 dzia\u0142k\u0119. Mo\u017cesz teraz przej\u015b\u0107 do negocjacji warunk\xf3w dzier\u017cawy."}),(0,a.jsx)(fy,{variant:"primary",className:"mt-2",onClick:U,children:"Przejd\u017a do negocjacji"})]})]}),(0,a.jsx)("div",{className:"actions-container",children:(0,a.jsx)(fy,{variant:"outline",onClick:W,disabled:100===_,children:"Przerwij poszukiwania"})})]})},X=()=>{const e=E.expectedPrice-E.negotiatedPrice,n=Math.round(e/E.expectedPrice*100),i=c.cash>=E.depositRequired;return(0,a.jsxs)(rv,{className:"acquisition-card",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-blue-800 mb-4",children:"Finalizacja umowy dzier\u017cawy"}),(0,a.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)(lv,{className:"h-6 w-6 text-green-500 mr-2"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-green-700",children:"Negocjacje zako\u0144czone"})]}),(0,a.jsx)("p",{className:"text-green-600",children:"Negocjacje zosta\u0142y zako\u0144czone. Przejrzyj warunki umowy i podejmij decyzj\u0119 o jej podpisaniu."})]}),(0,a.jsxs)("div",{className:"agreement-summary bg-white p-4 rounded-lg shadow mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Uzgodnione warunki"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"summary-item",children:[(0,a.jsx)("span",{className:"label",children:"Powierzchnia:"}),(0,a.jsxs)("span",{className:"value",children:[E.size," ha"]})]}),(0,a.jsxs)("div",{className:"summary-item",children:[(0,a.jsx)("span",{className:"label",children:"Jako\u015b\u0107 lokalizacji:"}),(0,a.jsx)("span",{className:"value",children:"low"===E.quality?"Niska":"medium"===E.quality?"\u015arednia":"Wysoka"})]}),(0,a.jsxs)("div",{className:"summary-item",children:[(0,a.jsx)("span",{className:"label",children:"Pierwotna cena:"}),(0,a.jsxs)("span",{className:"value",children:[E.expectedPrice.toLocaleString()," PLN"]})]}),(0,a.jsxs)("div",{className:"summary-item",children:[(0,a.jsx)("span",{className:"label",children:"Wynegocjowana cena:"}),(0,a.jsxs)("span",{className:"value text-green-600 font-bold",children:[E.negotiatedPrice.toLocaleString()," PLN"]})]}),(0,a.jsxs)("div",{className:"summary-item",children:[(0,a.jsx)("span",{className:"label",children:"Oszcz\u0119dno\u015b\u0107:"}),(0,a.jsxs)("span",{className:"value text-green-600 font-bold",children:[e.toLocaleString()," PLN (",n,"%)"]})]}),(0,a.jsxs)("div",{className:"summary-item",children:[(0,a.jsx)("span",{className:"label",children:"Miesi\u0119czny czynsz:"}),(0,a.jsxs)("span",{className:"value",children:[E.monthlyRent.toLocaleString()," PLN/mies."]})]}),(0,a.jsxs)("div",{className:"summary-item",children:[(0,a.jsx)("span",{className:"label",children:"D\u0142ugo\u015b\u0107 umowy:"}),(0,a.jsxs)("span",{className:"value",children:[E.contractLength," lat"]})]}),(0,a.jsxs)("div",{className:"summary-item",children:[(0,a.jsx)("span",{className:"label",children:"Kaucja wymagana:"}),(0,a.jsxs)("span",{className:"value font-bold",children:[E.depositRequired.toLocaleString()," PLN"]})]})]}),(0,a.jsxs)("div",{className:"cash-availability mt-4 p-3 rounded-lg border",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"label",children:"Dost\u0119pne \u015brodki:"}),(0,a.jsxs)("span",{className:"value font-bold "+(i?"text-green-600":"text-red-600"),children:[c.cash.toLocaleString()," PLN"]})]}),!i&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-red-600",children:[(0,a.jsx)(Kf,{className:"h-4 w-4 inline mr-1"}),"Nie masz wystarczaj\u0105cych \u015brodk\xf3w na wp\u0142at\u0119 kaucji. Potrzebujesz dodatkowe ",(E.depositRequired-c.cash).toLocaleString()," PLN."]})]})]}),(0,a.jsxs)("div",{className:"project-details bg-gray-50 p-4 rounded-lg mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Planowany projekt"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"summary-item",children:[(0,a.jsx)("span",{className:"label",children:"Typ projektu:"}),(0,a.jsx)("span",{className:"value",children:"PV"===E.projectType?"Farma fotowoltaiczna":"WF"===E.projectType?"Farma wiatrowa":"BESS"===E.projectType?"Magazyn energii":E.projectType})]}),(0,a.jsxs)("div",{className:"summary-item",children:[(0,a.jsx)("span",{className:"label",children:"Szacowana moc:"}),(0,a.jsxs)("span",{className:"value",children:[G(E.size,E.projectType)," ","BESS"===E.projectType?"MWh":"MW"]})]}),(0,a.jsxs)("div",{className:"summary-item",style:{gridColumn:"1 / -1"},children:[(0,a.jsx)("span",{className:"label",children:"Lokalizacja:"}),(0,a.jsxs)("span",{className:"value",children:[t,", Polska"]})]})]})]}),(0,a.jsxs)("div",{className:"actions-container mt-6",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between gap-4",children:[(0,a.jsx)(fy,{variant:"outline",onClick:W,children:"Anuluj proces"}),(0,a.jsxs)(fy,{variant:"primary",onClick:$,disabled:!i,className:"md:w-2/3",children:["Podpisz umow\u0119 dzier\u017cawy i wp\u0142a\u0107 kaucj\u0119 (",E.depositRequired.toLocaleString()," PLN)"]})]}),!i&&(0,a.jsx)("div",{className:"mt-4 text-sm text-center text-red-600",children:"Potrzebujesz wi\u0119cej \u015brodk\xf3w, aby podpisa\u0107 umow\u0119."})]})]})};return(0,a.jsxs)("div",{className:"land-acquisition-view",children:[(0,a.jsxs)("div",{className:"acquisition-header bg-white p-4 rounded-lg mb-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold text-primary",children:[v===cv&&"Wyb\xf3r skauta",v===dv&&"Poszukiwanie dzia\u0142ki",v===uv&&"Negocjacje warunk\xf3w",v===hv&&"Finalizacja umowy"]}),(0,a.jsxs)("div",{className:"location-info text-gray-600",children:[(0,a.jsx)(qf,{className:"h-4 w-4 inline mr-1"}),(0,a.jsxs)("span",{children:[t,", "]}),(0,a.jsx)("span",{children:N?`${N}, `:""}),(0,a.jsx)("span",{children:"Polska"})]})]}),v!==cv&&null!==_&&(0,a.jsxs)("div",{className:"acquisition-progress mt-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[(0,a.jsx)("span",{children:"Post\u0119p procesu"}),(0,a.jsxs)("span",{children:[_,"%"]})]}),(0,a.jsx)("div",{className:"progress-bar h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"progress-fill h-full bg-blue-500",style:{width:`${_}%`}})})]})]}),(()=>{switch(v){case cv:return Q();case dv:return J();case uv:return Z();case hv:return X();default:return Q()}})()]})},mv=[{id:"zachodniopomorskie",name:"Zachodniopomorskie",x:0,y:0},{id:"pomorskie",name:"Pomorskie",x:1,y:0},{id:"warminsko-mazurskie",name:"Warmi\u0144sko-Mazurskie",x:2,y:0},{id:"podlaskie",name:"Podlaskie",x:3,y:0},{id:"lubuskie",name:"Lubuskie",x:0,y:1},{id:"wielkopolskie",name:"Wielkopolskie",x:1,y:1},{id:"kujawsko-pomorskie",name:"Kujawsko-Pomorskie",x:2,y:1},{id:"mazowieckie",name:"Mazowieckie",x:3,y:1},{id:"dolnoslaskie",name:"Dolno\u015bl\u0105skie",x:0,y:2},{id:"lodzkie",name:"\u0141\xf3dzkie",x:1,y:2},{id:"swietokrzyskie",name:"\u015awi\u0119tokrzyskie",x:2,y:2},{id:"lubelskie",name:"Lubelskie",x:3,y:2},{id:"opolskie",name:"Opolskie",x:0,y:3},{id:"slaskie",name:"\u015al\u0105skie",x:1,y:3},{id:"malopolskie",name:"Ma\u0142opolskie",x:2,y:3},{id:"podkarpackie",name:"Podkarpackie",x:3,y:3}],fv=()=>{var e,t;const{state:n,dispatch:r}=ff(),{state:s,dispatch:o}=u(),{state:l,dispatch:c}=xf(),[d,h]=(0,i.useState)(null),[p,m]=(0,i.useState)(null),[f,y]=(0,i.useState)(!1),[g,v]=(0,i.useState)(!1),[w,x]=(0,i.useState)(!1),[b,j]=(0,i.useState)(null),[k,N]=(0,i.useState)(!1),[z,_]=(0,i.useState)(null),[S,E]=(0,i.useState)("lands"),[C,T]=(0,i.useState)([]),[P,I]=(0,i.useState)([]),[A,M]=(0,i.useState)(!1),[D,R]=(0,i.useState)(!1);(0,i.useEffect)((()=>{n.selectedRegion!==d&&(h(n.selectedRegion),n.selectedRegion&&y(!0))}),[n.selectedRegion]),(0,i.useEffect)((()=>{var e;if(null!==(e=s.staff)&&void 0!==e&&e.scouts){const e=s.staff.scouts.filter((e=>e.busy));I(e)}}),[null===(e=s.staff)||void 0===e?void 0:e.scouts]);const O=e=>{var t,n;const i=l.find((t=>t.id===e));return(null===i||void 0===i||null===(t=i.projects)||void 0===t||null===(n=t.filter((e=>"land_acquisition"!==e.status)))||void 0===n?void 0:n.length)||0},L=e=>P.filter((t=>t.assignedRegion===e)),F=e=>{const t=l.find((t=>t.id===e));return t&&t.projects?t.projects.reduce(((e,t)=>"constructed"===t.status?e+(t.capacity||0):e),0):0},U=()=>!!(s&&s.staff&&s.staff.scouts)&&s.staff.scouts.some((e=>!e.busy)),V=()=>{w||(U()?(x(!0),y(!1),R(!0),j(null)):showNotification("Brak dost\u0119pnych skaut\xf3w. Zatrudnij nowych pracownik\xf3w lub poczekaj a\u017c obecni sko\u0144cz\u0105 swoje zadania.","warning"))},B=()=>{if(!d)return;const e=l.find((e=>e.id===d));0!==((null===e||void 0===e?void 0:e.landAcquisitionProcesses)||[]).length?(v(!0),y(!1)):r({type:"NOTIFY",payload:{text:"Brak aktualnych poszukiwa\u0144 w tym regionie. Wy\u015blij skauta, aby rozpocz\u0105\u0107 pozyskiwanie dzia\u0142ki.",type:"info"}})},$=e=>{var t;const n=l.find((t=>t.id===e));return(null===n||void 0===n||null===(t=n.landAcquisitionProcesses)||void 0===t?void 0:t.length)||0},W=e=>{const t=l.find((t=>t.id===e));return((null===t||void 0===t?void 0:t.landAcquisitionProcesses)||[]).some((e=>"ready_for_negotiation"===e.status))},q=e=>{const t=L(e).length;return 0===t?null:(0,a.jsxs)("div",{className:"scout-indicator",title:`${t} aktywnych skaut\xf3w`,children:[(0,a.jsx)(Gf,{size:14}),(0,a.jsx)("span",{children:t})]})},H=e=>{const t=O(e);return 0===t?null:(0,a.jsxs)("div",{className:"projects-indicator",title:`${t} projekt\xf3w`,children:[(0,a.jsx)(hy,{size:14}),(0,a.jsx)("span",{children:t})]})},K=e=>{const t=l.find((t=>t.id===e));if(!t)return null;const n=t.solarConditions;let i="";return i=n>=80?"excellent":n>=60?"good":n>=40?"average":"poor",(0,a.jsx)("div",{className:`condition-indicator solar-condition ${i}`,title:`Nas\u0142onecznienie: ${n}/100`,children:(0,a.jsx)($f,{size:14})})},G=e=>{const t=l.find((t=>t.id===e));if(!t)return null;const n=t.windConditions;let i="";return i=n>=80?"excellent":n>=60?"good":n>=40?"average":"poor",(0,a.jsx)("div",{className:`condition-indicator wind-condition ${i}`,title:`Warunki wiatrowe: ${n}/100`,children:(0,a.jsx)(Py,{size:14})})},Q=e=>{try{if(!d)return console.error("Nie wybrano regionu do negocjacji"),void r({type:"NOTIFY",payload:{text:"B\u0142\u0105d: Nie wybrano regionu do negocjacji.",type:"error"}});const t=l.find((e=>e.id===d));if(!t||!t.landAcquisitionProcesses)return console.error("Brak danych regionu lub proces\xf3w pozyskiwania grunt\xf3w"),void r({type:"NOTIFY",payload:{text:"B\u0142\u0105d: Nie mo\u017cna uzyska\u0107 dost\u0119pu do danych regionu.",type:"error"}});const n=t.landAcquisitionProcesses.find((t=>t.id===e));if(!n)return console.error("Nie znaleziono procesu do negocjacji o ID:",e),void r({type:"NOTIFY",payload:{text:"B\u0142\u0105d: Nie znaleziono procesu do negocjacji.",type:"error"}});console.log("Przygotowanie do negocjacji procesu:",n);const i=n.negotiatedPrice||1e4*n.size;let a=null;s&&s.staff&&s.staff.scouts&&(a=s.staff.scouts.find((e=>e.id===n.scoutId))),j({processId:n.id,scoutId:n.scoutId,scoutName:n.scoutName||(a?a.name:"Nieznany skaut"),size:n.size||100,quality:n.quality||"medium",negotiatedPrice:i,expectedPrice:n.expectedPrice||i,regionId:d,annualRate:n.annualRate||.05,status:n.status||"ready_for_negotiation"}),M(!0)}catch(t){console.error("Wyst\u0105pi\u0142 nieoczekiwany b\u0142\u0105d podczas przygotowania negocjacji:",t),r({type:"NOTIFY",payload:{text:"Wyst\u0105pi\u0142 nieoczekiwany b\u0142\u0105d podczas przygotowania negocjacji. Spr\xf3buj ponownie.",type:"error"}})}},Z=e=>{var t;const n=l.find((e=>e.id===d)),i=null===n||void 0===n||null===(t=n.landAcquisitionProcesses)||void 0===t?void 0:t.find((t=>t.id===e));if(!i)return;const a=s.staff.scouts.find((e=>e.id===i.scoutId));a&&o({type:"UPDATE_STAFF",payload:{staffType:"scouts",staffId:a.id,changes:{busy:!1,assignedRegion:null}}}),c({type:"REMOVE_LAND_ACQUISITION_PROCESS",payload:{regionId:d,processId:e}}),r({type:"NOTIFY",payload:{text:`Anulowano proces poszukiwania gruntu w regionie ${null===n||void 0===n?void 0:n.name}.`,type:"info"}})};return(0,a.jsxs)("div",{className:"region-selection-view",children:[(0,a.jsxs)("div",{className:"region-selection-header",children:[(0,a.jsx)("h2",{children:"Wyb\xf3r regionu"}),(0,a.jsx)("p",{children:"Wybierz wojew\xf3dztwo, aby rozpocz\u0105\u0107 poszukiwanie dzia\u0142ek lub zarz\u0105dza\u0107 projektami"})]}),(0,a.jsxs)("div",{className:"regions-map-container",children:[(0,a.jsxs)("div",{className:"region-map-section",children:[(0,a.jsx)("div",{className:"regions-grid",children:mv.map((e=>{var t;const n=d===e.id,i=p===e.id,s=l.find((t=>t.id===e.id));return(0,a.jsx)("div",{className:`region-cell ${n?"selected":""} ${i?"hovered":""}`,style:{gridColumn:e.x+1,gridRow:e.y+1},children:(0,a.jsxs)("button",{className:`region-btn ${o=e.id,(e=>{const t=(e.solarConditions+e.windConditions)/2;return t>=70?"bg-green-200":t>=55?"bg-yellow-200":"bg-red-200"})(l.find((e=>e.id===o)))} ${n?"selected":""}`,onClick:()=>(e=>{if(d===e)return y(!f),void v(!1);l.find((t=>t.id===e)),h(e),r({type:"SELECT_REGION",payload:e}),y(!0),v(!1)})(e.id),onMouseEnter:()=>m(e.id),onMouseLeave:()=>m(null),children:[(0,a.jsx)("div",{className:"region-name",children:e.name}),(0,a.jsxs)("div",{className:"region-indicators",children:[K(e.id),G(e.id),q(e.id),H(e.id)]}),i&&s&&(0,a.jsxs)("div",{className:"region-hover-info",children:[(0,a.jsxs)("div",{className:"hover-info-item",children:[(0,a.jsx)("span",{children:"Dost\u0119pne grunty:"}),(0,a.jsxs)("span",{children:[null===(t=s.availableLand)||void 0===t?void 0:t.toLocaleString()," ha"]})]}),(0,a.jsxs)("div",{className:"hover-info-item",children:[(0,a.jsx)("span",{children:"Projekty:"}),(0,a.jsx)("span",{children:O(e.id)})]}),L(e.id).length>0&&(0,a.jsxs)("div",{className:"hover-info-item",children:[(0,a.jsx)("span",{children:"Aktywni skauci:"}),(0,a.jsx)("span",{children:L(e.id).length})]})]})]})},e.id);var o}))}),(0,a.jsxs)("div",{className:"regions-legend",children:[(0,a.jsx)("h3",{children:"Legenda"}),(0,a.jsxs)("div",{className:"legend-items",children:[(0,a.jsxs)("div",{className:"legend-item",children:[(0,a.jsx)("span",{className:"color-box color-low"}),(0,a.jsx)("span",{children:"Brak projekt\xf3w"})]}),(0,a.jsxs)("div",{className:"legend-item",children:[(0,a.jsx)("span",{className:"color-box color-medium"}),(0,a.jsx)("span",{children:"1-2 projekty"})]}),(0,a.jsxs)("div",{className:"legend-item",children:[(0,a.jsx)("span",{className:"color-box color-high"}),(0,a.jsx)("span",{children:"3+ projekt\xf3w"})]}),(0,a.jsxs)("div",{className:"legend-item",children:[(0,a.jsx)("span",{className:"color-box color-selected"}),(0,a.jsx)("span",{children:"Wybrany region"})]})]})]})]}),(0,a.jsxs)("div",{className:"region-panel-section",children:[(()=>{var e;if(!d||!f)return null;const t=l.find((e=>e.id===d)),n=L(d);return(0,a.jsxs)("div",{className:"region-action-panel",children:[(0,a.jsxs)("div",{className:"action-panel-header",children:[(0,a.jsx)("h3",{children:(null===t||void 0===t?void 0:t.name)||"Wybrany region"}),(0,a.jsx)("button",{className:"close-panel-btn",onClick:()=>y(!1),children:(0,a.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),(0,a.jsxs)("div",{className:"region-key-stats",children:[(0,a.jsxs)("div",{className:"key-stat",children:[(0,a.jsx)(Iy,{size:18}),(0,a.jsxs)("div",{className:"stat-content",children:[(0,a.jsx)("span",{className:"stat-label",children:"Dost\u0119pne grunty"}),(0,a.jsxs)("span",{className:"stat-value",children:[null===t||void 0===t||null===(e=t.availableLand)||void 0===e?void 0:e.toLocaleString()," ha"]})]})]}),(0,a.jsxs)("div",{className:"key-stat",children:[(0,a.jsx)($f,{size:18}),(0,a.jsxs)("div",{className:"stat-content",children:[(0,a.jsx)("span",{className:"stat-label",children:"Nas\u0142onecznienie"}),(0,a.jsxs)("span",{className:"stat-value",children:[null===t||void 0===t?void 0:t.solarConditions,"/100"]})]})]}),(0,a.jsxs)("div",{className:"key-stat",children:[(0,a.jsx)(Py,{size:18}),(0,a.jsxs)("div",{className:"stat-content",children:[(0,a.jsx)("span",{className:"stat-label",children:"Warunki wiatrowe"}),(0,a.jsxs)("span",{className:"stat-value",children:[null===t||void 0===t?void 0:t.windConditions,"/100"]})]})]}),(0,a.jsxs)("div",{className:"key-stat",children:[(0,a.jsx)(Lg,{size:18}),(0,a.jsxs)("div",{className:"stat-content",children:[(0,a.jsx)("span",{className:"stat-label",children:"Moc zainstalowana"}),(0,a.jsxs)("span",{className:"stat-value",children:[F(d)," MW"]})]})]})]}),(0,a.jsxs)("div",{className:"action-buttons",children:[(0,a.jsxs)("button",{className:"action-btn scout-btn "+(U()?"":"disabled"),onClick:V,disabled:!U(),children:[(0,a.jsx)("div",{className:"btn-icon",children:(0,a.jsx)(Iy,{size:18})}),(0,a.jsxs)("div",{className:"btn-content",children:[(0,a.jsx)("div",{className:"btn-title",children:"Wy\u015blij skauta"}),(0,a.jsx)("div",{className:"btn-description",children:"Znajd\u017a i wynegocjuj dzier\u017caw\u0119 dzia\u0142ki"})]})]}),(0,a.jsxs)("button",{className:"action-btn projects-btn "+(0===$(d)?"disabled":""),onClick:B,disabled:0===$(d),children:[(0,a.jsxs)("div",{className:"btn-icon",children:[(0,a.jsx)(hy,{size:18}),W(d)&&(0,a.jsx)("div",{className:"notification-badge",children:"!"})]}),(0,a.jsxs)("div",{className:"btn-content",children:[(0,a.jsxs)("div",{className:"btn-title",children:["Aktualne poszukiwania",W(d)&&(0,a.jsx)("span",{className:"attention-marker",children:" \u2022 "})]}),(0,a.jsxs)("div",{className:"btn-description",children:["Przejrzyj post\u0119p poszukiwania grunt\xf3w w tym regionie",W(d)&&(0,a.jsx)("span",{className:"text-yellow-500",children:" (Wymagana akcja!)"})]})]})]})]}),n.length>0&&(0,a.jsxs)("div",{className:"active-scouts-section",children:[(0,a.jsxs)("h4",{children:[(0,a.jsx)(Vf,{size:16,className:"section-icon"}),"Aktywne procesy w regionie"]}),(0,a.jsx)("div",{className:"active-scouts-list",children:n.map((e=>(0,a.jsxs)("div",{className:"active-scout-item",children:[(0,a.jsx)("div",{className:"scout-avatar",children:(0,a.jsx)(Gf,{size:20})}),(0,a.jsxs)("div",{className:"scout-info",children:[(0,a.jsx)("div",{className:"scout-name",children:e.name}),(0,a.jsx)("div",{className:"scout-status",children:"Poszukiwanie dzia\u0142ki"}),(0,a.jsxs)("div",{className:"scout-progress",children:[(0,a.jsx)("div",{className:"progress-bar",children:(0,a.jsx)("div",{className:"progress-fill",style:{width:`${e.progress||0}%`}})}),(0,a.jsxs)("span",{className:"progress-text",children:[Math.floor(e.progress||0),"%"]})]})]})]},e.id)))})]}),!(s&&s.staff&&s.staff.scouts&&s.staff.scouts.length>0)&&(0,a.jsxs)("div",{className:"region-warning",children:[(0,a.jsx)(Kf,{size:16,className:"warning-icon"}),(0,a.jsx)("span",{children:"Nie masz zatrudnionych skaut\xf3w. Zatrudnij skauta w panelu HR, aby m\xf3c poszukiwa\u0107 dzia\u0142ek."})]})]})})(),(()=>{if(!d||!g)return null;const e=l.find((e=>e.id===d)),t=(null===e||void 0===e?void 0:e.landAcquisitionProcesses)||[],n=e=>new Date(e).toLocaleDateString("pl-PL"),i={in_progress:"W trakcie",ready_for_negotiation:"Gotowy do negocjacji",negotiating:"W negocjacjach",completed:"Zako\u0144czony"},r={in_progress:"bg-blue-100 text-blue-800",ready_for_negotiation:"bg-green-200 text-green-900 font-bold",negotiating:"bg-amber-100 text-amber-800",completed:"bg-gray-100 text-gray-800"};return(0,a.jsxs)("div",{className:"region-projects-panel",children:[(0,a.jsxs)("div",{className:"projects-panel-header",children:[(0,a.jsxs)("h3",{children:["Aktualne poszukiwania w regionie ",null===e||void 0===e?void 0:e.name]}),(0,a.jsx)("button",{className:"close-panel-btn",onClick:()=>v(!1),children:(0,a.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),(0,a.jsx)("div",{className:"acquisition-processes-container",children:0===t.length?(0,a.jsx)("div",{className:"no-processes-message",children:"Brak aktualnych proces\xf3w poszukiwania grunt\xf3w w tym regionie."}):(0,a.jsx)("div",{className:"acquisition-processes-grid",children:t.map((e=>(0,a.jsxs)("div",{className:"acquisition-process-card "+(C.includes(e.id)?"expanded":""),onClick:()=>(e=>{var t;const n=l.find((e=>e.id===d)),i=null===n||void 0===n||null===(t=n.landAcquisitionProcesses)||void 0===t?void 0:t.find((t=>t.id===e));i&&"ready_for_negotiation"===i.status?Q(e):T((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))})(e.id),children:[(0,a.jsxs)("div",{className:"process-card-header",children:[(0,a.jsx)("div",{className:"process-icon",children:(0,a.jsx)(Iy,{size:18})}),(0,a.jsxs)("div",{className:"process-info",children:[(0,a.jsxs)("h4",{className:"process-title",children:["Dzia\u0142ka ",e.size,"ha"]}),(0,a.jsx)("div",{className:`process-status-badge ${r[e.status]}`,children:i[e.status]})]}),(0,a.jsx)("div",{className:"process-progress-indicator",children:(0,a.jsxs)("svg",{viewBox:"0 0 36 36",className:"circular-chart",children:[(0,a.jsx)("path",{className:"circle-bg",d:"M18 2.0845\r a 15.9155 15.9155 0 0 1 0 31.831\r a 15.9155 15.9155 0 0 1 0 -31.831"}),(0,a.jsx)("path",{className:"circle",strokeDasharray:`${e.progress}, 100`,d:"M18 2.0845\r a 15.9155 15.9155 0 0 1 0 31.831\r a 15.9155 15.9155 0 0 1 0 -31.831"}),(0,a.jsxs)("text",{x:"18",y:"20.35",className:"percentage",children:[e.progress,"%"]})]})})]}),C.includes(e.id)&&(0,a.jsxs)("div",{className:"process-card-details",children:[(0,a.jsxs)("div",{className:"details-grid",children:[(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"detail-label",children:"Skaut:"}),(0,a.jsx)("span",{className:"detail-value",children:e.scoutName})]}),(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"detail-label",children:"Rozpocz\u0119cie:"}),(0,a.jsx)("span",{className:"detail-value",children:n(e.startDate)})]}),(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"detail-label",children:"Zako\u0144czenie:"}),(0,a.jsx)("span",{className:"detail-value",children:n(e.completionDate)})]}),e.negotiatedPrice&&(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"detail-label",children:"Wycena:"}),(0,a.jsxs)("span",{className:"detail-value",children:[e.negotiatedPrice.toLocaleString()," PLN"]})]}),(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"detail-label",children:"Jako\u015b\u0107:"}),(0,a.jsx)("span",{className:"detail-value",children:"high"===e.quality?"Wysoka":"medium"===e.quality?"\u015arednia":"Niska"})]})]}),(0,a.jsxs)("div",{className:"process-actions",children:["ready_for_negotiation"===e.status&&(0,a.jsx)("button",{className:"action-button negotiate",onClick:t=>{t.stopPropagation(),Q(e.id)},children:"Negocjuj umow\u0119"}),"in_progress"===e.status&&(0,a.jsx)("button",{className:"action-button cancel",onClick:t=>{t.stopPropagation(),Z(e.id)},children:"Anuluj poszukiwanie"})]})]})]},e.id)))})})]})})()]})]}),w&&d&&(0,a.jsxs)("div",{className:"land-acquisition-modal",children:[(0,a.jsx)("div",{className:"land-acquisition-backdrop",onClick:()=>{D&&!window.confirm("Czy na pewno chcesz anulowa\u0107 proces pozyskiwania gruntu?")||(x(!1),y(!0),R(!1))}}),(0,a.jsx)("div",{className:"land-acquisition-content",children:(0,a.jsx)(pv,{region:null===(t=l.find((e=>e.id===d)))||void 0===t?void 0:t.name,regionId:d,negotiationData:b,onComplete:e=>{console.log("Proces pozyskiwania gruntu zako\u0144czony:",e),e&&e.leaseId&&e.projectId&&showNotification("Umowa dzier\u017cawy zosta\u0142a podpisana! Utworzono nowy projekt w Twoim portfolio.","success"),x(!1),y(!0),R(!1),refreshProjects&&refreshProjects()},onCancel:()=>{D&&!window.confirm("Czy na pewno chcesz anulowa\u0107 proces pozyskiwania gruntu?")||(x(!1),y(!0),R(!1))}})})]})]})},yv=e=>{let{employees:t,onSelectEmployee:n,selectedEmployeeId:r}=e;const[s,o]=(0,i.useState)("all"),[l,c]=(0,i.useState)("all"),[d,u]=(0,i.useState)("name"),h=(0,i.useMemo)((()=>{let e=[...t];return"all"!==s&&(e=e.filter((e=>e.typeShort===s))),"all"!==l&&(e=e.filter((e=>e.level===l))),e.sort(((e,t)=>{switch(d){case"name":return e.name.localeCompare(t.name);case"type":return e.typeShort.localeCompare(t.typeShort);case"level":return e.level.localeCompare(t.level);case"skill":return t.skill-e.skill;case"experience":return t.experience-e.experience;default:return 0}})),e}),[t,s,l,d]),p=e=>e.experience<3e3?"Pocz\u0105tkuj\u0105cy":e.experience<8e3?"Do\u015bwiadczony":"Ekspert";return(0,a.jsxs)("div",{className:"hr-employees-list",children:[(0,a.jsxs)("div",{className:"hr-employees-list-header",children:["Pracownicy (",h.length,")"]}),(0,a.jsxs)("div",{className:"hr-employees-list-filters",children:[(0,a.jsxs)("select",{value:s,onChange:e=>o(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"Wszyscy"}),(0,a.jsx)("option",{value:"lessor",children:"Dzier\u017cawcy"}),(0,a.jsx)("option",{value:"developer",children:"Developerzy"}),(0,a.jsx)("option",{value:"lawyer",children:"Prawnicy"}),(0,a.jsx)("option",{value:"envSpecialist",children:"Spec. \u015brodowiskowi"}),(0,a.jsx)("option",{value:"lobbyist",children:"Lobby\u015bci"})]}),(0,a.jsxs)("select",{value:l,onChange:e=>c(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"Wszystkie poziomy"}),(0,a.jsx)("option",{value:"junior",children:"Pocz\u0105tkuj\u0105cy"}),(0,a.jsx)("option",{value:"mid",children:"Do\u015bwiadczeni"}),(0,a.jsx)("option",{value:"senior",children:"Eksperci"})]}),(0,a.jsxs)("select",{value:d,onChange:e=>u(e.target.value),children:[(0,a.jsx)("option",{value:"name",children:"Sortuj: Nazwa"}),(0,a.jsx)("option",{value:"type",children:"Sortuj: Typ"}),(0,a.jsx)("option",{value:"level",children:"Sortuj: Poziom"}),(0,a.jsx)("option",{value:"skill",children:"Sortuj: Umiej\u0119tno\u015bci"}),(0,a.jsx)("option",{value:"experience",children:"Sortuj: Do\u015bwiadczenie"})]})]}),(0,a.jsx)("div",{className:"hr-employees-items",children:0===h.length?(0,a.jsx)("div",{className:"hr-no-employees",children:"Brak pracownik\xf3w spe\u0142niaj\u0105cych kryteria"}):h.map((e=>(0,a.jsxs)("div",{className:"hr-employee-item "+(r===e.id?"selected":""),onClick:()=>n(e),children:[(0,a.jsx)("div",{className:"hr-employee-name",children:e.name}),(0,a.jsxs)("div",{className:"hr-employee-info",children:[(0,a.jsx)("span",{children:Dy(e.typeShort)}),(0,a.jsx)("span",{children:Ry(e.level)})]}),(0,a.jsxs)("div",{className:"hr-employee-info",children:[(0,a.jsxs)("span",{children:["Umiej\u0119tno\u015b\u0107: ",e.skill,"/10"]}),(0,a.jsxs)("span",{children:["Do\u015bwiadczenie: ",p(e)]})]}),e.specialization&&(0,a.jsx)("div",{className:"hr-employee-specialization",children:e.specialization})]},e.id)))})]})},gv=e=>{let{employee:t,staffType:n,staffManagement:r,gameState:s}=e;const[o,l]=(0,i.useState)(!1);if(!t)return null;return(0,a.jsxs)("div",{className:"hr-employee-details",children:[(0,a.jsxs)("div",{className:"hr-employee-header",children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,a.jsx)("div",{className:"hr-employee-avatar",children:t.name.charAt(0)}),(0,a.jsxs)("div",{className:"hr-employee-title",children:[(0,a.jsx)("h3",{children:t.name}),(0,a.jsxs)("div",{className:"hr-employee-job",children:[Ry(t.level)," ",Dy(t.typeShort)]}),(0,a.jsx)("div",{children:t.specialization&&(0,a.jsxs)("span",{className:"hr-specialization",children:["Specjalizacja: ",t.specialization]})})]})]}),(0,a.jsxs)("div",{className:"hr-employee-actions",children:[(0,a.jsx)("button",{className:"train-btn",onClick:()=>{},children:"Szkolenie"}),(0,a.jsx)("button",{className:"fire-btn",onClick:()=>{o?(r.fireStaff(t.typeShort,t.id),l(!1)):l(!0)},children:o?"Potwierd\u017a zwolnienie":"Zwolnij"})]})]}),(0,a.jsxs)("div",{className:"hr-employee-grid",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"hr-employee-section",children:[(0,a.jsx)("h4",{children:"Statystyki"}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Sta\u017c pracy"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[s.turn-t.hiredOn," tur"]})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Umiej\u0119tno\u015bci"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.skill,"/10"]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value "+(t.skill>7?"high":t.skill>4?"medium":"low"),style:{width:10*t.skill+"%"}})})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Do\u015bwiadczenie"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.experience," p.d."]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value",style:{width:`${Math.min(100,t.experience/100)}%`}})})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Energia"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.energy,"/100"]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value "+(t.energy>70?"high":t.energy>40?"medium":"low"),style:{width:`${t.energy}%`}})})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Morale"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.morale,"/100"]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value "+(t.morale>70?"high":t.morale>40?"medium":"low"),style:{width:`${t.morale}%`}})})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Wynagrodzenie"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.salary.toLocaleString()," PLN / miesi\u0105c"]})]})]}),"developer"!==t.typeShort?null:t.technologyExperience&&0!==Object.keys(t.technologyExperience).length?(0,a.jsxs)("div",{className:"hr-employee-section",children:[(0,a.jsx)("h4",{children:"Do\u015bwiadczenie w technologiach"}),Object.entries(t.technologyExperience).map((e=>{let[t,n]=e;return(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:t}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[n," p.d."]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value",style:{width:`${Math.min(100,n/50)}%`}})})]},t)}))]}):(0,a.jsxs)("div",{className:"hr-employee-section",children:[(0,a.jsx)("h4",{children:"Do\u015bwiadczenie w technologiach"}),(0,a.jsx)("div",{className:"hr-no-data",children:"Brak do\u015bwiadczenia w konkretnych technologiach"})]}),"scout"!==t.typeShort?null:t.acquiredLands&&0!==t.acquiredLands?(0,a.jsxs)("div",{className:"hr-employee-section",children:[(0,a.jsx)("h4",{children:"Do\u015bwiadczenie dzier\u017cawcy"}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Pozyskane grunty"}),(0,a.jsx)("div",{className:"hr-stat-value",children:t.acquiredLands})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"\u0141\u0105czna powierzchnia"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.acquiredArea||0," ha"]})]})]}):(0,a.jsxs)("div",{className:"hr-employee-section",children:[(0,a.jsx)("h4",{children:"Do\u015bwiadczenie dzier\u017cawcy"}),(0,a.jsx)("div",{className:"hr-no-data",children:"Jeszcze nie pozyska\u0142 \u017cadnych grunt\xf3w"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"hr-employee-section",children:[(0,a.jsx)("h4",{children:"Cechy charakteru"}),t.traits&&t.traits.length>0?t.traits.map((e=>{const t=(e=>[...Ng,...zg,..._g].find((t=>t.id===e))||{label:e,description:""})(e);return(0,a.jsxs)("div",{className:"hr-trait-item",children:[(0,a.jsx)("div",{className:"hr-trait-name",children:t.label}),(0,a.jsx)("div",{className:"hr-trait-description",children:t.description})]},e)})):(0,a.jsx)("div",{className:"hr-no-data",children:"Brak zdefiniowanych cech charakteru"})]}),(0,a.jsxs)("div",{className:"hr-employee-section",children:[(0,a.jsx)("h4",{children:"Potrzeby"}),t.potrzeby?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Uznanie"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.potrzeby.uznanie,"/100"]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value",style:{width:`${t.potrzeby.uznanie}%`}})})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Rozw\xf3j"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.potrzeby.rozwoj,"/100"]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value",style:{width:`${t.potrzeby.rozwoj}%`}})})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Stabilizacja"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.potrzeby.stabilizacja,"/100"]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value",style:{width:`${t.potrzeby.stabilizacja}%`}})})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Autonomia"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.potrzeby.autonomia,"/100"]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value",style:{width:`${t.potrzeby.autonomia}%`}})})]}),(0,a.jsxs)("div",{className:"hr-stat-row",children:[(0,a.jsx)("div",{className:"hr-stat-label",children:"Relacje spo\u0142eczne"}),(0,a.jsxs)("div",{className:"hr-stat-value",children:[t.potrzeby.relacjeSpoleczne,"/100"]}),(0,a.jsx)("div",{className:"hr-progress-bar",children:(0,a.jsx)("div",{className:"hr-progress-value",style:{width:`${t.potrzeby.relacjeSpoleczne}%`}})})]})]}):(0,a.jsx)("div",{className:"hr-no-data",children:"Brak zdefiniowanych potrzeb"})]}),(0,a.jsxs)("div",{className:"hr-employee-section",children:[(0,a.jsx)("h4",{children:"Historia"}),t.historia&&0!==t.historia.length?(0,a.jsx)("div",{className:"hr-history-list",children:t.historia.map(((e,t)=>(0,a.jsxs)("div",{className:"hr-history-item",children:[(0,a.jsxs)("div",{className:"hr-history-date",children:[new Date(e.data).toLocaleDateString("pl-PL")," (tura ",s.turn,")"]}),(0,a.jsx)("div",{className:"hr-history-description",children:e.opis})]},t)))}):(0,a.jsx)("div",{className:"hr-no-data",children:"Brak historii wydarze\u0144"})]})]})]})]})};var vv={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},wv=i.createContext&&i.createContext(vv),xv=["attr","size","title"];function bv(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function jv(){return jv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},jv.apply(this,arguments)}function kv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Nv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kv(Object(n),!0).forEach((function(t){zv(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zv(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _v(e){return e&&e.map(((e,t)=>i.createElement(e.tag,Nv({key:t},e.attr),_v(e.child))))}function Sv(e){return t=>i.createElement(Ev,jv({attr:Nv({},e.attr)},t),_v(e.child))}function Ev(e){var t=t=>{var n,{attr:r,size:a,title:s}=e,o=bv(e,xv),l=a||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),i.createElement("svg",jv({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,o,{className:n,style:Nv(Nv({color:e.color||t.color},t.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),s&&i.createElement("title",null,s),e.children)};return void 0!==wv?i.createElement(wv.Consumer,null,(e=>t(e))):t(vv)}function Cv(e){return Sv({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(e)}function Tv(e){return Sv({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},child:[]}]})(e)}const Pv=e=>{var t,n,r,s,o,l,c,d,h,p,m,f;let{playerState:y,gameState:g}=e;const{dispatch:v}=u(),[w,x]=(0,i.useState)("all"),b=[{id:"fancy_cars",name:"Luksusowe samochody s\u0142u\u017cbowe",category:"lessor",description:"\u0141adniejsze samochody do prezentowania przed rolnikami zwi\u0119kszaj\u0105 skuteczno\u015b\u0107 dzier\u017cawc\xf3w.",levels:[{level:1,cost:25e4,benefit:"+5% do skuteczno\u015bci pozyskiwania grunt\xf3w"},{level:2,cost:5e5,benefit:"+10% do skuteczno\u015bci pozyskiwania grunt\xf3w"},{level:3,cost:1e6,benefit:"+15% do skuteczno\u015bci pozyskiwania grunt\xf3w"}],currentLevel:(null===(t=y.companyUpgrades)||void 0===t?void 0:t.fancy_cars)||0},{id:"digital_mapping",name:"Cyfrowe mapy i analizy",category:"lessor",description:"Zaawansowane narz\u0119dzia do analizy grunt\xf3w pozwalaj\u0105 lepiej wybiera\u0107 lokalizacje.",levels:[{level:1,cost:5e5,benefit:"+10% do dok\u0142adno\u015bci analiz lokalizacyjnych"},{level:2,cost:1e6,benefit:"+20% do dok\u0142adno\u015bci analiz lokalizacyjnych"},{level:3,cost:2e6,benefit:"+35% do dok\u0142adno\u015bci analiz lokalizacyjnych"}],currentLevel:(null===(n=y.companyUpgrades)||void 0===n?void 0:n.digital_mapping)||0},{id:"drone_surveys",name:"Drony do inspekcji terenowych",category:"lessor",description:"Drony pozwalaj\u0105 szybko oceni\u0107 du\u017ce obszary i zidentyfikowa\u0107 najlepsze lokalizacje.",levels:[{level:1,cost:35e4,benefit:"+15% do szybko\u015bci analizy terenu"},{level:2,cost:7e5,benefit:"+25% do szybko\u015bci analizy terenu"},{level:3,cost:14e5,benefit:"+40% do szybko\u015bci analizy terenu"}],currentLevel:(null===(r=y.companyUpgrades)||void 0===r?void 0:r.drone_surveys)||0},{id:"dev_workstations",name:"Zaawansowane stacje robocze",category:"developer",description:"Wysokiej klasy komputery i oprogramowanie CAD dla developer\xf3w.",levels:[{level:1,cost:35e4,benefit:"+8% do szybko\u015bci rozwoju projekt\xf3w"},{level:2,cost:7e5,benefit:"+16% do szybko\u015bci rozwoju projekt\xf3w"},{level:3,cost:14e5,benefit:"+25% do szybko\u015bci rozwoju projekt\xf3w"}],currentLevel:(null===(s=y.companyUpgrades)||void 0===s?void 0:s.dev_workstations)||0},{id:"dev_software",name:"Specjalistyczne oprogramowanie",category:"developer",description:"Licencje na profesjonalne oprogramowanie dla developer\xf3w.",levels:[{level:1,cost:4e5,benefit:"+10% do jako\u015bci dokumentacji technicznej"},{level:2,cost:8e5,benefit:"+20% do jako\u015bci dokumentacji technicznej"},{level:3,cost:16e5,benefit:"+30% do jako\u015bci dokumentacji technicznej"}],currentLevel:(null===(o=y.companyUpgrades)||void 0===o?void 0:o.dev_software)||0},{id:"gis_tools",name:"Zaawansowane narz\u0119dzia GIS",category:"gis",description:"Profesjonalne oprogramowanie i sprz\u0119t do analizy przestrzennej.",levels:[{level:1,cost:5e5,benefit:"+10% do dok\u0142adno\u015bci analiz lokalizacyjnych"},{level:2,cost:1e6,benefit:"+20% do dok\u0142adno\u015bci analiz lokalizacyjnych"},{level:3,cost:2e6,benefit:"+35% do dok\u0142adno\u015bci analiz lokalizacyjnych"}],currentLevel:(null===(l=y.companyUpgrades)||void 0===l?void 0:l.gis_tools)||0},{id:"drone_fleet",name:"Flota dron\xf3w badawczych",category:"gis",description:"Drony z kamerami termowizyjnymi i multispektralnymi do badania terenu.",levels:[{level:1,cost:6e5,benefit:"+12% do szybko\u015bci analizy terenu"},{level:2,cost:12e5,benefit:"+25% do szybko\u015bci analizy terenu"},{level:3,cost:24e5,benefit:"+40% do szybko\u015bci analizy terenu"}],currentLevel:(null===(c=y.companyUpgrades)||void 0===c?void 0:c.drone_fleet)||0},{id:"law_database",name:"Baza danych prawniczych",category:"lawyer",description:"Dost\u0119p do profesjonalnych baz danych prawniczych i precedens\xf3w.",levels:[{level:1,cost:45e4,benefit:"+10% do skuteczno\u015bci w post\u0119powaniach administracyjnych"},{level:2,cost:9e5,benefit:"+20% do skuteczno\u015bci w post\u0119powaniach administracyjnych"},{level:3,cost:18e5,benefit:"+35% do skuteczno\u015bci w post\u0119powaniach administracyjnych"}],currentLevel:(null===(d=y.companyUpgrades)||void 0===d?void 0:d.law_database)||0},{id:"pr_campaigns",name:"Kampanie PR dla projekt\xf3w",category:"lobbyist",description:"Profesjonalne kampanie PR zwi\u0119kszaj\u0105ce akceptacj\u0119 spo\u0142eczn\u0105.",levels:[{level:1,cost:4e5,benefit:"+15% do akceptacji spo\u0142ecznej projekt\xf3w"},{level:2,cost:8e5,benefit:"+30% do akceptacji spo\u0142ecznej projekt\xf3w"},{level:3,cost:16e5,benefit:"+50% do akceptacji spo\u0142ecznej projekt\xf3w"}],currentLevel:(null===(h=y.companyUpgrades)||void 0===h?void 0:h.pr_campaigns)||0},{id:"company_offices",name:"Nowoczesna siedziba firmy",category:"company",description:"Presti\u017cowe biura zwi\u0119kszaj\u0105ce morale wszystkich pracownik\xf3w.",levels:[{level:1,cost:1e6,benefit:"+10% do morale wszystkich pracownik\xf3w"},{level:2,cost:25e5,benefit:"+20% do morale wszystkich pracownik\xf3w"},{level:3,cost:5e6,benefit:"+35% do morale wszystkich pracownik\xf3w"}],currentLevel:(null===(p=y.companyUpgrades)||void 0===p?void 0:p.company_offices)||0},{id:"employee_benefits",name:"Program benefit\xf3w pracowniczych",category:"company",description:"Kompleksowy pakiet benefit\xf3w poprawiaj\u0105cy zadowolenie i wydajno\u015b\u0107.",levels:[{level:1,cost:8e5,benefit:"+8% do wydajno\u015bci i -10% do rotacji pracownik\xf3w"},{level:2,cost:16e5,benefit:"+15% do wydajno\u015bci i -25% do rotacji pracownik\xf3w"},{level:3,cost:32e5,benefit:"+25% do wydajno\u015bci i -50% do rotacji pracownik\xf3w"}],currentLevel:(null===(m=y.companyUpgrades)||void 0===m?void 0:m.employee_benefits)||0},{id:"training_program",name:"Program szkole\u0144 wewn\u0119trznych",category:"company",description:"Systematyczne szkolenia zwi\u0119kszaj\u0105ce kompetencje ca\u0142ego zespo\u0142u.",levels:[{level:1,cost:6e5,benefit:"+10% szybszy wzrost do\u015bwiadczenia"},{level:2,cost:12e5,benefit:"+20% szybszy wzrost do\u015bwiadczenia"},{level:3,cost:24e5,benefit:"+35% szybszy wzrost do\u015bwiadczenia"}],currentLevel:(null===(f=y.companyUpgrades)||void 0===f?void 0:f.training_program)||0}],j="all"===w?b:b.filter((e=>e.category===w));return(0,a.jsxs)("div",{className:"company-upgrades",children:[(0,a.jsx)("h3",{children:"Ulepszenia firmowe"}),(0,a.jsx)("p",{className:"upgrades-description",children:"Inwestuj w rozw\xf3j swojej firmy, aby zwi\u0119kszy\u0107 wydajno\u015b\u0107 i skuteczno\u015b\u0107 twoich pracownik\xf3w. Ka\u017cde ulepszenie mo\u017cna rozwija\u0107 do trzeciego poziomu, zwi\u0119kszaj\u0105c efekty."}),(0,a.jsxs)("div",{className:"upgrades-filters",children:[(0,a.jsx)("button",{className:"filter-btn "+("all"===w?"active":""),onClick:()=>x("all"),children:"Wszystkie"}),(0,a.jsx)("button",{className:"filter-btn "+("lessor"===w?"active":""),onClick:()=>x("lessor"),children:"Dzier\u017cawcy"}),(0,a.jsx)("button",{className:"filter-btn "+("developer"===w?"active":""),onClick:()=>x("developer"),children:"Developerzy"}),(0,a.jsx)("button",{className:"filter-btn "+("gis"===w?"active":""),onClick:()=>x("gis"),children:"GIS"}),(0,a.jsx)("button",{className:"filter-btn "+("lawyer"===w?"active":""),onClick:()=>x("lawyer"),children:"Prawnicy"}),(0,a.jsx)("button",{className:"filter-btn "+("lobbyist"===w?"active":""),onClick:()=>x("lobbyist"),children:"Lobby\u015bci"}),(0,a.jsx)("button",{className:"filter-btn "+("company"===w?"active":""),onClick:()=>x("company"),children:"Firma"})]}),(0,a.jsx)("div",{className:"upgrades-grid",children:j.map((e=>{const t=e.currentLevel+1,n=t>e.levels.length,i=n?null:e.levels[t-1];return(0,a.jsxs)("div",{className:"upgrade-card",children:[(0,a.jsxs)("div",{className:"upgrade-header",children:[(0,a.jsx)("div",{className:"upgrade-title",children:e.name}),(0,a.jsxs)("div",{className:"upgrade-level",children:["Poziom ",e.currentLevel,"/",e.levels.length]})]}),(0,a.jsx)("div",{className:"upgrade-description",children:e.description}),(0,a.jsxs)("div",{className:"upgrade-current-benefits",children:[(0,a.jsx)("div",{className:"upgrade-benefit-title",children:"Obecne korzy\u015bci:"}),0===e.currentLevel?(0,a.jsx)("div",{className:"upgrade-no-benefits",children:"Brak (ulepszenie nie zakupione)"}):(0,a.jsxs)("div",{className:"upgrade-benefit",children:[(0,a.jsx)(Cv,{className:"upgrade-benefit-icon"}),(0,a.jsx)("span",{children:e.levels[e.currentLevel-1].benefit})]})]}),!n&&(0,a.jsxs)("div",{className:"upgrade-next-level",children:[(0,a.jsx)("div",{className:"upgrade-benefit-title",children:"Nast\u0119pny poziom:"}),(0,a.jsxs)("div",{className:"upgrade-benefit",children:[(0,a.jsx)(Tv,{className:"upgrade-benefit-icon"}),(0,a.jsx)("span",{children:i.benefit})]})]}),(0,a.jsx)("div",{className:"upgrade-cost",children:n?(0,a.jsx)("div",{className:"upgrade-max-level",children:"Osi\u0105gni\u0119to maksymalny poziom"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"upgrade-price",children:["Koszt: ",i.cost.toLocaleString()," PLN"]}),(0,a.jsx)("button",{className:"upgrade-button",onClick:()=>(e=>{const t=b.find((t=>t.id===e));if(!t)return;const n=t.currentLevel+1;if(n>t.levels.length)return;const i=t.levels[n-1].cost;y.cash<i?alert("Niewystarczaj\u0105ce \u015brodki!"):v({type:"PURCHASE_COMPANY_UPGRADE",payload:{upgradeId:e,level:n,cost:i}})})(e.id),disabled:y.cash<i.cost,children:y.cash>=i.cost?"Ulepsz":"Za ma\u0142o \u015brodk\xf3w"})]})})]},e.id)}))})]})},Iv=e=>{let{employees:t,staffManagement:n,gameState:r}=e;const[s,o]=(0,i.useState)(null),[l,c]=(0,i.useState)("skill"),[d,u]=(0,i.useState)("all"),h=(0,i.useMemo)((()=>"all"===d?t:t.filter((e=>e.typeShort===d))),[t,d]),p=(0,i.useMemo)((()=>t.find((e=>e.id===s))||null),[t,s]),m=(0,i.useMemo)((()=>(e=>{if(!e)return[];const t=[{id:"skill",name:"Rozw\xf3j umiej\u0119tno\u015bci",description:"Zwi\u0119ksza og\xf3lny poziom umiej\u0119tno\u015bci pracownika.",cost:e.skill/2*5e3},{id:"morale",name:"Budowanie morale",description:"Zwi\u0119ksza morale i zaanga\u017cowanie pracownika.",cost:3e3}];if("developer"===e.typeShort){const e=[{id:"tech_pv",name:"Technologia PV",description:"Pog\u0142\u0119biona wiedza o technologii fotowoltaicznej.",cost:8e3},{id:"tech_wind",name:"Technologia wiatrowa",description:"Specjalistyczna wiedza o turbinach wiatrowych.",cost:1e4},{id:"tech_bess",name:"Magazyny energii",description:"Specjalistyczna wiedza o magazynach energii.",cost:12e3},{id:"tech_hybrid",name:"Systemy hybrydowe",description:"Wiedza o \u0142\u0105czeniu r\xf3\u017cnych technologii OZE.",cost:15e3}];return[...t,...e]}if("lessor"===e.typeShort){const e=[{id:"negotiation_skills",name:"Techniki negocjacji",description:"Zwi\u0119ksza umiej\u0119tno\u015bci negocjacyjne dzier\u017cawcy, co przek\u0142ada si\u0119 na lepsze warunki um\xf3w dzier\u017cawy.",duration:5,cost:5e3,effects:{negotiation:15,landAcquisitionSpeed:10}},{id:"land_valuation",name:"Wycena grunt\xf3w",description:"Pozwala lepiej ocenia\u0107 warto\u015b\u0107 grunt\xf3w, co zmniejsza koszty dzier\u017cawy.",duration:4,cost:4e3,effects:{landCostReduction:8,landQualityAssessment:15}},{id:"local_relations",name:"Relacje lokalne",description:"Uczy budowania relacji z lokalnymi spo\u0142eczno\u015bciami, co u\u0142atwia pozyskiwanie grunt\xf3w.",duration:6,cost:6e3,effects:{localRelations:20,landAcquisitionSpeed:15}}];return[...t,...e]}if("lawyer"===e.typeShort){const e=[{id:"energy_law",name:"Prawo energetyczne",description:"Pog\u0142\u0119biona wiedza o prawie energetycznym.",cost:9e3},{id:"env_regulations",name:"Regulacje \u015brodowiskowe",description:"Pog\u0142\u0119biona wiedza o przepisach ochrony \u015brodowiska.",cost:8e3}];return[...t,...e]}if("envSpecialist"===e.typeShort){const e=[{id:"env_assessment",name:"Oceny oddzia\u0142ywania",description:"Zaawansowane techniki oceny wp\u0142ywu na \u015brodowisko.",cost:8e3},{id:"nature_protection",name:"Ochrona przyrody",description:"Specjalistyczna wiedza o obszarach chronionych.",cost:7e3}];return[...t,...e]}if("lobbyist"===e.typeShort){const e=[{id:"public_relations",name:"Relacje publiczne",description:"Techniki budowania pozytywnych relacji.",cost:6e3},{id:"community_management",name:"Zarz\u0105dzanie spo\u0142eczno\u015bci\u0105",description:"Sposoby anga\u017cowania lokalnych spo\u0142eczno\u015bci.",cost:7e3}];return[...t,...e]}return t})(p)),[p]),f=(0,i.useMemo)((()=>m.find((e=>e.id===l))||null),[m,l]);return(0,a.jsxs)("div",{className:"training-center",children:[(0,a.jsx)("h3",{children:"Centrum szkole\u0144"}),(0,a.jsx)("p",{className:"training-description",children:"Rozwijaj umiej\u0119tno\u015bci swoich pracownik\xf3w poprzez specjalistyczne szkolenia. Ka\u017cde szkolenie zwi\u0119ksza poziom umiej\u0119tno\u015bci i do\u015bwiadczenie pracownika."}),(0,a.jsx)("div",{className:"training-filters",children:(0,a.jsxs)("select",{value:d,onChange:e=>u(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"Wszyscy pracownicy"}),(0,a.jsx)("option",{value:"lessor",children:"Dzier\u017cawcy"}),(0,a.jsx)("option",{value:"developer",children:"Developerzy"}),(0,a.jsx)("option",{value:"lawyer",children:"Prawnicy"}),(0,a.jsx)("option",{value:"envSpecialist",children:"Spec. \u015brodowiskowi"}),(0,a.jsx)("option",{value:"lobbyist",children:"Lobby\u015bci"})]})}),(0,a.jsxs)("div",{className:"training-grid",children:[(0,a.jsxs)("div",{className:"employees-for-training",children:[(0,a.jsx)("h4",{children:"Wybierz pracownika do szkolenia"}),0===h.length?(0,a.jsx)("div",{className:"no-employees-message",children:"Brak pracownik\xf3w spe\u0142niaj\u0105cych kryteria"}):(0,a.jsx)("div",{className:"training-employees-list",children:h.map((e=>(0,a.jsxs)("div",{className:"training-employee-item "+(s===e.id?"selected":""),onClick:()=>o(e.id),children:[(0,a.jsx)("div",{className:"training-employee-name",children:e.name}),(0,a.jsxs)("div",{className:"training-employee-info",children:[(0,a.jsx)("span",{children:Dy(e.typeShort)}),(0,a.jsxs)("span",{children:["Poziom: ",e.skill,"/10"]})]}),(0,a.jsxs)("div",{className:"training-employee-exp",children:["Do\u015bwiadczenie: ",e.experience," p.d."]})]},e.id)))})]}),(0,a.jsx)("div",{className:"training-options",children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h4",{children:"Dost\u0119pne szkolenia"}),(0,a.jsx)("div",{className:"training-types-list",children:m.map((e=>(0,a.jsxs)("div",{className:"training-type-item "+(l===e.id?"selected":""),onClick:()=>c(e.id),children:[(0,a.jsx)("div",{className:"training-type-name",children:e.name}),(0,a.jsxs)("div",{className:"training-type-cost",children:[e.cost.toLocaleString()," PLN"]})]},e.id)))}),f&&(0,a.jsxs)("div",{className:"training-details",children:[(0,a.jsx)("h5",{children:f.name}),(0,a.jsx)("p",{children:f.description}),(0,a.jsxs)("div",{className:"training-cost",children:["Koszt: ",f.cost.toLocaleString()," PLN"]}),(0,a.jsxs)("div",{className:"training-benefits",children:[(0,a.jsx)("div",{className:"training-benefit-title",children:"Korzy\u015bci:"}),"skill"===l&&(0,a.jsx)("div",{className:"training-benefit-item",children:"\u2022 Wzrost umiej\u0119tno\u015bci o 1 punkt"}),"morale"===l&&(0,a.jsx)("div",{className:"training-benefit-item",children:"\u2022 Wzrost morale o 20 punkt\xf3w"}),l.startsWith("tech_")&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"training-benefit-item",children:"\u2022 Dodatkowe do\u015bwiadczenie w technologii"}),(0,a.jsx)("div",{className:"training-benefit-item",children:"\u2022 Szybszy rozw\xf3j projekt\xf3w tej technologii"})]}),"negotiation"===l&&(0,a.jsx)("div",{className:"training-benefit-item",children:"\u2022 Wy\u017csze szanse na pozyskanie grunt\xf3w"}),"land_valuation"===l&&(0,a.jsx)("div",{className:"training-benefit-item",children:"\u2022 Lepsza ocena potencja\u0142u grunt\xf3w"}),(0,a.jsx)("div",{className:"training-benefit-item",children:"\u2022 Wzrost do\u015bwiadczenia zawodowego"})]}),(0,a.jsx)("button",{className:"start-training-button",onClick:()=>{p&&f&&n.trainStaff(p.typeShort,p.id,l)},children:"Rozpocznij szkolenie"})]})]}):(0,a.jsx)("div",{className:"select-employee-prompt",children:"Wybierz pracownika z listy, aby zobaczy\u0107 dost\u0119pne szkolenia"})})]})]})},Av=()=>{const{state:e,dispatch:t}=u(),{state:n,showNotification:r}=ff(),s=Fy(),[o,l]=(0,i.useState)("employees"),[c,d]=(0,i.useState)(null),[h,p]=(0,i.useState)(null),m=()=>{const t=[];return["lessors","developers","lawyers","envSpecialists","lobbyists"].forEach((n=>{e.staff[n]&&e.staff[n].forEach((e=>{t.push({...e,typePlural:n,typeShort:n.endsWith("s")?n.slice(0,-1):n})}))})),t};return(0,a.jsxs)("div",{className:"hr-system-container",children:[(0,a.jsxs)("div",{className:"hr-system-header",children:[(0,a.jsx)("h2",{children:"System zarz\u0105dzania zasobami ludzkimi"}),(0,a.jsxs)("div",{className:"hr-system-tabs",children:[(0,a.jsx)("button",{className:"employees"===o?"active":"",onClick:()=>l("employees"),children:"Pracownicy"}),(0,a.jsx)("button",{className:"training"===o?"active":"",onClick:()=>l("training"),children:"Szkolenia"}),(0,a.jsx)("button",{className:"upgrades"===o?"active":"",onClick:()=>l("upgrades"),children:"Ulepszenia firmy"}),(0,a.jsx)("button",{className:"employment"===o?"active":"",onClick:()=>l("employment"),children:"Zatrudnienie"})]})]}),(0,a.jsxs)("div",{className:"hr-system-content",children:["employees"===o&&(0,a.jsxs)("div",{className:"hr-employees-view",children:[(0,a.jsx)(yv,{employees:m(),onSelectEmployee:e=>{d(e),p(e.typeShort)},selectedEmployeeId:null===c||void 0===c?void 0:c.id}),c&&(0,a.jsx)(gv,{employee:c,staffType:h,staffManagement:s,gameState:n})]}),"training"===o&&(0,a.jsx)(Iv,{employees:m(),staffManagement:s,gameState:n}),"upgrades"===o&&(0,a.jsx)(Pv,{playerState:e,gameState:n}),"employment"===o&&(0,a.jsx)(wg,{staffManagement:s,gameState:n,playerState:e})]})]})},Mv=e=>{let{onLoginComplete:t}=e;const[n,r]=(0,i.useState)(""),[s,o]=(0,i.useState)(!1),[l,c]=(0,i.useState)(null),[d,u]=(0,i.useState)(null);(0,i.useEffect)((()=>{const e=cf((e=>{u(e),e&&e.displayName&&t(e)}));return()=>e()}),[t]);return(0,a.jsxs)("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-b from-gray-900 to-gray-800 overflow-hidden relative",children:[(0,a.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute w-96 h-96 rounded-full bg-green-500 opacity-10 -top-20 -left-20 animate-pulse"}),(0,a.jsx)("div",{className:"absolute w-128 h-128 rounded-full bg-blue-500 opacity-10 -bottom-40 -right-40 animate-pulse",style:{animationDuration:"8s"}}),(0,a.jsx)("div",{className:"absolute top-1/4 left-1/4 w-12 h-12 bg-yellow-400 opacity-20 rounded-full animate-float",style:{animationDuration:"5s"}}),(0,a.jsx)("div",{className:"absolute bottom-1/3 right-1/3 w-16 h-16 bg-purple-500 opacity-20 rounded-full animate-float",style:{animationDuration:"7s"}}),(0,a.jsx)("div",{className:"absolute top-2/3 left-1/5 w-8 h-8 bg-red-400 opacity-15 rounded-full animate-float",style:{animationDuration:"6s"}}),(0,a.jsx)("div",{className:"absolute top-1/5 right-1/4 w-10 h-10 bg-indigo-400 opacity-15 rounded-full animate-float",style:{animationDuration:"9s"}}),(0,a.jsxs)("div",{className:"absolute inset-0 opacity-10",children:[(0,a.jsx)("div",{className:"absolute top-1/4 left-0 right-0 h-px bg-gradient-to-r from-transparent via-blue-500 to-transparent"}),(0,a.jsx)("div",{className:"absolute top-2/4 left-0 right-0 h-px bg-gradient-to-r from-transparent via-green-500 to-transparent"}),(0,a.jsx)("div",{className:"absolute top-3/4 left-0 right-0 h-px bg-gradient-to-r from-transparent via-purple-500 to-transparent"})]})]}),(0,a.jsxs)("div",{className:"w-full max-w-md p-8 space-y-8 bg-gray-800 rounded-xl shadow-[0_20px_50px_rgba(0,0,0,0.5)] relative z-10 border border-gray-700 transform transition-all duration-300 hover:scale-[1.01] hover:shadow-[0_25px_60px_rgba(0,0,0,0.5)]",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-blue-500",children:"OZE Developer Manager"}),(0,a.jsx)("p",{className:"mt-3 text-xl text-gray-300 font-light",children:"Witaj w symulatorze dewelopera OZE!"}),(0,a.jsx)("div",{className:"h-1 w-32 bg-gradient-to-r from-green-400 to-blue-500 mx-auto my-4 rounded-full"})]}),d?(0,a.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),n.trim()){o(!0),c(null);try{await(async e=>{try{return await qi(tf.currentUser,{displayName:e}),tf.currentUser}catch(l){throw console.error("B\u0142\u0105d aktualizacji nazwy u\u017cytkownika:",l),l}})(n),t(d)}catch(l){c("B\u0142\u0105d ustawiania nazwy u\u017cytkownika. Spr\xf3buj ponownie."),console.error(l)}finally{o(!1)}}else c("Prosz\u0119 poda\u0107 nazw\u0119 u\u017cytkownika")},className:"mt-8 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"nickname",className:"block text-sm font-medium text-gray-300",children:"Tw\xf3j nickname do tablicy wynik\xf3w"}),(0,a.jsx)("input",{id:"nickname",name:"nickname",type:"text",required:!0,value:n,onChange:e=>r(e.target.value),placeholder:"Podaj sw\xf3j nickname",className:"w-full px-3 py-2 mt-1 text-gray-200 placeholder-gray-500 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 shadow-inner transition-all duration-200"})]}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"submit",disabled:s,className:"w-full px-4 py-3 font-bold text-white transition-all duration-300 bg-gradient-to-r from-green-600 to-blue-600 rounded-lg hover:from-green-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transform hover:scale-105 hover:shadow-[0_5px_15px_rgba(0,0,0,0.3)] shadow-lg",children:s?(0,a.jsxs)("span",{className:"flex items-center justify-center",children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Zapisywanie..."]}):"Zapisz i graj"})})]}):(0,a.jsx)("div",{className:"mt-8",children:(0,a.jsx)("button",{onClick:async()=>{o(!0),c(null);try{await rf()}catch(l){c("B\u0142\u0105d logowania. Spr\xf3buj ponownie."),console.error(l)}finally{o(!1)}},disabled:s,className:"w-full px-4 py-3 font-bold text-white transition-all duration-300 bg-gradient-to-r from-green-600 to-blue-600 rounded-lg hover:from-green-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transform hover:scale-105 hover:shadow-[0_5px_15px_rgba(0,0,0,0.3)] shadow-lg",children:s?(0,a.jsxs)("span",{className:"flex items-center justify-center",children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Logowanie..."]}):"Rozpocznij gr\u0119"})}),l&&(0,a.jsx)("div",{className:"p-4 mt-4 text-red-800 bg-red-100 rounded-md animate-pulse",children:(0,a.jsx)("p",{children:l})}),(0,a.jsxs)("div",{className:"text-center text-gray-500 text-sm mt-6",children:[(0,a.jsx)("p",{children:"\xa9 2023 OZE Developer Manager"}),(0,a.jsx)("style",{jsx:!0,children:"\n            @keyframes float {\n              0%, 100% { transform: translateY(0); }\n              50% { transform: translateY(-10px); }\n            }\n            .animate-float {\n              animation: float 5s ease-in-out infinite;\n            }\n          "})]})]})]})},Dv=e=>{let{onBack:t}=e;const[n,r]=(0,i.useState)([]),[s,o]=(0,i.useState)(!0),[l,c]=(0,i.useState)(null),[d,u]=(0,i.useState)("25GW");(0,i.useEffect)((()=>{h()}),[d]);const h=async()=>{o(!0),c(null);try{const e=await lf(d);Array.isArray(e)?r(e):(r([]),c("Nie otrzymano poprawnych danych z serwera. Spr\xf3buj ponownie p\xf3\u017aniej."))}catch(l){console.error("B\u0142\u0105d \u0142adowania tablicy wynik\xf3w:",l),r([]),c("Nie uda\u0142o si\u0119 za\u0142adowa\u0107 tablicy wynik\xf3w. Spr\xf3buj ponownie p\xf3\u017aniej.")}finally{o(!1)}},p=e=>{if(!e)return"N/A";return(e.toDate?e.toDate():new Date(e)).toLocaleDateString("pl-PL")};return(0,a.jsx)("div",{className:"flex flex-col min-h-screen bg-gray-800 text-white p-6",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto w-full",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-green-500",children:"Tablica Wynik\xf3w"}),(0,a.jsx)("button",{onClick:t,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",children:"Powr\xf3t do gry"})]}),(0,a.jsxs)("div",{className:"flex mb-6 border-b border-gray-700",children:[(0,a.jsx)("button",{className:"px-4 py-2 "+("25GW"===d?"text-green-500 border-b-2 border-green-500":"text-gray-400"),onClick:()=>u("25GW"),children:"Cel: 25 GW mocy"}),(0,a.jsx)("button",{className:"px-4 py-2 "+("10BLN"===d?"text-green-500 border-b-2 border-green-500":"text-gray-400"),onClick:()=>u("10BLN"),children:"Cel: 10 mld PLN"})]}),s?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)("p",{className:"text-xl text-gray-400",children:"\u0141adowanie wynik\xf3w..."})}):l?(0,a.jsx)("div",{className:"bg-red-900/20 border border-red-800 p-4 rounded-lg",children:(0,a.jsx)("p",{children:l})}):0===n.length?(0,a.jsxs)("div",{className:"bg-gray-700 p-8 rounded-lg text-center",children:[(0,a.jsx)("p",{className:"text-xl mb-2",children:"Nikomu jeszcze si\u0119 nie uda\u0142o, czy b\u0119dziesz pierwszy?"}),(0,a.jsx)("p",{className:"text-gray-400",children:"B\u0105d\u017a pierwszym, kt\xf3ry uko\u0144czy gr\u0119 z tym celem!"})]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full bg-gray-700 rounded-lg overflow-hidden",children:[(0,a.jsx)("thead",{className:"bg-gray-800",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left",children:"Miejsce"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left",children:"Gracz"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left",children:"Liczba tur"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left",children:"Liczba dni"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left",children:"Data uko\u0144czenia"})]})}),(0,a.jsx)("tbody",{children:n.map(((e,t)=>(0,a.jsxs)("tr",{className:t%2===0?"bg-gray-700":"bg-gray-650",children:[(0,a.jsx)("td",{className:"px-6 py-4",children:0===t?(0,a.jsx)("span",{className:"text-yellow-400 font-bold",children:"\ud83c\udfc6 1"}):1===t?(0,a.jsx)("span",{className:"text-gray-300 font-bold",children:"\ud83e\udd48 2"}):2===t?(0,a.jsx)("span",{className:"text-amber-600 font-bold",children:"\ud83e\udd49 3"}):`${t+1}`}),(0,a.jsx)("td",{className:"px-6 py-4 font-medium",children:e.nickname}),(0,a.jsx)("td",{className:"px-6 py-4",children:e.turns}),(0,a.jsx)("td",{className:"px-6 py-4",children:e.days}),(0,a.jsx)("td",{className:"px-6 py-4",children:p(e.timestamp)})]},e.id)))})]})})]})})},Rv=()=>{const[e,t]=(0,i.useState)(null),[n,r]=(0,i.useState)(!1),{state:s,dispatch:o}=ff(),{state:l,dispatch:c}=u();(0,i.useEffect)((()=>{"leaderboard"===s.appView&&(r(!0),o({type:"SET_APP_VIEW",payload:null}))}),[s.appView,o]);const d=(0,i.useCallback)((()=>{n&&r(!1)}),[n]);(0,i.useEffect)((()=>(window.addEventListener("next-game-day",d),()=>{window.removeEventListener("next-game-day",d)})),[d]);const h=(0,i.useCallback)((e=>{e&&e.preventDefault&&e.preventDefault();try{window.history.pushState(null,document.title,window.location.href)}catch(t){console.error("B\u0142\u0105d przy manipulacji historii:",t)}n&&r(!1)}),[n]);(0,i.useEffect)((()=>{try{window.history.pushState(null,document.title,window.location.href),window.addEventListener("popstate",h)}catch(e){console.error("B\u0142\u0105d przy dodawaniu obs\u0142ugi historii:",e)}return()=>{try{window.removeEventListener("popstate",h)}catch(e){console.error("B\u0142\u0105d przy usuwaniu obs\u0142ugi historii:",e)}}}),[h]);const p=(0,i.useCallback)((async()=>{if(e)try{await af(s,l),console.log("Stan gry zapisany")}catch(t){console.error("B\u0142\u0105d zapisywania stanu gry:",t)}}),[e,s,l]);(0,i.useEffect)((()=>{if(!e)return;const t=setInterval(p,6e4);return()=>clearInterval(t)}),[e,p]);const m=(0,i.useCallback)((async t=>{if(e)try{await of(t,s.day),console.log(`Osi\u0105gni\u0119to cel: ${t}`)}catch(n){console.error("B\u0142\u0105d zapisywania wyniku:",n)}}),[e,s.day]);(0,i.useEffect)((()=>{e&&l&&(l.installedCapacity+l.rtbCapacity>=25e3&&m("25GW"),l.cash>=1e10&&m("10BLN"))}),[e,l,m]),(0,i.useEffect)((()=>{if(e)return window.saveGameFunction=p,()=>{window.saveGameFunction=void 0}}),[e,p]);const f=async e=>{t(e);try{const e=await sf();e&&e.gameState&&(o({type:"LOAD_GAME",payload:e.gameState}),c({type:"LOAD_PLAYER",payload:e.playerState}),console.log("Wczytano zapisany stan gry"),o({type:"SET_NOTIFICATION",payload:{text:"Wczytano zapisany stan gry!",type:"success"}}))}catch(n){console.error("B\u0142\u0105d wczytywania stanu gry:",n)}},y=()=>{p()};if(!e)return(0,a.jsx)(Mv,{onLoginComplete:f});if(n)return(0,a.jsx)(Dv,{onBack:()=>r(!1)});const g=()=>{switch(s.currentScreen){case"home":default:return(0,a.jsx)(Ay,{onShowLeaderboard:()=>r(!0),onSaveGame:y});case"regions":return(0,a.jsx)(fv,{});case"company":return(0,a.jsx)(Rg,{});case"events":return(0,a.jsx)(Jg,{});case"competitors":return(0,a.jsx)(iv,{});case"market":return(0,a.jsx)(sv,{});case"hr":return(0,a.jsx)(Av,{})}};return(0,a.jsx)(Cy,{children:(0,a.jsx)(g,{})})};const Ov=function(){return(0,a.jsx)(Of,{children:(0,a.jsx)(Rv,{})})};r.createRoot(document.getElementById("root")).render((0,a.jsx)(i.StrictMode,{children:(0,a.jsx)(Ov,{})}))})();